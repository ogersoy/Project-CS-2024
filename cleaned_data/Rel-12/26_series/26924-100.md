# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
Multimedia Telephony for IMS (MTSI) is a standardized service for
conversational telephony, TS 22.173 [2]. The media handling and interaction
are specified in TS 26.114 [3]. MTSI has been specified such that the user
experience of multimedia telephony is equivalent to or better than
corresponding circuit-switched telephony services while still having efficient
resource usage. Multimedia telephony also exploits the richer capabilities of
IMS where media components can be used symmetrically or asymmetrically in
different directions.
# 1 Scope
TS 26.114 define media handling and interaction for the Multimedia Telephony
Service for IMS (MTSI) including mechanisms for the negotiation of bandwidth
using the SDP bandwidth modifiers. The present study investigates potential
improvements for the end-to-end QoS handling with the purpose to improve the
network resource allocation for variable bit-rate codecs, rate-adaptive codecs
and asymmetric sessions (i.e. different bitrates for different directions).
The study will focus on SDP extensions and the interaction with the policy
control.
The present document:
\- 1 -- Identifies high-level use cases
\- 2 -- Evaluates for these use cases the current limitations and the expected
benefits
\- 3 -- Establishes recommended high-level functional requirements and related
recommended technical requirements
\- 4 -- Discusses potential solutions
\- 5 -- Studies impact of potential solutions on networks and terminals
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.173: \"IP Multimedia Core Network Subsystem (IMS) Multimedia
Telephony Service and supplementary services; Stage 1\".
[3] 3GPP TS 26.114: \"IP Multimedia Subsystem (IMS); Multimedia telephony;
Media handling and interaction\".
[4] 3GPP TS 23.203: \"Policy and charging control architecture\".
[5] 3GPP TS 29.212: \"Policy and Charging Control (PCC); Reference points\".
[6] 3GPP TS 29.213: \"Policy and charging control signalling flows and Quality
of Service (QoS) parameter mapping\".
[7] 3GPP TS 29.214: \"Policy and charging control over Rx reference point\".
[8] IETF RFC 4566 (2006): \"SDP: Session Description Protocol\", M. Handley,
V. Jacobson and C. Perkins.
[9] IETF RFC 3264 (2002): \"An Offer/Answer Model with the Session Description
Protocol (SDP)\", J. Rosenberg and H. Schulzrinne.
[10] IETF RFC 3890 2004): \"A Transport Independent Bandwidth Modifier for the
Session Description Protocol (SDP)\"., M. Westerlund.
[11] 3GPP TS 23.401: \"Technical Specification Group Services and System
Aspects; GPRS enhancements for E-UTRAN access\".[12] 3GPP TS 24.229: \"IP
multimedia call control protocol based on Session Initiation Protocol (SIP)
and Session Description Protocol (SDP); Stage 3\".
[13] IETF RFC 5939: \"Session Description Protocol (SDP) Capability
Negotiation\".
[14] IETF RFC 7006: \"Miscellaneous Capabilities Negotiation in the Session
Description Protocol (SDP)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply.\ A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
AF Application Function
ARP Allocation and Retention Priority
AVP Attribute-Value Pair
EPC Evolved Packet Core
GW Gateway
LTE Long Term Evolution
MBR Maximum Bitrate
MTSI Multimedia Telephony Service for IMS
P-CSCF Proxy Call Server Control Function
PCC Policy and Charging Control
PCEF Policy and Charging Enforcement Function
PCRF Policy Charging and Rules Function
PDN-GW Packet Data Network Gateway (PGW)
RTCP RTP Control Protocol
SDP Session Description Protocol
SGW Serving Gateway
# 4 Overview
Clause 5 provides a high-level description of the network elements that are
involved in the session setup and resource reservation. The rest of the
present document is organized as follows:
Clause 6 describes the use cases analysed in this study. A gap analysis is
performed.
Clause 7 describes the recommended requirements that can be derived from the
gap analysis.
Clause 8 describes and evaluates potential solutions.
Clause 9 provides the conclusion and recommendations for further
standardization efforts.
# 5 Current QoS reservation mechanisms during session setup
## 5.1 System description
IMS uses local resource reservation where each IMS network allocates resources
only for its own access.
A simplified description of the functions that are used for the bandwidth
negotiation and the bearer setup in EPC and LTE is shown in the figure below.
{width="6.695138888888889in" height="3.2819444444444446in"}
Figure 5.1-1: High-level description of the functions that are involved in the
bandwidth negotiation and resource reservation in an IMS network when EPC is
used.
Editor\'s note: The figure above needs to be converted into an Enhanced
Metafile picture, so that it will be visible also in Draft and Outline view.
This will be done before creating v1.0.0 of the TR.
The resource allocation and bearer setup in EPC/LTE follows the Policy and
Charging Control (PCC) procedure in TS 23.203 [4], TS 29.212 [5], TS 29.213
[6] and TS 29.214 [7], and can on a high level be described as follows (a more
detailed description is found in TS 29.213 [6] Clause 6):
1\. The P-CSCF, acting as an Application Function (AF), analyses the SDP offer
and the SDP answer and determines the session information and the media
information that will be allocated. The AF instructs the Policy Charging and
Rules Function (PCRF) to allocate resources for the Service Data Flow. Both
the SDP session information and the media information are included in the Rx
service information.
\- Before sending the service information to the PCRF, the AF maps the
m-lines, c-lines, b-lines and the direction attributes from the SDP to the
corresponding Attribute-Value Pairs (AVP) in the service information. The AF
provides the media-related attribute lines in the SDP in transparent container
AVPs as part of the media information. The AF may also provide an application
identifier.
\- The media information includes the media properties, for example maximum
UL/DL bitrates for media, UL/DL bitrates for RTCP, codec information, etc.
2\. The PCRF converts the requested session information into a set of QoS
parameters for the Service Data Flow.
\- The PCRF can also take other information into account when determining the
QoS parameters, for example operator policies and subscription information.
\- The PCRF may use media-level SDP attribute lines in the service
information, the identity of the application and/or operator specific policies
to override bandwidth information directly included in the service
information. Codec specific algorithms that the PCRF can apply to derive
bandwidth information are not standardized, but can be based on the QoS
examples in Annex E of TS 26.114 [3].
\- The common QoS parameters for all Service Data Flows are: QoS Class
Identifier (QCI), and Allocation and Retention Priority (ARP). The additional
parameters for Service Data Flows characterized by a GBR QCI are: Maximum Bit
Rate (MBR) and Guaranteed Bit Rate (GBR), for uplink and downlink
respectively. The additional parameters for Service Data Flows characterized
by a non-GBR bearers are: Maximum Bit Rate (MBR), for uplink and downlink,
respectively.
3\. The PCRF requests the Policy and Charging Enforcement Function (PCEF) to
assign the set of QoS parameters to the Service Data Flow through a PCC rule.
Additionally the PCRF may request the PCEF to assign for all non-GBR bearers
an APN Aggregated MBR (APN AMBR). The PCEF applies the PCC rule(s) to a
Service Data Flow by mapping the associated traffic to an existing bearer or
by establishing and mapping the traffic to a dedicated bearer (or bearers)
between the UE and the PCEF. This includes sending a bearer setup request or a
bearer modification request to the RAN to set up or modify Radio Bearer(s) in
accordance with the QoS parameters. The PCEF is located in the Packet Data
Network Gateway (PDN-GW), a.k.a. PGW.
\- When reserving radio resources, the RAN may also take into account the
possible bandwidth savings caused by speech pauses and Robust Header
Compression (ROHC). This is not handled by the PCC specifications.
4\. The PGW monitors the RTP media traffic and the RTCP traffic, and enforces
compliance to APN-MBR rates for non-GBR bearers by dropping packets that
exceed the limit when needed. For GBR bearers the enforcement of the downlink
MBR is in PGW and uplink MBR in the RAN. The PGW also enforces the downlink
and uplink MBR per Service Data Flow.
If a non-GBR bearer was requested and if RAN can set up/modify a Radio Bearer
with the requested QoS parameter then the RAN does not reserve dedicated
resources for the bearer, i.e. the available bandwidth of the radio bearer can
be below the MBR and vary over time without any notification from the RAN to
the PGW.
If a GBR bearer was requested and if RAN can set up/modify a Radio Bearer with
the requested QoS parameters then it is expected that RAN reserves dedicated
resources for the bearer based on the requested GBR. If MBR for a bearer is
greater than GBR, the available bandwidth for the bearer, for bitrates greater
than GBR and up to the requested MBR, is not guaranteed, i.e. the available
bandwidth of the radio bearer can be between the GBR and MBR and vary over
time without any notification from the RAN to the PGW.
If the RAN cannot set up/modify a Radio Bearer then the bearer
setup/modification request will be rejected. The PCRF may inform the P-CSCF
that resources to be associated to the Service Data Flow could not be
allocated. The P-CSCF takes action on the SIP session.
A QoS aware terminal will detect if the available bearer resources (as
indicated via GBR and MBR values) for a Service Data Flow are lower than the
total bandwidth for media and RTCP as indicated in SDP. The terminal will then
start a new SDP offer/answer to update the media according to the available
resources, see also TS 26.114 [3] clause 6.2.7.
## 5.2 Simple SDP negotiation and bearer setup
The description below provides more details on the handling session setup
negotiation and the corresponding bearer allocation for the simple voice-only
case.
It is in this case assumed that RAN will set up a MBR=GBR bearer.
The SDP negotiation between the UEs uses the following SDP offer and SDP
answer examples:
Table 5.2-1: Example SDP offer/answer for the session setup for a simple
narrow-band\ voice-only VoLTE call (IPv6)
+----------------------------------------------------------------+ | SDP offer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 98 | | | | b=AS:38 | | | | b=RS:0 | | | | b=RR:2000 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=rtpmap:98 AMR/8000/1 | | | | a=fmtp:98 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+ | SDP answer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 | | | | b=AS:38 | | | | b=RS:0 | | | | b=RR:2000 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+
This means that both clients want to receive 38 kbps RTP media (including 24
kbps for IPv6/UDP/RTP overhead). They also agree on using RS+RR = 2 kbps for
RTCP for the RTP session which means 1 kbps per UE since both UEs will be
active senders and the RTCP bandwidth is then divided equally between the UEs.
This means that each client is prepared to receive 39 kbps (38 kbps for media
and 1 kbps for RTCP).
The PCRF will however allocate RS+RR = 2 kbps for the RTCP bandwidth, both for
uplink and downlink. The radio bearers will therefore be set up with
(resulting in no additional resource allocation to allow for redundancy
transmission):
\- MBR-UL = GBR-UL = 40 kbps (38 kbps for media and 2 kbps for RTCP)
\- MBR-DL = GBR-DL = 40 kbps
## 5.3 Other system aspects
The following is not considered in this study:
\- RTCP bandwidth allocation, since this would either scale the bandwidths
with a fixed percentage, e.g. adding 5 %, or would add a fixed offset, e.g. 2
kbps.
\- ROHC usage, since ROHC is only used between the UE and the eNodeB and the
usage is not known on the application layer and therefore does not change the
bandwidth values expressed with the b=AS bandwidth modifiers.
# 6 Use cases
## 6.1 General description
This study describes various use cases ranging from relatively simple use
cases to more complex use cases. The simple use cases include only one or a
few fixed-rate codecs while the more complex use cases include rate-adaptive
codecs. The simple use cases are included for the purpose of discussing one
issue at a time, even though these use cases may not be the most realistic for
real deployments since it is not realistic to assume that all codecs will be
allowed in all types of access networks. For example, it is unlikely that the
PCM codec will be allowed in LTE or HSPA RAN due to the relatively high
bitrate, and there can be an operator policy that removes this codec. However,
the main issue in this study is not what exact bitrates are required for
certain codecs but rather what happens if several codecs (or configurations)
are being offered with different bitrates.
The present document uses the terminology MBR and GBR instead of Max-
Requested-Bandwidth-UL/-DL used by the AF, Max_DR_UL/_DL and Gua_DR_UL/_DL
used by the PCRF, and Maximum Authorized Bandwidth UL/DL and Guaranteed
Authorized Data Rate UL/DL used by the PCEF, respectively. This is done to
improve the readability.
## 6.2 Use case A: Single fixed-rate speech codec
### 6.2.1 General description
Alice and Bob are setting up a voice-only session. Both UEs support only the
A-law PCM (64 kbps) codec. Both UEs use 20 ms frame lengths and encapsulate
only 1 frame in each packet. Alice sends the SDP offer and Bob sends the SDP
answer as shown below.
Table 6.2.1-1: SDP offer/answer for single codec
+-------------------------+ | SDP offer | +-------------------------+ | m=audio 46000 RTP/AVP 8 | | | | b=AS:88 | | | | a=rtpmap:8 PCMA/8000/1 | | | | a=ptime:20 | | | | a=maxptime:20 | +-------------------------+ | SDP answer | +-------------------------+ | m=audio 46002 RTP/AVP 8 | | | | b=AS:88 | | | | a=rtpmap:8 PCMA/8000/1 | | | | a=ptime:20 | | | | a=maxptime:20 | +-------------------------+
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive 88 kbps (64 kbps for the PCM encoding of the
media + 24 kbps for IPv6/UDP/RTP overhead).
\- UE-A will send 88 kbps.
\- UE-B (Bob) wants to receive 88 kbps.
\- UE-B will send 88 kbps.
\- Rate adaptation is not possible.
\- It is not possible to adapt the packetization because:
\- The bandwidth is limited to 88 kbps. Given that the codec needs 64 kbps
this means that the IP/UDP/RTP overhead can be no more than 24 kbps, which
corresponds to max 50 packets per second. This means that the packetization is
at least 20 ms.
\- However, the \'maxptime\' parameter limits the packetization to max 20 ms
per packet.
\- Hence the only option is to use exactly 20 ms per packet.
The Application Functions uses mapping rules to derive the session information
from the SDP offer and the SDP answer:
\- In IMS-A:
\- UE-A max send rate is 88 kbps.
\- UE-A min send rate is 88 kbps.
\- UE-A max receive rate is 88 kbps.
\- UE-A min receive rate is 88 kbps.
\- In IMS-B:
\- UE-B max send rate is 88 kbps.
\- UE-B min send rate is 88 kbps.
\- UE-B max receive rate is 88 kbps
\- UE-B min receive rate is 88 kbps
The AF sends these parameters together with the remaining media-related
information to the PCRF.
The PCRFs then uses the session information, and possibly also the remaining
media-related information to determine the following QoS parameters for each
local radio network:
Table 6.2.1-2: QoS parameters determined by the PCRF
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 88 kbps
MBR-DL~B~ 88 kbps GBR-UL~A~ 88 kbps GBR-DL~B~ 88 kbps B->A MBR-DL~A~ 88 kbps
MBR-UL~B~ 88 kbps GBR-DL~A~ 88 kbps GBR-UL~B~ 88 kbps
* * *
In this case, the two RANs only have the option to allocate MBR=GBR bearers
since the codec does not support rate adaptation, since the \'maxptime\'
parameter prevents encapsulating more frames in the packet and since the
bandwidths offered with b=AS prevent higher packet rates than 50 packets per
second.
### 6.2.2 Gap analysis
Comparing the UEs send rates with the QoS parameters gives:
Table 6.2.2-1: Comparison between media bitrate and QoS parameters
+-----------+------------+--------------+--------------+--------------+ | Direction | Media rate | QoS | QoS | Gap | | | | parameters A | parameters B | | +-----------+------------+--------------+--------------+--------------+ | A->B | 88 kbps | MBR-UL~A~=88 | MBR-DL~B~=88 | None, | | | | kbps | kbps | bearers | | | | | | optimally | | | | GBR-UL~A~=88 | GBR-DL~B~=88 | allocated | | | | kbps | kbps | | +-----------+------------+--------------+--------------+--------------+ | B->A | 88 kbps | MBR-DL~A~=88 | MBR-UL~B~=88 | None, | | | | kbps | kbps | bearers | | | | | | optimally | | | | GBR-DL~A~=88 | GBR-UL~B~=88 | allocated | | | | kbps | kbps | | +-----------+------------+--------------+--------------+--------------+
In this case, no issues are found.
## 6.3 Use case B: Several fixed-rate speech codecs
Editor\'s note: The identified issues should be proven also with more
realistic use cases.
Editor\'s note: At SA4#76 it was discussed that TS 24.229 Annex L requires
that MTSI clients shall be QoS aware (see MTSI report in S4-131311). However,
this requirement seems to apply only to the case when one set up EPS bearers,
i.e. when using EPC, which is used for LTE. MTSI clients can also use other
RATs than LTE may use a different Core Network, or even fixed access, in which
case Annex L would not apply. Annex L defines that the UE shall be QoS aware.
Annex B defines similar procedures and requirements for UTRAN and GPRS.
### 6.3.1 General description
#### 6.3.1.1 Overview
Alice and Bob are setting up a voice-only session. Both UEs support 3
different codecs, A-law PCM (64 kbps), μ-law PCM (64 kbps) and G.729 (8 kbps).
Alice sends the SDP offer as shown below which includes all three codecs. UE-B
accepts only one codec. If UE-B accepts to use either A-law PCM or μ-law PCM
then this gives the same session and bearer setup as shown above for Use case
A. This case is therefore not considered any further below. If UE-B accepts to
use the G.729 codec then UE-B sends the SDP answer as shown below.
It should be noted that the G.729 codec has a 10 ms frame length.
Table 6.3.1.1-1: First SDP offer and SDP answer for use case B.
+------------------------------+ | SDP offer | +------------------------------+ | m=audio 46000 RTP/AVP 8 0 18 | | | | b=AS:88 | | | | a=rtpmap:0 PCMU/8000/1 | | | | a=rtpmap:8 PCMA/8000/1 | | | | a=rtpmap:18 G729/8000/1 | | | | a=ptime:20 | | | | a=maxptime:80 | +------------------------------+ | SDP answer | +------------------------------+ | m=audio 46002 RTP/AVP 18 | | | | b=AS:32 | | | | a=rtpmap:18 G729/8000/1 | | | | a=ptime:20 | | | | a=maxptime:80 | +------------------------------+
This means that Alice is limited to send max 32 kbps and Bob is limited to
send max 88 kbps.
#### 6.3.1.2 SDP impacts on media handling
For the media handling in the UEs, the SDP offer/answer negotiation means for
the A->B direction:
\- UE-A can send max 32 kbps because of the limitation to 32 kbps in the SDP
answer.
\- The media encoding needs 8 kbps which means that the IPv6/UDP/RTP overhead
is limited to max 24 kbps, which is achieved for 50 packets per second (two 10
ms frames per packet = 20 ms per packet).
\- This should be regarded as the normal packetization scheme.
\- The IPv6/UDP/RTP overhead can be reduced if the packet rate is reduced.
This gives a few possible variants, for example (but not limited to):
\- Send 4 non-redundant frames (= 40 ms) in each packet. This gives a packet
rate of 25 packets per second and an IPv6/UDP/RTP overhead of 12 kbps. This
leaves 12 kbps for redundancy transmission (max 150 % redundancy). However,
the \'maxptime\' parameter prevents using this amount of redundancy. With
\'maxptime\' set to 80 it is only possible to include 40 ms of redundant
frames in each packet (8 kbps), which gives a redundancy level of 100 %. As
such, the total bandwidth becomes 28 kbps.
\- Send 6 non-redundant frames (= 60 ms) in each packet. This gives a packet
rate of 16.67 packets per second and an IPv6/UDP/RTP overhead of 8 kbps. This
leaves 16 kbps for redundancy transmission (max 200 % redundancy). However,
the \'maxptime\' parameter prevents using this amount of redundancy. With
\'maxptime\' set to 80 it is only possible to include 20 ms of redundant
frames in each packet (2.67 kbps), which gives a redundancy level of 33.33 %.
As such, the total bandwidth becomes 18.67 kbps.
\- The lowest possible bandwidth is achieved when sending 8 non-redundant
frames (80 ms) in the packets. This reduces the IPv6/UDP/RTP overhead to 6
kbps and the total bandwidth becomes 14 kbps.
\- This would leave 18 kbps that could be used for redundancy. However, the
\'maxptime\' parameter prevents adding redundant frames to the packets.
\- When the UE is not adapting, then the bandwidth will be 32 kbps.
\- When the UE is adapting, then the bandwidth can be anything between 14 and
32 kbps. The bandwidth is upwards limited by b=AS in the SDP answer and
downwards limited by the \'maxptime\' parameter.
For the B->A direction there are more possibilities:
\- UE-B can send 1 frame in the packet which gives 100 packets per second.
Such packetization would give an IPv6/UDP/RTP overhead of 48 kbps and the
total bitrate would be 56 kbps, assuming that no redundancy is used.
\- UE-B could use the remaining 32 kbps for redundancy and send 1 original
frame and 4 redundant frames in the packets, while still sending 100 packets
per second. This means a maximum redundancy of 400 %.
\- If UE-B limits the packet rate to 50 packets per second then it could send
up to 64 kbps media without exceeding the 88 kbps limit. However, since the
\'maxptime\' parameter is 80 ms then this allows sending only 8 frames in the
packet out of which 2 frames are original frames. This leaves 6 redundant
frames per packet which gives a redundancy level of 300 %. This gives a
maximum media bandwidth of 32 kbps, an IPv6/UDP/RTP overhead of 24 kbps and a
total maximum bandwidth of 56 kbps.
\- With a larger \'maxptime\' value the UE-B could use up to 700 % redundancy
(56 kbps) without exceeding the 88 kbps bandwidth limit while still keeping a
packet rate of 50 packets per second, but this would require a \'maxptime\'
value of 160 ms (2 non-redundant frames and 14 redundant frames, 10 ms each).
\- With the \'maxptime\' parameter set to 240 ms, as recommended in TS 26.114,
then further variants are possible.
\- The lowest bitrate that UE-B could achieve is when encapsulating 8 non-
redundant frames in the packets. Such encapsulation would reduce the
IPv6/UDP/RTP overhead to 6 kbps and the total bitrate would be 14 kbps.
\- When the UE is not adapting, then the bandwidth will be 32 kbps.
\- When the UE is adapting, then the bandwidth can be anything between 14 and
88 kbps.
#### 6.3.1.3 Bearer allocation based on first SDP offer/answer
All these possibilities mean that the PCRF have many different options to
consider when determining the session information parameters, but the two most
probable options are likely:
\- Option 1: Assume that the session will be asymmetric with max 32 kbps in
the A->B direction and max 88 kbps in the B->A direction.
\- According to TS 29.213, clause 6.2, the P-CSCF will select Max-Requested-
Bandwidth-UL according to b=AS in the SDP offer and Max-Requested-Bandwidth-DL
according to b=AS in the SDP answer, but for other AFs this is only a
recommendation.
\- The PCRF may still also override these values.
\- The use of b=AS in the resource reservation may lead to asymmetric bearers.
\- Option 2: Assume that the session will be symmetric with max 32 kbps in
both directions.
\- According to TS 29.213, clause 6.3, the PCRF prefers to select Max-
Requested-Bandwidth-UL/DL based on the codec-specific algorithm for the codec
for which the codec specific algorithm exist, regardless of how MBR UL/DL was
set by the AF.
\- The use of codec specific algorithm in the resource reservation leads to
symmetric bearers.
For the minimum bandwidth, the PCRFs could set this to anything from 14 kbps
up to 32 kbps for A->B direction and anything from 14 kbps up to either 32 or
88 kbps for the B->A direction, depending on whether the PCRFs choose option 1
or option 2. The PCRF however selects one single value for the minimum
bandwidth. This value needs to be derived from codec specific algorithms or
from operator policies since there is no information in the SDP that tells
what the UEs plan to use.
Editor\'s note: The discussion below related to b=TIAS and a=maxprate [10]
identifies a potential solutions which should be further evaluated in Clause
8. However, there may be networks that do not understand b=TIAS.
It should be noted that there is nothing in the SDPs that show how much
redundancy the UEs are allowed to use or how much they plan to use. There is
also no information about whether they plan to send 100 packets per second, 50
packets per second or something else. The \'ptime\' parameter is only a
recommendation and the \'maxprate\' parameter defined in RFC 3890 is not used
in TS 26.114. However, TS 24.229 has defined the b=TIAS bandwidth modifier and
the \'maxprate\' parameter as optional SDP parameters. A client specification
could introduce limitations on what the clients are allowed to do, for example
how much redundancy that is allowed, but the AFs would then have to rely on
other mechanisms like a feature tag, or similar, to determine which
specification the UE follows (if any).
If both AFs choose option 1 then the PCRFs would set the Authorized IP QoS
parameters to (the PCRF has to choose one single value but the tables indicate
the range that could be considered):
Table 6.3.1.3-1: Bearer allocation when both networks do resource reservation
according to option 1
* * *
Direction QoS parameters A (asymmetric) Rate QoS parameters B (asymmetric)
Rate A->B MBR-UL~A~ 32 kbps MBR-DL~B~ 32 kbps GBR-UL~A~ 14-32 kbps GBR-DL~B~
14-32 kbps B->A MBR-DL~A~ 88 kbps MBR-UL~B~ 88 kbps GBR-DL~A~ 14-88 kbps GBR-
UL~B~ 14-88 kbps
* * *
If both AFs choose option 2 then the PCRFs would set the QoS parameters to:
Table 6.3.1.3-2: Bearer allocation when both networks do resource reservation
according to option 2
* * *
Direction QoS parameters A (symmetric) Rate QoS parameters B (symmetric) Rate
A->B MBR-UL~A~ 32 kbps MBR-DL~B~ 32 kbps GBR-UL~A~ 14-32 kbps GBR-DL~B~ 14-32
kbps B->A MBR-DL~A~ 32 kbps MBR-UL~B~ 32 kbps GBR-DL~A~ 14-32 kbps GBR-UL~B~
14-32 kbps
* * *
Another possibility is that the AF in IMS-A chooses option 1 while the AF in
IMS-B chooses option 2. The respective PCRFs would set the QoS parameters to:
Table 6.3.1.3-3: Bearer allocation when network A does resource reservation
according to option 1 and network B does resource reservation according to
option 2
* * *
Direction QoS parameters A (asymmetric) Rate QoS parameters B (symmetric) Rate
A->B MBR-UL~A~ 32 kbps MBR-DL~B~ 32 kbps GBR-UL~A~ 14-32 kbps GBR-DL~B~ 14-32
kbps B->A MBR-DL~A~ 88 kbps MBR-UL~B~ 32 kbps GBR-DL~A~ 14-88 kbps GBR-UL~B~
14-32 kbps
* * *
Correspondingly, if the AF in IMS-A chooses option 2 and the AF in IMS-B
chooses option 1 then the respective PCRFs would set the QoS parameters to:
Table 6.3.1.3-4: Bearer allocation when network A does resource reservation
according to option 2 and network B does resource reservation according to
option 1
* * *
Direction QoS parameters A (symmetric) Rate QoS parameters B (asymmetric) Rate
A->B MBR-UL~A~ 32 kbps MBR-DL~B~ 32 kbps GBR-UL~A~ 14-32 kbps GBR-DL~B~ 14-32
kbps B->A MBR-DL~A~ 32 kbps MBR-UL~B~ 88 kbps GBR-DL~A~ 14-32 kbps GBR-UL~B~
14-88 kbps
* * *
Since local resource reservation is used in IMS this means that the RAN in
network A allocates bearers according to the PCRF-A\'s request, and that RAN
in network B allocates bearers according to PCRF-B\'s request.
When RAN allocates the bearers then it is expected to use:
\- If an MBR=GBR bearer is allocated:
\- MBR-UL = MBR-UL for RAN A and B, respectively.
\- MBR-DL = MBR-DL for RAN A and B, respectively.
\- GBR-UL = MBR-UL for RAN A and B, respectively.
\- GBR-DL = MBR-DL for RAN A and B, respectively.
\- If an MBR>GBR bearer is allocated:
\- MBR-UL = MBR-UL for RAN A and B, respectively.
\- MBR-DL = MBR-DL for RAN A and B, respectively.
\- GBR-UL = GBR-UL for RAN A and B, respectively.
\- GBR-DL = GBR-DL for RAN A and B, respectively.
#### 6.3.1.4 Bearer allocation based on second SDP offer/answer
Editor\'s note: Sending a second SDP offer/answer is a potential solution and
should also be discussed in Clause 8.
One of the identified potential solutions is that UE-A sends a second SDP
offer/answer with only the selected codec. This allows UE-A to modify the
bandwidth that she is willing to receive, see example below. This solution is
already used in TS 26.114 clause 6.2.7 to align the media bandwidth for the
receiving direction with the downlink QoS parameters. It is investigated here
if the solution can also be used to align the media bandwidth for the sending
direction with the uplink QoS parameters.
Table 6.3.1.4-1: Second SDP offer and SDP answer for use case B
+--------------------------+ | Second SDP offer | +--------------------------+ | m=audio 46000 RTP/AVP 18 | | | | b=AS:32 | | | | a=rtpmap:18 G729/8000/1 | | | | a=ptime:20 | | | | a=maxptime:80 | +--------------------------+ | Second SDP answer | +--------------------------+ | m=audio 46002 RTP/AVP 18 | | | | b=AS:32 | | | | a=rtpmap:18 G729/8000/1 | | | | a=ptime:20 | | | | a=maxptime:80 | +--------------------------+
This would mean that both Alice and Bob will be limited to sending max 32
kbps.
It is also expected that the AFs will set the Max-Requested-Bandwidth to 32
kbps, for both UL and DL. Correspondingly, both PCRFs will also set the MBR-UL
and MBR-DL parameters to 32 kbps.
For the setting of GBR-UL and GBR-DL parameters the PCRF still need to rely on
operator policies or codec-specific algorithms since the second SDP
offer/answer still does not include any information about the minimum bitrate
that the clients want when receiving or plan to use when sending.
If the MTSI client is QoS aware then it will know how GBR-UL/DL is set for the
local access, but there is no mechanisms available in SDP that the MTSI client
could use to inform the remote client about the local settings. This may have
consequences for the adaptation. One example is when the local QoS parameters
are sets to MBR=32 kbps and GBR=14 kbps while the remote RAN has allocated a
bearer with MBR=GBR=32 kbps. If congestion occurs in the local downlink then
the remote client has no way of knowing how it should adapt to reduce/remove
the congestion.
### 6.3.2 Gap analysis after 1st SDP offer/answer
#### 6.3.2.1 Common
The media rate (UE send rate) shown in the tables below is determined from the
information in the SDPs. The case when the client uses also the QoS parameters
for the UL bearer to limit the sending rate is commented below the tables,
where needed.
The tables below indicate the bitrate range that can be considered for GBR.
The PCRF chooses one value within this range.
The Gap analysis consists of separate analyses for Network A and Network B,
Gap A and Gap B, respectively. It is judged whether the QoS parameter is
optimal, over-allocated or under-allocated with respect to the local access.
An end-to-end Gap analysis is also made, Gap AB, with the following rules:
\- If either Gap A or Gap B shows \'under-allocation\', then Gap AB becomes
\'under-allocation\', regardless of the other Gap.
\- If both Gaps show \'optimal\', then Gap AB becomes \'optimal\'.
\- If one Gap shows \'over-allocation\' and the other shows \'optimal\' then
Gap AB becomes \'over-allocation\'.
#### 6.3.2.2 IMS-A chooses Option 1; IMS-B chooses Option 1
Comparing the UEs send rates with the QoS parameters when both RANs set up
bearers according to option 1 gives:
Table 6.3.2.2-1: Gap analysis when both networks do resource reservation
according to option 1
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A\ | | B\ | | | | | | | (a | | (a | | | | | | | symme | | symme | | | | | | | tric) | | tric) | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-UL~ | timal | R-DL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-U | | GBR-D | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B1 | B->A | 14-32 | MB | Over- | MB | Over- | Over- | | | | kbps | R-DL~ | alloc | R-UL~ | alloc | alloc | | | 50 | | A~=88 | ation | B~=88 | ation | ation | | | p | | kbps | | kbps | | | | | acket | | | Over- | | Over- | Over- | | | s/sec | | GBR-D | alloc | GBR-U | alloc | alloc | | | | | L~A~= | ation | L~B~= | ation | ation | | | No | | 14-88 | | 14-88 | | | | | redun | | kbps | | kbps | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B2 | B->A | 14-56 | MB | Over- | MB | Over- | Over- | | | | kbps | R-DL~ | alloc | R-UL~ | alloc | alloc | | | 100 | | A~=88 | ation | B~=88 | ation | ation | | | p | | kbps | | kbps | | | | | acket | | | Over- | | Over- | Over- | | | s/sec | | GBR-D | alloc | GBR-U | alloc | alloc | | | | | L~A~= | ation | L~B~= | ation | ation | | | No | | 14-88 | | 14-88 | | | | | redun | | kbps | | kbps | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B3 | B->A | 14-56 | MB | Over- | MB | Over- | Over- | | | | kbps | R-DL~ | alloc | R-UL~ | alloc | alloc | | | 50 | | A~=88 | ation | B~=88 | ation | ation | | | p | | kbps | | kbps | | | | | acket | | | Over- | | Over- | Over- | | | s/sec | | GBR-D | alloc | GBR-U | alloc | alloc | | | | | L~A~= | ation | L~B~= | ation | ation | | | Up to | | 14-88 | | 14-88 | | | | | 300 % | | kbps | | kbps | | | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B4 | B->A | 14-88 | MB | Op | MB | Op | Op | | | | kbps | R-DL~ | timal | R-UL~ | timal | timal | | | 100 | | A~=88 | | B~=88 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-D | | GBR-U | | | | | | | L~A~= | | L~B~= | | | | | Up to | | 14-88 | | 14-88 | | | | | 400 % | | kbps | | kbps | | | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+
Knowledge about the QoS parameters for the bearers does not solve the over-
allocation (case B1, B2, B3) because the bearers in the B->A direction are
allocated based on what UE-A declares that it is capable of receiving when
sending the SDP offer to UE-B, and there is no information about what bitrate
UE-B wants to send in the SDP answer that UE-B sends to UE-A.
In general, over-allocation cannot be solved by the knowing the QoS parameters
in the client. This can only be solved by providing more information from the
clients to the network, which is not included in the 1st offer-answer.
#### 6.3.2.3 IMS-A chooses Option 2; IMS-B chooses Option 2
Comparing the UEs send rates with the QoS parameters when both RANs set up
bearers according to option 2 gives:
Table 6.3.2.3-1: Gap analysis when both networks do resource reservation
according to option 2
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A\ | | B\ | | | | | | | ( | | ( | | | | | | | symme | | symme | | | | | | | tric) | | tric) | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-UL~ | timal | R-DL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-U | | GBR-D | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B1 | B->A | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-DL~ | timal | R-UL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-D | | GBR-U | | | | | | | L~A~= | | L~B~= | | | | | No | | 14-32 | | 14-32 | | | | | redun | | kbps | | kbps | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B2 | B->A | 14-56 | MB | U | MB | U | U | | | | kbps | R-DL~ | nder- | R-UL~ | nder- | nder- | | | 100 | | A~=32 | alloc | B~=32 | alloc | alloc | | | p | | kbps | ation | kbps | ation | ation | | | acket | | | | | | | | | s/sec | | GBR-D | U | GBR-U | U | U | | | | | L~A~= | nder- | L~B~= | nder- | nder- | | | No | | 14-32 | alloc | 14-32 | alloc | alloc | | | redun | | kbps | ation | kbps | ation | ation | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B3 | B->A | 14-56 | MB | U | MB | U | U | | | | kbps | R-DL~ | nder- | R-UL~ | nder- | nder- | | | 50 | | A~=32 | alloc | B~=32 | alloc | alloc | | | p | | kbps | ation | kbps | ation | ation | | | acket | | | | | | | | | s/sec | | GBR-D | U | GBR-U | U | U | | | | | L~A~= | nder- | L~B~= | nder- | nder- | | | Up to | | 14-32 | alloc | 14-32 | alloc | alloc | | | 300 % | | kbps | ation | kbps | ation | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B4 | B->A | 14-88 | MB | U | MB | U | U | | | | kbps | R-DL~ | nder- | R-UL~ | nder- | nder- | | | 100 | | A~=32 | alloc | B~=32 | alloc | alloc | | | p | | kbps | ation | kbps | ation | ation | | | acket | | | | | | | | | s/sec | | GBR-D | U | GBR-U | U | U | | | | | L~A~= | nder- | L~B~= | nder- | nder- | | | Up to | | 14-32 | alloc | 14-32 | alloc | alloc | | | 400 % | | kbps | ation | kbps | ation | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+
By knowing the QoS parameters for the bearers a client could handle the issues
with under-allocation (case B2, B3, B4) in the local network (network A for
UE-A and network B for UE-B, respectively). In this case, handling the under-
allocation in one network also handles the under-allocation in the other
network because the QoS parameters for RAN-A are the same as in RAN-B.
However, in the general case, a client cannot handle under-allocation
occurring in the remote network since it does not know how the bearers in the
remote network are set up.
It should be noted that, according to TS 24.229 Annex L [13], a UE using LTE
access is required to be QoS aware. An MTSI client in such a UE could then get
the information about the local QoS parameters if cross-layer communication is
used. However, there is no requirement in for example TS 26.114 that an API
for cross-layer communication does exist.
#### 6.3.2.4 IMS-A chooses Option 1; IMS-B chooses Option 2
Comparing the UEs send rates with the QoS parameters when RAN-A set up bearers
according to option 1 and RAN-B set up bearers according to option 2 gives:
Table 6.3.2.4-1: Gap analysis when network A does resource reservation
according to option 1 and network B does resource reservation according to
option 2
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A\ | | B\ | | | | | | | (a | | ( | | | | | | | symme | | symme | | | | | | | tric) | | tric) | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-UL~ | timal | R-DL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-U | | GBR-D | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B1 | B->A | 14-32 | MB | Over- | MB | Op | Over- | | | | kbps | R-DL~ | alloc | R-UL~ | timal | alloc | | | 50 | | A~=88 | ation | B~=32 | | ation | | | p | | kbps | | kbps | Op | | | | acket | | | Over- | | timal | Over- | | | s/sec | | GBR-D | alloc | GBR-U | | alloc | | | | | L~A~= | ation | L~B~= | | ation | | | No | | 14-88 | | 14-32 | | | | | redun | | kbps | | kbps | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B2 | B->A | 14-56 | MB | Over- | MB | U | U | | | | kbps | R-DL~ | alloc | R-UL~ | nder- | nder- | | | 100 | | A~=88 | ation | B~=32 | alloc | alloc | | | p | | kbps | | kbps | ation | ation | | | acket | | | Over- | | | | | | s/sec | | GBR-D | alloc | GBR-U | U | U | | | | | L~A~= | ation | L~B~= | nder- | nder- | | | No | | 14-88 | | 14-32 | alloc | alloc | | | redun | | kbps | | kbps | ation | ation | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B3 | B->A | 14-56 | MB | Over- | MB | U | U | | | | kbps | R-DL~ | alloc | R-UL~ | nder- | nder- | | | 50 | | A~=88 | ation | B~=32 | alloc | alloc | | | p | | kbps | | kbps | ation | ation | | | acket | | | Over- | | | | | | s/sec | | GBR-D | alloc | GBR-U | U | U | | | | | L~A~= | ation | L~B~= | nder- | nder- | | | Up to | | 14-88 | | 14-32 | alloc | alloc | | | 300 % | | kbps | | kbps | ation | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B4 | B->A | 14-88 | MB | Op | MB | U | U | | | | kbps | R-DL~ | timal | R-UL~ | nder- | nder- | | | 100 | | A~=88 | | B~=32 | alloc | alloc | | | p | | kbps | Op | kbps | ation | ation | | | acket | | | timal | | | | | | s/sec | | GBR-D | | GBR-U | U | U | | | | | L~A~= | | L~B~= | nder- | nder- | | | Up to | | 14-88 | | 14-32 | alloc | alloc | | | 400 % | | kbps | | kbps | ation | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+
If the VoIP client in UE-B knows the QoS parameters for the bearer then the
client can handle the under-allocation in RAN-B (case B2, B3, B4).
However, UE-B cannot solve the over-allocation in RAN-A (case B2, B3, B4)
since UE-B does not have any knowledge about the QoS parameters for UE-A. The
only way to solve this is if UE-B provides information about how much it plans
to send, so that IMS-A can make a more accurate resource reservation.
Editor\'s note: The discussion above about providing information about the
sending rate identifies a potential solution which should be further evaluated
in Clause 8.
#### 6.3.2.5 IMS-A chooses Option 2; IMS-B chooses Option 1
Comparing the UEs send rates with the QoS parameters when RAN-A set up bearers
according to option 2 and RAN-B set up bearers according to option 1 gives:
Table 6.3.2.5-1: Gap analysis when network A does resource reservation
according to option 2 and network B does resource reservation according to
option 1
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A\ | | B\ | | | | | | | ( | | (a | | | | | | | symme | | symme | | | | | | | tric) | | tric) | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-UL~ | timal | R-DL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-U | | GBR-D | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B1 | B->A | 14-32 | MB | Op | MB | Over- | Over- | | | | kbps | R-DL~ | timal | R-UL~ | alloc | alloc | | | 50 | | A~=32 | | B~=88 | ation | ation | | | p | | kbps | Op | kbps | | | | | acket | | | timal | | Over- | Over- | | | s/sec | | GBR-D | | GBR-U | alloc | alloc | | | | | L~A~= | | L~B~= | ation | ation | | | No | | 14-32 | | 14-88 | | | | | redun | | kbps | | kbps | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B2 | B->A | 14-56 | MB | U | MB | Over- | U | | | | kbps | R-DL~ | nder- | R-UL~ | alloc | nder- | | | 100 | | A~=32 | alloc | B~=88 | ation | alloc | | | p | | kbps | ation | kbps | | ation | | | acket | | | | | Over- | | | | s/sec | | GBR-D | U | GBR-U | alloc | U | | | | | L~A~= | nder- | L~B~= | ation | nder- | | | No | | 14-32 | alloc | 14-88 | | alloc | | | redun | | kbps | ation | kbps | | ation | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B3 | B->A | 14-56 | MB | U | MB | Over- | U | | | | kbps | R-DL~ | nder- | R-UL~ | alloc | nder- | | | 50 | | A~=32 | alloc | B~=88 | ation | alloc | | | p | | kbps | ation | kbps | | ation | | | acket | | | | | Over- | | | | s/sec | | GBR-D | U | GBR-U | alloc | U | | | | | L~A~= | nder- | L~B~= | ation | nder- | | | Up to | | 14-32 | alloc | 14-88 | | alloc | | | 300 % | | kbps | ation | kbps | | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B4 | B->A | 14-88 | MB | U | MB | Op | U | | | | kbps | R-DL~ | nder- | R-UL~ | timal | nder- | | | 100 | | A~=32 | alloc | B~=88 | | alloc | | | p | | kbps | ation | kbps | Op | ation | | | acket | | | | | timal | | | | s/sec | | GBR-D | U | GBR-U | | U | | | | | L~A~= | nder- | L~B~= | | nder- | | | Up to | | 14-32 | alloc | 14-88 | | alloc | | | 400 % | | kbps | ation | kbps | | ation | | | redun | | | | | | | | | dancy | | | | | | | +----+-------+-------+-------+-------+-------+-------+-------+
If the VoIP client in UE-B knows the QoS parameters for the bearer then this
does not solve the problem with under-allocation in RAN-A (case B2, B3, B4)
since UE-B has no knowledge about the QoS parameters for UE-A. The problem
with over-allocation in RAN-B (case B1, B2, B3) can also not be solved by UE-B
because the allocation is based on what UE-A has declared in the SDP offer.
To solve the problem with under-allocation in RAN-A a second SDP offer/answer,
with only the selected codec, is required. This is further discussed in Clause
8.
#### 6.3.2.6 Root-cause analysis when b=AS is used for resource reservation
The use case description shows that when the SDP offer includes multiple
codecs with different bitrates and when one of the lower-rate codecs is chosen
for the session then this gives an ambiguity regarding how high bitrate UE-B
is allowed to send. The root cause for this is the reason that the SDP offer
only includes one single bandwidth value, which is set to support the offered
codec which requires the highest bandwidth.
There is no information in the SDP offer that limits how much redundancy UE-B
may use, except that according to RFC 4566 [8] and RFC 3264 [9] it is not
allowed to exceed the b=AS bandwidth and the \'maxptime\' value. In addition,
there is no information in the SDP answer about whether UE-B plans to use the
excessive bandwidth for redundancy, and how much.
The discussion in clauses 6.3.2.2 to 6.3.2.5 shows that both over-allocation
and under-allocation may occur in the B->A direction.
Over-allocation may occur if the resource reservation is based on the
bandwidth in the SDP offer when asymmetric session is assumed. Under-
allocation may occur if the resource reservation is based on the bandwidth in
the SDP answer when symmetric session is assumed. The reason for the
misalignment is that the SDPs don\'t include sufficient information to draw
the correct conclusions, especially about how high bandwidth the clients plan
to send.
Neither over-allocation nor under-allocation can be solved with only one
offer-answer but under-allocation occurring in the local network can be
handled if the client is QoS aware. Detection of over-allocation and/or under-
allocation in the local network can however be used to trigger a second offer-
answer negotiation including only the codec selected in the first offer-
answer. This is further discussed in clause 6.3.3.
A QoS-aware client can however not detect over-allocation or under-allocation
in the remote network so this cannot be used to trigger a second offer-answer.
#### 6.3.2.7 Root-cause analysis when codec-specific information is used for
resource reservation
If codec-specific information is used, e.g. based on TS 26.114 Annex E, then
it is likely that the session setup will result in the same bearer allocation
as if the resources were allocated based on the information in the SDP answer
(option 2). If both networks allocate resources this way then this leads to
symmetrically allocated bearers. However, since there are no mechanisms in SDP
that the clients can use to express their desired or required sending rate
then there is no way for the network to know if it was better to allocate
resources based on codec-specific information in the SDP offer and the SDP
answer than on b=AS in the SDP answer. In TS 29.213 it is defined that codec-
specific information takes precedence over the bandwidth offered with b=AS in
the SDP.
A QoS-aware client can align its transmission to the QoS parameters in the
local network also in this case but it can still not know if this is optimal
also for the remote network.
Editor\'s note: In comments received for the MTSI teleconference in November
it was argued that TS 26.114 Annex E should be updated if extra resources need
to be allocated for example for redundancy. These things are solutions and
should be discussed further in the appropriate section for this.
#### 6.3.2.8 Handling of over-allocation and under-allocation
Over-allocation in the network may not be a significant issue for the UEs but
it can lead to admitting fewer users, for example the number of simultaneous
voice calls the RAN will accept.
Under-allocation in the network is likely a severe problem for the UEs that
need to be handled, either by reducing the bitrate or by sending a new SIP
message so that the network performs a new resource reservation with the new
bitrate.
A UE that is QoS aware, as defined in TS 24.229 Annex B for UTRAN and GPRS or
in Annex L for E-UTRAN, will likely detect if under-allocation or over-
allocation has happened in the local network and is then expected to initiate
a new SDP offer-answer negotiation, see also TS 26.114 clause 6.2.7.
### 6.3.3 Gap analysis after 2nd SDP offer/answer
When the maximum bandwidth is limited to 32 kbps in both directions then this
gives the following Gap analysis.
Table 6.3.3-1: Gap analysis after second SDP offer-answer
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A | | B | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-UL~ | timal | R-DL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-U | | GBR-D | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+ | B | B->A | 14-32 | MB | Op | MB | Op | Op | | | | kbps | R-DL~ | timal | R-UL~ | timal | timal | | | 50 | | A~=32 | | B~=32 | | | | | p | | kbps | Op | kbps | Op | Op | | | acket | | | timal | | timal | timal | | | s/sec | | GBR-D | | GBR-U | | | | | | | L~A~= | | L~B~= | | | | | | | 14-32 | | 14-32 | | | | | | | kbps | | kbps | | | +----+-------+-------+-------+-------+-------+-------+-------+
It should be noted that the optimality indicated here refers only to the case
when both networks assign GBR equally. This would, for example, be the case
when both PCRFs use codec-specific algorithms that derive the GBR values from
the same table. When this is not the case, for example if the PCRFs would use
operator policies that are different, then there is no guarantee that Gap AB
will be \'optimal\' even if both Gap A and Gap B are \'optimal\'. This is
because the GBR value is selected from a range and different PCRFs may very
well choose different values.
It is here also assumed that UE-A and UE-B wants to use the selected codec in
the same way. If either UE would need to use for example redundancy then the
client can only indicate this for the receiving direction by assigning a
higher bandwidth for the b=AS value. This can lead to appropriate bearer
allocation in the downlink. For the bearer allocation in the uplink the client
will have to rely on the SDP that the remote client sends and that it asks for
receiving a higher bandwidth. However, since there are no SDP mechanisms that
a client can use to indicate to the remote client that it wants to or needs to
send with a larger bandwidth then the likelihood that the remote client will
ask for exactly the correct bandwidth that the local client wants to send is
probably quite low.
## 6.4 Use case C: Single multi-rate speech codec (AMR), no extra bandwidth
allocated for redundancy
### 6.4.1 General description
Alice and Bob are setting up a voice-only session. Both UEs support only the
AMR codec (4.75-12.2 kbps, all codec modes) but follows TS 26.114 and
therefore offers both bandwidth-efficient and octet-aligned. Both UEs propose
to encapsulate 1 frame in each packet but allows for up to 12 frames per
packet, out of which maximum 4 can be non-redundant frames. Alice sends the
SDP offer and Bob sends the SDP answer as shown below. Bob accepts using the
bandwidth-efficient payload format version.
Table 6.4.1-1: SDP offer-answer for use case C
+----------------------------------------------------------------+ | SDP offer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 98 | | | | b=AS:38 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=rtpmap:98 AMR/8000/1 | | | | a=fmtp:98 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+ | SDP answer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 | | | | b=AS:37 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive max 38 kbps.
\- UE-A will send max 37 kbps.
\- UE-B (Bob) wants to receive max 37 kbps.
\- UE-B will send max 38 kbps.
\- Adaptation is possible in three ways:
\- The AMR codec supports multiple codec modes between 4,75 kbps and 12,2 kbps
which mean that the clients can do bitrate adaptation. If a mode-set is
defined by the offer-answer then this may restrict the rate throughout to only
some codec modes and/or a portion of this range.
\- Frame aggregation is also possible since both clients declare that they can
receive up to 240 ms of media in each packet (a=maxptime:240).
\- Redundancy may also be used but both clients declare that they will not
send redundant frames that are older than 220 ms (max-red=220).
\- Since the UEs cannot inform the network or the other UE what minimum codec
mode it wants to send and/or receive or what packetization they plan to use
when sending or receiving, there is no guidance in the SDPs for how the IMS
networks should select the minimum bitrate that is required for the session.
The table below gives a few examples for how the bitrate changes with the
adaptation:
Table 6.4.1-2: Total bitrate as a function of codec mode and packetization
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | # | Codec | Pac | Redun | RTP | IP | RTP | P | Total | | | mode | ketiz | dancy | pa | v6/UD | p | acket | bi | | | | ation | level | yload | P/RTP | acket | rate | trate | | | [k | | | size | ove | size | | | | | bps] | [fr | [%] | | rhead | | [pac | [k | | | | ames/ | | [b | | [by | kets/ | bps] | | | | pac | | ytes/ | \ | tes] | sec | | | | | ket] | | pac | [byte | | ond] | | | | | | | ket] | s/pac | | | | | | | | | | ket] | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | 12.2 | 1 | 0 | 32 | 60 | 92 | 50 | 36.8 | | | | | | | | | | (NO | | | | | | | | | | TE 1) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | 4.75 | 1 | 0 | 14 | 60 | 74 | 50 | 29.6 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | 5.9 | 1 | 0 | 16 | 60 | 76 | 50 | 30.4 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | 4.75 | 2 | 0 | 26 | 60 | 86 | 25 | 17.2 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 4.75 | 4 | 0 | 51 | 60 | 111 | 12.5 | 11.1 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | 4.75 | 2 | 100 | 26 | 60 | 86 | 50 | 34.4 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | 5.9 | 2 | 100 | 32 | 60 | 92 | 50 | 36.8 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 5.9 | 2 | 100 | 33 | 60 | 93 | 50 | 37.2 | | | | | with | | | | | (NO | | | | | 1 | | | | | TE 2) | | | | | frame | | | | | | | | | | o | | | | | | | | | | ffset | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | 4.75 | 3 | 200 | 39 | 60 | 99 | 50 | 39.6 | | | | | | | | | | (NO | | | | | | | | | | TE 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | 5.9 | 3 | 200 | 47 | 60 | 107 | 50 | 42.8 | | | | | | | | | | (NO | | | | | | | | | | TE 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | 4.75 | 4 | 300 | 51 | 60 | 111 | 50 | 44.4 | | | | | | | | | | (NO | | | | | | | | | | TE 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | 5.9 | 4 | 300 | 63 | 60 | 123 | 50 | 49.2 | | | | | | | | | | (NO | | | | | | | | | | TE 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NOTE | | | | | | | | | | 1: | | | | | | | | | | This | | | | | | | | | | f | | | | | | | | | | ormat | | | | | | | | | | is | | | | | | | | | | exp | | | | | | | | | | ected | | | | | | | | | | to be | | | | | | | | | | used | | | | | | | | | | d | | | | | | | | | | uring | | | | | | | | | | n | | | | | | | | | | ormal | | | | | | | | | | oper | | | | | | | | | | ating | | | | | | | | | | c | | | | | | | | | | ondit | | | | | | | | | | ions, | | | | | | | | | | i.e. | | | | | | | | | | when | | | | | | | | | | no | | | | | | | | | | adapt | | | | | | | | | | ation | | | | | | | | | | is | | | | | | | | | | n | | | | | | | | | | eeded | | | | | | | | | | to | | | | | | | | | | h | | | | | | | | | | andle | | | | | | | | | | c | | | | | | | | | | onges | | | | | | | | | | tion, | | | | | | | | | | high | | | | | | | | | | p | | | | | | | | | | acket | | | | | | | | | | loss | | | | | | | | | | r | | | | | | | | | | ates, | | | | | | | | | | large | | | | | | | | | | j | | | | | | | | | | itter | | | | | | | | | | or | | | | | | | | | | other | | | | | | | | | | deg | | | | | | | | | | raded | | | | | | | | | | oper | | | | | | | | | | ating | | | | | | | | | | c | | | | | | | | | | ondit | | | | | | | | | | ions. | | | | | | | | | | | | | | | | | | | | NOTE | | | | | | | | | | 2: TS | | | | | | | | | | 2 | | | | | | | | | | 6.114 | | | | | | | | | | a | | | | | | | | | | llows | | | | | | | | | | for | | | | | | | | | | using | | | | | | | | | | up to | | | | | | | | | | 300 % | | | | | | | | | | r | | | | | | | | | | edund | | | | | | | | | | ancy, | | | | | | | | | | see | | | | | | | | | | TS | | | | | | | | | | 2 | | | | | | | | | | 6.114 | | | | | | | | | | c | | | | | | | | | | lause | | | | | | | | | | 9 | | | | | | | | | | .2.1, | | | | | | | | | | but | | | | | | | | | | it | | | | | | | | | | also | | | | | | | | | | recom | | | | | | | | | | mends | | | | | | | | | | red | | | | | | | | | | ucing | | | | | | | | | | the | | | | | | | | | | bi | | | | | | | | | | trate | | | | | | | | | | when | | | | | | | | | | a | | | | | | | | | | dding | | | | | | | | | | r | | | | | | | | | | edund | | | | | | | | | | ancy. | | | | | | | | | | The | | | | | | | | | | cl | | | | | | | | | | ients | | | | | | | | | | will | | | | | | | | | | also | | | | | | | | | | e | | | | | | | | | | nsure | | | | | | | | | | that | | | | | | | | | | the | | | | | | | | | | negot | | | | | | | | | | iated | | | | | | | | | | band | | | | | | | | | | width | | | | | | | | | | is | | | | | | | | | | not | | | | | | | | | | exc | | | | | | | | | | eeded | | | | | | | | | | when | | | | | | | | | | using | | | | | | | | | | r | | | | | | | | | | edund | | | | | | | | | | ancy. | | | | | | | | | | To | | | | | | | | | | use | | | | | | | | | | pac | | | | | | | | | | ketiz | | | | | | | | | | ation | | | | | | | | | | fo | | | | | | | | | | rmats | | | | | | | | | | 8-12 | | | | | | | | | | the | | | | | | | | | | cl | | | | | | | | | | ients | | | | | | | | | | would | | | | | | | | | | need | | | | | | | | | | to | | | | | | | | | | de | | | | | | | | | | clare | | | | | | | | | | h | | | | | | | | | | igher | | | | | | | | | | bandw | | | | | | | | | | idths | | | | | | | | | | than | | | | | | | | | | what | | | | | | | | | | is | | | | | | | | | | shown | | | | | | | | | | in | | | | | | | | | | Table | | | | | | | | | | 6.4 | | | | | | | | | | .1-1. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
From this table, it should be clear that using redundancy can lead to using
both lower as well as higher bandwidth than the bandwidth used for the normal
operation (AMR12.2, no redundancy). A client can only control the amount of
bandwidth in the receiving direction since the bandwidth parameter applies
only to the receiving direction. The amount of bandwidth that can be used in
the sending direction depends on the bandwidth that the remote client has
declared in the SDP that it is prepared to receive.
For a UE using LTE or HSPA access types, it is expected that the b=AS is set
such that it allows for receiving a bandwidth corresponding to the normal
operation (AMR12.2, 1 frame per packet, no redundancy). This bandwidth
limitation would then apply independently of what bandwidth the other UE wants
to send. This limits the amount of redundancy to 100 % and requires that the
clients adapt down to AMR 5.9 kbps, or lower, when using redundancy.
For WiFi, and other access types where high packet loss rates can occur
relatively frequently, it can be beneficial to allow for using redundancy,
both in the sending and receiving direction, even if this results in using a
higher bandwidth. The UE can then set the b=AS value to a larger value, but
since the b=AS bandwidth applies only to the receiving direction then this
would only enable using higher bandwidths in DL. For UL, there are no
mechanisms available to indicate a higher bandwidth for the sending direction.
The sending bandwidth is instead limited by the maximum bandwidth that the
remote UE has declared that it wants to receive, which the remote UE decides
without knowing the local UEs preferences. Hence, for sessions where one UE is
using LTE or HSPA and the other is using WiFi then the resource reservation in
the LTE/HSPA network may not be sufficient for the UE that uses WiFi.
For the minimum bitrate the situation is even worse since there are no
mechanisms that either UE could use to indicate the minimum bitrate they want
to receive or want to send.
The PCRFs will have to use codec information to try to guess what the UEs want
to do. This can be done in several options, for example:
1) Option 1: A PCRF may assume that the minimum configuration is: AMR4.75, 1
frame per packet and no redundancy. This gives a minimum bitrate of 30 kbps
(60 bytes IPv6/UDP/RTP header, 14 bytes for one AMR4.75 speech frame, 50
packets per second gives 29.6 kbps).
2) Option 2: A PCRF may assume that the minimum configuration is: AMR4.75, 4
frames per packet and no redundancy. This gives a minimum bitrate of 12 kbps
(60 bytes IPv6/UDP/RTP header, 51 bytes for four AMR4.75 speech frames, 50/4
packets per second gives 11.1 kbps).
3) Option 3: There could also be an operator policy that decides to allocate
resources based on some other configuration, for example: AMR5.9, two non-
redundant speech frames in each packet and 200 % redundancy. This gives a
minimum bitrate of 31 kbps (60 bytes IPv6/UDP/RTP header, 94 bytes for four
AMR5.9 speech frames, 50/2 packets per second gives 30.8 kbps).
The lack of mechanisms to negotiate the minimum bitrate that the UEs want to
use means that different networks may allocate resources differently. A few
example combinations are shown in the tables below.
Table 6.4.1-3: Example bearer allocation, IMS-A allocates resources for GBR
(GBR-UL~A~, GBR-DL~A~) according to option 1, IMS-B allocates resources for
GBR (GBR-UL~B~, GBR-DL~B~) according to option 2
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 37 kbps
MBR-DL~B~ 37 kbps GBR-UL~A~ 30 kbps GBR-DL~B~ 12 kbps B->A MBR-DL~A~ 38 kbps
MBR-UL~B~ 38 kbps GBR-DL~A~ 30 kbps GBR-UL~B~ 12 kbps
* * *
Assuming that the UEs are QoS aware this means that:
\- UE-A may send with a bitrate between 30 and 37 kbps
\- UE-B may send with a bitrate between 12 and 38 kbps.
Another possibility is:
Table 6.4.1-4: Example bearer allocation, IMS-A allocates resources for GBR
(GBR-UL~A~, GBR-DL~A~) according to option 1, IMS-B allocates resources for
GBR (GBR-UL~B~, GBR-DL~B~) according to option 3
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 37 kbps
MBR-DL~B~ 37 kbps GBR-UL~A~ 30 kbps GBR-DL~B~ 31 kbps B->A MBR-DL~A~ 38 kbps
MBR-UL~B~ 38 kbps GBR-DL~A~ 30 kbps GBR-UL~B~ 31 kbps
* * *
Assuming that the UEs are QoS aware this means that:
\- UE-A may send with a bitrate between 30 and 37 kbps
\- UE-B may send with a bitrate between 31 and 38 kbps.
Yet another possibility is:
Table 6.4.1-5: Example bearer allocation, IMS-A allocates resources for GBR
(GBR-UL~A~, GBR-DL~A~) according to option 2, IMS-B allocates resources for
GBR (GBR-UL~B~, GBR-DL~B~) according to option 3
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 37 kbps
MBR-DL~B~ 37 kbps GBR-UL~A~ 12 kbps GBR-DL~B~ 31 kbps B->A MBR-DL~A~ 38 kbps
MBR-UL~B~ 38 kbps GBR-DL~A~ 12 kbps GBR-UL~B~ 31 kbps
* * *
Assuming that the UEs are QoS aware this means that:
\- UE-A may send with a bitrate between 12 and 37 kbps.
\- UE-B may send with a bitrate between 31 and 38 kbps.
### 6.4.2 Gap analysis
The difference in maximum rate (37 kbps vs. 38 kbps) gives the same issues as
already described in Clause 6.3 when multiple fixed-rate codecs with different
bitrates are offered. The difference between 37 kbps and 38 kbps might seem
insignificant. However, if the answerer would have limited the maximum codec
mode to, for example, 5.9 kbps mode then the bandwidth indicated in the SDP
answer would likely have been 31 kbps, which would give a much larger
difference. This can also be handled with a second SDP offer-answer as
discussed in Clause 6.3.
The larger issue is instead what minimum bitrates that will be used, and if
the UEs use this in the adaptation. Since each UE only knows the QoS parameter
for the local access, and it does not know the QoS parameters for the remote
access, then it cannot adjust the adaptation to the bitrates allowed in the
remote network. For example, if the bearers are set up according to Table
6.4.1-4 then UE-A may choose to not reduce the bitrate below 30 kbps even
though the GBR in network B is only 12 kbps. This can be expected to cause
significant packet losses or packet delays in network B.
Additionally, since each UE have aligned the transmission to the local QoS
parameters, then they have no incentive to send a new SDP offer to try to
align the bitrates because the bitrates are already aligned. Even if UE-B
would detect that UE-A is sending at a bitrate that is higher than GBR in
network B then there are no mechanisms in the SDP to inform UE-A about this
fact since the b=AS bandwidth is used to determine MBR and there are no other
bandwidth modifiers related to GBR.
It is however expected that most clients will reduce their bitrate even below
GBR, if possible, as long as poor operating conditions remain. Hence, poor
quality as a consequence of poor operating conditions will likely be a
temporary problem and the quality should recover after a while as clients
adapt. It may however happen that clients use the GBR as a threshold in their
adaptation, for example if the bitrate is above GBR then the client may adapt
rapidly down to GBR, but further downwards adaptation may be slower. This is
because the GBR rate is supposed to be \"guaranteed\" by the network. If the
RAN would not be able to guarantee this bitrate then it would either reject
the session setup or set GBR to a lower value, possibly to 0. In either case,
if the session setup is granted then the clients have no real incentive to
adapt to lower bitrates, except for exceptional cases.
Editor\'s note: A possible solution is to clarify in TS 26.114 that clients
should regard MBR and GBR as local QoS parameters and should therefore be
prepared to adapt below GBR, if possible.
## 6.5 Use case D: Single multi-rate speech codec (AMR) with extra bandwidth
allocated for redundancy
### 6.5.1 General description
Alice and Bob are setting up a voice-only session similar to what is shown in
use case C. The difference is that Bob is using an access which may have high
packet loss rate. UE-B therefore wants to use up to 100 % redundancy with up
to 4 frames offset in both uplink and downlink even when using AMR12.2. This
means that each packet (bandwidth-efficient) will contain:
\- 1 CMR at 4 bits
\- 6 ToC entries at 6 bits each:
\- 1 ToC for the redundant frame
\- 4 ToCs for NO_DATA frames
\- 1 ToC for the non-redundant frame
\- 2 AMR12.2 speech frames á 244 bits each
\- In this case, no padding is needed to fill up to an integer number of
octets
The total RTP payload size becomes 528 bits = 66 bytes which, combined with
the IPv6/UDP/RTP overhead of 24 kbps, gives a bandwidth of 50.4 kbps. UE-B
therefore sets the b=AS bandwidth to 51 kbps.
Table 6.5.1-1: SDP offer-answer for use case D
+----------------------------------------------------------------+ | SDP offer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 98 | | | | b=AS:38 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=rtpmap:98 AMR/8000/1 | | | | a=fmtp:98 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+ | SDP answer | +----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 | | | | b=AS:51 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +----------------------------------------------------------------+
It should be noted here that the only difference between this SDP answer and
the SDP answer shown in Table 6.4.1-1 is that the bandwidth value is
different. The SDP answers are otherwise identical.
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive max 38 kbps (based on b=AS in SDP offer).
\- UE-A will send max 51 kbps (based on b=AS in SDP answer).
\- UE-B (Bob) wants to receive max 51 kbps (based on b=AS in SDP answer).
\- UE-B will send max 38 kbps (based on b=AS in SDP offer).
The PCRFs can use the b=AS information from the SDP offer and the SDP answer
to set up MBR but when assigning GBR they will have to use codec information
to try to guess what the UEs want to do since there is no corresponding
information in the SDPs. This means that the bearers may be set up in several
ways. The three examples shown in clause 6.4.1 may be used also here, except
that the maximum bandwidth in the A->B direction is 51 kbps.
This gives the following example bearer allocation, which corresponds to Table
6.4.1-3.
Table 6.5.1-2: Example bearer allocation after first offer/answer, IMS-A
allocates resources for GBR (GBR-UL~A~, GBR-DL~A~) according to option 1,
IMS-B allocates resources\ for GBR (GBR-UL~B~, GBR-DL~B~) according to option
2
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 51 kbps
MBR-DL~B~ 51 kbps GBR-UL~A~ 30 kbps GBR-DL~B~ 12 kbps B->A MBR-DL~A~ 38 kbps
MBR-UL~B~ 38 kbps GBR-DL~A~ 30 kbps GBR-UL~B~ 12 kbps
* * *
This means that redundancy with AMR12.2 is possible in the A->B direction but
not in the B->A direction.
Assuming that both UEs are QoS aware, the sending bitrates becomes:
\- For UE-A:
\- Max bitrate = 51 kbps, allows for AMR12.2 with 100 % redundancy
\- Min bitrate = 30 kbps
\- For UE-B:
Max bitrate = 38 kbps, requires adapting the bitrate down to AMR5.9 to allow
for redundancy
Min bitrate = 12 kbps
If a second SDP offer/answer negotiation is performed then the SDP that UE-A
sends may change the bandwidth in the B->A direction. However, UE-A has no
knowledge about what UE-B wants to do, i.e. if UE-B wants to set up a
symmetric session or an asymmetric session. Hence, UE-A assigns a bandwidth
purely based on what itself want to do, i.e. AMR12.2 with bandwidth-efficient
payload format and without redundancy, without taking into account what UE-B
wants to do.
A second SDP offer/answer is therefore likely to give the following bearer
allocation:
Table 6.5.1-3: Example bearer allocation after second offer/answer
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-ULA 51 kbps
MBR-DLB 51 kbps GBR-ULA 30 kbps GBR-DLB 12 kbps B->A MBR-DLA 37 kbps MBR-ULB
37 kbps GBR-DLA 30 kbps GBR-ULB 12 kbps
* * *
If the PCRFs use codec information to assign bearers then this could result in
assigning different values for MBR and GBR. However, since there is no
information in the SDP that UE-B sends about its desired sending rate then the
PCRFs have no more knowledge than what UE-A has.
### 6.5.2 Gap analysis
If one assume that both UEs are QoS aware then one get the following gap
analysis after the second SDP offer-answer negotiation:
Table 6.5.2-1: Gap analysis after second SDP offer-answer
+----+-------+-------+-------+-------+-------+-------+-------+ | Id | Dire | Media | QoS | Gap A | QoS | Gap B | Gap | | | ction | rate | param | | param | | AB | | | | | eters | | eters | | | | | | | A | | B | | | +----+-------+-------+-------+-------+-------+-------+-------+ | A | A->B | 30-51 | MBR-U | Op | MBR-D | Op | Op | | | | kbps | LA=51 | timal | LB=51 | timal | timal | | | | | kbps | | kbps | | | | | | | | Op | | U | U | | | | | GBR-U | timal | GBR-D | nder- | nder- | | | | | LA=30 | | LB=12 | alloc | alloc | | | | | kbps | | kbps | ation | ation | +----+-------+-------+-------+-------+-------+-------+-------+ | B | B->A | 12-37 | MBR-D | Opt | MBR-U | Opt | Opt | | | | kbps | LA=37 | imal, | LB=37 | imal, | imal, | | | | | kbps | but | kbps | but | but | | | | | | u | | u | u | | | | | GBR-D | ndesi | GBR-U | ndesi | ndesi | | | | | LA=30 | rable | LB=12 | rable | rable | | | | | kbps | | kbps | | | | | | | | Over- | | Over- | Over- | | | | | | alloc | | alloc | alloc | | | | | | ation | | ation | ation | +----+-------+-------+-------+-------+-------+-------+-------+
As shown in the gap analysis, the lack of information about what UE-B wants to
send result in both under-allocation and over-allocation for the GBR values.
The MBR allocation in the B->A direction is judged as optimal since UE-B can
adjust the bitrate to the QoS parameters. However, the allocated MBR is not
the desired maximum bitrate since it does not allow UE-B to use AMR12.2 with
redundancy in the sending direction.
Since there are no mechanisms available in SDP to indicate the desired sending
rate then additional SDP negotiations will not solve the problem. The same
problem occurs if UE-B wants to use a lower encoding rate but more than 100 %
redundancy.
## 6.6 Use case E: Several multi-rate speech codecs (AMR and AMR-WB)
### 6.6.1 General description
Alice and Bob are setting up a voice-only session. UE-A supports both the AMR
codec (4.75-12.2 kbps, all codec modes) and the AMR-WB codec (6.60-23.85 kbps,
all codec modes). UE-B supports only the AMR codec. Both UEs follow TS 26.114
and therefore offers both bandwidth-efficient and octet-aligned. Both UEs
propose to encapsulate 1 frame in each packet but allows for up to 12 frames
per packet, out of which maximum 4 frames can be non-redundant frames. Alice
sends the SDP offer and Bob sends the SDP answer as shown below. Bob accepts
using the bandwidth-efficient payload format version.
Table 6.6.1-1: SDP offer-answer for use case E
+-----------------------------------------------------------------+ | SDP offer | +-----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 98 99 100 | | | | b=AS:49 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=rtpmap:98 AMR/8000/1 | | | | a=fmtp:98 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=rtpmap:99 AMR-WB/8000/1 | | | | a=fmtp:99 mode-change-capability=2; max-red=220 | | | | a=rtpmap:100 AMR-WB/8000/1 | | | | a=fmtp:100 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=ptime:20 | | | | a=maxptime:240 | +-----------------------------------------------------------------+ | SDP answer | +-----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 97 | | | | b=AS:37 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +-----------------------------------------------------------------+
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive max 49 kbps.
\- UE-A will send max 37 kbps.
\- UE-B (Bob) wants to receive max 37 kbps.
\- UE-B will send max 49 kbps.
\- Adaptation is possible in same ways as described in clause 6.4.1 for use
case C except that UE-B can use the higher bitrate to send more redundancy.
\- Since the UEs cannot inform the network or the other UE what minimum codec
mode it wants to send and/or receive or what packetization they plan to use
when sending or receiving, there is no guidance for how the IMS networks
should select the minimum bitrate that is required for the session.
The bandwidths for different configurations shown in Table 6.4.1-2 apply also
here.
Similar to discussed in clause 6.5, the PCRFs may allocate MBR in several
different ways. A difference here is that UE-B may choose to use all
combinations with a bitrate up to 49 kbps (combinations 1-11) while UE-A can
only use the combinations up to 37 kbps (combinations 1-7). This can be
aligned with a second SDP offer-answer.
The discussion in clause 6.5 on how the PCRFs may allocate GBR holds also
here. This cannot be solved with a second SDP offer-answer.
### 6.6.2 Gap analysis
The differences in MBR give the same gap as has been discussed above in clause
6.3. This can be solved with a second SDP offer-answer negotiation.
The problems caused by the GBRs have also been discussed in clause 6.4. As
described in clause 6.4.2, this cannot be solved with a second SDP offer-
answer negotiation since there are no SDP parameters available for negotiating
this information.
## 6.7 Use case F: Single video codec, symmetric usage
### 6.7.1 General description
Alice and Bob are setting up a video telephony session including both speech
and video. Both UEs support the minimum set of speech and video codecs defined
in TS 26.114, i.e.:
\- for speech: AMR (4.75-12.2 kbps); and:
\- for video: H.264 Constrained Baseline Profile (CBP) level 1.2.
For speech, both UEs propose to encapsulate 1 frame in each packet but allows
for up to 12 frames per packet, out of which maximum 4 can be non-redundant
frames.
Alice sends the SDP offer and Bob sends the SDP answer as shown below. Bob
accepts using the bandwidth-efficient payload format version. The SDPs do not
include attributes for SDPCapNeg, AVPF feedback messages, image attribute and
video orientation since these things make no difference for the current
analysis.
Since this analysis is targeting issues found for video then the SDPs do not
include audio. The SDP offer is aligned with the example SDP offer in TS
26.114, Table A.4.2a2.
Table 6.7.1-1: SDP offer-answer for use case F
+-------------------------------------------------------------+ | SDP offer | +-------------------------------------------------------------+ | m=video 49152 RTP/AVP 99 | | | | b=AS:315 | | | | b=RS:0 | | | | b=RR:2500 | | | | a=rtpmap:99 H264/90000 | | | | a=fmtp:99 packetization-mode=0; profile-level-id=42e00c; \ | | | | sprop-parameter-sets=J0LgDJWgUH6Af1A=,KM46gA== | +-------------------------------------------------------------+ | SDP answer | +-------------------------------------------------------------+ | m=video 49152 RTP/AVP 99 | | | | b=AS:315 | | | | b=RS:0 | | | | b=RR:2500 | | | | a=rtpmap:99 H264/90000 | | | | a=fmtp:99 packetization-mode=0; profile-level-id=42e00c; \ | | | | sprop-parameter-sets=J0LgDJWgUH6Af1A=,KM46gA== | +-------------------------------------------------------------+
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive max 315 kbps.
\- UE-B (Bob) wants to receive max 315 kbps.
\- UE-A will send max 315 kbps.
\- UE-B will send max 315 kbps.
\- Rate adaptation is possible. However, there is nothing in the SDPs that the
functions in the network can use to determine the bitrate range the clients
are planning to use when adapting.
The Application Functions use the b=AS values from the SDP offer and the SDP
answer sets the service information to:
\- In IMS-A:
\- UE-A max send rate is 315 kbps.
\- UE-A min send rate is unknown and is therefore left undefined.
\- UE-A max receive rate is 315 kbps.
\- UE-A min receive rate is also unknown and is therefore left undefined.
\- In IMS-B:
\- UE-B max send rate is 315 kbps.
\- UE-B min send rate is unknown and is therefore left undefined.
\- UE-B max receive rate is 315 kbps.
\- UE-B min receive rate is unknown and is therefore left undefined.
The AF sends these parameters together with the remaining media-related
information to the PCRF.
The PCRFs then uses the session information, and possibly also the remaining
media-related information, to determine the Authorized IP QoS parameters MBR-
UL, MBR-DL, GBR-UL and GBR-DL. Since the AF does not provide any minimum
bitrates that could be used to set the GBR-UL and GBR-DL parameters then the
PCRF uses operator policies instead. If different operators have different
policies then GBR will be set differently in the different networks. One
example is given below:
Table 6.7.1-2: Example bearer allocation for video
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 315 kbps
MBR-DL~B~ 315 kbps GBR-UL~A~ 100 kbps GBR-DL~B~ 150 kbps B->A MBR-DL~A~ 315
kbps MBR-UL~B~ 315 kbps GBR-DL~A~ 100 kbps GBR-UL~B~ 150 kbps
* * *
The difference between speech and video is that:
\- For speech, at least when using AMR or AMR-WB, the PCRF may use the codec
mode information available in the SDP to set GBR-UL/DL to the bandwidth needed
for the lowest codec mode.
\- For video, there is no corresponding information in the SDPs that is
related to the desired minimum bandwidth which the PCRF could use to set GBR.
The PCRF therefore relies on operator policies or use a codec specific
algorithm for this. The codec specific algorithm may use the QoS examples
provided in TS 26.114 Annex E. If both PCRFs use the same method to determine
GBR-UL/DL then it is likely that they choose the same values.
The lack of information in SDP can give a more or less unpredictable behaviour
when the clients need to adapt the bitrate.
Editor\'s note: It has been suggested that the image attribute should be taken
into account. It is however unclear if this can be done. There is some
correlation between the bandwidth and the image size but the correlation is
fairly weak.
### 6.7.2 Gap analysis
A QoS aware client is expected to align the bitrate range (min-max bitrate)
used for the adaptation to the allocated MBR and GBR values. However, a QoS
aware client is only aware of the QoS parameter in the local access and has no
knowledge about the QoS parameters defined for the bearers in the remote
access. A UE in network A may therefore adapt down to 100 kbps, which should
give no problems in network B. However, a UE in network B may adapt down to
only 150 kbps, which can be expected to give problems in network A if the
congestion occurred in that network. After adapting down to GBR further
adaptation may or may not happen. The figure below illustrates how the
downwards adaptation works if the client follows TS 26.114.
{width="6.695138888888889in" height="4.16875in"}
Figure 6.7.2-1: Examples of how MBR and GBR may be used by the MTSI client
when adapting
Editor\'s note: The figure above needs to be converted into an Enhanced
Metafile picture, so that it will be visible also in Draft and Outline view.
This will be done before creating v1.0.0 of the TR.
When adaptation is triggered by ECN, then the sending client is expected to
adapt down to ECN_min_rate, which is aligned with GBR (if known). This first
downwards adaptation can either immediately switch down to ECN_min_rate or may
switch down in steps, but in both cases this first downwards adaptation need
to be fast. Further ECN-CE markings will not give any further downwards
adaptation because ECN_min_rate is supposed to be \"guaranteed\", even in bad
conditions. Further ECN-CE markings will however prevent the client from
increasing the rate.
It is here assumed that ECN_min_rate is aligned with the GBR. If they are
different then the adaptation is expected to adapt down to the lower of the
two bitrates.
When adaptation is triggered by other means than ECN, e.g. packet losses or
jitter, then a good reaction is to adapt fast down to GBR (if GBR\B MBR-UL~A~ 5200 kbps
MBR-DL~B~ 5200 kbps GBR-UL~A~ 2100 kbps GBR-DL~B~ 2100 kbps B->A MBR-DL~A~
2100 kbps MBR-UL~B~ 2100 kbps GBR-DL~A~ 1100 kbps GBR-UL~B~ 1100 kbps
* * *
Since UE-B is going to send max 1.1 Mbps and since MBR-UL~B~ = MBR-DL~A~ = 2.1
Mbps this gives an over-allocation in the B->A direction in both networks.
Similarly, if a UE supports the same H.264 profile and level in both sending
and receiving direction and if the UE will use a lower send rate than what is
indicated with the level (and the b=AS value) and if the UE does not use the
\'max-recv-level\' parameter to indicate a higher level for the receiving
direction, then the same over-allocation will also occur.
### 6.9.2 Gap analysis
The PCRFs has no way of knowing that a UE-B is planning to send video with a
bitrate that is lower than the maximum bitrate for the supported H.264 profile
and level.
UE-A also has no way of knowing what bandwidth UE-B will send, so initiating a
new SDP offer-answer negotiation will not resolve the issue, because UE-A has
no information that it could use to choose a more suitable b=AS value.
UE-B could also initiate a second SDP offer-answer, but since there are no SDP
parameters to indicate the desired sending rate then this will not help.
### 6.9.3 Root-cause analysis
There is no bandwidth parameter similar to b=AS that the UE can use to
indicate the desired sending rate.
Operator policies or codec-specific algorithms can be used but will only work
if they are aligned with what the UE wants to do.
## 6.10 Use case I: Multiple video codecs
### 6.10.1 General description
Alice and Bob are setting up a video telephony session including both speech
and video. Both UEs support AMR speech coding. For video, both UEs support
video coding as follows:
\- 5 inch display with 848x480 resolution.
\- H.264 (AVC) Constrained Baseline Profile (CBP) level 3.1. For the given
display size and resolution the H.264 (AVC) codec would need 690 kbps
(including IPv6/UDP/RTP overhead).
\- H.265 (HEVC) Main Profile, Main tier level 3.1. For the given display size
and resolution the H.265 (HEVC) codec would need 540 kbps (including
IPv6/UDP/RTP overhead).
\- Both UEs want to use the more efficient H.265 video codec to reduce the
bitrate to 540 kbps whenever H.265 can be used, i.e. when both UEs support the
H.265 codec.
UE-A sends the SDP offer to offer with b=AS set to 690 kbps (including
IPv6/UDP/RTP overhead) since the client needs to choose the higher of the
bitrates needed for each respective codec. UE-B accepts H.265 and sets b=AS to
540 kbps. The SDP offer and the SDP answer are the same as in TS 26.114 Table
A.4.16 and Table A.4.18, respectively.
Table 6.10.1-1: SDP offer-answer for use case I
+--------------------------------------------------------------+ | SDP offer | +--------------------------------------------------------------+ | m=video 49154 RTP/AVP 98 97 100 99 | | | | a=tcap:1 RTP/AVPF | | | | a=pcfg:1 t=1 | | | | b=AS:690 | | | | b=RS:0 | | | | b=RR:5000 | | | | a=rtpmap:100 H264/90000 | | | | a=fmtp:100 packetization-mode=0; profile-level-id=42e01f; \ | | | | sprop-parameter-sets=Z0KAHpWgNQ9oB/U=,aM46gA== | | | | a=imageattr:100 send [x=848,y=480] recv [x=848,y=480] | | | | a=rtpmap:99 H264/90000 | | | | a=fmtp:99 packetization-mode=0; profile-level-id=42e01f; \ | | | | sprop-parameter-sets=Z0KADZWgUH6Af1A=,aM46gA== | | | | a=imageattr:99 send [x=320,y=240] recv [x=320,y=240] | | | | a=rtpmap:98 H265/90000 | | | | a=fmtp:98 profile-id=1; level-id=5d; \ | | | | sprop-vps=QAEMAf//AWAAAAMAgAAAAwAAAwB4LAUg; \ | | | | sprop-sps=QgEBAWAAAAMAgAAAAwAAAwB4oAaiAeFlLktIvQB3CAQQ; \ | | | | sprop-pps=RAHAcYDZIA== | | | | a=imageattr:98 send [x=848,y=480] recv [x=848,y=480] | | | | a=rtpmap:97 H265/90000 | | | | a=fmtp:97 profile-id=1; level-id=5d; \ | | | | sprop-vps=QAEMAf//AWAAAAMAgAAAAwAAAwB4LAUg; \ | | | | sprop-sps=QgEBAWAAAAMAgAAAAwAAAwB4oAoIDxZS5LSL0AdwgEE=; \ | | | | sprop-pps=RAHAcYDZIA== | | | | a=imageattr:97 send [x=320,y=240] recv [x=320,y=240] | | | | a=rtcp-fb:* trr-int 5000 | | | | a=rtcp-fb:* nack | | | | a=rtcp-fb:* nack pli | | | | a=rtcp-fb:* ccm fir | | | | a=rtcp-fb:* ccm tmmbr | | | | a=extmap:4 urn:3gpp:video-orientation | +--------------------------------------------------------------+ | SDP answer | +--------------------------------------------------------------+ | m=video 49156 RTP/AVPF 98 | | | | a=acfg:1 t=1 | | | | b=AS:540 | | | | b=RS:0 | | | | b=RR:5000 | | | | a=rtpmap:98 H265/90000 | | | | a=fmtp:98 profile-id=1; level-id=5d; \ | | | | sprop-vps=QAEMAf//AWAAAAMAgAAAAwAAAwB4LAUg; \ | | | | sprop-sps=QgEBAWAAAAMAgAAAAwAAAwB4oAaiAeFlLktIvQB3CAQQ; \ | | | | sprop-pps=RAHAcYDZIA== | | | | a=imageattr:98 send [x=848,y=480] recv [x=848,y=480] | | | | a=rtcp-fb:* trr-int 5000 | | | | a=rtcp-fb:* nack | | | | a=rtcp-fb:* nack pli | | | | a=rtcp-fb:* ccm fir | | | | a=rtcp-fb:* ccm tmmbr | | | | a=extmap:4 urn:3gpp:video-orientation | +--------------------------------------------------------------+
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A (Alice) wants to receive max 690 kbps.
\- UE-B (Bob) wants to receive max 540 kbps.
\- UE-A can send up to max 540 kbps, since UE-B has limited the bitrate in its
receiving direction to this.
\- UE-B can send up to max 690 kbps, since UE-A has not introduced any further
limitations.
\- Rate adaptation is possible, as for Use case F.
The Application Functions use the b=AS values from the SDP offer and the SDP
answer sets the service information to:
\- In IMS-A:
\- UE-A max send rate is 540 kbps (based on b=AS in the SDP answer).
\- UE-A min send rate is unknown and is therefore left undefined.
\- UE-A max receive rate is 690 kbps (based on b=AS in the SDP offer).
\- UE-A min receive rate is also unknown and is therefore left undefined.
\- In IMS-B:
\- UE-B max send rate is 690 kbps (based on b=AS in the SDP offer).
\- UE-B min send rate is unknown and is therefore left undefined.
\- UE-B max receive rate is 540 kbps (based on b=AS in the SDP answer).
\- UE-B min receive rate is unknown and is therefore left undefined.
The PCRFs then uses the session information, and possibly also the remaining
media-related information, to determine the Authorized IP QoS parameters.
Since the AF does not provide any minimum bitrates that could be used to set
the GBR-UL and GBR-DL parameters then the PCRF uses operator policies instead.
The MBRs and the GBRs for the A->B direction and the GBRs for the B->A
direction are aligned with the QoS example in TS 26.114 clause E.24. The MBRs
for the B->A direction are aligned with the b=AS in the SDP offer.
Table 6.10.1-2: Bearer allocation
* * *
Direction QoS parameters A Rate QoS parameters B Rate A->B MBR-UL~A~ 540 kbps
MBR-DL~B~ 540 kbps GBR-UL~A~ 64 kbps GBR-DL~B~ 64 kbps B->A MBR-DL~A~ 690 kbps
MBR-UL~B~ 690 kbps GBR-DL~A~ 64 kbps GBR-UL~B~ 64 kbps
* * *
This means that the improved coding gain is used for:
\- lower bitrate in the A->B direction; and for:
\- better quality in the B->A direction.
### 6.10.2 Gap analysis
The PCRFs has no way of knowing that a UE-A is planning to send video with a
bitrate that is lower for H.265 than for H.264.
### 6.10.3 Root-cause analysis
There is no bandwidth parameter similar to b=AS that the UE can use to
indicate different bandwidths for different codecs. This could possibly be
solved with SDP Capability Negotiation RFC 5939 [14] and SDP Miscellaneous
Capability Negotiation RFC 7006 [15].
Editor\'s note: SDPCapNeg is a potential solution and should also be discussed
in clause 8.
A second SDP offer/answer could also be used where only the H.265 codec is
included. UE-A could use this to indicate the appropriate maximum receiving
rate for the H.265 codec.
## 6.11 Use case J: Single video codec, symmetric usage, bitrate variations
### 6.11.1 General description
This use case is identical to Use case F but the discussion here focuses on
bitrate variations that may occur in the session, even under normal operating
conditions with good channel condition and low network load so that there is
no need for end-to-end bitrate adaptation. This use case therefore illustrates
the bitrate variations that may be generated by a video codec if no
restrictions are applied to the encoding process.
Alice and Bob are setting up a video telephony session including both speech
and video. Both UEs support the minimum set of speech and video codecs defined
in TS 26.114, i.e.:
  * for speech: AMR (4.75-12.2 kbps); and:
  * for video: H.264 Constrained Baseline Profile (CBP) level 1.2.
Alice sends the SDP offer and Bob sends the SDP answer as shown below. Since
this analysis is targeting issues for bitrate variations for video then the
SDPs do not include audio. The SDP examples shown below are also simplified
versions without SDPCapNeg, AVPF feedback messages, image attribute and video
orientation since these things make no difference for the current analysis.
Table 6.11.1-1: SDP offer-answer for use case J
+-------------------------------------------------------------+ | SDP offer | +-------------------------------------------------------------+ | m=video 49152 RTP/AVP 99 | | | | b=AS:315 | | | | b=RS:0 | | | | b=RR:2500 | | | | a=rtpmap:99 H264/90000 | | | | a=fmtp:99 packetization-mode=0; profile-level-id=42e00c; \ | | | | sprop-parameter-sets=J0LgDJWgUH6Af1A=,KM46gA== | +-------------------------------------------------------------+ | SDP answer | +-------------------------------------------------------------+ | m=video 49152 RTP/AVP 99 | | | | b=AS:315 | | | | b=RS:0 | | | | b=RR:2500 | | | | a=rtpmap:99 H264/90000 | | | | a=fmtp:99 packetization-mode=0; profile-level-id=42e00c; \ | | | | sprop-parameter-sets=J0LgDJWgUH6Af1A=,KM46gA== | +-------------------------------------------------------------+
This discussion focuses on video and speech is not considered any more in this
use case.
For the media handling in the UEs, the SDP offer/answer negotiation means:
  * UE-A (Alice) wants to receive max 315 kbps (on average).
  * UE-B (Bob) wants to receive max 315 kbps (on average).
  * UE-A will send max 315 kbps (on average).
  * UE-B will send max 315 kbps (on average).
The Application Functions use the b=AS values from the SDP offer and the SDP
answer sets the service information to:
  * In IMS-A:
\- UE-A max send rate is 315 kbps (on average).
\- UE-A min send rate is unknown and is therefore left undefined.
\- UE-A max receive rate is 315 kbps (on average).
\- UE-A min receive rate is also unknown and is therefore left undefined.
\- In IMS-B:
\- UE-B max send rate is 315 kbps (on average).
\- UE-B min send rate is unknown and is therefore left undefined.
\- UE-B max receive rate is 315 kbps (on average).
\- UE-B min receive rate is unknown and is therefore left undefined.
The AF sends these parameters together with the remaining media-related
information to the PCRF.
In this case, it is assumed that the PCRFs suggest to set up a bearer with
MBR=GBR. This gives the following bearer allocation.
Table 6.11.1-2: Bearer allocation for video
* * *
Direction Parameter Rate Parameter Rate A->B Max_DR_UL~A~ 315 kbps
Max_DR_DL~B~ 315 kbps Gua_DR_UL~A~ 315 kbps Gua_DR_DL~B~ 315 kbps B->A
Max_DR_DL~A~ 315 kbps Max_DR_UL~B~ 315 kbps Gua_DR_DL~A~ 315 kbps Gua_DR_UL~B~
315 kbps
* * *
In this discussion it is assumed that these parameters are also used in the
PGW to monitor that the UEs do not exceed the negotiated bandwidths.
Two trace files of video frame sizes are used to facilitate the discussion on
bitrate variations. The files are described in the Table 6.11.1-3 below and
are shown in Figures 6.11.1-1 and 6.11.1-2.
Table 6.11.1-3: File information
* * *
                                             File 1         File 2
Codec H.264 H.264 Resolution QCIF QCIF Frame rate 30 fps 30 fps Bitrate (incl.
IP, UDP and RTP overhead) 315 kbps 315 kbps Number of frames 2692 2204 Average
frame size 1312.5 bytes 1312.5 bytes Min frame size 595 bytes 1006 bytes Max
frame size 2147 bytes 1771 bytes
* * *
These files do not include any I frames.
{width="5.5881944444444445in" height="3.9340277777777777in"}
Figure 6.11.1-1: Video frame sizes for file 1
{width="5.579861111111111in" height="4.186111111111111in"}
Figure 6.11.1-2: Video frame sizes for file 2
When measuring the used bitrate, e.g. in a policing function, then one need to
average the instantaneous bitrates over some time to create a short-term
average. In this analysis, an averaging window has been used and different
lengths of the averaging window have been tested. The figure below shows a few
examples of how the variations in the short-term bitrate average are reduced
as the length of the averaging window increases.
+----------------------------------+----------------------------------+ | {width="2.401388888888889in" | | height="1.9638888888888888in"} | height="1.8736111111111111in"} | | | | | a) No averaging window | b) 0.5 s averaging window | +----------------------------------+----------------------------------+ | {width="2.5215277777777776in" | | height="2.0055555555555555in"} | height="1.9638888888888888in"} | | | | | c) 1 s averaging window | d) 2 s averaging window | +----------------------------------+----------------------------------+
Figure 6.11.1-3: Bitrates for file 1 with different averaging windows
As can be seen in the figure above the variations in the short-term average
are significantly reduced when applying an averaging window, even if the
window is as short as 0.5 seconds. This is however excluding I frames.
Statistics when applying different averaging window lengths are shown in Table
6.11.1-4.
I frames may be generated by the encoder for several reasons, for example
generated at a regular interval to stop error propagation or generated when
the receiver requests a Full Intra Refresh. I frames are usually much larger
than the average frame size, often as large as 5 to 10 times larger. The
effects of I frames on the short-term bitrate average have been analyzed by
manually inserting I frames every 15 second in the video trace files. Both I
frames of 5 times and 10 times the average video frame size have been used.
The video trace files were then re-scaled to maintain the 315 kbps average
bitrate (measured over the whole trace file). The averaging windows were then
applied in the same was as above. Table 6.11.1-4 shows the statistics for the
two files when I frames have been added.
Table 6.11.1-4: Bitrate variations after applying averaging window
* * *
File Averaging window length\ Average bitrate\ Maximum bitrate\ Minimum
bitrate\ Max/Avg bitrate Number of frames Number of times short-term average
is >25 % over long-term average Number of times short-term average is >10 %
over long-term average [s] [bps] [bps] [bps]
File 1 - 314999.6 515280 142800 1.64 2692 160 584
File 1 0.17 315003.3 352272 280944 1.12 2687 0 7
File 1 0.33 314987.7 333648 294816 1.06 2682 0 0
File 1 0.50 314980.8 327392 302080 1.04 2677 0 0
File 1 0.67 314980.9 323400 306300 1.03 2672 0 0
File 1 1.00 314986.6 321208 308784 1.02 2662 0 0
File 1 2.00 314990.1 317848 311728 1.01 2632 0 0
File 1, 5x I - 314998.5 1560960 141360 4.96 2692 152 546
File 1, 5x I 0.17 314630.5 597120 278400 1.90 2687 26 27
File 1, 5x I 0.33 314572.4 454608 292248 1.45 2682 51 51
File 1, 5x I 0.50 314554.2 408672 299424 1.30 2677 52 76
File 1, 5x I 0.67 314550.9 382284 303612 1.22 2672 0 101
File 1, 5x I 1.00 314557.6 359416 306016 1.14 2662 0 151
File 1, 5x I 2.00 314580.0 335960 308956 1.07 2632 0 0
File 1, 10x I - 314998.1 3087840 139920 9.80 2692 134 490
File 1, 10x I 0.17 314180.8 899376 275328 2.86 2687 26 26
File 1, 10x I 0.33 314071.4 604056 289032 1.92 2682 51 51
File 1, 10x I 0.50 314039.7 507152 296144 1.61 2677 76 76
File 1, 10x I 0.67 314032.2 455340 300288 1.45 2672 101 101
File 1, 10x I 1.00 314040.1 406968 302696 1.30 2662 151 151
File 1, 10x I 2.00 314085.6 358032 305584 1.14 2632 0 301
File 2 - 315001.4 425040 241440 1.35 2204 5 167
File 2 0.17 315007.9 336240 297888 1.07 2199 0 0
File 2 0.33 315001.6 332328 306528 1.06 2194 0 0
File 2 0.50 315003.6 329104 308784 1.04 2189 0 0
File 2 0.67 315005.7 328092 310044 1.04 2184 0 0
File 2 1.00 315002.1 326824 311672 1.04 2174 0 0
File 2 2.00 314952.8 325616 313084 1.03 2144 0 0
File 2, 5x I - 315001.5 1561200 239040 4.96 2204 8 137
File 2, 5x I 0.17 314554.7 576768 295104 1.83 2199 21 21
File 2, 5x I 0.33 314496.3 450408 303696 1.43 2194 41 41
File 2, 5x I 0.50 314484.4 402384 305984 1.28 2189 57 61
File 2, 5x I 0.67 314482.3 378408 307536 1.20 2184 0 81
File 2, 5x I 1.00 314479.8 356728 308840 1.13 2174 0 121
File 2, 5x I 2.00 314454.1 334512 310232 1.06 2144 0 0
File 2, 10x I - 315001.3 3087600 236400 9.80 2204 7 105
File 2, 10x I 0.17 314005.8 879024 291792 2.80 2199 21 21
File 2, 10x I 0.33 313884.3 599688 300360 1.91 2194 41 41
File 2, 10x I 0.50 313855.6 500752 302576 1.60 2189 61 61
File 2, 10x I 0.67 313848.3 451356 304092 1.44 2184 81 81
File 2, 10x I 1.00 313847.2 404216 305384 1.29 2174 121 121
File 2, 10x I 2.00 313849.9 356512 306780 1.14 2144 0 241
* * *
As can be seen in the table, adding I frames has a large impact on how the
averaged bitrate varies. To get a maximum short-term average (measured over
the averaging window) that is reasonably close to the long-term average
(measured over the whole file) then one need to have a long averaging window,
at least a few seconds long.
Looking at the columns showing how many times the average exceeds 25 % and 10
% over the average one can see that this occurs quite frequently when 5x and
10x I frames are added, even for long averaging windows. If the network would
drop a packet every time this happens then this would increase the packet loss
rate with a few percent, in the worst cases with as much as 10 %.
Another observation is that the frequency of large short-term average actually
seems to increase with increasing window length when large I frames are added.
### 6.11.2 Gap analysis
There is no information in the SDPs (offer or answer) and in the functions and
protocols used in PCC and RAN for resource reservation (GDP, Rx, scheduler,
etc...) about how large bitrate variations the clients want to use. There is
also no information in the SDPs or in the QoS parameters for the bearers that
informs the clients about how large bitrate variations the networks will
allow.
Editor\'s note: SA4 understands that adding such signalling would impact many
network nodes and interfaces, see also Reply LS from CT3 in
S4-130647/C3-130837, and that defining such modifications would be outside the
scope of SA4. A simpler solution would therefore be desirable.
In addition, for the MBR and GBR bitrates in EPC, [11], there is no definition
for how these (average) bitrates should be calculated.
Editor\'s note: Specifying how the (average) bitrates should be calculated may
solve the same problem as defining new signalling for the bitrate variations,
and it should be a simpler solution. Another possibility would be to define
requirements and/or recommendations for how terminals may send large frames.
These things should be considered when discussing potential solutions.
This means that the policing functions in the networks will need to be
configured without knowing what will work for the clients. The clients should
also implement some form of rate smoothing but a problem here is that client
developers do not know how much smoothing that is required by the networks. In
addition, the policing functions in different networks could very well be
configured differently so a rate smoothing that works in one network is not
guaranteed to work in other networks.
## 6.12 Use case K: Several multi-rate speech codecs (AMR, AMR-WB and EVS)
### 6.12.1 General description
Alice and Bob are setting up a voice-only session. Both UE-A and UE-B support:
the AMR codec (4.75-12.2 kbps, all codec modes); the AMR-WB codec (6.60-23.85
kbps, all codec modes); and the EVS (5.9-128 kbps, all codec modes). Both
operators allow using fullband (FB) speech, but the operators want to use the
EVS codec in different ways.
Operator A (originating side) wants to ensure SWB-FB quality in the 32-128
kbps bitrate range for most operating conditions, while adaptation down to WB
or even NB speech at lower bitrates is allowed but should happen quite rarely.
Operator B (terminating side) wants to use the EVS codec primarily between WB
and SWB and in the 9.6-48 kbps bitrate range even though adaptation to both
lower audio bandwidths at lower bitrates is possible, if/when needed.
Adaptation to higher bitrates at higher bitrates is also possible, when
resources are available.
NOTE: The EVS codec offers many codec specific parameters that operators may
use to control the negotiated bitrate range and the audio bandwidth range. The
above usage describes two ways for how the EVS codec may be used. It is not
clear how operators will use the codec in real networks.
Table 6.12.1-1. SDP offer-answer for use case X
+-----------------------------------------------------------------+ | SDP offer | +-----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 101 100 99 98 9 | | | | b=AS:153 | | | | a=rtpmap:97 AMR/8000/1 | | | | a=fmtp:97 mode-change-capability=2; max-red=220 | | | | a=rtpmap:98 AMR/8000/1 | | | | a=fmtp:98 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=rtpmap:99 AMR-WB/8000/1 | | | | a=fmtp:99 mode-change-capability=2; max-red=220 | | | | a=rtpmap:100 AMR-WB/8000/1 | | | | a=fmtp:100 mode-change-capability=2; max-red=220; octet-align=1 | | | | a=rtpmap:101 EVS/16000/1 | | | | a=fmtp:101 br=128; bw=nb-fb; \; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +-----------------------------------------------------------------+ | SDP answer | +-----------------------------------------------------------------+ | m=audio 49152 RTP/AVP 101 | | | | b=AS:153 | | | | a=rtpmap:101 EVS/16000/1 | | | | a=fmtp:101 br=128; bw=nb-fb; \; max-red=220 | | | | a=ptime:20 | | | | a=maxptime:240 | +-----------------------------------------------------------------+
Editor\'s note: The codec parameters for the EVS codec were not completely
defined at the time of writing and may need to be updated.
For the media handling in the UEs, the SDP offer/answer negotiation means:
\- UE-A wants to receive max 153 kbps, based on the b=AS in the SDP offer.
\- UE-A will send max 153 kbps, based on the b=AS in the SDP answer.
\- UE-B wants to receive max 153 kbps, based on the b=AS in the SDP answer.
\- UE-B will send max 153 kbps, based on the b=AS in the SDP offer.
\- There is however no information in the SDPs that can be used to set GBR.
The bitrate parameter \'br\' shows that all bitrates down to 5.9 kbps are
supported. However, this is not aligned with the operators\' intended codec
usage, see figure below.
One alternative would be if the UEs would use the \'br\' parameter to only
negotiate the primarily desired operating bitrates. This would however prevent
adaptation to bitrates outside this range. It may also give interworking
problems if UE-A and UE-B want to use non-overlapping bitrate ranges.
Therefore, it is desirable to have a bitrate negotiation that allows for using
the whole bitrate range, i.e. an unrestricted bitrate range, or at least to
not restrict the usage of the lower bitrates. This is done either by defining
\'br=5.9-128\' or \'br=128\'. This would however mean that this codec-specific
information is not representative for the intended codec usage.
{width="6.5in" height="3.9375in"}
Figure 6.12.1: Example of possible EVS codec usages (does not show used
bitrates)
To preserve the allowed bitrate range, the operators should also avoid
changing the indicated bitrate minimum and maximum bitrates, especially for
the upper limit. This however means that the operators cannot indicate the
desired bitrate range, if it is different from the allowed bitrate range.
### 6.12.2 Gap analysis
Similar to discussed for use case D, see clause 6.5, the PCRFs may allocate
MBR and GBR in several different ways. The downlink MBR in the local access
and the uplink MBR in the remote access can be aligned second SDP offer-
answer. However, there are no mechanisms in SDP to align GBR.
In addition, it is not possible to indicate in SDP a preferred bitrate range,
if this is different from the allowed bitrate range.
# 7 Recommended requirements
Editor\'s note: When preparing this section then inputs from CT1 in LS
S4-130646/C1-132536, from CT3 in LS S4-130647/C3-130837 and from SA2 in LS
S4-130649/S2-132324 will be taken into account. Tdoc S4-130705 provides
comments to these inputs which will also be taken into account.
## 7.1 Discussion on individual recommended requirements
### 7.1.1 General
### 7.1.2 Use case A: Single fixed-rate speech codec
**Gap(s):**
No gap identified.
**Proposed requirement(s):**
None.
### 7.1.3 Use case B: Several fixed-rate speech codecs
**Gap(s) after first SDP offer/answer:**
Both over-allocation and under-allocation can happen, since b=AS only
indicates one single value and therefore has to be set to the maximum
bandwidth needed for the codec that uses the highest bitrate.
Over-allocation typically happens when the resources are set up for a high-
bitrate codec but then a lower bitrate codec is negotiated. Under-allocation
typically happens if a network assigns too high MBR and GBR values and if the
other networks assign MBR and GBR with lower values. This can lead to
misalignment of both MBR and GBR between the different networks.
**Gap(s) after second SDP offer/answer:**
If both UEs use the selected codec in the same way, then it should be possible
to avoid the gap.
However, if a UE wants to use the selected codec in a different way, for
example with redundancy, then it is only possible to indicate this for the
receiving direction. There is no possibility to indicate the maximum or
desired bitrate for the sending direction.
**Proposed requirement(s):**
The following requirement is proposed: \"_It should be possible to make the
network aware of the minimum and maximum supported bandwidth requirements
negotiated between the UEs for each media direction._ \"
**Comments:**
The proposed requirement is an aggregation of several \"atomic\" requirements.
The analysis of this use case supports the following atomic requirements:
\- It should be possible to make the network aware of the minimum supported
bandwidth requirements negotiated between the UEs for the receiving direction.
\- It should be possible to make the network aware of the maximum supported
bandwidth requirements negotiated between the UEs for the receiving direction.
The corresponding atomic requirements for the sending direction are discussed
for Use case D, see clause 7.1.5.
### 7.1.4 Use case C: Single multi-rate speech codec (AMR), no extra bandwidth
allocated for redundancy
**Gap(s):**
For AMR, the UE signals which minimum and maximum bitrates that are supported.
This is either done by defining a mode-set, which then explicitly shows what
lowest and highest codec modes that are allowed, or by not defining any mode-
set, which then implicitly shows that the lowest and highest codec modes
defined for the codec are allowed for the session.
It is here assumed that the maximum desired bitrate is the same as the maximum
allowed bitrate and can thus be derived from the allowed mode-set. However, it
is not always possible to derive the minimum desired bitrate since different
operators in the path may want to ensure different quality levels even if they
allow adapting to even lower bitrates.
There is no signalling in SDP of the minimum desired bitrate so the UEs will
not know the desired minimum bitrate for the other UE, if it is different from
the minimum supported bitrate. Correspondingly, the networks will also not
know the minimum desired bitrates for the UEs and the other networks, unless
it is the same as the minimum supported bitrate.
**Comments:**
For example, a session may be set up to allow for using the AMR 12.2, 7.4, 5.9
and 4.75 kbps codec modes, but UE-A or Operator A may want to use at the
minimum the 5.9 kbps codec mode for most sessions and may consider using the
4.75 kbps codec mode only in the worst case. Correspondingly, UE-B or Operator
B may want to use at the minimum the 7.4 kbps codec mode for most sessions but
may consider using the 4.75 codec mode in the worst case. Operator A and
Operator B will then set up the bearers to UE-A and UE-B differently. They
should use the same value for MBR, but it can be expected that the GBR values
are different and defined according to each operator\'s desired minimum
bitrate.
**Proposed requirement(s):**
The following requirement is proposed: \"_It should be possible to make the
network aware of the minimum and maximum desired bandwidth requirements
negotiated between the UEs for each media direction, if this is different from
the supported bandwidths._ \"
**Comments:**
This proposed requirement is also an aggregation of several \"atomic\"
requirements. This use case supports the following atomic requirement:
\- It should be possible to make the network aware of the minimum desired
bandwidth requirements negotiated between the UEs for the receiving direction.
The corresponding atomic requirement for the minimum desired bandwidth for the
sending direction is discussed for Use case D in clause 7.1.5.
The corresponding atomic requirements for the maximum desired bandwidths are
discussed for Use case K, see clause 7.1.12.
### 7.1.5 Use case D: Single multi-rate speech codec (AMR) with extra
bandwidth allocated for redundancy
**Gap(s):**
See gaps for Use case C. This use case identifies that there are no mechanisms
in SDP to indicate the minimum desired bitrate for the sending direction.
**Proposed requirement(s):**
The proposed requirement is the same as for Use case C, see clause 7.1.4. No
new requirements are needed for this use case.
**Comments:**
The atomic requirement for the minimum desired bandwidths for the receiving
direction is supported by Use case C. This use case supports the atomic
requirement for the minimum desired bandwidths for the sending direction.
### 7.1.6 Use case E: Several multi-rate speech codecs (AMR and AMR-WB)
**Gap(s):**
Same as for use cases B and C.
**Proposed requirement(s):**
The proposed requirement is the same as for Use cases B and C, see clauses
7.1.3 and 7.1.4, respectively. No new requirements are needed for this use
case.
### 7.1.7 Use case F: Single video codec, symmetric usage
**Gap(s):**
Same as for use case C. However, for video codecs there is typically no
signalling of the minimum supported bitrate. This means that a UE may adapt
quite frequently down to quality levels (bitrate, frame rate) that are
significantly lower than the operator preferences, especially if the remote
network assigns a lower GBR value than what used in the local network.
**Proposed requirement(s):**
The proposed requirement is the same as for Use case C, see clause 7.1.4. No
new requirements are needed for this use case.
### 7.1.8 Use case G: Single video codec, asymmetric usage, sending video with
a bitrate matching the codec level
**Gap(s):**
Same as for use cases D. There are codec parameters to indicate a higher (but
not lower) codec level for the receiving direction than for the sending
direction. The b=AS bandwidth indicates only the bitrate in the receiving
direction and there is no corresponding parameter for the sending direction.
The maximum bitrate in the sending direction can however be derived from the
codec level applicable to the sending direction.
**Proposed requirement(s):**
The proposed requirement is the same as for Use case D, see clause 7.1.5. No
new requirements are needed for this use case.
### 7.1.9 Use case H: Single video codec, asymmetric usage, sending video with
a bitrate lower than the supported codec level
**Gap(s):**
Similar to use cases D and G but the maximum bitrate for the sending direction
cannot be derived from the codec level that is applicable to the sending
direction.
**Proposed requirement(s):**
No new requirements are needed for this use case.
### 7.1.10 Use case I: Multiple video codecs
**Gap(s):**
Same as for use cases C and E. The difference from use case C is that there is
no information about the minimum supported bitrates in the SDPs, so the
network has less information that it can use when assigning resources.
**Proposed requirement(s):**
The proposed requirement is the same as for Use cases C and E, see clauses
7.1.4 and 7.1.6, respectively. No new requirements are needed for this use
case.
### 7.1.11 Use case J: Single video codec, symmetric usage, bitrate variations
**Gap(s):**
There is no information in the SDPs that informs the networks about the
bitrate variations that the UEs would like to utilize.
There is also no information in the SDPs or in the QoS parameters where the
network can indicate how large bitrate variations that are allowed.
There is also no definition in the EPC specifications of how the (average)
bitrate is calculated.
**Proposed requirement(s):**
The following requirement is proposed: \"_It should be possible to make the
clients aware of what bitrate variations are allowed or how the bitrate
average is calculated, e.g. in policing functions._ \"
### 7.1.12 Use case K: Several multi-rate speech codecs (AMR, AMR-WB and EVS)
**Gap(s):**
Same as for Use cases B, C, D, E and I with the addition that there is no
information in SDP about the maximum desired bandwidths for sending and
receiving directions.
**Proposed requirement(s):**
The proposed requirements are the same as described for Use cases B and C, see
clauses 7.1.3 and 7.1.5, respectively. No new requirements are needed for this
use case.
**Comments:**
The atomic requirements for the minimum desired bandwidths for receiving and
sending directions are supported by Use cases C and D, respectively. This use
case supports the atomic requirements for the maximum desired bandwidths for
sending and receiving directions.
## 7.2 Discussion on proposed requirements for new SDP attributes
The natural way of conveying information related to session and/or media
bandwidths between the clients and the network nodes is to use SDP, especially
for the end-to-end case. It is therefore foreseen that new SDP attributes may
need to be designed. Such new SDP attributes should preferably be future proof
and so that they can be extended to also fulfil the needs of services and
media that are not considered at this point in time. This gives the following
proposed requirement: \"_New SDP attribute(s) should allow for future
extensions._ \"
Any new SDP attributes also need to be backwards compatible with other already
existing SDP attributes. The introduction of new SDP attributes should not
prevent the usage of other SDP attributes. This gives the following proposed
requirement. \"_New SDP attribute(s) should be backwards compatible with
existing attributes and offer/answer negotiation process._ \"
When introducing new SDP attributes, it is likely that this is done in a
gradual, incremental fashion. Some networks may add support for the new SDP
attributes early while it can be expected that other networks continue to use
only the legacy SDP attributes, possibly for a long time. Existing resource
allocation functions need to work as good or as bad as they work today also in
the future when new SDP attributes are used. This gives the following proposed
requirement: \"_The existing functionality for resource allocation in legacy
networks should not be affected by the introduction of new SDP attributes._ \"
## 7.3 Discussion on proposed general requirements for the solution
The use cases in the present document have discussed speech and video media
and a limited number of codecs. For any solution to become widely accepted and
used, the solution needs to be designed in such a way that it is generic and
can be reused for any service, any media, any codec and any codec
configuration. This gives the following proposed requirement: \"_The solution
should be generic and reusable for all services, media types and codecs._ \"
With a generic solution follows also a need to make it specific, so that it
can be optimized to work well for any service, any media, any codec and any
codec configuration. The solution therefore needs to be configurable. This
gives the following proposed requirement: \"_The solution should allow
configuration in clients and/or network nodes to be able to adapt its usage to
different services, media types and codecs._ \"
A difference from the existing QoS mechanisms used for the local resource
reservation is that the intention in this work is to find a solution that can
be used by all networks in the path as well as the end-points. This gives the
following proposed requirement: \"_The solution should be usable by all
networks and end-points._ \"
## 7.4 Summary of proposed requirements
Proposed requirements:
\- It should be possible to make the network aware of the minimum and maximum
supported bandwidth requirements negotiated between the UEs for each media
direction.
NOTE 1: The maximum supported bandwidth may be used to derive the MBR and/or
for policy enforcement. The minimum supported bandwidth may be used to
indicate the expected lower bound for the adaptation, e.g. used by MGWs.
\- It should be possible to make the network aware of the minimum and maximum
desired bandwidth requirements negotiated between the UEs for each media
direction.
NOTE 2: The minimum desired bandwidth may be used to derive the GBR. The
minimum and/or maximum desired bandwidths may be used for the admission
control, e.g. to determine how many users can be admitted in order to ensure a
certain desired quality level.
\- It should be possible for the clients to know what bitrate variations are
allowed or how the bitrate average is calculated, e.g. in the policing
functions.
Proposed requirements for the design of new SDP attributes:
\- New SDP attribute(s) should allow for future extensions.
\- New SDP attribute(s) should be backwards compatible with existing
attributes and offer/answer negotiation process.
\- The existing functionality for resource allocation in legacy networks
should not be affected by the introduction of new SDP attributes.
NOTE 3: Since legacy networks are expected to ignore any new SDP attributes,
the UEs cannot assume that all networks in the path use the information
included in the new SDP attributes.
Proposed requirements for the solution design:
\- The solution should be generic and reusable for all services, media types
and codecs.
\- The solution should allow configuration in clients and/or network notes to
be able to adapt its usage to different services, media types and codecs.
\- The solution should be usable by all networks and end-points.
# 8 Potential solution(s)
Editor\'s note: The clauses below will be repeated for each identified
potential solution.
## 8.1 Potential solution A
### 8.1.1 Description of the solution
### 8.1.2 Compliance with proposed requirements
### 8.1.3 Impact on networks and terminals
# 9 Conclusion and recommendations
#