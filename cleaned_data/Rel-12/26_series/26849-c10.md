# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
MooD is about enabling the setup of an MBMS user service on the fly and
seamlessly migrating an existing service to an MBMS user service, about
judging a unicast service to see if it would be better served by broadcast or
unicast, and about enabling an MBMS Broadcast Session for an ongoing MBMS User
Service where previously there was none active.
Specifically, MooD will investigate and specify enabling a BM-SC to convert a
non-MBMS unicast service as an MBMS User Service (already available in TS
26.346 [2]) and distributing the USD describing the aforementioned MBMS User
Service to interested UEs. Only services that can be expressed as an MBMS User
Service can be converted (i.e. RTP, DASH, file download including PSS
Progressive Download).
In addition, MooD will look into methods that may be able to determine or
assist in determining the consumption of a service, and look into elements
that may be able to be decision-makers on determining UC/BC transmission. The
level of specification of this aspect is TBD. MooD will also work towards
enable a USD to add an MBMS download or streaming session to an existing MBMS
user service if uptake is high.
It should be noted that MooD will investigate the level of MooD support for
UEs supporting pre-R12 MBMS. MooD will support at least MBMS Broadcast.
Support of MBMS Multicast is FFS and is considered lower priority.
# 1 Scope
The present document covers:
\- Use cases on the dynamically establishment of MBMS User Services to offload
unicast delivery of certain contents, either real-time or non-real-time based,
which reach a certain traffic volume due to the popularity of those contents.
\- Use cases for terminating a previously established MBMS User Service due to
subsequently decrease in its consumption.
\- Recommended requirements on the BM-SC and UE to support on-demand MBMS.
\- Gap analyses in the existing TR 26.346 specification for supporting the
recommended requirements for MooD operation.
\- High-level MBMS and unicast network architecture in the context of MooD.
\- Message sequence diagrams illustrating examples of MooD operation.
\- Description of solution frameworks that enable MooD operation, including
configuration data, necessary interaction between BM-SC and UE to activate or
trigger the MBMS client for reception of newly-established MBMS User Service,
and the reporting of ongoing consumption of the MBMS service to enable
measurement of ongoing demand for that service.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
> [1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 26.346: \"Multimedia Broadcast/Multicast Service (MBMS); Protocols
and codecs\".
[3] 3GPP TS 33.246: \"3G Security; Security of Multimedia Broadcast/Multicast
Service (MBMS)\".
[4] 3GPP TS 23.246: \"Multimedia Broadcast/Multicast Service (MBMS);
Architecture and functional description\".
[5] void
[6] IETF RFC 2326: \"Real Time Streaming Protocol (RTSP)\", Schulzrinne H.,
Rao A. and Lanphier R., April 1998.
[7] OMA Push Over The Air Protocol, Version 2.3, Nov 22, 2011,
http://technical.openmobilealliance.org/Technical/Release_Program/docs/Push/V2_3-20111122-A/OMA-
TS-PushOTA-V2_3-20111122-A.pdf.
[8] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
# 3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply. An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
> ADPD Associated Delivery Procedure Description
>
> BC Broadcast
>
> BM-SC Broadcast-Multicast-Service Center
>
> CDN Content Delivery Network
>
> CGI Cell Global Identification
>
> DASH Dynamic Adaptive Streaming over HTTP
>
> ECGI E-UTRAN Cell Global Identification
>
> FLUTE File Delivery over Unidirectional Transport
>
> HTTP HyperText TransferProtocol
>
> MBMS-GW Multimedia Broadcast and Multicast Service-Gateway
>
> MI-EMO MBMS Improvements -- Enhanced MBMS Operation
>
> MIME Multi-purpose Internet Mail Extensions
>
> MooD MBMS operation on Demand
>
> MO Management Object
>
> OMA Open Mobile Alliance
>
> OTT Over The Top
>
> PDN-GW (or P-GW) Packet Data Network-Gateway
>
> PAC Proxy Auto-Config
>
> PSS Packet-switched Streaming Service
>
> RAN Radio Access Network
>
> RRC Radio Resource Control
>
> RSS Rich Site Summary; a.k.a. Really Simple Syndication
>
> RTSP Real Time Streaming Protocol
>
> SAI Service Area Identification
>
> SIB2 SystemInformationBlockType2
>
> SIB3 SystemInformationBlockType3
>
> SIB15 SystemInformationBlockType15
>
> TMGI Temporary Mobile Group Identifier
>
> UC Unicast
>
> UE User Equipment
>
> URL Unified Resource Locator
>
> USD User Service Description
# 4 MBMS operation on Demand (MooD)
## 4.1 Introduction
MBMS operation on Demand represents an operational concept for MBMS and
associated technical architecture and functionalities which enable concurrent
demand by multiple users for a service or content item for unicast delivery to
be detected by a network operator, against a threshold based on operator
policy. This detection can be used to dynamically trigger the establishment,
at the BM-SC, of an MBMS User Service to offload the unicast network for
delivery of the same service or content to multiple users. Subsequently, the
BM-SC will initiate the typical processes for MBMS service
announcement/discovery and delivery. When concurrent user demand for that same
service/content drops below a configurable level (also set by operator
policy), the delivery mode can be configured to transition back from broadcast
to unicast.
## 4.2 Use Cases, Recommended Requirements, Gap Analysis and Working
Assumptions
### 4.2.1 Use Cases
#### 4.2.1.1 Use Case #1: Demand-based eMBMS for Real-Time (RT) Content
Sports action and news content provider \"SportsWorld\" makes its online
multimedia sports programming and news service, by the same name, available
over the Internet (a.k.a. \'Over-the-Top\' or OTT). LTE unicast access to the
service is offered in the country of Slobovia by its mobile network operator
\"SloWireless\". For the 2014 FIFO Global Cup Football championship game, the
team from Transmania is disqualified right before the game due to the
discovery of widespread substance abuse among its team members, and is
replaced by the team from Slobovia. The associated live coverage of the game
on SportsPlus becomes wildly popular in Slobovia. Two days later, SportsWorld
provides a breaking news story that the Slobovian players are actually robots
instead of humans, again attracting a large number of Slobovians to access the
SportsWorld site via their smartphones to follow the news developments.
SloWireless, which also provides eMBMS services, incurs a high and sustained
level of traffic on its LTE unicast network to/from the SportsWorld site due
to these events. Such high traffic volume not only stresses the capacity of
its unicast network, it also impairs the overall user experience due to more
frequent stalls during content reception, which is also of concern to the
content provider. Fortunately, SloWireless is capable of detecting dynamic OTT
traffic increase over its unicast network to any external site, and has the
means to dynamically provision an eMBMS service for unicast traffic
offloading. It also has a business agreement with SportsWorld to configure
demand-based eMBMS service as necessary.
#### 4.2.1.2 Use Case #2: Demand-based eMBMS for Non-Real-Time (NRT) Content
SportsWorld, the aforementioned sports news provider, also publishes RSS
(\"RDF Site Summary\" or \"Really Simple Syndication\", a.k.a.\'podcast\')
feeds covering different categories of sports news, interviews, highlights and
other information. Due to the popularity of the recent Slobovian Football team
incidents aired by this sports service, subscriptions to SportsWorld podcasts
increase dramatically. It would be more efficient for the high volume of such
RSS content delivery over the unicast network of SloWireless to be delivered
over broadcast/eMBMS bearer. SportsWorld has a business relationship with
SloWireless, for which the subscription events to the various RSS feeds
offered by SportWorld are measured and shared between the two companies. Upon
reaching a certain threshold for a given RSS feed, the mobile operator will
dynamically provision an eMBMS download delivery service to deliver the RSS
content according to a broadcast schedule.
#### 4.2.1.3 Use Case #3: Demand-based deactivation of eMBMS service
A couple weeks after the Slobovian Football team escapades, sports fans in the
country start to lose interest in on Slobovian Football news. Significant
drop-off is detected in user access to the SportsWorld site over the recently
provisioned eMBMS service by SloWireless. The operator decides that it i\'s no
longer beneficial for overall network utilization to maintain a dedicated
eMBMS broadcast of the SportsWorld service. In accordance with business terms
formerly agreed with SportsWorld, it deactivates this eMBMS service and the
associated network capacity is re‑allocated for carriage of unicast traffic.
#### 4.2.1.4 Use Case #4: Operator Control of eMBMS operation on Demand, Live
Streaming Service Support
In a shopping mall, many users are watching live program \'Joking time\' with
DASH, the cell which covers the shopping mall, is highly congested. New
passengers coming to the shopping mall have the hard time to access the
internet. Many UEs accessing DASH streaming are also eMBMS capable.
The congestion situation alerts the operator attention. The network
communicates with the UE to receive the DASH streaming content over MBMS
bearer and broadcast the live streaming content over MBMS bearer. Per
interaction with the network, the MBMS user service subscription is activated
and eMBMS capable UEs switch to eMBMS system and the congestion in the cell is
mitigated.
When the live \'Joking time\' is ongoing, some of users quit the program. Just
few users are still watching the program. At this moment, live \'breaking
news\' is on the air; many users click the link and starting watching
\'breaking news\'. The cell is becoming congested again. The network knows
that the number of viewers of \'Joking time\' is less than the number of views
of \'breaking news\', it decides to terminate the \'Joking time\' over MBMS
bearer and broadcast the \'breaking news\' over MBMS bearer. UEs quit the
\'Joking time\' MBMS user service and continue \'Joking time\' over DASH. The
viewers of \'breaking news\' can receive \'breaking news\' over MBMS bearer.
The cell congestion is avoided with dynamic MBMS user service update.
#### 4.2.1.5 Use Case #5: Content Aggregation
An operator provides a service with many TV live channels based on DASH.
Actually the operator acts as an aggregator for content producers and content
consumers. The TV channels include services of personalized reporters, local
news, many small production feeds. Channels may be referenced through social
networks and occasionally such channels get popular over time and the
popularity decreases again. The popularity may results from recommendations on
social sites, so the uptake is happening gradually. Also popularity may be
different in certain regions. The operator wants to ensure that in these high-
demand cases all MBMS-capable devices can consume these qualifying services
with high-quality without disturbing the user experience which includes
seamless service, availability of time-shift buffering, additional views and
components of the channel and possibly other features. The service provider
wants to deliver such popular services in a radio efficient manner.
### 4.2.2 Recommended Requirements & Evaluation Criteria
#### 4.2.2.1 General
Recommended requirements on functionality/capabilities to support the agreed
use cases for MI-MooD are as follows:
\- The BM-SC is able to provision a demand-based eMBMS service in substitution
of, or in addition to, unicast delivery of the same service/content.
\- The BM-SC, upon having dynamically transitioned the unicast service to an
MBMS User Service, may enable service delivery over unicast bearers only, over
MBMS bearers, or over both bearer types.
\- The BM-SC is capable, in a scalable manner, of providing indication to the
UE of each service that is eligible to be switched between a non-MBMS unicast
service and an MBMS User Service.
\- Upon obtaining awareness of low attachment rate/volume to broadcast
delivery of an existing MBMS User Service, the BM-SC can deactivate the MBMS
User Service.
\- Upon obtaining awareness of low attachment rate/volume to broadcast
delivery of an existing MBMS User Service, the BM-SC can disable service
delivery over an MBMS bearer and enable unicast-only delivery mode of the MBMS
User Service.
#### 4.2.2.2 UE-Supported Operation
The following recommended requirements are proposed for the solution that will
be specified in TS 26.346 [2]:
1) The solution for a potential MBMS user service provides the necessary
signalling as identified in the gap analysis above.
2) The solution for the potential MBMS user service provides a scalable
solution, both in terms of number of Potential MBMS User Services and in terms
of UEs involved when operating in unicast mode and in broadcast mode.
3) The solution for the potential MBMS user service provides the ability that
the uplink resources are used efficiently.
4) The solution for the potential MBMS user service provides the ability that
the amount of downlink resources are used efficiently.
5) The solution for the potential MBMS user service takes into account
relevant regulatory and privacy issues
6) The solution for a potential MBMS user service reuses existing MBMS
features to the extent possible, including features developed in other work
items during Rel-12 such MI-EMO.
7) The solution for a potential MBMS user service reuses existing features
such as common web technologies and HTTP features to the extent possible.
8) The solution for the potential MBMS user service minimizes the impact for
the user when migrating from a potential MBMS user service to an MBMS user
service.
9) The solution for the potential MBMS user service provides the ability to
run the MBMS user service as broadcast only mode as well as for a broadcast
and unicast mode.
10) The solution for the potential MBMS user service is at least enables for
DASH over MBMS as well as MBMS download delivery services that may be
augmented by associated delivery procedures providing repair through regular
HTTP servers.
11)The solution for the potential MBMS user service does not require changing
the formats of the potential MBMS user service when moving the service to an
MBMS user service, e.g. no transcoding to MBMS User service formats is
required.
12) The solution for the potential MBMS user service operates with minimum
processing overhead for the BMSC and other network components.
13) The solution for the potential MBMS user service is efficient in terms of
overhead, network usage, and UE battery consumption.
### 4.2.3 Gap Analysis & Evaluation
#### 4.2.3.1 General
This clause describes the deficiencies in the existing TS 26.346 [2] for
supporting the recommended requirements listed in clause 4.2.2.
##### 4.2.3.1.1 Dynamic and Demand-based MBMS User Service Establishment
No description or even mention exists in TS 26.346 [2] regarding dynamic and
demand-based provisioning of MBMS services. Up to now, it is assumed that MBMS
User Services are either provisioned statically by the service provider (e.g.
a mobile network operator), or variably over time but which do not rely on
real-time demand-based measurement of such content consumption via unicast
bearers, for dynamic conversion to delivery over MBMS bearers. Similarly, TS
26.346 [2] does not contain normative description of the means for the network
to inform the UE of the eligibility of unicast services for MBMS user service
conversion, nor how the UE currently consuming the unicast service might be
able to indicate to the network regarding its capability, or lack of such,
capability for receiving the service over broadcast.
##### 4.2.3.1.2 Dynamic and Demand-based MBMS User Service Termination
No description or even mention exists in TS 26.346 [2] regarding dynamic and
demand-based termination of MBMS services. While TS 26.346 [2], along with the
MBMS Security specification, TS 33.246 [3], define the MBMS User Service
deregistration procedure, resulting in service deactivation from the UE
perspective, nothing is said in either document about the termination of an
ongoing MBMS User Service from the network\'s perspective. For example, such
network-initiated MBMS User Service termination could be triggered by the
network\'s detection that a certain threshold, set by the service
provider/network operator, of MBMS user service deregistration events has been
exceeded, or that some form of network-based counting of actual content
consumption goes below a certain minimum level.
##### 4.2.3.1.3 Dynamic Conversion from Unicast to Broadcast Delivery
There is no description in TS 26.346 [2] on the technical means for the
service provider, upon detection of sufficiently high rate/volume of unicast
access to the same content or service in a common geographical area, by
multiple UEs, to consequently convert, in a dynamic fashion, such unicast
service to an MBMS user service for broadcast delivery.
#### 4.2.3.2 UE-Supported Operation
The following gaps are determined:
1) The ability that the BMSC informs MBMS-capable UEs about the Potential MBMS
User Service, in a scalable manner. The information may be done in one or more
of the following manners:
a) through a static configuration, e.g. the UEs are configured such that
certain services are always potential MBMS User services;
b) through device management, for example an operator may configure UEs
dynamically such that certain services are MBMS user services;
c) through the use of MBMS user service, for example to use a specific USD
that announces the service as a specific MBMS user service.
2) The ability that the UE continuously informs the BM-SC about the
consumption of the Potential MBMS User Service possibly enhanced with
location/consumption metadata, in a scalable manner. This may be done by one
or of the following ways:
a) the UE registers directly for the service and uses a specific API/protocol
to keep the BMSC informed;
b) by the use of specific HTTP requests that are generated according to the
configuration, e.g. to a specific proxy, potentially enhanced with query
parameters or cookies.
3) The establishment and announcement of an MBMS User service to the MBMS-
capable UEs that are currently consuming the service or MBMS-capable UEs that
are joining the Potential MBMS user service once the MBMS user service is
already established. This may be done by one or of the following ways:
a) Sending a USD to MBMS-capable UEs on a preconfigured API/protocol that is
defined in the configuration.
b) Sending a USD as part of the service distribution, either as part of the
service protocol or as part of the formats.
4) The ability that the UE continuously informs the BMSC about the consumption
of the UE in a scalable manner. This may be done by similar means as defined
in bullet point 2. This includes also the ability that the UE may signal the
termination of the service.
### 4.2.4 Assumptions
The following assumptions pertain to dynamic switching between unicast and
broadcast delivery modes of an MBMS User Service:
\- Business agreements enable the operator to convert the various content
feeds from unicast to broadcast delivery upon high demand of a nominal unicast
content/service.
\- The operator wants to accurately count the consumption of the service
taking into account the UE capabilities, the location of the UE, and the
actions of the user such as time-shift and so on.
## 4.3 Architecture
Figure 1 shows a high level MooD architecture. Upon the BM-SC\'s determination
of high attachment rate of a unicast service, **it activates an eMBMS user
service to carry the same content over the MBMS bearer. This conversion is
illustrated by** the unicast service whose transport is shown by the blue, red
or orange colored line to an MBMS user service carried on the MBMS bearer as
shown by the green-colored line.
Figure 1: High-level MooD architecture
## 4.4 Message Flows
### 4.4.1 High-Level Call Flow for UE-Supported MooD Operation
Figure 2 provides a call flow for the case where the UE supports MooD
operation in a sense that the MBMS-capable UEs \"inform\" the BMSC about the
consumption of the service and the BMSC is central to making MooD operation
decisions.
The physical implementation of the BMSC may be distributed, e.g. using a proxy
server for scalable distribution of the unicast content. However, in the
context of the present document, the focus is on logical entities that are
established in the 3GPP architecture and under control of SA4.
For the purpose of the call flow, the following is defined:
**Potential MBMS User Service:** A Non-MBMS User Service that may potentially
be migrated to an MBMS User Service.
> NOTE 1: In the call flow below, it is expected that the MI-MooD WI will
> require defining new normative signaling at least pertaining to the steps
> highlighted in _italics_. In addition, in a more refined version of this
> call flow, the MBMS-capable UE may be split into an MBMS UE and an
> Application Client.
{width="4.913888888888889in" height="9.359722222222222in"}
Figure 2: High-Level Call Flow for UE-Supported MooD Operation
1) The content server offers a service. The BMSC is made aware that this
service is a Potential MBMS User Service
2) _The BMSC informs MBMS-capable UEs about the Potential MBMS User Service_
3) _The MBMS-capable UE initially and continuously informs the BMSC about the
consumption of the Potential MBMS User Service, possibly enhanced with
location/consumption metadata. Sending this information is an implicit consent
of the UE to migrate to the MBMS User service. This may be done in one or more
of the following manners:_
\- _By direct registration for the service_
_\- By indirect registration using the regular data requests_
NOTE 2: Scalability needs to be taken in account for the mechanism used to
inform the BM-SC of the UE\'s consumption of the Potential MBMS User Service
4) Based on the information from the registration and/or other information the
BMSC continuously considers whether the service should be migrated to an MBMS
User Service.
5) The UE requests data for the Potential User Service in one of the following
manners:
\- directly to the content server;
\- using the BMSC as a proxy for the request and the BMSC forwards the
requests to the content server.
6) The UE receives the service as a regular unicast service.
7) At some point in time the BMSC may decide to initiate an MBMS User service
for Potential MBMS User service.
8) _The BMSC establishes an MBMS User Service with broadcast mode and informs
the MBMS-capable UEs that are consuming service about this._
9) The BMSC fetches the content from the Content Server and distributes it as
MBMS User service.
10) The BMSC starts distributing the content as MBMS User Service, typically
with broadcast mode enabled.
11) The UE joins the MBMS user service and receives the content through MBMS
user service.
12) The UE starts consuming content received through MBMS User Service.
13) _The UE continuously informs (taking account scalability) the BMSC about
the consumption of the service, and also provides deregistration of the
service._
NOTE 3: Scalability needs to be taken in account for the mechanism used to
inform the BM-SC of the UE\'s consumption of the MBMS User Service.
14) Based on the information from the registration and/or other information
the BMSC may decide to terminate the MBMS User service.
15) The BMSC informs the UEs consuming the MBMS User Service about the
termination.
16) The UE leaves the MBMS User service.
17) _The UE informs the BMSC that it has left the MBMS User service._
18) The UE starts requesting data of the Potential MBMS User Service through
unicast. The options are the same as in 3.
19) The BM-SC terminates the MBMS User service and continuous to provide the
Potential MBMS User Service.
### 4.4.2 Call Flow (From BC to UC)
Note that in the Figure 3 call flow below, it is expected that the MooD WI
will require defining normative new signalling at least for the steps
highlighted _in italics_.
Figure 3: Switching from BC to UC
In step 1 to 5 the UE consumes content as a regular MBMS user service. The
service may have initially been a non-MBMS user service.
1) The application requests content that is available through an MBMS user
service
2) The UE has access to the USD which indicates that MBMS user service is
available over both UC and BC delivery. The USD may indicate that the MBMS
user service is only available via BC by not including UC channel related
information.
3) _The UE informs the BM-SC that it wishes to acquire the MBMS user service.
Detailed signalling is TBD._ For example, this may be achieved by MBMS user
service registration for which the UE obtains the service key (MSK) if service
protection is enabled as specified in TS 26.346 [2]. Note that it is not
clearly indicated in TS 26.346 [2] whether the semantics of MBMS user service
registration refers to the device\'s consumption intent, or merely its intent
to be registered for the service to obtain all necessary information.
Therefore, other signalling than the MBMS registration may be necessary. See
step 6.
4) The UE detects that it is in broadcast coverage and enters BC access mode.
5) The content is received over MBMS bearer.
The remaining steps now support the MOOD aspects, namely to enable to turn an
MBMS user service into a non-eMBMS user service.
6) Procedures on the operation of the service are collected. These may be, but
are not limited to:
\- MCE counting procedures.
\- _BM-SC-based counting procedures based on registration/de-registration or
other means._
\- other operational aspects, e.g. the popularity of this MBMS user service or
other non-MBMS services. For detailed discussion on this matter also refer to
clause 4.4.1.
7) _At some point based on the collection of information, the BM-SC decides to
switch from BC to UC delivery based on counting, registration/deregistration
information, or other information (for example, a preconfigured timer
expires)._
8) _The BM-SC indicates that the MBMS transmission is about to stop. The
details are TBD. As an example:_
\- The BM-SC updates the USD.
\- The BM-SC uses the in-band Schedule Fragment to indicate the end of MBMS
transmission.
9) The UE detects that the MBMS broadcast delivery session is about to end
based on updated USD and/or in-band Schedule Fragment Info.
10) The UE establishes RRC connections before MBMS broadcast delivery session
end time.
11) The UE establishes PDN connection if needed.
12) The BM-SC performs MBMS broadcast delivery session stop procedures as
specified in TS 23.246 [4].
13) _The BM-SC updates the USD to indicate that the MBMS user service is only
available over UC. Alternatively, the MBMS user service is terminated by the
BM-SC by removing the service from the USD. The details are TBD._
14) The UE enters UC mode.
15) The UE get contents over the unicast.
### 4.4.3 Switching from non-eMBMS UC to eMBMS BC
#### 4.4.3.1 Description
In switching from non-eMBMS UC to eMBMS BC, it is assumed that the BM-SC
determines (e.g. it has detected or is informed of the occurrence of) high
attachment to a non-eMBMS service. The **BM-SC then activates eMBMS
transmission of the service, and subsequently switches content delivery from
UC delivery to BC delivery.**
The scenario is based on the following assumptions:
\- Business agreements enables the operator to convert the various content
feeds from unicast to broadcast delivery upon high demand of a nominal unicast
content/service.
#### 4.4.3.2 Call Flow (Network Redirection Based Solution)
This solution assumes that when the device application starts with a non-eMBMS
unicast service, the eMBMS client is not activated. The eMBMS client will be
activated based on network redirection which triggers the UE to acquire the
USD either through UC or BC. The network redirection can be HTTP/RTSP
redirection or can be other signaling sent from a network entity (for example,
using OMA Push). In the call flow presented here, the BM-SC converts a non-
eMBMS UC to eMBMS user service (see Figure 4).
Note that in the call flow below, it is expected that the MooD WI will require
defining normative new signalling at least for the steps highlighted _in
italics_.
Figure 4: Switching from non-eMBMS UC to BC (Network-based solution Approach)
1) The application requests a content item.
2) The UE requests the content item via a service through unicast. The
subsequently established OTT (Over the Top) or PSS over the unicast is
ongoing.
3) _The BM-SC decides to switch from non eMBMS unicast to eMBMS transmission
for the service. For example, this can be based on information on event or
detection on high rate attachment on non eMBMS unicast service. The BM-SC can
also consider the UE\'s UC to MBMS switching capability if that UE capability
is known to the BM-SC._
4) _The BM-SC provides a USD including information that the eMBMS service is
available over both UC and BC. The user service may include BC and UC related
information, or BC information only. If the BM-SC has already established
eMBMS session for USD (i.e. USD Broadcast Channel), the BM-SC can send updated
USD over that broadcast channel; otherwise, the BM-SC can establish eMBMS
session for updated USD (not shown in the call flow) or include USD update in
the UC to BC switching trigger later (see Step 7). The non-terminating arrow
indicates that the BM-SC makes the USD available by any means, e.g. broadcast
or unicast._
5) The BM-SC sets up an MBMS session as specified in TS 23.246 [4]. This step
can be performed in parallel with step 4.
6) The eNB applies radio resource configuration and sends updated SIB13 and
SIB15 if needed. The eNB perform MCCH change notifications to inform all UEs
of the presence of the eMBMS service.
7) _Once the MBMS session has been established, a trigger is provided to UEs
consuming the non-eMBMS service on the availability of a MBMS User Service for
the service. This step may include UC to BC switching trigger or UC to BC
switching trigger plus USD update. The detail method is TBD._
8) _The trigger results that the UE may activate the MBMS client, if the UE
has the proper capabilities._
9) _The UE initiates service discovery procedures to receive USDs through the
broadcast channel if available or through the unicast bearer otherwise. Once
the UE has received the USD, is in coverage, and is consuming the service, the
UE switches from UC to BC reception._
10) If the UE has not registered with the newly-established MBMS service and
USD indicates that service registration is required, the UE performs MBMS
service registration and obtain the service key if service protection is
enabled.
11) From the information received from SIB15 over the air and USD from the BM-
SC, if the corresponding MBMS service is transmitted on a different frequency,
the UE sends the \'MBMSInterestIndication\' message to indicate the interested
frequency. The eNB then hands over the UE to the proper frequency. The UE
subsequently updates system information from the SIB sent on the new
frequency.
12) The BM-SC gets content, for example, from the content server or PSS
server. This step may occur any time after Step 5.
13) The BM-SC sends that content over the MBMS bearer.
14) The unicast connection is torn down if there is no other unicast service.
### 4.4.4 MBMS User Service UC to BC MooD Example Flows
#### 4.4.4.1 Flow 1 -- Consumption Reporting enabled on unicast
##### 4.4.4.1.1 Assumptions and pre-conditions
\- SIB15 is available to the UE before and during service consumption on
unicast and broadcast.
\- MBMS Service Announcement made available to the UE before service
consumption on unicast. The r9:_availabilityInfo_ element in the USD includes
SAIx, which is also present in SIB15.
\- MBMS Client is active.
\- It does not impact SIB15 parameter setting by the RAN.
\- Both r12: unicastAppService and r12: broadcastAppService element are
included in the USD, however, the MBMS bearer is not set up by the network yet
while the UE is consuming the service on unicast.
\- The value of serviceArea element in the deliveryMethod element is pre-set
through a candidate coverage area information.
\- SIB2 and SIB13 are broadcasted by the cell.
\- _location_ element in _r12:consumptionReport_ indicates MBMS SAI.
\- No MBMS SAI change throughout (i.e. UE located in the same MBMS SAI).
\- _reportClientID_ is set to true in ADPD.
\- In this flow, UE MBMS Client is assumed to handle all the UE functions that
are not the UE DASH Client functions. E.g. HTTP local cache, FLUTE receiver,
MBMS service announcement receiver, other MBMS functions, etc.
\- BMSC to content server interface is not standardized.
##### 4.4.4.1.2 Flow 1 Sequence
{width="6.496527777777778in" height="8.315972222222221in"}
Figure 5: Consumption Reporting Enabled on Unicast
##### 4.4.4.1.3 Flow 1 Description
**Steps 1:** The UE gets the MBMS service announcement over unicast. It gets
the USBD, USD, ADPD, MPD, etc.
**Step 2:** The UE MBMS Client detects and read periodically SIB 15, and store
the SAIs from it. In this case, SAIx is stored
**Steps 3, 4:** DASH Client obtains the MPD from UE MBMS Client.
**Steps 5:** DASH Client request first segment to the UE MBMS Client
**Step 6, 7:** The UE MBSM Client detects the first segment request for one of
the service part of the USBD, thus it is recognized that the service is an
MBMS User Service and the service is only available over unicast. The USD for
the service includes SAIx. Furthermore, since the ADPD for the service
includes r12:consumptionReport, the UE MBSM Client sends a Consumption Report
including the clientId, serviceId associated to the selected service, SAIx
(from step 2) and an indication of start of unicast consumption.
**Steps 8-10:** First DASH segment requested from content server and delivered
to the UE Dash Client.
**Steps 11-14:** DASH Client requests and gets segment n+1 from content
server. These steps are repeated as necessary, for subsequent segments for UE
consumption of the MBMS User Service over unicast.
**Step 15, 16:** Once the periodic consumption reporting time is reached, the
UE MBMS Client sends a Consumption Report including the clientId, serviceId,
SAIx (from step 2) and an indication of periodic reporting of the MBMS User
Service over unicast. This step is repeated at each reporting period timeout,
until step 22.
**Step 17:** BMSC detects that there are enough UEs consuming the service on
unicast in SAIx, and decides to trigger the sending of the service over an
MBMS bearer.
**Step 18:** BMSC sets up an MBMS bearer for serviceId in SAIx.
**Step 19** : UE acquires the service on MBSM bearer.
**Step 20, 21:** UE MBMS Client sends a Consumption Report to the BMSC,
including the clientId, serviceId, SAIx (from step 2) and an indication of
transition of consumption over MBMS bearer.
**Steps 22-24:** BMSC fetches the following DASH segment (m+1) from the
content server and sends it on the MBMS bearer. UE MBMS Client reads and store
the DASH segment received over the MBMS bearer.
**Steps 25-26:** UE DASH Client fetches the DASH segment from the UE MBMS
Client.
**Step 27-28:** Upon detection of periodic timer expiration, the UE sends a
Consumption Report including the clientId, serviceId, SAIx (from step 2) and
the indication of periodic reporting for consumption of the MBMS User Service
over an MBMS bearer.
#### 4.4.4.2 Flow 2 -- Mobility (SAI change)
##### 4.4.4.2.1 Assumptions and pre-conditions
\- SIB15 is available to the UE before and during service consumption on
unicast and broadcast.
\- MBMS Service Announcement made available to the UE before service
consumption on unicast. The _r9:availabilityInfo_ element in the USD includes
SAI3 and SAI4.
\- MBMS Client is active.
\- It does not impact SIB15 parameter setting by the RAN.
\- Both r12:unicastAppService and r12:broadcastAppService element are included
in the USD, however, the MBMS bearer is not set up by the network yet while
the UE is consuming the service on unicast.
\- SIB2 and SIB13 are broadcasted by the cell.
\- The value of serviceArea element in the deliveryMethod element is pre-set
through a candidate coverage area information.
\- SAI change in unicast (SAI3  SAI4).
\- _reportClientID_ is set to true in ADPD.
\- _location_ element in r12:consumptionReport indicates MBMS SAI.
\- In this flow, the UE MBMS Client is assumed to handle all the UE functions
that are not the UE DASH Client functions. E.g. HTTP local cache, FLUTE
receiver, MBMS service announcement receiver, other MBMS functions, etc.
\- BMSC to content server interface is not standardized.
##### 4.4.4.2.2 Flow 2 Sequence
{width="6.2375in" height="7.3805555555555555in"}
Figure 6: Mobility (SAI Change)
##### 4.4.4.2.3 Flow 2 Description
**Steps 1:** The UE gets the MBMS service announcement over unicast. It gets
the USBD, USD, ADPD, MPD, etc.
**Step 2:** The UE MBMS Client detects and read periodically SIB 15, and store
the SAIs from it. In this case, SAI3 is stored.
**Steps 3, 4:** DASH Client obtains the MPD from UE MBMS Client.
**Steps 5:** DASH Client request first segment to the UE MBMS Client.
**Step 6, 7:** The UE MBMS Client detects the first segment request for one of
the service part of the USBD, thus it is recognized that the service is an
MBMS User Service and the service is only available over unicast. The USD for
the service includes SAI3 and SAI4 (step 1). Furthermore, since the ADPD for
the service includes r12:consumptionReport, the UE MBMS Client sends a
Consumption Report including the clientId, serviceId associated to the
selected service, SAI3 (from step 2) and an indication of start of unicast
consumption.
**Steps 8-10:** First DASH segment requested from content server and delivered
to the UE Dash Client.
**Steps 11-14:** DASH Client requests and gets segment n+1 from content
server. These steps are repeated as necessary, for subsequent segments for UE
consumption of the MBMS User Service over unicast.
**Step 15, 16:** Once the periodic consumption reporting time is reached, the
UE MBMS Client sends a Consumption Report including the clientId, serviceId,
SAI3 (from step 2) and an indication of periodic reporting of the MBMS User
Service over unicast. This step is repeated at each reporting period timeout,
until step 25.
**Step 17:** The UE MBMS Client reads SIB 15, and store the SAIs from it. In
this case, SAI4 is stored.
**Step 18, 19:** UE detects a location change in SAI from SAI3 to SAI4. SAI4
is in the USD, thus the UE triggers a Consumption Report including the
clientId, serviceId, SAI4 (from step 17) and an indication of location change
while consuming the MBMS User Service over unicast.
**Step 20:** BMSC detects that there are enough UEs consuming the service on
unicast in SAI4, and decides to trigger the sending of the service over an
MBMS bearer.
**Step 21:** BMSC sets up an MBMS bearer for serviceId in SAI4.
**Step 22** : UE acquires the service on MBSM bearer.
**Step 23, 24:** UE MBMS Client sends a Consumption Report to the BMSC,
including the clientId, serviceId, SAI4 (from step 17) and an indication of
transition of consumption over MBMS bearer.
**Steps 25-27:** BMSC fetches the following DASH segment from the content
server and sends it on the MBMS bearer. UE MBMS Client reads and store the
DASH segment received over the MBMS bearer.
**Steps 28-29:** UE DASH Client fetches the DASH segments from the UE MBMS
Client.
**Step 30, 31:** Upon detection of periodic timer expiration, the UE sends a
Consumption Report including the clientId, serviceId, SAI4 (from step 17) and
the indication of periodic reporting for consumption of the MBMS User Service
over an MBMS bearer.
#### 4.4.4.3 Applicability to non-DASH services
In the above flows, it is assumed that the UE is consuming a 3GP-DASH service,
and in that case the _deliveryMethod_ in the USD includes a
_r12:unicastAppService_ element, as currently specified in TS 26.346 [3]. It
would have been possible for the UE to consume a non-DASH service as the MBMS
User Service, and in that case the _deliveryMethod_ in the USD would have
included the _r8:alternativeAccessDelivery_ element instead.
#### 4.4.4.4 Location in ADPD r12:consumptionReport
The location element in the r12consumptionReport in the ADPD may indicate
either CGI, ECGI or MBMS SAI. It is expected that in a given deployment makes
use of a single location type, so there is no mix for e.g. of Consumption
Reporting based on MBMS SAI, and Consumption Reporting based on ECGI, or
Consumption Reporting based on CGI.
### 4.4.5 Solution
#### 4.4.5.1 MBMS Service Initiation
##### 4.4.5.1.1 MooD Configuration and USD Delivery
When the network detects a high rate or volume of attachment to a unicast
service, it may decide to convert, with support from the BM-SC, the unicast
service to an MBMS user service via MBMS bearer delivery to offload the
unicast traffic. The BM-SC may consider whether those UEs performing unicast
access are MooD-capable if such UEs\' capabilities are known to the BM-SC.
This can be achieved by restricting the OMA DM server to only send MooD
configuration data to MooD-capable UEs so that non-capable UEs will not use
the proxy server specified in MooD configuration.
The BM-SC will send a USD, or update an existing USD should other MBMS
services be already in use, by announcing the new MBMS user service and its
availability over broadcast and/or unicast delivery. The USD/updated USD is
specified as follows:
1) Use of the _r12:broadcastAppService_ and/or _r12:unicastAppService_
elements under the _deliveryMethod_ child element of the
_userServiceDescription_ element to identify whether the content is carried
over broadcast and/or unicast transport. Most likely, editorial change to
clause 7.6 of TS 26.346 will suffice, to indicate that existing mechanisms
defined for supporting unicast fallback and mobility-based transport switching
of application service access are also applicable to MooD operations.
2) Use of the _r12:appService_ child element of the _userServiceDescription_
element for providing the identities of identical and alternative versions of
an application service content item which can be substituted for one another,
in accordance to MooD operation, or operator policy (e.g. \"only broadcast
reception of content is allowed when the UE is redirected to broadcast
reception and the UE is within MBMS coverage\"). In addition, a unified MPD
(via corresponding Media Presentation Description fragment) that describes
both broadcast and unicast Representations is included in updated USD to
enable the UE to associate the service which is receiving through unicast with
MBMS user service.
If the BM-SC has already established a FLUTE session for USD delivery, the BM-
SC can send the USD/ updated USD over that broadcast channel; otherwise, the
BM-SC can establish a FLUTE session for sending USD/updated USD using the
existing MBMS session establishment procedure.
##### 4.4.5.1.2 Options for Redirection to MBMS Delivery
Upon having prepared the USD/updated USD for the newly-established MBMS user
service, the BM-SC then sends a redirection/trigger message to the UE to
redirect the UE to switch from unicast to broadcast reception. The following
alternative mechanisms may be considered:
Option 1: Send an indication along with the content provided in an HTTP
response to trigger UE access to the USD/updated USD over a unicast or MBMS
bearer:
\- Option 1A: HTTP 200 OK with 3GPP Extension Header containing an indication
for triggering UE reception of USD/USD-update. HTTP 200 OK includes the
segment that the UE has requested. An example call flow for the Option 1A
method is shown below in Figure 7.
\- Option 1B: HTTP 3xx Redirect with 3GPP Extension Header which prompts the
UE to initiate reception of the USD/updated USD. The redirection URL
represents a different location for the same requested resource. For example,
the redirection URL might be http://example.com/redirect/per-x/rep-y/seg-z.3gp
if the original request URL was http://example.com/per-x/rep-y/seg-z.3gp. The
3GPP-defined HTTP extension header might be named \"Trigger-MBMS\", with the
value \"Get-USD\", in which case the HTTP response message to the content
request by the UE with 3xx status code is accompanied by the response header:
\"Trigger-MBMS: Get-USD\". An associated call flow example for the Option 1B
method is shown below in Figure 8.
Option 2: Send the USD/updated USD together with the content provided in an
HTTP response to the UE by encapsulating the requested Segments and
USD/updated USD in a multipart MIME container.
Option 3: Using the OMA Push mechanism as specified in Clause 7.4 to send
USD/updated USD to UE over unicast channel.
Regardless of which option is used, the UE should continue using the unicast
channel to fetch content when the UE is acquiring a new USD or updated USD via
either unicast or broadcast transport. Once the UE can fully receive the
content from the MBMS bearer, the unicast channel can be released.
##### 4.4.5.1.3 Selected Method
In the case of unicast DASH streaming, the \"HTTP 200 OK with 3GPP Extension
Header\" method as described in Option 1A is deemed as the most preferable
among the alternative solutions. In general, the preferred response code or
method is dependent on the usage scenario -- for example, the unicast
streaming method (HTTP or RTP/RTSP), and for HTTP access, whether the resource
is a short file requiring low-latency response, vs. a large file for which
there is no need for stringent temporal response.
##### 4.4.5.1.4 MooD Service Initiation Call Flows
##### 4.4.5.1.4.1 Introduction {#introduction-2 .H6}
This clause provides two example call flows that correspond to the \"UE-
Elected Offloading\" method for MooD service initiation, and a call flow that
corresponds to the \"Network-Elected Offloading\" method.
##### 4.4.5.1.4.2 Example Call Flows for UE-Elected MBMS Offloading {#example-
call-flows-for-ue-elected-mbms-offloading .H6}
For the UE-elected offloading method, the example call flow below in Figure 7
illustrates the Option 1A based MooD service initiation procedure as triggered
by the use of an HTTP 2xx response code from the proxy server function which
includes the MooD header to activate the MBMS client. The diagram shows the
proxy server function to be part of the BM-SC, as an example implementation.
The proxy server function may also be a separated network function from the
BM-SC.
Figure 7: Example Call Flow for UE-Elected Offloading Using Option 1A
1) The application provides the URL to the MPD to the DASH client.
2) The DASH client, via the local HTTP proxy/cache in the UE, requests the MPD
from the Content Server over unicast.
3) The Content Server returns the requested MPD via unicast to the DASH client
via the local HTTP proxy/cache.
> 4a) From information in the MPD, the DASH client selects a specific DASH
> Representation and Segment of a specific Period (in this example, Segment 1
> of the 256 kbps-encoded video Representation of Period 3). Assuming that the
> chosen content is eligible for MBMS offloading, the UE, via the local HTTP
> proxy/cache, sends the request to the designated network proxy server
> function, and attaches its location in the 3GPP-defined HTTP extension
> header, i.e. the \"MooD header\".
>
> 4b) The proxy server function in turn forwards the request from the UE to
> the Content Server containing DASH Segments, but does not include the MooD
> header in the request.
5) The Content Server returns the requested Segment to the DASH client via the
proxy server function and the UE\'s HTTP proxy/cache.
6) Steps 5 and 6 are repeated prior to detection of high unicast demand for a
particular content deemed eligible for MBMS offloading by the proxy server
function.
> 7a) The proxy server function detects high unicast demand in one or more
> geographical areas based on the reported UEs\' locations in the requests for
> content deemed eligible for offloading to MBMS, and informs the BM-SC of
> such event.
>
> 7b) BM-SC enables MBMS delivery of the previously unicast content in one or
> MBMS service areas in accordance to the detected locations of service
> popularity.
8) BM-SC requests for and obtains the unicast MPD from the Content Server
containing MPD.
9) BM-SC produces the MPD for the newly-created MBMS User Service, which may
be a unified MPD conveying all available Representations (for MBMS bearer
delivery and fallback to unicast bearer).
10) The USD for the new MBMS service is delivered on the download session
allocated for USD transport.
11) The Content Server provides to the BM-SC all Segments of the DASH Media
Presentation available for MBMS delivery.
12) The BM-SC sends an indication to the proxy server function that the latter
should trigger or activate the UE for future MBMS reception of the requested
content.
> 13a) The DASH client sends request to the proxy server function for Segment
> M of the same Representation it had been receiving over unicast, including
> the UE\'s location in the MooD header, via the UE\'s HTTP proxy/cache.
>
> 13b) The proxy server function forwards the request from the UE to the
> Content Server containing DASH Segments, but does not include the MooD
> header in the request.
>
> 14a) The Content Server returns the requested Segment to the proxy server
> function.
>
> 14b) The proxy server function sends to the an HTTP 2xx response containing
> the requested Segment in the entity body, along with the 3GPP-defined MooD
> header as HTTP extension header. Included in the MooD header is the service
> identifier of the newly-established MBMS User Service, in the form of the
> _serviceId_ element of the USD.
15) The local HTTP proxy/cache sends indication to activate the MBMS client.
16) Steps 14-15 involving continued unicast access of Segments are repeated
until the dynamic MBMS service is set up at the UE.
> 17a and b) Upon activation, the MBMS client obtains the USD and related
> fragments including the MPD over the MBMS bearer or the unicast bearer.
18) The MBMS client activates reception of the FLUTE session for the MBMS User
Service whose _serviceId_ in the USD matches the _serviceId_ value that it had
earlier received in step 14b from the proxy server function.
19) The MBMS client is now fully ready to receive Segments over the MBMS
bearer.
20) Segments (and subsequent MPD updates, if any) for MBMS service X are
received by the MBMS client on the activated FLUTE session for MBMS Service X.
21) The MBMS client forwards received Segments and/or MPD updates for service
X to the local HTTP proxy/cache.
22) The MBMS client informs the local HTTP proxy/cache to directly serve
contents to the DASH client for future Segment requests.
23) The DASH requests Segment N of the DASH Media Presentation on service X.
24) The local HTTP proxy/cache delivers the requested Segment N to the DASH
client via a 200 OK response.
Steps 24-25 are repeated as long as the DASH client continues to request
subsequent Segments of this DASH Media Presentation on MBMS Service X.
The example call flow below in Figure 8 illustrates the Option 1B based MooD
service initiation procedure as triggered by the use of an HTTP 3xx response
code from the proxy server function which includes the MooD header to activate
the MBMS client. The diagram shows the proxy server function to be part of the
BM-SC, as an example implementation. The proxy server function may also be a
separated network function from the BM-SC.
Figure 8: Example Call Flow for UE-Elected Offloading Using Option 1B
> 1 -- 12) Identical to steps 1-12 in call flow #1 as shown in Figure 5.
13) The DASH client\'s request for Segment M of the same Representation it had
been receiving over unicast, including the UE\'s location contained in the
MooD header, is received by the network proxy server function.
14) The proxy server function returns an HTTP 3xx response with a redirection
URL in the Location header, along with the 3GPP-defined MooD extension header
to activate the MBMS client, which is received by the local HTTP proxy/cache
in the UE. Included in the MooD header is the service identifier of the newly-
established MBMS User Service, in the form of the _serviceId_ element of the
USD.
> 15a) (Optional) The local HTTP proxy/cache sends a redirected request for
> Segment M, which includes the UE\'s location in the MooD header, to the
> proxy server function.
>
> 15b) (Optional) The proxy server function forwards the request from the UE
> to the Content Server containing DASH Segments, but does not include the
> MooD header in the request.
16) (Optional) The content server returns the requested Segment M via a 200 OK
response, which reaches the DASH client via the network proxy server function
and the local proxy/cache.
Note: Steps 15a, 15b and 16 are optional. Depending on the specifics of the
3xx redirection, transition of content delivery and reception from the unicast
bearer to the MBS bearer can occur either seamlessly, or could be associated
with a \"break-before-make behavior\". Furthermore, although not depicted by
the implementation scenario as shown in Figure 2, the requested content may
correspond to a long, non-real time file, for which there is no need to ensure
the \"make-before break\" functionality. In that case, steps 15a, 15b and 16
will similarly be absent, and the delivery of the file requested by the client
application in step 13 will the deferred until the MBMS client has begun
reception of the file over the MBMS bearer.
17) The local HTTP proxy/cache sends indication to activate the MBMS client.
18) Steps 13-16 involving unicast Segment requests that encounter the HTTP 3xx
responses from the network proxy server function, followed by subsequent
redirected requests for and returned Segments from the content server, are
repeated until the dynamic MBMS service is set up at the UE.
> 19 -- 27) These steps are identical to and map 1:1 to steps 17-25 of call
> flow #1 in Figure 1 (i.e. step 19 in call flow #2 corresponds to step 17 in
> call flow #1, step 20 in call flow #2 corresponds to step 20 in call flow
> #1, and so on).
##### 4.4.5.1.4.3 Example Call Flow for Network-Elected MBMS Offloading
{#example-call-flow-for-network-elected-mbms-offloading .H6}
Note 1: In this call flow, it is assumed that the P-GW is configured by the
operator to send requests for unicast content eligible for MooD offloading to
the HTTP Proxy server. Doing so avoids the need for the proxy server to
measure the unicast traffic demand for every conceivable content item
accessible to the UE over the unicast network, nor does the MooD Configuration
MO have to be provisioned to the UE. Also, it is noted that although as shown,
it is the proxy server that determines the MBMS capability of the UE by
examining the MooD header, such determination of UE\'s MBMS capability could
instead also be performed by the P-GW, and indicated to the proxy server for
demand measurement.
Figure 9: Example Call Flow for Network-Elected Offloading
1) The application provides the MPD URL to the UE.
> 2a) The UE requests the MPD file via HTTP proxy from content server over
> unicast. A MooD-capable UE will include the MooD header field in the HTTP
> GET request. Indication that the UE is MooD capable is conveyed by the MooD
> header containing solely the field-name followed by a colon (\":\"), i.e.
> absence of a field-value in the header. The UE\'s location will be included
> in the MooD header if the MooD Configuration MO is not present in the UE and
> is preconfigured with a rule to indicate its location in the HTTP request.
> The UE location can serve as implicit indication that the UE is MooD
> capable.
>
> 2b) The proxy server forwards the request from the UE to the Content Server,
> but does not include the MooD header in the request.
>
> 3) The MPD file is delivered back to UE via HTTP proxy.
>
> 4a) The UE requests a Segment object via HTTP proxy from content server over
> unicast. A MooD-capable UE will include the MooD header field in the HTTP
> GET request.
>
> 4b) The proxy server forwards the request from the UE to the Content Server,
> but does not include the MooD header in the request.
>
> 5) The Segment object is delivered back to UE via HTTP proxy.
>
> 6a) The HTTP proxy detects the high attachment event through the counting of
> UE request with MooD header.
>
> 6b) If MooD header includes UE\' location information, the HTTP proxy
> obtains UE\'s location information directly from the request. Otherwise, If
> the MooD header include MooD capability indication, then the HTTP proxy acts
> as an AF to obtain the location information from the PCRF as specified by TS
> 29.214 (Rel-12). This step can also be performed after step 4a and before
> step 11.
>
> 7) The HTTP proxy decides to trigger eMBMS mode switch, and passes MPD
> information and UE\'s location information to the BM-SC.
Note 2: Only MooD-capable UE\'s information will be passed to the BM-SC.
8) The BM-SC decides to switch from non eMBMS unicast to eMBMS > transmission
for the content delivery. USD is constructed based on > the MPD information
and UE\'s location information.
> 9) The BM-SC provides a USD including information that the eMBMS service is
> available over both UC and BC. The BM-SC notifies the HTTP proxy with USD
> URL, and the UE\'s identification indicating its eligibility for future MBMS
> reception. For those UEs which are not served by the eMBMS, will be served
> by the HTTP proxy over unicast.
Note 3: The interface between the HTTP proxy and BM-SC is not standardized at
this release.
> 10a) HTTP proxy obtains the content from the content server.
>
> 10a.1) HTTP proxy delivers the contents to the BM-SC.
>
> 10b) As an alternative to 10a), the BM-SC obtains the content from the
> content server.
11) The new Segment request message including MooD header comes to the > HTTP
proxy.
12) The HTTP proxy sends either a 2xx response carrying the requested >
Segment or a 3xx response with a redirection URL, along with the > MooD header
(including USD URL), which prompts the UE to activate > its MBMS client. To
enable seamless transition from unicast to > broadcast reception, unicast
delivery of DASH Segments will > continue until the UE\'s MBMS client is ready
to receive content > via the MBMS bearer, at which time delivery will be
switched from > unicast to broadcast.
13) The BM-SC establishes the MBMS bearer and sends the content over > MBMS
bearer.
14) The UE activates the MBMS client.
> 15a) The UE may obtain the USD from the HTTP proxy over unicast.
>
> 15b) As an alternative, the UE obtains USD over broadcast.
15) The UE is now MBMS-ready to receive the next Segment over the MBMS >
bearer to facilitate unicast-to-broadcast switch.
16) The UE obtains Segment content over broadcast.
#### 4.4.5.2 MooD Consumption Reporting
##### 4.4.5.2.1 Introduction
This clause proposes a solution mechanism for assisting the MBMS service
operator in determining the actual consumption of an MBMS user service. Based
on more accurate knowledge of ongoing demand for an MBMS user service, the
operator may choose to terminate the MBMS user service, or temporarily switch
to unicast-only delivery of that service.
##### 4.4.5.2.2 Solution Options
**For MooD operation, it is desirable for the network to disable MBMS
transmission when the number of the UEs consuming the MBMS user service is
below a certain network configured threshold in the area. There are a few
possible means for the network to decide whether to terminate an MBMS user
service, for example:**
1) The network could disable MBMS transmission upon expiration of a
preconfigured timer. This timer-based mechanism may be suitable for use when
the prior decision to turn on MBMS transmission was initiated by some specific
event.
2) Using MCE counting procedures. For example, after the MCE detects the
number of UEs that are interested in an MBMS User Service falls below a
certain **threshold** , it sends such notification to the BM-SC. Currently MCE
counting is not accurate since it does no\'t include UEs that are receiving
MBMS User Service in idle state. In addition, MCE counting belongs to the
scope of 3GPP RAN2. SA4 might consider making a request to RAN2 to provide an
improved solution for MCE counting, for example one that supports the
following capabilities:
\- Enhance current RAN counting to include RRC_IDLE UEs in addition to those
in RRC_CONNECTED state.
\- Allow the UE to report autonomously when it starts or stops consumption of
a given MBMS User Service.
\- Allow the UE to report periodically the consumption of a given MBMS User
Service.
\- Enable the sending of RAN counting measurements to the BM-SC.
3) Adding BM-SC-based counting procedures based on MBMS User Service
registration/de-registration procedures. Currently, the semantics of MBMS user
service registration refers to the end-user\'s consumption intent but does not
indicate whether the UE is actually consuming (i.e. performing reception of)
the eMBMS user service.
4) MBMS service consumption reporting. This method defines an extension to the
Associated Delivery Procedure (ADP) Description to signal that the network
requires MBMS user service consumption reporting by the UE.
##### 4.4.5.2.3 Consumption Reporting Solution Framework
##### 4.4.5.2.3.1 Associated Delivery Procedure Description Modification
{#associated-delivery-procedure-description-modification .H6}
To attain more accurate knowledge of MBMS user service usage, we introduce a
service usage reporting mechanism. Specifically, an extension to the
Associated Delivery Procedure (ADP) Description is defined to signal that the
network requires MBMS user service consumption reporting by the UE, as
illustrated below in Figure 10 and described in the following.
{width="4.495833333333334in" height="4.197222222222222in"}
Figure 10: Extension of ADP Description containing MBMS service consumption\
reporting parameters
\- Via extension of the APD Description, the BM-SC specifies the percentage
subset of MBMS receivers it would like to perform MBMS User Service Reporting
(_sampleReportPercentage_), the frequency for the UE to report
(_reportInterval_), and if the UE is required to report when it starts or
stops to receive the MBMS user service in USD (_reportFlag_).
\- If the _sampleReportPercentage_ were provided for a MBMS user service and
the value is less than 100, the UE generates a random number which is
uniformly distributed in the range of 0 to100. The UE sends the MBMS user
service report periodically according to the report frequency
(_reportInterval)_ when the generated random number is of a lower value than
the _sampleReportPercentage_ value.
\- If _reportFlag_ is set to \"true\", the UE sends the MBMS user service
report when the UE starts (also including when the UE moves into MBMS
coverage) or stops (also including the UE is moved out of eMBMS coverage)
receiving the MBMS user service. To avoid excessive fluctuation of reporting
due to user misbehavior in quick succession of turning on and off the MBMS
service application, or due to a UE which is located near the border of MBMS
coverage and due to movement, meanders in and out of the MBMS coverage area,
the UE should implement a hysteresis based algorithm to reduce consumption
reporting in such conditions.
\- **When the UE sends** the MBMS user service report, it indicates the BM-SC
its location (for example, SAI, CGI or ECGI, based on MooD configuration.
##### 4.4.5.2.3.2 Eaxmple Call Flow of Reporting of Consumption on MBMS Bearer
{#eaxmple-call-flow-of-reporting-of-consumption-on-mbms-bearer .H6}
A high level call flow of an MBMS user service consumption reporting is shown
below in Figure 11.
Figure 11: Call Flow of MBMS User Service Consumption Reporting
##### 4.4.5.2.4 Automating Proxy Configuration
MooD provides a means for offloading traffic to MBMS delivery based on the use
o proxy servers. In the UE-elected mode, the UE routes its HTTP and RTSP
traffic through a pre-configured MooD proxy server. The UE inspects responses
from the MooD proxy server for redirections to MBMS. Upon detection of a
redirection, the UE will join the MBMS session and continue content reception
over MBMS bearer. This sub-clause describes a method whereby UE can be
automatically configured with the appropriate proxy for a given URL
##### 4.4.5.2.4.1 Proxy Auto-Config (PAC) {#proxy-auto-config-pac .H6}
Proxy Auto-Config (PAC) is a method used by web browsers and other user agents
to select the appropriate proxy server for a given URL. The method for
choosing a proxy is written as a JavaScript function contained in a PAC file.
This file can be hosted locally or on a network. Browsers and user agents can
be configured to use the file either manually or in automatically.
A PAC file is referenced each time a new URL is loaded. Information such as
the host, the URL, the local IP address is passed to the PAC script for
evaluation. A set of rules are matched based on the input information and used
to determine the destination for the requested URL.
The PAC file implements one function _FindProxyForURL(url, host)_ that
contains all the logic and rules to direct the request. Separate rules can be
set based on the protocol scheme, so that RTSP and HTTP traffic may be
directed to different proxy servers.
##### 4.4.5.2.4.2 Implementing MooD using PAC {#implementing-mood-using-pac
.H6}
The MooD MO is used by the operator to pre-configure the UE. The MooD MO
contains a list of proxy servers together with their usage rules. The usage
rule is defined based on the ContentRestriction leaf, which provides a list of
domain names that are used to match against the request URL.
The MooD MO content is mapped easily to a PAC file that can then be installed
system wide for automatic proxy selection. Each ProxyServer node consisting of
(Address[], ContentRestriction[]) information in the MooD MO is converted as
follows:
+----------------------------------------------------------+ | _function FindproxyForURL(url, host) {_ | | | | > _for(var restriction in ContentRestriction) {_ | | > | | > _if (shExpMatch(host, restriction)) {_ | | > | | > _var j = Math.floor(Math.random() * Address.length);_ | | > | | > _return Address[j];_ | | > | | > _}_ | | > | | > _}_ | | > | | > _return \"DIRECT\";_ | | | | _}_ | +----------------------------------------------------------+
#