# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the security aspects of the Proximity Services
(ProSe) features in EPS.\ Based on the common security procedures (clause 5)
for
\- interfaces between network entities (using NDS),
\- configuration of ProSe-enabled UEs, and
\- data transfer between the ProSe Function and a ProSe enabled UE (PC3
interface)
security for the following ProSe features is covered:
\- Open ProSe Direct Discovery in network coverage (clause 6.1);
\- One-to-many ProSe direct communication for ProSe-enabled Public Safety UEs
(clause 6.2);
\- EPC-level Discovery of ProSe-enabled UEs (clause 6.3);
\- EPC support for WLAN Direct Discovery and Communication (clause 6.4).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.303: \"Proximity-based services (ProSe); Stage 2\".
[3] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[4] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework
(AF)\".
[5] 3GPP TS 33.220: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA)\".
[6] ETSI TS 102 225: \"Smart Cards; Secured packet structure for UICC based
applications\".
[7] ETSI TS 102 226: \"Smart cards; Remote APDU structure for UICC based
applications\".
[8] 3GPP TS 31.115: \"Secured packet structure for (Universal) Subscriber
Identity Module (U)SIM Toolkit applications\".
[9] 3GPP TS 31.116: \"Remote APDU Structure for (U)SIM Toolkit applications
\".
[10] IETF RFC 3550: \"RTP: A Transport Protocol for Real-Time Applications\".
[11] IETF RFC 3711: \"The Secure Real-time Transport Protocol (SRTP)\".
[12] IETF RFC 6509: \"MIKEY-SAKKE: Sakai-Kasahara Key Encryption in Multimedia
Internet KEYing (MIKEY)\".
[13] IETF RFC 3830: \"MIKEY: Multimedia Internet KEYing\".
[14] IETF RFC 6507: \"Elliptic Curve-Based Certificateless Signatures for
Identity-Based Encryption (ECCSI)\".
[15] NIST FIPS 186-4: \"Digital Signature Standard (DSS)\".
[16] BSI TR-03111: \"Technical Guideline TR-03111; Elliptic Curve
Cryptography\".
[17] IETF RFC 5639: \"Elliptic Curve Cryptography (ECC) Brainpool Standard;
Curves and Curve Generation\".
[18] IETF RFC 3339: \"Date and Time on the Internet: Timestamps\".
[19] IETF RFC 5280: \"Internet X.509 Public Key Infrastructure Certificate and
Certificate Revocation List (CRL) Profile\".
[20] NIST FIPS 180-4: \"Secure Hash Standard (SHS)\".
[21] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[22] 3GPP TS 33.222: \"Generic Authentication Architecture (GAA); Access to
network application functions using Hypertext Transfer Protocol over Transport
Layer Security (HTTPS)\".
[23] IETF RFC 3261: \"SIP: Session Initiation Protocol\".
[24] IETF RFC 6508: \"Sakai-Kasahara Key Encryption (SAKKE)\".
[**25]** IETF **RFC 5480:** \"Elliptic Curve Cryptography Subject Public Key
Information\".
**[26] IETF RFC 6090:** \"Fundamental Elliptic Curve Cryptography
Algorithms\".
[27] **IETF** RFC 3339: \"Date and Time on the Internet: Timestamps\".
[28] IETF RFC 5905: \"Network Time Protocol Version 4: Protocol and Algorithms
Specification\".
[29] IETF Draft draft-ietf-avtcore-srtp-aes-gcm-17: \"AES-GCM and AES-CCM
Authenticated Encryption in Secure RTP (SRTP)\".
[30] Void.
[31] IETF RFC 5116: \"An Interface and Algorithms for Authenticated
Encryption\".
[32] 3GPP TS 33.328: \"IP Multimedia Subsystem (IMS) media plane security\".
[33] IETF RFC 6043: \"MIKEY-TICKET: Ticket-Based Modes of Key Distribution in
Multimedia Internet KEYing (MIKEY)\".
[34] IETF RFC 3986: \"Uniform Resource Identifier (URI): Generic Syntax\".
> [35] IETF RFC 4563: \"The Key ID Information Type for the General Extension
> Payload in Multimedia Internet KEYing (MIKEY)\".
[36] W3C REC-xmlschema-2-20041028: \"XML Schema Part 2: Datatypes\".
[37] IETF RFC 2616: \"Hypertext Transfer Protocol -- HTTP/1.1\".
[38] 3GPP TS 33.223: \"Generic Authentication Architecture (GAA); Generic
Bootstrapping Architecture (GBA) Push function\".
> [39] 3GPP TS 23.003: \"Numbering, addressing and identification\".
>
> [40] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
> Radio Resource Control (RRC); Protocol specification\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply.\ A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**Discovery Filter: See** 3GPP TS 23.303 **[2]**
**ProSe Application ID** : See [2]
**ProSe Application Code** : See [2]
**ProSe Application Mask:** See [2]
**ProSe Direct Communication** : See [2]
**ProSe Direct Discovery** : See [2]
**ProSe-enabled non-Public Safety UE** : See [2]
**ProSe-enabled Public Safety UE** : See [2]
**ProSe-enabled UE** : See [2]
**Validity Timer:** See [2]
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
ADF Accounting Data Forwarding
ALUID Application Layer User ID
AS Application Server
BSF Bootstrapping Server Function
CA Certificate Authority
CTF Charging Trigger Function
DSA Digital Signature Algorithm
ECDSA Elliptic Curve DSA
EPUID EPC Level User ID
GBA Generic Bootstrapping Architecture
GMK Group Master Key
GPS Global Positioning System
GSK Group Session Key
ID Identity
KMS Key Management System
LCID Logical Channel Identifier
MIC Message Integrity Code
MIKEY Multimedia Internet Keying
NAF Network Application Function
NITZ Network Identity and Time Zone
NTP Network Time Protocol
OTA Over The Air
PEK ProSe Encryption Key
PFID ProSe Function ID
PGK ProSe Group Key
ProSe Proximity-based Services
PTK ProSe Traffic Key
RTP Real-Time Transport Protocol
RTCP RTP Control Protocol
SDP Session Description Protocol
SEG Security Gateway
SRTP Secure Real-Time Transport Protocol
UID User ID
> UTC Universal Time Coordinated
# 4 Overview of ProSe security
## 4.1 General
The overall architecture for ProSe is given in TS 23.303 [2]. ProSe includes
several features that may be deployed independently of each other. For this
reason, no overall security architecture is provided and each feature
describes its own architecture.
Although made of several different features, those features share many
procedures, for example, both ProSe Direct Discovery and ProSe Direct
Communication utilize the same procedure for service authorization (see TS
23.303 [2]). Security for this common procedures are described in clause 5 of
the present document, while the overall security of the ProSe features is
described in clause 6 of the present document (which refers back to clause 5
as necessary).
## 4.2 Reference points and Functional Entities
> **PC8** : The reference point between the UE and the ProSe Key Management
> Function. PC8 relies on EPC user plane for transport (i.e. an \"over IP\"
> reference point). It is used to transport security material to UEs for ProSe
> one-to-many communications.
# 5 Common security procedures
## 5.1 General
This clause contains a description of the security procedures that are used by
more than one ProSe feature.
## 5.2 Network domain security
### 5.2.1 General
ProSe uses several interfaces between network entities, e.g. PC4a between the
ProSe Function and the HSS\ (see TS 23.303 [2]). This subclause describes the
security for those interfaces.
### 5.2.2 Security requirements
The ProSe network entities shall be able to authenticate the source of the
received data communications.
The transmission of data between ProSe network entities shall be integrity
protected.
The transmission of data between ProSe network entities shall be
confidentiality protected.
The transmission of data between ProSe network entities shall be protected
from replays.
### 5.2.3 Security procedures
For all interfaces between network elements,
> TS 33.210 [3] shall be applied to secure signalling messages on the
> reference points unless specified otherwise, and
>
> TS 33.310 [4] may be applied regarding the use of certificates with the
> security mechanisms of TS 33.210 [3] unless specified otherwise in the
> present document.
NOTE: For the case of an interface between two entities in the same security
domain, TS 33.210 [3] does not mandate the protection of the interface by
means of IPsec.
## 5.3 Security of UE to ProSe Function interface
### 5.3.1 General
The ProSe-enabled UEs have many interactions with the ProSe Function over the
PC3 in the ProSe features described in TS 23.303 [2].
### 5.3.2 Security requirements
Only the ProSe Function may provide configuration data impacting the ProSe-
related network operations to the ProSe-enabled UE. 3rd parties shall not be
allowed to provide such parameters.
The ProSe-enabled UE and the ProSe Function shall mutually authenticate each
other.
The transmission of configuration data between the ProSe Function and the
ProSe-enabled UE shall be integrity protected.
The transmission of configuration data between the ProSe Function and the
ProSe-enabled UE shall be confidentiality protected.
The transmission of configuration data between the ProSe Function and the
ProSe-enabled UE shall be protected from replays.
The configuration data shall be stored in the UE in a protected way to prevent
modification.
Some configuration data may require to be stored in the UE in a protected way
to prevent eavesdropping.
The transmission of UE identity should be confidentiality protected on PC3
interface.
### 5.3.3 Security procedures
#### 5.3.3.1 Security procedures for configuration transfer to the UICC
After deployment of the ProSe-enabled UE the configuration parameters stored
in the UICC may need to be updated to reflect the changes in the configuration
applied.
In case that configuration data of ProSe-enabled UE are stored in the UICC,
the UICC OTA mechanism (as specified in ETSI TS 102 225 [6] / TS 102 226 [7]
and 3GPP TS 31.115 [8] / TS 31.116 [9]) shall be used to secure the transfer
of the configuration data to be updated in the UICC.
#### 5.3.3.2 Security procedures for data transfer to the UE
This subclause describes procedures for protecting data transfer between UE
and ProSe Function (called the network function in the below
procedures).Between the UE and network function,
for UE initiated messages, the procedures specified by clause 5.4 of TS 33.222
[22] shall be used with the following addition. The network function may
optionally include an indication in the PSK-identity hint in the
ServerKeyExchange message over the Ua interface to inform the UE of the FQDN
of the BSF with which the UE shall run the bootstrapping procedure over the Ub
interface as specified in TS 33.220[5] to provide the key material for
establishment of the TLS tunnel. When performing such bootstrapping with the
indicated BSF, the UE and BSF shall use the provided FQDN as the BSF Identity
in all places, e.g. forming the B-TID. If there is no such indication, the UE
shall perform the bootstrapping with the BSF at the address given in TS 23.003
[39].
The UE may also hold a B-TID, Ks and other associated material from
bootstrapping runs with different BSFs simultaneously.
A network function that implements the NAF functionality (cf Annex F.2 or
Annex F.3) shall request USSs from the BSF when requesting the
Ks_(ext/int)_NAF key and the network function shall check in the USS if the
USIM is authorized to be used for ProSe services. If the authorization in the
network function fails then the network function shall release the PSK-TLS
connection with the UE. Otherwise (cf Annex F.4) the retrieval of
authentication vectors and authorization of the ProSe UE shall be performed
using the PC4a interface instead of the Zh interface. If the ProSe Function
does not have a unused Authentication vector associated with the ProSe UE, the
ProSe Function shall request one Authentication Vector from the HSS over the
PC4a interface. ProSe Function shall always indicate to the UE, in the Ua
message carrying the ServerKeyExchange of the PSK-TLS handshake, that the
Ks_NAF key shall be used to bootstrap the PSK-TLS security on the PC3
interface, by setting the psk_identity_hint field to a static string \"3GPP-
bootstrapping\".
NOTE 1: Annex F describes the possible network options for PC3 security. The
UE behaviour remains the same regardless of the network option used.
NOTE 2: When the termination points of both the Ua and Ub interfaces reside in
the network function then the implementation of the Zn interface is an
operator decision. However, if the operator considers deploying a stand-alone
BSF for use by the network function, then the operator should use the
canonical BSF name from TS 23.003 and the Zn interface should be available in
the network function already from the start although it would only be used
internally to the network function until a stand-alone BSF was deployed.
Otherwise, implementation changes to the network function will become
necessary at the time of introducing the stand-alone BSF.
For network initiated messages one of the following mechanisms shall be used:
\- If a PSK TLS connection has been established as a part of a pull message
and is still available, the available PSK TLS session shall be used.
\- Otherwise, PSK TLS with GBA push based shared key-based mutual
authentication between the UE and the network function shall be used. GBA push
is specified in TS 33.223 [38]. The network function (pushNAF) shall request
USSs from the BSF when requesting a GPI, and the network function shall check
in the USS if the USIM is authorized to be used for ProSe services. If the
authorization in the network function fails then the network function shall
refrain from establish PSK TLS with GBA push.
NOTE 3: If a TLS connection is released, it can only be re-established by the
client, i.e. UE, even though the TLS session including security association
would be alive on both sides. TLS connection, in turn, is dependent on the
underlying TCP connection.
# 6 Security for ProSe features
## 6.1 ProSe direct discovery
### 6.1.1 Overview of ProSe direct discovery in network coverage
The Direct Discovery in network coverage feature in clause 5.2 and 5.3 of TS
23.303 [2] describes several procedures.\ These are the following:
1\. The **Service Authorization** procedure: The UE contacts the ProSe
Function(s) in theHPLMN in order to obtain authorization to use direct
discovery in the various PLMNs. This step also includes the ability of the
HPLMN to revoke authorization via a push message.
2\. The **Discovery Request** procedure: This allows an announcing or a
monitoring UE to obtain the necessary configuration information to be able to
announce a code or monitor for codes in a particular PLMN. Among other things,
the configuration information includes the ProSe Application Codes to be
announced or Discovery Filters to be monitored for.
3\. The **Discovery** procedure: The ProSe App Code is announced by the
announcing UE and received by the monitoring UE.
4\. The **Match Report** procedure: This allows a ProSe App Code received by
the monitoring UE to be checked and confirmed by the network. As part of this
procedure the network provides the UE with the ProSe Application Id Name of
that code and possibly the meta-data corresponding to that ProSe Application
ID Name.
### 6.1.2 Security requirements
Procedures 1, 2, and 4 include traffic between the UE and ProSe Function and
between other network entities, therefore the requirements in clause 5.3.2 and
5.2.2 apply to this case.
In addition, for the overall discovery procedure, the following security
requirement applies: The system shall support a method to mitigate the replay
and impersonation attacks for ProSe open discovery.
### 6.1.3 Security procedures
#### 6.1.3.1 Interface between the UE and ProSe Function
In order to protect the messages between the UE and ProSe Function over PC3,
the UE shall support the procedures for the UE given in subclause 5.3.3.2 and
the ProSe Function shall support the procedures for the network function given
in subclause 5.3.3.2. In order to protect the messages between the UE and
ProSe Function CTF (ADF) (Accounting Data Forwarding function block of the
Charging Trigger Function) over PC3ch, the same communication security shall
apply for PC3ch as is used for PC3.
#### 6.1.3.2 Interfaces between network elements
This uses the procedures described in clause 5.2.3 of the present document.
#### 6.1.3.3 Integrity protection and validation of the transmitted code for
open discovery
##### 6.1.3.3.1 Open discovery security flows
The message flows apply when both the UEs are roaming or when one or both are
in their HPLMN.
Note that integrity protection via this Message Integrity Check (MIC)
furthermore enables the ProSe Function to verify that the announcing UE was
indeed authorized to announce this ProSe App Code at that time instance. A
UTC-based counter associated with the discovery slot is used to calculate the
MIC and verify the MIC. To help ensure that the announcing and monitoring UEs
end up with the same value of the UTC-based counter, the announcing UE
includes the 4 least significant bits of its couter value in the discovery
message, which the monitoring UE uses when setting the value of the UTC-based
counter that is passed to the ProSe Function.
Figure: 6.1.3.3.1-1: Integrity protection of the transmitted code
1\. The Announcing UE sends a Discovery Request message containing the ProSe
Application ID to the ProSe Function in its HPLMN in order to be allowed to
announce a code on its serving PLMN (either VPLMN or HPLMN).
2./3. The ProSe Functions in the HPLMN and VPLMN of the announcing UEs
exchange Announce Auth. messages. There are no changes to these messages for
the purpose of protecting the transmitted code for open discovery. If the
Announcing UE is not roaming, these steps do not take place.
4\. The ProSe Function in HPLMN of the announcing UE returns the ProSe App
Code that the announcing UE can announce and a 128-bit Discovery Key
associated with it. The ProSe Function stores the Discovery Key with the ProSe
App Code. In addition, the ProSe Function provides the UE with a CURRENT_TIME
parameter, which contains the current UTC-based time at the ProSe Function, a
MAX_OFFSET parameter, and a Validity Timer (see TS 23.303 [2]). The UE sets a
clock it uses for ProSe authentication (i.e. ProSe clock) to the value of
CURRENT_TIME and stores the MAX_OFFSET parameter, overwriting any previous
values. The announcing UE obtains a value for a UTC-based counter associated
with a discovery slot based on UTC time. The counter is set to a value of UTC
time in a granularity of seconds. The UE may obtain UTC time from any sources
available, e.g. the RAN via SIB16, NITZ, NTP, GPS (depending on which is
available).
NOTE 1: The UE may use unprotected time to obtain the UTC-based counter
associated with a discovery slot. This means that the discovery message could
be successfully replayed if a UE is fooled into using a time different to the
current time. The MAX_OFFSET parameter is used to limit the ability of an
attacker to successfully replay discovery messages or obtain correctly MICed
discovery message for later use. This is achieved by using MAX_OFFSET as a
maximum difference between the UTC-based counter associated with the discovery
slot and the ProSE clock held by the UE.
NOTE 2: A discovery slot is the time at which an announcing UE sends the
announcement.
5\. The UE starts announcing, if the UTC-based counter provided by the system
associated with the discovery slot is within the MAX_OFFSET of the announcing
UE\'s ProSe clock and if the Validity Timer has not expired (see TS 23.303
[2]).For each discovery slot it uses to announce, the announcing UE calculates
a 32-bit Message Integrity Check (MIC) to include with the ProSe App Code in
the discovery message. Four least significant bits of UTC-based counter are
transmitted along with the discovery message. The MIC is calculated as
described in sub clause A.2 using the Discovery Key and the UTC-based counter
associated with the discovery slot.
6\. The Monitoring UE sends a Discovery Request message containing the ProSe
Application ID to the ProSe Function in its HPLMN in order to get the
Discovery Filters that it wants to listen for.
7/8. The ProSe Functions in the HPLMN of the monitoring UE and HPLMN of the
announcing UEs exchange Monitor Req./Resp. messages. There are no changes to
these messages for the purpose of protecting the transmitted code for open
discovery.
9\. The ProSe Function returns the Discovery Filter containing either the
ProSe App Code(s), the ProSe App Mask(s) or both along with the CURRENT_TIME
and the MAX_OFFSET parameters. The UE sets its ProSe clock to CURRENT_TIME and
stores the MAX_OFFSET parameter, overwriting any previous values. The
monitoring UE obtains a value for a UTC-based counter associated with a
discovery slot based on UTC time. The counter is set to a value of UTC time in
a granularity of seconds. The UE may obtain UTC time from any sources
available, e.g. the RAN via SIB16, NITZ, NTP, GPS (depending on which is
available).
10\. The Monitoring UE listens for a discovery message that satisfies its
Discovery Filter, if the UTC-based counter associated with that discovery slot
is within the MAX_OFFSET of the monitoring UE\'s ProSe clock.
11\. On hearing such a discovery message, and if the UE has either not checked
the MIC for the discovered ProSe App Code previously or has checked a MIC for
the ProSe App Code and the associated Match Report refresh timer (see steps 14
and 15 for details of this timer) has expired, or as required based on the
procedures specified in TS 23.303 [2], the Monitoring UE sends a Match Report
message to the ProSe Function in the HPLMN of the monitoring UE. The Match
Report contains the UTC-based counter value with four least significant bits
equal to four least significant bits received along with discovery message and
nearest to the monitoring UE's UTC-based counter associated with the discovery
slot where it heard the announcement, and other discovery message parameters
including the ProSe App Code and MIC.
12\. The ProSe Function in the HPLMN of the monitoring UE passes the discovery
message parameters including the ProSe App Code and MIC and associated counter
parameter to the ProSe Function in the HPLMN of the announcing UE in the Match
Report message.
13\. The ProSe Function in the HPLMN of the announcing UE shall check the MIC
is valid. The relevant Discovery Key is found using the ProSe App Code.
14\. The ProSe Function in the HPLMN of the announcing UE shall acknowledge a
successful check of the MIC to the ProSe Function in the HPLMN of the
monitoring UE in the Match Report Ack message. The ProSe Function in the HPLMN
of the announcing UE shall include a Match Report refresh timer in the Match
Report Ack message. The Match Report refresh timer indicates how long the UE
will wait before sending a new Match Report for the ProSe App Code.
15\. The ProSe Function in the HPLMN of the monitoring UE returns an
acknowledgement that the integrity checked passed to the Monitoring UE. The
ProSe Function returns the parameter ProSe Application ID to the UE.\ It also
provides the CURRENT_TIME parameter, by which the UE (re)sets its ProSe clock
The ProSe Function in the HPLMN of the monitoring UE may optionally modify the
received Match Report refresh timer based on local policy and then shall
include the Match Report refresh timer in the message to the Monitoring UE..
## 6.2 Security for One-to-many ProSe direct communication
### 6.2.1 Overview of One-to-many ProSe direct communication
The One-to-many ProSe direct communication consists of the following
procedures based on TS 23.303 [2]:
1\. One-to-many ProSe Direct communication transmission;
2\. One-to-many ProSe Direct communication reception.
The functionality in this clause may only be supported by ProSe-enabled Public
Safety UEs.
Security for one-to-many ProSe direct communication consists of bearer level
security mechanism (specified in subclause 6.2.3) and media plane security
mechanism (specified in subclause 6.2.4).
### 6.2.2 Security requirements
The requirements in clause 5.3.2 apply for the signalling between the UE and
ProSe Function.
For the distribution of the keys, the following requirements apply:
\- The shared keys and session keys shall be protected in integrity and
confidentiality during their distribution.
\- Only authorized Public Safety ProSe-enabled UEs shall receive the shared
keys.
\- It shall be possible for the Public Safety ProSe-enabled UE to authenticate
the network entity distributing the shared keys.
\- The Public Safety ProSe-enabled UE should support authentication of the
group member distributing the session keys.
\- It shall be possible for the Public Safety ProSe-enabled UE to store shared
keys for past and future cryptoperiods.
\- The mechanism for distributing session keys shall support late entry to
group communications.
\- Authorized Public Safety Prose-enabled UEs shall securely store the shared
keys.
For the protection of the data transmission between the UEs, the following
requirements apply
\- The system shall support providing the Public Safety ProSe-enabled UEs with
the all the necessary keying material and chosen algorithms that are used to
protect the data sent between the Public Safety ProSe-enabled UE(s). This
material shall be provided without requiring signalling between the Public
Safety ProSe-enabled UEs.
\- Confidentiality of one-to-many communications should be supported. Its use
would be a configuration option related to network operations and should hence
be under control of the network operator.
\- Integrity protection of one-to-many communications shall be supported for
media plane security mechanism.
\- Security mechanisms shall scale effectively to large groups, and be
compatible with rapid setup of group communications.
\- Security mechanism shall support multiple logical channels between the same
source/destination pair. Security mechanism shall avoid key stream repetition
(COUNTs is about to be re-used with the same key), when multiple PDCP entities
exist in the Public Safety ProSe-enabled UE.
### 6.2.3 Bearer layer security mechanism
#### 6.2.3.1 Security keys and their lifetimes
As part of the TLS protected signalling between the UE and ProSe Key
Management Function, a ProSe MIKEY Key (PMK) may be sent from the ProSe Key
Management Function to the UE. This key is used to protect the MIKEY messages
that are used to carry the PGKs to the UE. The usage of PMK to protect the
MIKEY messages is described in clause 6.2.3.3.2.3. The UE keeps the PMK until
it receives a new one from the ProSe Key Management Function.
A UE needs to have an algorithm identity and a PGK (ProSe Group Key)
provisioned for each group that they belong to. From this key, a UE that
wishes to broadcast data shall first generate a PTK (ProSe Traffic Key). The
parameters used in this generation ensure that PTKs are unique for each UE and
need to be transferred in the header of the user data packet (see below for
more information). The PTK is derived when the first PDCP entity for a group
is created and then PDCP entities created further for the same group shall use
the PTK derived for the group.
From the PTK, a UE derives the needed ProSe Encryption Key (PEK) to be able to
encrypt the data. The UE can protect the data to be sent with the relevant
keys and algorithms at the bearer level (see clause 6.2.3.3 for more
details).\ A receiving UE would need to derive the PTK using the information
in the bearer header and then the PEK used to decrypt the data.
When the PGKs are provided to the UE, they shall be provided with an Expiry
Time. The Expiry Time of the PGK needs to be set such that the keys for later
periods have a longer expiration period. Each PGK for each group shall be
associated with a different Expiry Time value.
When protecting data that is to be sent, the UE uses the PGK that has not
expired and with the earliest expiration time to derive the PTK etc, for that
group. When receiving protected data the UE shall only use a PGK that has not
expired or the PGK that has most recently expired. All other expired PGK(s)
should be deleted.
When a PGK key is deleted in the sending UE and receiving UE, all related keys
as PTK and PEK derived from the expired PGK shall be deleted as well as the
related PGK Identity, PTK Identity and Counter. After releasing all the PDCP
entities of a group, the PTK and PEK derived for the group is deleted.
#### 6.2.3.2 Identities
The ProSe Key Management Function sends to the UE a PMK along with a 64 bit
PMK identity. The UE uses both the PMK identity and the FQDN of the ProSe Key
Management Function to identify the PMKs locally (e.g., PMK_id\@FQDN). The
ProSe Key Management Function shall only allocate currently (and locally)
unused PMK identities.
The PGKs are specific to a particular group and hence have a Group Identity
associated with that group. This Group Identity is referred to as \"ProSe
Layer-2 Group ID\" in TS 23.303 [2] and is 24 bits long. In addition, each PGK
associated with a group has 8-bit PGK Identity to identify it. This allows
several PGKs for a group to be held simultaneously as each can be uniquely
identified. When allocating PGK ID, the ProSe Key Management Function shall
ensure that all allocated PGKs that have not expired shall be uniquely
identifiable by the 5 least significant bits of the PGK ID. This means that
the combination of Group Identity and PGK Identity uniquely identifies a PGK.
The Group Identity is the destination Layer 2 identity of the group. An all
zero PGK Identity is used to signal special cases between the UE and ProSe Key
Management Function, and hence is never used to identify a PGK.
Each member of a group has a unique 24-bit Group Members Identity, identifying
a UE within a group and referred to as \"ProSe UE ID\" in TS 23.303 [2]. This
is used a part of the PTK derivation to ensure each user generates unique PTKs
for protecting the data that they send. The Group Members Identity is the
source Layer 2 identity when the UE sends data.
The PTK identity shall be a 16-bit counter set to a unique value in the
sending UE that has not been previously used together with the same PGK and
PGK identity in the UE. Every time a new PTK needs to be derived, the PTK
Identity counter is incremented.
A PTK is uniquely identified by the combination of Group Identity, PGK
Identity, Group Member Identity of the sending UE and a 16-bit PTK identity.
The PTK Identity is used as part of the derivation of PTK to ensure that all
PTKs are unique. Under a particular PGK, the PTK identities are used in order
starting with 1.
A Logical Channel ID (LCID) associated with the PDCP/RLC entity is used as an
input for ciphering in order to avoid key stream repetition (i.e., to avoid
counter being re-used with the same PEK by one or more PDCP entities
corresponding to a group).
A 16 bit counter is maintained per PDCP entity. Counter and LCID ensures key
stream freshness across the transmission by multiple PDCP entities of the same
group. The counter is same as the PDCP SN in regular LTE.
For each group that the UE is a member of, the ME shall store a value of PTK
ID and counter in either the USIM or non-volatile memory on the ME to prevent
the re-use of the same values with a LCID under a PGK in case the UE
unexpectedly powers down. These stored values shall be associated with the PGK
that is being used to send the data.
After power on but before sending any one-to-many data for a group, the ME
shall handle the PTK ID and counter from the USIM or non-volatile memory of
the ME as follows. The ME shall copy the values PTK ID and counter into
volatile memory.
NOTE 1: The values stored in volatile memory represent the smallest values of
PTK ID and Counter that the UE knows have not been used with currently unused
LCIDs.
For USIM storage of PTK ID and counter, the ME shall also increase the PTK ID
in the USIM by 3 if it is less than 2\^16-4 or to 2\^16 -- 1 otherwise, and
set the value of counter to 2\^16-1 (its maximum value). If storage in non-
volatile memory of the ME is used, the ME shall keep the value of PTK ID in
the non-volatile memory of the ME the same, and set the counter to 2\^16-1.
NOTE 2: The PTK ID on the USIM is set higher than if it was held in non-
volatile memory of the ME to reduce the number of writes to the USIM. It is
not set to the maximal value in both cases as this would invalidate a PGK for
a possibly out of coverage UE.
When a new PDCP entity is created for sending traffic, the UE shall select a
currently unused LCID. If a previously unused PGK is to be used to provide the
keys for protecting this PDCP entity, then the UE acts as below. Otherwise the
ME selects a PTK Identity and counter values to use with the new PDCP entity,
such that no larger PTK ID has been used for this PGK and LCID and no larger
counter values have been used with this PGK, PTK ID and LCID.
NOTE 3: It is enough for the ME to use the values stored in the volatile
memory of the ME to ensure keystream freshness, but more sophisticated methods
may allow more efficient use of PTK ID and counters.
If a previously unused PGK is to be used with the PDCP entity, then for a PGK
already stored on the USIM, the ME sets the PTK identity and counter on the
USIM to 3 and 2\^16-1 respectively and associates them with this PGK. For a
new PGK stored in non-volatile memory in the ME, the ME shall set the PTK
identity and counter in the non-volatile memory of the ME to one and 2\^16-1
respectively and associates them with this PGK. The ME shall set both the PTK
ID and counter in volatile memory to one. The ME shall use the new PGK, a PTK
ID of one and a counter of one to protect the traffic on the PDCP entity.
To encrypt the data for a PDCP entity, the ME shall calculate PTK (as
described in Annex A.3) and then PEK from PTK (as described in Annex A.4). The
ME then uses the PEK, LCID, PTK ID and counter to encrypt the next data packet
as described in subclause 6.2.3.6.1. Immediately after encrypting the data
packet, the ME shall increase the counter associated with the PDCP entity by
one. If this causes the counter to wrap, then the ME shall behave as follows:
\- If PTK ID \
\
\kms.example.org\
\user\@example.org\
\2014-01-26T10:05:52\
\KMSProvider12345\
\http://kms.example.org/keymanagement/identity/v1/init\
\
\
\
\cert1.kms.example.org\
\kms.example.org\
\www.example.org\
\2000-01-26T00:00:00\
\2100-01-26T23:59:59\
\false\
\#uri?P-Year=#year&P-Month=#month\
\(OCTET STRING)\
\(OCTET STRING)\
\
\sec1.example.org\
\sec2.example.org\
\
\
\
\
\
### B.3.3.1 Example KMSKeyProv XML
\
\
\kms.example.org\
\user\@example.org\
\2014-01-26T10:07:14\
\KMSProvider12345\
\http://kms.example.org/keymanagement/identity/v1/keyprov\
\
\
\
\kms.example.org\
\cert1.kms.example.org\
\www.example.org\
\user\@example.org\
\user\@example.org?P-Year=2014&P-Month=02\
\2014-01-31T00:00:00\
\2014-03-01T23:59:59\
\false\
\(OCTET STRING)\
\(OCTET STRING)\
\(OCTET STRING)\
\
\
\kms.example.org\
\cert1.kms.example.org\
\www.example.org\
\user.psuedonym\@example.org\
\user.psuedonym\@example.org?P-Year=2014&P-Month=02\
\2014-01-31T00:00:00\
\2014-03-01T23:59:59\
\false\
\(OCTET STRING)\
\(OCTET STRING)\
\(OCTET STRING)\
\
\
\
\
### B.3.3.1 Example KMSCertCache XML
\
\
\kms.example.org\
\user\@example.org\
\2014-01-26T10:14:12\
\KMSProvider12345\
\http://kms.example.org/keymanagement/identity/v1/certcache\
\
\
\
\
\cert2.kms.example.org\
\kms.example.org\
\www.example.org\
\2000-01-26T00:00:00\
\2100-01-26T23:59:59\
\false\
\#uri?P-Year=#year&P-YDay=#yday\
\(OCTET STRING)\
\(OCTET STRING)\
\
\sec3.example.org\
\
\
\
\
\
\
\
\
\nnnn\
\
\
\DEADBEEF\
\
\cert1.kms.example.org\
\
\
\
\
\
\cert1.kms.another.example.org\
\kms.another.example.org\
\www.another.example.org\
\2000-01-26T00:00:00\
\2100-01-26T23:59:59\
\false\
\#uri?P-Year=#year&P-YDay=#yday\
\(OCTET STRING)\
\(OCTET STRING)\
\
\another.example.org\
\
\
\
\
\
\
\
\
\nnnn\
\
\
\DEADBEEF\
\
\cert1.kms.example.org\
\
\
\
\
\
\
## B.3.4 KMS Response XML Schema
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
###### ## Annex C (Normative): SRTP/SRTCP Profile
Each Crypto-Session (CS) in the SRTP Crypto-Session Bundle (CSB) is
provisioned with a unique 16-octet SRTP Master Key and 12 octet SRTP Master
Salt (both derived from the TGK). The Master Key and Salt are not used
directly to protect SRTP traffic. Rather, SRTP Session Encryption Keys and
Session Salt are derived for this purpose. The AES-CM Pseudo Random Function
as described in RFC 3711 [11], section 4.3.3, shall be used.
SRTP/SRTCP peers shall support IETF Draft draft-ietf-avtcore-srtp-aes-gcm-17
[29]. Both SRTP and SRTCP payloads shall be encrypted using the authenticated
encryption algorithm AEAD_AES_128_GCM as defined in IETF Draft draft-ietf-
avtcore-srtp-aes-gcm-17 [29] . The key derivation rate shall be 0..
SRTP packets may include the Master Key Identifier tag as defined in RFC 3711
[11]. If included, the MKI tag shall contain the identifier of the GSK.
The SRTP transforms and parameters in the SRTP protection profile defined in
Annex O of TS 33.328 [32] may also be used to protect the media stream.
###### ## Annex D (Normative): MIKEY Message Formats for Media Security
# D.1 General aspects
## D.1.0 Introduction
MIKEY is used to transport GMKs from Group Owners to UEs and GSKs from the
initiating UE to the receiving UE.
GMK transmission shall use MIKEY-SAKKE messages as defined in RFC 6509 [12].
GSK transmission shall use pre-shared keys as defined in RFC 3830 [13]. GSKs
may be identified using key identifiers (MKI) which are included in the KEMAC
payload.
The GMK is encrypted to the UserIDs associated to the receiving UE and signed
using the UserID associated to the Group. Details of this process are defined
in RFC 6508 [33] and RFC 6507 [14]. The structure of the UserIDs used is
defined by the KMS of the UE.
GSKs are transmitted by MIKEY in a key transport mode as defined in RFC 3830
[13]. The pre-shared key used for transmission is the GMK. The encryption and
authentication keys used to transport the GSK are derived from the GMK.
The GMK and GSK shall be 16 octets in length. The size of the authentication
key to be used to verify the MAC field of a MIKEY message shall be 20 octets
in length.
## D.1.1 MIKEY common fields
If the transmitter requires an ACK for a transmission this is indicated by
setting the V-bit in the MIKEY common header. For distribution of GSKs for
one-to-many communications, the V-bit shall not be set.
Each MIKEY message contains the timestamp field (TS). The timestamp field
shall be TS type NTP-UTC (TS type 0), and hence is a 64-bit UTC time.
URIs within the payloads shall conform to the normalisation procedures defined
in Section 6 of RFC 3986 [34].
# D.2 MIKEY message structure for GMK Distribution
The MIKEY-SAKKE message shall include the Common Header payload, timestamp
payload, IDRi payload, IDRr payload, SAKKE payload and ECCSI payload.
The message may also include a RAND payload and Security Properties payload.
The structure of the MIKEY message carrying a GMK key shall be according to
Figure D.2-1.
In the Common Header payload, the CSB ID field of MIKEY common header is not
used for identification purposes and shall be set to zero. The CS# shall also
be zero. The CS ID map type subfield shall be set to \"Empty map\" as defined
in RFC 4563 [35].
The MIKEY-RAND payload is not used to derive key material and need not be
included. The Security Properties payload is also not required but may also be
included.
The IDRi payload shall contain the Group URI corresponding to the GMK. The
IDRr payload shall contain the user URI associated to the UE. These shall be
IDR payloads as defined in Section 6.6 of RFC 6043 [33]. IDRi contains the URI
of the Group (i.e. the identifier for the group managed by the group owner).
As it is distributing keys, it has role \"KMS\", Value 3. IDRr contains the
URI of UE and has role \"Initiator\", Value 1\. The ID Type field of IDRi and
IDRr payloads shall be set to value 1 (=URI).
The SAKKE payload shall encapsulate the GMK to the user URI. Only one GMK key
shall be transported in the SAKKE payload. The same GMK shall be encapsulated
to each member of the group.
The entire MIKEY message shall be signed by including an SIGN payload
providing authentication of the group owner. The signature shall be of type 2
(ECCSI). The signature shall use the (key associated with) the group URI
included in IDRi.
Figure D.2-1: The MIKEY GMK distribution message
# D.3 MIKEY message structure for GSK distribution
GSKs are distributed using the MIKEY pre-shared key mechanism described in RFC
3830 [13]. The pre-shared key shall be the GMK.
The MIKEY message shall contain a Common Header, Timestamp payload, RAND
payload, IDRi payload, IDRr payload and KEMAC payload. The Security Properties
payload, a Key ID extension payload and a SIGN (ECCSI) payload may also be
included. The structure of the MIKEY message carrying a GSK key shall be
according to Figure D.3-1.
The Common Header payload shall include a CSB ID field, CS# and CS map type of
\"SRTP-ID\" as defined in RFC 3830 [13].
The RAND payload shall be included as it is used to derive MIKEY internal key-
encryption keys and the SRTP/SRTCP master keys/salts.
The IDRi payload shall contain the URI associated with the initiating UE. The
IDRr payload shall contain the group URI. These shall be IDR payloads as
defined in Section 6.6 of RFC 6043 [33]. IDRi payload has role \"Initiator\",
Value 1. IDRr contains the URI associated with the group and has role
\"Receiver\", Value 2. The ID Type field of IDRi and IDRr payloads shall be
set to value 1 (=URI).
Security Policy (SP) payload may be included to provide information for the
security protocol such as algorithms to use, key lengths, initial values for
algorithms etc. See Section 6.2.4 for details on SRTP security.
The KEMAC payload shall contain the encrypted GSK. Only one GSK key can be
transported in the KEMAC payload. The KEMAC payload shall use encryption
algorithm AES-CM-128 as specified in RFC 3830 [13], and MAC algorithm HMAC-
SHA-256-256 as specified in RFC 6043 [33]. The encryption and MAC keys shall
be derived from the GMK using the key derivation function defined in section
4.1.4 of RFC 3830 [13] and using the PRF-HMAC-SHA-256 Pseudo-Random Function
as described in RFC 6043 [33], Section 6.1.
Within the encrypted key-data sub-payload of the KEMAC payload, the Type
subfield shall be set to TGK (value 0). The key validity data may be included.
This may include an MKI or validity period.
The entire MIKEY message may be signed by including an SIGN payload providing
authentication of the caller. The signature shall be of type 2 (ECCSI). The
signature shall use the (key associated with) the initiating UE URI included
in IDRi.
Figure D.3-1: The logical structure of the MIKEY message used to deliver GSK
# D.4 Exporting the GSK to SRTP
To key SRTP, the GSK is used as the shared TEK Generation Key (TGK) described
in [13]. The MIKEY Pseudo-Random Function (MIKEY-PRF) is used to derive a SRTP
Master Key and Master Salt pair for each SRTP Crypto Session (CS) from the GSK
(equivalently TGK). The PRF-HMAC-SHA-256 Pseudo-Random Function as described
in [33], section 6.1, shall be used to perform the derivation.
The same process shall apply to key SRTCP.
###### ## Annex E (Normative): Key Request and Response messages
# E.1 Introduction
This annex defines the Key Request and Key Response procedures between the UE
and the ProSe Key Management Function for ProSe one-to-many communications.
# E.2 Transport protocol for messages between UE and ProSe Key Management
Function
The UE and ProSe Key Management Function shall use HTTP 1.1 as specified in
IETF RFC 2616 [37] as the transport protocol for the messages between the UE
and ProSe Key Management Function. The ProSe messages described here shall be
included in the body of either an HTTP request message or an HTTP response
message. The following rules apply:
\- The UE initiates the transactions with an HTTP request message;
\- The ProSe Key Management Function responds to the requests with an HTTP
response message; and
\- HTTP POST methods are used for the procedures.
# E.3 XML Schema
Implementations in compliance with the present document shall implement the
XML schema defined below for messages used in ProSe key management procedures.
\
\
\
\
Info for ProSe Key Management Messages Syntax
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
An entity receiving the XML body ignores any unknown XML element and any
unknown XML attribute.
# E.4 Semantics
## E.4.1 General
The \ element is the root element of this XML
document and it can be one of the following elements:
\- \;
\- \;
\- \ element containing other ProSe key management message
defined in future releases; or
\- an element from other namespaces defined in future releases.
## E.4.2 Semantics of \
The \ element consists of:
1) \ element which contains the parameter defined in subclause
E.5.2.2.1:
2) zero or one \ element contains the parameter defined in
subclause E.5.2.2.2.
3) zero or more \ element, each of which consists of:
> a) a \ element containing the parameter defined in subclause
> E.5.2.2.3;
b) one or more \ element containing the parameter defined in subclause
E.5.2.2.4;
c) zero or one \ element containing elements defined in future
releases;
d) zero, one or more elements from other namespaces defined in future
releases; and
> e) zero, one or more attributes defined in future releases;
4) zero or more \ element containing the parameter defined in
subclause E.5.2.2.5;
5) zero or one \ element containing elements defined in future
releases;
6) zero, one or more elements from other namespaces defined in future
releases; and
7) zero, one or more attributes defined in future releases.
## E.4.3 Semantics of \
The \ element consists of:
1) a \ element which contains the parameter defined in
subclause E.5.2.2.1: and
2) zero or more \ element, each of which consists of :
> a) a \ element containing the parameter defined in subclause
> E.5.2.2.3;
b) a \ element containing the parameter defined in subclause
E.5.2.2.5;
c) zero, one or more elements defined in future releases; and
> d) zero, one or more attributes defined in future releases;
3) zero or more \ element, each of which consists of:
> a) a \ element containing the parameter defined in subclause
> E.5.2.2.3;
>
> b) a \ element containing the parameter defined in subclause
> E.5.2.2.6;
c) a \ element containing the parameter defined in subclause
E.5.2.2.7;
d) zero, one or more elements defined in future releases; and
> e) zero, one or more attributes defined in future releases;
4) zero or one \ element, each of which consists of:
a) a \ element containing the parameter defined in subclause
E.5.2.2.8;
b) a \ element containing the parameter defined in subclause E.5.2.2.9;
c) zero, one or more elements defined in future releases; and
d) zero, one or more attributes defined in future releases; 5) zero or one
\ element containing elements defined in future releases;
6) zero, one or more elements from other namespaces defined in future
releases; and
7) zero, one or more attributes defined in future releases.
# E.5 General message format and information elements coding
E.5.1 Overview
This clause contains general message format and information elements coding
for the messages used in the procedures described in the present document.
E.5.2 ProSe direct discovery message formats
E.5.2.1 Data types format in XML schema
To exchange structured information over the transport protocol, XML text
format/notation is introduced.
The corresponding XML data types for the data types used in Key Management
messages are provided in table E.5.5.1-1.
Table E.2.5.1-1: Primitive or derived types for ProSe Parameter Type
* * *
ProSe Parameter Type Type in XML Schema Integer decimal String string Boolean
boolean Binary hexBinary Date and Time dateTime
* * *
For complex data types described in subclause E.5.2.2, an XML \"complexType\"
can be used.
Message construction shall be compliant with W3C REC-xmlschema-2-20041028:
\"XML Schema Part 2: Datatypes\" [36]
### E.5.2.2 Parameters in ProSe key management messages
#### E.5.2.2.1 Transaction ID
This parameter is used to uniquely identify a ProSe Key management
transaction. The UE shall set this parameter to a new number for each outgoing
new discovery request. The transaction ID is an integer in the 0-255 range.
#### E.5.2.2.2 Supported Algorithm
This parameter is used to indicate which encryption algorithm the UE supports
for one-to-many commuications. It is a 1 octet long binary parameter encoded
as shown in table E.5.2.2.2-1:
Table E.5.2.2.2-1: UE _encryption algorithm capability_ information element
* * *
EPS encryption algorithms supported (octet 1)
EPS encryption algorithm EEA0 supported (octet 1, bit 8)  
0 EPS encryption algorithm EEA0 not supported 1 EPS encryption algorithm EEA0
supported
EPS encryption algorithm 128-EEA1 supported (octet 1, bit 7)  
0 EPS encryption algorithm 128-EEA1 not supported 1 EPS encryption algorithm
128-EEA1 supported
EPS encryption algorithm 128-EEA2 supported (octet 1, bit 6)  
0 EPS encryption algorithm 128-EEA2 not supported 1 EPS encryption algorithm
128-EEA2 supported
EPS encryption algorithm 128-EEA3 supported (octet 1, bit 5)  
0 EPS encryption algorithm 128-EEA3 not supported 1 EPS encryption algorithm
128-EEA3 supported
EPS encryption algorithm EEA4 supported (octet 1, bit 4)  
0 EPS encryption algorithm EEA4 not supported 1 EPS encryption algorithm EEA4
supported
EPS encryption algorithm EEA5 supported (octet 1, bit 3)  
0 EPS encryption algorithm EEA5 not supported 1 EPS encryption algorithm EEA5
supported
EPS encryption algorithm EEA6 supported (octet 1, bit 2)  
0 EPS encryption algorithm EEA6 not supported 1 EPS encryption algorithm EEA6
supported
EPS encryption algorithm EEA7 supported (octet 1, bit 1)  
0 EPS encryption algorithm EEA7 not supported 1 EPS encryption algorithm EEA7
supported
* * *
#### E.5.2.2.3 Group ID
This parameter is used to indicate the Group that the UE is requesting keys
for. It is an integer in the 0-167777215 range.
#### E.5.2.2.4 PGK ID
This parameter is used to indicate the PGK IDs for a particular group. It is
an integer in the 0-255 range.
#### E.5.2.2.5 Error Code
This parameter is used to indicate the particular reason why the UE will not
be receiving keys for a requested group. It is an integer in the 0-255 range
encoded as follows:
> 0 Reserved
>
> 1 UE does not support the required security algorithms
>
> 2 The ProSe Key Management Function does not supply keys for this group
>
> 3 UE is not authorised to receive keys for this group
>
> 4 UE requested to stop receiving PGKs for this group
>
> 5-255 Unused
#### E.5.2.2.6 Group Member ID
This parameter is used as the identity of the UE within a Group. It is an
integer in the 0-167777215 range.
#### E.5.2.2.7 Algorithm Info
The purpose of the Algorithm info is to indicate the confidentilaity
algorithms to be used for ciphering protection of the particular group
traffic. It is a binary parameter of length 1 octet that is encoded as shown
in table E.5.2.2.7-1.
Table E.5.2.2.7-1: Selected security algorithm information element
* * *
Type of ciphering algorithm (octet 1, bit 5 to 7)  
Bits  
**7** **6** **5**  
0 0 0 EPS encryption algorithm EEA0 (null ciphering algorithm) 0 0 1 EPS
encryption algorithm 128-EEA1 0 1 0 EPS encryption algorithm 128-EEA2 0 1 1
EPS encryption algorithm 128-EEA3 1 0 0 EPS encryption algorithm EEA4 1 0 1
EPS encryption algorithm EEA5 1 1 0 EPS encryption algorithm EEA6 1 1 1 EPS
encryption algorithm EEA7
Bits 1- 4 and bit 8 of octet 1 are spare and shall be coded as zero.
* * *
E.5.2.2.8 PMK ID
This parameter is used to identify a PMK. It is an 8 octet long binary
parameter.
E.5.2.2.9 PMK
This parameter is a key that is used to protect MIKEY messages. It is a 32
octet long binary parameter.
###### ## Annex F (Informative): Network options for PC3 security
# F.1 General
The present annex describes the network options for securing PC3 and PC8
interfaces.
# F.2 Prose Function using standalone BSF
The network option for Prose Function using standalone BSF is described below:
Figure F.2-1: Prose Function using standalone BSF.
This architecture follows the GBA architecture, where the ProSe Function and
the ProSe Key Management Function are acting asa NAF.
# F.3 BSF - Prose Function/NAF colocation
The network option for Prose Function using colocated BSF is described below:
Figure F.3-1: BSF -- Prose Function colocation
In this architecture the BSF is colocated with the ProSe Function and the
ProSe Key Management Function acting as a NAF. Zn interface is present between
BSF and ProSe Function and also between BSF and ProSe Key Management Function.
# F.4 Prose Function with bootstrapping entity
The network option for Prose Function with bootstrapping entity is described
below:
Figure F.4-1: Prose Function with bootstrapping entity
In this architecture the ProSe Function and the ProSe Key Management Function
are enhanced in the way that the subset of BSF and NAF functionality towards
the UE is reused, specifically the protocols defined for Ub and Ua reference
points. Interfaces Zn and Zh are not used. Functionality of retrieving the
authentication vector in order to support the mutually authenticated key
exchange is the responsibility of the PC4a interface between the ProSe
Function and the HSS, or the PC4a* interface between ProSe Key Management
Function and HSS.
#