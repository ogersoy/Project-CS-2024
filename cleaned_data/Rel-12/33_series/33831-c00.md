# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
The Study on Security on spoofed call detection and prevention (FS_SPOOF) is
linked to the Rel-11 Specification of Protection against Unsolicited
Communication for IMS (SPUCI) work concluded in TR 33.838 [2] (un-trusted
networks), which at its turn builds on the Rel-9 Study of Mechanisms for
Protection against Unsolicited Communication for IMS (PUCI) in TR 33.937 [3].
There are a variety of methods and technologies that can be used to make
spoofed calls. The most common ways can be through leased voice line/PRI or
using VoIP technology. Spoofed call is unfortunately an existing method in
telecom fraud. It tricks the called party into thinking the call was coming
from a different, sometimes authoritative organization than the caller\'s. In
some regions, commonly spoofed IDs are those from authoritative organizations,
emergency IDs, bank IDs and police IDs. In other regions, threats typically
include e.g. voicemail spoofing (privacy threats) and premium services
spoofing (commercial threats). Spoofed calls may indeed be terminated in a
3GPP mobile network -- an increasing probability and threat. There are several
impacts by the spoofing calls. For example, the existence of spoofed calls
lowers the trust level of telecom services, in that people may trust all
networks less and less. It enhances the fraud effect greatly by tricking
people, it causes great loss to the users, and threatens to create bad
reputation to also mobile networks and its services.
  * Spoofing call is possible in local, long distance and international calls with low cost, although the cost and effort to implement it varies with network, and with country
  * It is hard to detect spoofing calls in current mobile network; It is almost impossible to detect spoofing calls from gateways, especially the spoofed call ID is subscribers of different networks
In order to detect the spoofing call and find measures to deal with this heavy
problem of spoofed call, the best common methods and possible practices for
this kind of problem need to be described.
**The objective is** to come up with recommendations on means to identify
spoofed calls in CS domain where the call could have originated from outside
the CS domain. This study has the following objectives:
  * Outline valid threat scenarios for spoofing calls coming to 2G and 3G CS domains.
  * Analyze and evaluate if any tools in 3GPP can be used to counteract this problem.
  * Study and identify possible required technology mechanism to detect the spoofed calls in the first step and also study prevention as second step if detection is achievable.
# 1 Scope
The present document studies the means to identify calls with spoofed Calling
Line Identification terminating in the CS domain where the call could have
originated from either inside or outside the CS domain. Calling Line
Identification (CLI or CLID), also called Caller Identification (CID),
evaluates and transmits a caller\'s number while Calling Line Identity
Presentation (CLIP) enables displaying the caller\'s number during call setup
or ringing. Usual applications for CLIP are:
to display the original number of the caller;
to display a caller\'s presentation number, e.g. a doctor calling a patient
out of hours who doesn\'t want to disclose his private number but showing
instead the number of his office;
to display a number unrelated to the calling line, e.g. call centers
displaying numbers related to their customers (depending on national
regulations).
But CLI can also be misused to display a misleading number in the display that
is in no way related to the originator of the call. This behaviour is called
CLI spoofing or spoofed call. CLI spoofing ranges from harmless hoax to
criminal activities like for example Voice Phishing (vishing) by displaying
the forged number of a bank in order to steal the callee\'s credentials. And
although CLI may be unreliable, people use it to decide whether to accept a
call or not.
This study item studies the detection of a spoofed call as the first step, and
prevention as a second step if detection is achievable. In particular, the
goals of this document are:
  * Outline valid threat scenarios for spoofed calls coming to 2G and 3G CS domains;
  * Analyze and evaluate if any tools in 3GPP can be used to counteract spoofed call detection and prevention;
  * Study and identify any other suitable techniques or mechanisms for spoofed call detection and prevention.
NOTE: When the \"potential requirements\" and \"potential solutions\" from the
present document might be introduced into normative documents (Technical
Specifications - TSs), the word **\"should\"** needs to be changed into
**\"shall\"** (with bold characters).
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TR 33.838: \"Study on Protection against Unsolicited Communication
for IMS (PUCI)\".
[3] 3GPP TR 33.937: \"Study of mechanisms for Protection against Unsolicited
Communication for IMS (PUCI)\".
[4] 3GPP TS 29.163: \"Interworking between the IP Multimedia (IM) Core Network
(CN) subsystem and Circuit Switched (CS) networks\".
[5] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS); Stage 2\".
[6] 3GPP TS 33.210: \"3G security; Network Domain Security (NDS); IP network
layer security\".
[7] 3GPP TS 23.081: \"Line Identification supplementary services; Stage 2\".
[8] Caller ID spoofing, http://en.wikipedia.org/wiki/Caller_ID_spoofing
[9] 3GPP TS 22.081: \"Line Identification supplementary services - Stage 1\"
[10] 3GPP TS 29.011: "Signalling interworking for supplementary services"
> [11] ITU Q.701: "Functional description of the message transfer part (MTP)
> of SignallingSystem No. 7"
[12] ITU Q.704: "Signalling network functions and messages"
[13] ITU Q.723: "Telephone user part formats and codes"
[14] ITU Q.931: "ISDN user-network interface layer 3 specification for basic
call control ITU-T"
[15] ITU Q.951: "Digital subscriber signalling system No.1 Stage 3 description
for supplementary services using DSS1"
[16] 3GPP TS 22.228: "Service requirements for the Internet Protocol (IP)
multimedia core network subsystem (IMS); Stage 1".
[17] 3GPP TS 29.010: "Signalling procedures and the Mobile Application Part
(MAP)"
[18] 3GPP TS 23.078: "Customised Applications for Mobile network Enhanced
Logic (CAMEL) Phase 4; Stage 2"
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply.\ A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**Spoofed call:** It is the practice of causing the telephone network to
display a number on the recipient\'s display that is not that of the actual
originating station.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
CLIP Calling Line Identity Presentation
CLI Calling Line Identification
IAM Initial Address Message
CID Caller Identification
PRI Primary Rate Interface
LI Line Identity
SI Screening Indicator
PI Presentation Indicator
PBX Private Branch eXchange
PRI Primary Rate Interface
# 4 Spoofed call scenarios
## 4.0 Background
### 4.0.1 General background
There are a variety of methods and technologies that can be used to make
spoofed calls as shown in the scenarios hereafter. The most common ways are
probably through leased voice line / Primary Rate Interface (PRI) / PBX or
using VoIP technology. Spoofed call is unfortunately an existing method in
telecom fraud. Potential usage of spoofed call may be
supervision or hoax in the personal sphere (may be harmless)
SPIT advertisement calls with forged CLIs to prevent that the originator of
the call can be traced back (in some countries illegal)
stalking with frequently varying presentation numbers to confuse the stalking
victim (in some countries illegal)
voice phishing by spoofing of bank IDs in order to steal user credentials
(illegal)
spoofing IDs from authoritative organizations, emergency IDs and police IDs
(illegal)
spoofing on voicemail (privacy threats) and on premium services (commercial
threats)
The list of potential spoofed call usages already shows that CLI spoofing is
not necessarily illegal. Whether CLI spoofing in general or a specific kind of
CLI spoofing is illegal or not, depends on national legislation.
Spoofed calls may indeed be terminated in a 3GPP mobile network -- an
increasing probability and threat. There are several impacts by the spoofed
calls. For example, the existence of spoofed calls lowers the trust level of
telecom services, in that people may trust all networks less and less. Fraud
can cause substantial loss to users and operators; it enhances the fraud
effect by cheating people, and threatens to create bad reputation to also
mobile networks and its services.
In order to detect the spoofed call and to find measures to deal with the
problem of spoofed calls, the most suitable methods for this problem need to
be studied and described.
### 4.0.2 Standardization background
TS 23.081 is the standard, relevant for CLI in 3GPP CS networks. It defines
in clause 1 the call identification supplementary service \'Calling Line
Identification Presentation (CLIP)\'
and in Annex A the mapping rules of the CLI parameters received via the
network-network interface to the CLI parameters to be sent to the terminating
user equipment.
There are three different information elements concerning CLIP that are
defined in TS 23.081 and are used within the messages:
the \'Calling Party Number\' information element that contains besides the
Line Identity (LI) a Screening Indicator (SI) and a Presentation Indicator
(PI)
the \'Generic Number\' information element that contains besides an additional
Line Identity (aLI) an additional Screening Indicator (aSI) and an additional
Presentation Indicator (aPI)\ The \'Generic Number\' is an additional
\'Calling Party Number\' that is provided by the user itself.
the \'Cause of no CLI\' information element that optionally tells the reasons
why the presentation of the CLI is restricted
While the Screening Indicator gives information about the origin and the depth
of \'Line Identity\' evaluation, the Presentation Indicator tells the
terminating network if a \'Line Identity\' is available at all and if yes,
whether it is allowed to present it to the terminating user. The figure
beneath shows what parameters are provided by the information elements
\'Calling Party Number\', \'Generic Number\' and \'Cause of no CLI\' and how
they interact.
{width="6.695833333333334in" height="2.70625in"}
TS 29.163 [4] is the standard, relevant for 3GPP IMS networks and specifies
the mapping between ISUP and IMS parameters. In particular, it defines the
conversion from SIP to BICC/ISUP:
in clause 7.2.3.1.2.6 \'Calling Party Number\'\ # with mapping of SIP
\'From\', \'P-Asserted-Identity\' and \'Privacy\' headers to CLI parameters\ #
with the setting of the network provided BICC/ISUP \'Calling Party Number\'
parameters\ # with the mapping of \'P-Asserted-Identity\' and \'Privacy\'
headers to BICC/ISUP \'Calling Party Number\' parameters;
in clause 7.2.3.1.2.7 \'Generic Number\' with the mapping of SIP \'From\'
header to BICC/ISUP \'Generic Number\' parameters.
The origin of problems is wider than just 3GPP networks and relates to ISUP,
also used in fixed PSTN.\ Here the \'Calling Party Number\' information
element is defined in the ITU-T Recommendation Q.931 [5] clause 4.5.10 with
the meaning and the use of the fields \'Presentation Indicator\' and
\'Screening Indicator\' ([5] clause 3 and clause 4. ISUP is under control of
the ITU.
## 4.1 Scenario 1: Spoofed call using the VoIP
In figure 4.1-1 the spoofed call is made using the VoIP technology.
Figure 4.1-1: Scenario of the spoofed call using the VoIP
When a call is made, the VoIP client will attach its caller ID to the
destination as a part of the data packet. It is easy for an attacker to make a
few changes in your VoIP packet and modify the caller ID, e.g. in the SIP
protocol, the \"caller ID\" is specified in the \"FROM field\" which is the
header line in requests such as INVITES.
## 4.2 Scenario 2: Spoofed call using the PRI/PBX
In the typical telecom environment, a Private Branch eXchange (PBX) usually
connects to the local network through Primary Rate Interface (PRI). Generally,
the network operator passes whatever caller ID through those PRI trunks
without verifications, so the PBX attacker can modify whatever number in
outbound phone number that lead to spoofed call.
Figure 4.2-1: Scenario of the spoofed call using the PRI/PBX
## 4.3 Scenario 3: Spoofing identities from an application server
Within IMS, an application server can be included in the path based on the iFC
in the service profile by the S-CSCF. Application servers can be also be
deployed by 3rd party service providers and additionally it (application
server) can act as B2BUA. The B2BUA terminates the incoming SIP leg and
initiates a new one towards the terminating side.\ It can easily exchange also
the identities and re-route the call. Based on the subscription this is
independent whether the call is originated in CS or IMS and terminated in CS
or IMS.
## 4.4 Scenario 4: Spoofing identities from an IP-PBX towards IMS
There are many ways how IP-PBX are connected to the mobile operator\'s IMS,
the basically two most common ones are:
1) The IP-PBX registers to the IMS using wildcarded IMPUs, the interface
between IP-PBX and IMS is Gm and similar to the one UE -- P-CSCF.
2) The IP-PBX does not register to the IMS and it is seen from the IMS point
of view as a peering network.
In both cases, the mobile operator has to trust the IP-PBX administrator that
everything is configured properly. While the IP-PBX (using IMS registration
procedures) is more used for smaller enterprises, the IP-PBX without
registration is more used for larger enterprises.
In both cases, the mobile operator has currently no means to detect whether a
specific attacker within the enterprise is hijacking a high number of accounts
and misbehaving e.g. with a high rate of call setups towards many
destinations.
## 4.5 Scenario 5: Spoofing of caller ID
Prerequisites: Attacker installs software to modify the caller ID sent or
subscribes to a caller ID spoofing service.
Description: An attacker fakes the caller ID displayed on the victim\'s UE to
that of a legitimate entity (e.g. bank, law enforcement, etc.) or of a
different number and coerces the victim into divulging sensitive information.
This attack can be combined with social engineering attack better results for
the attacker.
Probability: Highly likely.
Impact: harmful.
Threats to assets:
1) User: Divulging of sensitive information such as financial and personal
information which may lead to further loss of tangible assets.
2) Operators Network: damage of reputation
3) Spoofed Entity: damage of reputation, loss of trust and potential legal
issues.
Mitigation: TBD.
## 4.6 Scenario 6: Spoofing of caller location
Prerequisites: Attacker installs software to modify the caller ID sent or
subscribes to a caller ID spoofing service.
Description: An attacker fakes the caller ID displayed on the victim\'s UE not
to show an original caller ID, but a spoofed calling location in an attempt to
lead the receiving party in believing that the call originated in another
location (e.g. country).
Probability: Highly likely.
Impact: Harmful.
Threats to assets:
1) User: Divulging of sensitive information such as financial and personal
information which may lead to further loss of tangible assets. Prank and
annoying calls lead to personal anxiety and frustration which may lead to loss
of time.
2) Operators Network: damage of reputation
3) Spoofed Entity: damage of reputation, loss of trust and potential legal
issues.
## 4.7 Scenario 7: Internal spoofing
One possible scenario is where the originating party and the terminating party
are both subscribers in the same network. This particular case may not be very
common, but offers the best possibility to detect spoofing.
In this scenario, subscriber states or location information can be used to
detect spoofed call. For example:
1) Subscriber states: If the originating subscriber state is not registered in
the originating MSC, then it is possibly a spoofed call.
2) Location information: If the originating subscriber comes through a gateway
MSC and with no call forwarding indicated, location information can be used to
decide whether it is roaming. If not, then it is a possible spoofed call.
These useful information can be requested by Any Time Interrogation process to
HLR, which will provide the requested subscriber location and/or subscriber
state information.
## 4.8 Scenario 8: Direct interconnect
A second possible scenario is where the originating network and the
terminating network are directly connected.\ As mentioned in the SID,
different methods exist for spoofing the A number. From the perspective of the
terminating network, the exact method used for spoofing the caller ID is of
lesser importance, as the effect will be the same.\ The currently predominant
interconnect for voice calls that provides caller ID service uses the ISUP
protocol in SS7/C7. During call setup, the A-number is passed as an optional
parameter in the ISUP Initial Address Message (IAM). This information is then
used by the terminating network to provide the caller ID service to the
B-party.
The current security model for telephony interconnect is essentially based on
a trusted federation. That is, the intention is that only trusted parties can
participate in exchange of telephony traffic, and thus the signalling
information provided should be possible to trust and the protocols include no
specific security mechanisms for protection or validation of the information.
However, charging records are used for audit purposes after the fact. It is
worth noting that in many respects trust between the involved parties is
required to make exchange of traffic meaningful, and trust could, thus, not be
replaced with security mechanisms.
In the specific case of the A-number information passed in ISUP, the
originating network needs to be trusted to provide the correct subscriber
number among those allocated to the network. It is questionable whether it
would be practically feasible to replace this principle with a security
mechanism. However, a more interesting case of spoofing is probably where the
A-number is spoofed outside of the range allocated to the originating network,
e.g., spoofing of a government agency number from a private exchange or VoIP
provider, or similar.
In this scenario, it may be possible for the terminating network to determine,
with some degree of confidence, which network originated the traffic. Having
this information, might further permit the terminating network to detect
number spoofing outside of the number ranges allocated to the originating
network using, e.g. number masks.
## 4.9 Scenario 9: Transit interconnect
In a transit scenario, which is likely to be the most common case, it is much
more difficult to ascertain with certainty where the traffic originated and,
thus, also to determine if the originating number is correct.
# 5 Potential security requirements for detection
1) The network **should** be able to verify that the caller ID received is
from the originating party or from a party that is authorized to use the
caller ID.
2) The network **should** be able to alert a called party if the caller ID
information being sent to the called party is not authorized. The alert may be
in the form of alerting tones, flashing/blinking lights, etc.
3) 3) The network **should** be able to log the information if the caller ID
sent to the called party is not authenticated. The log information **should**
include caller ID, called ID, call time and any parameters useful for the
purpose of audit.
4) 4) The edge nodes of the network (IBCF) **should** be able to identify
whether the caller ID of the incoming session is authorized to be used. This
is valid for deployments where CS domain of a network is connected with IMS
and the call to CS is received via IMS. Checking at the edge/IBCF only works
for cases where the call is originated from an untrusted network while the
caller ID of the incoming session belongs to a trusted IP network
5) 5) If the spoofed call is detected, the network **should** be able to tear
down the call and/or save the call unique information in the database such as
blacklists.
# 6 Potential solutions for detection
## 6.1 IBCF checking incoming requests from untrusted networks
The solution in the present clause is only possible for specific deployments
where the CS domain is connected to other VoIP networks via an IMS network of
the same operator. This cannot be assumed as the general case.
The solution has the underlying basic assumptions that operators that have
interworking and roaming agreements with each other follow the recommendation
from TS 23.228 [6] to apply the security procedures as described in TS 33.210
[7] at the IBCFs. IBCFs can therefore distinguish the incoming requests from
trusted and untrusted networks, i.e. whether the request was received via an
IPSec tunnel or not. SIP URIs consist of a username and a realm, e.g. username
= bob and realm = example.com result in the SIP URI bob@example.com. The same
concept applies also for tel URIs with user= phone e.g. username =
+1-2345-67890 and realm = example.com would result in the tel URI
+1-2345-67890@example.com. The IBCF can now easily see whether an incoming
request pretending to be from the right network is also received via the
corresponding IPSec tunnel as depicted in figure 6.1-1:
{width="5.395833333333333in" height="2.109722222222222in"}
Figure 6.1-1: IBCF interconnection with different networks
Figure 6.1-1 shows the terminating Network C, which trusts the Networks A, B
and interconnects the IBCFs in a trusted way. The connection to the internet
or other networks is considered untrusted.
If now an attacking SIP server in the internet tries to setup a session to a
UE in the terminating Network C with a stolen identity from Network A, it
would send an INVITE with e.g. +1-2345-67890@NetworkA.com in the \"from\"
field to the Network C. The IBCF of the Network C can extract easily the
domain from the \"from\" field directly recognize that the INVITE is not
received via the expected security context from the IBCF of Network A.
This simple may check works fine even a UE is roaming, since the SIP
signalling is mostly routed via the home network and therefore can be expected
to be received at the terminating network via the trusted security context.
Even in the specific deployment \'CS domain protected by an IMS network\' the
solution shows some restrictions. CLI validity checks at the IBCF as described
in this clause will only work for cases where the call is originated in an
untrusted network while the caller ID of the incoming session belongs to a
trusted network. This means that callers from an untrusted network spoofing
the CLI with a number from their own network can not be detected. The same
applies for callers residing in an untrusted network and spoofing the CLI with
numbers of a different untrusted network. And even callers residing in a
trusted network that spoof the CLI with numbers of their own network could not
be detected.
The solution may not be applicable when operators interconnect their SIP
signalling via hubs, that have members that can be only partly trusted as
shown in the following figure:
{width="5.304861111111111in" height="2.526388888888889in"}
Figure 6.1-2: IBCF interconnection with different networks
In this case, the trusted contact point of the IBCF is always the same,
independently whether the original request comes from a fully trusted member
or not. The IBCF at the terminating Network C could additionally take the
\"contact\" field into account and check based on lists whether the IP address
or domain fits to the one extracted from the \"from\" header filed.
## 6.2 Present only trusted CLIs
This solution proposes to present Calling Line Identifiers (CLIs) to the
terminating user only if they can be regarded as \'trusted\'. A CLI is
regarded as trusted if all networks (originating, transit and terminating
network(s)) that the call passes are members of a federation of trust. A
federation of trust is formed by bilateral or multilateral agreements that
oblige its members to apply to the agreed policies which are:
  * Any originating network inside the federation of trust has to handle the CLI according to standards (e.g. TS 23.081 [8] in 3GPP for CS networks; refer also to clause 4.1.2 \'Standardization Background\' in the present document) and has to set the values of the parameters in the information elements \'Calling Party Number\'/\'Generic Number\' ({additional} Line Identity, {additional} Screening Indicator or {additional} Presentation Indicator) accordingly.
  * Any network inside the federation of trust that receives calls from untrusted networks is advised to set the Presentation Indicator (PI) of the \'Calling Party Number\' information element to the value \'Number not available\' and to delete all other relevant presentation parameters inside the information elements \'Calling Party Number\' and \'Generic Number\' which are \'line identity\', \'additional presentation indicator\', \'additional line identity\' and \'cause of no CLI\'.
  * Transit networks inside a federation of trust **should** not change any parameters in the information elements \'Calling Party Number\' and \'Generic Number\'.
Federations of trust form disjoint sets. I.e. a network can be a member of
only one federation of trust otherwise problems with transitive trust arise.
Receiving CLIs from an untrusted network does not necessarily mean that the
CLIs are spoofed but the integrity of the CLIs cannot be guaranteed and
therefore they may be potentially spoofed. By not presenting the CLIs in these
cases, the trust into presented CLIs in terminating CS networks can be
guaranteed if all members of the federation of trust abide by the agreed
policies.
The \'federation of trust\' is somehow related to the \'circles of trust\' as
discussed in RFC 5039 [9] by Rosenberg and Jennings. RFC 5039 [9] states that
this structure is close to that in place for legacy networks today and that
only little impairment (in case of RFC 5039 [9] voice SPAM) is known by these
kinds of structures. But although the present document deals with CLI
spoofing, the statement is in line with the risk analysis in the present
document (refer to clause 4 \'Spoofed call scenarios\') where VoIP networks
and PRI/PBX networks are regarded as the main sources of danger concerning CLI
spoofing.
The federation of trust relies on a hop-by-hop trust. Every operator network
inside the federation of trust should be able to reliably authenticate those
peer networks in the federation of trust to which it is directly connected
(e.g. by means of the Za-interface as specified in TS 33.210 [7]). From these
networks all CLIs are accepted even if these networks are not the originating
but a transit network.
{width="3.3847222222222224in" height="3.4090277777777778in"}
Figure 6.2-1 Federation of trust
It is described next by way of example how the following three types of calls
with network \'B\' as the terminating network are handled, cf. also Figure
6.2-1:
1) a call from network \'A\' to network \'B\', directly routed from network
\'A\' to network \'B\';
2) a call from network \'A\' to network \'B\' routed via the transit network
\'C\';
3) a call from network \'X\' to network \'B\' routed via the transit network
\'A\'.
In all three cases network \'B\' as the terminating network accepts the CLI-
related information in the call because the calls are received either from the
trusted network \'B\' or from the trusted network \'C\'. Network \'B\'
doesn\'t even care whether the call originates in a trusted or in an untrusted
network or whether it passes one or more transit networks. Instead it
completely relies on the belief that its neighbour networks in the federation
of trust (that is network \'A\' and network \'C\') act according to the
principles and the policies of the federation of trust which are:
  * in case 1: that the originating trusted network \'A\' evaluates and sets the CLI parameters thoroughly and standard-conforming;
  * in case 2: that the originating trusted network \'A\' acts as described before and that the trusted transit network \'C\' additionally leaves the CLI parameters unchanged during transit;
  * in case 3: that the trusted transit network \'A\' detects that the call is received from an untrusted network with the consequence that the Presentation Indicator is set to \'Number not available\' and that all other relevant parameters are deleted.
A special case inside the federation of trust is the Screening Indicator
\'User provided, not screened\'. This setting allows a \'user\' to insert an
\'additional Calling Number\' that is provided by the \'user\' itself if he
has subscribed for this service. A typical example for such a \'user\' is a
call center intending to present the number of its customers instead of its
own number. As \'User provided, not screened\' already implies, this
additional number is not verified by the originating network. Although the
\'user\' is obliged (via legislation, at least in some countries) to use only
numbers from a pool of permitted numbers, it would in principle be possible to
use this feature for CLI spoofing.
Despite of this potential danger it is proposed to accept this special
Screening Indicator in all other networks inside the federation of trust. The
reason is that the service subscription is usually restricted to trusted users
and thus such a user is at least known to the network operator. If however
such a user used this feature for CLI spoofing, complaints of spoofed victims
would allow for a detection of the spoofing source by analyzing the Call Data
Records of the terminating and the originating network. These contain besides
the additional number also the original user number. And it is assumed that
members of the federation of trust will cooperate to solve the problem.
The \'User provided, not screened\' problem exists only inside the federation
of trust. If this Screening indicator is received from an untrusted network,
it is irrelevant because the edge network of the federation of trust would
already set the Presentation Indicator to \'Number not available\' as
described above.
A federation of trust is not restricted to fixed, CS and IMS networks but also
open to all kinds of VoIP networks if they apply the principles and the
policies of the federation of trust. VoIP networks can either be directly
connected to a CS network or via an IMS network of the same operator. How a
federation of trust could look like from a CS-network point of view is in
principle shown in figure 6.2-.2.
{width="5.365277777777778in" height="3.275in"}
Figure 6.2-2 Federation of trust from a CS-network point of view
The advantage of this solution is that it can maintain the trust in presented
CLIs while being fully compatible with existing standards of 3GPP and ITU.
Required is only a corresponding setting of CLI-related parameters (setting PI
to \'Number not available\' and deleting all other CLI parameters) by the edge
node of a federation of trust that receives a call from an untrusted network.
# 7 Out-of-band methods closed to user group
## 7.1 Verifying through \"middle\" 3^rd^ party
Assume caller (A) wishes to contact another party (B). Doing so directly means
that B will see A\'s CID and **should** assume that this is valid. Given that
the CID can be manipulated there is no guarantee that it is actually A calling
B, but adding a 3^rd^ party (C) who is trusted by both A and B it should be
possible that when A calls B, B can be sure that it is actually A.
Within this process there would be a requirement for trust to be established
in both directions between A and C, but it would only be necessary for B to
trust C (it would not matter to C who B is).
Both A and B need to trust C as this is as central communication point between
both parties. B needs to trust C so that when they check an incoming call they
need to know that C is going to return a response that the can rely upon --
otherwise there would be no point in verifying the call if C was not a Trusted
Third Party (TTP). A **should** trust C as they **should** know that when they
record a call with them it will be accurately relayed to B when a request is
made.
C **should** trust A as C has the responsibility of making the final decision
as to whether a call is genuine or not, if C does not have suitable measures
for determining the identity of A then spoof A\'s could exist in C\'s
database, meaning that spoof calls can correctly be relayed to B.
{width="3.911111111111111in" height="1.4368055555555554in"}
Figure 7.1-1: Trust and communication relationships between A, B and C
Figure 7.1-1 shows the process of communication between A, B, and C. Prior to
any call trust will have been established between A and C, and B will trust C.
There will be no direct communication between A and B. When the verification
process begins and B verifies a call with C, B already trusts them, and hence
as a result of C informing them that the call is genuinely A. There is no need
for existing trust between A and B.
### 7.1.1 Process description
**1\. Calling Party A informs 3^rd^ Party C their intention to call B**
Prior to commencing the call to B, A informs C of their intentions. This
should be done via a secure channel so that the original message cannot be
tampered with (and thus creating a scenario whereby an attacker creates a
\"verified\" call by taking advantage of A\'s trust of C).
Once the message has been passed to C the phone call is made to B through
existing methods. Stage 2 should happen near instantaneously, but the call
should not be initiated until the message is known to have been passed to C.
**2\. 3rd Party C makes record of intention to call**
Once C has received the message from A that it is going to call B it should
store a record of this, but only if it has verified the identity of A.
**3\. Called Party B receives incoming call**
B\'s phone should receive the incoming call from A, if it supports this
verification functionality then see 4, else 5.
**4\. Called Party B supports call verification**
If call verification is supported then the receiving phone should
automatically be able to contact C and validate the CID. This could be done
through one of the following three processes (4.1, 4.2, 4.3):
> **4.1 Internet**
>
> If the receiving phone had an internet connection (e.g. smartphone) then
> possibly the quickest solution would be to send a request (over a secure
> protocol, HTTPS) to C containing the CID number and B\'s phone number),
> allowing for C to check if this was a valid record.
>
> **4.2 SMS**
>
> A second option (if supported) would be for B to send a SMS message to C
> indicating the same details as in (the CID number and B\'s phone number),
> allowing for V to check if this was a valid record.
>
> **4.3 Phone Line**
>
> A final option would be for B to contact C over a second phone line if one
> was present, and transmit the same data as the previous 2 methods in order
> for C to validate.
**5\. Called Party B doesn\'t support call verification**
If call verification is not supported then the CID cannot be verified
automatically. At this point the user would have to make a decision as to
whether or not to accept the call based solely on the CID, an alternative
route would be for the user to phone Cfrom another line in order to check if a
call is expected from the given number. If this route was taken the rest of
the process below would not apply.
**6\. 3^rd^ Party C Receives Validation Request**
Upon receiving a request, C should check if there is an active record of A
attempting to call B, if this exists then it can be assumed that the CID was
genuine and therefore the call can be verified. C should send a response back
containing this information so that it can be displayed to B. Once the check
has been made it should be marked as such, in order to prevent any reply
attacks whereby a user could receive a call from a fake CID and that could
then be verified against a record that was still open on C.
If there was no open record of a call between A and B then it can be assumed
that the call was not genuine and B should be informed appropriately.
If a call is genuine then where supported C could potentially send more data
about A to B in order to reinforce the validity of the call, such as company
name and logo.
**7\. Called Party B receives validation response**
Upon receiving a response from C, B\'s phone should display an appropriate
message and action to perform. If the call could not be validated then B
should be encouraged not to answer due to the risk of it. If the call was
validated then B should be informed of this, and if received also show
additional information about the call (company name, logo, etc.).
Ideally B\'s phone should not start ringing until a response has been received
from C so they can immediately make a decision about the call, but depending
upon network delay this may not be possible.
From this point the call would progress as usual with no further intervention
from C.
**8\. Call Ended**
Once the call has ended A should report to C that the call has ended, so the
record can be removed entirely to prevent a scenario whereby the same call
could be verified twice.
**9\. 3rd Party C Logs Call**
Once C has received the message from A that the call has ended this should be
logged, and if A wishes to call B again the process would start over.
Additionally if no message is received from A in a given time period the
record should also be removed to prevent leaving an open door for attackers.
### 7.1.2 Call process diagram
{width="3.6125in" height="5.129166666666666in"}
Figure 7.1-2: Call process
1) Company registers their intent to call Customer with 3^rd^ Party.
2) 3^rd^ Party confirms this.
3) Company initiates call to Customer
4) Customer receives call
5) If Customers hardware supports call verification they contact the third
party to verify that the company should be calling them, if not they make a
decision based on the CID.
6) 3^rd^ Party responds to Customer the status of the call (genuine/not).
7) Customer makes a decision as to whether or not to accept the call
7.1) If the call is genuine, or customer chooses to accept anyway the Customer
accepts and is Connected to the Company
7.1) If the call is not genuine then Customer rejects the call (potentially
add in additional step to report the caller)
8) When the call is ended the Company reports this to the 3^rd^ Party so that
the record of the call is used and cannot be validated against in the future.
## 7.2 Using TOTP to verify caller
Time-based One Time Passwords (TOTPs) are used frequently in \"2-step
verification\" login routines on websites, in particular in the Banking
sector, and exist in both Hardware and Software varieties. They are used to
generate a password that can be used to as an additional method of
authentication. Both the time and a key are used to create a hash value. This
means that there is no need for the any physical connection between the 2
parties, and at any given moment each will generate the same password.
The passwords are generated using a shared secret and a time based algorithm.
The key is something that remains static each time the password is generated,
and **should** be known by both parties otherwise the correct password cannot
be generated.
In order to take into account slight fluctuations in time between the two
parties the time used in generating the hash is taken at X second intervals,
where X is a time period that the password will be valid for, often around 30
seconds.
By hashing the secret and time interval a password can be generated that can
be used to verify that both parties are who they say they are (i.e. have the
correct secret).
The device that generates the key can either be implemented in software (e.g.
smartphone app, built into call centre software) or in hardware.
In the case of a customer verifying a company calling them, this would work by
both of them agreeing on a shared secret and then this being stored in the
customer\'s device and by the company. This process could happen by the
customer calling the company and verifying their identity to them, which in
return the company could give them the secret (e.g. 4872 3481). From this
point forward if both the customer and company were to generate a password at
any given time, they would both match (and verify each other).
When a company was to call a customer the customer would be able to verify
them by asking them to generate a TOTP, and if the customer was to do this at
the same time and they matched then that would confirm that they are talking
to the genuine company.
It would not be possible for a spoof caller to verify themselves through this
method unless they had access to the shared secret (which would represent a
security breach of the company).
One drawback of this is that it requires the customer to be alert enough to
remember this process (ask the company to verify themselves); where a genuine
company might provide the customer with a password that they can verify a
spoof caller could simply ignore this and rely on the hope that the customer
would forget to ask the company to verify itself.
### 7.2.1 TOTP key exchange
{width="3.939583333333333in" height="3.578472222222222in"}
Figure 7.1-3: TOTP key exchange process
(1) Company contacts customer informing them of new TOTP verification system
and instructions of how this is to work (also either sends hardware device or
instructions to obtain software).
(2) As per instructions in (1) customer contacts the company in order to
register with TOTP, the company then generates a secret key that will be used
for generating the TOTPs.
(3) Company passes this information on to the customer.
(4) Customer enters the key into their device, allowing them to generate keys.
### 7.2.2 Call process
{width="3.9368055555555554in" height="3.1166666666666667in"}
Figure 7.1-4: TOTP call process
1) Company calls Customer;
2) Customer asks the company to verify themselves (using TOTP);
3) Company generates TOTP on their device (likely to be integrated within call
centre software);
4) TOTP is returned to company agent;
5) Company provides TOTP to the customer;
6) Customer generates TOTP on their device;
7) Customer checks that TOTP matches with the one provided by the company;
a) Steps 3-4, and 6-7 could happen simultaneously;
8) Customer makes a decision as to whether or not to the company is genuine
(if passwords don\'t match could ask again to validate, or simply end the
call);
9) Customer continues the call if genuine.
## 7.3 Verifying caller through shared confidential data
Services exist that allow for a company to verify a customer through
confidential customer information that is provided through a trusted 3^rd^
party.
The verification process works by a company who wants to verify a customer
asking a set of confidential questions that only the customer would know the
answer to, the company trying to verify the customer does not process this
confidential information. Instead it asks a customer to identify themselves
(name, address etc.) and then this data is sent to the TTP in order for them
to verify the individual. This system works as a customer is verified using
data that only they know and the TTP have access to in order to verify their
identity, so once this is matched the TTP is able to tell the company that a
customer is who they say they are.
This solution proposes a similar process but whereby the \"customer\" and a
trusted 3^rd^ party are able to verify that the \"company\" is who they say
they are, in order to verify that the company calling is genuine (and the CID
not spoofed).
In such a process it would be difficult to ask the company for details to
verify themselves, given that much of this information would be public in the
first place (and hence available to spoof callers), or would be information
that the company would not be willing to disclose. Given this restriction a
validation method based upon shared confidential information would still have
to be between a trusted 3^rd^ party and the customer.
### 7.3.1 Company confirming information with customer
When a company contacts a customer if the call is related to private
information one of the first things they do is to verify the customer is who
they say they are, for example by asking them to confirm their date of birth.
The problem with this though is that the customer at this point has no idea if
the call is genuine. Data such as date of birth is readily available
especially if the customer was subject to identity fraud. This verification is
a one way system and works reasonably well for the company to verify its
customer, but provides no trust in the other direction.
In order for a customer to verify that the company they are speaking to is
genuine the TTP would be a place where customers can share confidential
information that can later be used for registered companies to identify
themselves. This data would be provided by the customer on an opt-in basis,
rather than being extracted from existing data sources. This means that the
customer would be able to provide data that was not necessary true, but this
would not be an issue. So long as the customer was able to give the answer
that they had given to the 3^rd^ party when challenged for the question (in
order to validate a call) then this would verify that the caller has access to
the data source and hence can be validated
Given that the information held by the 3^rd^ party would be known only by
themselves and the customer, a customer would be able to assume any registered
company who knew was able to access any details held were genuine (presuming
the company had gone through a strict process of registering themselves with
the 3^rd^ party). There would be no requirement that this data was private,
just that it was confidential between the customer and 3^rd^ party.
In order for this process to work effectively the company would have to
confirm to the customer a piece of information that is within the 3^rd^ party
database, for example:
  * Company calls customer and asks them if they were born in Ipswich and their favourite colour is beige.
    * If this is true the customer knows either the call is genuine.
    * If this information is false then the customer knows that the call is not genuine.
A potential issue with this is that a customer may not want to disclose such
confidential information to a 3^rd^ party that they know will be used to
identify them, so the information that they are willing to disclose may be
such that it is either easily accessible or known by other people. This would
make the customer more susceptible to answering a spoof call if someone had
stolen documents relating to them, for example:
  * Customer throws out bank statement and electricity bill.
  * This information is stolen and used by criminals to setup a spoof call, who confirm the information of \"X is your bank account number and your electricity provider is Y with the account number Z\".
  * The customer knowing this to be true (but not knowing their identity has been stolen) confirms the information and then proceeds to give the criminals more private information that they are able to use.
### 7.3.2 Data registration
{width="3.2in" height="2.845833333333333in"}
Figure 7.1-5: Shared data registration
1) Company informs Customer that they are using a 3^rd^ party to verify their
outgoing calls, and that they need to register their data with them if they
wish to use it.
1.1) Provide method for Customer to verify that this original contact is
genuine, otherwise could be a spoofing attempt to collect peoples data.
2) Customer registers with 3^rd^ Party using a Pin provided to them by the
Company so they can link their records with the 3^rd^ Party, also allow for
circumstances where user already has account with 3^rd^ Party so can just
enter pin to link their current account with the contacting Company.
3) 3^rd^ party collates data together with any other known sources that can
verify them.
At this stage (if the user opted in) the contacting Company could provide the
3^rd^ party with any further details that they know about the customer, so
that this could be used for other companies to verify them (e.g. if a customer
registers with a bank, then the bank could provide a list of account numbers
so that their electricity company could verify themselves by using this data).
### 7.3.3 Call process
{width="3.9375in" height="3.5006944444444446in"}
Figure 7.1-6: Shared data call process
1) Company calls Customer and verifies they are talking to the right person
(e.g. check birthday/mother\'s maiden name)
2) Customer asks Company to verify themselves (or Company offers).
3) Company sources information about the customer through the 3^rd^ Party (who
should only provide a random subset of information at any 1 time)
4) Company passes this information onto the Customer and if it is genuine then
the Customer knows that the caller can be verified.
# 8 Evaluation of potential solutions
Void.
# 9 Conclusions and recommendations
The present document analyzes solutions for the spoofed caller ID problem. It
seems practically infeasible to provide a solution that requires modifications
to the Signalling System 7 (SS7).\ But the solutions in the present document
can do without such modifications to existing standards.
Clause 6.1 (\"IBCF checking incoming requests from untrusted networks\")
provides a simple IBCF based solution for an identity check if an incoming
call is received via an untrusted network, using the identity from a trusted
network. This solution is limited to the scenario that the attacker is a SIP
server in the internet and has to pass by the IBCF to reach the terminating UE
in the CS domain.
Clause 6.2 (\"Present only trusted Calling Line Identifiers\") describes a
solution that requires configuration of parameters according to existing
standards. If a federation of trust among operators is not considered
practical, an operator can implement this solution independently of other
operators. But then only Calling Line Identifiers for calls originating from
within that operator\'s network are considered trusted and presented to the
callee.
Clause 7 (\"Verifying through \"middle\" 3^rd^ party\") provides potential
solutions which would allow for verification to occur out of band, thus not
requiring changes to the existing SS7 protocol, this being a benefit in that
existing infrastructure need not be affected by the solution(s) which are able
to seamlessly co-exist. Since this does not affect the underlying protocol
implementation these could be potentially deployed by individual service
providers, without requiring normative standardization work in 3GPP SA3.
Although the potential solutions in clause 7 may be appropriate for an
individual service provider, they are, not appropriate as a general purpose
protection mechanisms for spoofed calls in general. This is mainly because
they require a third party that is trusted by both caller A and caller B,
which seems infeasible to set up for any given parties A and B.
SA3 has finalized the present study. If in the future, a more effective
solution requiring standardization is identified, then a new normative work
item could be created.
#