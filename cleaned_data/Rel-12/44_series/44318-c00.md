# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes the procedures used over the Generic Access
Network (GAN) interface (i.e., the Up interface). The procedures are defined
in terms of messages exchanged over the Up interface.
A building block method is used to describe the procedures.
The basic building blocks are \"elementary procedures\" provided by the
Generic Access (GA) protocol control entities.
Complete layer 3 transactions consist of specific sequences of elementary
procedures. The term \"structured procedure\" is used for these sequences.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
> [1] Void.
>
> [2] 3GPP TS 23.002: \"Network Architecture\".
>
> [3] 3GPP TS 23.003: \"Numbering, Addressing and identification\".
>
> [4] 3GPP TS 23.009: \"Handover procedures\".
>
> [5] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
>
> [6] 3GPP TS 23.234: \"3GPP system to Wireless Local Area Network (WLAN)
> interworking; System description\".
>
> [7] 3GPP TS 23.236: \"Intra-domain connection of Radio Access Network (RAN)
> nodes to multiple Core Network (CN) nodes\".
>
> [8] 3GPP TS 24.008: \"Mobile radio interface layer 3 specification\".
>
> [9] 3GPP TS 26.103: \"Speech codec list for GSM and UMTS\".
>
> [10] 3GPP TS 33.234: \"3G security; Wireless Local Area Network (WLAN)
> interworking security\".
>
> [11] 3GPP TS 43.020: \"Security related network functions\".
[12] 3GPP TS 44.018: \"Mobile radio interface layer 3 specification, Radio
Resource Control (RRC) protocol\"
> [13] 3GPP TS 44.021: \"Rate adaption on the Mobile Station - Base Station
> System, (MS - BSS) Interface\"
>
> [14] 3GPP TS 48.004: \"Base Station System - Mobile-services Switching
> Centre (BSS - MSC) interface; Layer 1 specification\".
>
> [15] 3GPP TS 48.006: \"Signalling transport mechanism specification for the
> Base Station System - Mobile-services Switching Centre (BSS - MSC)
> interface\".
>
> [16] 3GPP TS 48.008: \"Mobile-services Switching Centre - Base Station
> System (MSC - BSS) interface; Layer 3 specification\".
>
> [17] 3GPP TS 48.014: \"General Packet Radio Service (GPRS); Base Station
> System (BSS) - Serving GPRS Support Node (SGSN) interface; Gb interface
> Layer 1\".
>
> [18] 3GPP TS 48.016: \"General Packet Radio Service (GPRS); Base Station
> System (BSS) - Serving GPRS Support Node (SGSN) interface; Network
> Service\".
>
> [19] 3GPP TS 48.018: \"General Packet Radio Service (GPRS); Base Station
> System (BSS) - Serving GPRS Support Node (SGSN) interface; BSS GPRS Protocol
> (BSSGP)\".
>
> [20] 3GPP TS 23.271: \"Location Services (LCS); Functional Description;
> Stage 2\".
>
> [21] Void.
>
> [22] Void.
>
> [23] RFC 4186, January 2006: \"Extensible Authentication Protocol Method for
> Global System for Mobile Communications (GSM) Subscriber Identity Modules
> (EAP-SIM)\".
>
> [24] RFC 2104, February 1997: \"HMAC: Keyed-Hashing for Message
> Authentication\".
>
> [25] RFC 4776, October 2006: \"Dynamic Host Configuration Protocol (DHCPv4
> and DHCPv6) Option for Civic Addresses Configuration Information\".
>
> [26] Void.
>
> [27] RFC 5996, September 2010: \"Internet Key Exchange Protocol Version 2
> (IKEv2)\".
>
> [28] Void.
>
> [29] Void.
>
> [30] Void.
>
> [31] Void.
>
> [32] RFC 768, August 1980: \"User Datagram Protocol\".
>
> [33] RFC 791, September 1981: \"Internet Protocol\".
>
> [34] RFC 793, September 1981: \"Transmission Control Protocol\".
>
> [35] RFC 3550, July 2003: \"RTP: A Transport Protocol for Real-Time
> Applications\".
>
> [36] Void.
>
> [37] 3GPP TS 43.318: \"Generic Access Network - Stage 2\".
>
> [38] Void.
>
> [39] Void.
>
> [40] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol
> Specification\".
>
> [41] RFC 4187, January 2006: \"Extensible Authentication Protocol Method for
> 3rd Generation Authentication and Key Agreement (EAP-AKA)\".
>
> [42] RFC 2486, January 1999: \"The Network Access Identifier\".
>
> [43] 3GPP TS 23.041: \"Technical realization of Cell Broadcast Service
> (CBS)\".
>
> [44] 3GPP TS 43.055: \"Dual Transfer Mode (DTM), Stage 2\".
>
> [45] 3GPP TS 44.060, \"Radio Link Control/Medium Access Control (RLC/MAC)
> protocol\".
>
> [46] 3GPP TS 25.133, \"Requirements for support of radio resource management
> (FDD)\".
>
> [47] 3GPP TS 45.009, \"Link adaptation\".
>
> [48] RFC 4867, April 2007: \"RTP Payload Format and File Storage Format for
> the Adaptive Multi-Rate (AMR) and Adaptive Multi-Rate Wideband (AMR-WB)
> Audio Codecs\".
[49] 3GPP TS 43.129: \"Packet-switched handover for GERAN A/Gb mode; Stage
2\".
[50] RFC 3629, November 2003: \"UTF-8 a transformation format of ISO 10646\".
[51] RFC 4040, April 2005: \"RTP Payload Format for a 64 kbit/s Transparent
Call\".
[52] 3GPP TS 25.413: \"UTRAN Iu interface Radio Access Network Application
Part (RANAP) signalling\".
[53] 3GPP TS 29.060: \"General Packet Radio Service (GPRS); GPRS Tunnelling
Protocol (GTP) across the Gn and Gp interface\".
[54] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[55] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA)
Radio Resource Control (RRC); Protocol specification\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions in 3GPP TS
43.318 and the following apply.
**Access Point ID:** The AP-ID is the physical identity (e.g. MAC address) of
the generic IP access network point through which the MS is accessing GAN
service. This identifier is provided by the MS (obtained via broadcast from
the AP) to the GANC via the Up interface, when it requests GAN service. The
AP-ID may be used by the GANC to support location services. The AP-ID may also
be used by the service provider to restrict GAN service access via only
authorized APs.
**Blind Transmission:** refers to the decision made by the SGSN to start the
transmission of downlink N-PDUs or by the target BSS/GANC to start the
transmission of downlink LLC PDUs for a given mobile station before receiving
confirmation that the PS handover procedure has been successfully completed.
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
Wm Reference point between a Security Gateway and a 3GPP AAA Server or 3GPP
AAA proxy.
## 3.3 Abbreviations
For the purposes of the present document, the following abbreviations apply:
AAA Authentication, Authorization and Accounting
AKA Authentication and Key Agreement
AP Access Point
BSC Base Station Controller
BSS Base Station Subsystem
BSSGP Base Station System GPRS Protocol
BSSMAP Base Station System Management Application Part
BTS Base Transceiver Station
CBS Cell Broadcast Service
CC Call Control
CGI Cell Global Identification
CM Connection Management
CN Core Network
CPE Customer Premises Equipment
CS Circuit Switched
CSD Circuit Switched Data
CTC Circuit Transport Channel
CTM Cellular Text Telephone Modem
DNS Domain Name System
DTM Dual Transfer Mode
E-UTRAN Evolved UTRAN
EAP Extensible Authentication Protocol
ECGI Evolved Cell Global Identifier
ESP Encapsulating Security Payload
ETSI European Telecommunications Standards Institute
FCC US Federal Communications Commission
FEC Forward Error Correction
FLR Frame Loss Ratio
FQDN Fully Qualified Domain Name
GA Generic Access
GAN Generic Access Network
GANC Generic Access Network Controller
GA-RC Generic Access Resource Control
GA-CSR Generic Access Circuit Switched Resources
GA-PSR Generic Access Packet Switched Resources
GA-RRC Generic Access Radio Resource Control
GERAN GSM EDGE Radio Access Network
GGSN Gateway GPRS Support Node
GMM/SM GPRS Mobility Management and Session Management
GPRS General Packet Radio Service
GSM Global System for Mobile communications
GSN GPRS Support Node
HLR Home Location Register
HPLMN Home PLMN
IETF Internet Engineering Task Force
IMEISV International Mobile Station Equipment Identity and Software Version
Number
IMSI International Mobile Subscriber Identity
IP Internet Protocol
ISP Internet Service Provider
LA Location Area
LAI Location Area Identity
LLC Logical Link Control
MAC Medium Access Control
MAC Message Authentication Code
MM Mobility Management
MS Mobile Station
MSC Mobile Switching Center
MSRN Mobile Station Roaming Number
MTP1 Message Transfer Part Layer 1
MTP2 Message Transfer Part Layer 2
MTP3 Message Transfer Part Layer 3
NAS Non-Access Stratum
NAT Network Address Translation
NSS Network SubSystem
PDP Packet Data Protocol
PDU Protocol Data Unit
PLMN Public Land Mobile Network
PSAP Public Safety Answering Point
PSTN Public Switched Telephone Network
PTC Packet Transport Channel
P-TMSI Packet TMSI
QoS Quality of Service
RA Routing Area
RAC Routing Area Code
RAI Routing Area Identity
RAT Radio Access Technology
RLC Radio Link Control
RRC Radio Resource Control
RTCP Real Time Control Protocol
RTP Real Time Protocol
SA Security Association
SCCP Signalling Connection Control Part
SGSN Serving GPRS Support Node
SEGW Security Gateway
SMS Short Message Service
SNDCP Sub-Network Dependent Convergence Protocol
TAI Tracking Area Identity
TBF Temporary Block Flow
TC Transport Channel
TCP Transmission Control Protocol
TEID Tunnel Endpoint Identifier
TFO Tandem Free Operation
TMSI Temporary Mobile Subscriber Identity
TrFO Transcoder Free Operation
TTY Text telephone or teletypewriter
UDP User Datagram Protocol
UMTS Universal Mobile Telecommunication System
UTRAN Universal Terrestrial Radio Access Networks
VLR Visited Location Register
# 4 Elementary procedures for handling of secure connection
## 4.1 General
All traffic over the Up interface shall be sent through the IPsec tunnel that
is established as a result of the authentication procedure.
## 4.2 Establishment of the secure connection
### 4.2.1 General
The MS and GANC-SEGW shall set up one IKE Secure Association (SA) and one
CHILD_SA for IPsec ESP according to the profiles defined in [37]. The MS shall
act as initiator, and the GANC-SEGW as responder. For MS with SIM only, the MS
and GANC-SEGW shall use EAP-SIM for mutual authentication of the MS and the
core network according to sub-clause 4.3. For MS with USIM, the MS and GANC-
SEGW shall use EAP-AKA for mutual authentication of the MS and the core
network according to sub-clause 4.4.
The MS shall use certificates for authentication of the GANC-SEGW according to
sub-clause 4.2.5.
Furthermore, the MS shall:
\- use Configuration Payload according to [27] to acquire/renew an internal IP
address in the network protected by the GANC-SEGW
\- act as initiator in the Traffic Selector (TS) negotiation. The MS shall use
the following value for the traffic selector-initiator and traffic selector-
responder payloads:
TSi = (0, 0-65535, 0.0.0.0-255.255.255.255)
TSr = (0, 0-65535, 0.0.0.0-255.255.255.255)
The GANC-SEGW shall use the following value for the traffic selector-initiator
and traffic selector-responder payloads:
TSi = (0, 0-65535, _ms_internal_address_ \- _ms_internal_address_), where
ms_internal_address is the IP address in the network protected by the GANC-
SEGW that is assigned to the MS
TSr = (0, 0-65535, 0.0.0.0-255.255.255.255)
Either the MS or GANC-SEGW may initiate re-keying of the SA based on their
individual lifetime policy on the SA.
### 4.2.2 Identities
The MS shall send its EAP-SIM or EAP-AKA identity (composed according to sub-
clauses 4.3.2 and 4.4.2) as initiator identity IDi.
The MS shall include the GANC-SEGW identity that it wishes to communicate with
in the Identity Responder (IDr) payload in the IKE_SA_AUTH Request (message 3)
as follows:
\- If the MS derived the FQDN of the Provisioning GANC-SEGW from the IMSI (as
described in [3]), it shall include the derived FQDN in the Identification
Data field of the IDr payload and indicate Identity Type 2 (ID_FQDN) in the ID
Type field of the IDr payload;
\- If the MS was provisioned with an IPv4 address of the Provisioning GANC-
SEGW, or received it in the GA-RC DISCOVERY ACCEPT message or GA-RC REGISTER
REDIRECT message for the Default or a Serving GANC-SEGW, it shall include that
IPv4 address in the Identification Data field of the IDr payload and indicate
Identity Type 1 (ID_IPV4_ADDR) in the ID Type field of the IDr payload;
\- If the MS was provisioned with an IPv6 address of the Provisioning GANC-
SEGW, or received it in the GA-RC DISCOVERY ACCEPT message or GA-RC REGISTER
REDIRECT message for the Default or a Serving GANC-SEGW, it shall include that
IPv6 address in the Identification Data field of the IDr payload and indicate
Identity Type 5 (ID_IPV6_ADDR) in the ID Type field of the IDr payload;
\- If the MS was provisioned with a FQDN of the Provisioning GANC-SEGW, or
received it in the GA-RC DISCOVERY ACCEPT message or GA-RC REGISTER REDIRECT
message for the Default or a Serving GANC-SEGW, it shall include that FQDN in
the Identification Data field of the IDr payload and indicate Identity Type 2
(ID_FQDN) in the ID Type field of the IDr payload;
The GANC-SEGW shall provide the GANC-SEGW identity in the Identity Payload
(IDr) as following:
Identity Type = 2 (ID_FQDN) or 1 (ID_IPV4_ADDR) or 5 (ID_IPV6_ADDR)
Identity Data = GANC-SEGW FQDN or IPv4 address or IPv6 address, respectively
Identity Type shall match the Type of the SubjectAltName contained in the
GANC-SEGW certificate as well as what was provisioned in the MS for
Provisioning GANC-SEGW or provided in GA-RC DISCOVERY ACCEPT for Default GANC-
SEGW or GA-RC REGISTER REDIRECT for Serving GANC-SEGW.
### 4.2.3 Crypto negotiation
The MS and GANC-SEGW negotiate the cryptographic suite to use for the SA, as
per [27].
The MS shall include all the algorithms for integrity and confidentiality
(defined in the profile for IPsec ESP in [37]) that it supports in the
proposal. The GANC-SEGW signals back the selected algorithms that will be used
for confidentiality and integrity protection, based on core network policy.
### 4.2.4 NAT traversal
The MS and GANC-SEGW shall use the IKEv2 mechanisms for detection of NAT, NAT
traversal and keep-alive (as specified in [27]). If NAT is detected, the MS
and GANC-SEGW shall use the UDP encapsulation of ESP packets mechanism (as
specified in [30]).
### 4.2.5 Certificate Handling and Authentication
As the MS and GANC-SEGW use EAP-SIM or EAP-AKA for mutual authentication,
IKEv2 mandates that this is used in conjunction with a public key signature
based authentication of the GANC-SEGW to the MS.
The MS requirements for certificate authentication and handling are listed in
3GPP TS 33.234 [10].
In addition to the requirements listed in 3GPP TS 33.234 [10], the MS shall
take the following actions for received GANC-SEGW certificates:
\- match the SubjectAltName in the end entity certificate with the IDr
payload, and with GANC-SEGW identity obtained from derivation of the
Provisioning GANC-SEGW FQDN, provisioning, discovery or register redirect.
\- If the MS was provisioned with an IP address of the GANC-SEGW, (or received
it in the GA-RC DISCOVERY ACCEPT or GA-RC REGISTER REDIRECT message), then the
certificate shall contain an IPaddress SubjectAltName that matches that
address.
\- If the MS was provisioned with an FQDN of the GANC-SEGW, or received it in
the GA-RC DISCOVERY ACCEPT or GA-RC REGISTER REDIRECT message, then the
certificate shall contain a DNSname SubjectAltName that matches that FQDN.
\- If the MS derived the FQDN of the Provisioning GANC-SEGW, then the
certificate shall contain a DNSname SubjectAltName that matches that FQDN.
\- If a single SubjectAltName extension contains several IPaddress or DNSname
components, at least one of them shall match the expected value.
### 4.2.6 Abnormal cases
If the MS and GANC-SEGW are not able to set up the SA for any other reason
than EAP-SIM or EAP-AKA authentication failure, and the current GANC-SEGW is
the SEGW associated to the Default GANC or a Serving GANC, the MS shall act as
if a \"Lower layer failure in the MS\" has occurred and act as defined in sub-
clause 6.2.4.2.
If the MS and GANC-SEGW are not able to set up the SA for any other reason
than EAP-SIM or EAP-AKA authentication failure, and the current GANC-SEGW is
the SEGW associated to the Provisioning GANC, the MS shall act as if a \"Lower
layer failure in the MS\" has occurred and act as defined in sub-clause 5.6.2.
## 4.3 EAP-SIM authentication
### 4.3.1 General
After the initial IKEv2 exchanges, EAP-SIM authentication is invoked by
deferring the sending of the AUTH payload, as per [27].
The GANC-SEGW shall:
\- compose an EAP Response/Identity message containing the IDi of the MS and
send this message to the AAA server. This will trigger the EAP-SIM
authentication procedure.
\- communicate with the local AAA server over the Wm interface, and relay
traffic between the local AAA server and MS.
After the MS has received the EAP Success message (i.e. EAP-SIM authentication
procedure was successful), the MS and GANC-SEGW complete the setup of the SA.
### 4.3.2 EAP-SIM Identity
The MS sends its identity as part of the initial IKE exchanges, and this also
serves as identify for the EAP-SIM exchange. The identity is composed
compliant with the Network Access Identifier (NAI) format specified in [42]
and [3].
### 4.3.3 EAP-SIM Fast Re-authentication
The MS may use the re-authentication identity that was provided during the
previous EAP-SIM authentication procedure to authenticate using EAP-SIM fast
re-authentication instead of the full authentication procedure. The MS shall
use the realm part provided by the EAP-SIM server as part of the fast re-
authentication identity, as specified in [23].
The MS may attempt to use the fast re-authentication procedure when it has an
unused re-authentication identity available. The MS shall not use one re-
authentication identity more than once. The fast re-authentication procedure
shall not be used for the first authentication after the MS has powered up, in
that case it shall use the full authentication procedure.
### 4.3.4 Abnormal cases
If the EAP-SIM authentication procedure fails, and the current GANC-SEGW is
the SEGW associated to the Default GANC or a Serving GANC fails, the MS shall
act as if it had received GA-RC REGISTER REJECT with the Reject Cause value
\'IMSI not allowed\' as defined in sub-clause 6.2.3.3.
If the EAP-SIM authentication procedure fails, and the current GANC-SEGW is
the SEGW associated to the Provisioning GANC, the MS shall act as if it had
received GA-RC DISCOVERY REJECT with the Reject Cause value \'IMSI not
allowed\' as defined in sub-clause 5.5.2.
## 4.4 EAP-AKA authentication
### 4.4.1 General
After the initial IKEv2 exchanges, EAP-AKA authentication is invoked by
deferring the sending of the AUTH payload, as per [27].
The GANC-SEGW shall:
\- compose an EAP Response/Identity message containing the IDi of the MS and
send this message to the AAA server. This will trigger the EAP-AKA
authentication procedure.
\- communicate with the local AAA server over the Wm interface, and relay
traffic between the local AAA server and MS.-
After the MS has received the EAP Success message (i.e. EAP-AKA authentication
procedure was successful), the MS and GANC-SEGW complete the setup of the SA.
### 4.4.2 EAP-AKA Identity
The MS sends its identity as part of the initial IKE exchanges, and this also
serves as identify for the EAP-AKA exchange. The identity is composed
compliant with the Network Access Identifier (NAI) format specified in [42]
and [3].
### 4.4.3 EAP-AKA Fast Re-authentication
The MS may use the re-authentication identity that was provided during the
previous EAP-AKA authentication procedure to authenticate using EAP-AKA fast
re-authentication instead of the full authentication procedure. The MS shall
use the realm part provided by the EAP-AKA server as part of the fast re-
authentication identity, as specified in [41].
The MS may attempt to use the fast re-authentication procedure when it has an
unused re-authentication identity available. The MS shall not use one re-
authentication identity more than once. The fast re-authentication procedure
shall not be used for the first authentication after the MS has powered up, in
that case it shall use the full authentication procedure.
### 4.4.4 Abnormal cases
If the EAP-AKA authentication procedure fails, and the current GANC-SEGW is
the SEGW associated to the Default GANC or a Serving GANC fails, the MS shall
act as if it had received GA-RC REGISTER REJECT with the Reject Cause value
\'IMSI not allowed\' as defined in sub-clause 6.2.3.3.
If the EAP-AKA authentication procedure fails, and the current GANC-SEGW is
the SEGW associated to the Provisioning GANC, the MS shall act as if it had
received GA-RC DISCOVERY REJECT with the Reject Cause value \'IMSI not
allowed\' as defined in sub-clause 5.5.2.
## 4.5 Release of the secure connection
The SA is closed according the procedures defined in [27].
# 5 GA-RC elementary procedures for GANC Discovery
### 5.1 Purpose of the Discovery Procedure
The purpose of the Discovery procedure is to allow the network to allocate a
Default GANC to a MS. This allocation consists of the IP address or FQDN of
the Default GANC-SEGW, and the IP address or FQDN and TCP port of the Default
GANC to be used for the Registration procedure. As long as the Default GANC is
available in the network the MS shall not perform Discovery procedure again.
The Discovery procedure is performed using the IPsec tunnel that is
established between the MS and the Provisioning GANC-SEGW as defined in sub-
clause 4.2.
### 5.2 Discovery procedure
The Discovery procedure is performed between the MS and the Provisioning GANC.
The Discovery procedure is initiated by the MS in order to receive information
about the Default GANC to be used for future instances of the Registration
Procedure.
Figure 5.2: Discovery procedure
### 5.3 Discovery Request initiation by the MS
This procedure shall be triggered after the MS has gained IP connectivity
(i.e. an IP address is allocated to the MS in the \"transport IP\" layer) and
the MS has either no stored information about a Default GANC or if the
previous Registration procedure towards the Default GANC was unsuccessful.
The MS may initially be provisioned with information (i.e. an IP address or a
FQDN) about the Provisioning GANC and the corresponding Provisioning SEGW
related to that GANC. The provisioning of this information in the MS is out of
the scope of this document. This information can be in the format of either a
FQDN or an IP-address or any combination of these.
The MS shall:
\- If the MS holds an IP address of the Provisioning SEGW, the MS establishes
the secure connection towards the Provisioning SEGW according to sub-clause
4.2;
\- If the MS holds a FQDN of the Provisioning SEGW, the MS performs a public
DNS query to retrieve the IP-address of the Provisioning SEGW and establish
the secure connection towards the Provisioning SEGW according to sub-clause
4.2. The MS shall not store the IP address retrieved from DNS for subsequent
procedures (apart from DNS resolver caching);
\- In case the MS is not provisioned with information about the Provisioning
SEGW, derive a FQDN of the Provisioning SEGW from the IMSI (as described in
[3]);
The MS performs a public DNS Query to retrieve the IP-address of the
Provisioning SEGW and establish the secure connection towards the Provisioning
SEGW according to sub-clause 4.2. The MS shall not store the IP address
retrieved from DNS for subsequent procedures (apart from DNS resolver
caching);
\- Following successful establishment of secure connection to the Provisioning
SEGW:
\- If the MS holds an IP address of the Provisioning GANC, the MS shall
establish a TCP connection to the Provisioning GANC using the well-known TCP
port for Discovery as defined in sub-clause 12.2.1
\- If the MS holds a FQDN of the Provisioning GANC, the MS shall perform a DNS
query \"inside the secure connection\" to retrieve the IP-address of the
Provisioning GANC. The MS shall establish a TCP connection to the Provisioning
GANC using this IP address and a TCP port defined for Discovery (see sub-
clause 12.2.1). The MS shall not store the IP address retrieved from DNS for
subsequent procedures (apart from DNS resolver caching).
\- In cases where the MS is not provisioned with information about the
Provisioning GANC, the MS derives a FQDN of the Provisioning GANC from the
IMSI (as described in [3]).
A DNS query is performed \"inside the secure connection\" to retrieve the IP-
address of the Provisioning GANC. The MS shall not store the IP address
retrieved from DNS for subsequent procedures (apart from DNS resolver
caching).A TCP connection is then established inside the IPsec tunnel, to the
Provisioning GANC using the TCP port defined for Discovery procedure (see sub-
clause 12.2.1).
\- In all cases the MS shall establish only a single TCP connection to the
GANC over the IPsec tunnel.
\- After successful establishment of a secure connection to the SEGW and a TCP
connection to the GANC the MS shall proceed as follows:
\- If the Discovery Procedure is due to the MS failing to register with a
GANC, the MS includes the following information elements in the GA-RC
DISCOVERY REQUEST message: Register Reject Cause IE, Redirection Counter IE
and Default GANC IE,
\- Send a GA-RC DISCOVERY REQUEST message to the Provisioning GANC on the
established TCP connection.
\- When GA-RC layer has submitted the GA-RC DISCOVERY REQUEST message to the
TCP layer, it shall start timer TU3901.
### 5.4 Discovery Request processing by the network
When receiving the GA-RC DISCOVERY REQUEST message the Provisioning GANC may
either accept or reject the Discovery request from the MS.
#### 5.4.1 Discovery accepted
If the Provisioning GANC accepts the Discovery request from the MS, it shall
send the GA-RC DISCOVERY ACCEPT message to the MS. When the GA-RC layer in the
Provisioning GANC has submitted the GA-RC DISCOVERY ACCEPT message to the TCP
layer, it may initiate release of its half of the bidirectional TCP
connection.
The Provisioning GANC may use the Redirect Counter IE, Register Reject Cause
Value IE and Default GANC IE received in the GA-RC DISCOVERY REQUEST message
to assign a different Default GANC for the MS.
#### 5.4.2 Discovery rejected
If the Provisioning GANC rejects the Discovery request from the MS, it shall
send the GA-RC DISCOVERY REJECT message to the MS. When the GA-RC layer in the
Provisioning GANC has submitted the GA-RC DISCOVERY REJECT message to the TCP
layer and the value of the Discovery Reject Cause IE included in the message
was not \'Network Congestion\', it may initiate release of its half of the
bidirectional TCP connection.
The Provisioning GANC may use the Redirect Counter IE, Register Reject Cause
Value IE and Default GANC IE received in the GA-RC DISCOVERY REQUEST message
to detect a problem and reject the MS.
### 5.5 Discovery response processing by the MS
#### 5.5.1 Discovery accepted
When the MS receives GA-RC DISCOVERY ACCEPT message, it shall:
\- stop the timer TU3901.
\- set the timer value for TU3903 to the default value,
\- store the information about Default GANC in persistent storage:
\- The Default GANC information consists of the Default GANC, SEGW associated
with the Default GANC and optionally a TCP port to be used with that Default
GANC. If a specific TCP Port is not received in the message, the defined port
for Registration is used (see sub-clause 12.2.1)
\- release the TCP connection towards the Provisioning GANC
\- the secure connection to the Provisioning SEGW can be reused as follows;
\- If the MS is provisioned with an IP address of the Provisioning GANC-SEGW
and it matches the received Default GANC-SEGW IP address IE, the MS shall
reuse the existing secure connection.
\- If the MS is provisioned with a FQDN of the Provisioning GANC-SEGW or
derived a FQDN for the Provisioning GANC-SEGW and it matches the received
Default GANC-SEGW FQDN IE, the MS shall reuse the existing secure connection.
\- otherwise the MS shall release the existing secure connection towards the
SEGW of the Provisioning GANC as defined in sub-clause 4.5
\- initiate the registration procedure towards the Default GANC as defined in
sub-clause 6.2.
#### 5.5.2 Discovery rejected
When the MS receives GA-RC DISCOVERY REJECT message it shall:
\- stop the timer TU3901,
\- set the timer value for TU3903 to the default value,
\- If the value of the Reject Cause IE indicates \'Network Congestion\' , the
MS shall:
\- Maintain the secure connection to the GANC-SEGW and the TCP connection to
the GANC.
\- Create a random value between zero and the received value in TU3902 Timer
IE, and
\- Add this value to the received value in TU3902 Timer IE, this becomes the
new value for TU3902.
\- Start timer TU3902 according to the new calculated value _._
\- If the value of the Reject Cause IE indicates \'IMSI not allowed\' or
\"Unspecified\", then the MS shall:
\- Release the TCP connection established to the Provisioning GANC, if still
established.
\- Release the secure connection towards the SEGW associated with the
Provisioning GANC as defined in sub-clause 4.5.
\- Not initiate a new Discovery procedure until the next power-on.
### 5.6 Abnormal cases
#### 5.6.1 TU3901 expiry
If timer TU3901 has expired in the MS, the MS shall:
\- release the TCP connection towards the Provisioning GANC,
\- release the secure connection towards SEGW of the Provisioning GANC as
defined in sub-clause 4.5,
\- double the current value for timer TU3903 but not exceeding the maximum
value defined for this timer as defined in sub-clause 12.1.1 and
\- start timer TU3903 and wait for it to expire.
#### 5.6.2 Lower layer failure in the MS
Lower layer failure in the MS can be for example related to DNS, IPsec or TCP.
If any lower layer failure happens in the MS, the MS shall:
\- release the TCP connection towards the Provisioning GANC, if established,
\- release the secure connection towards SEGW of the Provisioning GANC, if
established, as defined in sub-clause 4.5,
\- double the current timer value for TU3903 but not exceeding the maximum
value defined in sub-clause 12.1.1,
\- stop timer TU3901 if running and
\- start timer TU3903 and wait for it to expire.
#### 5.6.3 TU3902 expiry
If timer TU3902 has expired in the MS, the MS shall:
\- if the TCP connection to the Provisioning GANC is still established:
\- send a GA-RC DISCOVERY REQUEST message and
\- start timer TU3901
\- otherwise, restart the Discovery procedure as defined in sub-clause 5.3.
#### 5.6.4 TU3903 expiry
If timer TU3903 has expired in the MS, the MS shall restart the Discovery
procedure as defined in sub-clause 5.3.
# 6 GA-RC elementary procedures for Registration
## 6.1 Purpose of GAN Registration
The Registration procedure is performed between the MS and the GANC (Default
or Serving GANC). The purpose of this procedure is to allow the MS to register
for GAN services on the most suitable GANC for the network. The MS as part of
the Registration procedure provides the GANC with information relating to the
current connectivity of the MS. The GANC, as part of a successful
Registration, indicates the GAN mode (i.e., GAN A/Gb mode or GAN Iu mode) that
the MS shall operate in while registered with the GANC and provides the MS
with the \"System Information\" message content that is applicable in GAN
mode. The Registration procedure is performed using the IPsec tunnel that is
established between the MS and the Default or the Serving GANC-SEGW as defined
in sub-clause 4.2.
## 6.2 Registration procedure
Figure 6.2.1: Registration procedure
### 6.2.1 Registration initiation by the MS
This procedure shall be triggered by the MS under the following conditions:
\- the MS has gained IP connectivity (i.e. an IP address is allocated to the
MS in the \"transport IP\" layer); and
\- the MS has stored information about a Default GANC.
The Registration procedure is initiated towards the Default GANC after a
successful Discovery procedure or after a failed Registration towards a
Serving GANC, where no GAN PLMN list was provided to the MS from the Default
GANC. The Registration procedure is also initiated towards the Default GANC
when no more PLMNs can be selected from the GAN PLMN List received from the
Default GANC.
As part of the Registration procedure, the MS may receive a list of PLMN
identities when trying to register towards the Default GANC. This list of PLMN
identities is passed to the GANC selection process. Following PLMN selection
by the GANC selection process, and if registered to a Serving GANC, the MS
shall first deregister from the current Serving GANC as defined in sub-clause
6.4.1, and then attempt the registration procedure towards the Serving GANC-
SEGW and GANC associated with the selected PLMN.
This procedure is also triggered towards the Default GANC, if the MS at any
time wishes to perform manual PLMN selection or \"User reselection\"
irrespective of whether the MS is in manual or automatic PLMN selection mode.
If the MS is already successfully registered to a Serving GANC, and a manual
PLMN selection or \"User reselection\" is initiated, the MS shall first
deregister from the current Serving GANC as defined in sub-clause 6.4.1 and
then initiate registration towards the Default GANC and include an indication
that a list of PLMN identities is requested for manual PLMN selection or user
reselection. After receiving the requested PLMN list from the Default GANC the
MS shall then re-register on the last registered Serving GANC.
GANC information required to initiate the Registration procedure consists of a
GANC-SEGW address, a GANC address and a GANC TCP port number. The MS shall
initiate the Registration procedure towards a Serving GANC if the
corresponding GANC information is available in the stored Serving GANC table.
If successful, the stored Serving GANC table in the MS may be updated to
contain address information of the successfully registered Serving GANC and
the corresponding GSM-CGI, UTRAN cell identity or E-UTRAN cell identity, if
available, or AP-ID, if no GSM CGI, UTRAN cell identity or E-UTRAN cell
identity is available (see sub-clause 6.2.3.1). UTRAN cell identity consists
of the Location Area Identity (LAI) and Cell Identity (defined in [40]).
E-UTRAN cell identity consists of the Tracking Area Identity (TAI) and Cell
Identity (defined in [55]). The Default GANC is in control of whether or not
the MS is allowed to store GANC information in the stored Serving GANC table.
If the MS is in GERAN, UTRAN or E-UTRAN coverage, it shall check if it has
stored Serving GANC information for the current GSM CGI in case of GERAN
coverage, UTRAN cell identity in case of UTRAN Coverage, or E-UTRAN cell
identity in case of E-UTRAN coverage, or if the MS is not in
GERAN/UTRAN/E-UTRAN coverage, it shall check if it has stored Serving GANC
information for the current AP-ID:
\- if found, the MS shall initiate the GAN Registration procedure towards the
stored Serving GANC
\- if not found, the MS shall initiate the GAN Registration procedure towards
the Default GANC
The Location Black List contains information about forbidden Locations
acquired while attempting GAN registration and is only valid if the MS is in
GERAN or UTRAN coverage. It can contain Location information on 3 different
levels: Country (i.e. MCC), PLMN (i.e. MCC and MNC) and Location Area (i.e.
MCC, MNC and LAC). If the MS is in a location identified by an entry in the
Location Black List, the MS shall not initiate the GAN Registration procedure.
The Location Black List shall be deleted upon power cycle.
The AP Black List contains information about denied APs. If the MS is being
provided IP connectivity by an AP that is on the AP Black List, the MS shall
not initiate discovery or GAN registration, until the relevant AP has been
removed from the AP Black List. The AP Black List shall be deleted upon power
cycle.
To initiate the GAN registration procedure the MS shall:
\- If the MS has stored an IP address of the GANC-SEGW, and the MS does not
already have an established secure connection to this GANC-SEGW, the MS
establishes a secure connection towards the GANC-SEGW according to sub-clause
4.2;
\- If the MS has stored a FQDN of the GANC-SEGW, the MS performs a public DNS
query to retrieve the IP-address of the GANC-SEGW, if the MS does not already
have an established secure connection to this GANC-SEGW, the MS establishes
the secure connection towards the GANC-SEGW according to sub-clause 4.2. The
MS shall not store the IP address retrieved from DNS for subsequent procedures
(apart from DNS resolver caching).
Following successful establishment of secure tunnel:
\- If the MS holds an IP address of the GANC, the MS establishes a TCP
connection to the GANC at the stored TCP port to be used for Registration with
this GANC. If no TCP port has been stored for this GANC, the default TCP port
(see sub-clause 12.2.1) shall be used;
\- If the MS holds a FQDN of the GANC, the MS performs a DNS query \"inside
the secure tunnel\" to retrieve the IP-address of the GANC. The MS establishes
a TCP connection to the GANC at the stored TCP port to be used for
Registration with this GANC. If no TCP port has been stored for this GANC, the
default TCP port (see sub-clause 12.2.1) shall be used. The MS shall not store
the retrieved IP address for subsequent procedures (apart from DNS resolver
caching);
\- The MS shall only establish a single TCP connection to the GANC over the
IPsec tunnel.
After successful establishment of a secure connection to the SEGW and a TCP
connection to the GANC, the MS sends a GA-RC REGISTER REQUEST message to the
GANC on the TCP connection, including the following information elements:
\- The Geographical Location IE, if available;
\- AP Location IE, if available;
\- Required GAN Services IE, if required;
\- If a GAN PLMN list was received during the last registration attempt with
the Default GANC and the GANC selection process is finished unsuccessfully
(i.e. the MS was not successfully registered to a Serving GANC and to the
associated PLMN in the GAN PLMN List IE), then the MS includes the received
GAN PLMN List information in the GAN PLMN List IE in the GA-RC REGISTER
REQUEST message;
\- Else if the MS failed to register during the last registration it attempted
with a GANC (Default or Serving), then Register reject Cause IE, Redirection
Counter IE and address information (i.e. IP Address or the **Fully Qualified
Domain/Host Name IE**) of the last GANC and last GANC-SEGW;
\- Else if the MS was redirected during the last registration it attempted
with a GANC (Default or Serving):
\- Redirection Counter IE and address information (i.e. IP address or FQDN) of
the last GANC and last GANC-SEGW
When GA-RC layer has submitted the GA-RC REGISTER REQUEST message to the TCP
layer, it shall start a timer TU3904
### 6.2.2 Registration processing by the network
#### 6.2.2.1 General
When receiving the GA-RC REGISTER REQUEST message the GANC may either accept
or reject the Registration request from the MS. The GANC may also redirect the
MS to another GANC or provide a list of PLMN identities that may provide GAN
service to the MS.
The GANC should verify that the binding (IMSI, inner IP address) as received
in the GA-RC REGISTER REQUEST is the same as the one that the MS used during
authentication to the GANC-SEGW.
#### 6.2.2.2 Registration accepted
If the GANC accepts the Registration request from the MS, it shall send the
GA-RC REGISTER ACCEPT message to the MS and store information relating to the
GAN service requirements of the mobile station.
If the Default GANC indicator is included in the GA-RC REGISTER REQUEST
message received from the MS, then the GANC shall include the Serving GANC
Table indicator to indicate to the MS whether or not the MS is allowed to
store the GANC information in the stored Serving GANC table.
The GANC shall include the IE \"GAN Mode Indicator\" if the IE \"GAN
Classmark\" received by the GANC in the GA-RC REGISTER REQUEST message
included the GAN Mode Support Indicator field with value other than
Unspecified. The IE \"GAN Mode Indicator\" indicates the GAN mode (i.e., GAN
A/Gb mode or GAN Iu mode) that the MS shall operate in while registered with
the GANC.
#### 6.2.2.3 Registration redirected
If the GANC decides to redirect the MS to another GANC, the network shall send
the GA-RC REGISTER REDIRECT message to the MS and act as follows:
\- If the MS attempts to register with the Default GANC as indicated by the
presence of the Registration Indicators IE in the GA-RC REGISTER REQUEST
message and the MS is not in manual PLMN selection mode, user reselection was
not triggered and the MS is being redirected to a Serving GANC in the HPLMN,
the GANC shall not include the GAN PLMN List information element.
\- If the MS attempts to register with the Default GANC as indicated by the
presence of the Registration Indicators IE in the GA-RC REGISTER REQUEST
message, and the MS is not in manual PLMN selection mode, user reselection was
not triggered and based on the current MS location and operator policies, the
MS needs to perform a GANC selection, the GANC shall include the GAN PLMN List
information element.
\- If the MS attempts to register with the Default GANC as indicated by the
presence of the Registration Indicators IE in the GA-RC REGISTER REQUEST
message and that the MS is in manual PLMN selection mode or user reselection
was triggered and requests a list of PLMNs, the GANC shall include the GAN
PLMN List information element.
\- If the MS attempts to register with a Serving GANC as indicated by the
absence of the Registration Indicators IE in the GA-RC REGISTER REQUEST
message, the GANC shall not include the GAN PLMN List information.
When the GA-RC layer in the network has submitted the GA-RC REGISTER REDIRECT
message to the TCP layer, it may initiate release of its half of the
bidirectional TCP connection.
The GANC can send this message at any time, but it shall not be sent to an MS
in GA-CSR-DEDICATED or GA-PSR-ACTIVE state.
The GANC may use the Redirect Counter IE, Register Failure Cause IE, Register
Reject Cause Value IE and Last GANC IE to detect a problem and redirect the MS
to a different Serving GANC.
If the Default GANC indicator is included in the GA-RC REGISTER REQUEST
message received from the MS, then the GANC may include the Serving GANC Table
indicator to indicate to the MS whether or not the MS is allowed to store the
GANC information in the stored Serving GANC table.
#### 6.2.2.4 Registration rejected
If the GANC decides to reject the registration from the MS, it shall send the
GA-RC REGISTER REJECT message to the MS. When the GA-RC layer in the network
has submitted the GA-RC REGISTER REJECT message to the TCP layer and the value
of the Register Reject Cause IE included in the message was not \'Network
Congestion\', it may initiate release of its half of the bidirectional TCP
connection.
The GANC may use the Redirect Counter IE, Register Failure Cause IE, Register
Reject Cause Value IE and Last GANC IE to detect a problem and reject the MS.
### 6.2.3 Registration response processing by the MS
#### 6.2.3.1 Registration accepted
When the MS receives GA-RC REGISTER ACCEPT message, it shall:
\- stop the timer TU3904,
\- reset the Redirection Counter,
\- retrieve the **GAN Mode Indicator IE (if included) and:**
\- if no GAN Mode Indicator IE is included or if the GAN Mode Indicator IE is
included and indicates that the MS shall operate in GAN A/Gb mode, and the MS
supports GAN A/Gb mode, then the MS shall operate in GAN A/Gb mode while
registered with the GANC.
\- if the GAN Mode Indicator IE is included and indicates that the MS shall
operate in GAN Iu mode, and the MS supports GAN Iu mode, then the MS shall
operate in GAN Iu mode while registered with the GANC.
\- if GAN A/Gb mode is selected, then retrieve the GAN System Information
parameters and:
\- send the contents of GAN Cell Description IE (if received) to the GSM RR
layer or UTRAN RRC to be used for Measurement Reports in GSM RR dedicated mode
or GSM RR packet transfer mode or UTRAN RRC connected mode
\- store the received GAN System Information and when GA-RC becomes the
serving layer send the following information to the upper layers either
immediately or upon entering the GA-CSR-IDLE state if the MS is currently in
GA-CSR-DEDICATED state:
\- from GAN Control Channel Description IE\ \- Network Mode of Operation,\ \-
GPRS availability Indicator,\ \- Dual Transfer Mode Indicator,\ \- IMSI
Detach/Attach indicator,\ \- MSC Release Indicator,\ \- SGSN Release
Indicator,\ \- T3212 timer value,\ \- Routing Area Code,\ \- Emergency Call
Mode Preference and\ \- Emergency Call indicator.
\- GAN Location Area Identity.
\- Store the Early Classmark Sending Indicator from GAN Control Channel
Description IE.
\- Store the Call Re-establishment bit from GAN Control Channel Description
IE.
\- if GAN Iu mode is selected, then retrieve the GAN System Information
parameters and:
\- send the contents of GAN Iu Mode Cell Description IE (if received) to the
GSM RR layer or UTRAN RRC to be used for Measurement Reports in GSM RR
dedicated mode or GSM RR packet transfer mode or UTRAN RRC connected mode
\- store the received GAN System Information and when GA-RC becomes the
serving layer send the following information to the upper layers either
immediately or upon entering the GA-RRC-IDLE state if the MS is currently in
GA-RRC-CONNECTED state:
\- from GAN Control Channel Description IE\ \- Network Mode of Operation,\ \-
IMSI Detach/Attach indicator,\ \- MSC Release Indicator,\ \- SGSN Release
Indicator,\ \- T3212 timer value,\ \- Routing Area Code,\ \- Emergency Call
Mode Preference and\ \- Emergency Call indicator.
\- GAN Location Area Identity.
\- Store the Call Re-establishment bit from GAN Control Channel Description
IE.
\- Start Keep alive mechanism as defined in sub-clause 6.5 using the received
TU3906 Timer IE.
\- Use the received TU3910 Timer value as follows:
\- When the MS roves out (i.e. leaves GAN mode and enters GERAN/UTRAN mode),
it shall start timer TU3910 and shall not rove in (i.e. leave GERAN/UTRAN mode
and enter GAN mode) until this timer has expired, unless the MS has detected
loss of GERAN or UTRAN coverage.
\- If timer TU3910 is running and MS is in GA-RC-REGISTERED state and;
\- MS receives GA-RC REGISTER UPDATE DOWNLINK message, the MS shall restart
the timer TU3910 using the new value if included in the message.
\- If the GA-RC REGISTER ACCEPT was received from the Default GANC, the MS
shall store the received Serving GANC table indicator and shall consider the
Default GANC to be the Serving GANC.
\- If the stored Serving GANC Table indicator is set to \"store\", update the
stored Serving GANC table as follows (the SEGW and GANC address information
type, i.e. FQDN or IP address, stored depends on the address type held by the
MS when initiating registration i.e. if the MS held an IP address, then that
IP-address shall be stored and if the MS held an FQDN, then that FQDN shall be
stored):
\- If the MS is in GERAN/UTRAN/E-UTRAN coverage and this was indicated in the
GA-RC REGISTER REQUEST by including a current GSM CGI, UTRAN cell identity
(i.e., LAI and Cell Identity which is defined in [40]), or E-UTRAN cell
identity (i.e., TAI and Cell Identity which is defined in [55]):
\- if the stored Serving GANC table does not contain the GSM CGI, UTRAN cell
identity, or E-UTRAN cell identity, add the GSM CGI, UTRAN cell identity or
E-UTRAN cell identity to the table with the information about the Serving
GANC: SEGW FQDN or IP-address, GANC FQDN or IP-address and the TCP port to be
used (if received in the message, otherwise the TCP port for Registration as
defined in sub-clause 12.2.1).
\- if the stored Serving GANC table contains the GSM CGI, UTRAN cell identity
or E-UTRAN cell identity, update the information about the Serving GANC for
this GSM CGI, UTRAN cell identity or E-UTRAN cell identity: SEGW FQDN or IP-
address, GANC FQDN or IP-address and the TCP port to be used, as described
above.
\- If the MS is not in GERAN/UTRAN/E-UTRAN coverage and this was indicated in
the GA-RC REGISTER REQUEST:
\- if the stored Serving GANC table does not contain the AP-ID, add the AP-ID
with the information about the Serving GANC: SEGW FQDN or IP-address, GANC
FQDN or IP-address and the TCP port to be used (if received in the message,
otherwise the TCP port for Registration as defined in sub-clause 12.2.1).
\- if the stored Serving GANC table contains the AP-ID, update the information
about the Serving GANC for this AP-ID: SEGW FQDN or IP-address, GANC FQDN or
IP-address and the TCP port to be used, as described above.
\- If the stored Serving GANC Table indicator is set to \"Do not store\", the
MS should not store the new registered serving GANC information in the stored
Serving GANC table but should still maintain the related serving GANC
information, if existing in the stored Serving GANC table.
#### 6.2.3.2 Registration redirected
When the MS receives GA-RC REGISTER REDIRECT message, it shall:
\- stop the timer TU3904,
\- Increment the Redirection counter,
\- release the TCP connection towards the GANC,
\- if timer TU3910 is running and MS is in GA-RC-REGISTERED state the MS shall
stop the timer TU3910,
\- if the GA-RC REGISTER REDIRECT was received from the Default GANC, the MS
shall;
\- store the received Serving GANC table indicator;
\- if the GA-RC REGISTER REDIRECT contains the GAN PLMN List information
element;
\- store the information received in the GAN PLMN List information element ,
\- pass the received list of PLMN identities to the GANC selection process;
\- release the secure connection towards SEGW of the Default GANC as defined
in sub-clause 4.5; and;
\- following PLMN selection by the GANC selection process, initiate the
registration procedure towards the GANC associated with the selected PLMN as
defined in sub-clause 6.2. Each GANC selected in this manner shall be
considered as a Serving GANC by the MS;
\- if the returned SEGW is the same as the one used for the connection towards
the previous GANC,
\- if the GA-RC-REGISTER REDIRECT was received from the Default GANC, then:
\- if the stored Default GANC-SEGW address information is in an IP address
format and the received GA-RC REGISTER REDIRECT message contains the Serving
GANC-SEGW IP address IE, and these two IP addresses match, the MS shall reuse
the secure connection;
\- or if the stored Default GANC-SEGW address information is a FQDN and the
received GA-RC REGISTER REDIRECT message contains the Serving GANC-SEGW FQDN
IE, and these identifiers match, the MS shall reuse the secure connection.
\- if the GA-RC-REGISTER REDIRECT was received from a Serving GANC, then:
\- if the MS held a Serving GANC-SEGW IP address for the current Serving GANC
(either in the Serving GANC store or received in a previous GA-RC REGISTER
REDIRECT) and the received GA-RC REGISTER REDIRECT contains the Serving GANC-
SEGW IP address IE, and these two IP addresses match, the MS shall reuse the
secure connection, or
\- if the MS held a Serving GANC-SEGW FQDN identifier (either in the Serving
GANC store or received in a previous GA-RC REGISTER REDIRECT) and the received
GA-RC REGISTER REDIRECT contains the Serving GANC-SEGW FQDN IE, and these
identifiers match, the MS shall reuse the secure connection
\- otherwise release the secure connection towards SEGW of the previous GANC
as defined in sub-clause 4.5
\- initiate the registration procedure towards the returned GANC as defined in
sub-clause 6.2.
#### 6.2.3.3 Registration rejected
When the MS receives GA-RC REGISTER REJECT message it shall:
\- stop the timer TU3904,
\- if the MS is in the process of GANC selection;
\- ignore the received Register Reject Cause Information Element; and;
\- proceed as defined in sub-clause 6.2.4.5.
\- else extract the Register Reject Cause information element and act as
following depending on the value of the Reject Cause IE:
\- \'Network Congestion\'\ \- create a random value between zero and the
received value in IE \'TU3907 Timer\' and\ \- add this value to the received
value in IE \'TU3907 Timer\', and use this as the new value for TU3907\ \-
start timer TU3907 according to the new calculated value and wait for it to
expire.
\- \'AP not allowed\'\ \- release the TCP connection established to the GANC,
if still established,\ \- release the secure connection towards the SEGW
associated with the GANC, as defined in sub-clause 4.5\ \- store the AP-ID in
the AP Black List and not initiate a new Register Request from this AP, until
the AP-ID is removed from the AP Black List i.e. as a result of power-cycle.
\- \'Location not allowed\'\ \- release the TCP connection established to the
GANC, if still established,\ \- release the secure connection towards the SEGW
associated with the GANC, as defined in sub-clause 4.5\ \- update the Location
Black List according to the received information elements Location Black List
indicator and Location Area Identification (i.e. the same as that included in
the GA-RC REGISTER REQUEST message) and not initiate a new Register Request
from the locations indicated by the updated Location Black List, until they
are removed from the Location Black List i.e. as a result of power-cycle.
\- \'IMSI not allowed\'\ \- release the TCP connection established to the
GANC, if still established.\ \- release the secure connection towards the SEGW
associated with the GANC, as defined in sub-clause 4.5\ \- not initiate a new
GAN Registration procedure until the next power-on.
\- \'Invalid GANC\' or \'Unspecified\'\ \- release the TCP connection
established to the GANC, if still established.\ \- release the secure
connection towards the SEGW associated with the GANC, as defined in sub-clause
4.5\ \- act as defined in sub-clause 6.2.4.5
\- \'Geo Location not known\'\ \- release the TCP connection established to
the GANC, if still established.\ \- release the secure connection towards the
SEGW associated with the GANC, as defined in sub-clause 4.5\ \- not retry
registration from this AP until the location is provided or until the next
power-on.
The MS shall also:
\- Update the stored Serving GANC table as follows if the received Reject
cause was not \'Network Congestion\' or \'Geo Location not known\':
\- If the MS is in GERAN/UTRAN/E-UTRAN coverage it shall remove information
related to the current GSM CGI, UTRAN cell identity or E-UTRAN cell identity,
if it exists in the table.
\- If the MS is not in GERAN/UTRAN/E-UTRAN coverage it shall remove
information related to the AP-ID, if exists in the table.
### 6.2.4 Abnormal cases
#### 6.2.4.1 TU3904 expiry
If timer TU3904 expires in the MS, the MS shall:
\- release the TCP connection towards the GANC,
\- release the secure connection towards SEGW of the GANC as defined in sub-
clause 4.5,
\- If GAN registration is unsuccessful after a number of attempts defined by
the MS parameter \"Up Register Max Retries\" (defined in sub-clause 12.2.3),
the MS shall act as defined in sub-clause 6.2.4.5.
\- Otherwise, if GAN Registration can be re-attempted according to the MS
parameter \"Up Register Max Retries\", start timer TU3905 and wait for it to
expire.
#### 6.2.4.2 Lower layer failure in the MS
Lower layer failure in the MS can be for example related to DNS, IPsec or TCP.
If any lower layer failure happens in the MS, the MS shall:
\- release the TCP connection towards the current GANC, if established,
\- Stop timer TU3904 if running,
\- release the secure connection towards SEGW of the current GANC, if
established, as defined in sub-clause 4.5, and
\- If registration is still unsuccessful after a number of attempts defined by
the MS parameter \"Up Connect Attempt Count\" (defined in sub-clause 12.2.3),
the MS shall act as defined in sub-clause 6.2.4.5.
\- otherwise, stop timer TU3907 if running and
\- start timer TU3905 and wait for it to expire.
#### 6.2.4.3 TU3905 expiry
If timer TU3905 has expired in the MS, the MS shall restart the Registration
procedure as defined in sub-clause 6.2.1.
#### 6.2.4.4 TU3907 expiry
If timer TU3907 expires in the MS, the MS shall:
\- If GAN registration is unsuccessful after a number of attempts defined by
the MS parameter \"Up Register Max Retries\" (defined in sub-clause 12.2.3),
the MS shall act as if a \"Lower layer failure in the MS\" has occurred as
defined in sub-clause 6.2.4.2
\- else, if the TCP connection to the GANC is still established,
\- send a GA-RC REGISTER REQUEST that includes information elements as
described in sub-clause 6.2.1 and
\- start timer TU3904
\- else, restart the GAN Registration procedure towards the GANC as defined in
sub-clause 6.2.1
#### 6.2.4.5 Registration Failure
The MS shall;
\- If the GANC selection is ongoing:
\- act on upper layer indications as follows;
\- If no more PLMNs/GANCs are available for GANC selection or the GANC
selection is finished unsuccessfully;
\- stop all ongoing registration procedures;
\- release the TCP connection towards the current GANC, if established,
\- release the secure connection towards SEGW of the current GANC, if
established, as defined in sub-clause 4.5
\- initiate registration towards the Default GANC as defined in sub-clause
6.2.1;
\- else if the GANC selection process indicates new PLMN/GANC selection:
\- initiate registration procedure towards the GANC associated with the
selected PLMN as defined in sub-clause 6.2.
\- else if the MS attempted the registration towards the Default GANC
\- delete the stored information about the Default GANC,
\- delete the contents of the stored Serving GANC table
\- Increment Redirection Counter
\- initiate Discovery Procedure as defined in sub-clause 5.3
\- else if the MS attempted the registration towards current GANC is a Serving
GANC
\- Update the stored Serving GANC table as defined in the end of sub-clause
6.2.3.3 (i.e. delete information about this Serving GANC in the table) and
\- Increment Redirection Counter
\- initiate Registration Procedure towards the Default GANC as defined in sub-
clause 6.2.1
#### 6.2.4.6 GAN mode selection related failures
If no GAN Mode Indicator IE is included in the GA-RC REGISTER ACCEPT message
or if the GAN Mode Indicator IE is included and indicates that the MS shall
operate in GAN A/Gb mode, but the MS does not support GAN A/Gb mode, then the
MS shall immediately initiate GAN deregistration per sub-clause 6.4.1 and then
proceed according to the registration reject procedures defined for the case
of \'Invalid GANC\' in sub-clause 6.2.3.3.
If the GAN Mode Indicator IE is included in the GA-RC REGISTER ACCEPT message
and indicates that the MS shall operate in GAN Iu mode, but the MS does not
support GAN Iu mode, then the MS shall immediately initiate GAN deregistration
per sub-clause 6.4.1 and then proceed according to the registration reject
procedures defined for the case of \'Invalid GANC\' in sub-clause 6.2.3.3.
## 6.3 Registration Update procedure
After the MS has successfully registered to a GANC, the MS shall update the
GANC as a result of the conditions described in sub-clause 6.3.1: This update
is performed using the Registration Update procedure.
The GANC may also use the Registration Update procedure towards the MS.
{width="4.0465277777777775in" height="2.2006944444444443in"}
Figure 6.3.1: Registration Update procedure initiated by the MS
Figure 6.3.2: Registration Update procedure initiated by the network
### 6.3.1 Register Update initiation by the MS
MS initiates this procedure when it has registered successfully to GANC and
any of the following occurs:
\- The MS acquires GERAN/UTRAN/E-UTRAN coverage for the first time after
reporting no coverage during its last GAN registration.
\- An MS registered for GAN Iu mode establishes a new UTRAN serving cell as a
result of Intra-RAT handover while in GERAN/UTRAN/E-UTRAN mode and the UARFCN
of the new UTRAN serving cell is different from the UARFCN indicated during
its last GAN Registration or GAN Registration Update.
\- An MS registered for GAN Iu mode establishes a new serving cell as a result
of Inter-RAT handover to UTRAN while in GERAN/UTRAN/E-UTRAN mode.
\- An MS registered for GAN Iu mode enters connected mode in a UTRAN cell
while in GERAN/UTRAN/E-UTRAN mode and the UARFCN of the serving UTRAN cell is
different from the UARFCN indicated during its last GAN Registration/GAN
Registration Update or a UARFCN was not provided during its last GAN
Registration/GAN Registration Update.
\- An MS operating in GERAN/UTRAN/E-UTRAN preferred mode and registered for
GAN Iu mode enters dedicated/Packet Transfer mode in a GERAN cell while in
GERAN/UTRAN/E-UTRAN mode and the GERAN serving cell is different from the one
indicated during its last GAN Registration/GAN Registration Update.
\- An MS operating in GERAN/UTRAN/E-UTRAN preferred mode and registered for
GAN A/Gb mode establishes a new GERAN serving cell as a result of Intra-
RAT/inter-RAT handover while in GERAN/UTRAN/E-UTRAN mode.
\- An MS operating in GERAN/UTRAN/E-UTRAN preferred mode and registered for
GAN A/Gb mode establishes a new UTRAN serving cell as a result of intra-
RAT/inter-RAT handover while in GERAN/UTRAN/E-UTRAN mode.
\- An MS operating in GERAN/UTRAN/E-UTRAN preferred mode and registered for
GAN A/Gb mode enters dedicated/Packet Transfer mode in a GERAN cell, or enters
connected mode in a UTRAN cell or enters connected mode in a E-UTRAN cell
while in GERAN/UTRAN/E-UTRAN mode and the GERAN/UTRAN/E-UTRAN serving cell is
different from the one indicated during its last GAN Registration/GAN
Registration Update.
\- Changes to the generic IP access network point of attachment (i.e. a new
radio link is established).
\- When the mobile station requires a change to the list of GAN services
previously requested within the **Required GAN Services** IE of a GAN
Registration.
The MS shall:
\- send a GA-RC REGISTER UPDATE UPLINK message to the GANC on the established
TCP connection and include the changed information in the message.
### 6.3.2 Register Update processing by the network
When receiving the GA-RC REGISTER UPDATE UPLINK message, the network may
either accept or reject the Registration Update. The network may also redirect
the MS to another GANC.
#### 6.3.2.1 Register Update Accepted
If the network accepts the Registration Update, no message is returned to the
MS.
#### 6.3.2.2 Register Update Rejected
If the network rejects the Registration Update, it shall send the GA-RC
DEREGISTER message to the MS. This message shall contain the Register Reject
Cause information element.
#### 6.3.2.3 Register Update results in redirection
If the network decides to redirect the MS to another GANC, it shall send the
GA-RC REGISTER REDIRECT message to the MS. This message shall contain valid
information about another GANC, so that the MS is able to initiate the
Registration procedure towards that GANC.
The GANC can send the GA-RC REGISTER REDIRECT message at any time, but it
shall not be sent to an MS in GA-CSR-DEDICATED or GA-PSR-ACTIVE state.
### 6.3.3 Register Update Response handling in the MS
#### 6.3.3.1 Register Update Rejected
When the MS receives the GA-RC DEREGISTER message, it shall act as defined in
sub-clause 6.4.4 \"Reception of GA-RC DEREGISTER by MS\".
#### 6.3.3.2 Register Update results in redirection
When the MS receives GA-RC REGISTER REDIRECT message, it shall act as defined
in sub-clause 6.2.3.2 \"Registration redirected\".
### 6.3.4 Register Update initiation by the network
The network may at any time send the GA-RC REGISTER UPDATE DOWNLINK message to
a MS that is registered. This could happen e.g. because of change in the GANC
System Information. The network may include all information in this message
(i.e. not necessarily only the changed information).
### 6.3.5 Register Update handling in the MS
When the MS receives GA-RC REGISTER UPDATE DOWNLINK message, it shall process
the received information elements as defined in sub-clause 6.2.3.1.
## 6.4 MS deregistration
The MS should attempt to perform deregistration procedure before leaving the
AP. Optionally, the network could also initiate deregistration of a MS.
Figure 6.4.1: Deregistration procedure initiated by the MS
Figure 6.4.2: Deregistration procedure initiated by the network
### 6.4.1 Deregistration initiated by the MS
When the MS is leaving or about to leave the GAN coverage and the MS has
successfully registered with a GANC, it should:
\- send the GA-RC DEREGISTER message (with Register Reject Cause =
Unspecified) using the currently established TCP-connection,
\- release the TCP connection towards the GANC,
\- release the secure connection towards the SEGW, as defined in sub-clause
4.5 and
\- release all resources related to GAN
### 6.4.2 Reception of GA-RC DEREGISTER by GANC
When the network receives the GA-RC DEREGISTER message, it shall release all
resources associated with the MS.
### 6.4.3 Deregistration initiated by the network
The GANC may at any time initiate the deregistration of a successfully
registered MS by sending the GA-RC DEREGISTER message to the MS. When the GA-
RC layer in the network has submitted the GA-RC DEREGISTER message to the TCP
layer, it may initiate release of its half of the bidirectional TCP
connection.
### 6.4.4 Reception of GA-RC DEREGISTER by MS
When the MS receives the GA-RC DEREGISTER message, it shall:
\- if the MS is in the process of PLMN selection;
\- ignore the received Register Reject Cause Information Element, and
\- proceed as defined in sub-clause 6.2.4.5.
\- else extract the Reject Cause information element and act as following
depending on the value of the Reject Cause IE:
\- \'Network Congestion\'
\- release all local GAN resources (e.g. MS is in active call over GAN)
\- release the TCP connection towards the current GANC and
\- release the secure connection towards the GANC-SEGW, as defined in sub-
clause 4.5
\- create a random value between zero and the received value in IE 'TU3907
Timer' and
\- add this value to the received value in IE 'TU3907 Timer', and use this as
the new value for TU3907
\- start timer TU3907 according to the new calculated value
\- \'AP not allowed\'
\- release the TCP connection established to the GANC, if still established,
\- release the secure connection towards the SEGW associated with the GANC, as
defined in sub-clause 4.5,
\- store the AP-ID in the AP Black List of and not initiate a new Register
Request from this AP, until the AP-ID is removed from the AP black list i.e.
as a result of power-cycle.
\- \'Location not allowed\'
\- release the TCP connection established to the GANC, if still established,
\- release the secure connection towards the SEGW associated with the GANC, as
defined in sub-clause 4.5,
\- update the Location Black List according to the received information
elements Location Black List indicator and Location Area Identification and
not initiate a new Register Request from that Location, until the Location is
removed from the Location Black List i.e. as a result of power-cycle.
\- \'IMSI not allowed\'
\- release the TCP connection established to the GANC, if still established.
\- release the secure connection towards the SEGW associated with the GANC as
defined in sub-clause 4.5,
\- not initiate a new Registration procedure until the next power-on.
\- \'Unspecified\'
\- release the TCP connection established to the GANC, if still established.
\- release the secure connection towards the SEGW associated with the GANC as
defined in sub-clause 4.5,
\- act as if a \"Lower layer failure in the MS\" has occurred as defined in
sub-clause 6.2.4.2
\- \'Invalid GANC\'
\- release the TCP connection established to the GANC, if still established.
\- release the secure connection towards the SEGW associated with the GANC as
defined in sub-clause 4.5,
\- act as defined in sub-clause 6.2.4.5 \"Registration Failure\"
\- \'Geo Location not known\'
\- release the TCP connection established to the GANC, if still established.
\- release the secure connection towards the SEGW associated with the GANC as
defined in sub-clause 4.5,
\- not retry registration from this AP until the location is provided or until
the next power-on.
The MS shall also,
\- Update the stored Serving GANC table as following if the received Reject
cause was not \'Network Congestion\' or \'Geo Location not known\'
\- If the MS is in GERAN/UTRAN/E-UTRAN coverage
\- Remove information related to the current GSM CGI, UTRAN cell identity or
E-UTRAN cell identity, if exists in the table
\- If the MS is not in GERAN/UTRAN/E-UTRAN coverage
\- Remove information related to the AP-ID, if exists in the table.
## 6.5 Keep alive mechanism and TU3906 handling
When the MS receives the GA-RC REGISTER ACCEPT message, it shall initiate the
GA-RC Keep Alive -mechanism by starting timer TU3906 using the TU3906 Timer
value received in that message.
When timer TU3906 expires in the MS, the MS shall send the GA-RC KEEP ALIVE
-message to the GANC and start timer TU3906.
If the MS releases the TCP connection (e.g. because of receiving GA-RC
REGISTER REDIRECT, GA-RC REGISTER REJECT and GA-RC DEREGISTER message), then
it shall stop timer TU3906.
Figure 6.5.1: Keep Alive procedure
If the MS detects, that it is not able to send the GA-RC KEEP ALIVE message to
the network due to lower layer failure, it shall act according to sub-clause
9.5.
## 6.6 MS Initiated Synchronization after TCP connection reestablishment
When MS receives TCP RST after TCP connection failure, it shall try to re-
establish the signalling connection using GA-RC Synchronization procedure. The
following message flow depicts the messages associated with this procedure:
Figure 6.6.1 MS initiated synchronization procedure
### 6.6.1 Initiation of the Synchronization Procedure by the MS
When MS receives TCP RST indicating a TCP connection failure, it shall attempt
to re-establish TCP connection once. After successfully re-establishing TCP
connection, the MS shall send GA-RC SYNCHRONIZATION INFORMATION to the GANC to
synchronize the state information. If TCP connection re-establishment is
unsuccessful, the MS shall release the related local GA-CSR and GA-PSR
resources (if the MS is operating in GAN A/Gb mode) or GA-RRC resources (if
the MS is operating in GAN Iu mode), and continue as per section 9.5 as if a
TCP failure other than TCP RST has occurred.
### 6.6.2 Processing of the Synchronization Information message by the GANC
Upon receiving the GA-RC SYNCHRONIZATION INFORMATION message from the MS, the
GANC updates the MS state information as specified in the request.
Moreover, the GANC should verify that the binding (IMSI, inner IP address) as
received in the GA-RC SYNCHRONIZATION INFORMATION is the same as the one that
the MS used as identity for authentication to the GANC-SEGW.
## 6.7 Transmission of Cell Broadcast Information
If the GANC has previously received the indication that the mobile station
requires to receives the CBS, the GANC may pass the GA-RC CELL BROADCAST INFO
message to a mobile station including one or more pages of Cell Broadcast
messages.
Figure 6.7.1: Transmission of Cell Broadcast Information by the network
# 7 GA-CSR elementary procedures
## 7.1 GA-CSR Connection establishment
The GA-CSR connection is a logical connection between the MS and the GANC. It
is established when the upper layers in the MS request GA-CSR to enter
dedicated mode. The MS initiates GA-CSR connection establishment by sending
the GA-CSR REQUEST message to the network. When a successful response is
received from the network, GA-CSR replies to the upper layer that it has
entered dedicated mode. The upper layers have then the possibility to request
transmission of messages to the network. These messages are sent to the
network using GA-CSR UPLINK DIRECT TRANSFER messages as defined in sub-clause
7.2.1.
Note that in the case of a network-initiated CS session, the GA-CSR connection
is implicitly established when the MS responds to the GA-CSR PAGING REQUEST
message from the GANC with the GA-CSR PAGING RESPONSE message (see sub-clause
7.3).
Also, in the case of CS handover from GERAN or UTRAN to GAN A/Gb mode, the GA-
CSR connection is implicitly established when the MS sends the GA-CSR HANDOVER
ACCESS message to the GANC (see sub-clause 7.7).
Two service access points are defined which are discriminated by their Service
Access Point Identifiers (SAPI):
SAPI 0: supports the transfer of signalling information including user-user
information;
SAPI 3: supports the transfer of user short messages.
Figure 7.1.1 Initiation of GA-CSR connection, successful case
Figure 7.1.2 Initiation of GA-CSR connection, failure case
### 7.1.1 Initiation of GA-CSR connection establishment by the MS
The MS initiates the establishment of the GA-CSR connection when the upper
layers request the GA-CSR to enter dedicated state.
Before initiation of GA-CSR connection establishment request, the MS shall
check for access permission based on Access Control Class bits returned within
GA-RC REGISTER ACCEPT message as defined in [12].
If it is allowed for the MS to access the network, it shall send a GA-CSR
REQUEST message to the GANC on the established TCP connection and include the
Establishment Cause IE and start timer TU3908
### 7.1.2 Reception of GA-CSR REQUEST by GANC
When GANC receives GA-CSR REQUEST message, the GANC may either accept or
reject the GA-CSR connection establishment request.
#### 7.1.2.1 GA-CSR connection establishment request accepted
If the GANC accepts the GA-CSR connection establishment request, it shall send
the GA-CSR REQUEST ACCEPT message to the MS.
#### 7.1.2.2 GA-CSR connection establishment request rejected
If the GANC rejects the GA-CSR connection establishment request, it shall send
the GA-CSR REQUEST REJECT message to the MS.
### 7.1.3 GA-CSR connection establishment response handling in the MS
#### 7.1.3.1 GA-CSR connection establishment request accepted
When the MS receives the GA-CSR REQUEST ACCEPT message, it shall:
\- if timer TU3908 is active:
\- stop timer TU3908,
\- move into GA-CSR-DEDICATED state,
\- indicate to upper layers that GA-CSR has entered dedicated state and
\- send the initial GA-CSR UPLINK DIRECT TRANSFER message to the network
\- if timer TU3908 is not active:
\- ignore the GA-CSR REQUEST ACCEPT message and
\- continue with any ongoing procedure as if the GA-CSR REQUEST ACCEPT message
was not received
#### 7.1.3.2 GA-CSR connection establishment request rejected
When the MS receives the GA-CSR REQUEST REJECT message, it shall:
\- if timer TU3908 is active:
\- stop timer TU3908,
\- remain in GA-CSR-IDLE state and
\- indicate to upper layers that GA-CSR was not able to enter dedicated state
\- if timer TU3908 is not active:
\- ignore the GA-CSR REQUEST REJECT message and
\- continue with any ongoing procedure as if the GA-CSR REQUEST REJECT message
was not received
### 7.1.4 Failure cases
#### 7.1.4.1 Timer TU3908 expiry
If timer TU3908 expires in the MS, the MS shall remain in GA-CSR-IDLE state
and indicate to upper layers that GA-CSR was not able to enter dedicated state
## 7.2 Upper layer message transmission
The GA-CSR UPLINK DIRECT TRANSFER message is used for the transfer of upper
layer messages from the MS to the GANC while the GA-CSR DOWNLINK DIRECT
TRANSFER message is used for the transfer of upper layer messages from the
GANC to the MS. The first GA-CSR UPLINK DIRECT TRANSFER message received by
the GANC triggers the establishment of the signalling connection to the CN for
that MS.
### 7.2.1 Upper layer message forwarding by the MS
Figure 7.2.1.1 Uplink Direct Transfer, normal flow
The MS shall initiate the Uplink Direct Transfer procedure in GA-CSR-DEDICATED
state when the upper layers request a transfer of a non-access stratum
message.
The MS shall include the contents of the received upper layer message in the
IE \"L3 Message\" and set the SAPI used in the IE \"SAPI ID\".
### 7.2.2 Reception of GA-CSR UPLINK DIRECT TRANSFER by GANC
When the GANC receives GA-CSR UPLINK DIRECT TRANSFER message from an MS in GA-
CSR-DEDICATED state for which there is no signalling connection to the core
network (i.e. this is the first GA-CSR UPLINK DIRECT TRANSFER after GA-CSR
Connection establishment) the GANC should trigger the normal A-interface
procedures towards the Core network to establish a signalling connection. GANC
should transfer the contents of the IE \"L3 Message\" to the CN. The GANC
should transfer the contents of the IE \"SAPI ID\" to the CN.
### 7.2.3 Upper layer message forwarding by the GANC
Figure 7.2.3.1 Downlink Direct Transfer, normal flow
The Downlink Direct Transfer procedure is initiated by the GANC, when the GANC
receives a request from the upper layers to transfer a non-access stratum
message, after the establishment of the GA-CSR connection to the MS.
On receiving a request from the upper layers the GANC should include the
contents of the upper layer message in the IE \"L3 Message\".
### 7.2.4 Reception of GA-CSR DOWNLINK DIRECT TRANSFER by the MS
When the MS receives the GA-CSR DOWNLINK DIRECT TRANSFER message it shall
forward the contents of the message to the upper layers.
#### 7.2.4.1 Invalid GA-CSR DOWNLINK DIRECT TRANSFER
If the MS receives a GA-CSR DOWNLINK DIRECT TRANSFER message and MS is not in
GA-CSR-DEDICATED state, the MS shall:
\- ignore the contents of the GA-CSR DOWNLINK DIRECT TRANSFER message;
\- transmit a GA-CSR STATUS message as follows:
\- set the IE \"RR Cause\" to \"Message type not compatible with protocol
state\"
\- include the received message contents in the IE \"PDU in error\"
\- continue with any ongoing procedure and act as if the GA-CSR DOWNLINK
DIRECT TRANSFER message was not received.
## 7.3 Paging for CS domain
Figure 7.3.1 Paging, normal flow
### 7.3.1 Initiation of Paging
The GANC initiates this procedure when it receives a PAGING REQUEST message
over the A-interface or a Paging CS message over the Gb-interface. The MS to
be paged is identified by the identity received in the request from the CN. If
the request includes the TMSI then the GANC should include the TMSI as the
mobile identity else it should include the IMSI received in the request.
### 7.3.2 Reception of GA-CSR PAGING REQUEST by the MS
If the mobile identity in the GA-CSR PAGING REQUEST message matches any of the
valid identities of the MS and the MS is in GA-CSR-IDLE state, the MS shall:
\- if timer TU3908 is not active and access to the network is allowed;
\- send a GA-CSR PAGING RESPONSE message to the GANC and
\- enter GA-CSR-DEDICATED state.
\- if timer TU3908 is active;
\- discard the received GA-CSR PAGING REQUEST message.
### 7.3.3 Reception of GA-CSR PAGING RESPONSE by the GANC
On receiving the GA-CSR PAGING RESPONSE message the GANC should establish the
signalling connection to the MSC and forward the contents of the GA-CSR PAGING
RESPONSE message to the MSC.
### 7.3.4 Abnormal Cases
If the MS receives a GA-CSR PAGING REQUEST message and MS is in GA-CSR-
DEDICATED state or GA-RC-REGISTERED state, the MS shall:
\- ignore the GA-CSR PAGING REQUEST message
\- continue with any ongoing procedure as if the GA-CSR PAGING REQUEST was not
received.
If the MS receives a GA-CSR PAGING REQUEST and the mobile identity included in
the message does not match any of the valid identities assigned to the MS, the
MS shall:
\- ignore the GA-CSR PAGING REQUEST message
\- continue with any ongoing procedure as if the GA-CSR PAGING REQUEST message
was not received.
## 7.4 Traffic Channel assignment
Figure 7.4.1 Channel Activation, successful case
### 7.4.1 Initiation of Channel Assignment
The GANC configures a traffic channel by transmitting the GA-CSR ACTIVATE
CHANNEL message on receiving an Assignment Request from the MSC. The GA-CSR
ACTIVATE CHANNEL message can be sent to the MS only in GA-CSR-DEDICATED state.
The Channel Assignment procedure is always activated by the network.
### 7.4.2 Reception of GA-CSR ACTIVATE CHANNEL by MS
The MS shall act on the received GA-CSR ACTIVATE CHANNEL message when in GA-
CSR-DEDICATED state as follows:
\- Code and decode the CS payload samples according to the IE \"Channel
Mode\";
\- If the IE \"Bandwidth-efficient Mode Indicator\" is received, use the RFC
4867 [48] bandwidth-efficient payload format to code and decode the CS payload
samples; otherwise, use the RFC 4867 [48] octet-aligned payload format.
\- Use the value indicated by the IE \"Sample Size\" as the minimum sampling
size for the coding and decoding of the CS payload samples, if the MS is not
able to use the indicated value. If AMR is used with FEC by sending redundant
frames, the sample size is defined as the size of the new speech sample in
each RTP packet, not including any redundant speech sample.
\- Configure the uplink CS payload stream to be transmitted to the UDP port
identified by the IE \"UDP Port\";
\- Configure the uplink CS payload stream to be transmitted to the IP address
identified by the IE \"IP address\";
\- If received, use the configuration included in the IE \'Multi-rate
Configuration\' for the CS payload stream;
\- If received, use the configuration included in the IE \"RTP Redundancy
Configuration\" for the CS payload stream. The redundancy policy is defined
for each of the AMR modes to use. The level of redundancy can span from no
redundancy to double redundancy. In the same active codec set, a lower codec
mode shall not be associated with a lower redundancy level then a higher codec
mode. For example, the highest mode in the set is used with no redundancy, the
next lower with single redundancy and rest of the modes with double
redundancy;
\- If received, use the Payload Type included in the IE \'Payload Type\' for
the PT field in the RTP header for the CS downlink and uplink payload streams;
On successful configuration of the channel, the MS shall:
\- Start timer TU3911.
\- Transmit a GA-CSR ACTIVATE CHANNEL ACK message and include the UDP port
number in the IE \'UDP Port\" for the downlink CS payload stream to be used by
the GANC.
\- Include the selected RTP sample size, to be used uplink and downlink, in
the IE Sample Size.
\- if the IE \'RTCP UDP Port\' was received in the GA-CSR ACTIVATE CHANNEL
message and the MS is capable of supporting RTCP, activate the uplink RTCP
stream and include the IE \'RTCP UDP Port\' for the downlink RTCP stream to be
used by the GANC.
### 7.4.3 Reception of GA-CSR ACTIVATE CHANNEL ACK by GANC
If the call uses a TDM-based A-interface: The GANC shall configure itself for
transmission of RTP packets to the MS to the indicated UDP port and RTCP
packets to the MS, if the IE \'RTCP UDP Port\' is included by the MS, and
transmit a GA-CSR ACTIVATE CHANNEL COMPLETE message to the MS.
If the call uses a TDM-based A-interface: To enable downlink quality
measurements in the MS, the GANC shall send at least one RTP frame each 480
ms. During periods of discontinuous transmission (DTX), each RTP frame
transmitted by the GANC shall bear a format in the AMR payload Table of
Contents that either (a) omits all NO_DATA indications and contains only the
next AMR speech or SID frame that is available, or (b) includes a single
NO_DATA frame should no AMR speech or SID frame become available for 480 ms.
The RTP timestamp shall indicate the time of that speech or SID or NO_DATA
frame. See Section A.1.2 of Annex A for examples of the RFC 4867 [48] octet-
aligned payload format.
If the call uses a IP-based A-interface: The GANC sends a GA-CSR ACTIVATE
CHANNEL COMPLETE message to the UE.
### 7.4.4 Reception of GA-CSR ACTIVATE CHANNEL COMPLETE by MS
The RTP channel is available for use by upper layers. To enable uplink quality
measurements in the GANC, the MS shall send at least one RTP frame each 480
ms. During periods of discontinuous transmission (DTX), each RTP frame
transmitted by the MS shall bear a format in the AMR payload Table of Contents
that either (a) omits all NO_DATA indications and contains only the next AMR
speech or SID frame that is available, or (b) includes a single NO_DATA frame
should no AMR speech or SID frame become available for 480 ms. The RTP
timestamp shall indicate the time of that speech or SID or NO_DATA frame. See
Section A.1.2 of Annex A for examples of the RFC 4867 [48] octet-aligned
payload format.
Stop timer TU3911.
### 7.4.5 Failure to establish channel by MS
If the MS fails to establish the channel indicated in the GA-CSR ACTIVATE
CHANNEL message or timer TU3911 expires the MS shall:
\- transmit a GA-CSR ACTIVATE CHANNEL FAILURE message;
\- act as if the GA-CSR ACTIVATE CHANNEL message was not received.
## 7.5 Release of GA-CSR
### 7.5.1 Initiation of GA-CSR connection release by MS
If the MS needs to release the GA-CSR connection and signalling connection to
the core network, it shall send the GA-CSR CLEAR REQUEST message to the GANC
and start timer TU3909. The MS shall include the \'RR Cause\' IE.
Figure 7.5.1.1 Initiation of GA-CSR connection release by MS
### 7.5.2 Reception of GA-CSR CLEAR REQUEST by GANC
The GANC will request core network to initiate the procedure to release of
dedicated resources.
### 7.5.3 Initiation of GA-CSR connection release by GANC
Figure 7.5.3.1 Initiation of GA-CSR connection release by network
The GANC initiates this procedure to command the MS to release the GA-CSR and
any traffic channel resources and instruct the MS to leave GA-CSR-DEDICATED
state.
The GA-CSR RELEASE message will include an RR cause indication as follows:
#0: normal release, e.g. at the end of a call.
#1: unspecified abnormal release.
#65: if e.g. a handover procedure is stopped because the call has been
cleared.
### 7.5.4 Reception of GA-CSR RELEASE by MS
When the MS receives the GA-CSR RELEASE message, it shall:
\- transmit a GA-CSR RELEASE COMPLETE message to the GANC and release all GA-
CSR and any traffic channel resources,
\- stop timer TU3909 (if running), and
\- enter GA-CSR-IDLE state.
A mobile station not supporting \"GPRS\" shall consider the IE \"GPRS
Resumption\" as unknown in the GA-CSR RELEASE message and perform the GA-CSR
Release procedure as normal.
For a MS supporting the \"GPRS\" option:
\- if the GA-CSR RELEASE message includes the IE \"GPRS Resumption\":
\- if the GPRS Resumption information element indicates that the network has
resumed GPRS services, the GA-CSR sub-layer of the mobile station shall
indicate a GA-CSR GPRS resumption complete to the MM sub-layer.
\- if the GPRS Resumption information element indicates that the network has
not successfully resumed GPRS services, the GA-CSR sub-layer of the mobile
station shall indicate a GPRS resumption failure to the MM sub-layer.
\- if the mobile station has performed the GPRS suspension procedure (sub-
clause 8.10) and the GPRS Resumption information element is not included in
the message, the GA-CSR sub-layer of the mobile station shall indicate a GPRS
resumption failure to the MM sub-layer.
\- if the mobile station has not performed the GPRS suspension procedure and
the GPRS Resumption information element is not included in the message, the
mobile station shall perform the channel release procedure as normal
### 7.5.5 Failure cases
#### 7.5.5.1 Timer TU3909 expiry
If timer TU3909 expires in the MS, the MS shall release all GA-CSR and any
traffic channel resources and enter GA-CSR-IDLE state.
## 7.6 Classmark Indication
### 7.6.1 Initiation of classmark interrogation by GANC
Figure 7.6.1.1 Classmark change
The GANC initiates the classmark interrogation procedure by transmitting the
GA-CSR CLASSMARK ENQUIRY message to the MS when it desires more information
about the MS\'s capabilities. The GA-CSR CLASSMARK ENQUIRY message can be sent
to a MS only in GA-CSR-DEDICATED state.
### 7.6.2 Transmission of classmark information by MS
On receipt of the GA-CSR CLASSMARK ENQUIRY message or in case of \"early
classmark sending\" procedure based on the system information indication
received in GA-RC REGISTER ACCEPT message, the mobile station sends a GA-CSR
CLASSMARK CHANGE message to the GANC.
The MS shall include the IE \"Mobile Classmark 2\" in the GA-CSR CLASSMARK
CHANGE message. It may also contain a IE \"Mobile Classmark 3\" depending on
the MS capabilities.
In addition a MS supporting UTRAN sends a GA-CSR UTRAN CLASSMARK CHANGE
message.
The Classmark Enquiry Mask information element in the GA-CSR CLASSMARK ENQUIRY
message indicates the type of request. If the Classmark Enquiry Mask
information element is not included in the GA-CSR CLASSMARK ENQUIRY message,
this indicates a request for GA-CSR CLASSMARK CHANGE message.
In the \"early classmark sending\" case the GA-CSR UTRAN CLASSMARK CHANGE
message shall not be sent by the MS if prohibited by the 3G Early Classmark
Sending Restriction received as system information in GA-RC REGISTER ACCEPT
message.
The GA-CSR UTRAN CLASSMARK CHANGE and GA-CSR CLASSMARK CHANGE message shall
only be sent by a MS in GA-CSR-DEDICATED state
When an GA-CSR CLASSMARK CHANGE message and an GA-CSR UTRAN CLASSMARK CHANGE
message are to be sent, the GA-CSR CLASSMARK CHANGE message shall be sent
first.
## 7.7 CS handover to GAN A/Gb mode
Figure 7.7.1: CS handover to GAN A/Gb mode, successful case 7.7.1 Initiation
The procedure is initiated when the source radio access technology (e.g.
GERAN) orders the MS to make CS handover to GAN A/Gb mode.
The procedure is applicable in GA-RC-REGISTERED state provided the conditions
described in Annex C.1: \"(Source-RAT) Measurement Report for Handover and
Cell Change Order to GAN A/Gb mode\" are met.
The handover order in the source radio access technology mode is sent via the
(RR) HANDOVER COMMAND message. If the ARFCN and BSIC parameters included in
the Cell Description IE in the (RR) HANDOVER COMMAND message (specified in
[12]) match those of the GAN cell, the MS shall:
\- send a GA-CSR HANDOVER ACCESS message to the network including the complete
(RR) HANDOVER COMMAND message in the _Handover To GAN Command_ IE and enter
GA-CSR-DEDICATED state;
NOTE: sending the complete (RR) HANDOVER COMMAND message in the _Handover To
GAN Command_ IE instead of the _Handover Reference_ IE allows for more than
256 concurrent handover requests
\- if non-signalling mode is indicated in _Channel Mode_ IE, the MS shall:
\- start timer TU3920;
\- otherwise, the MS shall:
\- immediately send a GA-CSR HANDOVER COMPLETE message to the network;
\- switch to GAN A/Gb mode; i.e. attach the GA-CSR entity to the RR-SAP.
### 7.7.2 Reception of GA-CSR HANDOVER ACCESS by the GANC
If non-signalling mode is indicated in the _Channel Mode_ IE, the GANC shall
initiate traffic channel assignment as specified in sub-clause 7.4.
### 7.7.3 Successful completion of the CS handover to GAN A/Gb mode
If the traffic channel assignment was successfully completed within timer
TU3920, the MS shall:
\- stop timer TU3920;
\- send a GA-CSR HANDOVER COMPLETE message to the network;
\- switch to GAN A/Gb mode; i.e. attach the GA-CSR entity to the RR-SAP.
In addition the MS shall send upper layer messages for which LAPDm has not yet
received acknowledgement from the network to the network using the GA-CSR
entity.
### 7.7.4 Reception of GA-CSR HANDOVER COMPLETE by the GANC
The GANC should indicate handover detection and completion to CN.
### 7.7.5 MS fails to complete requested handover
If the traffic channel assignment procedure fails or the timer TU3920 expires
before traffic channel assignment is completed, the MS shall:
\- terminate the procedure including release of the associated GA-CSR
resources;
\- resume the connection in the source radio access technology used before the
handover;
\- indicate the failure to the source radio access technology.
## 7.8 CS handover from GAN A/Gb mode
Figure 7.8.1: Handover from GAN, successful case
Figure 7.8.2: Handover from GAN, failure case
### 7.8.1 Initiation
The purpose of this procedure is to transfer, upon request from the MS (and
under the control of the GAN), a connection between MS and GAN to another
radio access technology (e.g. GERAN).
The procedure is applicable in GA-CSR-DEDICATED state.
The procedure may be initiated by the MS based on:
\- local measurements of GAN coverage signal quality;
\- reception of a GA-CSR UPLINK QUALITY INDICATION message indicating poor
uplink quality in the _UL Quality Indication_ IE; If the UL Quality Indication
IE indicates \"Network problem\" a handover out to GERAN or UTRAN should be
attempted. In case the UL Quality Indication information element shows \"Radio
problem\" or \"Undetermined problem\" a search for a new access point should
be done before the handover out is initiated;
\- reception of RTCP packets indicating poor uplink quality;
\- excessive loss or delay in the received RTP packets
When the MS decides to trigger the handover from GAN A/Gb mode, it shall:
\- send a GA-CSR HANDOVER INFORMATION message to the network including a list
of candidate/ target cell identifiers ranked in order of preference which is
the most recent list available from the other radio access technology (e.g.
GSM RR) and including the received signal strength for each identified GERAN
or UTRAN cell. The MS may include GERAN cells, UTRAN cells or both, as
permitted by the Handover Reporting Control IE (see sub-clause 11.2.113). If
no Handover Reporting Control IE was included in the most recently received
GA-RC REGISTER ACCEPT message, there is no restriction on the cells that may
be listed.
### 7.8.2 Reception of GA-CSR HANDOVER INFORMATION by the GANC
The GANC should signal the need for handover to the CN.
If the CN grants the handover request, GANC should send a GA-CSR HANDOVER
COMMAND message to the MS.
The GA-CSR HANDOVER COMMAND message should only indicate a target cell which
was reported by the MS in the GA-CSR HANDOVER INFORMATION message.
### 7.8.3 Reception of GA-CSR HANDOVER COMMAND by the MS
The MS shall:
\- suspend all NAS layer signalling transmissions;
\- start the connection establishment to the target radio access technology
(e.g. GERAN) by using the contents of the _Handover From GAN Command_ IE. This
message carries information about the candidate/ target cell identifier and
radio parameters relevant for the target radio access technology;
A MS that is simultaneously operating in GPRS and CS modes over GAN shall
follow the procedure as outlined in 3GPP TS 43.055 when it switches to target
cell.
NOTE: The requirements concerning the establishment of the radio connection
towards the target radio access technology (e.g. GERAN) and the signalling
procedure are outside of the scope of this specification.
### 7.8.4 Successful completion of the CS handover from GAN A/Gb mode
Upon successfully completing the CS handover from GAN A/Gb mode, the GANC
should:
\- release all radio resources associated with the GAN connection.
Upon successfully completing the CS handover, the MS shall:
\- switch to target radio access technology (e.g. GERAN) mode i.e. detach the
GA-RR entity from the RR-SAP;
\- enter GA-RC-REGISTERED state.
NOTE: The release of the GAN radio resources is initiated from the target RAT.
The MS may deregister from the GANC (as defined in sub-clause 6.4) after
successfully completing the handover. If the MS chooses to deregister from the
GANC, it may do so either immediately after successfully completing the
handover or after sending the GA-CSR RELEASE COMPLETE message to the GANC in
response to the GA-CSR RELEASE message from the GANC.
### 7.8.5 MS fails to complete requested handover
If the MS does not succeed in establishing a connection to the target radio
access technology, the MS shall:
\- revert back to the GAN configuration;
\- return a GA-CSR HANDOVER FAILURE message and resume normal operation as if
the GA-CSR HANDOVER COMMAND message has not been received. The cause shall be
set as specified in 3GPP TS 44.018.
### 7.8.6 Reception of GA-CSR HANDOVER FAILURE by the GANC
The GANC may initiate the release of resources in the target radio access
technology.
### 7.8.7 Abnormal Cases
If the GA-CSR HANDOVER COMMAND message instructs the MS:
\- to perform a non-supported scenario, or
\- to use a non-supported configuration,
the MS shall return a GA-CSR HANDOVER FAILURE message with cause as defined in
3GPP TS 44.018 and resume normal operation as if the GA-CSR HANDOVER COMMAND
message has not been received.
## 7.9 Ciphering configuration procedure
The ciphering configuration procedure is used by the network to set the
ciphering mode, i.e. whether or not the transmission is ciphered, and if so
which algorithm to use. This information is not used when the GA-CSR-layer is
the serving entity in the MS, but shall be stored in the MS for possible
future use after a handover from GAN during the same upper layer transaction
(i.e. RR-layer becomes the serving entity during this upper layer
transaction).
This procedure applies only for a MS in GA-CSR-DEDICATED state.
The procedure shall only be used to change from \"not ciphered\" mode to
\"ciphered\" mode, or vice-versa, or to pass a GA-CSR CIPHERING MODE COMMAND
message to the mobile station while remaining in the \"not ciphered\" mode.
The ciphering mode setting procedure is always triggered by the network.
Figure 7.9.1 Ciphering configuration
### 7.9.1 Ciphering configuration initiation
The network initiates the ciphering mode setting procedure by sending a GA-CSR
CIPHERING MODE COMMAND message to the mobile station, indicating whether
ciphering shall be used or not, and if yes which algorithm to use.
Additionally, the network may, by the use of the cipher response information
element, request the mobile station to include its IMEISV in the GA-CSR
CIPHERING MODE COMPLETE message.
### 7.9.2 Ciphering configuration completion
Whenever the mobile station receives a valid GA-CSR CIPHERING MODE COMMAND
message, it shall, if a SIM is present and considered valid and the ciphering
key sequence number stored on the SIM indicates that a ciphering key is
available, save information about the ciphering key to use if the MS is later
performing Handover from GAN. A valid GA-CSR CIPHERING MODE COMMAND message is
defined to be one of the following:
\- one that indicates \"start ciphering\" and is received by the mobile
station in the \"not ciphered\" mode;
\- one that indicates \"no ciphering\" and is received by the MS in the \"not
ciphered\" mode; or
\- one that indicates \"no ciphering\" and is received by the mobile station
in the \"ciphered\" mode.
Other GA-CSR CIPHERING MODE COMMAND messages shall be regarded as erroneous,
and a GA-CSR STATUS message with cause \"Protocol error unspecified\" shall be
returned, and no further action taken.
The MS shall also calculate a MAC (Message Authentication Code). The MAC shall
be calculated over the following data:
RAND \| IMSI
using \"HMAC-SHA1-96\" algorithm, as specified in [24] with Kc as
authentication key.
In the formulas above, the \"\|\" character denotes concatenation. RAND is the
16-octet random number received from the GANC in the GA-CSR CIPHERING MODE
COMMAND message. IMSI is the MS IMSI, in the same format as defined for the
Mobile Identity IE as defined in [8] i.e. as a variable-length sequence of
digits in BCD format (e.g. the IMSI \"123456789098765\" is encoded as the
following octets (in hexadecimal): \"21 43 65 87 09 89 67 F5\"). Network byte
order is used.
The Kc key is the Kc that has been derived during the last authentication. The
length of the MAC is 12 octets.
When the appropriate action on the GA-CSR CIPHERING MODE COMMAND message has
been taken, the mobile station sends back a GA-CSR CIPHERING MODE COMPLETE
message. If the \"cipher response\" field of the cipher response information
element in the GA-CSR CIPHERING MODE COMMAND message specified \"IMEISV must
be included\" the mobile station shall include its IMEISV in the GA-CSR
CIPHERING MODE COMPLETE message.
## 7.10 Channel mode modify procedure
In dedicated mode, the GANC can request a modification of the channel mode,
multi-rate configuration, RTP redundancy configuration, sample size, GANC IP
address, GANC RTP UDP port and GANC RTCP UDP port used for an active traffic
channel.
The channel mode modify procedure allows the network to request the mobile
station to modify configuration used for an active channel. The channel mode
covers the coding, decoding and transcoding mode as well as the redundancy
policy used on the active channel.
This procedure is always initiated by the network.
Figure 7.10.1 Channel mode modify
### 7.10.1 Normal channel mode modify procedure
#### 7.10.1.1 Initiation of the channel mode modify procedure
The network initiates the procedure by sending a GA-CSR CHANNEL MODE MODIFY
message to the mobile station.
#### 7.10.1.2 Completion of channel mode modify procedure
When the MS has received the GA-CSR CHANNEL MODE MODIFY message, the mobile
station modifies the configuration, sets the mode and/or the RTP redundancy
configuration for the active channel and then replies by a GA-CSR CHANNEL MODE
MODIFY ACKNOWLEDGE message indicating the ordered channel mode.
This applies whether the mode and/or redundancy policy commanded by the GA-CSR
CHANNEL MODE MODIFY message is different from the one used by the mobile
station or whether it is already in use.
When the MS has sent the GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message, it
shall start transmit RTP packets with the new size. Until RTP packets with the
new sample size have been received, the MS should handle the reception of RTP
packets with the old sample size. The MS shall also use changed configurations
for all other parameters (channel mode, multi-rate configuration, RTP
redundancy configuration, etc.) in uplink RTP frames immediately after sending
GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message. In the downlink direction, MS
shall be able to receive RTP packets with the old parameters, until the first
RTP packet using the new parameters is received.
The GANC shall only start using the new configuration in downlink RTP frames
as of receiving GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message. In the uplink
direction, the GANC shall be able to receive RTP packets with the old
parameters, until the first RTP packet using the new parameters is received.
#### 7.10.1.3 Abnormal cases
If the GA-CSR CHANNEL MODE MODIFY message includes IE \"RTP Redundancy
Configuration\" and MS has indicated that it does not support RTP Redundancy
through the GAN Classmark, it shall ignore the IE \"RTP Redundancy
Configuration\".
If the mobile station does not support the indicated channel mode or sample
size modifications, it shall retain the old mode and return the used
configuration in the GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message.
# 8 GA-PSR elementary procedures
## 8.1 GA-PSR Transport Channel (GA-PSR TC) Overview
The GA-PSR Transport Channel is defined as a UDP based point to point GA-PSR
connection between the MS and the GANC utilized for GPRS user data transfer.
The life-time of the GA-PSR TC is controlled by the TU4001 timer. The duration
of the TU4001 timer is provided to the MS as one of the GAN system parameters
in the GA-RC REGISTER ACCEPT message. In the same way as other GAN system
parameters, the GANC can update the TU4001 timer using the standard mechanism
for GAN system parameters update. The MS shall store the TU4001 timer for
future use and updates the value when requested.
## 8.2 MS Initiated GA-PSR Transport Channel (GA-PSR TC) Activation
The MS initiated GA-PSR TC activation is triggered by the uplink GPRS user
data request when the GA-PSR is in the GA-PSR-STANDBY state. The following
message flow depicts the messages and timers involved in this procedure:
Figure 8.2.1: MS initiated GA-PSR TC Activation
### 8.2.1 Initiation of the GA-PSR TC Activation by the MS
Upon receiving the uplink user data transfer request from the LLC for LLC SAPI
3, 5, 9 or 11 and while the MS GA-PSR is in the GA-PSR-STANDBY state, the MS
shall,
\- send a GA-PSR-ACTIVATE-UTC-REQ message,
\- start timer TU4002,
\- set the uplink packet sequence number to 0,
\- set the expected downlink packet sequence number to 0 and
### 8.2.2 Processing of the GA-PSR TC Activation Request by the GANC
Upon receiving the GA-PSR-ACTIVATE-UTC-REQ message from the MS, if the GANC
accepts this request, it:
\- allocates the IP address and the UDP port number to be used by the MS for
GPRS user data transport,
\- sends the GA-PSR-ACTIVATE-UTC-ACK message to the MS with the cause
indicating successful activation,
\- sets downlink packet sequence number to 0 and
\- sets the expected uplink packet sequence number to 0.
### 8.2.3 Processing of the GA-PSR TC Activation Acknowledgment by the MS
Upon receiving the GA-PSR-ACTIVATE-UTC-ACK message while the MS initiated GA-
PSR TC activation is in progress, the MS shall stop timer TU4002, create and
store the corresponding GA-PSR TC information and the MS GA-PSR shall
transition into GA-PSR-ACTIVE state. The MS GA-PSR shall start TU4001 timer
and forward any outstanding uplink user data packets. The TU4001 timer is
restarted whenever any user data packet is sent to or received from the GANC.
### 8.2.4 Abnormal Cases
#### 8.2.4.1 GA-PSR TC Activation Collision
If the GANC receives a GA-PSR-ACTIVATE-UTC-REQ message from the MS while the
network initiated GA-PSR TC activation procedure is in progress, the GANC
aborts the network initiated activation procedure and responds to the MS with
the GA-PSR-ACTIVATE-UTC-ACK message including the cause indicating successful
activation. The message includes GANC IP address and GANC UDP port to be used
for the uplink GPRS user data transport.
If the MS receives a GA-PSR-ACTIVATE-UTC-REQ message from the GANC while the
MS initiated GA-PSR TC activation procedure is in progress, the MS shall
silently discard the request and wait for the acknowledgment related to the MS
initiated activation already in progress.
#### 8.2.4.2 Timer TU4002 Expires during GA-PSR TC Activation
If timer TU4002 expires in the MS, the MS shall remain in GA-PSR-STANDBY state
and declare the procedure as failed to the upper layers.
#### 8.2.4.3 GANC Receives Duplicate GA-PSR TC Activation Request
If the GANC receives a GA-PSR TC activation message from the MS with an active
GA-PSR TC, it responds with the GA-PSR-ACTIVATE-UTC-ACK message to the MS and
the cause indicates successful activation. The message includes GANC IP
address and GANC UDP port allocated to the existing GA-PSR TC. In parallel, if
the MS provided new UDP port number, the GANC updates the GA-PSR TC attributes
accordingly.
After sending the GA-PSR-ACTIVATE-UTC-ACK message, the GANC
\- sets the downlink packet sequence number to 0 and
\- sets the expected uplink packet sequence number to 0
#### 8.2.4.4 GANC Rejects GA-PSR TC Activation
If the GANC decides to reject GA-PSR TC activation, it shall send a GA-PSR-
ACTIVATE-UTC-ACK message to the MS with the failure cause code and shall not
include GANC IP address and UDP port number. The following rejection cause
values are supported:
\- \"No available resources\" indicates that the GANC failed to allocate
required resources.
\- \"GANC failure\" indicates internal GANC failure.
\- \"Not authorized for data service\" indicates that the MS is not authorized
to use data services via GAN.
Upon receiving the GA-PSR-ACTIVATE-UTC-ACK message indicating failure, the MS
shall declare the procedure as failed to the upper layers.
#### 8.2.4.5 MS Aborts GA-PSR TC Activation due to Lower Layer Failure
If a lower layer failure is detected while waiting for GA-PSR-ACTIVATE-UTC-ACK
message, the MS shall declare the procedure as failed and send the
corresponding indication to upper layers. Further, the MS shall act according
to sub-clause 9.5.
## 8.3 Network Initiated GA-PSR Transport Channel (GA-PSR TC) Activation
The GANC initiated GA-PSR TC activation is triggered by the downlink GPRS user
data request when the corresponding GA-PSR TC does not exist or as a result of
PS handover from a GERAN/UTRAN cell to a GAN cell if PS handover is supported
by the GANC. The following message flow depicts the messages and timers
associated with this procedure:
Figure 8.3.1: Network initiated GA-PSR TC Activation
### 8.3.1 Initiation of the GA-PSR TC Activation by the GANC
Upon receiving the downlink user data transfer request associated with LLC
SAPI 3, 5, 9 or 11 and if there is no GA-PSR TC associated with the specific
MS or upon receiving a PS Handover Request message from the SGSN and if PS
handover is supported, the GANC allocates the IP address and the UDP port
number to be used by the MS for GPRS user data transport and sends a GA-PSR-
ACTIVATE-UTC-REQ message to the MS. The GANC also:
\- sets the downlink packet sequence number to 0 and
\- sets the expected uplink packet sequence number to 0
### 8.3.2 Processing of the GA-PSR TC Activation Request by the MS
Upon receiving the GA-PSR-ACTIVATE-UTC-REQ message from the GANC, the MS shall
verify the following:
\- the GA-PSR is in GA-PSR-STANDBY state
\- the GA-PSR TC does not exist
\- the GPRS service is not suspended
Assuming successful verification, the MS shall allocate UDP port number for
the MS GPRS user data transport and store the associated information. In
parallel, the MS GA-PSR shall transition to GA-PSR-ACTIVE state and start
TU4001 timer. Subsequently, the MS shall send the GA-PSR-ACTIVATE-UTC-ACK
message to the GANC with the cause indicating successful activation. The
message includes the MS UDP port to be used for the downlink GPRS user data
transport.
After the MS has sent the GA-PSR-ACTIVATE-UTC-ACK message, it shall:
\- set the uplink packet sequence number to 0 and
\- set the expected downlink packet sequence number to 0
### 8.3.3 Processing of the GA-PSR TC Activation Acknowledgment by the GANC
Upon receiving the GA-PSR-ACTIVATE-UTC-ACK message while the GANC initiated
GA-PSR TC activation is in progress as a result of a downlink user data
transfer request, the GANC forwards any outstanding downlink user data
packets.
Upon receiving the GA-PSR-ACTIVATE-UTC-ACK message while the GANC initiated
GA-PSR TC activation is in progress as a result of receiving a PS Handover
Request message from the SGSN, the GANC sends a PS Handover Request Ack
message to the SGSN and may start blind transmission of downlink user data.
Both uplink and downlink packet sequence number for user data are set to 0
after successful GA-PSR TC activation.
### 8.3.4 Abnormal Cases
#### 8.3.4.1 GA-PSR TC Activation Collision
If the MS receives a GA-PSR-ACTIVATE-UTC-REQ message from the GANC while the
MS initiated GA-PSR TC activation procedure is in progress, the MS shall
silently discard the request and wait for the acknowledgment related to the MS
initiated activation already in progress.
#### 8.3.4.2 MS Rejects GA-PSR TC Activation when the GPRS Service is
suspended
If the MS determines that the GPRS service is suspended when the GA-PSR-
ACTIVATE-UTC-REQ is received, it shall send a GA-PSR-ACTIVATE-UTC-ACK message
to the GANC with the failure cause code set to \"GPRS Suspended\".
Upon receiving the GA-PSR-ACTIVATE-UTC-ACK message indicating that the GPRS
service is suspended, the GANC aborts the activation procedure.
#### 8.3.4.3 MS Receives GA-PSR TC Activation Request while GA-PSR TC active
If the MS receives a GA-PSR TC activation message from the GANC while the GA-
PSR TC is active, it shall send the GA-PSR-ACTIVATE-UTC-ACK message to the
GANC. The message shall include MS UDP port allocated to the existing GA-PSR
TC. In parallel, if the GANC provided new IP Address and UDP port number, the
MS shall update the GA-PSR TC attributes accordingly.
After sending the GA-PSR-ACTIVATE-UTC-ACK message, the MS shall:
\- set uplink packet sequence number to 0 and
\- set the expected downlink packet sequence number to 0
## 8.4 MS Initiated Deactivation of GA-PSR Transport Channel
When the TU4001expires, the MS GA-PSR initiates deactivation of the GA-PSR TC
by sending the request to the GANC as per following message flow:
Figure 8.4.1: MS initiated GA-PSR TC Deactivation
### 8.4.1 GA-PSR TC Deactivation Initiation by the MS
When the TU4001 timer expires and if there are no outstanding uplink GPRS user
data messages to be transferred, the MS GA-PSR shall send the GA-PSR-
DEACTIVATE-UTC-REQ message to the GANC to request the deactivation of the
transport channel. In parallel, the MS shall start TU4002 timer to wait for
the confirmation.
### 8.4.2 Processing of GA-PSR TC Deactivation Request by the GANC
Upon receipt of a GA-PSR-DEACTIVATE-UTC-REQ message from the MS, the GANC
releases the GA-PSR TC and sends the GA-PSR-DEACTIVATE-UTC-ACK message to the
MS indicating successful deactivation; i.e. the cause IE is set to
\"success\".
### 8.4.3 Processing of GA-PSR TC Deactivation Acknowledgment by the MS
Upon receipt of a GA-PSR-DEACTIVATE-UTC-ACK message from the GANC, the MS GA-
PSR shall stop TU4002 timer, and release the GA-PSR TC. In parallel, the MS
GA-PSR shall transition to GA-PSR-STANDBY state.
### 8.4.4 Abnormal Cases
#### 8.4.4.1 Timer TU4002 Expires during GA-PSR TC Deactivation
If timer TU4002 expires in the MS, the MS shall transit to GA-PSR-STANDBY
state and declare the procedure as failed to the upper layers.
#### 8.4.4.2 GANC Rejects GA-PSR TC Deactivation
The following scenarios cover the cases when the GANC rejects GA-PSR TC
Deactivation:
\- If the corresponding GA-PSR TC does not exist on the network side, the GANC
responds with a GA-PSR-DEACTIVATE-UTC-ACK message indicating successful
deactivation.
\- If there is outstanding downlink GPRS user data for the specified MS, the
GANC forwards the data packets instead and ignores the deactivation request.
#### 8.4.4.3 Uplink User Data Transfer is initiated while GA-PSR TC
Deactivation is in Progress
If the MS LLC initiates the uplink user data transfer after the MS GA-PSR has
sent the deactivation request to the GANC, the MS GA-PSR shall complete the
deactivation procedure first and than initiate a new GA-PSR TC activation
procedure to enable data transfer.
#### 8.4.4.4 Downlink User Data Transfer is received while the GA-PSR TC
Deactivation is in Progress
If the MS receives any downlink user data packets while waiting for the GA-
PSR-DEACTIVATE-UTC-ACK message response, it shall abort the deactivation
procedure (i.e. stop timer TU4002) and restart TU4001 timer.
#### 8.4.4.5 Unexpected GA-PSR-DEACTIVATE-UTC-ACK response
If the MS receives an unexpected GA-PSR-DEACTIVATE-UTC-ACK message response
while the GA-PSR is in GA-PSR-ACTIVE state, the MS GA-PSR shall stop TU4001
timer, and release the GA-PSR TC. In parallel, the MS GA-PSR shall transition
to GA-PSR-STANDBY state.
If the MS receives an unexpected GA-PSR-DEACTIVATE-UTC-ACK message response
while the GA-PSR is in GA-PSR-STANDBY state, the message is silently
discarded.
#### 8.4.4.6 Unexpected GA-PSR-ACTIVATE-UTC-REQ
If the MS receives an unexpected GA-PSR-ACTIVATE-UTC-REQ message while waiting
for GA-PSR-DEACTIVATE-UTC-ACK message response, the MS ignores the request and
continues waiting for deactivation response.
#### 8.4.4.7 MS Aborts GA-PSR TC Deactivation due to Lower Layer Failure
If a lower layer failure is detected while waiting for GA-PSR-DEACTIVATE-UTC-
ACK message, the MS shall declare the procedure as failed and send the
corresponding indication to upper layers. Further, the MS shall act according
to sub-clause 9.5.
## 8.5 GANC Initiated Deactivation of GA-PSR Transport Channel
The GANC may initiate the deactivation of the GA-PSR TC by sending the request
to the MS as per following message flow:
Figure 8.5.1: Network initiated GA-PSR TC Deactivation
### 8.5.1 GA-PSR TC Deactivation Initiation by the GANC
When the GANC decides to deactivate GA-PSR TC channel, it shall send GA-PSR-
DEACTIVATE-UTC-REQ message to the MS to request the deactivation.
### 8.5.2 Processing of GA-PSR TC Deactivation Request by the MS
Upon receipt of a GA-PSR-DEACTIVATE-UTC-REQ message from the GANC, the MS
shall release the GA-PSR TC and send the GA-PSR-DEACTIVATE-UTC-ACK message to
the GANC indicating successful deactivation; i.e. the cause IE is set to
\"success\". In parallel, the MS GA-PSR shall transition to GA-PSR-STANDBY
state.
### 8.5.3 Processing of GA-PSR TC Deactivation Acknowledgment by the GANC
Upon receipt of a GA-PSR-DEACTIVATE-UTC-ACK message from the MS, the GANC
shall release the GA-PSR TC.
### 8.5.4 Abnormal Cases
#### 8.5.4.1 MS Rejects GA-PSR TC Deactivation
The following scenarios cover the cases when the MS rejects GA-PSR TC
Deactivation:
\- If the corresponding GA-PSR TC does not exist on the MS side, the MS shall
respond with a GA-PSR-DEACTIVATE-UTC-ACK message indicating successful
deactivation.
\- If there is outstanding uplink GPRS user data, the MS forwards the data
packets instead and ignores the deactivation request.
#### 8.5.4.2 Uplink User Data Transfer is received while GA-PSR TC
Deactivation is in Progress
If the MS LLC initiates the uplink user data transfer after the MS has
received a deactivation request from the GANC, the MS shall complete the
deactivation procedure first and than initiate a new GA-PSR TC activation
procedure to enable data transfer.
If the MS LLC initiates the uplink user data transfer before the MS has
received a deactivation request from the GANC, the MS shall treat that as
normal uplink user data transfer as defined in sub-clause 8.7.1.
#### 8.5.4.3 Downlink User Data Transfer is initiated while the GA-PSR TC
Deactivation is in Progress
If the GANC receives any downlink user data packets while waiting for the GA-
PSR-DEACTIVATE-UTC-ACK response, it shall complete the deactivation procedure
first and than initiate a new GA-PSR TC activation procedure to enable data
transfer.
## 8.6 Implicit Deactivation of GA-PSR Transport Channel
If the GAN deregistration is performed for a mobile station with an active GA-
PSR TC, the GANC automatically releases the associated GA-PSR TC. The MS shall
release the GA-PSR TC upon GAN deregistration.
This includes the scenarios where an implicit GAN deregistration is performed
by either the MS or GANC due to lower layer failures.
## 8.7 GA-PSR GPRS User Data Transport
While the corresponding GA-PSR TC is available, both mobile station and GANC
can initiate GPRS user data transfer automatically using GA-PSR UNITDATA
service as illustrated in the following figure:
Figure 8.7.1: GA-PSR GPRS User Data transport
The GPRS user data packets are tunnelled using UDP transport as specified for
GA-PSR Transport Channel. Each packet is assigned a sequence number in the
range of 0 to 65535 sequentially. The sequence number is set to 0 after
reaching the maximum - 65535.
### 8.7.1 MS Initiates Uplink GPRS User Data Transfer
Assuming that the GA-PSR TC has been already activated as specified in sub-
clauses 8.2 or 8.3, the MS GA-PSR is able to immediately forward any uplink
GPRS user data packets to the GANC. Upon the request from the LLC to transfer
an uplink LLC PDU with GPRS user data identified with LLC SAPI 3, 5, 9 or 11,
the MS GA-PSR shall restart TU4001 timer and encapsulate the complete LLC PDU
within a GA-PSR UNITDATA message.
Subsequently, the MS shall send the GA-PSR UNITDATA message to the GANC using
the existing GA-PSR TC; i.e. using the corresponding GANC IP address and UDP
port number.
The MS shall increment the uplink packet sequence number for each GA-PSR-
UNITDATA message sent to the GANC.
### 8.7.2 Processing of the Uplink GPRS User Data Message by the GANC
Upon receiving the uplink user data message from the MS, the GANC extracts the
received LLC PDU and available message parameters, relays the PDU to the SGSN
via the Gb interface using the BSSGP uplink unitdata procedure as per standard
GPRS.
The GANC increments the expected uplink packet sequence number for each GA-
PSR-UNITDATA message received from the MS.
### 8.7.3 GANC Initiates Downlink GPRS User Data Transfer
Assuming that the GA-PSR TC has been already activated as specified in sub-
clause 8.2 or 8.3, the GANC is able to immediately forward any downlink GPRS
user data packets to the MS. Upon receiving a downlink packet for the MS, the
GANC sends the GA-PSR UNITDATA message to the MS using the existing GA-PSR TC;
i.e. using the corresponding MS IP address and UDP port number.
The GANC increments the downlink packet sequence number for each GA-PSR-
UNITDATA message sent to the MS.
### 8.7.4 Processing of the Downlink GPRS User Data Message by the MS
Upon receiving the downlink user data message from the GANC, the MS GA-PSR
shall restart TU4001 timer, extract the received LLC PDU and TLLI and forward
the PDU to the LLC layer via the GRR SAP as per standard GPRS.
The MS shall increment the expected downlink packet sequence number for each
GA-PSR-UNITDATA message received from the GANC.
### 8.7.5 Abnormal Cases
#### 8.7.5.1 GANC Receives an Uplink User Data Message while the GA-PSR TC
Activation Procedure is in progress
Upon receiving an uplink message while the GA-PSR TC activation procedure is
in progress (TU4002 timer is still running), the GANC will process the request
as if the GA-PSR TC was active.
#### 8.7.5.2 GANC Receives an Uplink User Data Message and the GA-PSR TC is
not active
Upon receiving an uplink message that is associated with a GA-PSR TC that does
not exist, the GANC will process the message as defined in sub-clause 8.7.2.
The GANC may disregard the uplink packet sequence number in this case.
Further, the GANC initiates GA-PSR TC activation procedure as defined in sub-
clause 8.3.
#### 8.7.5.3 Handling of out-of-sequence packets
Packets received out-of-sequence should be dropped.
#### 8.7.5.4 MS Receives a Downlink User Data Message while the GA-PSR TC
Activation Procedure is in progress
Upon receiving a downlink message while the GA-PSR TC activation procedure is
in progress (TU4002 timer is still running), the MS GA-PSR shall process the
request as if the transport channel was active. The MS shall not initiate
uplink GPRS user data transfer until the GA-PSR TC activation procedure is
successfully completed (as specified in the subclause 8.2). The MS shall use
the IP address and UDP port number received in the GA-PSR ACTIVATE UTC ACK
message for sending uplink GPRS user data packets to the GANC on that
transport channel.
#### 8.7.5.5 Uplink User Data Transfer Failed due to Lower Layer Failure
If a lower layer failure is detected while attempting to send an uplink user
data packet, the MS shall declare the procedure as failed and send the
corresponding indication to upper layers.
## 8.8 GA-PSR GPRS Signalling and SMS Messages Transport
While the MS is registered for GAN services, the corresponding TCP session for
signalling transport is always available and, assuming that the MS GA-CSR and
GA-PSR are attached to GSM/GPRS SAPs, both mobile station and GANC can
initiate GPRS signalling message transfer using GA-PSR DATA service as
illustrated in the following figure. The GA-PSR-DATA transport mechanism is
utilized for all GPRS GMM/SM signalling and SMS messages.
Figure 8.8.1: GA-PSR GPRS Signalling and SMS Messages transport
### 8.8.1 MS Initiates Uplink GPRS Signalling/SMS Message Transfer
Upon the request form the LLC to transfer an uplink LLC PDU carrying GPRS
signalling message (identified with LLC SAPI 1) or GPRS SMS message (LLC SAPI
7), the MS GA-PSR shall encapsulate the complete LLC PDU within a GA-PSR DATA
message and send the message to the GANC using the existing signalling TCP
session.
### 8.8.2 Processing of the Uplink GA-PSR DATA Message by the GANC
Upon receiving the uplink GA-PSR DATA message from the MS, the GANC extracts
the received LLC PDU and available message parameters and, relays the PDU to
the SGSN via the Gb interface using the BSSGP uplink unitdata procedure as per
standard GPRS.
### 8.8.3 GANC Initiates Downlink GA-PSR DATA Transfer
Upon receiving a downlink LLC PDU with GPRS signalling (identified with LLC
SAPI 1) or SMS message (LLC SAPI 7), the GANC encapsulates the complete LLC
PDU within a GA-PSR DATA message and sends the message to the MS using the
existing signalling TCP session.
### 8.8.4 Processing of the Downlink GA-PSR DATA Message by the MS
Upon receiving the GA-PSR-DATA message that includes the downlink GPRS
signalling or SMS LLC PDU from the GANC, the MS shall extract the received LLC
PDU and TLLI and forward the PDU to the LLC layer via the GRR SAP as per
standard GPRS.
### 8.8.5 Abnormal Cases
#### 8.8.5.1 Downlink or Uplink User Data Transfer Failed due to Lower Layer
Failure
If a lower layer failure is detected while attempting to send an uplink GPRS
signalling or SMS message, the MS GA-PSR shall act according to sub-clause
9.5.
## 8.9 Packet paging for packet service
The following figure depicts interactions involved in the packet paging
procedure via GAN.
Figure 8.9.1: Packet Paging
### 8.9.1 PS Paging Request Processing by the GANC
Upon receiving a Paging PS request from the SGSN for GAN registered MS, the
GANC sends the GA-PSR-PS-PAGE message to the MS via the signalling TCP
session.
### 8.9.2 PS Paging Request Processed by the MS
Upon receiving a GA-PSR-PS-PAGE message from the GANC, the MS GA-PSR shall
forward the indication to the GMM layer using the GMMRR SAP as per standard
GPRS. Subsequently, the MS shall send an uplink LLC PDU as a page response per
standard GPRS. The MS may either send GA-PSR-DATA or GA-PSR-UNITDATA message
as described in sub-clauses 8.7 and 8.8.
### 8.9.3 Processing of the PS Paging Response by the GANC
Since the MS responds to a PS Paging with any LLC PDU encapsulated within the
standard GA-PSR-DATA or GA-PSR-UNITDATA message, the GANC will process the
message as any other GPRS signalling/SMS or user data message. The processing
of uplink GPRS data messages is described in sub-clause 8.7 and for the uplink
GPRS signalling messages in sub-clause 8.8.
## 8.10 GPRS Suspend Procedure
The following figure depicts interaction involved in the GPRS Suspend
procedure.
{width="3.9277777777777776in" height="0.9569444444444445in"}
Figure 8.10.1 GPRS Suspend
### 8.10.1 GPRS Suspension Initiation by the MS
While transitioning to dedicated mode and if unable to support simultaneous CS
and PS services, the MS shall request the suspension of the downlink GPRS data
transfer by sending a GA- CSR GPRS SUSPENSION REQUEST message to the GANC
### 8.10.2 GPRS Suspend Request Processing by the GANC
Upon receiving a GA- CSR GPRS SUSPENSION REQUEST message from the MS, the GANC
completes the GPRS suspend procedure via the Gb interface as defined in [19].
## 8.11 MS Initiated Downlink Flow Control
The MS initiated downlink flow control procedure is based on standard GPRS
downlink flow control mechanism enhanced for GAN service. The MS implements
the flow control algorithm to monitor and calculate the data rate that could
be supported based on the current conditions. When the flow control condition
is detected (e.g. the utilization of the buffers reaches a high watermark
level), the MS re-calculates the estimated data rate that could be supported
and sends the flow control request to the GANC to adjust the data rate
accordingly. The following message flow depicts the messages and timers
associated with this procedure:
Figure 8.11.1: MS initiated Downlink Flow Control
Initially, before detecting a flow control condition, the flow control
condition does not exist in the MS. In this state, the MS GA-PSR monitors the
average downlink data rate and the utilization of resources (e.g. downlink
buffers), and when utilization exceeds a certain threshold, a downlink flow
control condition is detected.
When the downlink flow control condition is detected, the MS sends the GA-PSR-
DFC-REQ message to the GANC and starts the TU4003 timer. Whenever the timer
expires, the MS checks the downlink flow control condition, and if it
continues to exist, the MS restarts the timer, and sends another GA-PSR-DFC-
REQ message to the GANC. The MS remains in this state while the flow control
condition persists. As soon as the flow control condition is resolved, the MS
deactivates the TU4003 timer and transitions to the default state in which no
downlink flow control condition exists.
In case TU4003 is running and the CS traffic channel is activated or released
or in case of GA-CSR state transition, MS may request the GANC flow control
parameters to adjust existing flow control by sending GA-PSR-DFC-REQ message
to the GANC and if so it shall restart the timer TU4003.
### 8.11.1 Initiation of the Downlink Flow Control by the MS
Upon detecting the downlink flow control condition, the MS shall initiate a
downlink flow control procedure by sending a GA-PSR-DFC-REQ message to the
GANC via the existing GA-PSR TC. The message includes new estimated data rate
that can be supported. At the same time the MS shall start timer TU4003 to
continue monitoring the flow control condition. The timer TU4003 is specified
in sub-clause 12.
### 8.11.2 Processing of the Downlink Flow Control Request by the GANC
Upon receiving the GA-PSR-DFC-REQ message from the MS, the GANC initiates
downlink flow control procedure over the Gb interface as per standard GPRS.
### 8.11.3 Processing of the TU4003 Timer Expiry by the MS
When the TU4003 timer expires, the MS shall re-evaluate the flow control
condition and perform the following based on the outcome of the evaluation:
\- If the flow control condition still exists (e.g. downlink buffer
utilization is still above the low watermark level), the MS shall calculate a
new data rate that can be supported and forward the corresponding GA-PSR-DFC-
REQ message to the GANC via the existing GA-PSR TC. Simultaneously, the MS
shall start timer TU4003 to continue monitoring the downlink data transfer.
\- If the flow condition has been resolved (e.g. buffer utilization is below
the low mark level), the MS shall not restart the TU4003 timer and shall stop
sending flow control requests to the GANC.
## 8.12 Uplink Flow Control
The uplink flow control procedure is used to dynamically manage sharing of the
available Gb interface bandwidth. The following message flow depicts the
messages and timers associated with this procedure:
Figure 8.12.1: Uplink Flow Control
Upon receiving the request, the MS GA-PSR adjusts the uplink data rate as per
request.
### 8.12.1 Initiation of the Uplink Flow Control by the GANC
Upon detecting the uplink flow control condition, the GANC initiates an uplink
flow control procedure by sending a GA-PSR-UFC-REQ message to the MS via the
existing GA-PSR TC. The request is PFC based if the packet flow management
procedures are supported.
The GANC shall never request the uplink data rate that is lower than the
guaranteed uplink bit rate specified for that PFC. The guaranteed bit rate can
be ignored by the GANC if the Traffic Class is Interactive class or Background
class.
### 8.12.2 Processing of the Uplink Flow Control Request by the MS
Upon receiving the GA-PSR-UFC-REQUEST message from the GANC, the MS adjusts
the uplink data rate accordingly.
### 8.12.3 Resetting of the Uplink Flow Control Condition by the GANC
After the uplink flow control condition is resolved and the current conditions
allow the uplink data rate to be reset to normal level, the GANC initiates an
uplink flow control condition reset by sending a GA-PSR-UFC-REQUEST message to
the MS via the existing GA-PSR TC. This message includes the reset indicator.
### 8.12.4 Abnormal Cases
#### 8.12.4.1 GA-PSR TC Deactivation is in Progress
If the MS receives a GA-PSR-UFC-REQUEST message while the GA-PSR TC
deactivation is in progress, the MS shall ignore the flow control request.
## 8.13 PS handover to GAN A/Gb mode
### 8.13.1 Initiation
If PS handover to GAN A/Gb mode is supported by both the MS and the source
BSS/RNC it may be used to prevent an MS from performing an autonomous rove-in
to GAN A/Gb mode in favour of using PS handover to perform a cell change. PS
handover from a GERAN cell to a GAN A/Gb mode cell may be triggered as
described in 3GPP TS 44.060 [45]. PS handover from a UTRAN cell to a GAN A/Gb
mode cell may be triggered as described in 3GPP TS 25.331 [40].
The procedure for PS handover to a GAN A/Gb mode cell results in the target
GANC allocating the MS a GA-PSR Transport Channel in response to receiving a
**PS Handover Request** message from the SGSN (see sub-clause 8.3 and 3GPP TS
43.129 [49]). When the source BSS/RNC is informed about the successful
allocation of the GA-PSR Transport Channel it responds by sending the MS a
**PS Handover Command** message (source BSS) or a **Handover from UTRAN
Command** message (source RNC).
If the target GANC supports blind transmission it may begin transmitting
downlink data on the allocated GA-PSR Transport Channel prior to determining
that PS handover to the GAN A/Gb mode cell has been successfully completed.
Otherwise, it may discard downlink data that becomes available prior to
detecting the successful completion of the PS handover to the GAN A/Gb mode
cell. An MS that supports blind transmission enables the reception of downlink
data upon being allocated a GA-PSR Transport Channel (i.e. prior to switching
to GAN A/Gb mode).
### 8.13.2 Successful completion of the PS handover to GAN A/Gb mode
From the MS perspective the procedure for PS handover to a GAN A/Gb mode cell
is started upon reception of the **PS Handover Command** message or the
**Handover from UTRAN Command** message and completed upon sending a **GA-PSR
HANDOVER COMPLETE** message to the GANC.
From the source BSS/RNC perspective the procedure for PS handover to a GAN
A/Gb mode cell is started upon deciding to perform PS handover of an MS to a
GAN A/Gb mode cell and completed upon being told by the SGSN to release all
ongoing radio resources.
From the target GANC perspective the procedure for PS handover to a GAN A/Gb
mode cell is started upon receiving a **PS Handover Request** message and
completed upon receiving a **GA-PSR HANDOVER COMPLETE** message from the MS.
Upon receiving this message the GANC shall indicate PS handover completion to
the SGSN.
### 8.13.3 Abnormal Cases
Upon receiving a **PS Handover Command** message or a **Handover from**
**UTRAN Command** message in the source cell the MS may experience the
following abnormal conditions:
\- If connectivity has been lost on the GA-PSR Transport Channel before the MS
has transmitted a GA-PSR HANDOVER COMPLETE message it shall abort the PS
handover to GAN A/Gb mode. The MS shall remain in the source cell and provide
a failure notification as described in 3GPP TS 44.060 [45] for a GERAN cell or
in 3GPP TS 25.331 [40] for a UTRAN cell.
## 8.14 PS handover from GAN A/Gb mode
### 8.14.1 Initiation
If PS handover from GAN A/Gb mode is supported by both the MS and the GANC it
may be used to prevent an MS from performing an autonomous rove-out from GAN
A/Gb mode in favour of using PS handover to perform a cell change.
Figure 8.14.1: PS handover from GAN A/Gb mode, successful case
Figure 8.14.2: PS handover from GAN A/Gb mode, failure case
The MS and the GANC inform each other of whether or not they support PS
handover during GAN registration. If supported, PS handover may be triggered
by the MS based on:
\- local measurements of GAN coverage signal quality;
\- user initiated change of operational mode to GERAN/UTRAN preferred or
GERAN/UTRAN only;
\- reception of a **GA-PSR UPLINK QUALITY INDICATION** message from the GANC
indicating one of the following in the UL Quality Indication IE:
\- Radio problem (unacceptable uplink performance).
\- Network problem.
\- Unknown problem.
Upon experiencing any of these trigger conditions an MS may at any point
trigger the PS handover procedure in the source GANC by sending a **GA-PSR
HANDOVER INFORMATION** message.
A **GA-PSR HANDOVER INFORMATION** message sent by an MS shall include a list
of candidate GERAN/UTRAN cells ranked in order of preference based on the most
recent lists available from the candidate radio access technologies and
including the received signal strength for each identified GERAN or UTRAN
cell. The list of candidate cells may include only GERAN cells, only UTRAN
cells or both, as permitted by the Handover Reporting Control IE (see sub-
clause 11.2.113). If no Handover Reporting Control IE was included in the most
recently received GA-RC REGISTER ACCEPT message, there is no restriction on
the cells that may be listed. Upon sending this message the MS shall start
timer TU4004.
### 8.14.2 Reception of GA-PSR HANDOVER INFORMATION by the GANC
Upon reception of a **GA-PSR HANDOVER INFORMATION** message the source GANC
triggers PS handover to a GERAN/UTRAN target cell by sending a **PS Handover
Required** message to the SGSN. This results in the allocation of radio
resources/RABs in the target cell (see 3GPP TS 43.129 [49]). When the source
GANC is informed by the SGSN about the successful allocation of radio
resources/RABs in the target cell it responds by sending the MS a **GA-PSR
HANDOVER COMMAND** message. While the PS handover procedure is ongoing but
prior to sending the MS a **GA-PSR HANDOVER COMMAND** message, the GANC may
send the MS one or more instances of the **GA-PSR HANDOVER CONTINUE** message
to prevent timer TU4004 from expiring in the MS.
### 8.14.3 Reception of GA-PSR HANDOVER CONTINUE by the MS
Upon reception of a **GA-PSR HANDOVER CONTINUE** message from the GANC the MS
shall proceed as follows:
\- If timer TU4004 is running it shall be restarted.
\- If timer TU4004 is not running the MS shall discard the **GA-PSR HANDOVER
CONTINUE** message.
### 8.14.4 Reception of GA-PSR HANDOVER COMMAND by the MS
The **GA-PSR HANDOVER COMMAND** message should only indicate a target cell
which was reported by the MS in the **GA-PSR HANDOVER INFORMATION** message.
\- For the case of PS handover to a GERAN cell, the GA-PSR Handover Command
message shall include the set of PSI or SI messages required for mobile
station to operate in the new cell within the _PS Handover to GERAN PSI_ IE or
_PS Handover to GERAN SI_ IE (see A/Gb mode to A/Gb mode PS handover described
in 3GPP TS 44.060 [45]).
\- For the case of PS handover to a GERAN cell the MS shall ignore the value
of the Page Mode, Global TFI and Container ID information elements included in
the PS HANDOVER COMMAND message carried within the GA-PSR Handover Command
message.
\- For the case of PS Handover to a GERAN cell, the PS Handover Command
message created by the target BSS shall always indicate the PS Handover type
as being non-synchronized (see 3GPP TS 44.060 [45]).
Upon reception of a **GA-PSR HANDOVER COMMAND** message from the GANC the MS
shall:
\- stop timer TU4004.
\- suspend all NAS layer signalling transmissions;
\- start the connection establishment to the target BSS/RNC by using the
contents of the _PS Handover to GERAN Command_ IE or _PS Handover to UTRAN
Command_ IE (included in the **GA-PSR HANDOVER COMMAND** message) which
contains either a **PS Handover Command** message (see 3GPP TS 44.060 [45])
created by the target BSS (for PS handover to a GERAN cell) or a **Handover to
UTRAN Command** message (see 3GPP TS 25.331 [40]) created by the target RNC
(for PS handover to a UTRAN cell). These encapsulated messages carry
information about the target cell identifier and radio parameters relevant for
the target radio access technology.
### 8.14.5 Successful completion of the PS Handover from GAN A/Gb mode
From the MS perspective the procedure for PS handover from a GAN A/Gb mode
cell is started upon reception of the **GA-PSR HANDOVER COMMAND** message from
the GANC and completed using procedures applicable to the target radio access
technology (see Note 1). Upon successfully completing the PS handover from a
GAN A/Gb mode cell the MS shall:
\- switch to GERAN/UTRAN mode (i.e. switch the serving RR to GSM RR or UTRAN
RRC).
\- enter GA-RC-REGISTERED state.
\- either deregister from GAN A/Gb mode as defined in sub-clause 6.4 or remain
in the GA-RC-REGISTERED state but consider the GA-PSR Transport Channel
previously used in the GAN A/Gb mode cell as implicitly released.
From the source GANC perspective the procedure for PS handover from a GAN A/Gb
mode cell is started upon receiving a **GA-PSR HANDOVER INFORMATION** message
from the MS and deciding to perform PS handover to a GERAN/UTRAN cell. It is
completed upon being told by the SGSN to delete the packet flow contexts
corresponding to that MS (see Note 2).
From the target BSS/RNC perspective the procedure for PS handover from a GAN
A/Gb mode cell is started upon receiving a **PS Handover Request** message
(target BSS) or a **Relocation Request** message (target RNC) from the SGSN
and completed upon receiving confirmation from the MS that it has arrived in
the target cell (see Note 1).
NOTE 1: The requirements concerning the establishment of the radio connection
towards the target radio access technology and the corresponding signalling
procedures are outside of the scope of this specification.
NOTE 2: The target RAT informs the source RAT (e.g. by sending a **Forward
Relocation Complete** message) that PS handover was successful so that the
local release of the GA-PSR Transport Channel can be triggered.
### 8.14.6 Abnormal Cases
If timer TU4004 expires the MS shall either rove-out to GERAN/UTRAN mode or
remain in GANA/Gb mode if the conditions that caused the MS to initiate PS
handover have been resolved. In the latter case, the MS may subsequently re-
initiate PS handover based on the triggering events described in clause
8.14.1.
If the MS is unable to act on the **GA-PSR HANDOVER COMMAND** message it shall
discard it, send the source GANC a **GA-PSR HANDOVER FAILURE** message and
resume normal operation as if the **GA-PSR HANDOVER COMMAND** message had not
been received. The GA-PSR cause value in the **GA-PSR HANDOVER FAILURE**
message shall be set to \"PS handover failure - incorrect handover command\".
If the MS is able to act on the **GA-PSR HANDOVER COMMAND** message but is
unable to establish the radio connection towards the target radio access
technology it shall return to the old cell, send the source GANC a **GA-PSR
HANDOVER FAILURE** message and resume normal operation as if the **GA-PSR
HANDOVER COMMAND** message had not been received. The GA-PSR cause value in
the **GA-PSR HANDOVER FAILURE** message shall be set to \"PS handover failure
- target RAT access failure\".
For the case of PS handover to a GERAN cell, if the **GA-PSR Handover
Command** message does not contain the minimum set of PSI or SI messages
required for mobile station to operate in the new cell (see A/Gb mode to A/Gb
mode PS handover described in 3GPP TS 44.060 [45]), the MS shall send the
source GANC a **GA-PSR HANDOVER FAILURE** message and resume normal operation
as if the GA-PSR HANDOVER COMMAND message had not been received. The GA-PSR
cause value in the **GA-PSR HANDOVER FAILURE** message shall be set to \"PS
handover failure - missing SI/PSI information\".
For the case of PS handover to a GERAN cell, if the PS HANDOVER COMMAND
message carried within the **GA-PSR Handover Command** message does not
provide resources for at least one uplink TBF in the new cell, the MS shall
send the source GANC a **GA-PSR HANDOVER FAILURE** message and resume normal
operation as if the GA-PSR HANDOVER COMMAND message had not been received. The
GA-PSR cause value in the **GA-PSR HANDOVER FAILURE** message shall be set to
\"PS handover failure - no uplink TBF allocation\".
### 8.14.7 Reception of GA-PSR HANDOVER FAILURE by the GANC
Upon reception of a **GA-PSR HANDOVER FAILURE** message from an MS the GANC
shall initiate the release of resources in the target radio access technology.
# 8a GA-RRC elementary procedures
## 8a.1 GA-RRC connection establishment
The GAN Iu mode GA-RRC CS and PS connections are logical connections between
the MS and the GANC. As described in 3GPP TS 43.318, the GA-RRC sub-layer in
the MS contains two entities, the CS domain GA-RRC sublayer entity and the PS
domain GA-RRC sublayer entity. These entities operate independently and in
parallel; e.g., two GA-RRC connections are established in the case of
simultaneous CS and PS services, one GA-RRC connection for each domain. Each
GA-RRC sub-layer entity in the MS can be in one of two states, GA-RRC-IDLE or
GA-RRC-CONNECTED. Figures showing state changes (e.g., from GA-RRC-IDLE to GA-
RRC-CONNECTED) in this sub-clause refer to changes for a single GA-RRC sub-
layer entity, either CS or PS.
A GA-RRC connection is established when the upper layers in the MS request the
establishment of a signalling connection for either CS or PS domain and the
GA-RRC sub-layer entity in the MS is in the GA-RRC-IDLE state for that domain;
i.e., no GA-RRC connection exists. When a successful response is received from
the network, GA-RRC replies to the upper layer that the GA-RRC sub-layer
entity in the MS has entered the RRC connected mode (i.e., the GA-RRC-
CONNECTED state). The upper layers then have the possibility to request
transmission of NAS messages to the network (as described in sub-clause 8a.2).
Note that in the case of a network-initiated CS or PS session, the GA-RRC
connection is implicitly established when the MS responds to the GA-RRC PAGING
REQUEST message from the GANC with the GA-RRC INITIAL DIRECT TRANSFER message
containing the paging response (see sub-clause 8a.3).
Also, in the case of handover from GERAN or UTRAN to GAN Iu mode, the GA-RRC
connection is implicitly established when the MS sends the GA-RRC RELOCATION
ACK message to the GANC (normal case) or the GA-RRC RELOCATION ACCESS message
to the GANC (exception case), as described in sub-clause 8a.10.
Figure 8a.1.1 MS initiation of GA-RRC connection, successful case
Figure 8a.1.2 MS initiation of GA-RRC connection, failure case
### 8a.1.1 Initiation of GA-RRC connection establishment by the MS
The MS initiates the establishment of the GA-RRC connection when the upper
layers in the MS request the establishment of a signalling connection for
either CS or PS domain and the GA-RRC sub-layer entity in the MS is in GA-RRC-
IDLE state for that domain.
Before initiation of the GA-RRC connection establishment request, the MS shall
check for access permission based on Access Control Class bits returned within
GA-RC REGISTER ACCEPT message as defined in [12].
If it is allowed for the MS to access the network, the MS shall send a GA-RRC
REQUEST message to the GANC on the established TCP connection, including the
IE \"CN Domain Identity\" and the IE \"Establishment Cause\", and start timer
TU5908 for the domain (i.e., the MS may have up to two instances of the TU5908
timer running at the same time, one for each domain).
### 8a.1.2 Reception of GA-RRC REQUEST by GANC
When the GANC receives the GA-RRC REQUEST message, the GANC may either accept
or reject the GA-RRC connection establishment request.
#### 8a.1.2.1 GA-RRC connection establishment request accepted
If the GANC accepts the GA-RRC connection establishment request, it shall send
the GA-RRC REQUEST ACCEPT message to the MS including the IE \"CN Domain
Identity\".
#### 8a.1.2.2 GA-RRC connection establishment request rejected
If the GANC rejects the GA-RRC connection establishment request, it shall send
the GA-RRC REQUEST REJECT message to the MS including the IE \"CN Domain
Identity\".
### 8a.1.3 GA-RRC connection establishment response handling in the MS
#### 8a.1.3.1 GA-RRC connection establishment request accepted
When the MS receives the GA-RRC REQUEST ACCEPT message, it shall:
\- if timer TU5908 is active for the domain indicated by the IE \"CN Domain
Identity\":
\- stop timer TU5908 for that domain,
\- move into the GA-RRC-CONNECTED state for that domain,
\- indicate to upper layers that GA-RRC has entered the connected state for
that domain, and
\- send the GA-RRC INITIAL DIRECT TRANSFER message to the network;
\- if timer TU5908 is not active for the domain indicated by the IE \"CN
Domain Identity\":
\- ignore the GA-RRC REQUEST ACCEPT message, and
\- continue with the procedure as if the GA-RRC REQUEST ACCEPT message was not
received.
#### 8a.1.3.2 GA-RRC connection establishment request rejected
When the MS receives the GA-RRC REQUEST REJECT message, it shall:
\- if timer TU5908 is active for the domain indicated by the IE \"CN Domain
Identity\":
\- stop timer TU5908 for that domain,
\- remain in the GA-RRC-IDLE state for that domain, and
\- indicate to upper layers that GA-RRC was not able to enter the connected
state for that domain;
\- if timer TU5908 is not active for the domain indicated by the IE \"CN
Domain Identity\":
\- ignore the GA-RRC REQUEST REJECT message, and
\- continue with the procedure as if the GA-RRC REQUEST REJECT message was not
received.
### 8a.1.4 Failure cases
#### 8a.1.4.1 Timer TU5908 expiry
If timer TU5908 expires in the MS, the GA-RRC sub-layer entity in the MS shall
remain in the GA-RRC-IDLE state and indicate to upper layers that GA-RRC was
not able to enter the connected state for the domain.
## 8a.2 Upper layer message transmission
The GA-RRC INITIAL DIRECT TRANSFER message is used to transfer the \"initial\"
upper layer message for the domain (i.e., the first NAS message after GA-RRC
connection establishment for the domain) from the MS to the GANC. Receipt of
the GA-RRC INITIAL DIRECT TRANSFER message by the GANC triggers the
establishment of the signalling connection to the indicated CN domain for the
MS. The GA-RRC UPLINK DIRECT TRANSFER message is used to transfer all
subsequent upper layer messages for the signalling connection from the MS to
the GANC.
The GA-RRC DOWNLINK DIRECT TRANSFER message is used to transfer upper layer
messages from the GANC to the MS.
### 8a.2.1 Initial upper layer message forwarding by the MS
Figure 8a.2.1.1 Initial direct transfer, normal flow
The GA-RRC sub-layer entity in the MS shall initiate the initial direct
transfer procedure in the GA-RRC-CONNECTED state when the upper layers request
the transfer of the first non-access stratum (NAS) message associated with the
signalling connection.
The MS shall include the IE \"CN Domain Identity\" and the contents of the
received NAS message in the L3 Message IE. The MS also includes the Intra
Domain NAS Node Selector (IDNNS) IE which may be used by the GANC to route the
establishment of a signalling connection to a CN node within the indicated CN
domain (i.e., using IuFlex).
### 8a.2.2 Reception of GA-RRC INITIAL DIRECT TRANSFER by GANC
When the GANC receives the GA-RRC INITIAL DIRECT TRANSFER message from a GA-
RRC sub-layer entity in MS in the GA-RRC-CONNECTED state and there is no
signalling connection to the indicated CN domain, the GANC shall establish an
Iu signalling connection between the GANC and the indicated CN domain and
transfer the initial NAS message to the CN.
### 8a.2.3 Subsequent upper layer message forwarding by the MS
Figure 8a.2.3.1 Uplink direct transfer, normal flow
The GA-RRC sub-layer entity in the MS shall initiate the uplink direct
transfer procedure in the GA-RRC-CONNECTED state when the upper layers request
the transfer of a subsequent NAS message associated with the signalling
connection (i.e., after the initial NAS message).
The MS shall include the IE \"CN Domain Identity\" and the contents of the
received NAS message in the IE \"L3 Message\".
### 8a.2.4 Reception of GA-RRC UPLINK DIRECT TRANSFER by GANC
When the GANC receives the GA-RRC UPLINK DIRECT TRANSFER message from a GA-RRC
sub-layer entity in the MS in the GA-RRC-CONNECTED state, the GANC shall
transfer the NAS message to the CN using the existing signalling connection.
### 8a.2.5 Upper layer message forwarding by the GANC
Figure 8a.2.5.1 Downlink direct transfer, normal flow
The downlink direct transfer procedure is initiated by the GANC when the GANC
receives a NAS message from a CN domain (i.e., after the establishment of the
GA-RRC connection to the MS for the domain).
The GANC shall include the IE \"CN Domain Identity\" and the contents of the
received NAS message in the IE \"L3 Message\".
### 8a.2.6 Reception of GA-RRC DOWNLINK DIRECT TRANSFER by the MS
When the MS receives the GA-RRC DOWNLINK DIRECT TRANSFER message it shall,
using the IE \"CN Domain Identity\", route the contents of the IE \"NAS
message\" and the value of the IE \"CN Domain Identity\" to upper layers.
#### 8a.2.6.1 Invalid GA-RRC DOWNLINK DIRECT TRANSFER
If the MS receives a GA-RRC DOWNLINK DIRECT TRANSFER message and GA-RRC sub-
layer entity in the MS is not in GA-RRC-CONNECTED state for the indicated
domain, the MS shall:
\- ignore the contents of the GA-RRC DOWNLINK DIRECT TRANSFER message;
\- transmit a GA-RRC STATUS message to the GANC as follows:
\- set the IE \"GA-RRC Cause\" to \"Message type not compatible with protocol
state\"
\- include the received message contents in the IE \"PDU in Error\"
\- continue with any ongoing procedure and act as if the GA-RRC DOWNLINK
DIRECT TRANSFER message was not received.
## 8a.3 Paging
The GANC uses the paging procedure to transmit paging information received
from the CN to the MS. The procedure also results in GA-RRC connection
establishment between the MS and the GANC for the indicated domain.
Figure 8a.3.1 Paging, normal flow
### 8a.3.1 Initiation of paging
The GANC sends the GA-RRC PAGING REQUEST message to the MS when the GANC
receives a PAGING message over the Iu interface from a CN domain. The IMSI of
the MS to be paged is identified by the IE \"Permanent NAS UE Identity\"
received in the request from the CN. If the request also includes the (P-)TMSI
then the GANC shall include the (P-)TMSI in the IE \"Mobile Identity\"; else
the GANC shall include the IMSI in the IE \"Mobile Identity\". The GANC also
includes the IE \"CN Domain Identity\" and the IE \"GA-RRC Paging Cause\", if
a cause is received from the CN.
### 8a.3.2 Reception of GA-RRC PAGING REQUEST by the MS
If the mobile identity in the GA-RRC PAGING REQUEST message matches any of the
valid identities of the MS and the GA-RRC sub-layer entity in the MS is in the
GA-RRC-IDLE state for the indicated domain, the MS shall:
\- if timer TU5908 is not active for the domain and access to the network is
allowed:
\- indicate reception of paging to upper layers, and
\- forward the IE \"CN Domain Identity\", the IE \"Mobile Identity\" and the
IE \"Paging Cause\" (if received) to the upper layers;
\- Note: The upper layers will request the establishment of a signalling
connection and the transmission of the paging response in the initial NAS
message. This results in the implicit establishment of the GA-RRC connection
(i.e., the GA-RRC sub-layer entity in the MS enters the GA-RRC CONNECTED
state) and the transmission of the paging response from the MS to the GANC in
the GA-RRC INITIAL DIRECT TRANSFER message, as shown in Figure 8a.3.1.
\- if timer TU5908 is active for the domain:
\- ignore the GA-RRC PAGING REQUEST message, and
\- continue with the ongoing procedure as if the GA-RRC PAGING REQUEST was not
received.
### 8a.3.3 Abnormal Cases
If the MS receives a GA-RRC PAGING REQUEST message and the GA-RRC sublayer
entity in the MS is in GA-RRC-CONNECTED state for the indicated domain or the
MS is in the GA-RC-REGISTERED state but in GERAN/UTRAN/E-UTRAN mode, the MS
shall:
\- ignore the GA-RRC PAGING REQUEST message, and
\- continue with any ongoing procedure as if the GA-RRC PAGING REQUEST was not
received.
If the MS receives a GA-RRC PAGING REQUEST and the mobile identity included in
the message does not match any of the valid identities assigned to the MS, the
MS shall:
\- ignore the GA-RRC PAGING REQUEST message, and
\- continue with any ongoing procedure as if the GA-RRC PAGING REQUEST message
was not received.
## 8a.4 Transport channel activation
There are two versions of the transport channel activation procedure, the
circuit transport channel (i.e., the \"RTP channel\") activation procedure and
the packet transport channel activation procedure. As illustrated in the
following sub-clauses, these two procedures use the same messages and the same
basic message flows (as illustrated in the following figure), but differ in
the content of the messages.
Figure 8a.4.1 Transport channel activation, normal flow
### 8a.4.1 Circuit transport channel activation
#### 8a.4.1.1 Initiation of circuit transport channel activation
The following are the possible triggers for initiation of the circuit
transport channel (CTC) activation procedure:
\- If the MS is in the GA-RRC-CONNECTED state for the CS domain and the GANC
receives the RAB Assignment Request message from the MSC;
\- If the MS is in the GA-RRC-CONNECTED state for the CS domain and the GANC
receives the GA-RRC RELOCATION ACCESS message from the MS during the CS
handover to GAN Iu mode process (see sub-clause 8a.10.5).
One or more CTCs may be activated using a single instance of the channel
activation procedure; however, it is not possible to activate both circuit and
packet transport channels using a single instance of the channel activation
procedure.
The GANC begins the activation of the CTC(s) by transmitting the GA-RRC
ACTIVATE CHANNEL message to the MS. The message contains the IE \"CN Domain
Identity\" (indicating CS domain) and IE \"CTC Activation List\" which
includes the parameters necessary to describe each circuit transport channel.
#### 8a.4.1.2 Reception of GA-RRC ACTIVATE CHANNEL (CS domain) by the MS
The MS shall act on the received GA-RRC ACTIVATE CHANNEL message indicating
the CS domain as follows:
\- for each CTC specified in the IE \"CTC Activation List\":
\- store the RAB ID;
\- if the IE \"RAB Configuration\" indicates that the CTC is for AMR or AMR-WB
speech, use the format specified in Annex A.1 and Annex D to code and decode
the RTP packets;
\- if the IE \"RAB Configuration\" indicates that the CTC is for circuit
switched data, use the format specified in Annex A.2 to code and decode the
RTP packets;
\- use the value indicated by the IE \"Sample Size\" as the minimum sample
size for the coding and decoding of the RTP packets, if the MS is not able to
use the indicated value. If the circuit transport channel is for AMR or AMR-WB
speech with RTP redundancy, the sample size is defined as the size of the new
speech sample in each RTP packet, not including any redundant speech samples;
\- configure the uplink RTP packets to be transmitted to the UDP port and IP
address identified by the IE \"RTP UDP Port\" and the IE \"GANC IP address\",
respectively;
\- use the Payload Type included in the IE \"Payload Type\" for the PT field
in the RTP header for the RTP packets;
\- if received, use the configuration included in the IE \"Multi-rate
Configuration 2\" for the circuit transport channel that is for AMR or AMR-WB
speech;
\- if received, use the configuration included in the IE \"RTP Redundancy
Configuration\" for the circuit transport channel that is for AMR or AMR-WB
speech. The redundancy policy is defined for each of the AMR modes specified
in the IE \"Multi-rate Configuration 2\". The level of redundancy can span
from no redundancy to double redundancy. In the same active codec set, a lower
codec mode shall not be associated with a lower redundancy level then a higher
codec mode. For example, the highest mode in the set is used with no
redundancy, the next lower with single redundancy and rest of the modes with
double redundancy.
\- if received, pass the contents of the NAS Synchronisation Indicator to
upper layers.
On completing the above procedure, the MS shall:
\- start timer TU5911 for the CS domain;
\- transmit a GA-RRC ACTIVATE CHANNEL ACK message including the IE \"CN Domain
Identity\" and the IE \"CTC Activation Ack List\". For each CTC specified in
the IE \"CTC Activation Ack List\":
\- include the IE \"RAB ID\" for the CTC with the same value as received in
the GA-RRC ACTIVATE CHANNEL message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each CTC that is successfully configured (i.e., GA-RRC Cause value is
\'0\'):
\- include the allocated UDP port number in the IE \"RTP UDP Port\" for the
downlink RTP packets to be sent from the GANC to the MS;
\- include the selected RTP sample size, to be used for uplink and downlink
RTP packets, in the IE \"Sample Size\";
\- include the Payload Type in the IE \"Payload Type\";
\- if the IE \"RTCP UDP Port\" was received in the GA-RRC ACTIVATE CHANNEL
message and the MS is capable of supporting RTCP, activate the uplink RTCP
stream and include the IE \"RTCP UDP Port\" for the downlink RTCP packets to
be sent from the GANC to the MS.
#### 8a.4.1.3 Reception of GA-RRC ACTIVATE CHANNEL ACK (CS domain) by GANC
On reception of the GA-RRC ACTIVATE CHANNEL ACK message indicating the CS
domain, the GANC shall configure itself for transmission of RTP packets to the
\"RTP UDP Port\" indicated in the message and RTCP packets to the \"RTCP UDP
Port\" indicated in the message (if included) for each successfully activated
CTC, and transmit a GA-RRC ACTIVATE CHANNEL COMPLETE message to the MS.
To enable downlink quality measurements in the MS, the GANC shall send at
least one RTP frame each 480 ms for each active CTC. During periods of
discontinuous transmission (DTX), if the CTC is for AMR or AMR-WB speech, each
RTP frame transmitted by the GANC shall bear a format in the AMR/AMR-WB
payload Table of Contents that either (a) omits all NO_DATA indications and
contains only the next AMR speech or SID frame that is available, or (b)
includes a single NO_DATA frame should no AMR speech or SID frame become
available for 480 ms. The RTP timestamp shall indicate the time of that speech
or SID or NO_DATA frame. See Section A.1.2 of Annex A for examples.
#### 8a.4.1.4 Reception of GA-RRC ACTIVATE CHANNEL COMPLETE (CS domain) by MS
On reception of the GA-RRC ACTIVATE CHANNEL COMPLETE message indicating the CS
domain, the MS shall stop timer TU5911 for the CS domain and consider the
successfully activated CTC(s) to be available for use by upper layers. To
enable uplink quality measurements in the GANC, the MS shall send at least one
RTP frame each 480 ms for each active CTC. During periods of discontinuous
transmission (DTX), each RTP frame transmitted by the MS shall bear a format
in the AMR/AMR-WB payload Table of Contents that either (a) omits all NO_DATA
indications and contains only the next AMR speech or SID frame that is
available, or (b) includes a single NO_DATA frame should no AMR speech or SID
frame become available for 480 ms. The RTP timestamp shall indicate the time
of that speech or SID or NO_DATA frame. See Section A.1.2 of Annex A for
examples.
### 8a.4.2 Packet transport channel activation
#### 8a.4.2.1 Initiation of packet transport channel activation
The following is the possible trigger for initiation of the packet transport
channel activation procedure:
\- If the MS is in the GA-RRC-CONNECTED state for the PS domain and the GANC
receives the RAB Assignment Request message from the SGSN.
One or more packet transport channels may be activated using a single instance
of the channel activation procedure; however, it is not possible to activate
both circuit and packet transport channels using a single instance of the
channel activation procedure.
The GANC begins the activation of the PTC(s) by transmitting the GA-RRC
ACTIVATE CHANNEL message to the MS. The message contains the IE \"CN Domain
Identity\" (indicating PS domain) and IE \"PTC Activation List\" which
includes the parameters necessary to describe each packet transport channel.
#### 8a.4.2.2 Reception of GA-RRC ACTIVATE CHANNEL (PS domain) by the MS
The MS shall act on the received GA-RRC ACTIVATE CHANNEL message indicating
the PS domain as follows:
\- for each PTC specified in the IE \"PTC Activation List\":
\- store the RAB ID;
\- allocate local PTC resources based on the values in the IE \"RAB
Configuration\";
\- use the TEID value included in the IE \"GANC TEID\" for the TEID field in
the GA-RRC PDU messages to be sent to the GANC;
\- use the TEID value included in the IE \"MS TEID\" to verify the TEID field
in the GA-RRC PDU messages to be received from the GANC;
\- configure the uplink GA-RRC PDU messages to be transmitted to the UDP port
and IP address identified by the IE \"GANC UDP Port\" and the IE \"GANC IP
address\", respectively.
On completing the above procedure, the MS shall:
\- start timer TU5911 for the PS domain;
\- transmit a GA-RRC ACTIVATE CHANNEL ACK message including the IE \"CN Domain
Identity\" and the IE \"PTC Activation Ack List\". For each PTC specified in
the IE \"PTC Activation Ack List\":
\- include the IE \"RAB ID\" for the PTC with the same value as received in
the GA-RRC ACTIVATE CHANNEL message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each PTC that is successfully configured (i.e., GA-RRC Cause value is
\'0\'):
\- include the allocated UDP port number in the IE \"MS UDP Port\" for the
downlink GA-RRC PDU messages to be sent from the GANC to the MS.
#### 8a.4.2.3 Reception of GA-RRC ACTIVATE CHANNEL ACK (PS domain) by GANC
On reception of the GA-RRC ACTIVATE CHANNEL ACK message indicating the PS
domain, the GANC shall configure itself for transmission of GA-RRC PDU
messages to the \"MS UDP Port\" indicated in the message for each successfully
activated PTC, and transmit a GA-RRC ACTIVATE CHANNEL COMPLETE message to the
MS.
#### 8a.4.2.4 Reception of GA-RRC ACTIVATE CHANNEL COMPLETE (PS domain) by MS
On reception of the GA-RRC ACTIVATE CHANNEL COMPLETE message indicating the PS
domain, the MS shall stop timer TU5911 for the PS domain, and start timer
TU4001 for each of the successfully activated PTC(s) which are now available
for use by upper layers.
## 8a.5 GA-RRC connection release
### 8a.5.1 GA-RRC connection release request by MS
If the MS needs to release the GA-RRC connection and signalling connection to
a particular CN domain, it shall send the GA-RRC RELEASE REQUEST message to
the GANC and start timer TU5909 for the domain. The MS shall include the IE
\"CN Domain Identity\" and the IE \"GA-RRC Cause\". The GA-RRC Cause value
shall be one of the following:
#40: UE generated signalling connection release
#115: unspecified failure
Figure 8a.5.1.1 GA-RRC connection release request by MS
### 8a.5.2 Reception of GA-RRC RELEASE REQUEST by GANC
When the GANC receives the GA-RRC RELEASE REQUEST message, it shall request
the selected CN domain to release the Iu connection for the MS, including all
active RABs for that domain. The GANC selects the CN domain based on the value
of the received IE \"CN Domain Identity\".
### 8a.5.3 Initiation of GA-RRC connection release by GANC
The GANC initiates the GA-RRC connection release procedure to command the MS
to release the GA-RRC connection and any user plane resources for a particular
domain and instruct the GA-RRC sub-layer entity of the MS to leave the GA-RRC-
CONNECTED state and return to the GA-RRC-IDLE state for the domain. The GANC
normally initiates this procedure when it receives the Iu Release Command from
the CN; however, the GANC may also initiate this procedure under certain
failure conditions.
Figure 8a.5.3.1 GA-RRC connection release, normal flow
The GANC initiates the GA-RRC connection release procedure by sending the GA-
RRC RELEASE message to the MS.
The GA-RRC RELEASE message includes the IE \"GA-RRC Cause\". The GA-RRC Cause
value should be one of the following:
#83: normal release; e.g., at the end of a call
#115: unspecified failure
Other values, if received, should be treated as \"unspecified failure\".
### 8a.5.4 Reception of GA-RRC RELEASE by MS
When the GA-RRC sublayer entity in the MS receives the GA-RRC RELEASE message,
it shall:
\- send a GA-RRC RELEASE COMPLETE message to the GANC,
\- release the GA-RRC connection and any user plane resources for the
indicated domain,
\- stop timer TU5002 for the domain (if running) (see sub-clause 8a.8),
\- stop timer TU5909 for the domain (if running), and
\- enter the GA-RRC-IDLE state for the domain.
### 8a.5.5 Failure cases
#### 8a.5.5.1 Timer TU5909 expiry
If timer TU5909 expires in the MS, the GA-RRC sublayer entity in the MS shall
release the GA-RRC connection and any user plane resources and enter the GA-
RRC-IDLE state for the domain associated with the TU5909 timer.
## 8a.6 Security mode control
The security mode control procedure is used by the network to set the security
mode; i.e., the settings for integrity protection and encryption, including
the algorithms to use. This information is not used when GA-RRC is the serving
entity in the MS, but shall be stored in the MS for possible future use after
a handover from GAN Iu mode to UTRAN during the same upper layer transaction
(i.e., the UTRAN RRC layer becomes the serving entity during this upper layer
transaction).
The security mode control procedure also proves that the MS identity that is
authenticated to the GANC is the same as the MS identity authenticated to the
core network.
The security mode control procedure applies only for a MS in the GA-RRC-
CONNECTED state for either the CS domain or the PS domain.
The security mode control procedure is always triggered by the network.
Figure 8a.6.1 Security mode control, normal flow
### 8a.6.1 Security mode control initiation
The GANC initiates the security mode control procedure by sending a GA-RRC
SECURITY MODE COMMAND message to the MS. This message includes the IE
\"Selected Integrity Protection Algorithm\", the IE \"Selected Encryption
Algorithm\" (optional), and the IE \"Random Number\". The GANC selects the
algorithms based on the permitted algorithms received from the CN and the MS
security capabilities indicated in the IE \"3G Security Capability\" received
from the MS in the GA-RC REGISTER REQUEST message.
### 8a.6.2 Security mode control completion
Whenever the MS receives a valid GA-RRC SECURITY MODE COMMAND message, it
shall, if a (U)SIM is present and considered valid and the key set identifier
(KSI) stored on the (U)SIM indicates that an integrity key and cipher key are
available for the domain indicated in the IE \"CN Domain Identity\", store the
selected integrity protection algorithm and (if received) the selected
encryption algorithm for possible future use after a handover from GAN Iu mode
to UTRAN during the same upper layer transaction. If handover from GAN Iu mode
to UTRAN occurs, encryption is enabled if the IE "Selected Encryption
Algorithm" is present in the message and disabled otherwise.
The MS shall also calculate a MAC (Message Authentication Code). The MAC shall
be calculated over the following data:
RAND \| IMSI
using \"HMAC-SHA1-96\" algorithm, as specified in [24] with the integrity key
(IK) for the domain indicated in the IE \"CN Domain Identity\" used as the
authentication key.
In the formulas above, the \"\|\" character denotes concatenation. RAND is the
16-octet random number received from the GANC in the GA-RRC SECURITY MODE
COMMAND message. IMSI is the MS IMSI, in the same format as defined for the
Mobile Identity IE as defined in [8]; i.e. as a variable-length sequence of
digits in BCD format (e.g. the IMSI \"123456789098765\" is encoded as the
following octets (in hexadecimal): \"21 43 65 87 09 89 67 F5\"). Network byte
order is used.
The IK key is the IK that has been derived during the last authentication for
the domain indicated in the IE \"CN Domain Identity\". The length of the MAC
is 12 octets.
When the appropriate action on the GA-RRC SECURITY MODE COMMAND message has
been taken, the MS sends a GA-RRC SECURITY MODE COMPLETE message to the GANC.
The MS includes the calculated MAC value in the IE \"Ciphering Command MAC\".
## 8a.7 Transport channel modification
There are two versions of the transport channel modification procedure, the
circuit transport channel modification procedure and the packet transport
channel modification procedure. As illustrated in the following sub-clauses,
these two procedures use the same messages and the same basic message flows
(as illustrated in the following figure), but differ in the content of the
messages.
Figure 8a.7.1 Transport channel modification, normal flow
### 8a.7.1 Circuit transport channel modification
#### 8a.7.1.1 Initiation of circuit transport channel modification
The GANC initiates the circuit transport channel (CTC) modification procedure
when it determines that one or more active CTCs require modification; e.g.,
based on information received from the MSC in the RAB Assignment Request
message or based on local GANC logic.
The following CTC parameters may be modified:
\- RAB Configuration
\- Sample Size
\- GANC RTP UDP Port
\- GANC IP Address
\- Multi-rate Configuration 2
\- RTP Redundancy Configuration
\- GANC RTCP UDP Port
\- NAS Synchronisation Indicator
The GANC only includes the IEs which specify modifications to the existing CTC
parameters.
One or more CTCs may be modified using a single instance of the channel
modification procedure; however, it is not possible to modify both circuit and
packet transport channels using a single instance of the channel modification
procedure.
The GANC begins the modification of the CTC(s) by transmitting the GA-RRC
MODIFY CHANNEL message to the MS. The message contains the IE \"CN Domain
Identity\" (indicating CS domain) and IE \"CTC Modification List\" which
includes the parameters necessary to describe the modifications to each
circuit transport channel.
#### 8a.7.1.2 Reception of GA-RRC MODIFY CHANNEL (CS domain) by the MS
On receipt of the GA-RRC MODIFY CHANNEL message indicating the CS domain, the
MS shall process the specified CTC modifications.
On completion of the modification of the CTC(s), the MS shall:
\- transmit a GA-RRC MODIFY CHANNEL ACK message including the IE \"CN Domain
Identity\" and the IE \"CTC Modification Ack List\". For each CTC specified in
the IE \"CTC Modification Ack List\":
\- include the IE \"RAB ID\" for the CTC with the same value as received in
the GA-RRC MODIFY CHANNEL message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each CTC that is successfully modified (i.e., GA-RRC Cause value is
\'0\'):
\- include the modified parameter values currently used by the MS.
When the MS has sent the GA-RRC MODIFY CHANNEL ACK message, it shall start
transmitting RTP packets based on the successful parameter modifications. The
MS shall be able to receive RTP packets with the old parameters until the MS
determines that the first RTP packet using the new parameters has been
received.
#### 8a.7.1.3 Reception of GA-RRC MODIFY CHANNEL ACK (CS domain) by GANC
On reception of the GA-RRC MODIFY CHANNEL ACK message indicating the CS
domain, the GANC shall configure itself for transmission of RTP packets to the
MS using the new parameter values for the successfully modified CTC(s). The
GANC shall be able to receive RTP packets with the old parameters until the
GANC determines that the first RTP packet using the new parameters has been
received.
### 8a.7.2 Packet transport channel modification
#### 8a.7.2.1 Initiation of packet transport channel modification
The GANC initiates the packet transport channel (PTC) modification procedure
when it determines that one or more active PTCs require modification; e.g.,
based on information received from the SGSN in the RAB Assignment Request
message or based on local GANC logic.
The following PTC parameters may be modified:
\- RAB Configuration
\- GANC UDP Port
\- GANC IP Address
The GANC only includes the IEs which specify modifications to the existing PTC
parameters.
One or more PTCs may be modified using a single instance of the channel
modification procedure; however, it is not possible to modify both circuit and
packet transport channels using a single instance of the channel modification
procedure.
The GANC begins the modification of the PTC(s) by transmitting the GA-RRC
MODIFY CHANNEL message to the MS. The message contains the IE \"CN Domain
Identity\" (indicating PS domain) and IE \"PTC Modification List\" which
includes the parameters necessary to describe the modifications to each packet
transport channel.
#### 8a.7.2.2 Reception of GA-RRC MODIFY CHANNEL (PS domain) by the MS
On receipt of the GA-RRC MODIFY CHANNEL message indicating the PS domain, the
MS shall process the specified PTC modifications.
On completion of the modification of the PTC(s), the MS shall:
\- transmit a GA-RRC MODIFY CHANNEL ACK message including the IE \"CN Domain
Identity\" and the IE \"PTC Modification Ack List\". For each PTC specified in
the IE \"PTC Modification Ack List\":
\- include the IE \"RAB ID\" for the PTC with the same value as received in
the GA-RRC MODIFY CHANNEL message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each PTC that is successfully modified (i.e., GA-RRC Cause value is
\'0\'):
\- include the modified parameter values currently used by the MS.
When the MS has sent the GA-RRC MODIFY CHANNEL ACK message, it shall start
transmitting GA-RRC PDU messages based on the successful parameter
modifications. The MS shall be able to receive GA-RRC PDU messages with the
old parameters until the MS determines that the first GA-RRC PDU message using
the new parameters has been received.
#### 8a.7.2.3 Reception of GA-RRC MODIFY CHANNEL ACK (PS domain) by GANC
On reception of the GA-RRC MODIFY CHANNEL ACK message indicating the PS
domain, the GANC shall configure itself for transmission of GA-RRC PDU
messages to the MS using the new parameter values for the successfully
modified PTC(s). The GANC shall be able to receive GA-RRC PDU messages with
the old parameters until the GANC determines that the first GA-RRC PDU message
using the new parameters has been received.
## 8a.8 Transport channel deactivation
### 8a.8.1 Transport channel deactivation request by MS
If the MS needs to deactivate one or more transport channels for a particular
domain, it shall send the GA-RRC DEACTIVATE CHANNEL REQUEST message to the
GANC and start timer TU5002 for the domain. The MS shall include the IE \"CN
Domain Identity\" and the IE \"GA-RRC Cause\". The GA-RRC Cause value shall be
one of the following:
#0: normal release (e.g., due to inactivity timer timeout)
#115: unspecified failure
Figure 8a.8.1 Transport channel deactivation request by MS
### 8a.8.2 Reception of GA-RRC DEACTIVATE CHANNEL REQUEST by GANC
When the GANC receives the GA-RRC DEACTIVATE CHANNEL REQUEST message, it shall
request the selected CN domain to release the identified RABs associated with
the MS. The GANC selects the CN domain based on the value of the received IE
\"CN Domain Identity\". Note that the GANC may also request the selected CN
domain to release the Iu connection for the MS in this case, based on local
policy settings.
### 8a.8.3 Initiation of transport channel deactivation by GANC
The GANC normally initiates this procedure when it receives the RAB Assignment
message from the CN indicating RAB release; however, the GANC may also
initiate this procedure under certain failure conditions.
Figure 8a.8.3 Transport channel deactivation, normal flow
One or more circuit or packet transport channels may be deactivated using a
single instance of the channel deactivation procedure; however, it is not
possible to deactivate both circuit and packet transport channels using a
single instance of the channel deactivation procedure.
The GA-RRC DEACTIVATE CHANNEL message includes the IE \"GA-RRC Cause\" with
value as follows:
#0: normal event, e.g. deactivate due to RAB release request from CN
#115: unspecified failure
#10: relocation cancelled (e.g., the handover procedure is stopped because the
call has been cleared)
### 8a.8.4 Reception of GA-RRC DEACTIVATE CHANNEL by MS
When the MS receives the GA-RRC DEACTIVATE CHANNEL message, it shall:
\- deactivate the CTC(s) or PTC(s) identified in the IE \"RAB ID List\";
\- send a GA-RRC DEACTIVATE CHANNEL COMPLETE message to the GANC.
### 8a.8.5 Failure cases
#### 8a.8.5.1 Timer TU5002 expiry
If timer TU5002 expires in the MS, the MS shall release the associated
transport channel(s).
## 8a.9 PS domain user plane data transfer
When the corresponding GA-RRC PTC has been activated, both the MS and the GANC
can transfer PS domain user data using the GA-RRC PDU message as illustrated
in the following figure:
Figure 8a.9.1 GA-RRC PS domain user data transfer
### 8a.9.1 MS initiates uplink PS domain user plane data transfer
Assuming that the GA-RRC PTC associated with the identified RAB has been
activated as specified in sub-clause 8a.4.2, the MS is able to immediately
forward any uplink PS domain user data packets for the RAB to the GANC using
the PTC. Upon request from the upper layers to transfer an uplink PS domain
user data packet associated with a RAB to the GANC, the PS domain GA-RRC
sublayer entity in the MS shall restart the TU4001 timer for the PTC,
encapsulate the complete PS domain user data packet within a GA-RRC PDU
message, and send the GA-RRC PDU message to the GANC using the associated GA-
RRC PTC.
If sequencing has been activated for the PTC (i.e., Delivery Order is
requested in the IE \"RAB Configuration\" associated with the PTC), the MS
shall include GA-RRC PDU sequence number information in the GA-RRC PDU message
sent to the GANC using the PTC. The GA-RRC PDU sequence number information
handling is specified in sub-clause 11.1.3b.2.
Note: The GTP-U G-PDU messages from the CN may include GTP-U sequence number
information even though Delivery Order is not requested in the RAB Assignment
(e.g., the GGSN implementation may always include GTP-U sequence number
information). However, GTP-U messages from the GANC to the CN may not include
sequence number information in this case (i.e., even though sequence number
information is included from CN to GANC).
### 8a.9.2 Processing of the received GA-RRC PDU message by the GANC
Upon receiving the GA-RRC PDU message from the MS, the GANC shall relay the
GA-RRC PDU payload within a GTP-U G-PDU message to the SGSN via the Iu-ps
interface using the GTP-U protocol as defined in [53].
Note that all uplink GA-RRC PDU messages sent by the MS terminate at the GANC.
### 8a.9.3 GANC initiates downlink PS domain user plane data transfer
Assuming that the GA-RRC PTC associated with the identified RAB has been
activated as specified in sub-clause 8a.4.2, the GANC is able to immediately
forward any downlink PS domain user data packets for the RAB to the MS using
the PTC. Upon receiving a downlink GTP-U G-PDU message for the MS from the CN,
the GANC shall relay the GTP-U G-PDU payload within a GA-RRC PDU message to
the MS using the associated GA-RRC PTC.
### 8a.9.4 Processing of the received GA-RRC PDU message by the MS
Upon receiving the GA-RRC PDU message from the GANC, the MS shall restart the
TU4001 timer for the PTC, extract the received PS domain user data packet and
forward the contents to the upper layers in the MS via the PDCP SAP as per
standard UMTS.
If sequencing has been activated for the PTC, the MS shall increment the
expected downlink GA-RRC PDU sequence number for each GA-RRC PDU message
received from the GANC using the PTC.
Note that all downlink GA-RRC PDU messages received by the MS are sent from
the GANC.
### 8a.9.5 Abnormal Cases
#### 8a.9.5.1 TU4001 timer expiry
If timer TU4001 expires, the MS shall request deactivation of the PTC as
specified in sub-clause 8a.8.1.
#### 8a.9.5.2 GANC receives a GA-RRC PDU message while the GA-RRC PTC
activation procedure is in progress
Upon receiving an uplink GA-RRC PDU message while the GA-RRC PTC activation
procedure for the PTC is in progress, the GANC will process the request as if
the GA-RRC PTC was active.
#### 8a.9.5.3 GANC receives a GA-RRC PDU message and the GA-RRC PTC is not
active
Upon receiving an uplink GA-RRC PDU message that is associated with a GA-RRC
PTC that does not exist, the GANC shall discard the message and initate PTC
deactivation as defined in sub-clause 8a.8.
#### 8a.9.5.4 Handling of out-of-sequence packets
Packets received out-of-sequence by the MS shall be processed as described in
sub-clause 11.1.3b.2.
#### 8a.9.5.5 MS receives a GA-RRC PDU message while the GA-RRC PTC activation
procedure is in progress
Upon receiving a downlink GA-RRC PDU message before sending the response to a
received PTC activation request, the MS shall queue the received GA-RRC PDU
message and process the message immediately after completing the PTC
activation.
#### 8a.9.5.6 Uplink PS domain user data transfer failed due to lower layer
failure
If a lower layer failure is detected while attempting to send an uplink PS
domain user data packet, the MS shall declare the procedure as failed and send
the corresponding indication to upper layers.
## 8a.10 Handover to GAN Iu mode
The handover to GAN Iu mode procedure is applicable when the MS is in the GA-
RC-REGISTERED state.
The preparation phase of the handover to GAN Iu mode procedure is normally
initiated when the GANC sends the GA-RRC RELOCATION REQUEST message to the MS,
as illustrated in Figure 8a.10.1.
The exception is when the GANC receives a Relocation Request message that does
not include the IMSI parameter from a MSC. This exception case is described in
sub-clause 8a.10.5.
Figure 8a.10.1: Handover to GAN Iu mode, successful case
### 8a.10.1 Reception of GA-RRC RELOCATION REQUEST by the MS
The GA-RRC RELOCATION REQUEST message contains the IE \"CN Domains to
Handover\" indicating the CS domain, the PS domain or both CS and PS domains.
If the CS domain or both CS and PS domains is indicated, the message includes
the IE \"CTC Activation List\". If the PS domain or both CS and PS domains is
indicated, the message includes the IE \"PTC Activation List\".
The MS shall act on the received GA-RRC RELOCATION REQUEST message containing
the IE \"CTC Activation List\" as follows:
\- for each CTC specified in the IE \"CTC Activation List\":
\- store the RAB ID;
\- if the IE \"RAB Configuration\" indicates that the CTC is for AMR or AMR-WB
speech, use the format specified in Annex A.1 and Annex D to code and decode
the RTP packets;
\- if the IE \"RAB Configuration\" indicates that the CTC is for circuit
switched data, use the format specified in Annex A.2 to code and decode the
RTP packets;
\- use the value indicated by the IE \"Sample Size\" as the minimum sample
size for the coding and decoding of the RTP packets, if the MS is not able to
use the indicated value. If the circuit transport channel is for AMR or AMR-WB
speech with RTP redundancy, the sample size is defined as the size of the new
speech sample in each RTP packet, not including any redundant speech samples;
\- configure the uplink RTP packets to be transmitted to the UDP port and IP
address identified by the IE \"RTP UDP Port\" and the IE \"GANC IP address\",
respectively;
\- use the Payload Type included in the IE \"Payload Type\" for the PT field
in the RTP header for the RTP packets;
\- if received, use the configuration included in the IE \"Multi-rate
Configuration 2\" for the circuit transport channel that is for AMR or AMR-WB
speech;
\- if received, use the configuration included in the IE \"RTP Redundancy
Configuration\" for the circuit transport channel that is for AMR or AMR-WB
speech. The redundancy policy is defined for each of the AMR modes specified
in the IE \"Multi-rate Configuration 2\". The level of redundancy can span
from no redundancy to double redundancy. In the same active codec set, a lower
codec mode shall not be associated with a lower redundancy level then a higher
codec mode. For example, the highest mode in the set is used with no
redundancy, the next lower with single redundancy and rest of the modes with
double redundancy.
\- if received, pass the contents of the NAS Synchronisation Indicator to
upper layers.
The MS shall act on the received GA-RRC RELOCATION REQUEST message containing
the IE \"PTC Activation List\" as follows:
\- for each PTC specified in the IE \"PTC Activation List\":
\- store the RAB ID;
\- allocate local PTC resources based on the values in the IE \"RAB
Configuration\";
\- use the TEID value included in the IE \"GANC TEID\" for the TEID field in
the GA-RRC PDU messages to be sent to the GANC;
\- use the TEID value included in the IE \"MS TEID\" to verify the TEID field
in the GA-RRC PDU messages to be received from the GANC;
\- configure the uplink GA-RRC PDU messages to be transmitted to the UDP port
and IP address identified by the IE \"GANC UDP Port\" and the IE \"GANC IP
address\", respectively.
On completing the above procedures, the MS shall:
\- transmit a GA-RRC RELOCATION REQUEST ACK message including the IE \"CN
Domains to Handover\" with value the same as received in the GA-RRC RELOCATION
REQUEST message. If the CS domain or both CS and PS domains is indicated, the
message shall include the IE \"CTC Activation Ack List\". If the PS domain or
both CS and PS domains is indicated, the message shall include the IE \"PTC
Activation Ack List\".
\- For each CTC specified in the IE \"CTC Activation Ack List\" (if included):
\- include the IE \"RAB ID\" for the CTC with the same value as received in
the GA-RRC RELOCATION REQUEST message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each CTC that is successfully configured (i.e., GA-RRC Cause value is
\'0\'):
\- include the allocated UDP port number in the IE \"RTP UDP Port\" for the
downlink RTP packets to be sent from the GANC to the MS;
\- include the selected RTP sample size, to be used for uplink and downlink
RTP packets, in the IE \"Sample Size\";
\- include the Payload Type in the IE \"Payload Type\";
\- if the IE \"RTCP UDP Port\" was received in the GA-RRC RELOCATION REQUEST
message and the MS is capable of supporting RTCP, activate the uplink RTCP
stream and include the IE \"RTCP UDP Port\" for the downlink RTCP packets to
be sent from the GANC to the MS.
\- For each PTC specified in the IE \"PTC Activation Ack List\" (if included):
\- include the IE \"RAB ID\" for the PTC with the same value as received in
the GA-RRC RELOCATION REQUEST message in the IE \"RAB ID\";
\- include the IE \"GA-RRC Cause\" indicating either success (i.e., value
\'0\') or a failure cause value;
\- for each PTC that is successfully configured (i.e., GA-RRC Cause value is
\'0\'):
\- include the allocated UDP port number in the IE \"MS UDP Port\" for the
downlink GA-RRC PDU messages to be sent from the GANC to the MS.
After transmitting the GA-RRC RELOCATION REQUEST ACK message to the GANC, the
GA-RRC sub-layer entity (if only one of CS and PS domains is subject to
handover) or entities (if both CS and PS domains are subject to handover) in
the MS transitions to the GA-RRC CONNECTED state.
### 8a.10.2 Reception of GA-RRC RELOCATION REQUEST ACK by the GANC
On reception of the GA-RRC RELOCATION REQUEST ACK message, the GANC shall do
the following:
\- If the IE \"CN Domains to Handover\" indicates either the CS domain or both
domains, the GANC shall configure itself for transmission of RTP packets to
the \"RTP UDP Port\" indicated in the message and RTCP packets to the \"RTCP
UDP Port\" indicated in the message (if included) for each successfully
activated CTC.
\- If the IE \"CN Domains to Handover\" indicates either the PS domain or both
domains, the GANC shall configure itself for transmission of GA-RRC PDU
messages to the \"MS UDP Port\" indicated in the message for each successfully
activated PTC.
\- The GANC then continues with the relocation preparation process with the
CN.
### 8a.10.3 Normal execution
The normal execution phase of the handover to GAN Iu mode procedure is
initiated when the source radio access technology (e.g. GERAN or UTRAN) orders
the MS to handover (GERAN) or relocate (UTRAN) to GAN Iu mode.
\- The exception is when the GANC receives a Relocation Request message that
does not include the IMSI parameter from a MSC. This exception case is
described in sub-clause 8a.10.5.
The execution procedure is applicable when the MS is in the GA-RC-REGISTERED
state provided the conditions described in Annex C.2: \"(Source-RAT)
Measurement Report for Handover and Cell Change Order to GAN Iu mode\" are
met.
The handover order in GERAN is sent via the INTER SYSTEM TO UTRAN HANDOVER
COMMAND message which contains a HANDOVER TO UTRAN message. The handover order
in UTRAN is sent via the PHYSICAL CHANNEL RECONFIGURATION message. If the
UARFCN and PSC parameters included in either of the HANDOVER TO UTRAN message
or the PHYSICAL CHANNEL RECONFIGURATION message (both are specified in [40])
match those of the GAN Iu mode cell, the MS shall:
\- send a GA-RRC RELOCATION COMPLETE message to the GANC;
\- in the case of PS domain handover, start timer TU4001 for each of the
successfully activated PTC(s);
\- switch the serving RR to GAN Iu mode; i.e. attach the GA-RRC sub-layer
entities to the RR-SAP.
### 8a.10.4 Reception of GA-RRC RELOCATION COMPLETE by the GANC
On reception of the GA-RRC RELOCATION COMPLETE message, the GANC shall
indicate handover detection and completion to the CN.
### 8a.10.5 Exception case: No IMSI in CS domain Relocation Request
The following exception procedures are applicable if the handover is for the
CS domain only and the GANC did not receive the IMSI parameter in the
Relocation Request message from the MSC. The procedure is illustrated in
Figure 8a.10.5.
Figure 8a.10.5: Handover to GAN Iu mode, exception case
In this case, the MS will not receive the GA-RRC RELOCATION REQUEST message
from the GANC before receiving the handover order from the source radio access
technology, as described in sub-clause 8a.10.3.
If the UARFCN and PSC parameters included in either of the HANDOVER TO UTRAN
message or the PHYSICAL CHANNEL RECONFIGURATION message match those of the GAN
Iu mode cell, the GA-RRC CS domain sub-layer entity in the MS shall:
\- if the handover is not for a signalling channel only, the MS shall:
\- send a GA-RRC RELOCATION ACCESS message to the network including the
complete UTRAN RRC handover command message in the IE \"UTRAN RRC Message\"
and enter the GA-RRC-CONNECTED state for the CS domain (Note: The MS shall
extract the UTRAN RRC _Handover to UTRAN Command_ message from the GERAN RRC
Handover to UTRAN Command IE that is present in the GERAN RRC _Inter System to
UTRAN Command_ message);
\- start timer TU3920;
\- otherwise, the MS shall:
\- immediately send a GA-RRC RELOCATION COMPLETE message to the GANC;
\- enter the GA-RRC-CONNECTED state for the CS domain;
\- switch the serving RR to GAN Iu mode; i.e. attach the GA-RRC sub-layer
entities to the RR-SAP.
On receipt of the GA-RRC RELOCATION ACCESS message, the GANC shall initiate
CTC activation as specified in sub-clause 8a.4.1.
On receipt of the GA-RRC ACTIVATE CHANNEL COMPLETE message, the MS shall:
\- stop timer TU3920;
\- send a GA-RRC RELOCATION COMPLETE message to the GANC;
\- switch to GAN Iu mode; i.e. attach the GA-RRC sub-layer entities to the RR-
SAP.
On reception of the GA-RRC RELOCATION COMPLETE message, the GANC shall
indicate handover detection and completion to the CN.
If the CTC activation procedure fails or the timer TU3920 expires before CTC
activation is completed, the MS shall:
\- terminate the procedure including release of the associated GA-RRC
resources;
\- resume the connection in the source radio access technology used before the
handover;
\- indicate the failure to the source radio access technology.
## 8a.11 Handover from GAN Iu mode
The purpose of this procedure is to transfer, upon request from the MS (and
under the control of the GANC), a connection between the MS and the GANC to
another radio access technology (e.g. GERAN or UTRAN).
The procedure is applicable when one or both of the GA-RRC sub-layer entities
in the MS are in GA-RRC-CONNECTED state.
Figure 8a.11.1: Handover from GAN Iu mode, successful case
Figure 8a.11.2: Handover from GAN Iu mode, failure case
### 8a.11.1 Initiation
The procedure may be initiated by the MS based on:
\- local measurements of GAN coverage signal quality;
\- reception of a GA-RRC UPLINK QUALITY INDICATION message indicating poor
uplink quality in the _UL Quality Indication_ IE; If the UL Quality Indication
IE indicates \"Network problem\" a handover out to GERAN or UTRAN should be
attempted. In case the UL Quality Indication information element shows \"Radio
problem\" or \"Undetermined problem\" a search for a new access point should
be done before the handover out is initiated;
\- reception of RTCP packets indicating poor uplink quality (i.e., in the CS
case);
\- excessive loss or delay in the received RTP packets (i.e., in the CS case).
When the MS decides to trigger the handover from GAN Iu mode, it shall:
\- send a GA-RRC RELOCATION INFORMATION message to the GANC including a list
of candidate/ target cell identifiers ranked in order of preference which is
the most recent list available from the other radio access technology (e.g.
GSM RR) and including the received signal strength for each identified GERAN
or UTRAN cell. The MS may include GERAN cells, UTRAN cells or both.
### 8a.11.2 Reception of GA-RRC RELOCATION INFORMATION by the GANC
The GANC should signal the need for handover to the CN.
If the CN grants the handover request, the GANC should send a GA-RRC
RELOCATION COMMAND message to the MS.
The GA-RRC RELOCATION COMMAND message should only indicate a target cell which
was reported by the MS in the GA-RRC RELOCATION INFORMATION message.
### 8a.11.3 Reception of GA-RRC RELOCATION COMMAND by the MS
The MS shall:
\- suspend all NAS layer signalling transmissions;
\- start the connection establishment to the target radio access technology
(e.g. GERAN or UTRAN) by using the contents of the IE \"UTRAN RRC Message\".
This message carries information about the candidate/ target cell identifier
and radio parameters relevant for the target radio access technology.
A MS with simultaneously active PS and CS sessions in GAN Iu mode shall follow
the procedure as outlined in [40] when it switches to the target cell.
NOTE: The requirements concerning the establishment of the radio connection
towards the target radio access technology (e.g. GERAN) and the signalling
procedure are outside of the scope of this specification.
### 8a.11.4 Successful completion of the handover from GAN Iu mode
Upon successfully completing the handover from GAN Iu mode, the GANC should:
\- release all radio resources associated with the GAN connection.
Upon successfully completing the handover from GAN Iu mode, the MS shall:
\- switch to the target radio access technology (e.g. GERAN or UTRAN) mode;
i.e. detach the GA-RRC sub-layer entities from the RR-SAP;
\- enter the GA-RC-REGISTERED state (but in GERAN/UTRAN mode).
NOTE: The release of the GAN radio resources is initiated from the target RAT.
The MS may deregister from the GANC (as defined in sub-clause 6.4) after
successfully completing the handover. If the MS chooses to deregister from the
GANC, it may do so either immediately after successfully completing the
handover or after sending the GA-RRC RELEASE COMPLETE message to the GANC in
response to the GA-RRC RELEASE message from the GANC.
### 8a.11.5 MS fails to complete requested handover
If the MS does not succeed in establishing a connection to the target radio
access technology, the MS shall:
\- revert back to the GAN Iu mode configuration;
\- return a GA-RRC RELOCATION FAILURE message to the GANC and resume normal
operation as if the GA-RRC RELOCATION COMMAND message has not been received.
The GA-RRC Cause value shall be set to value \'Relocation Failure In Target
CN/RNC Or Target System\' as specified in [52].
### 8a.11.6 Reception of GA-RRC RELOCATION FAILURE by the GANC
The GANC may initiate the release of resources in the target radio access
technology.
### 8a.11.7 Abnormal Cases
If the GA-RRC RELOCATION COMMAND message instructs the MS:
\- to perform a non-supported scenario, or
\- to use a non-supported configuration,
the MS shall return a GA-RRC RELOCATION FAILURE message with GA-RRC Cause
value set to \'Unspecified failure\' or other appropriate cause as defined in
[52] and resume normal operation as if the GA-RRC RELOCATION COMMAND message
has not been received.
# 9 Error handling procedures
## 9.1 General
The procedures specified in this specification apply to those messages which
pass the checks described in this sub-clause.
This sub-clause also specifies procedures for the handling of unknown,
unforeseen, and erroneous protocol data by the receiving entity. These
procedures are called \"error handling procedures\", but in addition to
providing recovery mechanisms for error situations they define a compatibility
mechanism for future extensions of the protocols.
Sub-clauses 9.2 to 9.4 shall be applied in order of precedence.
In this sub-clause the following terminology is used:
\- An IE is defined to be syntactically incorrect in a message if it contains
at least one value defined as \"reserved\" in sub-clause 11, or if its value
part violates rules of clause 11. However it is not a syntactical error that
an IE specifies in its length indicator a greater length than defined in
clause 11.
\- A message is defined to have semantically incorrect contents if it contains
information which, possibly dependent on the state of the receiver, is in
contradiction to the resources of the receiver and/or to the procedural part
of this specification.
The procedures below apply to GA-RC/GA-CSR, GA-PSR, and GA-RRC messages,
unless explicitly specified otherwise. The MS shall use the GA-CSR STATUS
message to indicate problems with the GA-RC and GA-CSR protocols, the GA-PSR
STATUS message to indicate problems with the GA-PSR protocol, and the GA-RRC
STATUS message to indicate problems with the GA-RRC protocol.
## 9.2 Message too short
When a message is received that is too short to contain a complete message
header and all the mandatory information elements, that message shall be
ignored.
## 9.3 Invalid Message Header
If the MS receives a message over UDP with message type not defined or not
implemented, it shall ignore the message.
If the MS receives a message over TCP with protocol discriminator not defined
or not implemented, it shall ignore the message.
If the MS receives a message with Skip Indicator IE not encoded as 0000 or
Length IE greater than 2048, it shall ignore the message.
If the MS receives a message over TCP with message type not defined for the
specific PD (GA-RC/GA-CSR, GA-PSR or GA-RRC) or not implemented, it shall
return a GA-CSR STATUS, GA-PSR STATUS or GA-RRC STATUS message, respectively,
with cause \"message type non-existent or not implemented\".
If the MS receives a message not compatible with the protocol state, the MS
shall ignore the message and shall return a (GA-CSR, GA-PSR or GA-RRC) STATUS
message with cause \"Message type not compatible with protocol state\".
## 9.4 Invalid Information Elements
If the MS receives a GA-RC/GA-CSR, GA-PSR or GA-RRC message with a missing or
syntactically incorrect mandatory IE, the MS shall ignore the message and
shall return a (GA-CSR, GA-PSR or GA-RRC) STATUS message with cause \"Invalid
mandatory information\". In addition, if the message was a GA-CSR RELEASE
message or GA-RRC RELEASE message, the actions taken shall be the same as
specified in sub-clause 7.5 or sub-clause 8a.5, respectively.
The MS shall ignore all unknown IEs in received messages.
The MS shall treat all optional IEs that are syntactically incorrect in a
message as not present in the message.
If the MS diagnoses a missing or unexpected conditional IE or when it receives
at least one syntactically incorrect conditional IE, it shall ignore the
message and shall return a (GA-CSR, GA-PSR or GA-RRC) STATUS message with
cause value \"conditional IE error\".
If the MS receives a message with semantically incorrect contents, it shall
ignore the message and shall return a (GA-CSR, GA-PSR or GA-RRC) STATUS
message with cause value \"semantically incorrect message\".
## 9.5 Handling of lower layer faults
The handling of lower layer failures in the MS while in the GA-RC-DEREGISTERED
state is described in sub-clauses 5.6.2 and 6.2.4.2.
The handling of lower layer failures in the MS while not in the GA-RC-
DEREGISTERED state is described below:
For all lower layer failures in the MS (for example related to DNS, IPsec or
TCP failures other than RST), the MS shall:
\- release the TCP connection towards the current GANC, if established,
\- stop timer TU3906,
\- release the secure connection towards SEGW of the current GANC, if
established, as defined in sub-clause 4.5,
\- start timer TU3905, and
\- enter GA-RC-DEREGISTERED state.
## 9.6 Out of sequence IEs
The MS shall ignore all out of sequence IEs in a message. The network should
take the same approach.
# 10 Message functional definitions and contents
## 10.1 GA-RC and GA-CSR Messages
Table 10.1.1 summarizes the GA-RC and GA-CSR messages.
Table 10.1.1: GA-RC and GA-CSR Messages
* * *
Discovery messages: Reference GA-RC DISCOVERY REQUEST 10.1.2 GA-RC DISCOVERY
ACCEPT 10.1.3 GA-RC DISCOVERY REJECT 10.1.4 Registration messages: Reference
GA-RC REGISTER REQUEST 10.1.5 GA-RC REGISTER ACCEPT 10.1.6 GA-RC REGISTER
REDIRECT 10.1.7 GA-RC REGISTER REJECT 10.1.8 GA-RC DEREGISTER 10.1.9 GA-RC
REGISTER UPDATE UPLINK 10.1.10 GA-RC REGISTER UPDATE DOWNLINK 10.1.11 GA-CSR
connection establishment messages: Reference GA-CSR REQUEST 10.1.12 GA-CSR
REQUEST ACCEPT 10.1.13 GA-CSR REQUEST REJECT 10.1.24 Ciphering messages:
Reference GA-CSR CIPHERING MODE COMMAND 10.1.35 GA-CSR CIPHERING MODE COMPLETE
10.1.36 Traffic Channel establishment messages: Reference GA-CSR ACTIVATE
CHANNEL 10.1.15 GA-CSR ACTIVATE CHANNEL ACK 10.1.16 GA-CSR ACTIVATE CHANNEL
COMPLETE 10.1.18 GA-CSR ACTIVATE CHANNEL FAILURE 10.1.17 GA-CSR CHANNEL MODE
MODIFY 10.1.40 GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE 10.1.41 Channel release
messages: Reference GA-CSR RELEASE 10.1.19 GA-CSR RELEASE COMPLETE 10.1.20 GA-
CSR CLEAR REQUEST 10.1.37 Handover messages: Reference GA-CSR HANDOVER ACCESS
10.1.29 GA-CSR HANDOVER COMPLETE 10.1.30 GA-CSR UPLINK QUALITY INDICATION
10.1.31 GA-CSR HANDOVER INFORMATION 10.1.32 GA-CSR HANDOVER COMMAND 10.1.33
GA-CSR HANDOVER FAILURE 10.1.34 Paging messages: Reference GA-CSR PAGING
REQUEST 10.1.21 GA-CSR PAGING RESPONSE 10.1.22 Miscellaneous message:
Reference GA-CSR UPLINK DIRECT TRANSFER 10.1.23 GA-CSR DOWNLINK DIRECT
TRANSFER 10.1.25 GA-CSR CLASSMARK ENQUIRY 10.1.26 GA-CSR CLASSMARK CHANGE
10.1.27 GA-CSR STATUS 10.1.28 GA-RC KEEP ALIVE 10.1.14 GA-CSR GPRS SUSPENSION
REQUEST 10.1.38 GA-RC SYNCHRONIZATION INFORMATION 10.1.39 GA-RC CELL BROADCAST
INFO 10.1.14a GA-CSR UTRAN CLASSMARK CHANGE 10.1.42
* * *
### 10.1.1 (void)
### 10.1.2 GA-RC DISCOVERY REQUEST
The MS transmits this message to the Provisioning GANC in order to obtain the
address information of a Default GANC.
Direction: MS to GANC
Table 10.1.2.1: GA-RC DISCOVERY REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                       Length Indicator\                   M          V        2                
                                               11.1.1.1
        GA-RC Protocol Discriminator           Protocol Discriminator\             M          V        Â½        0000    
                                               11.1.1.2
        Skip Indicator                         Skip Indicator\                     M          V        Â½        0000    
                                               11.1.1.3
        GA-RC DISCOVERY REQUEST Message Type   Message Type\                       M          V        1                
                                               11.1.1.4
1 IMSI Mobile Identity\ M TLV 10  
11.2.1
2 GAN Release Indicator GAN Release Indicator\ M TLV 3  
11.2.2
7 GAN Classmark GAN Classmark\ M TLV 4  
11.2.7
3 AP Radio Identity Radio Identity\ C TLV 9  
11.2.3
6 GERAN/UTRAN coverage Indication GERAN/UTRAN coverage Indicator\ M TLV 3  
11.2.6
4 GERAN Cell Identity GERAN Cell Identity\ C TLV 4  
11.2.4
5 Location Area Identification Location Area Identification\ C TLV n  
11.2.5
41 Routing Area Code Routing Area Code\ C TLV n  
11.2.41
21 Register Reject Cause Register reject Cause\ C TLV 3  
11.2.21
11 Redirection Counter Redirection Counter\ C TLV 3  
11.2.11
9 Default GANC-SEGW IP address IP Address\ C TLV 7-19  
11.2.9
10 Default GANC-SEGW FQDN Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10
97 Default GANC IP address IP Address\ C TLV 7-19  
11.2.9
98 Default GANC FQDN Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10
73 3G Cell Identity 3G Cell Identity\ C TLV 6  
11.2.73
130 Tracking Area Identity Tracking Area Identity\ O TLV 8  
11.2.114
132 E-UTRAN Camping Indicator E-UTRAN Camping Indicator\ O TLV 4  
11.2.116
131 E-UTRAN Cell Identity E-UTRAN Cell Identity\ C TLV 7  
11.2.115
* * *
#### 10.1.2.1 AP Radio Identity
The AP Radio identity shall be included if the MS connects via an AP over the
unlicensed radio.
#### 10.1.2.2 GERAN Cell Identity
The GERAN Cell Identity shall be included, if the MS is in an area with GSM
Coverage. The GERAN Cell Identity is retrieved from the GSM System
information. If the GERAN Cell Identity information element is included, it is
not permitted to include the 3G Cell Identity information element or the
E-UTRAN Cell Identity information element.
#### 10.1.2.3 Location Area Identification
The most recent Location Area Identification shall be included, if available
in the MS. Following cases are identified:
\- Normal service or limited service over GERAN/UTRAN.\ In this case the LAI
received in the GERAN or UTRAN System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the LAI is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage.\ In this case the LAI is
taken from the SIM, if available.
#### 10.1.2.4 Routing Area Code
The Routing Area Code (RAC) shall be included, if available in the MS.
Following cases are identified:
\- Normal service over GERAN/UTRAN with GPRS support\ In this case the RAC
received in the GERAN or UTRAN System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the RAC is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage\ In this case the RAC is
taken from the SIM, if available.
\- Normal service over GERAN/UTRAN without GPRS support or limited service\
The RAC is not included.
#### 10.1.2.5 Register Reject Cause
The Register Reject Cause shall be included if
The MS reattempts GA-RC Discovery Request after failing to connect to the
default GANC.
#### 10.1.2.6 Redirection Counter
The Redirection Counter IE shall be included if Register Reject Cause IE is
included.
#### 10.1.2.7 Default GANC-SEGW IP address
The conditional IE Default GANC-SEGW IP address shall be included if the
conditional IE Default GANC-SEGW FQDN is not included. It is not permitted to
include both Default GANC-SEGW IP address and Default GANC-SEGW FQDN in the
same message. One of these IEs shall be included if Register Reject Cause IE
is included.
#### 10.1.2.8 Default GANC-SEGW FQDN
The conditional IE Default GANC-SEGW FQDN shall be included if the conditional
IE Default GANC-SEGW IP address is not included. It is not permitted to
include both Default GANC-SEGW IP address and Default GANC-SEGW FQDN in the
same message. One of these IEs shall be included if Register Reject Cause IE
is included.
#### 10.1.2.9 Default GANC IP address
The conditional IE Default GANC IP address shall be included if the
conditional IE Default GANC FQDN is not included. It is not permitted to
include both Default GANC IP address and Default GANC FQDN in the same
message. One of these IEs shall be included if Register Reject Cause IE is
included.
#### 10.1.2.10 Default GANC FQDN
The conditional IE Default GANC FQDN shall be included if the conditional IE
Default GANC IP address is not included. It is not permitted to include both
Default GANC IP address and Default GANC FQDN in the same message. One of
these IEs shall be included if Register Reject Cause IE is included.
#### 10.1.2.11 3G Cell Identity
The 3G Cell Identity shall be included, if the MS is in an area with UTRAN
Coverage. The 3G Cell Identity is retrieved from the UTRAN System information.
If the 3G Cell Identity information element is included, it is not permitted
to include the GERAN Cell Identity information element.
#### 10.1.2.12 Tracking Area Identity
The most recent Tracking Area Identity shall be included, if the MS supports
E-UTRAN and the TAI is available in the MS. Following cases are identified:
\- Normal service or limited service over E-UTRAN.\ In this case the TAI
received in the E-UTRAN System Information is included.
\- Normal service or limited service over GERAN/UTRAN.\ In this case the TAI
is not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage.\ In this case the TAI is
taken from the USIM, if available.
#### 10.1.2.13 E-UTRAN Camping Indicator
The E-UTRAN Camping Indicator IE shall be included if the MS is camped on a
E-UTRAN cell.
#### 10.1.2.14 E-UTRAN Cell Identity
The E-UTRAN Cell Identity IE shall be included if the MS is camped on a
E-UTRAN cell, as indicated by the E-UTRAN Camping Indicator. The MS obtains
the E-UTRAN Cell Identity value from the E-UTRAN System information. If the
E-UTRAN Cell Identity information element is included, it is not permitted to
include the GERAN Cell Identity information element or the 3G Cell Identity
information element.
### 10.1.3 GA-RC DISCOVERY ACCEPT
The Provisioning GANC sends information of the Default GANC and SEGW
associated with the Default GANC the MS should use.
Direction: GANC to MS
Table 10.1.3.1: GA-RC DISCOVERY ACCEPT message content`
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      Length Indicator\                   M          V        2                
                                              11.1.1.1
        GA-RC Protocol Discriminator          Protocol Discriminator\             M          V        Â½        0000    
                                              11.1.1.2
        Skip Indicator                        Skip Indicator\                     M          V        Â½        0000    
                                              11.1.1.3
        GA-RC DISCOVERY ACCEPT Message Type   Message Type\                       M          V        1                
                                              11.1.1.4
9 Default GANC-SEGW IP address IP Address\ C TLV 7-19  
11.2.9
10 Default GANC-SEGW FQDN Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10
97 Default GANC IP address IP Address\ C TLV 7-19  
11.2.9
98 Default GANC FQDN Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10
103 GANC TCP port number Communication port\ O TLV 4  
11.2.25
* * *
#### 10.1.3.1 Default GANC-SEGW IP address
The conditional IE Default GANC-SEGW IP address shall be included if the
conditional IE Default GANC-SEGW FQDN is not included. It is not permitted to
include both Default GANC-SEGW IP address and Default GANC-SEGW FQDN in the
same message.
#### 10.1.3.2 Default GANC-SEGW FQDN
The conditional IE Default GANC-SEGW FQDN shall be included if the conditional
IE Default GANC-SEGW IP address is not included. It is not permitted to
include both Default GANC-SEGW IP address and Default GANC-SEGW FQDN in the
same message.
#### 10.1.3.3 Default GANC IP address
The conditional IE Default GANC IP address shall be included if the
conditional IE Default GANC FQDN is not included. It is not permitted to
include both Default GANC IP address and Default GANC FQDN in the same
message.
#### 10.1.3.4 Default GANC FQDN
The conditional IE Default GANC FQDN shall be included if the conditional IE
Default GANC IP address is not included. It is not permitted to include both
Default GANC IP address and Default GANC FQDN in the same message.
### 10.1.4 GA-RC DISCOVERY REJECT
The Provisioning GANC rejects the Discovery Request from the MS.
Direction: GANC to MS
Table 10.1.4.1: GA-RC DISCOVERY REJECT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      Length Indicator\         M          V        2                
                                              11.1.1.1
        GA-RC Protocol Discriminator          Protocol Discriminator\   M          V        Â½        0000    
                                              11.1.1.2
        Skip Indicator                        Skip Indicator\           M          V        Â½        0000    
                                              11.1.1.3
        GA-RC DISCOVERY REJECT Message Type   Message Type\             M          V        1                
                                              11.1.1.4
12 Discovery Reject Cause Discovery Reject Cause\ M TLV 3  
11.2.12
24 TU3902 Timer TU3902 Timer\ C TLV 4  
11.2.24
* * *
#### 10.1.4.1 TU3902 Timer
The TU3902 Timer IE shall be included if the Discovery Reject Cause \'Network
Congestion\' is returned to the MS.
### 10.1.5 GA-RC REGISTER REQUEST
The MS registers with the GANC in order to establish a MS context in the GANC
and receive the needed GAN system information. The MS also uses this message
to request a list of PLMN identities, when the MS is in manual PLMN selection
mode.
Direction: MS to GANC
Table 10.1.5.1: GA-RC REGISTER REQUEST message content
+-----+-------+-------+-------+-------+-------+-------+-------+ | IEI | I | Type | Pre | F | L | Value | Notes | | | nform | /Refe | sence | ormat | ength | | | | | ation | rence | | | | | | | | El | | | | | | | | | ement | | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | | L | **L | M | V | 2 | | | | | ength | ength | | | | | | | | Indi | Indic | | | | | | | | cator | ator\ | | | | | | | | | 11.1. | | | | | | | | | 1.1** | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | | GA-RC | **Pro | M | V | Â½ | 0000 | | | | Pro | tocol | | | | | | | | tocol | Disc | | | | | | | | Dis | rimin | | | | | | | | crimi | ator\ | | | | | | | | nator | 11.1. | | | | | | | | | 1.2** | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | | Skip | ** | M | V | Â½ | 0000 | | | | Indi | _Skip | | | | | | | | cator | Indic | | | | | | | | | ator\ | | | | | | | | | * | | | | | | | | | 11.1. | | | | | | | | | 1.3_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | | GA-RC |__Me | M | V | 1 | | | | | REG | ssage | | | | | | | | ISTER | Type\ | | | | | | | | RE | 11.1. | | | | | | | | QUEST | 1.4_ _| | | | | | | | me | | | | | | | | | ssage | | | | | | | | | ide | | | | | | | | | ntity | | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 1 | IMSI |__M | M | TLV | 10 | | | | | | obile | | | | | | | | | Iden | | | | | | | | | tity\ | | | | | | | | | 11. | | | | | | | | | 2.1_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 2 | GAN |__GAN | M | TLV | 3 | | | | | Re | Re | | | | | | | | lease | lease | | | | | | | | Indi | Indic | | | | | | | | cator | ator\ | | | | | | | | | 11. | | | | | | | | | 2.2_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 7 | GAN | GAN | M | TLV | 4 | | | | | Clas | Class | | | | | | | | smark | mark\ | | | | | | | | | 1 | | | | | | | | | 1.2.7 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 3 | AP | ** | C | TLV | 9-n | | | | | Radio | Radio | | | | | | | | Ide | Iden | | | | | | | | ntity | tity\ | | | | | | | | |__1 | | | | | | | | | 1.2.3 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 96 | MS | ** | M | TLV | 9-n | | | | | Radio | Radio | | | | | | | | ide | Iden | | | | | | | | ntity | tity\ | | | | | | | | | 11. | | | | | | | | | 2.3_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 17 |__GSM |__GSM | M | TLV | 3 | | | | | RR/ | RR/ | | | | | | | | UTRAN | UTRAN | | | | | | | | RRC | RRC | | | | | | | | St | S | | | | | | | | ate_ _| tate\ | | | | | | | | | 11.2 | | | | | | | | | .17_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 6 | Cov |__G | M | TLV | 3 | | | | | erage | ERAN/ | | | | | | | | Indic | UTRAN | | | | | | | | ation | cov | | | | | | | | | erage | | | | | | | | | Indic | | | | | | | | | ator\ | | | | | | | | | 11. | | | | | | | | | 2.6_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 4 | GERAN | ** | C | TLV | 4 | | | | | Cell | GERAN | | | | | | | | Ide | Cell | | | | | | | | ntity | Iden | | | | | | | | | tity\ | | | | | | | | | 11. | | | | | | | | | 2.4_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 5 | Loc |__Loc | C | TLV | 7 | | | | | ation | ation | | | | | | | | Area | Area | | | | | | | | Iden | Ident | | | | | | | | tific | ifica | | | | | | | | ation | tion\ | | | | | | | | | 11. | | | | | | | | | 2.5_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 41 | Ro |__Ro | C | TLV | 3 | | | | | uting | uting | | | | | | | | Area | Area\ | | | | | | | | Code | C | | | | | | | | | ode_ _| | | | | | | | | | | | | | | | | | 11 | | | | | | | | | .2.41 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 8 | Geogr |__Ge | O | TLV | 9-n | | | | | aphic | ograp | | | | | | | | Loc | hical | | | | | | | | ation | Loca | | | | | | | | | tion\ | | | | | | | | | 11. | | | | | | | | | 2.8_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 42 | AP |__AP | O | TLV | 7-n | | | | | loc | Loca | | | | | | | | ation | tion\ | | | | | | | | | 11.2 | | | | | | | | | .42_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 21 | Reg |__Reg | C | TLV | 3 | | | | | ister | ister | | | | | | | | R | r | | | | | | | | eject | eject | | | | | | | | Cause | C | | | | | | | | | ause\ | | | | | | | | | 11.2 | | | | | | | | | .21_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 11 | R |__R | C | TLV | 3 | | | | | edire | edire | | | | | | | | ction | ction | | | | | | | | Co | Cou | | | | | | | | unter | nter\ | | | | | | | | | 11.2 | | | | | | | | | .11_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 9 | Last |__IP | C | TLV | 7-19 | | | | | GANC | Add | | | | | | | | -SEGW | ress\ | | | | | | | | IP | 11. | | | | | | | | ad | 2.9_ _| | | | | | | | dress | | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 10 | Last | ** | C | TLV | 5-258 | | | | | GANC | Fully | | | | | | | | -SEGW | Qual | | | | | | | | FQDN | ified | | | | | | | | | D | | | | | | | | | omain | | | | | | | | | /Host | | | | | | | | | Name\ | | | | | | | | | 11.2 | | | | | | | | | .10_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 97 | Last |__IP | C | TLV | 7-19 | | | | | GANC | Add | | | | | | | | IP | ress\ | | | | | | | | ad | 11. | | | | | | | | dress | 2.9_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 98 | Last | ** | C | TLV | 5-258 | | | | | GANC | Fully | | | | | | | | FQDN | Qual | | | | | | | | | ified | | | | | | | | | D | | | | | | | | | omain | | | | | | | | | /Host | | | | | | | | | Name\ | | | | | | | | | 11.2 | | | | | | | | | .10_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 61 | AP |__AP | C | TLV | 4-260 | | | | | Se | Se | | | | | | | | rvice | rvice | | | | | | | | Name | Name\ | | | | | | | | | 11.2 | | | | | | | | | .61_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 68 | Re |__Reg | C | TLV | 3 | | | | | gistr | istra | | | | | | | | ation | tion\ | | | | | | | | indic | I | | | | | | | | ators | ndica | | | | | | | | | tors\ | | | | | | | | | 11.2 | | | | | | | | | .68_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 69 | GAN |__GAN | C | TLV | n | | | | | PLMN | PLMN | | | | | | | | List | List\ | | | | | | | | | 11.2 | | | | | | | | | .69_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 71 | Req |__Req | O | TLV | 3 | | | | | uired | uired | | | | | | | | GAN | GAN | | | | | | | | Ser | Serv | | | | | | | | vices | ices\ | | | | | | | | | 11.2 | | | | | | | | | .71_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 73 | 3G |__3G | C | TLV | 6 | | | | | Cell | Cell | | | | | | | | Ide | Iden | | | | | | | | ntity | tity\ | | | | | | | | | 11.2 | | | | | | | | | .73_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 82 | 3G |__3G | O | TLV | 4 | | | | | U | UA | | | | | | | | ARFCN | RFCN\ | | | | | | | | | 11.2 | | | | | | | | | .82_ _| | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 74 | 3G |__3G | C | TLV | 6 | | | | | Sec | Sec | | | | | | | | urity | urity | | | | | | | | Capab | C | | | | | | | | ility | apabi | | | | | | | | | lity\ | | | | | | | | | 11.2. | | | | | | | | | 111_ * | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 130 | Tra | Tra | O | TLV | 8 | | | | | cking | cking | | | | | | | | Area | Area | | | | | | | | Ide | Iden | | | | | | | | ntity | tity\ | | | | | | | | | 11. | | | | | | | | | 2.114 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 132 | E- | E- | O | TLV | 4 | | | | | UTRAN | UTRAN | | | | | | | | Ca | Ca | | | | | | | | mping | mping | | | | | | | | Indi | Indic | | | | | | | | cator | ator\ | | | | | | | | | 11. | | | | | | | | | 2.116 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+ | 131 | E- | E- | C | TLV | 7 | | | | | UTRAN | UTRAN | | | | | | | | Cell | Cell | | | | | | | | Ide | Iden | | | | | | | | ntity | tity\ | | | | | | | | | 11. | | | | | | | | | 2.115 | | | | | | +-----+-------+-------+-------+-------+-------+-------+-------+
#### 10.1.5.1 GERAN Cell Identity
The GERAN Cell Identity shall be included, if the MS is in an area with GSM
Coverage. The GERAN Cell Identity is retrieved from the GSM System
information. If the GERAN Cell Identity information element is included, it is
not permitted to include the 3G Cell Identity information element or the
E-UTRAN Cell Identity information element.
#### 10.1.5.2 Location Area Identification
The most recent Location Area Identification shall be included, if available
in the MS. Following cases are identified:
\- Normal service or limited service over GERAN/UTRAN\ In this case the LAI
received in the GERAN/UTRAN System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the LAI is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage\ In this case the LAI is
taken from the SIM, if available.
#### 10.1.5.3 Routing Area Code
The Routing Area Code (RAC) shall be included, if available in the MS.
Following cases are identified:
\- Normal service over GERAN/UTRAN with GPRS support\ In this case the RAC
received in the GSM System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the RAC is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage\ In this case the RAC is
taken from the SIM, if available.
\- Normal service over GERAN/UTRAN without GPRS support or limited service\
The RAC is not included.
#### 10.1.5.4 Register Reject Cause
The Register Reject Cause shall be included if the MS reattempts GA-RC
Register Request after failing to connect to a Serving GANC.
#### 10.1.5.5 Redirection Counter
The Redirection Counter IE shall be included if Register Reject Cause IE is
included.
#### 10.1.5.6 Last GANC-SEGW IP address
The conditional IE Last GANC-SEGW IP address shall be included if the
conditional IE Last GANC-SEGW FQDN is not included. It is not permitted to
include both Last GANC-SEGW IP address and Last GANC-SEGW FQDN in the same
message. One of these IEs shall be included if Register Reject Cause is
included.
#### 10.1.5.7 Last GANC-SEGW FQDN
The conditional IE Last GANC-SEGW FQDN shall be included if the conditional IE
Last GANC-SEGW IP address is not included. It is not permitted to include both
Last GANC-SEGW IP address and Last GANC-SEGW FQDN in the same message. One of
these IEs shall be included if Register Reject Cause is included.
#### 10.1.5.8 Last GANC IP address
The conditional IE Last GANC IP address shall be included if the conditional
IE Last GANC FQDN is not included. It is not permitted to include both Last
GANC IP address and Last GANC FQDN in the same message. One of these IEs shall
be included if Register Reject Cause is included.
#### 10.1.5.9 Last GANC FQDN
The conditional IE Last GANC FQDN shall be included if the conditional IE Last
GANC IP address is not included. It is not permitted to include both Last GANC
IP address and Last GANC FQDN in the same message. One of these IEs shall be
included if Register Reject Cause is included.
#### 10.1.5.10 AP Radio Identity
The AP Radio identity shall be included if the MS connects via an AP over the
unlicensed radio.
#### 10.1.5.11 AP Service Name
The AP Service Name shall be included, if available, and if the MS connects
via an AP over the unlicensed radio.
#### 10.1.5.12 Registration Indicators
The MS shall include this information element when attempting to register to
the Default GANC. The presence of this Information Element indicates to the
GANC that it is the Default GANC for that MS.
#### 10.1.5.13 GAN PLMN List
The GAN PLMN List information element shall be included only when attempting
to register with the Default GANC and if no more PLMNs can be selected from
the GAN PLMN List received from the Default GANC.
#### 10.1.5.14 3G Cell Identity
The 3G Cell Identity IE shall be included if the MS is in an area with UTRAN
Coverage. The 3G Cell Identity is retrieved from the UTRAN System information.
If the 3G Cell Identity information element is included, it is not permitted
to include the GERAN Cell Identity information element.
#### 10.1.5.15 3G UARFCN
The 3G UARFCN IE shall be included if the MS is currently camped on a UTRAN
cell and the MS indicates support for GAN Iu mode in the GAN Classmark IE.
#### 10.1.5.16 3G Security Capability
The 3G Security Capability IE shall be included if the MS indicates support
for GAN Iu mode in the GAN Classmark IE.
#### 10.1.5.17 Tracking Area Identity
The most recent Tracking Area Identity shall be included, if the MS supports
E-UTRAN and the TAI is available in the MS. Following cases are identified:
\- Normal service or limited service over E-UTRAN.\ In this case the TAI
received in the E-UTRAN System Information is included.
\- Normal service or limited service over GERAN/UTRAN.\ In this case the TAI
is not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage.\ In this case the TAI is
taken from the USIM, if available.
#### 10.1.5.18 E-UTRAN Camping Indicator
The E-UTRAN Camping Indicator IE shall be included if the MS is camped on a
E-UTRAN cell.
#### 10.1.5.19 E-UTRAN Cell Identity
The E-UTRAN Cell Identity IE shall be included if the MS is camped on a
E-UTRAN cell, as indicated by the E-UTRAN Camping Indicator. The MS obtains
the E-UTRAN Cell Identity value from the E-UTRAN System information. If the
E-UTRAN Cell Identity information element is included, it is not permitted to
include the GERAN Cell Identity information element or the 3G Cell Identity
information element.
### 10.1.6 GA-RC REGISTER ACCEPT
The GANC provides system information to the MS using this message. The
contents of this message are a collection of IEs from system information 3 and
13 of GERAN specifications plus some additions.
Direction: GANC to MS
Table 10.1.6.1: GA-RC REGISTER ACCEPT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                         **Length Indicator\                       M          V        2                
                                                 11.1.1.1**
        GA-RC Protocol Discriminator             **Protocol Discriminator\                 M          V        Â½        0000    
                                                 11.1.1.2**
        Skip Indicator                           ***Skip Indicator\                        M          V        Â½        0000    
                                                 *11.1.1.3**
        GA-RC REGISTER ACCEPT message identity   **Message Type\                           M          V        1                
                                                 11.1.1.4**
4 Cell Identity **Cell Identity\ M TLV 4  
11.2.4**
5 Location Area Identification **Location Area Identification\ M TLV 7  
11.2.5**
14 GAN Control Channel Description **GAN Control Channel Description\ M TLV 8  
11.2.14**
23 **TU3910 Timer** TU3910 Timer\ M TLV 4  
11.2.23
22 **TU3906 Timer** TU3906 Timer**\ M TLV 4  
11.2.22**
19 GAN Band **GAN Band\ M TLV 3  
11.2.19**
37 **TU3920 Timer** TU3920 Timer\ M TLV 4  
11.2.37
13 GAN Cell Description **GAN Cell Description\ O TLV 4  
11.2.13**
43 TU4001 **Timer** **TU4001** Timer**\ C TLV 4  
11.2.43**
60 TU4003 **Timer** **TU4003** Timer**\ C TLV 4  
11.2.60**
44 Location Status **Location Status\ O TLV 3  
11.2.44**
62 GAN Service Zone Information **GAN Service Zone Information\ O TLV 5-133  
11.2.62**
67 Serving GANC table indicator **Serving GANC table** **indicator\ O TLV 3  
11.2.67**
112 TU4004 **Timer** **TU4004** Timer**\ C TLV 3  
11.2.78**
79 GAN Mode Indicator **GAN Mode Indicator\ O TLV 3  
11.2.79**
81 GAN Iu Mode\ **GAN Iu Mode\ O TLV 6  
Cell Description Cell Description\  
11.2.81**
129 Handover Reporting Control **Handover Reporting Control 11.2.113** O TLV 4
* * *
#### 10.1.6.1 TU4001 and TU4003
These information elements are included in the message, if GPRS is supported
by the GANC.
#### 10.1.6.2 GAN Service Zone Information
This information element is included by the HPLMN, if the network is
configured with GAN Service Zone information.
#### 10.1.6.3 Serving GANC Table Indicator
The optional IE Serving GANC Table Indicator shall be included when the GA-RC
REGISTRATION ACCEPT is sent from the Default GANC.
NOTE: the GANC knows from the presence of IE Registration Indicators in GA-RC
REGISTER REQUEST, whether it is the Default GANC.
#### 10.1.6.4 GAN Band
This information element is applicable if and only if the MS is directed to
operate in GAN A/Gb mode; otherwise, the contents of this IE shall be
disregarded.
#### 10.1.6.5 **TU4004 Timer**
This information element shall be included if the IE \"GANC Control Channel
Description\" indicates that the GANC supports PS handover.
#### 10.1.6.6 **GAN Mode Indicator**
This information element shall be included if the IE \"GAN Classmark\"
received by the GANC in the GA-RC REGISTER REQUEST message included the GAN
Mode Support Indicator field with value other than \'Unspecified\'.
#### 10.1.6.7 **GAN Cell Description**
This information element may be included if the IE \"GAN Mode Indicator\" is
included and has value \'The MS shall operate in GAN A/Gb mode\' or if the IE
\"GAN Mode Indicator\" is not included.
#### 10.1.6.8 **GAN Iu Mode Cell Description**
This information element may be included if the IE \"GAN Mode Indicator\" is
included and has value \'The MS shall operate in GAN Iu mode\'.
### 10.1.7 GA-RC REGISTER REDIRECT
The GANC may use this message to redirect the MS to another GANC. In this case
the message will contain the Serving GANC-SEGW and Serving GANC information.
The message may also contain information about one or more PLMN identities
where the MS may be served while in GAN coverage.
Direction: GANC to MS
Table 10.1.7.1: GA-RC REGISTER REDIRECT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                       **Length Indicator\                   M          V        2                
                                               **11.1.1.1
        GA-RC Protocol Discriminator           **Protocol Discriminator\             M          V        Â½        0000    
                                               11.1.1.2**
        Skip Indicator                         *Skip Indicator\                      M          V        Â½        0000    
                                               *11.1.1.3
        GA-RC REGISTER REDIRECT Message Type   **Message Type\                       M          V        1                
                                               11.1.1.4**
9 Serving GANC-SEGW IP address **IP Address\ C TLV 7-19  
11.2.9**
10 Serving GANC-SEGW FQDN **Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10**
97 Serving GANC IP address **IP Address\ C TLV 7-19  
11.2.9**
98 Serving GANC FQDN **Fully Qualified Domain/Host Name\ C TLV 5-258  
11.2.10**
103 Serving GANC TCP port number **Communication port\ O TLV 4  
**11.2.25
67 Serving GANC table indicator **Serving GANC table** **indicator\ O TLV 3  
11.2.67**
69 GAN PLMN List **GAN PLMN List\ C TLV n  
11.2.69**
* * *
#### 10.1.7.1 Serving GANC-SEGW IP address
The conditional IE Serving GANC-SEGW IP address shall be included if neither
the IE Serving GANC-SEGW FQDN nor the IE GAN PLMN List is included.
#### 10.1.7.2 Serving GANC-SEGW FQDN
The conditional IE Serving GANC-SEGW FQDN shall be included if neither the IE
Serving GANC-SEGW IP address nor the IE GAN PLMN List is included.
#### 10.1.7.3 Serving GANC IP address
The conditional IE Serving GANC IP address shall be included if neither the IE
Serving GANC FQDN nor the IE GAN PLMN List is included.
#### 10.1.7.4 Serving GANC FQDN
The conditional IE Serving GANC FQDN shall be included if neither the IE
Serving GANC IP address nor the IE GAN PLMN List is included.
#### 10.1.7.5 Serving GANC TCP port number
The optional IE Serving GANC TCP port number is included if the network is
configured to use another than the default TCP port (as defined in sub-clause
12.1.2) for registrations. If this information element is included, then it is
not permitted to include the GAN PLMN List information element.
#### 10.1.7.5a Serving GANC Table Indicator
The optional IE Serving GANC Table Indicator shall be included when the GA-RC
REGISTRATION REDIRECT is sent from the Default GANC.
NOTE: The GANC knows from the presence of IE Registration Indicators in GA-RC
REGISTER REQUEST, whether it is the Default GANC.
#### 10.1.7.6 GAN PLMN List
The conditional IE GAN PLMN List contains information about 1 or more PLMNs
that may provide GAN service to the MS in its current location. If this
information element is included, then it is not permitted to include any of
the following information elements: Serving GANC-SEGW IP address, Serving
GANC-SEGW FQDN, Serving GANC IP address, Serving GANC FQDN and Serving GANC
TCP port number.
### 10.1.8 GA-RC REGISTER REJECT
The GAN uses this message to reject the registration request from a MS.
Direction: GANC to MS
Table 10.1.8.1: GA-RC REGISTER REJECT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                     **Length Indicator\                M          V        2                
                                             11.1.1.1**
        GA-RC Protocol Discriminator         **Protocol Discriminator\          M          V        Â½        0000    
                                             11.1.1.2**
        Skip Indicator                       ***Skip Indicator\                 M          V        Â½        0000    
                                             *11.1.1.3**
        GA-RC REGISTER REJECT Message Type   **Message Type\                    M          V        1                
                                             11.1.1.4**
21 Register Reject Cause **Register Reject Cause\ M TLV 3  
11.2.21**
16 TU3907 Timer **TU3907 Timer\ C TLV 4  
11.2.16**
58 Location Black List indicator **Location Black List indicator\ C TLV 3  
11.2.58**
5 Location Area Identification Location Area Identification\ C TLV 7  
11.2.5
* * *
#### 10.1.8.1 TU3907 Timer
The TU3907 Timer IE shall be included if the Register Reject Cause \'Network
Congestion\' is returned to the MS.
#### 10.1.8.2 Location Black List indicator
The Location Black List indicator IE shall be included if the Register Reject
Cause \'Location not allowed\' is returned to the MS.
#### 10.1.8.3 Location Area Identification
The Location Area Identification IE shall be included if the Register Reject
Cause \'Location not allowed\' is returned to the MS.
### 10.1.9 GA-RC DEREGISTER
The GANC on receiving this message removes all contexts associated with the MS
in the GANC. The MS on receiving this message releases all GA-RC, GA-CSR and
GA-PSR resources.
Direction: MS to GANC, GANC to MS
Table 10.1.9.1: GA-RC DEREGISTER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\                M          V        2                
                                        11.1.1.1**
        GA-RC Protocol Discriminator    **Protocol Discriminator\          M          V        Â½        0000    
                                        11.1.1.2**
        Skip Indicator                  **Skip Indicator\                  M          V        Â½        0000    
                                        11.1.1.3**
        GA-RC DEREGISTER Message Type   **Message Type\                    M          V        1                
                                        11.1.1.4**
21 Deregister Cause **Register Reject Cause\ M TLV 3  
11.2.21**
58 Location Black List indicator **Location Black List indicator\ C TLV 3  
11.2.58**
5 Location Area Identification Location Area Identification\ C TLV 7  
11.2.5
16 TU3907 Timer **TU3907 Timer\ C TLV 4  
11.2.16**
* * *
#### 10.1.9.1 Location Black List indicator
The Location Black List indicator IE shall be included if the Register Reject
Cause \'Location not allowed\' is returned to the MS.
#### 10.1.9.2 Location Area Identification
The Location Area Identification IE shall be included if the Register Reject
Cause \'Location not allowed\' is returned to the MS.
#### 10.1.9.3 TU3907 Timer
The TU3907 Timer IE shall be included if the Register Reject Cause 'Network
Congestion' is returned to the MS.
### 10.1.10 GA-RC REGISTER UPDATE UPLINK
The MS shall send this message when it needs to update the GAN with the
updated AP and GSM cell identities.
Direction: MS to GAN
Table 10.1.10.1: GA-RC REGISTER UPDATE UPLINK message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                **Length Indicator\               M          V        2                
                                                        11.1.1.1**
        GA-RC Protocol Discriminator                    **Protocol Discriminator\         M          V        Â½        0000    
                                                        11.1.1.2**
        Skip Indicator                                  **Skip Indicator\                 M          V        Â½        0000    
                                                        11.1.1.3**
        GA-RC REGISTER UPDATE UPLINK message identity   **Message Type\                   M          V        1                
                                                        11.1.1.4**
3 AP Radio Identity **Radio Identity\ O TLV 9  
**11.2.3
6 Coverage Indication GERAN/UTRAN coverage Indicator\ O TLV 3  
11.2.6
4 GERAN Cell Identity **GERAN Cell Identity\ C TLV 4  
11.2.4**
5 Location Area Identification **Location Area Identification\ C TLV 7  
11.2.5**
41 Routing Area Code **Routing Area Code\ C TLV 3  
11.2.41**
8 Geographic Location **Geographical Location\ O TLV 9-n  
11.2.8**
42 AP Location **AP Location\ O TLV 7-n  
11.2.42**
71 Required GAN Services **Required GAN Services\ O TLV 3  
11.2.71**
73 3G Cell Identity **3G Cell Identity\ C TLV 6  
11.2.73**
61 AP Service Name **AP Service Name\ C TLV 4-260  
11.2.61**
82 3G UARFCN **3G UARFCN\ O TLV 4  
11.2.82**
130 Tracking Area Identity **Tracking Area Identity\ O TLV 8  
11.2.114**
132 E-UTRAN Camping Indicator **E-UTRAN Camping Indicator\ O TLV 4  
11.2.116**
131 E-UTRAN Cell Identity **E-UTRAN Cell Identity\ C TLV 7  
11.2.115**
* * *
#### 10.1.10.1 GERAN Cell Identity
The GERAN Cell Identity shall be included, if GERAN/UTRAN Coverage Indication
IE is included and the MS is in an area with GSM Coverage. The GERAN Cell
Identity is retrieved from the GSM System information. If the GERAN Cell
Identity information element is included, it is not permitted to include the
3G Cell Identity information element or the E-UTRAN Cell Identity information
element.
#### 10.1.10.2 Location Area Identification
The most recent Location Area Identification shall be included, if available
in the MS and if GERAN/UTRAN Coverage Indication IE is included. Following
cases are identified:
\- Normal service or limited service over GERAN or UTRAN\ In this case the LAI
received in the GERAN/UTRAN System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the LAI is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage\ In this case the LAI is
taken from the SIM, if available.
#### 10.1.10.3 Routing Area Code
The Routing Area Code (RAC) shall be included, if available in the MS and if
\"Coverage Indication\" is included. Following cases are identified:
\- Normal service over GERAN/UTRAN with GPRS support\ In this case the RAC
received in the GERAN/UTRAN System Information is included.
\- Normal service or limited service over E-UTRAN.\ In this case the RAC is
not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage\ In this case the RAC is
taken from the SIM, if available.
\- Normal service over GERAN/UTRAN without GPRS support or limited service\
The RAC is not included.
#### 10.1.10.4 3G Cell Identity
The 3G Cell Identity shall be included, if GERAN/UTRAN Coverage Indication IE
is included and the MS is in an area with UTRAN Coverage. The 3G Cell Identity
is retrieved from the UTRAN System information. If the 3G Cell Identity
information element is included, it is not permitted to include the GERAN Cell
Identity information element or the E-UTRAN Cell Identity information element.
#### 10.1.10.5 AP Service Name
The AP Service Name information element shall be included, if available, and
if the AP Radio Identity information element is included.
#### 10.1.10.6 3G UARFCN
The 3G UARFCN IE shall be included if the MS experiences any of the following
while registered for GAN Iu mode:
\- The MS acquires UTRAN coverage for the first time after reporting no
coverage during its last GAN registration.
\- The MS establishes a new UTRAN serving cell as a result of Intra-RAT
handover while in GERAN/UTRAN/E-UTRAN mode and the UARFCN of the new UTRAN
serving cell is different from the UARFCN indicated during its last GAN
Registration or GAN Registration Update.
\- The MS establishes a new UTRAN serving cell as a result of Inter-RAT
handover to UTRAN while in GERAN/UTRAN/E-UTRAN mode.
\- The MS enters connected mode in a UTRAN cell while in GERAN/UTRAN/E-UTRAN
mode and the UARFCN of the serving UTRAN cell is different from the UARFCN
indicated during its last GAN Registration/GAN Registration Update or a UARFCN
was not provided during its last GAN Registration/GAN Registration Update.
#### 10.1.10.7 Tracking Area Identity
The most recent Tracking Area Identity shall be included, if the MS supports
E-UTRAN and the TAI is available in the MS. Following cases are identified:
\- Normal service or limited service over E-UTRAN.\ In this case the TAI
received in the E-UTRAN System Information is included.
\- Normal service or limited service over GERAN/UTRAN.\ In this case the TAI
is not included.
\- MS has not found GERAN/UTRAN/E-UTRAN coverage.\ In this case the TAI is
taken from the USIM, if available.
#### 10.1.10.8 E-UTRAN Camping Indicator
The E-UTRAN Camping Indicator IE shall be included if the MS is camped on a
E-UTRAN cell.
#### 10.1.10.9 E-UTRAN Cell Identity
The E-UTRAN Cell Identity IE shall be included if the MS is camped on a
E-UTRAN cell, as indicated by the E-UTRAN Camping Indicator. The MS obtains
the E-UTRAN Cell Identity value from the E-UTRAN System information. If the
E-UTRAN Cell Identity information element is included, it is not permitted to
include the GERAN Cell Identity information element or the 3G Cell Identity
information element.
### 10.1.11 GA-RC REGISTER UPDATE DOWNLINK
The network sends this message to the MS to indicate change in GAN system
information or MS location status.
Direction: GANC to MS
Table 10.1.11.1: GA-RC REGISTER UPDATE DOWNLINK message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                  **Length Indicator\                  M          V        2                
                                                          11.1.1**.1
        GA-RC Protocol Discriminator                      **Protocol Discriminator\            M          V        Â½        0000    
                                                          11.1.1.2**
        Skip Indicator                                    ***Skip Indicator\                   M          V        Â½        0000    
                                                          *11.1.1.3**
        GA-RC REGISTER UPDATE DOWNLINK message identity   **Message Type\                      M          V        1                
                                                          11.1.1.4**
4 Cell Identity **Cell Identity\ O TLV 4  
11.2.4**
5 Location Area Identification **Location Area Identification\ O TLV 7  
11.2.5**
14 GAN Control Channel Description **GAN Control Channel Description\ O TLV 8  
11.2.14**
23 **TU3910 Timer** TU3910 Timer\ O TLV 4  
11.2.23
22 TU3906 Timer **TU3906 Timer\ O TLV 4  
11.2.22**
19 GAN Band **GAN Band\ O TLV 3  
11.2.19**
37 TU3920 Timer TU3920 Timer\ O TLV 4  
11.2.37
13 GAN Cell Description **GAN Cell Description\ O TLV 4  
11.2.13**
43 TU4001 Timer **TU4001 Timer\ O TLV 4  
11.2.43**
60 TU4003 Timer **TU4003 Timer\ O TLV 4  
11.2.60**
44 Location Status **Location Status\ O TLV 3  
11.2.44**
62 GAN Service Zone Information **GAN Service Zone Information\ O TLV 5-133  
11.2.62**
81 GAN Iu Mode\ **GAN Iu Mode\ O TLV 6  
Cell Description Cell Description\  
11.2.81**
* * *
#### 10.1.11.1 GAN Service Zone Information
This information element is included from the HPLMN, if the network is
configured with UMA Service Zone information.
#### 10.1.11.2 **GAN Cell Description**
This information element may be included if and only if the MS is operating in
GAN A/Gb mode.
#### 10.1.11.3 **GAN Iu Mode Cell Description**
This information element may be included if and only if the MS is operating in
GAN Iu mode.
### 10.1.12 GA-CSR REQUEST
The MS sends this message to the network to establish the GA-CSR Connection.
Direction: MS to GANC
Table 10.1.12.1: GA-CSR REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      **Length Indicator\         M          V        2                   
                                              11.1.1**.1
        GA-CSR Protocol Discriminator         **Protocol Discriminator\   M          V        Â½        **0001**   
                                              11.1.1.2**
        Skip Indicator                        ***Skip Indicator\          M          V        Â½        0000       
                                              *11.1.1.3**
        GA-CSR **REQUEST** message identity   **Message Type\             M          V        1                   
                                              11.1.1.4**
50 Establishment Cause **Establishment Cause\ M TLV 3  
11.2.50**
* * *
### 10.1.13 GA-CSR REQUEST ACCEPT
The GANC sends this message to the MS to indicate that is has accepted the
establishment of the GA-CSR Connection.
Direction: GANC to MS
Table 10.1.13.1: GA-CSR REQUEST ACCEPT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-CSR Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0001**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-CSR **REQUEST ACCEPT** message identity   **Message Type\             M          V        1                   
                                                     11.1.1.4**
* * *
### 10.1.14 GA-RC KEEP ALIVE
The MS sends this message to the GANC.
Direction: MS to GANC
Table 10.1.14.1: GA-RC KEEP ALIVE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\         M          V        2                
                                        **11.1.1.1
        GA-RC Protocol Discriminator    **Protocol Discriminator\   M          V        Â½        0000    
                                        11.1.1.2**
        Skip Indicator                  ***Skip Indicator\          M          V        Â½        0000    
                                        *11.1.1.3**
        GA-RC KEEP ALIVE Message Type   **Message Type\             M          V        1                
                                        11.1.1.4**
* * *
### 10.1.14a GA-RC CELL BROADCAST INFO
The GANC sends this message to the MS.
Direction: GANC to MS
Table 10.1.14a.1: GA-RC CELL BROADCAST INFO message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                         **Length Indicator\         M          V        2                
                                                 **11.1.1.1
        GA-RC Protocol Discriminator             **Protocol Discriminator\   M          V        Â½        0000    
                                                 11.1.1.2**
        Skip Indicator                           ***Skip Indicator\          M          V        Â½        0000    
                                                 *11.1.1.3**
        GA-RC CELL BROADCAST INFO Message Type   **Message Type\             M          V        1                
                                                 11.1.1.4**
72 Broadcast Container Broadcast container\ M TLV n-m  
11.2.72
* * *
### 10.1.15 GA-CSR ACTIVATE CHANNEL
The GANC uses this message to establish a traffic channel on GAN.
Direction: GANC to MS
Table 10.1.15.1: GA-CSR ACTIVATE CHANNEL message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           **Length Indicator\                   M          V        2                   
                                                   11.1.1.1**
        GA-CSR Protocol Discriminator              Protocol Discriminator\               M          V        Â½        **0001**   
                                                   11.1.1.2
        Skip Indicator                             *Skip Indicator\                      M          V        Â½        0000       
                                                   *11.1.1.3
        GA-CSR ACTIVATE CHANNEL message identity   Message Type\                         M          V        1                   
                                                   11.1.1.4
27 Channel Mode Channel Mode\ M TLV 3  
11.2.27
53 Sample Size Sample Size\ M TLV 3 CS payload sample size in ms 11.2.53
97 IP Address IP Address\ M TLV 7-19  
11.2.9
104 RTP UDP Port Communication Port\ M TLV 4  
11.2.25
54 Payload Type **Payload Type\ O TLV 3  
11.2.54**
55 Multi-rate Configuration Multi-rate Configuration\ C TLV 3-n  
11.2.55
63 RTP Redundancy Configuration **RTP Redundancy Configuration\ C TLV 3-6  
11.2.63**
105 RTCP UDP Port Communication Port\ O TLV 4  
11.2.25
133 Bandwidth-efficient Mode Indicator Bandwidth-efficient Mode Indicator\ O
TLV 4  
11.2.117
* * *
#### 10.1.15.1 Payload Type
The Payload Type information Element is included when the speech codec
signaled uses dynamic Payload Type.
#### 10.1.15.2 Multi-rate Configuration
The Multi-rate Configuration information element is included when the Channel
Mode is speech with a speech version using AMR.
#### 10.1.15.3 RTP Redundancy Configuration
The RTP Redundancy Configuration information element is included when the
Channel Mode is speech with a speech version using AMR, and the MS has
indicated support for RTP Redundancy through the GAN Classmark IE. The
redundancy level is defined for each of the AMR modes in the Multi-rate
Configuration. The level of redundancy can span from no redundancy to double
redundancy.
#### 10.1.15.4 RTCP UDP Port
The RTCP UDP port information element is used to indicate the UDP port for
RTCP, if RTCP shall be used towards the network.
#### 10.1.15.5 Bandwidth-efficient Mode Indicator
The Bandwidth-efficient Mode Indicator information element is included if RFC
4867 [48] bandwidth-efficient mode shall be used to code and decode the CS
payload samples on the traffic channel.
### 10.1.16 GA-CSR ACTIVATE CHANNEL ACK
The MS indicates the communication port information for the downlink stream to
the Serving GANC.
Direction: MS to GANC
Table 10.1.16.1: GA-CSR ACTIVATE CHANNEL ACK message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                               **Length Indicator\       M          V        2                   
                                                       **11.1.1.1
        GA-CSR Protocol Discriminator                  Protocol Discriminator\   M          V        Â½        **0001**   
                                                       11.1.1.2
        Skip Indicator                                 *Skip Indicator\          M          V        Â½        0000       
                                                       *11.1.1.3
        GA-CSR ACTIVATE CHANNEL ACK message identity   Message Type\             M          V        1                   
                                                       11.1.1.4
104 RTP UDP Port **Communication Port\ M TLV 4  
11.2.25**
53 Sample Size Sample Size\ M TLV 3 CS payload sample size in ms 11.2.53
54 Payload Type **Payload Type\ O TLV 3  
11.2.54**
105 RTCP UDP Port Communication Port\ O TLV 4  
11.2.25
* * *
#### 10.1.16.1 Payload Type
The Payload Type IE is included when the speech codec signaled uses dynamic
Payload Type. It shall be set to the same value as the Payload Type IE of the
GA-CSR CHANNEL ACTIVATE message.
#### 10.1.16.2 RTCP UDP Port
The RTCP UDP port information element is used to indicate the UDP port for
RTCP, if RTCP shall be used towards the mobile station.
#### 10.1.16.3 Sample Size
The MS shall indicate what sample size it is using and what the network shall
use in the downlink. The MS shall follow the minimum sample size indication
sent by the network in GA-CSR ACTIVATE CHANNEL.
### 10.1.17 GA-CSR ACTIVATE CHANNEL FAILURE
The MS indicates failure to establish the channel to the GANC.
Direction: MS to GANC
Table 10.1.17.1: GA-CSR ACTIVATE CHANNEL FAILURE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                   **Length ndicator\          M          V        2                   
                                                           **11.1.1.1
        GA-CSR Protocol Discriminator                      **Protocol Discriminator\   M          V        Â½        **0001**   
                                                           11.1.1.2**
        Skip Indicator                                     *Skip Indicator\            M          V        Â½        0000       
                                                           *11.1.1.3
        GA-CSR ACTIVATE CHANNEL FAILURE message identity   Message Type\               M          V        1                   
                                                           11.1.1.4
29 RR cause RR cause\ M TLV 3  
11.2.29
* * *
### 10.1.18 GA-CSR ACTIVATE CHANNEL COMPLETE
The Serving GANC acknowledges completion of the traffic channel
establishment**.**
Direction: GANC to MS
Table 10.1.18.1: GA-CSR ACTIVATE CHANNEL COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                    **Length Indicator\         M          V        2                   
                                                            **11.1.1.1
        GA-CSR Protocol Discriminator                       **Protocol Discriminator\   M          V        Â½        **0001**   
                                                            11.1.1.2**
        Skip Indicator                                      *Skip Indicator\            M          V        Â½        0000       
                                                            *11.1.1.3
        GA-CSR ACTIVATE CHANNEL COMPLETE message identity   Message Type\               M          V        1                   
                                                            11.1.1.4
* * *
### 10.1.19 GA-CSR RELEASE
This message is used to instruct the MS to release all GA-CSR related
resources associated with the connection to the Serving GANC.
Direction: GANC to MS
Table 10.1.19.1: GA-CSR RELEASE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                  **Length Indicator\         M          V        2                   
                                          **11.1.1.1
        GA-CSR Protocol Discriminator     **Protocol Discriminator\   M          V        Â½        **0001**   
                                          11.1.1.2**
        Skip Indicator                    *Skip Indicator\            M          V        Â½        0000       
                                          *11.1.1.3
        GA-CSR RELEASE message identity   Message Type\               M          V        1                   
                                          11.1.1.4
29 RR cause RR cause\ M TLV 3  
11.2.29
31 GPRS Resumption GPRS Resumption\ O TLV 3  
11.2.31
* * *
### 10.1.20 GA-CSR RELEASE COMPLETE
The MS acknowledges release of all GA-CSR related resources to the Serving
GANC.
Direction: MS to GANC
Table 10.1.20.1: GA-CSR RELEASE COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           **Length Indicator\         M          V        2                   
                                                   **11.1.1.1
        GA-CSR Protocol Discriminator              **Protocol Discriminator\   M          V        Â½        **0001**   
                                                   11.1.1.2**
        Skip Indicator                             *Skip Indicator\            M          V        Â½        0000       
                                                   *11.1.1.3
        GA-CSR RELEASE COMPLETE message identity   Message Type\               M          V        1                   
                                                   11.1.1.4
* * *
### 10.1.21 GA-CSR PAGING REQUEST
Direction: GANC to MS
**Table 10.1.21.1: GA-CSR PAGING REQUEST** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                         **Length Indicator\         M          V        2                   
                                                 **11.1.1.1
        GA-CSR Protocol Discriminator            **Protocol Discriminator\   M          V        Â½        **0001**   
                                                 11.1.1.2**
        Skip Indicator                           *Skip Indicator\            M          V        Â½        0000       
                                                 *11.1.1.3
        GA-CSR PAGING REQUEST message identity   Message Type\               M          V        1                   
                                                 11.1.1.4
51 Channel Needed Channel Needed\ M TLV 3  
11.2.51
1 TMSI or IMSI Mobile Identity\ M TLV 7-10  
11.2.1
* * *
### 10.1.22 GA-CSR PAGING RESPONSE
The MS responds to the page using this message.
Direction: MS to GANC
**Table 10.1.22.1: GA-CSR PAGING RESPONSE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                          **Length Indicator\                  M          V        2                   
                                                  **11.1.1.1
        GA-CSR Protocol Discriminator             **Protocol Discriminator\            M          V        Â½        **0001**   
                                                  11.1.1.2**
        Skip Indicator                            *Skip Indicator\                     M          V        Â½        0000       
                                                  *11.1.1.3
        GA-CSR PAGING RESPONSE message identity   Message Type\                        M          V        1                   
                                                  11.1.1.4
48 Ciphering Key Sequence Number Ciphering Key Sequence Number\ M TLV 3  
11.2.48
28 Mobile Station Classmark 2 Mobile Station Classmark 2 11.2.28 M TLV 5
1 Mobile Identity Mobile Identity\ M TLV 7-10  
11.2.1
50 Establishment Cause **Establishment\ M TLV 3  
Cause\  
11.2.50**
* * *
### 10.1.23 GA-CSR UPLINK DIRECT TRANSFER
The MS communicates with the CN by encapsulating CC/MM/SS/SMS messages in this
container.
Direction: MS to GANC
Table 10.1.23.1: GA-CSR UPLINK DIRECT TRANSFER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                 **Length Indicator\         M          V        2                        
                                                         **11.1.1.1
        GA-CSR Protocol Discriminator                    **Protocol Discriminator\   M          V        Â½             **0001**   
                                                         11.1.1.2**
        Skip Indicator                                   *Skip Indicator\            M          V        Â½             0000       
                                                         *11.1.1.3
        GA-CSR UPLINK DIRECT TRANSFER message identity   Message Type\               M          V        1                        
                                                         11.1.1.4
26 L3 message L3 Message\ M TLV Var. Length  
11.2.26
49 SAPI ID SAPI ID\ M TLV 3  
11.2.49
* * *
### 10.1.24 GA-CSR REQUEST REJECT
The GANC sends this message to the MS to indicate that is has rejected the
establishment of the GA-CSR Connection.
Direction: GANC to MS
Table 10.1.24.1: GA-CSR REQUEST REJECT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\         M          V        2                   
                                        11.1.1**.1
        GA-CSR Protocol Discriminator   **Protocol Discriminator\   M          V        Â½        **0001**   
                                        11.1.1.2**
        Skip Indicator                  ***Skip Indicator\          M          V        Â½        0000       
                                        *11.1.1.3**
        GA-CSR **REQUEST\               **Message Type\             M          V        1                   
        REJECT** message identity       11.1.1.4**
29 RR cause RR cause\ M TLV 3  
11.2.29
* * *
### 10.1.25 GA-CSR DOWNLINK DIRECT TRANSFER
The CN communicates with the MS by encapsulating CC/MM/SS/SMS messages in this
container.
Direction: GANC to MS
Table 10.1.25.1: GA-CSR DOWNLINK DIRECT TRANSFER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
           Length Indicator                                   **Length Indicator\         M          V        2                        
                                                              **11.1.1.1
           GA-CSR Protocol Discriminator                      **Protocol Discriminator\   M          V        Â½             **0001**   
                                                              11.1.1.2**
           Skip Indicator                                     *Skip Indicator\            M          V        Â½             0000       
                                                              *11.1.1.3
           GA-CSR DOWNLINK DIRECT TRANSFER message identity   Message Type\               M          V        1                        
                                                              11.1.1.4
**26** L3 message L3 Message\ M TLV Var. Length  
11.2.26
* * *
### 10.1.26 GA-CSR CLASSMARK ENQUIRY
The CN obtains classmark information of the mobile through this enquiry
message.
Direction: GANC to MS
Table 10.1.26.1: GA-CSR CLASSMARK ENQUIRY message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                            **Length Indicator\         M          V        2                   
                                                    **11.1.1.1
        GA-CSR Protocol Discriminator               **Protocol Discriminator\   M          V        Â½        **0001**   
                                                    11.1.1.2**
        Skip Indicator                              *Skip Indicator\            M          V        Â½        0000       
                                                    *11.1.1.3
        GA-CSR CLASSMARK ENQUIRY message identity   Message Type\               M          V        1                   
                                                    11.1.1.4
65 Classmark Enquiry Mask Classmark Enquiry Mask\ O TLV 3  
11.2.65
* * *
### 10.1.27 GA-CSR CLASSMARK CHANGE
The MS sends classmark information indicating it\'s capabilities to the
network using this message.
Direction: MS to GANC
Table 10.1.27.1: GA-CSR CLASSMARK CHANGE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                  Length Indicator\             M          V        2                
                                                          11.1.1.1
        GA-CSR Protocol Discriminator                     Protocol Discriminator\       M          V        Â½        0001    
                                                          11.1.1.2
        Skip Indicator                                    Skip Indicator\               M          V        Â½        0000    
                                                          11.1.1.3
        GA-CSR CLASSMARK CHANGE message identity          Message Type\                 M          V        1                
                                                          11.1.1.4
28 Mobile Station Classmark 2 Mobile Station Classmark 2\ M TLV 5  
11.2.28
56 Additional Mobile Station Classmark Information Mobile Station Classmark 3\
C TLV 3-34  
11.2.56
* * *
#### 10.1.27.1 Additional Mobile Station Classmark Information
This IE shall be included if and only if the CM3 bit in the _Mobile Station
Classmark 2_ IE is set to 1.
### 10.1.28 GA-CSR STATUS
The MS communicates to the GANC various error conditions.
Direction: MS to GANC
Table 10.1.28.1: GA-CSR STATUS message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                 **Length Indicator\       M          V        2                 
                                         **11.1.1.1
        GA-CSR Protocol Discriminator    Protocol Discriminator\   M          V        Â½         0001    
                                         11.1.1.2
        Skip Indicator                   Skip Indicator\           M          V        Â½         0000    
                                         11.1.1.3
        GA-CSR STATUS message identity   Message Type\             M          V        1                 
                                         11.1.1.4
29 RR Cause RR Cause\ M TLV 3  
11.2.29
52 PDU in Error PDU in Error\ M TLV 6 - 257  
11.2.52
* * *
### 10.1.29 GA-CSR HANDOVER ACCESS
Direction: MS to GANC
Table 10.1.29.1: GA-CSR HANDOVER ACCESS message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                          Length Indicator\         M          V        2                     
                                                  11.1.1.1
        GA-CSR Protocol Discriminator             Protocol Discriminator\   M          V        Â½             0001    
                                                  11.1.1.2
        Skip Indicator                            Skip Indicator\           M          V        Â½             0000    
                                                  11.1.1.3
        GA-CSR HANDOVER ACCESS message identity   Message Type\             M          V        1                     
                                                  11.1.1.4
26 Handover To GAN Command L3 Message\ M TLV Var. Length  
11.2.26
* * *
#### 10.1.29.1 Handover To GAN Command
This information element contains the entire (RR) HANDOVER COMMAND message
received via the source radio access technology.
### 10.1.30 GA-CSR HANDOVER COMPLETE
Direction: MS to GANC
Table 10.1.30.1: GA-CSR HANDOVER COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                            Length Indicator\         M          V        2                
                                                    11.1.1.1
        GA-CSR Protocol Discriminator               Protocol Discriminator\   M          V        Â½        0001    
                                                    11.1.1.2
        Skip Indicator                              Skip Indicator\           M          V        Â½        0000    
                                                    11.1.1.3
        GA-CSR HANDOVER COMPLETE message identity   Message Type\             M          V        1                
                                                    11.1.1.4
* * *
### 10.1.31 GA-CSR UPLINK QUALITY INDICATION
The GANC indicates changes in the uplink quality, which may be used by the MS
to trigger the handover from GAN procedure.
Direction: GANC to MS
Table 10.1.31.1: GA-CSR UPLINK QUALITY INDICATION message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                Length Indicator\         M          V        2                
                                                        11.1.1.1
        GA-CSR Protocol Discriminator                   Protocol Discriminator\   M          V        Â½        0001    
                                                        11.1.1.2
        Skip Indicator                                  Skip Indicator\           M          V        Â½        0000    
                                                        11.1.1.3
        GA-CSR UL QUALITY INDICATION message identity   Message Type\             M          V        1                
                                                        11.1.1.4
33 UL Quality Indication UL Quality Indication\ M V 3  
11.2.33
* * *
### 10.1.32 GA-CSR HANDOVER INFORMATION
The MS triggers the handover from GAN procedure indicating the list of cell
identifiers in the target radio access technology.
Direction: MS to GANC
Table 10.1.32.1: GA-CSR HANDOVER INFORMATION message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                               Length Indicator\                   M          V        2                
                                                       11.1.1.1
        GA-CSR Protocol Discriminator                  Protocol Discriminator\             M          V        Â½        0001    
                                                       11.1.1.2
        Skip Indicator                                 Skip Indicator\                     M          V        Â½        0000    
                                                       11.1.1.3
        GA-CSR HANDOVER INFORMATION message identity   Message Type\                       M          V        1                
                                                       11.1.1.4
15 GERAN Cell Identifier List Cell Identifier List\ O TLV n  
11.2.15
106 GERAN Received Signal Level List GERAN Received Signal Level List\ C TLV n  
11.2.70
66 UTRAN Cell Identifier List UTRAN Cell Identifier List\ O TLV n  
11.2.66
107 UTRAN Received Signal Level List UTRAN Received Signal Level List\ C TLV n  
11.2.70b
* * *
#### 10.1.32.1 GERAN Cell Identifier List
The GERAN Cell Identifier List information element shall be included if
Handover to a GERAN cell is requested by the mobile station. The cells are
ranked in descending order of preference according to measured value.
#### 10.1.32.2 GERAN Received Signal Level List
The GERAN Received Signal Level List information element shall be included if
the GERAN Cell Identifier List information element is included. It contains
the Received signal quality for each cell included in the GERAN Cell
Identifier List information element. The order of the measurements in the
GERAN Received Signal Level List shall be the same as the order of the Cell
identifiers included in the GERAN Cell Identifier List information element.
#### 10.1.32.3 UTRAN Cell Identifier List
The UTRAN Cell Identifier List information element shall be included if
Handover to an UTRAN cell is requested by the mobile station. The cells are
ranked in descending order according to measured Ec/No value.
#### 10.1.32.4 UTRAN Received Signal Level List
The UTRAN Received Signal Level List information element shall be included if
the UTRAN Cell Identifier List information element is included. It contains
the Received signal quality for each cell included in the UTRAN Cell
Identifier List information element. The order of the measurements in the
UTRAN Received Signal Level List shall be the same as the order of the Cell
identifiers included in the UTRAN Cell Identifier List information element.
NOTE: At least one of the cell identifier list IEs must be present.
### 10.1.33 GA-CSR HANDOVER COMMAND
The GANC orders the MS to handover from GAN.
Direction: GANC to MS
Table 10.1.33.1: GA-CSR HANDOVER COMMAND message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\            M          V        2                
                                                   11.1.1.1
        GA-CSR Protocol Discriminator              Protocol Discriminator\      M          V        Â½        0001    
                                                   11.1.1.2
        Skip Indicator                             Skip Indicator\              M          V        Â½        0000    
                                                   11.1.1.3
        GA-CSR HANDOVER COMMAND message identity   Message Type\                M          V        1                
                                                   11.1.1.4
32 Handover From GAN Command Handover From GAN Command\ M TLV n  
11.2.32
* * *
#### 10.1.33.1 Handover From GAN Command
If the target radio access technology is GERAN, the value part of the Handover
From GAN Command IE is coded as the HANDOVER COMMAND message specified in
[12]. If the target RAT is UTRAN, the value part of the Handover From GAN
Command IE is coded as the INTER SYSTEM TO UTRAN HANDOVER COMMAND message
specified in [12].
### 10.1.34 GA-CSR HANDOVER FAILURE
The MS indicates a failure to complete the requested handover from GAN.
Direction: MS to GANC
Table 10.1.34.1: GA-CSR HANDOVER FAILURE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\         M          V        2                
                                                   11.1.1.1
        GA-CSR Protocol Discriminator              Protocol Discriminator\   M          V        Â½        0001    
                                                   11.1.1.2
        Skip Indicator                             Skip Indicator\           M          V        Â½        0000    
                                                   11.1.1.3
        GA-CSR HANDOVER FAILURE message identity   Message Type\             M          V        1                
                                                   11.1.1.4
29 RR Cause RR Cause\ M TLV 3  
11.2.29
* * *
#### 10.1.34.1 RR Cause
If the target radio access technology is GERAN/UTRAN, this information element
is coded as the RR Cause IE in [12].
### 10.1.35 GA-CSR CIPHERING MODE COMMAND
The network sends this message to the MS to indicate the ciphering
configuration for future handover to GERAN.
Direction: GANC to MS
Table 10.1.35.1: GA-CSR CIPHERING MODE COMMAND message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                 Length Indicator\         M          V        2                
                                                         11.1.1.1
        GA-CSR Protocol Discriminator                    Protocol Discriminator\   M          V        Â½        0001    
                                                         11.1.1.2
        Skip Indicator                                   Skip Indicator\           M          V        Â½        0000    
                                                         11.1.1.3
        GA-CSR CIPHERING MODE COMMAND message identity   Message Type\             M          V        1                
                                                         11.1.1.4
30 Ciphering Mode Setting Cipher Mode Setting\ M TLV 3  
11.2.30
45 Cipher Response Cipher Response\ M TLV 3  
11.2.45
46 Random number Ciphering Command RAND\ M TLV 18  
11.2.46
* * *
### 10.1.36 GA-CSR CIPHERING MODE COMPLETE
The MS sends this message to the GANC to acknowledge the ciphering
configuration as well as to authenticate that the MS holds the correct Kc.
Direction: MS to GANC
Table 10.1.36.1: GA-CSR CIPHERING MODE COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                  Length Indicator\         M          V        2                
                                                          11.1.1.1
        GA-CSR Protocol Discriminator                     Protocol Discriminator\   M          V        Â½        0001    
                                                          11.1.1.2
        Skip Indicator                                    Skip Indicator\           M          V        Â½        0000    
                                                          11.1.1.3
        GA-CSR CIPHERING MODE COMPLETE message identity   Message Type\             M          V        1                
                                                          11.1.1.4
47 Message Authentication Code Ciphering Command MAC\ M TLV 14  
11.2.47
1 Mobile Equipment\ Mobile Identity\ C TLV 11  
Identity 11.2.1
* * *
#### 10.1.36.1 Mobile Equipment Identity
This information element is included according the value of the Mobile
Equipment Identity Request of the GA-CSR CIPHERING MODE COMMAND.
### 10.1.37 GA-CSR CLEAR REQUEST
The MS sends this message to the network to indicate that the network should
release the signalling connection and related resources.
Direction: MS to GANC
Table 10.1.37.1: GA-CSR CLEAR REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                        Length Indicator\         M          V        2                
                                                11.1.1.1
        GA-CSR Protocol Discriminator           Protocol Discriminator\   M          V        Â½        0001    
                                                11.1.1.2
        Skip Indicator                          Skip Indicator\           M          V        Â½        0000    
                                                11.1.1.3
        GA-CSR CLEAR REQUEST message identity   Message Type\             M          V        1                
                                                11.1.1.4
29 RR cause RR cause\ M TLV 3  
11.2.29
* * *
### 10.1.38 GA-CSR GPRS SUSPENSION REQUEST
This message is used by the MS to request the suspension of the GPRS downlink
data transfer when transitioning to dedicated mode.
Direction: MS to GANC.
Table 10.1.38.1: GA-CSR GPRS SUSPENSION REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                  Length Indicator\              M          V        2                
                                                          11.1.1.1
        GA-CSR Protocol Discriminator                     Protocol Discriminator\        M          V        Â½        0001    
                                                          11.1.1.2
        Skip Indicator                                    Skip Indicator\                M          V        Â½        0000    
                                                          11.1.1.3
        GA-CSR GPRS SUSPENSION REQUEST message identity   Message Type\                  M          V        1                
                                                          11.1.1.4
34 TLLI TLLI\ M TLV 6  
11.2.34
36 Suspension cause Suspension Cause\ M TLV 3  
11.2.36
18 Routing Area Identification Routing Area Identification\ M TLV 8  
11.2.18
* * *
### 10.1.39 GA-RC SYNCHRONIZATION INFORMATION
This message is sent by the MS after successful re-establishment of the TCP
connection as defined in sub-clause 9.5.
Direction: MS to GANC.
**Table 10.1.39.1: GA-RC SYNCHRONIZATION INFORMATION** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                     Length Indicator\         M          V        2                
                                                             11.1.1.1
        GA-RC Protocol Discriminator                         Protocol Discriminator\   M          V        Â½        0000    
                                                             11.1.1.2
        Skip Indicator                                       Skip Indicator\           M          V        Â½        0000    
                                                             11.1.1.3
        GA-RC SYNCHRONIZATION INFORMATION message identity   Message Type\             M          V        1                
                                                             11.1.1.4
1 IMSI Mobile Identity\ M TLV 10  
11.2.1
20 GAN State GAN State\ M TLV 3  
11.2.20
* * *
### 10.1.40 GA-CSR CHANNEL MODE MODIFY
This message is sent by the network to the mobile station to request the
setting of the mode for the indicated channel(s).
Table 10.1.40.1: GA-CSR CHANNEL MODE MODIFY message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                              Length Indicator\               M          V        2                
                                                      11.1.1.1
        GA-CSR Protocol Discriminator                 Protocol Discriminator\         M          V        Â½        0001    
                                                      11.1.1.2
        Skip Indicator                                Skip Indicator\                 M          V        Â½        0000    
                                                      11.1.1.3
        GA-CSR CHANNEL MODE MODIFY message identity   Message Type\                   M          V        1                
                                                      11.1.1.4
27 Channel Mode Channel Mode\ O TLV 3  
11.2.27
55 Multi-rate Configuration Multi-rate Configuration\ C TLV 3-n  
11.2.55
63 RTP Redundancy Configuration RTP Redundancy Configuration\ C TLV 3-6  
11.2.63
53 Sample Size Sample Size\ O TLV 3 CS payload sample size in ms 11.2.53
97 IP Address IP Address\ O TLV 7-19  
11.2.9
104 RTP UDP Port Communication Port\ O TLV 4  
11.2.25
105 RTCP UDP Port Communication Port\ O TLV 4  
11.2.25
* * *
#### 10.1.40.1 Channel Mode
The Channel Mode IE shall be included if the GANC is changing the current
Channel Mode.
#### 10.1.40.2 Multi-rate Configuration
The Multi-rate Configuration information element is included when the Channel
Mode is speech with a speech version using AMR.
#### 10.1.40.3 RTP Redundancy Configuration
The Redundancy Configuration information element is included when the Channel
Mode is speech with a speech version using AMR, and the MS has indicated
support for RTP Redundancy through the GAN Classmark IE. The redundancy level
is defined for each of the AMR modes in the Multi-rate Configuration. The
level of redundancy can span from no redundancy to double redundancy.
#### 10.1.40.4 Sample Size
The Sample Size IE shall be included if the GANC is changing the current
Sample Size. The MS should use the value indicated by the IE \"Sample Size\"
as the minimum sampling size for the coding and decoding of the CS payload
samples, if the MS is not able to use the indicated value.
#### 10.1.40.5 IP Address
The IP Address IE shall be included if the GANC is changing the local IP
address used for an active user plane session.
#### 10.1.40.6 RTP UDP Port
The RTP UDP Port IE shall be included if the GANC is changing the local UDP
Port used for RTP for an active user plane session.
#### 10.1.40.7 RTCP UDP Port
The RTCP UDP Port IE shall be included if the GANC is changing the local UDP
Port used for RTCP for an active user plane session.
### 10.1.41 GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE
This message is sent by the mobile station to the network to indicate the
successful or unsuccessful execution of a channel mode modify request
Table 10.1.41.1: GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                          Length Indicator\         M          V        2                
                                                                  11.1.1.1
        GA-CSR Protocol Discriminator                             Protocol Discriminator\   M          V        Â½        0001    
                                                                  11.1.1.2
        Skip Indicator                                            Skip Indicator\           M          V        Â½        0000    
                                                                  11.1.1.3
        GA-CSR CHANNEL MODE MODIFY ACKNOWLEDGE message identity   Message Type\             M          V        1                
                                                                  11.1.1.4
27 Channel Mode Channel Mode\ M TLV 3  
11.2.27
53 Sample Size Sample Size\ O TLV 3 CS payload sample size in ms 11.2.53
* * *
#### 10.1.41.1 Channel Mode
The Channel Mode IE shall always be included by the MS. It contains the
currently used Channel Mode.
#### 10.1.41.2 Sample Size
The Sample Size IE shall be included by the MS if it was included in the GA-
CSR CHANNEL MODE MODIFY. It contains the currently used Sample Size.
### 10.1.42 GA-CSR UTRAN CLASSMARK CHANGE
The MS sends UTRAN Classmark information indicating its UTRAN capabilities to
the network using this message.
Direction: MS to GANC
Table 10.1.42.1: GA-CSR UTRAN CLASSMARK CHANGE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                 Length Indicator\         M          V        2                
                                                         11.1.1.1
        GA-CSR Protocol Discriminator                    Protocol Discriminator\   M          V        Â½        0001    
                                                         11.1.1.2
        Skip Indicator                                   Skip Indicator\           M          V        Â½        0000    
                                                         11.1.1.3
        GA-CSR UTRAN CLASSMARK CHANGE message identity   Message Type\             M          V        1                
                                                         11.1.1.4
64 UTRAN Classmark UTRAN Classmark\ M TLV n  
11.2.64
* * *
## 10.2 GA-PSR Messages
Table 10.2.1 summarizes the GA-PSR messages.
Table 10.2.1: GA-PSR Messages
* * *
GA-PSR TC Management messages: Reference Transport Layer used GA-PSR-ACTIVATE-
UTC-REQ 10.2.1 TCP GA-PSR-ACTIVATE-UTC-ACK 10.2.2 TCP GA-PSR-DEACTIVATE-UTC-
REQ 10.2.3 TCP GA-PSR-DEACTIVATE-UTC-ACK 10.2.4 TCP GPRS Tunnelling messages:
Reference  
GA-PSR-DATA 10.2.5 TCP GA-PSR-UNITDATA 10.2.6 UDP GAN Specific Signalling
messages: Reference  
GA-PSR-PS-PAGE 10.2.7 TCP GA-PSR-DFC-REQ 10.2.9 UDP GA-PSR-UFC-REQ 10.2.8 UDP
GA-PSR-STATUS 10.2.10 TCP GA-PSR HANDOVER COMPLETE 10.2.11 TCP GA-PSR UPLINK
QUALITY INDICATION 10.2.12 TCP GA-PSR HANDOVER INFORMATION 10.2.13 TCP GA-PSR
HANDOVER COMMAND 10.2.14 TCP GA-PSR HANDOVER CONTINUE 10.2.15 TCP GA-PSR
HANDOVER FAILURE 10.2.16 TCP
* * *
### 10.2.1 GA-PSR-ACTIVATE-UTC-REQ
This message is sent either by the MS or GANC to initiate GA-PSR Transport
Channel activation.
Direction: GANC to MS, MS to GANC.
**Table 10.2.1.1: GA-PSR-ACTIVATE-UTC-REQ** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\         M          V        2                
                                                   11.1.1.1
        GA-PSR Protocol Discriminator              Protocol Discriminator\   M          V        Â½        0010    
                                                   11.1.1.2
        Skip Indicator                             Skip Indicator\           M          V        Â½        0000    
                                                   11.1.1.3
        GA-PSR-ACTIVATE-UTC-REQ message identity   GA-PSR Message Type\      M          V        1                
                                                   11.1.2.1
        TLLI                                       TLLI\                     M          V        4                
                                                   11.1.2.2
100 UDP Port for GPRS user data transport Communication Port\ M TLV 4  
11.2.25
99 IP address for GPRS user data transport IP Address\ O TLV 7-19  
11.2.9
* * *
#### 10.2.1.1 IP address for GPRS user data transport
This IE shall be included by the GANC and shall not be included by the MS. It
contains GANC IP address for GPRS user data transport if GANC initiates
activation.
#### 10.2.1.2 UDP Port for GPRS user data transport
This information element contains MS UDP port for GPRS user data transport if
MS initiates activation. It contains GANC UDP port for GPRS user data
transport if GANC initiates activation.
### 10.2.2 GA-PSR-ACTIVATE-UTC-ACK
This message is sent either by the MS or GANC to confirm GA-PSR Transport
Channel activation.
Direction: GANC to MS, MS to GANC.
**Table 10.2.2.1: GA-PSR-ACTIVATE-UTC-ACK** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\              M          V        2                
                                                   11.1.1.1
        GA-PSR Protocol Discriminator              Protocol Discriminator\        M          V        Â½        0010    
                                                   11.1.1.2
        Skip\                                      Skip Indicator\                M          V        Â½        0000    
        Indicator                                  11.1.1.3
        GA-PSR-ACTIVATE-UTC-ACK message identity   GA-PSR Message Type\           M          V        1                
                                                   11.1.2.1
        TLLI                                       TLLI\                          M          V        4                
                                                   11.1.2.2
99 IP address for GPRS user data transport IP Address\ O TLV 7-19  
11.2.9
100 UDP Port for GPRS user data transport Communication Port Identity\ C TLV 4  
11.2.25
39 GA-PSR TC Activation Status GA-PSR Cause\ M TLV 3  
11.2.39
* * *
#### 10.2.2.1 IP address for GPRS user data transport
This IE shall be included by the GANC and shall not be included by the MS. It
contains GANC IP address for GPRS user data transport if MS initiates
successful activation.
#### 10.2.2.2 UDP Port for GPRS user data transport
This information element must be included if the GA-PSR cause indicates
success (0) and contains the following:
GANC UDP port for GPRS user data transport if MS initiates activation.
MS UDP port for GPRS user data transport if GANC initiates activation.
### 10.2.3 GA-PSR-DEACTIVATE-UTC-REQ
This message is sent by the MS or by the GANC to initiate GA-PSR Transport
Channel deactivation.
Direction: MS to GANC, GANC to MS.
**Table 10.2.3.1: GA-PSR-DEACTIVATE-UTC-REQ** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             Length Indicator\         M          V        2                
                                                     11.1.1.1
        GA-PSR Protocol Discriminator                Protocol Discriminator\   M          V        Â½        0010    
                                                     11.1.1.2
        Skip Indicator                               Skip Indicator\           M          V        Â½        0000    
                                                     11.1.1.3
        GA-PSR-DEACTIVATE-UTC-REQ message identity   GA-PSR Message Type\      M          V        1                
                                                     11.1.2.1
        TLLI                                         TLLI\                     M          V        4                
                                                     11.1.2.2
39 GA-PSR TC Deactivation Cause GA-PSR Cause\ M TLV 3  
11.2.39
* * *
### 10.2.4 GA-PSR-DEACTIVATE-UTC-ACK
This message is sent by the GANC or by the MS to confirm GA-PSR Transport
Channel deactivation.
Direction: GANC to MS, MS to GANC.
**Table 10.2.4.1: GA-PSR-DEACTIVATE-UTC-ACK** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             Length Indicator\         M          V        2                
                                                     11.1.1.1
        GA-PSR Protocol Discriminator                Protocol Discriminator\   M          V        Â½        0010    
                                                     11.1.1.2
        Skip Indicator                               Skip Indicator\           M          V        Â½        0000    
                                                     11.1.1.3
        GA-PSR-DEACTIVATE-UTC-ACK message identity   Message Type\             M          V        1                
                                                     11.1.2.1
        TLLI                                         TLLI\                     M          V        4                
                                                     11.1.2.2
* * *
### 10.2.5 GA-PSR-DATA
This message is used both in uplink and downlink direction to tunnel GPRS
signalling and SMS messages.
Direction: GANC to MS and MS to GANC.
**Table 10.1.5.1: GA-PSR-DATA** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                Length Indicator\         M          V        2                
                                        11.1.1.1
        GA-PSR Protocol Discriminator   Protocol Discriminator\   M          V        Â½        0010    
                                        11.1.1.2
        Skip Indicator                  Skip Indicator\           M          V        Â½        0000    
                                        11.1.1.3
        GA-PSR-DATA message identity    GA-PSR Message Type\      M          V        1                
                                        11.1.2.1
        TLLI                            TLLI\                     M          V        4                
                                        11.1.2.2
38 Requested QoS QoS\ C TLV 3  
11.2.38
35 Packet Flow Identifier Packet Flow Identifier\ O TLV 3  
11.2.35
57 LLC PDU LLC-PDU\ M TLV 2-1562  
11.2.57
* * *
#### 10.2.5.1 Requested QoS
This Information Element is Mandatory for uplink packets only i.e. in the
direction from MS to GANC. This IE shall not be included in downlink packets
i.e. in the direction from GANC to MS.
#### 10.2.5.2 Packet Flow Identifier
This Information Element is present only if packet flow management procedures
are supported.
### 10.2.6 GA-PSR-UNITDATA
This message is used to tunnel uplink and downlink GPRS user data messages (on
the GA-PSR TC over UDP) between the MS and GANC.
Direction: GANC to MS and MS to GANC.
**Table 10.2.6.1: GA-PSR-UNITDATA** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        GA-PSR-UNITDATA message identity   GA-PSR Message Type\      M          V        1                
                                           11.1.3.1
        TLLI                               TLLI\                     M          V        4                
                                           11.1.3.2
        Sequence Number                    Sequence Number\          M          V        2                
                                           11.1.3.3
38 Requested QoS QoS\ C TLV 3  
11.2.38
35 Packet Flow Identifier Packet Flow Identifier\ O TLV 3  
11.2.35
57 LLC PDU LLC-PDU\ M TLV 2-1562  
11.2.57
* * *
#### 10.2.6.1 Requested QoS
This Information Element is Mandatory for uplink packets only i.e. in the
direction from MS to GANC. This IE shall not be included in downlink packets
i.e. in the direction from GANC to MS.
#### 10.2.6.2 Packet Flow Identifier
This Information Element is present only if packet flow management procedures
are supported.
### 10.2.7 GA-PSR-PS-PAGE
This message is used by the GANC to forward the packet page for PS services to
the MS.
Direction: GANC to MS.
**Table 10.2.7.1: GA-PSR-PS-PAGE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                  Length Indicator\         M          V        2                
                                          11.1.1.1
        GA-PSR Protocol Discriminator     Protocol Discriminator\   M          V        Â½        0010    
                                          11.1.1.2
        Skip\                             Skip Indicator\           M          V        Â½        0000    
        Indicator                         11.1.1.3
        GA-PSR-PS-PAGE message identity   GA-PSR Message Type\      M          V        1                
                                          11.1.2.1
        Reserved                          TLLI\                     M          V        4        0       To keep GA-PSR-signalling message header consistent.
                                          11.1.2.2
1 Mobile Identity Mobile Identity\ M TLV 7-10  
11.2.1
* * *
#### 10.2.7.1 Mobile Identity
The mobile identity IE contains either IMSI or P-TMSI based on the request
from SGSN.
### 10.2.8 GA-PSR-UFC-REQ
This message is sent by the GANC to the MS (on the GA-PSR TC over UDP) to
initiate uplink flow control procedure.
Direction: GANC to MS.
**Table 10.2.8.1: GA-PSR-UFC-REQ** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        GA-PSR-UFC-REQ message identity   GA-PSR Message Type\      M          V        1                
                                          11.1.3.1
        TLLI                              TLLI\                     M          V        4                
                                          11.1.3.2
        Sequence Number                   Sequence Number\          M          V        2                
                                          11.1.3.3
40 Requested Uplink User Data Rate User Data Rate\ M TLV 5  
11.2.40
35 Packet Flow Identifier Packet Flow Identifier\ O TLV 3  
11.2.35
59 Reset Indicator Reset Indicator\ O TLV 3  
11.2.59
* * *
#### 10.2.8.1 Packet Flow Identifier
This Information Element is included if the request is related to a specific
PFC (e.g. not included when PFM procedures are not supported).
#### 10.2.8.2 Reset Indicator
This information element is included if the GANC initiates an uplink flow
control condition reset.
### 10.2.9 GA-PSR-DFC-REQ
This message is sent by the MS to the GANC (on the GA-PSR TC over UDP) to
initiate downlink flow control procedure.
Direction: MS to GANC.
**Table 10.2.9.1: GA-PSR-DFC-REQ** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        GA-PSR-DFC-REQ message identity     GA-PSR Message Type\      M          V        1                
                                            11.1.3.1
        TLLI                                TLLI\                     M          V        4                
                                            11.1.3.2
        Sequence Number                     Sequence Number\          M          V        2                
                                            11.1.3.3
40 Requested Downlink User Data Rate User Data Rate\ M TLV 5  
11.2.40
35 Packet Flow Identifier Packet Flow Identifier\ O TLV 3  
11.2.35
* * *
#### 10.2.9.1 Packet Flow Identifier
This Information Element is included if the request is related to a specific
PFC (e.g. not included when PFM procedures are not supported).
### 10.2.10 GA-PSR STATUS
This message is used to indicate protocol errors.
Direction: MS to GANC.
**Table 10.2.10.1: GA-PSR STATUS** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                 Length Indicator\         M          V        2                 
                                         11.1.1.1
        GA-PSR Protocol Discriminator    Protocol Discriminator\   M          V        Â½         0010    
                                         11.1.1.2
        Skip Indicator                   Skip Indicator\           M          V        Â½         0000    
                                         11.1.1.3
        GA-PSR-STATUS message identity   GA-PSR Message Type\      M          V        1                 
                                         11.1.2.1
        TLLI                             TLLI\                     M          V        4                 
                                         11.1.2.2
39 GA-PSR Cause GA-PSR Cause\ M TLV 3  
11.2.39
52 PDU in Error PDU in Error\ M TLV 6 - 257  
11.2.52
* * *
### 10.2.11 GA-PSR HANDOVER COMPLETE
Direction: MS to GANC
Table 10.2.11.1: GA-PSR HANDOVER COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                            Length Indicator\         M          V        2                
                                                    11.1.1.1
        GA-PSR Protocol Discriminator               Protocol Discriminator\   M          V        Â½        0010    
                                                    11.1.1.2
        Skip Indicator                              Skip Indicator\           M          V        Â½        0000    
                                                    11.1.1.3
        GA-PSR HANDOVER COMPLETE message identity   GA-PSR Message Type\      M          V        1                
                                                    11.1.2.1
        TLLI                                        **TLLI\                   M          V        4                
                                                    11.1.2.2**
* * *
### 10.2.12 GA-PSR UPLINK QUALITY INDICATION
The GANC indicates changes in the uplink quality, which may be used by the MS
to trigger the PS handover from GAN procedure.
Direction: GANC to MS
Table 10.2.12.1: GA-PSR UPLINK QUALITY INDICATION message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                Length Indicator\         M          V        2                
                                                        11.1.1.1
        GA-PSR Protocol Discriminator                   Protocol Discriminator\   M          V        Â½        0010    
                                                        11.1.1.2
        Skip Indicator                                  Skip Indicator\           M          V        Â½        0000    
                                                        11.1.1.3
        GA-PSR UL QUALITY INDICATION message identity   GA-PSR Message Type\      M          V        1                
                                                        11.1.2.1
        TLLI                                            **TLLI\                   M          V        4                
                                                        11.1.2.2**
33 UL Quality Indication UL Quality Indication\ M TLV 3  
11.2.33
* * *
### 10.2.13 GA-PSR HANDOVER INFORMATION
The MS triggers the PS handover from GAN procedure indicating the list of cell
identifiers in the target radio access technology.
Direction: MS to GANC
Table 10.2.13.1: GA-PSR HANDOVER INFORMATION message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                               Length Indicator\                   M          V        2                
                                                       11.1.1.1
        GA-PSR Protocol Discriminator                  Protocol Discriminator\             M          V        Â½        0010    
                                                       11.1.1.2
        Skip Indicator                                 Skip Indicator\                     M          V        Â½        0000    
                                                       11.1.1.3
        GA-PSR HANDOVER INFORMATION message identity   GA-PSR Message Type\                M          V        1                
                                                       11.1.2.1
        TLLI                                           **TLLI\                             M          V        4                
                                                       11.1.2.2**
15 GERAN Cell Identifier List Cell Identifier List\ C TLV n  
11.2.15
106 GERAN Received Signal Level List GERAN Received Signal Level List\ C TLV n  
11.2.70
66 UTRAN Cell Identifier List UTRAN Cell Identifier List\ C TLV n  
11.2.66
107 UTRAN Received Signal Level List UTRAN Received Signal Level List\ C TLV n  
11.2.70b
* * *
#### 10.2.13.1 GERAN Cell Identifier List
See sub-clause 10.1.32.1.
#### 10.2.13.2 GERAN Received Signal Level List
See sub-clause 10.1.32.2.
#### 10.2.13.3 UTRAN Cell Identifier List
See sub-clause 10.1.32.3.
#### 10.2.13.4 UTRAN Received Signal Level List
See sub-clause 10.1.32.4.
### 10.2.14 GA-PSR HANDOVER COMMAND
The GANC orders the MS to perform PS handover from GAN.
Direction: GANC to MS
Table 10.2.14.1: GA-PSR HANDOVER COMMAND message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\               M          V        2                
                                                   11.1.1.1
        GA-PSR Protocol Discriminator              Protocol Discriminator\         M          V        Â½        0010    
                                                   11.1.1.2
        Skip Indicator                             Skip Indicator\                 M          V        Â½        0000    
                                                   11.1.1.3
        GA-PSR HANDOVER COMMAND message identity   GA-PSR Message Type\            M          V        1                
                                                   11.1.2.1
        TLLI                                       **TLLI\                         M          V        4                
                                                   11.1.2.2**
108 PS Handover to GERAN Command PS Handover to GERAN Command\ C TLV n  
11.2.74
109 PS Handover to UTRAN Command PS Handover to UTRAN Command\ C TLV n  
11.2.75
110 PS Handover to GERAN PSI PS Handover to GERAN PSI\ C TLV n  
11.2.76
111 PS Handover to GERAN SI PS Handover to GERAN SI\ C TLV n  
11.2.77
* * *
#### 10.2.14.1 PS Handover to GERAN Command
If the target radio access technology is GERAN, the value part of the _PS
Handover to GERAN Command_ IE shall be included and coded as the PS HANDOVER
COMMAND message specified in 3GPP TS 44.060 [45]. If this IE is present then
the _PS Handover to UTRAN Command_ IE shall not be present.
#### 10.2.14.2 PS Handover to UTRAN Command
If the target radio access technology is UTRAN, the value part of the PS
Handover to UTRAN Command IE shall be included and coded as the INTER SYSTEM
TO UTRAN HANDOVER COMMAND message specified in 3GPP TS 25.331 [40]. If this IE
is present then the _PS Handover to GERAN Command_ IE, the _PS Handover to
GERAN PSI_ IE and the _PS Handover to GERAN SI_ IE shall not be present.
#### 10.2.14.3 PS Handover to GERAN PSI
If the target radio access technology is GERAN and PBCCH is present in the
target cell, the value part of the _PS Handover to GERAN PSI_ IE shall be
included and coded as per the minimum set of PSI messages required for
operation in A/Gb mode as defined for A/Gb mode to A/Gb mode PS handover (see
3GPP TS 44.060 [45]). When this IE is included the _PS Handover to GERAN SI_
IE shall not be present.
#### 10.2.14.4 PS Handover to GERAN SI
If the target radio access technology is GERAN and PBCCH is not present in the
target cell, the value part of the _PS Handover to GERAN SI_ IE shall be
included and coded as per the minimum set of SI messages required for
operation in A/Gb mode as defined for A/Gb mode to A/Gb mode PS handover (see
3GPP TS 44.060 [45]). When this IE is included the _PS Handover to GERAN PSI_
IE shall not be present.
### 10.2.15 GA-PSR HANDOVER CONTINUE
The GANC indicates that the MS shall continue to wait for a **GA-PSR HANDOVER
COMMAND** message instead of performing a rove-out.
Direction: GANC to MS
Table 10.2.15.1: GA-PSR HANDOVER CONTINUE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                            Length Indicator\         M          V        2                
                                                    11.1.1.1
        GA-PSR Protocol Discriminator               Protocol Discriminator\   M          V        Â½        0010    
                                                    11.1.1.2
        Skip Indicator                              Skip Indicator\           M          V        Â½        0000    
                                                    11.1.1.3
        GA-PSR HANDOVER CONTINUE message identity   GA-PSR Message Type\      M          V        1                
                                                    11.1.2.1
        TLLI                                        **TLLI\                   M          V        4                
                                                    11.1.2.2**
* * *
### 10.2.16 GA-PSR HANDOVER FAILURE
The MS indicates that a handover from GAN A/Gb mode (attempted as a result of
receiving a **GA-PSR HANDOVER COMMAND** message) failed.
Direction: MS to GANC
Table 10.2.16.1: GA-PSR HANDOVER FAILURE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           Length Indicator\         M          V        2                
                                                   11.1.1.1
        GA-PSR Protocol Discriminator              Protocol Discriminator\   M          V        Â½        0010    
                                                   11.1.1.2
        Skip Indicator                             Skip Indicator\           M          V        Â½        0000    
                                                   11.1.1.3
        GA-PSR HANDOVER FAILURE message identity   GA-PSR Message Type\      M          V        1                
                                                   11.1.2.1
        TLLI                                       **TLLI\                   M          V        4                
                                                   11.1.2.2**
39 GA-PSR Cause GA-PSR Cause\ M TLV 3  
11.2.39
* * *
## 10.3 GA-RRC control plane messages
Table 10.3.1 summarizes the GA-RRC control plane messages.
Table 10.1.1: GA-RRC control plane messages
* * *
GA-RRC control plane messages: Reference GA-RRC REQUEST 10.3.1 GA-RRC REQUEST
ACCEPT 10.3.2 GA-RRC REQUEST REJECT 10.3.3 GA-RRC RELEASE REQUEST 10.3.4 GA-
RRC RELEASE 10.3.5 GA-RRC RELEASE COMPLETE 10.3.6 GA-RRC PAGING REQUEST 10.3.7
GA-RRC ACTIVATE CHANNEL 10.3.8 GA-RRC ACTIVATE CHANNEL ACK 10.3.9 GA-RRC
ACTIVATE CHANNEL COMPLETE 10.3.10 GA-RRC MODIFY CHANNEL 10.3.11 GA-RRC MODIFY
CHANNEL ACK 10.3.12 GA-RRC DEACTIVATE CHANNEL REQUEST 10.3.13 GA-RRC
DEACTIVATE CHANNEL 10.3.14 GA-RRC DEACTIVATE CHANNEL COMPLETE 10.3.15 GA-RRC
SECURITY MODE COMMAND 10.3.16 GA-RRC SECURITY MODE COMPLETE 10.3.17 GA-RRC
INITIAL DIRECT TRANSFER 10.3.18 GA-RRC UPLINK DIRECT TRANSFER 10.3.19 GA-RRC
DOWNLINK DIRECT TRANSFER 10.3.20 GA-RRC RELOCATION INFORMATION 10.3.21 GA-RRC
RELOCATION COMMAND 10.3.22 GA-RRC RELOCATION ACCESS 10.3.23 GA-RRC RELOCATION
COMPLETE 10.3.24 GA-RRC RELOCATION FAILURE 10.3.25 GA-RRC RELOCATION REQUEST
10.3.26 GA-RRC RELOCATION REQUEST ACK 10.3.27 GA-RRC UPLINK QUALITY INDICATION
10.3.28 GA-RRC STATUS 10.3.29
* * *
### 10.3.1 GA-RRC REQUEST
The MS sends this message to the GANC to establish the GA-RRC Connection for
the indicated domain.
Direction: MS to GANC
Table 10.3.1.1: GA-RRC REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      **Length Indicator\             M          V        2                   
                                              11.1.1**.1
        GA-RRC Protocol Discriminator         **Protocol Discriminator\       M          V        Â½        **0011**   
                                              11.1.1.2**
        Skip Indicator                        ***Skip Indicator\              M          V        Â½        0000       
                                              *11.1.1.3**
        GA-RRC **REQUEST** message identity   **GA-RRC Message Type\          M          V        1                   
                                              **11.1.3a.1
80 CN Domain Identity CN Domain Identity**\ M TLV 3  
11.2.80**
85 GA-RRC Establishment Cause **GA-RRC Establishment Cause\ M TLV 3  
11.2.85**
* * *
### 10.3.2 GA-RRC REQUEST ACCEPT
The GANC sends this message to the MS to indicate that is has accepted the
establishment of the GA-RRC Connection.
Direction: GANC to MS
Table 10.3.2.1: GA-RRC REQUEST ACCEPT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC **REQUEST ACCEPT** message identity   **GA-RRC Message Type\      M          V        1                   
                                                     **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
* * *
### 10.3.3 GA-RRC REQUEST REJECT
The GANC sends this message to the MS to indicate that is has rejected the
establishment of the GA-RRC Connection.
Direction: GANC to MS
Table 10.3.3.1: GA-RRC REQUEST REJECT message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\         M          V        2                   
                                        11.1.1**.1
        GA-RRC Protocol Discriminator   **Protocol Discriminator\   M          V        Â½        **0011**   
                                        11.1.1.2**
        Skip Indicator                  ***Skip Indicator\          M          V        Â½        0000       
                                        *11.1.1.3**
        GA-RRC **REQUEST\               **GA-RRC Message Type\      M          V        1                   
        REJECT** message identity       **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
86 GA-RRC Cause GA-RRC Cause\ M TLV 4  
11.2.86
* * *
### 10.3.4 GA-RRC RELEASE REQUEST
The MS sends this message to the GANC to indicate that the GANC should
initiate release of the signalling connection and related resources for the
indicated domain.
Direction: MS to GANC
Table 10.3.4.1: GA-RRC RELEASE REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\         M          V        2                   
                                        11.1.1**.1
        GA-RRC Protocol Discriminator   **Protocol Discriminator\   M          V        Â½        **0011**   
                                        11.1.1.2**
        Skip Indicator                  ***Skip Indicator\          M          V        Â½        0000       
                                        *11.1.1.3**
        GA-RRC RELEASE **REQUEST\       **GA-RRC Message Type\      M          V        1                   
        **message identity              **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
86 GA-RRC Cause GA-RRC Cause**\ M TLV 4  
11.2.86**
* * *
### 10.3.5 GA-RRC RELEASE
The GANC sends this message to the MS to instruct the MS to release all GA-RRC
related resources for the indicated domain.
Direction: GANC to MS
Table 10.3.5.1: GA-RRC RELEASE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      **Length Indicator\         M          V        2                   
                                              11.1.1**.1
        GA-RRC Protocol Discriminator         **Protocol Discriminator\   M          V        Â½        **0011**   
                                              11.1.1.2**
        Skip Indicator                        ***Skip Indicator\          M          V        Â½        0000       
                                              *11.1.1.3**
        GA-RRC **RELEASE** message identity   **GA-RRC Message Type\      M          V        1                   
                                              **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
86 GA-RRC Cause GA-RRC Cause\ M TLV 4  
11.2.86
* * *
### 10.3.6 GA-RRC RELEASE COMPLETE
The MS sends this message to the GANC to acknowledge the release of all GA-RRC
related resources for the indicated domain.
Direction: MS to GANC
Table 10.3.6.1: GA-RRC RELEASE COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                               **Length Indicator\         M          V        2                   
                                                       11.1.1**.1
        GA-RRC Protocol Discriminator                  **Protocol Discriminator\   M          V        Â½        **0011**   
                                                       11.1.1.2**
        Skip Indicator                                 ***Skip Indicator\          M          V        Â½        0000       
                                                       *11.1.1.3**
        GA-RRC **RELEASE COMPLETE** message identity   **GA-RRC Message Type\      M          V        1                   
                                                       **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
* * *
### 10.3.7 GA-RRC PAGING REQUEST
The GANC uses this message to transmit paging information received from the CN
to the MS.
Direction: GANC to MS
Table 10.3.7.1: GA-RRC PAGING REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC **PAGING REQUEST** message identity   **GA-RRC Message Type\      M          V        1                   
                                                     **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
1 IMSI or (P)-TMSI Mobile Identity\ M TLV 7-10  
11.2.1
87 GA-RRC Paging Cause GA-RRC Paging Cause\ O TLV 3  
11.2.87
* * *
### 10.3.8 GA-RRC ACTIVATE CHANNEL
The GANC sends this message to the MS to initiate channel activation.
Direction: GANC to MS
**Table 10.3.8.1: GA-RRC ACTIVATE CHANNEL** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           **Length Indicator\         M          V        2                   
                                                   11.1.1**.1
        GA-RRC Protocol Discriminator              **Protocol Discriminator\   M          V        Â½        **0011**   
                                                   11.1.1.2**
        Skip Indicator                             ***Skip Indicator\          M          V        Â½        0000       
                                                   *11.1.1.3**
        GA-RRC ACTIVATE CHANNEL message identity   **GA-RRC Message Type\      M          V        1                   
                                                   **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
89 CTC Activation List CTC Activation List\ C TLV n  
11.2.89
115 PTC Activation List PTC Activation List\ C TLV n  
11.2.96
* * *
#### 10.3.8.1 CTC Activation List
The CTC (Circuit Transport Channel) Activation List information element shall
be included if the IE \"CN Domain Identity\" indicates the CS domain.
#### 10.3.8.2 PTC Activation List
The PTC (Packet Transport Channel) Activation List information element shall
be included if the IE \"CN Domain Identity\" indicates the PS domain.
### 10.3.9 GA-RRC ACTIVATE CHANNEL ACK
The MS sends this message to the GANC to acknowledge the channel activation
request.
Direction: MS to GANC
**Table 10.3.9.1: GA-RRC ACTIVATE CHANNEL ACK** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                               **Length Indicator\         M          V        2                   
                                                       11.1.1**.1
        GA-RRC Protocol Discriminator                  **Protocol Discriminator\   M          V        Â½        **0011**   
                                                       11.1.1.2**
        Skip Indicator                                 ***Skip Indicator\          M          V        Â½        0000       
                                                       *11.1.1.3**
        GA-RRC ACTIVATE CHANNEL ACK message identity   **GA-RRC Message Type\      M          V        1                   
                                                       **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
91 CTC Activation Ack List CTC Activation Ack List\ C TLV n  
11.2.91
117 PTC Activation Ack List PTC Activation Ack List\ C TLV n  
11.2.98
* * *
#### 10.3.9.1 CTC Activation Ack List
The CTC Activation Ack List information element shall be included if the IE
\"CN Domain Identity\" indicates the CS domain.
#### 10.3.9.2 PTC Activation Ack List
The PTC Activation Ack List information element shall be included if the IE
\"CN Domain Identity\" indicates the PS domain.
### 10.3.10 GA-RRC ACTIVATE CHANNEL COMPLETE
The GANC sends this message to the MS to indicate the completion of the
channel activation.
Direction: GANC to MS
**Table 10.3.10.1: GA-RRC ACTIVATE CHANNEL COMPLETE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                    **Length Indicator\         M          V        2                   
                                                            11.1.1**.1
        GA-RRC Protocol Discriminator                       **Protocol Discriminator\   M          V        Â½        **0011**   
                                                            11.1.1.2**
        Skip Indicator                                      ***Skip Indicator\          M          V        Â½        0000       
                                                            *11.1.1.3**
        GA-RRC ACTIVATE CHANNEL COMPLETE message identity   **GA-RRC Message Type\      M          V        1                   
                                                            **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
* * *
### 10.3.11 GA-RRC MODIFY CHANNEL
The GANC sends this message to the MS to initiate channel modification.
Direction: GANC to MS
**Table 10.3.11.1: GA-RRC MODIFY CHANNEL** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                         **Length Indicator\         M          V        2                   
                                                 11.1.1**.1
        GA-RRC Protocol Discriminator            **Protocol Discriminator\   M          V        Â½        **0011**   
                                                 11.1.1.2**
        Skip Indicator                           ***Skip Indicator\          M          V        Â½        0000       
                                                 *11.1.1.3**
        GA-RRC MODIFY CHANNEL message identity   **GA-RRC Message Type\      M          V        1                   
                                                 **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
93 CTC Modification List CTC Modification List\ C TLV n  
11.2.93
119 PTC Modification List PTC Modification List\ C TLV n  
11.2.100
* * *
#### 10.3.11.1 CTC Modification List
The CTC (Circuit Transport Channel) Modification List information element
shall be included if the IE \"CN Domain Identity\" indicates the CS domain.
#### 10.3.11.2 PTC Modification List
The PTC (Packet Transport Channel) Modification List information element shall
be included if the IE \"CN Domain Identity\" indicates the PS domain.
### 10.3.12 GA-RRC MODIFY CHANNEL ACK
The MS sends this message to the GANC to acknowledge the successful channel
modification.
Direction: MS to GANC
**Table 10.3.12.1: GA-RRC MODIFY CHANNEL ACK** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                **Length Indicator\          M          V        2                   
                                        11.1.1**.1
        GA-RRC Protocol Discriminator   **Protocol Discriminator\    M          V        Â½        **0011**   
                                        11.1.1.2**
        Skip Indicator                  ***Skip Indicator\           M          V        Â½        0000       
                                        *11.1.1.3**
        GA-RRC MODIFY CHANNEL ACK\      **GA-RRC Message Type\       M          V        1                   
        message identity                **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
94 CTC Modification Ack List CTC Modification Ack List\ C TLV n  
11.2.94
120 PTC Modification Ack List PTC Modification Ack List\ C TLV n  
11.2.101
* * *
#### 10.3.12.1 CTC Modification Ack List
The CTC (Circuit Transport Channel) Modification Ack List information element
shall be included if the IE \"CN Domain Identity\" indicates the CS domain.
#### 10.3.12.2 PTC Modification Ack List
The PTC (Packet Transport Channel) Modification Ack List information element
shall be included if the IE \"CN Domain Identity\" indicates the PS domain.
### 10.3.13 GA-RRC DEACTIVATE CHANNEL REQUEST
The MS sends this message to the GANC to request the GANC to deactivate the
channel(s) identified in the message for the indicated domain.
Direction: MS to GANC
**Table 10.3.13.1: GA-RRC DEACTIVATE CHANNEL REQUEST** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                     **Length Indicator\         M          V        2                   
                                                             11.1.1**.1
        GA-RRC Protocol Discriminator                        **Protocol Discriminator\   M          V        Â½        **0011**   
                                                             11.1.1.2**
        Skip Indicator                                       ***Skip Indicator\          M          V        Â½        0000       
                                                             *11.1.1.3**
        GA-RRC DEACTIVATE CHANNEL REQUEST message identity   **GA-RRC Message Type\      M          V        1                   
                                                             **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
84 RAB ID List RAB ID List\ M TLV n  
11.2.84
86 GA-RRC Cause GA-RRC Cause\ M TLV 4  
11.2.86
* * *
### 10.3.14 GA-RRC DEACTIVATE CHANNEL
The GANC sends this message to the MS to instruct the MS to deactivate the
channel(s) identified in the message for the indicated domain.
Direction: GANC to MS
**Table 10.3.14.1: GA-RRC DEACTIVATE CHANNEL** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC DEACTIVATE CHANNEL message identity   **GA-RRC Message Type\      M          V        1                   
                                                     **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
84 RAB ID List RAB ID List\ M TLV n  
11.2.84
* * *
### 10.3.15 GA-RRC DEACTIVATE CHANNEL COMPLETE
The MS sends this message to the GANC to indicate the completion of the
channel deactivation.
Direction: MS to GANC
**Table 10.3.15.1: GA-RRC DEACTIVATE CHANNEL COMPLETE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                      **Length Indicator\         M          V        2                   
                                              11.1.1**.1
        GA-RRC Protocol Discriminator         **Protocol Discriminator\   M          V        Â½        **0011**   
                                              11.1.1.2**
        Skip Indicator                        ***Skip Indicator\          M          V        Â½        0000       
                                              *11.1.1.3**
        GA-RRC DEACTIVATE CHANNEL COMPLETE\   **GA-RRC Message Type\      M          V        1                   
        message identity                      **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
* * *
### 10.3.16 GA-RRC SECURITY MODE COMMAND
The GANC sends this message to the MS to indicate the selected integrity
algorithm and (optionally) the selected encryption algorithm. The message also
includes a random number used to authenticate the MS.
Direction: GANC to MS
**Table 10.3.16.1: GA-RRC SECURITY MODE COMMAND** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                **Length Indicator\                          M          V        2                   
                                                        11.1.1**.1
        GA-RRC Protocol Discriminator                   **Protocol Discriminator\                    M          V        Â½        **0011**   
                                                        11.1.1.2**
        Skip Indicator                                  ***Skip Indicator\                           M          V        Â½        0000       
                                                        *11.1.1.3**
        GA-RRC SECURITY MODE COMMAND message identity   **GA-RRC Message Type\                       M          V        1                   
                                                        **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
124 Selected Integrity Protection Algorithm Selected Integrity Protection
Algorithm**\ M TLV 3  
11.2.105**
46 Random Number Ciphering Command RAND**\ M TLV 18  
11.2.46**
125 Selected Encryption Algorithm Selected Encryption Algorithm\ O TLV 3  
11.2.106
* * *
### 10.3.17 GA-RRC SECURITY MODE COMPLETE
The MS sends this message to the GANC to provide the MS response to the
authentication challenge.
Direction: MS to GANC
**Table 10.3.17.1: GA-RRC SECURITY MODE COMPLETE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                 **Length Indicator\         M          V        2                   
                                         11.1.1**.1
        GA-RRC Protocol Discriminator    **Protocol Discriminator\   M          V        Â½        **0011**   
                                         11.1.1.2**
        Skip Indicator                   ***Skip Indicator\          M          V        Â½        0000       
                                         *11.1.1.3**
        GA-RRC SECURITY MODE COMPLETE\   **GA-RRC Message Type\      M          V        1                   
        message identity                 **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
47 Message Authentication Code Ciphering Command MAC\ M TLV 14  
11.2.47
* * *
### 10.3.18 GA-RRC INITIAL DIRECT TRANSFER
The MS sends this message to the GANC to transfer the initial NAS PDU from the
MS to the indicated core network domain.
Direction: MS to GANC
Table 10.3.18.1: GA-RRC INITIAL DIRECT TRANSFER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                      **Length Indicator\                 M          V        2                        
                                                              11.1.1**.1
        GA-RRC Protocol Discriminator                         **Protocol Discriminator\           M          V        Â½             **0011**   
                                                              11.1.1.2**
        Skip Indicator                                        ***Skip Indicator\                  M          V        Â½             0000       
                                                              *11.1.1.3**
        GA-RRC **INITIAL DIRECT TRANSFER** message identity   **GA-RRC Message Type\              M          V        1                        
                                                              **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
88 Intra Domain NAS Node Selector Intra Domain NAS Node Selector**\ M TLV 5  
11.2.88**
26 L3 Message **L3 Message\ M TLV Var. Length  
11.2.26**
* * *
### 10.3.19 GA-RRC UPLINK DIRECT TRANSFER
The MS sends this message to the GANC to transfer a subsequent (i.e., other
than the initial) NAS PDU from the MS to the indicated core network domain.
Direction: MS to GANC
Table 10.3.19.1: GA-RRC UPLINK DIRECT TRANSFER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                     **Length Indicator\         M          V        2                        
                                                             11.1.1**.1
        GA-RRC Protocol Discriminator                        **Protocol Discriminator\   M          V        Â½             **0011**   
                                                             11.1.1.2**
        Skip Indicator                                       ***Skip Indicator\          M          V        Â½             0000       
                                                             *11.1.1.3**
        GA-RRC **UPLINK DIRECT TRANSFER** message identity   **GA-RRC Message Type\      M          V        1                        
                                                             **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
26 L3 Message **L3 Message\ M TLV Var. Length  
11.2.26**
* * *
### 10.3.20 GA-RRC DOWNLINK DIRECT TRANSFER
The GANC sends this message to the MS to transfer a NAS PDU from the indicated
core network domain to the MS.
Direction: GANC to MS
Table 10.3.20.1: GA-RRC DOWNLINK DIRECT TRANSFER message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                       **Length Indicator\         M          V        2                        
                                                               11.1.1**.1
        GA-RRC Protocol Discriminator                          **Protocol Discriminator\   M          V        Â½             **0011**   
                                                               11.1.1.2**
        Skip Indicator                                         ***Skip Indicator\          M          V        Â½             0000       
                                                               *11.1.1.3**
        GA-RRC **DOWNLINK DIRECT TRANSFER** message identity   **GA-RRC Message Type\      M          V        1                        
                                                               **11.1.3a.1
80 CN Domain Identity **CN Domain Identity\ M TLV 3  
11.2.80**
26 L3 Message **L3 Message\ M TLV Var. Length  
11.2.26**
* * *
### 10.3.21 GA-RRC RELOCATION INFORMATION
The MS triggers the handover from GAN Iu mode procedure indicating the list of
cell identifiers in the target radio access technology.
Direction: MS to GANC
Table 10.3.21.1: GA-RRC RELOCATION INFORMATION message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                 **Length Indicator\                 M          V        2                   
                                                         11.1.1**.1
        GA-RRC Protocol Discriminator                    **Protocol Discriminator\           M          V        Â½        **0011**   
                                                         11.1.1.2**
        Skip Indicator                                   ***Skip Indicator\                  M          V        Â½        0000       
                                                         *11.1.1.3**
        GA-RRC RELOCATION INFORMATION message identity   **GA-RRC Message Type\              M          V        1                   
                                                         **11.1.3a.1
126 CN Domains to Handover **CN Domains to Handover\ M TLV 3  
11.2.107**
15 GERAN Cell Identifier List Cell Identifier List\ O TLV n  
11.2.15
106 GERAN Received Signal Level List GERAN Received Signal Level List\ C TLV n  
11.2.70
66 UTRAN Cell Identifier List UTRAN Cell Identifier List\ O TLV n  
11.2.66
107 UTRAN Received Signal Level List UTRAN Received Signal Level List\ C TLV n  
11.2.70b
28 Mobile Station Classmark 2 Mobile Station Classmark 2\ O TLV 5  
11.2.28
56 Mobile Station Classmark 3 Mobile Station Classmark 3\ O TLV 3-34  
11.2.56
128 MS Radio Access Capability MS Radio Access Capability\ O TLV 4-67  
11.2.112
64 UTRAN Classmark UTRAN Classmark\ C TLV n  
11.2.64
* * *
#### 10.3.21.1 GERAN Cell Identifier List
The GERAN Cell Identifier List information element shall be included if
handover to a GERAN cell is requested by the mobile station. The cells are
ranked in descending order of preference according to measured value.
#### 10.3.21.2 GERAN Received Signal Level List
The GERAN Received Signal Level List information element shall be included if
the GERAN Cell Identifier List information element is included. It contains
the received signal quality for each cell included in the GERAN Cell
Identifier List information element. The order of the measurements in the
GERAN Received Signal Level List shall be the same as the order of the cell
identifiers included in the GERAN Cell Identifier List information element.
#### 10.3.21.3 UTRAN Cell Identifier List
The UTRAN Cell Identifier List information element shall be included if
handover to an UTRAN cell is requested by the mobile station. The cells are
ranked in descending order according to measured Ec/No value.
#### 10.3.21.4 UTRAN Received Signal Level List
The UTRAN Received Signal Level List information element shall be included if
the UTRAN Cell Identifier List information element is included. It contains
the received signal quality for each cell included in the UTRAN Cell
Identifier List information element. The order of the measurements in the
UTRAN Received Signal Level List shall be the same as the order of the cell
identifiers included in the UTRAN Cell Identifier List information element.
NOTE: At least one of the cell identifier list IEs must be present.
#### 10.3.21.5 Mobile Station Classmark 2
The Mobile Station Classmark 2 information element shall be included if the
GERAN Cell Identifier List information element is included. It shall also be
included if the MS is GERAN capable and the UTRAN Cell Identifier List
information element is included.
#### 10.3.21.6 Mobile Station Classmark 3
The Mobile Station Classmark 3 information element shall be included if the
GERAN Cell Identifier List information element is included. It shall also be
included if the MS is GERAN capable and the UTRAN Cell Identifier List
information element is included.
#### 10.3.21.7 MS Radio Access Capability
The MS Radio Access Capability information element shall be included if the
GERAN Cell Identifier List information element is included. It shall also be
included if the MS is GERAN capable and the UTRAN Cell Identifier List
information element is included.
#### 10.3.21.8 UTRAN Classmark
The UTRAN Classmark information element shall be included if the UTRAN Cell
Identifier List information element is included. This IE includes the INTER
RAT HANDOVER INFO message defined in TS 25.331 [40]. The INTER RAT HANDOVER
INFO message shall include the UE security information IE and the UE security
information2 IE, in addition to the mandatory content of the message.
### 10.3.22 GA-RRC RELOCATION COMMAND
The GANC sends this message to the MS to order the MS to handover from GAN Iu
mode.
Direction: GANC to MS
Table 10.3.22.1: GA-RRC RELOCATION COMMAND message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC RELOCATION COMMAND message identity   **GA-RRC Message Type\      M          V        1                   
                                                     **11.1.3a.1
126 CN Domains to Handover **CN Domains to Handover\ M TLV 3  
11.2.107**
78 UTRAN RRC Message **UTRAN RRC Message\ M TLV n  
11.2.111**
127 SRNS Relocation Info **UTRAN RRC Message\ C TLV N  
11.2.111**
* * *
#### 10.3.22.1 UTRAN RRC Message
If the target radio access technology is GERAN, the value part of the UTRAN
RRC Message IE is coded as the HANDOVER FROM UTRAN COMMAND message specified
in [40]. If the target RAT is UTRAN, the value part of the UTRAN RRC Message
IE is coded as the UTRAN reconfiguration message received from the target RNS
as specified in [40]; e.g., PHYSICAL CHANNEL RECONFIGURATION.
#### 10.3.22.2 SRNS Relocation Info
The SRNS Relocation Info information element includes the SRNS RELOCATION INFO
message defined in TS 25.331 [40]. This IE shall be included if the target
radio access technology is UTRAN. The content is the same as the SRNS
RELOCATION INFO message content sent by the GANC to the target RNC in the
Source RNC to Target RNC Transparent Container. Note that the type of this IE
is the same as the UTRAN RRC Message defined in sub-clause 11.2.111, with the
exception that the IEI is 2-octets in length.
### 10.3.23 GA-RRC RELOCATION ACCESS
The MS sends this message to the GANC to indicate that the MS has been
commanded to handover a CS domain session to GAN Iu mode but the GA-RRC CS
domain sub-layer entity in the MS is not yet in the GA-RRC CONNECTED state.
Direction: MS to GANC
Table 10.3.23.1: GA-RRC RELOCATION ACCESS message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                            **Length Indicator\         M          V        2                   
                                                    11.1.1**.1
        GA-RRC Protocol Discriminator               **Protocol Discriminator\   M          V        Â½        **0011**   
                                                    11.1.1.2**
        Skip Indicator                              ***Skip Indicator\          M          V        Â½        0000       
                                                    *11.1.1.3**
        GA-RRC RELOCATION ACCESS message identity   **GA-RRC Message Type\      M          V        1                   
                                                    **11.1.3a.1
78 UTRAN RRC Message **UTRAN RRC Message\ M TLV n  
11.2.111**
* * *
#### 10.3.23.1 UTRAN RRC Message
This information element contains the entire UTRAN RRC handover message
received via the source radio access technology. If the source radio access
technology is GERAN, the value part of the UTRAN RRC Message IE is coded as
the HANDOVER TO UTRAN COMMAND message specified in [40]. If the source RAT is
UTRAN, the value part of the UTRAN RRC Message IE is coded as the UTRAN
reconfiguration message received from the target RNS as specified in [40];
e.g., PHYSICAL CHANNEL RECONFIGURATION.
### 10.3.24 GA-RRC RELOCATION COMPLETE
The MS sends this message to the GANC to indicate that the handover to GAN Iu
mode is complete.
Direction: MS to GANC
Table 10.3.24.1: GA-RRC RELOCATION COMPLETE message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                              **Length Indicator\             M          V        2                   
                                                      11.1.1**.1
        GA-RRC Protocol Discriminator                 **Protocol Discriminator\       M          V        Â½        **0011**   
                                                      11.1.1.2**
        Skip Indicator                                ***Skip Indicator\              M          V        Â½        0000       
                                                      *11.1.1.3**
        GA-RRC RELOCATION COMPLETE message identity   **Message Type\                 M          V        1                   
                                                      11.1.1.4**
126 CN Domains to Handover **CN Domains to** Handover**\ M TLV 3  
11.2.107**
* * *
### 10.3.25 GA-RRC RELOCATION FAILURE
The MS sends this message to the GANC to indicate failure to complete the
handover from GAN Iu mode procedure.
Direction: MS to GANC
**Table 10.3.25.1: GA-RRC RELOCATION FAILURE** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\         M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\   M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\          M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC RELOCATION FAILURE message identity   **GA-RRC Message Type\      M          V        1                   
                                                     **11.1.3a.1
86 GA-RRC Cause GA-RRC Cause**\ M TLV 4  
11.2.86**
* * *
### 10.3.26 GA-RRC RELOCATION REQUEST
The GANC sends this message to the MS to request activation of one or more
CTCs, one or more PTCs or a combination of CTCs and PTCs, for the purpose of
handover to GAN Iu mode.
Direction: GANC to MS
Table 10.3.26.1: GA-RRC RELOCATION REQUEST message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                             **Length Indicator\             M          V        2                   
                                                     11.1.1**.1
        GA-RRC Protocol Discriminator                **Protocol Discriminator\       M          V        Â½        **0011**   
                                                     11.1.1.2**
        Skip Indicator                               ***Skip Indicator\              M          V        Â½        0000       
                                                     *11.1.1.3**
        GA-RRC RELOCATION REQUEST message identity   **GA-RRC Message Type\          M          V        1                   
                                                     **11.1.3a.1
126 CN Domains to Handover **CN Domains to** Handover**\ M TLV 3  
11.2.107**
89 CTC Activation List CTC Activation List\ C TLV n  
11.2.89
115 PTC Activation List PTC Activation List\ C TLV n  
11.2.96
* * *
#### 10.3.26.1 CTC Activation List
The CTC (Circuit Transport Channel) Activation List information element shall
be included if the IE \"CN Domains to Handover\" indicates the CS domain or
both CS and PS domains.
#### 10.3.26.2 PTC Activation List
The PTC (Packet Transport Channel) Activation List information element shall
be included if the IE \"CN Domains to Handover\" indicates the PS domain or
both CS and PS domains.
### 10.3.27 GA-RRC RELOCATION REQUEST ACK
The MS sends this message to the GANC to acknowledge the relocation request.
Direction: MS to GANC
Table 10.3.27.1: GA-RRC RELOCATION REQUEST ACK message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                 **Length Indicator\             M          V        2                   
                                                         11.1.1**.1
        GA-RRC Protocol Discriminator                    **Protocol Discriminator\       M          V        Â½        **0011**   
                                                         11.1.1.2**
        Skip Indicator                                   ***Skip Indicator\              M          V        Â½        0000       
                                                         *11.1.1.3**
        GA-RRC RELOCATION REQUEST ACK message identity   **GA-RRC Message Type\          M          V        1                   
                                                         **11.1.3a.1
126 CN Domains to Handover **CN Domains to** Handover**\ M TLV 3  
11.2.107**
91 CTC Activation Ack List CTC Activation Ack List\ C TLV n  
11.2.91
117 PTC Activation Ack List PTC Activation Ack List\ C TLV n  
11.2.98
* * *
#### 10.3.27.1 CTC Activation Ack List
The CTC Activation Ack List information element shall be included if the IE
\"CN Domains to Handover\" indicates the CS domain or both CS and PS domains.
#### 10.3.27.2 PTC Activation Ack List
The PTC Activation Ack List information element shall be included if the IE
\"CN Domains to Handover\" indicates the PS domain or both CS and PS domains.
### 10.3.28 GA-RRC UPLINK QUALITY INDICATION
The GANC sends this message to the MS to indicate changes in the uplink
quality, which may be used by the MS to trigger the handover from GAN Iu mode
procedure.
Direction: GANC to MS
**Table 10.3.28.1: GA-RRC UPLINK QUALITY INDICATION** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                    **Length Indicator\         M          V        2                   
                                                            11.1.1**.1
        GA-RRC Protocol Discriminator                       **Protocol Discriminator\   M          V        Â½        **0011**   
                                                            11.1.1.2**
        Skip Indicator                                      ***Skip Indicator\          M          V        Â½        0000       
                                                            *11.1.1.3**
        GA-RRC UPLINK QUALITY INDICATION message identity   **GA-RRC Message Type\      M          V        1                   
                                                            **11.1.3a.1
33 UL Quality Indication UL Quality Indication\ M V 3  
11.2.33
* * *
### 10.3.29 GA-RRC STATUS
The MS sends this message to the GANC to communicate various error conditions.
Direction: MS to GANC
**Table 10.3.29.1: GA-RRC STATUS** message content
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                 **Length Indicator\         M          V        2                   
                                         11.1.1**.1
        GA-RRC Protocol Discriminator    **Protocol Discriminator\   M          V        Â½        **0011**   
                                         11.1.1.2**
        Skip Indicator                   ***Skip Indicator\          M          V        Â½        0000       
                                         *11.1.1.3**
        GA-RRC STATUS message identity   **GA-RRC Message Type\      M          V        1                   
                                         **11.1.3a.1
86 GA-RRC Cause GA-RRC Cause**\ M TLV 4  
11.2.86**
52 PDU Error PDU in Error**\ M TLV 6-257  
11.2.52**
* * *
## 10.4 GA-RRC PS user plane messages
Table 10.4.1 summarizes the GA-RRC PS user plane messages.
Table 10.4.1: GA-RRC PS user plane messages
* * *
GA-RRC control plane messages: Reference GA-RRC PDU 10.4.1
* * *
### 10.4.1 GA-RRC PDU
This message is used to tunnel uplink and downlink PS domain user data between
the MS and the GANC. See sub-clause 11.1.3b for a description of the fields in
this message.
Direction: MS to GANC and GANC to MS
* * *
8 7 6 5 4 3 2 1  
Version PT spare E S PN octet 1  
Message Type octet 2  
Length octet 3-4  
TEID octet 5-8  
Sequence Number octet 9-10  
N-PDU Number octet 11  
Next Extension Header Type octet 12  
PS Domain User Data
* * *
Figure 10.4.1.1: GA-RRC PDU message contents
# 11 General message format and information elements coding
## 11.1 Message coding principles
Five different message headers are defined in this specification:
\- Message header for the GA-RC and GA-CSR messages (defined in sub-clause
11.1.1)
\- Message header for the GA-PSR messages sent over the TCP-based signalling
channel (defined in sub-clause 11.1.2)
\- Message header for the GA-PSR messages sent over the UDP-based GA-PSR
Transport Channel (defined in sub-clause 11.1.3)
\- Message header for the GA-RRC messages sent over the TCP-based signalling
channel (defined in sub-clause 11.1.3a)
\- Message header for the GA-RRC messages sent over the UDP-based GA-RRC
Packet Transport Channel (defined in sub-clause 11.1.3b)
The principles for information element coding are described in sub-clause
11.1.4.
### 11.1.1 GA-RC and GA-CSR message header information elements
Each GA-RC and GA-CSR message begins with a 4-octet message header, as shown
in Table 11.1.1.1. This message header consists of the following information
elements: Length Indicator, Protocol Discriminator, Skip Indicator and Message
Type. These IEs are described in the following sub-clauses.
Note that these information elements are also present in both the GA-PSR
message header and the GA-RRC message header defined in sub-clauses 11.1.2 and
11.1.3a, respectively. However, the GA-PSR and GA-RRC message headers include
additional information elements.
Table 11.1.1.1: GA-RC and GA-CSR message header contents
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                                                                                                             **Length Indicator\         M          V        2                
                                                                                                                                                     11.1.1.1**
        GA-RC and GA-CSR Protocol Discriminator                                                                                                      **Protocol Discriminator\   M          V        Â½        0001    
                                                                                                                                                     11.1.1.2**
        Skip Indicator                                                                                                                               Skip Indicator\             M          V        Â½        0000    
                                                                                                                                                     11.1.1.3
        GA-RC and GA-CSR Message Type                                                                                                                **Message Type\             M          V        1                
                                                                                                                                                     11.1.1.4**
        Here continues the list of IE\'s using TLV coding format and depending on Protocol Discriminator and Message Type as defined in clause 10.
* * *
#### 11.1.1.1 Length Indicator (LI)
The first two octets of the message header contains the Length Indicator (LI)
information element. The LI is needed as each message is transported using
TCP, which provides a \'stream-of-bytes\' transmission i.e. no message
concept, or message length concept is provided by TCP and this has to be
handled in the application layer.
This field specifies the total length of the message
**[excluding]{.underline}** the 2 octets for Length Indicator.
Minimum value for LI is 2 and maximum value is defined as 2048.
For example: For a message of total length of 20 octets, this field is coded
with the decimal value of 18. Then there follows 18 octets of message (i.e.
total length of TCP-data is 20 octets).
* * *
8 7 6 5 4 3 2 1  
LI MSB octet 1  
LI LSB octet 2
* * *
Figure 11.1.1.1.1. Length Indicator message header field
Table 11.1.1.1.1: Length Indicator message header field
+----------------------------------------------------------------------+ | LI value, Length Indicator value (octet 1 and 2) | | | | In the LI value field bit 8 of octet 1 is the most significant bit | | and bit 1of octet 2 the least significant bit. | | | | The Length Indicator consists of 2 octets. | +----------------------------------------------------------------------+
#### 11.1.1.2 Protocol Discriminator (PD)
Bits 1 to 4 of the third octet in the message header contain the Protocol
Discriminator (PD) information element. The PD identifies the upper layer
protocol to which the message belongs.
The following Protocol Discriminator values are defined:
Table 11.1.1.2.1: Protocol Discriminator Values
* * *
Protocol PD Value GA-RC 0 GA-CSR 1 GA-PSR 2 GA-RRC 3
* * *
#### 11.1.1.3 Skip Indicator
Bits 5 to 8 of the third octet in the message header contain the Skip
Indicator information element. A message received with Skip Indicator
different from 0000 shall be ignored. A message received with Skip Indicator
encoded as 0000 shall not be ignored (unless it is ignored for other reasons).
A protocol entity sending any message shall encode the Skip Indicator as 0000.
#### 11.1.1.4 Message Type
The Message Type IE is the fourth octet in the message header. Bit 8 of the
Message Type value is the most significant bit and bit 1 is the least
significant bit.
The following message types are defined for GA-RC and GA-CSR:
Table 11.1.1.4.1: Message Type values for GA-RC
* * *
GA-RC message name Message Type value (decimal) Message Type value (hex) GA-RC
DISCOVERY REQUEST 1 H\'01 GA-RC DISCOVERY ACCEPT 2 H\'02 GA-RC DISCOVERY
REJECT 3 H\'03 GA-RC REGISTER REQUEST 16 H\'10 GA-RC REGISTER ACCEPT 17 H\'11
GA-RC REGISTER REDIRECT 18 H\'12 GA-RC REGISTER REJECT 19 H\'13 GA-RC
DEREGISTER 20 H\'14 GA-RC REGISTER UPDATE UPLINK 21 H\'15 GA-RC REGISTER
UPDATE DOWNLINK 22 H\'16 GA-RC CELL BROADCAST INFO 23 H\'17 GA-RC KEEP ALIVE
116 H\'74 GA-RC SYNCHRONIZATION INFORMATION 120 H\'78
* * *
Table 11.1.1.4.2: Message Type values for GA-CSR
* * *
GA-CSR message name Message Type value (decimal) Message Type value (hex)
GA-CSR CIPHERING MODE COMMAND 32 H\'20
GA-CSR CIPHERING MODE COMPLETE 33 H\'21
GA-CSR ACTIVATE CHANNEL 48 H\'30
GA-CSR ACTIVATE CHANNEL ACK 49 H\'31
GA-CSR ACTIVATE CHANNEL COMPLETE 50 H\'32
GA-CSR ACTIVATE CHANNEL FAILURE 51 H\'33
GA-CSR CHANNEL MODE MODIFY 52 H\'34
GA-CSR CHANNEL MODE MODIFY\ 53 H\'35 ACKNOWLEDGE
GA-CSR RELEASE 64 H\'40
GA-CSR RELEASE COMPLETE 65 H\'41
GA-CSR CLEAR REQUEST 66 H\'42
GA-CSR HANDOVER ACCESS 80 H\'50
GA-CSR HANDOVER COMPLETE 81 H\'51
GA-CSR UPLINK QUALITY INDICATION 82 H\'52
GA-CSR HANDOVER INFORMATION 83 H\'53
GA-CSR HANDOVER COMMAND 84 H\'54
GA-CSR HANDOVER FAILURE 85 H\'55
GA-CSR PAGING REQUEST 96 H\'60
GA-CSR PAGING RESPONSE 97 H\'61
GA-CSR UPLINK DIRECT TRANSFER 112 H\'70
GA-CSR DOWNLINK DIRECT TRANSFER 114 H\'72
GA-CSR STATUS 115 H\'73
GA-CSR CLASSMARK ENQUIRY 117 H\'75
GA-CSR CLASSMARK CHANGE 118 H\'76
GA-CSR GPRS SUSPENSION REQUEST 119 H\'77
GA-CSR UTRAN CLASSMARK CHANGE 121 H\'79
GA-CSR REQUEST 128 H\'80
GA-CSR REQUEST ACCEPT 129 H\'81
GA-CSR REQUEST REJECT 130 H\'82
* * *
### 11.1.2 GA-PSR message header information elements over TCP
Each GA-PSR message sent over the TCP-based signalling channel begins with an
8-octet message header. This message header consists of the following
information elements: Length Indicator, Protocol Discriminator, Skip
Indicator, Message Type and TLLI. These IEs are described in the following
sub-clauses.
Table 11.1.2.1: GA-PSR (TCP) message header contents
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                                                                                                                             **Length Indicator\         M          V        2                
                                                                                                                                                     11.1.1.1**
        GA-PSR Protocol Discriminator                                                                                                                **Protocol Discriminator\   M          V        Â½        0010    
                                                                                                                                                     11.1.1.2**
        Skip Indicator                                                                                                                               ***Skip Indicator\          M          V        Â½        0000    
                                                                                                                                                     11.1.1.3***
        GA-PSR Message Type                                                                                                                          **GA-PSR Message Type\      M          V        1                
                                                                                                                                                     11.1.2.1**
        TLLI                                                                                                                                         **TLLI\                     M          V        4                
                                                                                                                                                     11.1.2.2**
        Here continues the list of IE\'s using TLV coding format and depending on Protocol Discriminator and Message Type as defined in clause 10.
* * *
#### 11.1.2.1 GA-PSR Message Type
The GA-PSR Message Type IE is the fourth octet in the GA-PSR (TCP) message
header. Bit 8 of the GA-PSR Message Type value is the most significant bit and
bit 1 is the least significant bit.
The following GA-PSR Message Type values are defined:
Table 11.1.2.1.1: GA-PSR Message Type values (TCP)
* * *
GA-PSR message name GA-PSR Message Type value (decimal) GA-PSR-DATA 1 GA-PSR-
PS-PAGE 3 GA-PSR-ACTIVATE-UTC-REQ 8 GA-PSR-ACTIVATE-UTC-ACK 9 GA-PSR-
DEACTIVATE-UTC-REQ 10 GA-PSR-DEACTIVATE-UTC-ACK 11 GA-PSR STATUS 12 GA-PSR
HANDOVER COMPLETE 13 GA-PSR UPLINK QUALITY INDICATION 14 GA-PSR HANDOVER
INFORMATION 15 GA-PSR HANDOVER COMMAND 16 GA-PSR HANDOVER CONTINUE 17 GA-PSR
HANDOVER FAILURE 18
* * *
#### 11.1.2.2 Temporary Logical Link Identity (TLLI)
Octets 5 to 8 of the GA-PSR (TCP) message header contain the Temporary Logical
Link Identity (TLLI) information element. The TLLI identifies the MS this
message was sent by or sent to.
### 11.1.3 GA-PSR message header information elements over UDP
Each GA-PSR message sent over the UDP-based GA-PSR Transport Channel begins
with a 7-octet message header. This message header consists of the following
information elements: GA-PSR Message Type, TLLI, and Sequence Number. These
IEs are described in the following sub-clauses.
Table 11.1.3.1: GA-PSR (UDP) message header contents
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        GA-PSR Message Type                                                                                                                          GA-PSR Message Type\   M          V        1                
                                                                                                                                                     11.1.3.1
        TLLI                                                                                                                                         TLLI\                  M          V        4                
                                                                                                                                                     11.1.3.2
        Sequence Number                                                                                                                              Sequence Number\       M          V        2                
                                                                                                                                                     11.1.3.3
        Here continues the list of IE\'s using TLV coding format and depending on Protocol Discriminator and Message Type as defined in clause 10.
* * *
#### 11.1.3.1 GA-PSR Message Type
The GA-PSR Message Type IE is the first octet in the GA-PSR (UDP) message
header. Bit 8 of the GA-PSR Message Type value is the most significant bit and
bit 1 is the least significant bit.
The following GA-PSR Message Type values are defined:
Table 11.1.3.1.1: GA-PSR Message Type values (UDP)
* * *
GA-PSR message name GA-PSR Message Type value (decimal) GA-PSR UNITDATA 2 GA-
PSR-UFC-REQ 6 GA-PSR-DFC-REQ 7
* * *
#### 11.1.3.2 Temporary Logical Link Identity (TLLI)
Octets 2 to 5 of the GA-PSR (UDP) message header contain the Temporary Logical
Link Identity (TLLI) information element. The TLLI identifies the MS this
message was sent by or sent to.
#### 11.1.3.3 Sequence Number
Octets 6 to 7 of the GA-PSR (UDP) message header contain the Sequence Number
information element with value in the range of 0 to 65535.
### 11.1.3a GA-RRC message header information elements over TCP
Each GA-RRC message sent over the TCP-based signalling channel begins with a
4-octet message header. This message header consists of the following
information elements: Length Indicator, Protocol Discriminator, Skip
Indicator, and GA-RRC Message Type. These IEs are described in the following
sub-clauses.
Table 11.1.3a.1: GA-RRC (TCP) message header contents
* * *
IEI Information Element Type/Reference Presence Format Length Value Notes
        Length Indicator                           **Length Indicator\         M          V        2                
                                                   11.1.1.1**
        GA-RRC Protocol Discriminator              **Protocol Discriminator\   M          V        Â½        0011    
                                                   11.1.1.2**
        Skip Indicator                             ***Skip Indicator\          M          V        Â½        0000    
                                                   11.1.1.3***
        GA-RRC Message Type                        **GA-RRC Message Type\      M          V        1                
                                                   11.1.3a.1**
        Other IEs as defined in sub-clause 10.3.
* * *
#### 11.1.3a.1 GA-RRC Message Type
The GA-RRC Message Type IE is the fourth octet in the GA-RRC (TCP) message
header. Bit 8 of the GA-RRC Message Type value is the most significant bit and
bit 1 is the least significant bit.
The following GA-RRC (TCP) Message Type values are defined:
Table 11.1.3a.1.1: GA-RRC Message Type values (TCP)
* * *
GA-RRC message name GA-RRC Message Type value\ (decimal)
GA-RRC REQUEST 1
GA-RRC REQUEST ACCEPT 2
GA-RRC REQUEST REJECT 3
GA-RRC RELEASE REQUEST 4
GA-RRC RELEASE 5
GA-RRC RELEASE COMPLETE 6
GA-RRC PAGING REQUEST 7
GA-RRC ACTIVATE CHANNEL 8
GA-RRC ACTIVATE CHANNEL ACK 9
GA-RRC ACTIVATE CHANNEL COMPLETE 10
GA-RRC MODIFY CHANNEL 11
GA-RRC MODIFY CHANNEL ACK 12
GA-RRC DEACTIVATE CHANNEL REQUEST 13
GA-RRC DEACTIVATE CHANNEL 14
GA-RRC DEACTIVATE CHANNEL COMPLETE 15
GA-RRC SECURITY MODE COMMAND 16
GA-RRC SECURITY MODE COMPLETE 17
GA-RRC INITIAL DIRECT TRANSFER 18
GA-RRC UPLINK DIRECT TRANSFER 19
GA-RRC DOWNLINK DIRECT TRANSFER 20
GA-RRC RELOCATION INFORMATION 21
GA-RRC RELOCATION COMMAND 22
GA-RRC RELOCATION ACCESS 23
GA-RRC RELOCATION COMPLETE 24
GA-RRC RELOCATION FAILURE 25
GA-RRC RELOCATION REQUEST 26
GA-RRC RELOCATION REQUEST ACK 27
GA-RRC UPLINK QUALITY INDICATION 28
GA-RRC STATUS 29
* * *
### 11.1.3b GA-RRC message header over UDP
Each GA-RRC message sent over the UDP-based Packet Transport Channel begins
with a message header that is as defined for the G-PDU message in the GTP-U
protocol in [53]. The message header is shown below for information. See [53]
for a description of each field.
* * *
8 7 6 5 4 3 2 1  
Version PT spare E S PN octet 1  
Message Type octet 2  
Length octet 3-4  
TEID octet 5-8  
Sequence Number octet 9-10  
N-PDU Number octet 11  
Next Extension Header Type octet 12
* * *
Figure 11.1.3b.1: GA-RRC (PTC) message header contents
Table 11.1.3b.1: GA-RRC (PTC) message header description
+----------------------------------------------------------------------+ | **Version** (octet 1) | | | | The Version field shall be set to value \'001\'. | | | | **PT,** Payload Type (octet 1) | | | | The Payload Type field shall be set to value \'1\'. | | | | **E,** Extensions Header Flag (octet 1) | | | | The use of the Extensions Header Flag is described in [53]. The MS | | shall set the E field to value \'0\' for all messages sent to the | | GANC and disregard all extension fields if present in messages | | received from the GANC. | | | | **S,** Sequence Number Flag (octet 1) | | | | Bit | | | | 2 | | | | 0 The Sequence Number field is not present or is present but not | | meaningful | | | | 1 The Sequence Number field is present | | | | See sub-clause 11.1.3b.2 for the handling of this field. | | | | **PN,** N-PDU Number Flag (octet 1) | | | | Bit | | | | 1 | | | | 0 The N-PDU Number field is not present or is present but not | | meaningful | | | | 1 The N-PDU Number field is present | | | | The MS shall set PN to value \'0\' for all messages sent to the | | GANC. | | | | **Message Type** (octet 2) | | | | The GTP-U Message Type field carries the GA-RRC PTC Message Type | | value as defined in sub-clause 11.1.3b.1. | | | | **Length** (octet 3-4) | | | | This field indicates the length in octets of the payload; i.e., the | | rest of the message following the mandatory part of the header (that | | is the first 8 octets). | | | | The MSB is octet 3 and the LSB is octet 4. | | | | **TEID, Tunnel Endpoint ID (octet 5-8)** | | | | This field contains the TEID value that has been assigned to the MS | | (for downlink messages) or the GANC (for uplink messages) for the | | PTC to which this message belongs. The format is as defined in | | sub-clause 11.2.110, \"TEID\" but with no IEI and no length fields. | | | | **Sequence Number** (octet 9-10) | | | | This field shall be present if and only if any one or more of the S, | | PN and E flags are set. This field is meaningful if and only if the | | Sequence Number Flag is set to 1. The handling of this field is | | specified in sub-clause 11.1.3b.2. | | | | **N-PDU Number** (octet 11) | | | | This field shall be present if and only if any one or more of the S, | | PN and E flags are set. This field is meaningful if and only if the | | N-PDU Number Flag is set to 1. If the Sequence Number field shall be | | included in messages sent to the GANC, the MS shall fill the N-PDU | | Number field with the value \'00000000\' for all messages sent to | | the GANC and disregard all N-PDU Number fields if present in | | messages received from the GANC. | | | | **Next Extension Header Type** (octet 11) | | | | This field shall be present if and only if any one or more of the S, | | PN and E flags are set. This field is meaningful if and only if the | | Extensions Header Flag is set to 1. If the Sequence Number field | | shall be included in messages sent to the GANC, the MS shall fill | | the Next Extensions Header Type field with the value \'00000000\' | | for all messages sent to the GANC and disregard all extension fields | | if present in messages received from the GANC. | +----------------------------------------------------------------------+
#### 11.1.3b.1 GA-RRC PTC Message Type
The GA-RRC PTC Message Type field is the second octet in the GA-RRC (PTC)
message header. Bit 8 of the GA-RRC PTC Message Type value is the most
significant bit and bit 1 is the least significant bit.
The following GA-RRC PTC message types are defined:
Table 11.1.3a.1.1: Message types for GA-RRC (UDP)
* * *
GA-RRC PTC message name GA-RRC PTC Message Type value\ (decimal)
GA-RRC PDU 255
* * *
#### 11.1.3b.2 GA-RRC Sequence Number Handling
The following describes the use of GA-RRC PDU message sequence numbering
assuming sequencing has been activated for the PTC (i.e., Delivery Order is
requested in the IE \"RAB Configuration\" associated with the PTC).
The sending MS shall use 0 for the value of the Sequence Number of the first
GA-RRC PDU message in a tunnel, only during the PDP context activation, and
shall increment the Sequence Number for each following GA-RRC PDU message. The
value shall wrap to zero after 65535.
The receiving MS shall set the content of a counter to zero, only during the
PDP context activation. When the receiving MS receives a valid GA-RRC PDU
message, it shall increment this counter by one. This counter shall wrap to
zero after 65535. It defines the \'Expected Sequence Number\'.
Based on the received and Expected Sequence Number values, the receiving MS
may decide whether or not to discard the received GA-RRC PDU message.
The receiving MS shall reorder the incoming T-PDUs in sequence if the
Reordering Required flag in the PDP context is set. In this case, if needed,
the receiving MS shall take into account a maximum number of valid received
frames and a maximum elapsed time to assume that a GA-RRC PDU message was
lost.
The sequence numbers allocated by the CN (down-link) and MS (uplink) are kept
unchanged irrespective of the number of GA-RRC and GTP tunnels the PDU is
transferred over. Therefore, GANC shall use on the Up interface for down-link
PDUs the G-PDU sequence number received from the SGSN, and shall use on the Iu
interface for uplink PDUs the GA-RRC PDU sequence number received from the MS.
In case of SRNS relocation and intersystem change, the GANC shall tunnel PDUs
without changing the G-PDU sequence numbers.
### 11.1.4 Information Element Coding principles
Each information element after the relevant message header is coded using the
TLV principle as following:
\- The first part of each IE is the _Type_ field identifying the Information
Element. The _Type_ field is coded using either 1 or 2 octets. The _ext_ field
in octet 1 of the Information Element is the field extension bit and defines
if the 2^nd^ _Type_ field octet is included:
\- if set to 0, then the _Type_ field consists of one octet with a value less
than or equal to 127 (see Figure 11.1.4.1);
* * *
8 7 6 5 4 3 2 1  
_ext_ =0 _Type_ value octet 1
* * *
Figure 11.1.4.1: _Type_ field structure (coding using one octet)
\- if set to 1, then the _Type_ field consists of two octets with a value
greater than 127 (see Figure 11.1.4.2).
* * *
8 7 6 5 4 3 2 1  
_ext_ =1 _Type_ value octet 1  
_Type_ value (cont.) octet 1a
* * *
Figure 11.1.4.2: _Type_ field structure (coding using two octets)
\- The second part of each IE is the _Length_ field identifying the length of
the _Value_ field of the Information Element. The _Length_ field is coded
using either 1 or 2 octets. The _ext_ field in octet 2 of the information
element is the field extension bit and defines if the 2^nd^ _Length_ field
octet is included:
\- if set to 0, then the _Length_ field consists of one octet with a value
less than or equal to 127 (see Figure 11.1.4.3);
* * *
8 7 6 5 4 3 2 1  
_ext_ =0 _Length_ value octet 2
* * *
Figure 11.1.4.3: _Length_ field structure (coding using one octet)
\- if set to 1, then the _Length_ field consists of two octets with a value
greater than 127 (see Figure 11.1.4.4).
* * *
8 7 6 5 4 3 2 1  
_ext_ =1 _Length_ value octet 2  
_Length_ value (cont.) octet 2a
* * *
Figure 11.1.4.4: _Length_ field structure (coding using two octets)
\- The third part of each IE is the _Value_ field of the Information Element.
The length of the _Value_ field depends on the _Type_ field of the IE and is
defined in the sub-clauses below 11.2.
When the _Type_ field or the _Length_ field extends over more than one octet,
the order of bit values progressively decreases as the octet number increases.
The least significant bit of the field is represented by the lowest numbered
bit of the highest numbered octet of the field.
### 11.1.5 Network Byte order
The Network byte order shall be Big-Endian.
## 11.2 IE Type and Identifiers
Table 11.2.1: IE type and identifiers for Unlicensed Radio Resources
management
* * *
IE Identifier Reference
Mobile Identity 1 11.2.1
GAN Release Indicator 2 11.2.2
Radio Identity 3 11.2.3
GERAN Cell Identity 4 11.2.4
Location Area Identification 5 11.2.5
GERAN/UTRAN coverage Indicator 6 11.2.6
GAN Classmark 7 11.2.7
Geographical Location 8 11.2.8
GANC-SEGW IP Address 9 11.2.9
GANC-SEGW Fully Qualified Domain/Host Name 10 11.2.10
Redirection Counter 11 11.2.11
Discovery Reject Cause 12 11.2.12
GAN Cell Description 13 11.2.13
GAN Control Channel\ 14 11.2.14 Description
Cell Identifier List 15 11.2.15
TU3907 Timer 16 11.2.16
GSM RR/UTRAN RRC State 17 11.2.17
Routing Area Identification 18 11.2.18
GAN Band 19 11.2.19
GA-RC/GA-CSR/GA-PSR State 20 11.2.20
Register Reject Cause 21 11.2.21
TU3906 Timer 22 11.2.22
TU3910 Timer 23 11.2.23
TU3902 Timer 24 11.2.24
L3 Message 26 11.2.26
Channel Mode 27 11.2.27
Mobile Station Classmark 2 28 11.2.28
RR Cause 29 11.2.29
Cipher Mode Setting 30 11.2.30
GPRS Resumption 31 11.2.31
Handover From GAN Command 32 11.2.32
UL Quality Indication 33 11.2.33
TLLI 34 11.2.34
Packet Flow Identifier 35 11.2.35
Suspension Cause 36 11.2.36
TU3920 Timer 37 11.2.37
QoS 38 11.2.38
GA-PSR Cause 39 11.2.39
User Data Rate 40 11.2.40
Routing Area Code 41 11.2.41
AP Location 42 11.2.42
TU4001 Timer 43 11.2.43
Location Status 44 11.2.44
Cipher Response 45 11.2.45
Ciphering Command RAND 46 11.2.46
Ciphering Command MAC 47 11.2.47
Ciphering Key Sequence Number 48 11.2.48
SAPI ID 49 11.2.49
Establishment Cause 50 11.2.50
Channel Needed 51 11.2.51
PDU in Error 52 11.2.52
Sample Size 53 11.2.53
Payload Type 54 11.2.54
Multi-rate Configuration 55 11.2.55
Mobile Station Classmark 3 56 11.2.56
LLC-PDU 57 11.2.57
Location Black List indicator 58 11.2.58
Reset Indicator 59 11.2.59
TU4003 Timer 60 11.2.60
AP Service Name 61 11.2.61
GAN Service Zone Information 62 11.2.62
RTP Redundancy Configuration 63 11.2.63
UTRAN Classmark 64 11.2.64
Classmark Enquiry Mask 65 11.2.65
UTRAN Cell Identifier List 66 11.2.66
Serving GANC table indicator 67 11.2.67
Registration indicators 68 11.2.68
GAN PLMN List 69 11.2.69
Required GAN Services 71 11.2.71
Broadcast Container 72 11.2.72
3G Cell Identity 73 11.2.73
MS Radio Identity 96 11.2.3
GANC IP Address 97 11.2.9
GANC Fully Qualified Domain/\ 98 11.2.10 Host Name
IP address for GPRS user data transport 99 11.2.9
UDP Port for GPRS user data transport 100 11.2.25
GANC TCP port 103 11.2.25
RTP UDP port 104 11.2.25
RTCP UDP port 105 11.2.25
GERAN Received Signal Level List 106 11.2.70
UTRAN Received Signal Level List 107 11.2.70b
PS Handover to GERAN Command 108 11.2.74
PS Handover to UTRAN Command 109 11.2.75
PS Handover to GERAN PSI 110 11.2.76
PS Handover to GERAN SI 111 11.2.77
TU4004 Timer 112 11.2.78
GAN Mode Indicator 79 11.2.79
CN Domain Identity 80 11.2.80
GAN Iu Mode Cell Description 81 11.2.81
3G UARFCN 82 11.2.82
RAB ID 83 11.2.83
RAB ID List 84 11.2.84
GA-RRC Establishment Cause 85 11.2.85
GA-RRC Cause 86 11.2.86
GA-RRC Paging Cause 87 11.2.87
Intra Domain NAS Node Selector 88 11.2.88
CTC Activation List 89 11.2.89
CTC Description 90 11.2.90
CTC Activation Ack List 91 11.2.91
CTC Activation Ack Description 92 11.2.92
CTC Modification List 93 11.2.93
CTC Modification Ack List 94 11.2.94
CTC Modification Ack Description 95 11.2.95
PTC Activation List 115 11.2.96
PTC Description 116 11.2.97
PTC Activation Ack List 117 11.2.98
PTC Activation Ack Description 118 11.2.99
PTC Modification List 119 11.2.100
PTC Modification Ack List 120 11.2.101
PTC Modification Ack Description 121 11.2.102
RAB Configuration 122 11.2.103
Multi-rate Configuration 2 123 11.2.104
Selected Integrity Protection Algorithm 124 11.2.105
Selected Encryption Algorithm 125 11.2.106
CN Domains to Handover 126 11.2.107
3G Security Capability 74 11.2.108
NAS Synchronisation Indicator 75 11.2.109
GANC TEID 76 11.2.110
MS TEID 77 11.2.110
UTRAN RRC Message 78 11.2.111
SRNS Relocation Info 127 11.2.111
MS Radio Access Capability 128 11.2.112
Handover Reporting Control 129 11.2.113
Tracking Area Identity 130 11.2.114
E-UTRAN Cell Identity 131 11.2.115
E-UTRAN Camping Indicator 132 11.2.116
Bandwidth-efficient Mode Indicator 133 11.2.117
* * *
### 11.2.1 Mobile Identity
The purpose of the _Mobile Identity_ information element is to provide either
the international mobile subscriber identity, IMSI, the temporary mobile
subscriber identity, TMSI/P-TMSI, the international mobile equipment identity,
IMEI or the international mobile equipment identity together with the software
version number, IMEISV.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Mobile Identity IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of mobile | octet 2, 2a | | | | | | | | | identity contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8] not including | .... | | | | | | | | | IEI and length, if | | | | | | | | | | present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.1.1: Mobile Identity information element
### 11.2.2 GAN Release Indicator
This information element is used to indicate the GAN Release supported.
* * *
8 7 6 5 4 3 2 1  
GAN Release Indicator IEI octet 1  
Length of GAN Release Indicator IE contents octet 2  
spare URI octet 3
* * *
Figure 11.2.2.1: GAN Release Indicator information element
Table 11.2.2.1: GAN Release Indicator information element
+--------------------------------------+---+---+---------------------------------+ | URI, GAN Release Indicator (octet 3) | | | | | | | | | | Bits | | | | +--------------------------------------+---+---+---------------------------------+ | 3 | 2 | 1 | | +--------------------------------------+---+---+---------------------------------+ | 0 | 0 | 1 | Release 1 (i.e. 3GPP Release-6) | +--------------------------------------+---+---+---------------------------------+ | 0 | 1 | 0 | Release 2 (i.e. 3GPP Release-7) | +--------------------------------------+---+---+---------------------------------+ | 0 | 1 | 1 | Release 3 (i.e. 3GPP Release-8) | +--------------------------------------+---+---+---------------------------------+ | All other values are reserved. | | | | +--------------------------------------+---+---+---------------------------------+
### 11.2.3 Access Identity
The Access Identity IE is used for transmission of identifiers of the Access
Technologies e.g. the Bluetooth Device Address (BD_ADDR) or WLAN MAC Address.
* * *
8 7 6 5 4 3 2 1  
Access Identity IEI octet 1  
Length of Access Identity contents octet 2  
Spare Type of identity octet 3  
Access Identity MSB value octet 4
Access Identity LSB value octet 9
* * *
Figure 11.2.3.1: Access Identity information element
Table 11.2.3.1: Access Identity information element
+----------------------------+-------+---+---+--------------------------------------+ | Type of Identity (octet 3) | | | | | | | | | | | | Bits | | | | | +----------------------------+-------+---+---+--------------------------------------+ | 4 | **3** | 2 | 1 | | +----------------------------+-------+---+---+--------------------------------------+ | 0 | 0 | 0 | 0 | IEEE MAC-address format | +----------------------------+-------+---+---+--------------------------------------+ | 0 | 0 | 0 | 1 | | +----------------------------+-------+---+---+--------------------------------------+ | to | | | | | +----------------------------+-------+---+---+--------------------------------------+ | 1 | 1 | 1 | 1 | All other values are for future use. | +----------------------------+-------+---+---+--------------------------------------+
### 11.2.4 GERAN Cell Identity
The purpose of the _Cell Identity_ information element is to identify a cell
within a location area.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | GERAN Cell Identity | octet 1 | | | | | | | | | IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of GERAN | octet 2, 2a | | | | | | | | | Cell Identity IE | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8] not including | .... | | | | | | | | | IEI and length, if | | | | | | | | | | present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.4.1 GERAN _Cell Identity_ information element
### 11.2.5 Location Area Identification
The purpose of the _Location Area Identification_ information element is to
provide an unambiguous identification of location areas within the area
covered by the GSM system.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Location Area | octet 1 | | | | | | | | | Identification IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of Location | octet 2, 2a | | | | | | | | | Area Identification | | | | | | | | | | IE contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8] not including | .... | | | | | | | | | IEI and length, if | | | | | | | | | | present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.5.1: Location Area Identification information element
### 11.2.6 GERAN/UTRAN coverage Indicator
This information element is used to indicate the presence of GERAN/UTRAN
coverage in the current MS location.
* * *
8 7 6 5 4 3 2 1  
GERAN/UTRAN coverage Indicator IEI octet 1  
Length of GERAN/UTRAN coverage Identity contents octet 2  
GCI octet 3
* * *
Figure 11.2.6.1 GERAN/UTRAN coverage Indicator information element
_Table 11.2.6.1: GERAN/UTRAN coverage Indicator information element_
+----------------------------------------------------------------------+ | GCI, GERAN/UTRAN coverage Indicator (octet 3) | | | | 0 Normal Service in the GERAN/UTRAN | | | | 1 Limited Service in the GERAN/UTRAN | | | | 2 MS has not found GERAN/UTRAN coverage (LAI information taken from | | SIM, if available). This value shall be used if the MS is camped on | | a E-UTRAN cell. | | | | 3 MS has found GERAN/UTRAN coverage, service state unknown | | | | 4-255 All other values are for future use | +----------------------------------------------------------------------+
### 11.2.7 GAN Classmark
The purpose of the _GAN Classmark_ information element is to provide the
network with information concerning aspects of both the cellular and generic
access interfaces, as well as the support for RTP redundancy of the mobile
station equipment.
* * *
8 7 6 5 4 3 2 1  
GAN Classmark IEI octet 1  
Length of GAN Classmark IE contents octet 2  
spare UC GC TGA octet 3  
spare BMSI GMSI PS HO RRS octet 4
* * *
Figure 11.2.7.1: GAN Classmark information element
Table 11.2.7.1: GAN Classmark information element
+----------------------------------------------------------------------+ | TGA, Type of Generic Access (octet 3) | | | | This field is used to indicate the current Generic Access type used | | by the mobile station to access the GAN. | | | | Bit | | | | 4 3 2 1 | | | | 0 0 0 0 no radio | | | | 0 0 0 1 Bluetooth | | | | 0 0 1 0 WLAN 802.11 | | | | 1 1 1 1 unspecified | | | | All other values are reserved in Release 1. | +----------------------------------------------------------------------+ | GC, GERAN Capable (octet 3) | | | | Bit | | | | 5 | | | | 0 The MS is not GERAN capable. | | | | 1 The MS is GERAN capable. | +----------------------------------------------------------------------+ | UC, UTRAN Capable (octet 3) | | | | Bit | | | | 6 | | | | 0 The MS is not UTRAN capable. | | | | 1 The MS is UTRAN capable. | +----------------------------------------------------------------------+ | RRS, RTP Redundancy Support (octet 4) | | | | Bit1 | | | | 0 RTP Redundancy not supported | | | | 1 RTP Redundancy supported | +----------------------------------------------------------------------+ | PS HO, PS Handover Capable (octet 4) | | | | Bit | | | | 2 | | | | 0 The MS does not support PS handover to/from GAN A/Gb mode. | | | | 1 The MS supports PS handover to/from GAN A/Gb mode. | +----------------------------------------------------------------------+ | GMSI, GAN Mode Support Indicator (octet 4) | | | | Bits | | | | 4 3 | | | | 0 0 Unspecified | | | | 0 1 The MS supports GAN A/Gb mode only | | | | 1 0 The MS supports GAN Iu mode only | | | | 1 1 The MS supports GAN A/Gb mode and GAN Iu mode | +----------------------------------------------------------------------+ | BMSI, Bandwidth-efficient Mode Support Indicator (octet 4) | | | | Bit | | | | 5 | | | | 0 The MS does not support RFC 4867 [48] bandwidth-efficient mode. | | | | 1 The MS supports RFC 4867 [48] bandwidth-efficient mode. | +----------------------------------------------------------------------+
### 11.2.8 Geographical Location
This is a variable length information element providing an estimate of a
geographic location of a target MS.
It is coded as follows:
* * *
8 7 6 5 4 3 2 1
Geographical Location Indicator IEI octet 1
Length of Geographical Location value contents octet 2, 2a
Location estimate octet 3\  
....\  
octet n
* * *
Figure 11.2.8.1: Geographical Location information element
The Location Estimate field is composed of 1 or more octets with an internal
structure according to section 7 in [5].
### 11.2.9 IP Address
The IP Address information element contains one IP address.
* * *
8 7 6 5 4 3 2 1  
IP address IEI octet 1  
Length of IP address IE contents octet 2, 2a  
IP Address type octet 3  
Address information MSB octet 4
Address information LSB octet n
* * *
Figure 11.2.9.1: IP address information element
Table 11.2.9.1: IP address information element
+--------------------------------------------------------+ | IP address type number value (octet 3)\ | | Bits\ | | 8 7 6 5 4 3 2 1\ | | 0 0 1 0 0 0 0 1 IPv4 address\ | | 0 1 0 1 0 1 1 1 IPv6 address | | | | All other values shall be interpreted as Ipv4 address\ | | in this version of the protocol. | +--------------------------------------------------------+
If PDP type number indicates Ipv4, the Address information in octet 4 to octet
7 contains the Ipv4 address. Bit 8 of octet 4 represents the most significant
bit of the IP address and bit 1 of octet 7 the least significant bit .
If PDP type number indicates Ipv6, the Address information in octet 4 to octet
19 contains the Ipv6 address. Bit 8 of octet 4 represents the most significant
bit of the IP address and bit 1 of octet 19 the least significant bit.
### 11.2.10 Fully Qualified Domain/Host Name (FQDN)
The Fully Qualified Domain/Host Name (FQDN) information element contains the
name of a network element (i.e. SEGW or a GANC). The information element is
coded in string format.
* * *
8 7 6 5 4 3 2 1  
FQDN IEI octet 1  
Length of FQDN IE contents octet 2, 2a  
FQDN 1^st^ character octet 3
FQDN last character octet n
* * *
Figure 11.2.10.1: FQDN information element
Table 11.2.10.1: _FQDN_ information element
+----------------------------------------------------------------------+ | FQDN, Fully Qualified Domain/Host Name value (octet 3 to octet n) | | | | The FQDN is coded as a string. This means that the 1^st^ character | | of the string is coded in octet 3 and the last character of the | | string is coded in the last octet of this IE (octet n). | +----------------------------------------------------------------------+
### 11.2.11 Redirection Counter
The purpose of this information element is to indicate to the GANC the number
of times the MS has been redirect and still has not obtained service.
* * *
8 7 6 5 4 3 2 1  
Redirection Counter IEI octet 1  
Length of Redirection Counter contents octet 2  
Redirection Counter value octet 3
* * *
Figure 11.2.11.1: Redirection Counter information element
Table 11.2.11.1: Redirection Counter information element
+----------------------------------------------------------------------+ | Redirection Counter value (octet 3 ) | | | | In the Redirection Counter value field bit 8 of octet 3 is the most | | significant bit | | | | The value is given in number redirections | | | | The Redirection Counter value consists of 1 octets. | +----------------------------------------------------------------------+
### 11.2.12 Discovery Reject Cause
The Discovery reject Cause information element contains information to the MS
about the reason for a Discovery Reject. The MS shall act according to the
cause value received.
* * *
8 7 6 5 4 3 2 1  
Discovery Reject Cause IEI octet 1  
Length of Discovery Reject Cause IE contents octet 2  
Discovery Reject Cause Value octet 3
* * *
Figure 11.2.12.1: Discovery Reject Cause information element
Table 11.2.12.1: Discovery Reject Cause information element
+----------------------------------+---+---+--------------------------+ | Discovery Reject Cause (octet 3) | | | | | | | | | | Bits | | | | +----------------------------------+---+---+--------------------------+ | 3 | 2 | 1 | | +----------------------------------+---+---+--------------------------+ | 0 | 0 | 0 | Network Congestion | +----------------------------------+---+---+--------------------------+ | 0 | 0 | 1 | Unspecified | +----------------------------------+---+---+--------------------------+ | 0 | 1 | 0 | IMSI not allowed | +----------------------------------+---+---+--------------------------+ | 1 | 0 | 0 | | +----------------------------------+---+---+--------------------------+ | to | | | | +----------------------------------+---+---+--------------------------+ | 1 | 1 | 1 | Reserved for future use. | +----------------------------------+---+---+--------------------------+
### 11.2.13 GAN Cell Description
The purpose of the _GAN Cell Description_ information element is to provide a
minimum description of a GAN A/Gb mode cell, e.g. to identify the GAN A/Gb
mode cell in order to be handed over from GERAN/UTRAN.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | GAN Cell | octet 1 | | | | | | | | | Description IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of GAN Cell | octet 2, 2a | | | | | | | | | Description value | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], Cell | .... | | | | | | | | | Description IE, not | | | | | | | | | | including IEI and | octet n | | | | | | | | | length, if present. | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.13.1:  _GAN Cell Description_ information element
### 11.2.14 GAN Control Channel Description
The purpose of the _Control Channel Description_ information element is to
provide a variety of information about the GAN service.
* * *
8 7 6 5 4 3 2 1  
GAN Control Channel Description IEI octet 1  
Length of GAN Control Channel Description contents octet 2  
MSCR ATT DTM GPRS NMO ECMC spare octet 3  
T3212 timeout value octet 4  
RAC octet 5  
spare PS HO 3GECS PFCFM RE ECMP SGSNR octet 6  
AC C15 AC C14 AC C13 AC C12 AC C11 AC C10 AC C09 AC C08 octet 7 AC C07 AC C06
AC C05 AC C04 AC C03 AC C02 AC C01 AC C00 octet 8
* * *
Figure 11.2.14.1:  _GAN Control Channel Description_ information element
Table 11.2.14.1:  _GAN Control Channel Description_ information element
+----------------------------------------------------------------------+ | **ECMC** , Early Classmark Sending Control (octet 3) | | | | Bit | | | | 2 | | | | 0 Early Classmark Sending is allowed\ | | 1 Early Classmark Sending is forbidden\ | | This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **NMO** , Network Mode of Operation (octet 3) | | | | Bit | | | | 4 3 | | | | 0 0 Network Mode of Operation I | | | | 0 1 Network Mode of Operation II | | | | 1 0 Network Mode of Operation III (this value is not valid in GAN Iu | | mode) | | | | 1 1 Reserved | +----------------------------------------------------------------------+ | **GPRS** , GPRS Availability (octet 3) | | | | Bit | | | | 5 | | | | 0 GPRS available\ | | 1 GPRS not available\ | | This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **DTM** , Dual Transfer Mode of Operation by network (octet 3) | | | | Bit | | | | 6 | | | | 0 Network does not support dual transfer mode\ | | 1 Network supports dual transfer mode\ | | This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **ATT** , Attach-detach allowed (octet 3) | | | | Bit | | | | 7 | | | | 0 MSs in the cell are not allowed to apply IMSI attach and detach | | procedure.\ | | 1 MSs in the cell shall apply IMSI attach and detach procedure. | +----------------------------------------------------------------------+ | **MSCR** , MSC Release (octet 3) | | | | Bit | | | | 8 | | | | 0 MSC is Release \'98 or older\ | | 1 MSC is Release \'99 onwards | | | | This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **T3212 timeout value** (octet 4) | | | | The T3212 timeout value field is coded as the binary representation | | of the timeout value for periodic updating in decihours. | | | | Range: 1 to 255 | | | | The value 0 is used for infinite timeout value i.e. periodic | | updating shall not be used within the cell. | +----------------------------------------------------------------------+ | **RAC, Routing Area Code** (octet 5)\ | | This field is the binary representation of the Routing Area Code, | | see [3]. Bit 8 is the most significant bit and bit 1 is the least | | significant bit. | +----------------------------------------------------------------------+ | **SGSNR** , SGSN Release (octet 6) | | | | Bit | | | | 1 | | | | 0 SGSN is Release \'98 or older\ | | 1 SGSN is Release \'99 onwards | | | | This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **ECMP** , Emergency Call Mode Preference (octet 6) | | | | Bit | | | | 2 | | | | 0 GERAN/UTRAN is preferred for Emergency calls\ | | 1 GAN is preferred for Emergency calls | +----------------------------------------------------------------------+ | **RE** , Call re-establishment allowed (octet 6) | | | | Bit | | | | 3 | | | | 0 Call Re-establishment allowed in the cell\ | | 1 Call Re-establishment not allowed in the cell | | | | **When call re-establishment is allowed, the mobile station may | | initiate call re-establishment if rove-in follows the RR/RRC | | connection failure in GSM/UMTS.** | +----------------------------------------------------------------------+ | **PFCFM** , PFC_FEATURE_MODE (octet 6)\ | | Bit\ | | 4\ | | 0 The network does not support packet flow context procedures.\ | | 1 The network supports packet flow context procedures.\ | | This field shall be disregarded in GAN Iu mode. | | | | **3GECS,** 3G Early Classmark Sending Restriction (octet 6) | | | | Bit | | | | 5 | | | | > 0 UTRAN classmark change message shall note be sent with the Early | | > classmark sending | | > | | > 1 The sending of UTRAN Classmark Sending messages is controlled by | | > the Early Classmark Sending Control parameter | | > | | > This field shall be disregarded in GAN Iu mode. | | | | **PS HO** , PS Handover indicator (octet 6) | | | | Bit | | | | 6 | | | | > 0 The network does not support PS handover between GERAN/UTRAN | | > mode and GAN A/Gb mode. | | > | | > 1 The network supports PS handover between GERAN/UTRAN mode and | | > GAN A/Gb mode. | | > | | > This field shall be disregarded in GAN Iu mode. | +----------------------------------------------------------------------+ | **AC CN,** Access Control Class N (octet 7 and octet 8) | | | | **These fields are specified and described in 3GPP TS 44.018 and | | 3GPP TS 22.011.** | +----------------------------------------------------------------------+
### 11.2.15 Cell Identifier List
The Cell Identifier List information element is used to transfer multiple Cell
Global Identifications in GAN.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | GAN Cell Identifier | octet 1 | | | | | | | | | List IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of GAN Cell | octet 2, 2a | | | | | | | | | Identifier List | | | | | | | | | | value contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [16], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.15.1:  _Cell Identifier List_ information element
NOTE: Cell identification discriminator \"The whole Cell Global
Identification, CGI\" as defined in [16] shall be used.
### 11.2.16 TU3907 Timer
The purpose of this information element is to indicate to the MS the minimum
period of time it should wait before attempting Registration at the current
GANC.
* * *
8 7 6 5 4 3 2 1  
TU3907 Timer IEI octet 1  
Length of TU3907 Timer IE contents octet 2  
TU3907 Timer value MSB octet 3  
TU3907Timer value LSB octet 4
* * *
Figure 11.2.16.1: TU3907 Timer information element
Table 11.2.16.1: TU3907 Timer information element
+----------------------------------------------------------------------+ | TU3907 Timer value (octet 3 and 4) | | | | In the TU3907 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1 of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU3907 Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.17 GSM RR/UTRAN RRC State
This information element is used to indicate the state of the GSM RR or UTRAN
RRC entity when the MS is registering for GAN service. If GSM-RR is the
current serving RR entity, information about GSM RR shall be included and if
UTRAN-RRC is the current serving RR entity, information about UTRAN RRC shall
be included.
* * *
8 7 6 5 4 3 2 1  
GSM RR/UTRAN RRC State IEI octet 1  
Length of GSM RR/ UTRAN RRC State contents octet 2  
spare GRS octet 3
* * *
Figure 11.2.17.1 GSM RR/UTRAN RRC State information element
_Table 11.2.17.1: GSM RR/UTRAN RRC State information element_
+-----------------------------------------------+ | GRS, GSM RR/UTRAN RRC State (octet 3) | | | | Bits 1-3 | | | | 0 0 0 GSM RR is in IDLE state.\ | | 0 0 1 GSM RR is in DEDICATED state. | | | | 0 1 0 UTRAN RRC is in IDLE STATE | | | | 0 1 1 UTRAN RRC is in CELL_DCH STATE | | | | 1 0 0 UTRAN RRC is in CELL_FACH STATE\ | | 1 0 1 UTRAN RRC is in CELL_PCH STATE\ | | 1 1 0 UTRAN RRC is in URA_PCH STATE | | | | 1 1 1 Unknown | | | | All other values are reserved for future use. | +-----------------------------------------------+
### 11.2.18 Routing Area Identification
The purpose of the _routing area identification_ information element is to
provide an unambiguous identification of routing areas within the GPRS
coverage area.
+---------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+---------+---+---+---+---+---+---+---+ | Routing Area | octet 1 | | | | | | | | | Identification IEI | | | | | | | | | +---------------------+---------+---+---+---+---+---+---+---+ | Length of Routing | octet 2 | | | | | | | | | Area Identification | | | | | | | | | | contents | | | | | | | | | +---------------------+---------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8] not including | .... | | | | | | | | | IEI and length, if | | | | | | | | | | present. | octet 8 | | | | | | | | +---------------------+---------+---+---+---+---+---+---+---+
Figure 11.2.18.1: Routing Area Identification information element
### 11.2.19 GAN Band
The GAN Band information element is used to indicate to the mobile station the
GSM Band that is associated with the GANC. The mobile station uses this
information to construct the MS Classmark 2 information element. The GAN Band
is applicable in GAN A/Gb mode only.
* * *
8 7 6 5 4 3 2 1  
GAN Band IEI octet 1  
Length of GAN Band contents octet 2  
spare GAN Band octet 3
* * *
Figure 11.2.19.1: GAN Band information element
Table 11.2.19.1: GAN Band information element
+----------------------------------------------------------------------+ | GAN Band (4 bit field)\ | | This field indicates the band applicable for the parameters in this | | structure. | | | | Bits 4 - 1\ | | 4 3 2 1 | | | | 0 0 0 0 E-GSM is supported | | | | 0 0 0 1 P-GSM is supported | | | | 0 0 1 0 GSM 1800 is supported | | | | 0 0 1 1 GSM 450 is supported | | | | 0 1 0 0 GSM 480 is supported | | | | 0 1 0 1 GSM 850 is supported | | | | 0 1 1 0 GSM 1900 is supported | | | | 0 1 1 1 GSM 700 is supported | | | | All other values are reserved for future use and shall not be | | interpreted as an error. | +----------------------------------------------------------------------+
### 11.2.20 GAN State
This information element is used to indicate the state of the GAN protocol
sub-layer entities in the MS to the GANC.
* * *
8 7 6 5 4 3 2 1  
GAN State IEI octet 1  
Length of GAN State contents octet 2  
spare GA-RRC-PS GA-RRC-CS UPS URS octet 3
* * *
Figure 11.2.20.1 GAN State information element
_Table 11.2.20.1: GAN State information element_
+-------------------------------------------------------------------+ | URS, GA-RC/GA-CSR State (octet 3) | | | | Bits 2-1 | | | | 2 1 | | | | 0 0 GA-CSR is in GA-CSR-IDLE state. | | | | 0 1 GA-CSR is in GA-CSR-DEDICATED state. | | | | 1 0 GA-RC is in GA-RC-REGISTERED state while in GERAN/UTRAN mode. | | | | UPS, GA-PSR State (octet 3) | | | | Bit | | | | 3 | | | | 1. GA-PSR is in GA-PSR-STANDBY state. | | | | 2. GA-PSR is in GA-PSR-ACTIVE state. | | | | GA-RRC-CS, GA-RRC (CS) State (octet 3) | | | | Bit | | | | 4 | | | | 0 GA-RRC (CS) is in GA-RRC-IDLE state. | | | | 1 GA-RRC (CS) is in GA-RRC-CONNECTED state. | | | | GA-RRC-PS, GA-RRC (PS) State (octet 3) | | | | Bit | | | | 5 | | | | 0 GA-RRC (PS) is in GA-RRC-IDLE state. | | | | 1 GA-RRC (PS) is in GA-RRC-CONNECTED state. | +-------------------------------------------------------------------+
### 11.2.21 Register Reject Cause
This information element contains the reason for Register reject or
deregistration.
* * *
8 7 6 5 4 3 2 1  
Register Reject Cause IEI octet 1  
Length of Register Reject Cause IE contents octet 2  
RRC octet 3
* * *
Figure 11.2.21.1:  _Register Reject Cause_ information element
Table 11.2.21.1:  _Register Reject Cause_ information element
* * *
Register Reject Cause (octet 3)  
0 Network Congestion 1 AP not allowed 2 Location not allowed 3 Invalid GANC 4
Geo Location not known 5 IMSI not allowed 6 Unspecified 7 GANC-SEGW
certificate not valid 8 EAP_SIM authentication failed 9 TCP establishment
failed 10 Redirection 11 EAP-AKA Authentication failed 12 to 255 Reserved for
future use.
* * *
### 11.2.22 TU3906 Timer
The TU3906 Timer information element contains the value for the GA-RC Keep
Alive mechanism, as described in section 5.5.
* * *
8 7 6 5 4 3 2 1  
TU3906 Timer IEI octet 1  
Length of TU3906 Timer IE contents octet 2  
TU3906 Timer value MSB octet 3  
TU3906 Timer value LSB octet 4
* * *
Figure 11.2.22.1: TU3906 Timer information element
Table 11.2.22.1: TU3906 Timer information element
+----------------------------------------------------------------------+ | TU3906 Timer value (octet 3 and 4) | | | | In the TU3906 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU3906 Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.23 TU3910 Timer
When the MS roves out, it shall start timer TU3910 and shall not rove in until
this timer has expired, unless the MS has detected loss of GERAN coverage.
* * *
8 7 6 5 4 3 2 1  
TU3910 Timer IEI octet 1  
Length of TU3910 Timer IE contents octet 2  
TU3910 Timer value MSB octet 3  
TU3910 Timer value LSB octet 4
* * *
Figure 11.2.23.1: TU3910 Timer information element
Table 11.2.23.1: TU3910 Timer information element
+----------------------------------------------------------------------+ | TU3910 Timer (octet 3 and 4) | | | | In the TU3910 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU3910 value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.24 TU3902 Timer
The purpose of this information element is to indicate to the MS the minimum
period of time it should wait before attempting the Discovery procedure again.
* * *
8 7 6 5 4 3 2 1  
TU3902 Timer IEI octet 1  
Length of TU3902 Timer IE contents octet 2  
TU3902 Timer value MSB octet 3  
TU3902 Timer value LSB octet 4
* * *
Figure 11.2.24.1: TU3902 Timer information element
Table 11.2.24.1: TU3902 Timer information element
+----------------------------------------------------------------------+ | TU3902 Timer value (octet 3 and 4) | | | | In the TU3902 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1 of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU3902 Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.25 Communication Port Identity
The Communication Port Identity information element is used to identify the
TCP or UDP port for the connection.
* * *
8 7 6 5 4 3 2 1  
Communication Port Identity IEI octet 1  
Length of Communication Port Identity IE contents octet 2  
Communication Port MSB value octet 3  
Communication Port LSB value octet 4
* * *
Figure 11.2.25.1: Communication Port information element
Even though it is only recommended in [35], RTP shall use an even destination
UDP port number and the corresponding RTCP stream shall use the next higher
(odd) destination UDP port number. E.g. UDP ports 49170 and 49171 form one
RTP/RTCP UDP port pair.
### 11.2.26 L3 Message
The L3 Message information element contains the upper layer message to be
transported using the GA-CSR protocol or the GA-RRC protocol between the MS
and the core network.
* * *
8 7 6 5 4 3 2 1  
L3 Message IEI octet 1  
Length of L3 Message IE contents octet 2, 2a  
L3 Message contents, 1st octet octet 3
L3 Message contents, last octet octet n
* * *
Figure 11.2.26.1: L3 Message information element
### 11.2.27 Channel Mode
The _Channel Mode_ information element gives information of the mode on
coding/decoding and transcoding. The exact mode is determined by the contents
of this IE and the channel type.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Channel Mode IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of Channel | octet 2, 2a | | | | | | | | | Mode IE contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.27.1: Channel Mode information element
NOTE 1: Support for AMR FR codec, as specified in 3GPP TS 26.071 [7], is
mandatory when operating in GAN A/Gb mode, with support for other codecs being
optional.
### 11.2.28 Mobile Station Classmark 2
The purpose of the _Mobile Station Classmark 2_ information element is to
provide the network with information concerning aspects of both high and low
priority of the mobile station equipment. This affects the manner in which the
network handles the operation of the mobile station. The Mobile Station
Classmark information indicates general mobile station characteristics and it
shall therefore, except for fields explicitly indicated, be independent of the
frequency band of the channel it is sent on.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Mobile station | octet 1 | | | | | | | | | classmark 2 IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of mobile | octet 2, 2a | | | | | | | | | station classmark 2 | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.28.1: Mobile Station Classmark 2 information element
### 11.2.29 RR Cause
The purpose of the _RR Cause_ information element is to provide the reason for
release or the reason for completion of an assignment or handover.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | RR Cause IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of RR Cause | octet 2, 2a | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.29.1: RR Cause information element
### 11.2.30 Cipher Mode Setting
The purpose of the _Cipher Mode Setting_ information element is to indicate
whether stream ciphering shall be started or not and if it is to be started,
which algorithm to use. It is not used for ciphering when the MS is in GAN
A/Gb mode or GAN Iu mode, but after handover from GAN A/Gb mode in the target
RAT.
* * *
8 7 6 5 4 3 2 1  
Cipher Mode Setting IEI octet 1  
Length of Cipher Mode Setting IE contents octet 2  
spare algorithm identifier SC octet 3
* * *
Figure 11.2.30.1: Cipher Mode Setting information element
NOTE: The coding of fields SC and algorithm identifier is defined in [12] as
part of the Cipher Mode Setting IE.
### 11.2.31 GPRS Resumption
The purpose of the _GPRS Resumption_ information element is to indicate
whether the network has successfully resumed GPRS services or not.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | GPRS Resumption IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of GPRS | octet 2, 2a | | | | | | | | | Resumption contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.31.1: GPRS Resumption information element
### 11.2.32 Handover From GAN Command
The purpose of Handover From GAN Command information element is to provide
information to the MS of handover from GAN. The Handover From GAN Command
information element contains all information needed by the MS for handover
from GAN.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Handover from GAN | octet 1 | | | | | | | | | Command IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of Handover | octet 2, 2a | | | | | | | | | from GAN Command | | | | | | | | | | value contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | If the target RAT | octet 3 | | | | | | | | | is GERAN, the rest | | | | | | | | | | of the IE is coded | .... | | | | | | | | | as HANDOVER COMMAND | | | | | | | | | | message in [12]. | octet n | | | | | | | | | If the target RAT | | | | | | | | | | is UTRAN, the rest | | | | | | | | | | of the IE is coded | | | | | | | | | | as INTER SYSTEM TO | | | | | | | | | | UTRAN HANDOVER | | | | | | | | | | COMMAND message in | | | | | | | | | | [12]. | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.32.1: Handover From GAN Command information element
### 11.2.33 UL Quality Indication
This information element provides an indication to the MS that the GAN has
detected insufficient signal quality on the uplink or is unable to support the
service on the broadband network, thereby requiring the MS to trigger a
Handover by providing the necessary information regarding the potential target
cells in the other RAT. Handover from GAN can be triggered by GAN only if the
MS has indicated presence of GSM coverage previously in the Register or
Register Update messages.
* * *
8 7 6 5 4 3 2 1  
UL Quality Indication IEI octet 1  
Length of UL Quality Indication contents octet 2  
spare ULQI octet 3
* * *
Figure 11.2.33.1: UL Quality Indication information element
Table 11.2.33.1: UL Quality Indication information element
+-------------------------------------------+-------+-------+---+----------------------+ | ULQI, UL Quality Indication (octet 3) | | | | | | | | | | | | Bits | | | | | +-------------------------------------------+-------+-------+---+----------------------+ | **4** | **3** | **2** | 1 | | +-------------------------------------------+-------+-------+---+----------------------+ | **0** | 0 | 0 | 0 | Quality ok | +-------------------------------------------+-------+-------+---+----------------------+ | 0 | 0 | 0 | 1 | Radio problem | +-------------------------------------------+-------+-------+---+----------------------+ | 0 | 0 | 1 | 0 | Network problem | +-------------------------------------------+-------+-------+---+----------------------+ | 0 | 1 | 0 | 0 | Undetermined problem | +-------------------------------------------+-------+-------+---+----------------------+ | Other values are reserved for future use. | | | | | +-------------------------------------------+-------+-------+---+----------------------+
### 11.2.34 TLLI
The purpose of the _TLLI_ information element is to provide the Temporary
Logical Link Identifier.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | TLLI IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of TLLI | octet 2, 2a | | | | | | | | | value contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.34.1: TLLI information element
### 11.2.35 Packet Flow Identifier
The _Packet Flow Identifier (PFI)_ information element indicates the Packet
Flow Identifier for a Packet Flow Context.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | **Packet Flow | octet 1 | | | | | | | | | Identifier** IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of **Packet | octet 2, 2a | | | | | | | | | Flow Identifier** | | | | | | | | | | value contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
**Figure 11.2.35.1: Packet Flow Identifier information element**
### 11.2.36 Suspension Cause
The purpose of the _Suspension Cause_ information element is to provide the
reason for the GPRS suspension.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Suspension Cause | octet 1 | | | | | | | | | IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of | octet 2, 2a | | | | | | | | | Suspension Cause | | | | | | | | | | value contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [12], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.36.1: Suspension Cause information element
### 11.2.37 TU3920 Timer
The purpose of this information element is to indicate to the MS the maximum
period of time it should wait before aborting the Handover to GAN (A/Gb mode
or Iu mode) procedure.
* * *
8 7 6 5 4 3 2 1  
TU3920 Timer IEI octet 1  
Length of TU3920 Timer IE contents octet 2  
TU3920 Timer value MSB octet 3  
TU3920 Timer value LSB octet 4
* * *
Figure 11.2.37.1: TU3920 Timer information element
Table 11.2. 37.1: TU3920 Timer information element
+----------------------------------------------------------------------+ | TU3920 Timer value (octet 3 and 4) | | | | In the TU3920 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1 of octet 4 the least significant bit. | | | | The value is given in number of hundreds of milliseconds. | | | | The TU3920 Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.38 QoS
This information element indicates the QoS Profile associated with a PDU.
* * *
8 7 6 5 4 3 2 1  
QoS IEI octet 1  
Length of QoS value contents octet 2  
spare RLC_MODE RADIO_PRIORITY PEAK_THROUGHPUT_CLASS octet 3
* * *
Figure 11.2.38.1: QoS information element
_Table 11.2.38.1: QoS information element_
+---------------------------------------------------------+ | PEAK_THROUGHPUT_CLASS (octet 3, bits 1-4) | | | | This field is coded as PEAK_THROUGHPUT_CLASS field in | | | | the Channel Request Description information | | | | element specified in [45] | | | | RADIO_PRIORITY (octet 3, bits 5-6) | | | | This field is coded as RADIO_PRIORITY field in the | | | | Channel Request Description information | | | | element specified in [45] | | | | RLC_MODE (octet 3, bit 7) | | | | This field is coded as RLC_MODE field in the | | | | Channel Request Description information | | | | element specified in [45] | | | | . | +---------------------------------------------------------+
### 11.2.39 GA-PSR Cause
This information element indicates the status related to GAN specific
signalling procedures.
* * *
8 7 6 5 4 3 2 1  
GA-PSR Cause IEI octet 1  
Length of GA-PSR Cause value contents octet 2  
GA-PSR Cause value octet 3
* * *
Figure 11.2.39.1: GA-PSR Cause information element
Table 11.2.39.1 GA-PSR Cause value
+-----------------------------------------------------------+ | GA-PSR Cause (octet 3) | | | | Value | | | | 0 \"success\" | | | | 2 \"no available resources\" | | | | 3 \"GANC failure\" | | | | 4 \"not authorized for data service\" | | | | 5 \"message type non existent or not implemented\" | | | | 6 \"message type not compatible with the protocol state\" | | | | 7 \"invalid mandatory information\" | | | | 8 \"syntactically incorrect message\" | | | | 9 \"GPRS suspended\" | | | | 10 \"normal deactivation\" | | | | 12 \"conditional IE error\" | | | | 13 \"semantically incorrect message\" | | | | 14 \"PS handover failure - incorrect handover command\" | | | | 15 \"PS handover failure - target RAT access failure | | | | 16 \"PS handover failure - missing SI/PSI information\" | | | | 17 \"PS handover failure - no uplink TBF allocation\" | | | | All other values are for future use. | +-----------------------------------------------------------+
### 11.2.40 User Data Rate
This information element indicates the User Data Rate used in flow control
procedures:
* * *
8 7 6 5 4 3 2 1  
User Data Rate IEI octet 1  
Length of User Data Rate value contents octet 2  
R Value (MSB) octet 3  
octet 4  
R Value (LSB) octet 5
* * *
Figure 11.2.40.1: User Data Rate IE
Table 11.2.40.1: User Data Rate IE
+----------------------------------------------------------------------+ | R value (octets 3, 4 and 5) | | | | In the R value field bit 8 of octet 3 is the most significant bit | | and bit 1 of octet 5 the least significant bit. | | | | The R field is the binary encoding of the rate information expressed | | in 100 bits/sec increments, starting from 0 x 100 bits/sec until | | 16777215 x 100 bits/sec (1.6 Gbps). | +----------------------------------------------------------------------+
### 11.2.41 Routing Area Code
The purpose of the _Routing Area Code IE_ is to provide an unambiguous
identification of routing areas within a location area.
* * *
8 7 6 5 4 3 2 1  
Routing Area Code IEI octet 1  
Length of the Routing Area Code value contents octet 2  
The rest of the IE is coded as in [3] not including IEI and length, if
present. octet 3
* * *
Figure 11.2.41.1: Routing Area Code information element
### 11.2.42 AP Location
The AP Location information element is to indicate the location of the MS or
AP to the network.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | AP Location IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of AP | octet 2, 2a | | | | | | | | | Location contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [25], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.42.1: AP Location information element
### 11.2.43 TU4001 Timer
The purpose of this information element is to indicate to the MS the minimum
period of time it should wait before deactivating an idle GAN A/Gb mode GA-PSR
Transport Channel or GAN Iu mode Packet Transport Channel.
* * *
8 7 6 5 4 3 2 1  
TU4001 Timer IEI octet 1  
Length of TU4001 Timer IE contents octet 2  
TU4001 Timer value MSB octet 3  
TU4001 Timer value LSB octet 4
* * *
Figure 11.2.43.1: TU4001 Timer information element
Table 11.2.43.1: TU4001 Timer information element
+----------------------------------------------------------------------+ | TU4001 Timer value (octet 3 and 4) | | | | In the TU4001 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1 of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU4001Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.44 Location Status
This information element indicates whether the GANC is able to identify the
location for the specific MS. Based on network or operator policy, the network
may accept a Registration Request from a MS, even if the location of the MS
(or AP) is not known in the network. This IE may be used by the MS to provide
an indication to the user as to whether the MS\'s location is known.
* * *
8 7 6 5 4 3 2 1  
Location Status IEI octet 1  
Length of Location Status value contents octet 2  
spare LS octet 3
* * *
Figure 11.2.44.1 Location Status information element
_Table 11.2.44.1: Location Status information element_
+-------------------------------------+ | LS, Location Status (octet 3) | | | | Bit | | | | 2 1 | | | | 0 0 MS location known | | | | 0 1 MS location unknown | | | | All other value are for future use. | +-------------------------------------+
### 11.2.45 Cipher Response
The purpose of the _Cipher Response_ information element is to indicate to the
mobile station which information the mobile station has to include in the GA-
CSR CIPHERING MODE COMPLETE message.
* * *
8 7 6 5 4 3 2 1  
Cipher Response IEI octet 1  
Length of Cipher Response contents octet 2  
spare CR octet 3
* * *
Figure 11.2.45.1:  _Cipher Response_ information element
Table 11.2.45.1:  _Cipher Response_ information element
+--------------------------------+ | CR Cipher Response (octet 3) | | | | Bit | | | | 1 | | | | 0 IMEISV shall not be included | | | | 1 IMEISV shall be included | +--------------------------------+
### 11.2.46 Ciphering Command RAND
The Ciphering Command RAND information element contains the random number to
be used for computing the MAC by the MS, to authenticate that the MS has the
correct key Kc.
+-------------------------------------------+----------+ | Ciphering Command RAND IEI | octet 1 | +-------------------------------------------+----------+ | Length of Ciphering Command RAND contents | octet 2 | +-------------------------------------------+----------+ | Ciphering Command RAND value part | octet 3 | | | | | | .... | | | | | | octet 18 | +-------------------------------------------+----------+
Figure 11.2.46.1:  _Ciphering Command RAND_ information element
The GANC generates the random number using the same pseudo-random function as
first cryptographic suite as defined in the profile for IKEv2 in [37].
### 11.2.47 Ciphering Command MAC
The Ciphering Command MAC information element contains the Message
Authentication Code computed by the MS, to authenticate that the MS has the
correct key Kc.
+------------------------------------------+----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------------+----------+---+---+---+---+---+---+---+ | Ciphering Command MAC IEI | octet 1 | | | | | | | | +------------------------------------------+----------+---+---+---+---+---+---+---+ | Length of Ciphering Command MAC contents | octet 2 | | | | | | | | +------------------------------------------+----------+---+---+---+---+---+---+---+ | Ciphering Command MAC value part | octet 3 | | | | | | | | | | | | | | | | | | | | .... | | | | | | | | | | | | | | | | | | | | octet 14 | | | | | | | | +------------------------------------------+----------+---+---+---+---+---+---+---+
Figure 11.2.47.1:  _Ciphering Command MAC_ information element
The MAC is computed as defined in sub-clause 7.9.2.
### 11.2.48 Ciphering Key Sequence Number
The purpose of the _Ciphering Key Sequence Number_ information element is to
make it possible for the network to identify the ciphering key Kc which is
stored in the mobile station without invoking the authentication procedure.
The ciphering key sequence number is allocated by the network and sent with
the AUTHENTICATION REQUEST message to the mobile station where it is stored
together with the calculated ciphering key Kc.
* * *
8 7 6 5 4 3 2 1  
Ciphering Key Sequence IEI octet 1  
Length of Ciphering Key Sequence IE contents octet 2  
spare Key sequence octet 3
* * *
Figure 11.2.48.1: _Ciphering Key Sequence Number_ information element
Table 11.2.48.1: _Ciphering Key Sequence Number_ information element
+--------------------+--------------------+---+--------------------+ | Key sequence | | | | | (octet 3) | | | | | | | | | | Bits | | | | +--------------------+--------------------+---+--------------------+ | 3 | 2 | 1 | | +--------------------+--------------------+---+--------------------+ | | | | | +--------------------+--------------------+---+--------------------+ | 0 | 0 | 0 | | +--------------------+--------------------+---+--------------------+ | through | Possible values | | | | | for the ciphering | | | | | key | | | +--------------------+--------------------+---+--------------------+ | 1 | 1 | 0 | sequence number | +--------------------+--------------------+---+--------------------+ | | | | | +--------------------+--------------------+---+--------------------+ | 1 | 1 | 1 | No key is | | | | | available (MS to | | | | | network); | +--------------------+--------------------+---+--------------------+ | | | | Reserved (network | | | | | to MS) | +--------------------+--------------------+---+--------------------+
### 11.2.49 SAPI ID
The SAPI ID IE is used by the MS to indicate the SAPI value for the upper
layer message.
* * *
8 7 6 5 4 3 2 1  
SAPI ID IEI octet 1  
Length of SAPI ID IE contents octet 2  
spare SAPI ID octet 3
* * *
Figure 11.2.49.1: SAPI ID information element
Table 11.2.49.1: SAPI ID information element
+-----------------------------+---+---+-----------------------------+ | SAPI ID, SAPI Identifier | | | | | (octet 3) | | | | | | | | | | Bits | | | | +-----------------------------+---+---+-----------------------------+ | 3 | 2 | 1 | | +-----------------------------+---+---+-----------------------------+ | 0 | 0 | 0 | SAPI 0 (all other except | | | | | SMS) | +-----------------------------+---+---+-----------------------------+ | 0 | 1 | 1 | SAPI 3 (SMS) | +-----------------------------+---+---+-----------------------------+ | All other values are | | | | | undefined in Release 1. | | | | +-----------------------------+---+---+-----------------------------+
### 11.2.50 Establishment Cause
The Establishment Cause IE is used by the MS the indicate the type of the
transaction being initiated to the network.
* * *
8 7 6 5 4 3 2 1  
Establishment Cause IEI octet 1  
Length of Establishment Cause IE contents octet 2  
Establishment Cause octet 3
* * *
Figure 11.2.50.1: Establishment Cause information element
Table 11.2.50.1: Establishment Cause information element
+----------------------------------------------------------------------+ | Establishment Cause (octet 3) | | | | Bits 8 ... 1 | | | | 1010 0000 Emergency | | | | 1100 0000 Call re-establishment | | | | 0000 0000 Location Update | | | | 0001 0000 Other SDCCH procedures including IMSI Detach, SMS, SS, | | paging response | | | | // note: Paging response for \"SDCCH needed\" is using codepoint | | \"0001 0000\" | | | | 0010 0000 Paging response (TCH/F needed) | | | | 0011 0000 Paging response (TCH/F or TCH/H needed) | | | | 1000 0000 Paging response (\"any channel\" needed) | | | | 0100 0000 Originating speech call from dual-rate mobile station when | | TCH/H is sufficient | | | | 0101 0000 Originating data call from dual-rate mobile station when | | TCH/H is sufficient | | | | 1110 0000 Originating speech call and TCH/F is needed | | | | 1111 0000 Originating data call and TCH/F is needed | | | | All other values are undefined in Release 1. | +----------------------------------------------------------------------+
### 11.2.51 Channel Needed
The Channel Needed IE is equivalent to the Channel Needed IE specified in [12]
and is coded as per following definition:
* * *
8 7 6 5 4 3 2 1
Channel Needed IEI octet 1
Length of Channel Needed IE contents octet 2
spare CHANNEL\ octet 3  
(first)
* * *
Figure 11.2.51.1: Channel Needed information element
Table 11.2.51.1: Channel Needed information element
+---------------------------------+ | CHANNEL (octet 3) | | | | Bits | | | | 2 1 | | | | 0 0 Any channel. | | | | 0 1 SDCCH. | | | | 1 0 TCH/F (Full rate). | | | | 1 1 TCH/H or TCH/F (Dual rate). | +---------------------------------+
### 11.2.52 PDU in Error
The PDU in Error IE contains a faulty message returned to the sender of the
message.
* * *
8 7 6 5 4 3 2 1  
PDU in Error IEI octet 1  
Length of PDU in Error contents octet 2, 2a  
PDU in Error, 1st octet octet 3
PDU in Error, last octet octet n
* * *
Figure 11.2.52.1: PDU in Error information element
NOTE: If the faulty message included in the _PDU in Error_ IE is larger than
255 octets then only the first 255 octets of the message are to be included
and the _Length of the PDU in Error_ field shall indicate that 255 octets are
included.
### 11.2.53 Sample Size
The Sample Size IE is used by the network to indicate the minimum size of the
CS payload frames to be included in each RTP/UDP packet. It is also used by
the MS to indicate to the network the sample size used by the MS and to be
applied by the network in the downlink.
* * *
8 7 6 5 4 3 2 1  
Sample Size IEI octet 1  
Length of Sample Size IE contents octet 2  
Sample Size octet 3
* * *
Figure 11.2.53.1: Sample Size information element
Table 11.2.53.1: Sample Size information element
* * *
Sample Size (octet 3)  
20 20 ms of CS payload included in each RTP/UDP packet 40 40 ms of CS payload
included in each RTP/UDP packet 60 60 ms of CS payload included in each
RTP/UDP packet 80 80 ms of CS payload included in each RTP/UDP packet All
other values are undefined in Release 1.
* * *
### 11.2.54 Payload Type
The Payload Type IE is used to indicate the RTP Payload Type for dynamically
assigned Payload Type.
* * *
8 7 6 5 4 3 2 1  
Payload Type IEI octet 1  
Length of Payload Type IE contents octet 2  
Payload Type octet 3
* * *
Figure 11.2.54.1: Payload Type information element
Table 11.2.54.1: Payload Type information element
+----------------------------------------------+ | Payload Type (octet 3) | | | | Allowed values are between 96 and 127. | | | | All other values are undefined in Release 1. | +----------------------------------------------+
### 11.2.55 Multirate Configuration
The _MultiRate configuration_ information element gives parameters related to
the multi-rate speech codec used in GAN A/Gb mode.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Multirate | octet 1 | | | | | | | | | Configuration IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of Multirate | octet 2, 2a | | | | | | | | | Configuration | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE, | octet 3 | | | | | | | | | except the | | | | | | | | | | Threshold and | .... | | | | | | | | | Hysteresis values, | | | | | | | | | | is coded as in | octet n | | | | | | | | | [12], not | | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | | | | | | | | | | The included | | | | | | | | | | Threshold and | | | | | | | | | | Hysteresis values | | | | | | | | | | shall be coded | | | | | | | | | | according to Table | | | | | | | | | | 11.2.55.1 and Annex | | | | | | | | | | D.1. | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.55.1: Multirate Configuration information element
Table 11.2.55.1:  _MultiRate configuration_ information element
+---------------------------------------------+-----------------------+ | Octet 3 - n | Hysteresis Frame Loss | | | | | Threshold Frame Loss | value Ratio | | | | | value Ratio | 0 = 0 % | | | | | 0 = 0 % | 1 = 0.25 % | | | | | 1 = 0.25 % | 2 = 0.5 % | | | | | ... | 3 = 0.75 % | | | | | 19 = 4.75 % | 4 = 1 % | | | | | 20 = 5 % | 5 = 1.5 % | | | | | 21 = 5.5 % | 6 = 2 % | | | | | ... | 7 = 2.5 % | | | | | 39 = 14.5 % | 8 = 3 % | | | | | 40 = 15 % | 9 = 4 % | | | | | 41 = 16 % | 10 = 5 % | | | | | ... | 11 = 6 % | | | | | 50 = 25 % | 12 = 8 % | | | | | 51 = 26 % | 13 = 10 % | | | | | 52 = 28 % | 14 = 13 % | | | | | ... | 15 = 17 % | | | | | 62 = 48 % | | | | | | 63 = 50 % | | +---------------------------------------------+-----------------------+ | The Frame Loss Ratio (FLR) is the number of | | | missing speech frames at the receiver, | | | divided by the total number of expected | | | speech frames for the speech signal during | | | the actual measurement period. When there | | | are redundant speech frames, these shall | | | also be counted both when missing and as | | | included in the complete speech signal | | | respectively. In missing RTP packets, the | | | number of redundant speech frames shall be | | | assumed to follow the used RTP Redundancy | | | Configuration and the latest Codec Mode | | | Request value, CMR, signalled to the | | | sending part. (For CMR, see annex A.) For | | | example, when RTP sample size is 20 ms, | | | single redundancy is used and two RTP | | | packets are missing during the last second, | | | the frame loss ratio is (2+2)/(2*50) = 4%. | | | | | | A filter shall be applied to the frame loss | | | ratio before comparing it with the | | | threshold and hysteresis values according | | | to Annex D.1. | | +---------------------------------------------+-----------------------+
### 11.2.56 Mobile Station Classmark 3
The purpose of the _Mobile Station Classmark 3_ information element is to
provide the network with information concerning aspects of the mobile station.
The contents might affect the manner in which the network handles the
operation of the mobile station. The Mobile Station Classmark information
indicates general mobile station characteristics and it shall therefore,
except for fields explicitly indicated, be independent of the frequency band
of the channel it is sent on.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Mobile station | octet 1 | | | | | | | | | classmark 3 IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of mobile | octet 2, 2a | | | | | | | | | station classmark 3 | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [8], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.56.1: Mobile Station Classmark 3 information element
### 11.2.57 LLC-PDU
This information element contains an LLC-PDU. The element coding is:
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | LLC-PDU IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of LLC-PDU | octet 2, 2a | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is coded as in | | | | | | | | | | [19], not | .... | | | | | | | | | including IEI and | | | | | | | | | | length, if present. | octet n | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.57.1: LLC-PDU information element
### 11.2.58 Location Black List indicator
The Location Black List indicator information element is used to indicate
which part of the Location Area Identification is to be added in the Location
Black List.
* * *
8 7 6 5 4 3 2 1  
Location Black List indicator IEI octet 1  
Length of Location Black List indicator contents octet 2  
spare LBLI octet 3
* * *
Figure 11.2.58.1: Location Black List indicator information element
Table 11.2.58.1: Location Black List indicator information element
+-----------------------------------------------+---+---+------------------+ | LBLI, Location Black List indicator (octet 3) | | | | | | | | | | Bits | | | | +-----------------------------------------------+---+---+------------------+ | 3 | 2 | 1 | | +-----------------------------------------------+---+---+------------------+ | 0 | 0 | 0 | MCC | +-----------------------------------------------+---+---+------------------+ | 0 | 0 | 1 | MCC and MNC | +-----------------------------------------------+---+---+------------------+ | 0 | 1 | 0 | MCC, MNC and LAC | +-----------------------------------------------+---+---+------------------+ | All other values are undefined in Release 1. | | | | +-----------------------------------------------+---+---+------------------+
### 11.2.59 Reset Indicator
The Reset Indicator information element is used to signal to the MS when the
flow control procedure is complete and the MS can reset the maximum uplink
data rate to normal level.
* * *
8 7 6 5 4 3 2 1  
Reset Indicator IEI octet 1  
Length of Reset Indicator contents octet 2  
spare RI octet 3
* * *
Figure 11.2.59.1 Reset Indicator information element
**_Table 11.2.59.1: Reset Indicator information element_**
+---------------------------------------------------+ | RI, Reset Indicator (octet 3) | | | | Bit | | | | 1 | | | | 0 The flow control condition continues to exist.. | | | | 1 The flow control condition no longer exists. | +---------------------------------------------------+
### 11.2.60 TU4003 Timer
The purpose of this information element is to indicate to the MS how often it
is allowed to send flow control messages. In case of CS traffic channel is
activated or released or in case of GA-CSR state transition, MS is allowed to
update Flow Control condition by sending GA-PSR-DFC-REQ message while TU4003
is running.
* * *
8 7 6 5 4 3 2 1  
TU4003 Timer IEI octet 1  
Length of TU4003 Timer IE contents octet 2  
TU4003 Timer value MSB octet 3  
TU4003 Timer value LSB octet 4
* * *
Figure 11.2.60.1: TU4003 Timer information element
Table 11.2.60.1: TU4003 Timer information element
+----------------------------------------------------------------------+ | TU4003 Timer value (octet 3 and 4) | | | | In the TU4003 Timer value field bit 8 of octet 3 is the most | | significant bit and bit 1 of octet 4 the least significant bit. | | | | The value is given in number of seconds. | | | | The TU4003 Timer value consists of 2 octets. | +----------------------------------------------------------------------+
### 11.2.61 AP Service Name
The AP Service Name element contains either the SSID or the PAN Service Name
of the unlicensed AP being used.
* * *
8 7 6 5 4 3 2 1  
AP Service Name IEI octet 1  
Length of AP Service Name IE contents octet 2, 2a  
AP Service Name type octet 3  
AP Service Name MSB octet 4
AP Service Name LSB octet n
* * *
Figure 11.2.61.1: AP Service Name information element
Table 11.2.61.1: AP Service Name information element
+----------------------------------------------------------------------+ | AP Service Name type number value (octet 3)\ | | Bits\ | | 8 7 6 5 4 3 2 1\ | | 0 0 0 0 0 0 0 1 SSID\ | | 0 0 0 0 0 0 1 0 PAN Service Name | | | | All other values are undefined in Release 1. | | | | AP Service Name value (octet 4 to octet n)\ | | The AP Service Name is coded as a string according to UTF-8 format | | defined in RFC 3629 [50]. This means that the 1^st^ octet of the | | UTF-8 string is coded in octet 4 and the last octet of the UTF-8 | | string is coded in the last octet of this IE (octet n). | +----------------------------------------------------------------------+
### 11.2.62 GAN Service Zone Information
The purpose of the _GAN Service Zone Information_ information element is to
provide the mobile station with GAN Service Zone related information
applicable to the current location of the user. It consists of two fields.
_GAN Service Zone Name_ string can be used by the GANC to indicate textual
information related to the location. _GAN Service Zone Icon Indicator_ can be
used by the GANC to turn on various indicators in the mobile station.
* * *
GAN Service Zone Information IEI octet 1 Length of GAN Service Zone
Information value contents octet 2, 2a GAN Service Zone Icon Indicator octet 3
Length of GAN Service Zone string octet 4 GAN Service Zone string, 1^st^
character octet 5
GAN Service Zone string, last character octet n
* * *
Figure 11.2.62.1:  _GAN Service Zone Information_ information element
Table 11.2.62.1: _GAN Service Zone Information_ information element
+----------------------------------------------------------------------+ | GAN Service Zone Icon Indicator, octet 3 | | | | Value | | | | 1 Unlimited Calls | | | | 128-254 Operator specific values | | | | All other values are reserved. | | | | GAN Service Zone Name, octets 4-n | | | | Octet 4 defines the length (i.e. number of octets) of the GAN | | Service Zone Name string starting in octet 5. Maximum length of the | | GAN Service Zone Name string is 32 characters and as each character | | can be presented using 1 to 4 octets the maximum number of octets is | | 128. | | | | The GAN Service Zone Name string (octets 5 to n) is coded as a | | string according to UTF-8 format defined in RFC 3629 [50]. This | | means the 1st octet of the UTF-8 string is coded in octet 5 and the | | last octet of the UTF-8 string is coded in the last octet of this | | field (octet n). | +----------------------------------------------------------------------+
### 11.2.63 RTP Redundancy Configuration
The _RTP Redundancy configuration_ information element provides the parameters
related to redundancy policy for the AMR active codec set. For each mode of
the AMR codec set, the redundancy level is indicated i.e. no redundancy
(window size 1), single redundant frame (window size 2), double redundant
frames (window size 3). The mode for encoding redundant frames can be equal to
or lower than the mode for the primary encoding.
For each mode of the AMR Active Mode Set, as signaled in the Multi-rate
Configuration IE, the window size for including redundant frames is indicated.
So if e.g. the Active Mode Set contains four active modes, then the RTP
Redundancy Configuration IE consists of six octets, of which four indicate the
Codec Mode to Window Size mapping.
+------------+------------+------------+---------+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------+------------+------------+---------+---+---+---+---+---+ | RTP | octet 1 | | | | | | | | | Redundancy | | | | | | | | | | Con | | | | | | | | | | figuration | | | | | | | | | | IEI | | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+ | Length of | octet 2, | | | | | | | | | RTP | 2a | | | | | | | | | Redundancy | | | | | | | | | | Con | | | | | | | | | | figuration | | | | | | | | | | IE | | | | | | | | | | contents | | | | | | | | | +------------+------------+------------+---------+---+---+---+---+---+ | GAN A/Gb | GAN Iu | Window | octet 3 | | | | | | | Mode | Mode | Size | | | | | | | | | | | .... | | | | | | | Codec Mode | Codec Mode | | | | | | | | | | | | octet n | | | | | | +------------+------------+------------+---------+---+---+---+---+---+
Figure 11.2.63.1: Redundancy Configuration information element
Table 11.2.63.1: Redundancy configuration IE
+-----------------------------+-------+-----------------------------+ | Window Size (octet 3 to | | | | octet n) | | | | | | | | Bits | | | +-----------------------------+-------+-----------------------------+ | 2 | 1 | | +-----------------------------+-------+-----------------------------+ | 0 | 0 | Window size 1, No | | | | redundancy | +-----------------------------+-------+-----------------------------+ | 0 | 1 | Window size 2 (single | | | | redundancy) | +-----------------------------+-------+-----------------------------+ | 1 | 0 | Window size 3 (double | | | | redundancy) | +-----------------------------+-------+-----------------------------+ | All other values are | | | | reserved | | | +-----------------------------+-------+-----------------------------+ | GAN A/Gb Mode Codec Mode | | | | (octet 3 to octet n) | | | | | | | | Bits | | | +-----------------------------+-------+-----------------------------+ | **8** | **7** | | +-----------------------------+-------+-----------------------------+ | The GAN A/Gb Mode Codec | | | | Mode is coded as in [47] | | | | sub-clause 3.4.1 | | | +-----------------------------+-------+-----------------------------+ | GAN Iu Mode Codec Mode | | | | (octet 3 to octet n) | | | | | | | | Bits | | | | | | | | **6 5 4 3** | | | | | | | | 0 0 0 0 Represents the | | | | lowest codec mode (lowest | | | | bit-rate) of the ACS | | | | | | | | 0 0 0 1 Represents the | | | | second lowest mode, if the | | | | ACS includes more than one | | | | mode | | | | | | | | 0 0 1 0 Represents the | | | | third lowest mode, if the | | | | ACS includes more than two | | | | modes | | | | | | | | 0 0 1 1 Represents the | | | | fourth lowest mode, if the | | | | ACS includes more than | | | | three modes | | | | | | | | 0 1 0 0 Represents the | | | | fifth lowest mode, if the | | | | ACS includes more than four | | | | modes | | | | | | | | 0 1 0 1 Represents the | | | | sixth lowest mode, if the | | | | ACS includes more than five | | | | modes | | | | | | | | 0 1 1 0 Represents the | | | | seventh lowest mode, if the | | | | ACS includes more than six | | | | modes | | | | | | | | 0 1 1 1 Represents the | | | | highest mode, if the ACS | | | | includes eight modes | | | +-----------------------------+-------+-----------------------------+
### 11.2.64 UTRAN Classmark
The _UTRAN Classmark_ information element includes the INTER RAT HANDOVER INFO
(defined in [40]) which gives UTRAN related information to the network (target
system) for the purpose of intersystem handover.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | UTRAN Classmark IEI | octet 1 | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of UTRAN | octet 2, 2a | | | | | | | | | Classmark contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is the INTER RAT | | | | | | | | | | HANDOVER INFO coded | .... | | | | | | | | | as in [40], not | | | | | | | | | | including IEI and | octet n | | | | | | | | | length, if present. | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.64.1: UTRAN Classmark information element
### 11.2.65 Classmark Enquiry Mask
The Classmark Enquiry mask defines the information to be returned to the
network. The bit mask defines the specific information to be returned, such as
UTRAN specific information and/or requests the sending of the GA-CSR CLASSMARK
CHANGE message.
+---------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-------------+---+---+---+---+---+---+---+ | Classmark Enquiry | octet 1 | | | | | | | | | Mask IEI | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | Length of Classmark | octet 2, 2a | | | | | | | | | Enquiry Mask | | | | | | | | | | contents | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+ | The rest of the IE | octet 3 | | | | | | | | | is the Classmark | | | | | | | | | | Enquiry Mask coded | .... | | | | | | | | | as in [12], not | | | | | | | | | | including IEI and | octet n | | | | | | | | | length, if present. | | | | | | | | | +---------------------+-------------+---+---+---+---+---+---+---+
Figure 11.2.65.1: Classmark Enquiry Mask information element
### 11.2.66 UTRAN Cell Identifier List
The UTRAN Cell Identifier List information element is used to transfer
multiple UTRAN target cell identifiers from the MS to the GANC.
* * *
8 7 6 5 4 3 2 1  
UTRAN Cell Identifier List IEI octet 1  
Length of UTRAN Cell Identifier List value contents octet 2, 2a  
spare UTRAN Cell Identification Discriminator octet 3  
UTRAN Cell Identification 1
UTRAN Cell Identification n
* * *
Figure 11.2.66.1:  _UTRAN Cell Identifier List_ information element
The length of the UTRAN Cell Identifier List information element depends on
the UTRAN Cell Identification Discriminator (octet 3).
The \"UTRAN Cell Identification Discriminator\" is coded as follows:
0000 PLMN-ID, LAC and a 28-bit Cell Id are used to identify the target UTRAN
cell.
All other values are reserved.
The coding of the UTRAN Cell Identifications 1 to n depends on the Cell
identification discriminator (octet 3). Below the coding is shown for each
UTRAN Cell Identification Discriminator:
Coding of UTRAN Cell Identification for UTRAN Cell Identification
Discriminator = 0000
Table 11.2.66.1: Coding of UTRAN Cell Identification Discriminator = 0000
* * *
8 7 6 5 4 3 2 1  
MCC digit 2 MCC digit 1 octet m  
MNC digit 3 MCC digit 3 octet m+1  
MNC digit 2 MNC digit 1 octet m+2  
LAC octet m+3  
LAC cont. octet m+4  
3G Cell identity octet m+5  
3G Cell identity cont. octet m+6  
3G Cell identity cont. octet m+7  
3G Cell identity cont. Spare octet m+8
* * *
**LAC, Location Area Code** (2 octet field)\ This field is the binary
representation of the Location Area Code, see [3]. The LAC field consists of
16 bits. Bit 8 in octet m+3 is the most significant bit and bit 1 in octet m+4
is the least significant bit.
**3G Cell Identity** (4 octet field).\ The octets (m+5)-(m+8) are coded as
octets 3-6 in sub-clause 11.2.73.
### 11.2.67 Serving GANC table indicator
The purpose of the _Serving GANC table_ _indicator_ is to indicate to the
mobile station if it is allowed to store information in the stored Serving
GANC table after a successful registration.
* * *
8 7 6 5 4 3 2 1  
Serving GANC table indicator IEI octet 1  
Length of Serving GANC table indicator value contents octet 2  
spare SUTI octet 3
* * *
Figure 11.2.67.1 Serving GANC table indicator information element
_Table 11.2.67.1: Serving GANC table indicator information element_
+----------------------------------------------------------------------+ | SUTI, Serving GANC table indicator (octet 3) | | | | Bit | | | | 1 | | | | 0 The MS is not allowed to store information in the stored Serving | | GANC table but should still maintain the existing content of the | | serving GANC table - \"Do Not Store\". | | | | 1 The MS is allowed to store information in the stored Serving GANC | | table\"Store\". | +----------------------------------------------------------------------+
### 11.2.68 Registration indicators
The _Registration indicators information element_ is used by the mobile
station to indicate status information related to the registration request to
the network. This information element is included only when attempting to
register to the Default GANC.
* * *
8 7 6 5 4 3 2 1  
Registration indicators IEI octet 1  
Length of Registration indicators contents octet 2  
spare MPS octet 3
* * *
Figure 11.2.68.1 Registration indicators information element
_Table 11.2.68.1: Registration indicators information element_
+----------------------------------------------------------------------+ | **MPS** , Manual PLMN Selection indicator (octet 3) | | | | Bit | | | | 2 1 | | | | > 0 0 The MS is in Automatic PLMN selection mode and user | | > reselection was not triggered. | | > | | > 0 1 The MS is in Manual PLMN selection mode and/or user | | > reselection was triggered. The MS requests the list of PLMN | | > identities that may provide GAN service in the current location. | | | | All other values are reserved for future use. | +----------------------------------------------------------------------+
### 11.2.69 GAN PLMN List
The GAN PLMN List information element is used by the network to indicate
possible PLMNs that may provide GAN service to the MS in its current location.
The information element contains the PLMN identifier and the associated GANC
and GANC-SEGW address information for each PLMN in the list. It may also
contain PLMN specific GAN Service Zone Information.
* * *
8 7 6 5 4 3 2 1  
GAN PLMN List IEI octet 1  
Length of GAN PLMN List value contents octet 2, 2a  
Number of PLMNs octet 3  
PLMN information, PLMN 1
PLMN information, PLMN n
* * *
Figure 11.2.69.1:  _PLMN List_ information element
The \"Number of PLMNs\" (octet 3) contains the number of PLMN information
items in the list. Bit 8 of octet 3 is the most significant bit and bit 1 of
octet 3 the least significant bit.
Coding of PLMN information for each PLMN is the following:
* * *
8 7 6 5 4 3 2 1  
MCC digit 2 MCC digit 1 octet m  
MNC digit 3 MCC digit 3 octet m+1  
MNC digit 2 MNC digit 1 octet m+2  
Spare GAN Modes GSZI GANC-ADDR SEGW-ADDR octet m+3  
GANC-SEGW Address information  
GANC Address information  
GAN Service Zone information
* * *
Figure 11.2.69.2:  _PLMN information_ part of PLMN List information element
Table 11.2.69.1: _PLMN information_ part of PLMN List information element
+----------------------------------------------------------------------+ | **MCC** , Mobile country code (octet m, octet m+1 bits 1 to 4) | | | | The MCC field is coded as in ITU-T Rec. E212, Annex A. | | | | **MNC** , Mobile network code (octet m+2, octet m+1 bits 5 to 8). | | | | The coding of this field is the responsibility of each | | administration but BCD coding shall be used. The MNC shall consist | | of 2 or 3 digits. For PCS 1900 for North America, Federal Regulation | | mandates that a 3-digit MNC shall be used. However a network | | operator may decide to use only two digits in the MNC over the radio | | interface. In this case, bits 5 to 8 of octet m+1 shall be coded as | | \"1111\". Mobile equipment shall accept MNC coded in such a way. | | | | **SEGW-ADDR** , GANC-SEGW address type indicator (octet m+3) | | | | Bits | | | | 2 1 | | | | 0 0 GANC-SEGW Address Information for this PLMN is coded as | | IP-address. The format is as defined in sub-clause 11.2.9, \"IP | | Address\" excluding the IP address IEI, but including Length | | Indicator, IP Address Type and Address Information. | | | | 1 0 GANC-SEGW Address Information for this PLMN is coded as FQDN. | | The format is as defined in sub-clause 11.2.10, \"Fully Qualified | | Domain/Host Name (FQDN)\" excluding the FQDN IEI, but including | | Length Indicator and FQDN. | | | | **GANC-ADDR** , GANC address type indicator (octet m+3) | | | | Bits | | | | 4 3 | | | | 0 0 GANC Address Information is coded as IP-address. The format is | | as defined in sub-clause 11.2.9, \"IP Address\" excluding the IP | | address IEI, but including Length\ | | Indicator, IP Address Type and Address Information. | | | | 1 0 GANC Address Information is coded as FQDN. The format is as | | defined in sub-clause 11.2.10, \"Fully Qualified Domain/Host Name | | (FQDN)\" excluding the FQDN\ | | IEI, but including Length Indicator and all characters of FQDN. | | | | **GSZI** , GAN Service Zone Information Indicator (octet m+3) | | | | Bit | | | | 5 | | | | 0 GAN Service Zone Information is not included for this PLMN. | | | | 1 GAN Service Zone Information is included for this PLMN. | | | | **GAN Modes** | | | | Bit | | | | 7 6 | | | | 0 0 Unknown | | | | 0 1 The PLMN can only be accessed using GAN A/Gb mode | | | | 1 0 The PLMN can only be accessed using GAN Iu mode | | | | 1 1 The PLMN can be accessed using GAN A/Gb mode or GAN Iu mode | | | | GANC-SEGW Address information and GANC Address information for each | | PLMN are coded as defined by GANC-SEGW and GANC address type | | indicators (for each PLMN). | | | | GAN Service Zone Information is of variable length and the format is | | as defined in the sub-clause 11.2.62, for the octets 3 to n (GAN | | Service Zone Icon Indicator, length of GAN Service Zone Name and GAN | | Service Zone Name). The inclusion of this field is optional for each | | PLMN and is defined by the GSZI bit. | +----------------------------------------------------------------------+
### 11.2.70 GERAN Received Signal Level List
The GERAN Received Signal Level List information element contains the received
signal level for each cell.
* * *
8 7 6 5 4 3 2 1  
GERAN Received Signal Level List IEI octet 1  
Length of GERAN Received Signal Level List value contents octet 2, 2a  
spare **RXLEV-NCELL 1** octet 3  
spare **RXLEV-NCELL 2** octet 4
spare **RXLEV-NCELL n** octet n+2
* * *
Figure 11.2.70.1:  _GERAN Received Signal Level List_ information element
Table 11.2.70.1: _GERAN Received Signal Level List_ information element
+----------------------------------------------------------------------+ | **RXLEV-NCELL i** , Result of measurement on the i\'th neighbour cell | | (octet i+2), i ranges from 1 to n. | | | | The RXLEV-NCELL field is coded as the binary representation of a | | value N. N corresponds according to the mapping defined in | | 3GPP TS 45.008 to the received signal strength on the i\'th | | neighbouring cell. | | | | Range: 0 to 63. | +----------------------------------------------------------------------+
### 11.2.70b UTRAN Received Signal Level List
The UTRAN Received Signal Level List information element contains the received
signal level CPICH Ec/No and CPICH RSCP [46] value for each cell.
* * *
8 7 6 5 4 3 2 1  
UTRAN Received Signal Level List IEI octet 1  
Length of UTRAN Received Signal Level List value contents octet 2, 2a  
spare **Ec/No-NCELL 1** octet 3  
spare RSCP-**NCELL 1** octet 4  
spare **Ec/No-NCELL 2** octet 5  
spare RSCP-**NCELL 2** octet 6
spare **Ec/No-NCELL n** octet 2*n+1  
spare RSCP-**NCELL n** octet 2*n+2
* * *
Figure 11.2.70b.1:  _UTRAN Received Signal Level List_ information element
Table 11.2.70b.1: _UTRAN Received Signal Level List_ information element
+----------------------------------------------------------------------+ | **Ec/No-NCELL i** , Result of Ec/No measurement on the i\'th | | neighbour cell is contained in octet 2*i+1, i ranges from 1 to n. | | | | **RSCP-NCELL i** , Result of RSCP measurement on the i\'th neighbour | | cell is contained in octet 2*i+2, i ranges from 1 to n. | | | | The mapping is defined in [46]. For RSCP the range from \"-116 dBm | | â‰¤ CPICH RSCP \\|\\|
**CMR (Codec Mode Request):** is used for rate adaptation. The value of the
CMR field is set to the frame type index of the corresponding speech mode
being requested. The frame type index may be 0-7 for AMR, or 0-8 for AMR-WB,
as defined in [48]. CMR value 15 indicates that no mode request is present,
and other values are for future use.
**FT (Frame Type index):** indicates either the AMR or AMR-WB speech coding
mode or comfort noise (SID) mode of the corresponding frame carried in this
payload. E.g. in case of AMR speech, a value of FT=7 indicates that this frame
carries AMR 12.2 sample(s).
**Q (frame Quality indicator):** if set to 0, indicates that the corresponding
frame is severely damaged.
The **F** bit indicates whether another speech frame follows in the same
payload (F=1) or if this frame is the last frame in the payload (F=0).
**R** and **P** stand for reserved and padding bits, respectively.
The following diagram shows an octet-aligned AMR payload carrying one AMR 12.2
speech frame-block:
0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| CMR=15\|R\|R\|R\|R\|0\| FT=7 \|Q\|P\|P\| f1(0..7) \| f1(8..15) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f1(16..23) \| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \| f1(232..239) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\|f1(243)\|P\|P\|P\|P\|
+-+-+-+-+-+-+-+-+
The following diagram shows an octet-aligned AMR payload carrying two AMR 12.2
speech frame-blocks:
0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| CMR=15\|R\|R\|R\|R\|1\| FT=7 \|Q\|P\|P\|0\| FT=7 \|Q\|P\|P\| f1(0..7) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f1(8..15) \| f1(16..23) \| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f1(232..239) \|f1(243)\|P\|P\|P\|P\| f2(0..7) \| f2(8..15) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \| f1(232..239) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\|f2(243)\|P\|P\|P\|P\|
+-+-+-+-+-+-+-+-+
NOTE: The last octet in both speech frames is padded with four 0s to make it
octet-aligned.
The following diagram shows an octet-aligned AMR payload carrying one AMR 12.2
speech frame-block (FT=7) and one AMR SID frame (FT=8; 39 bits):
0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| CMR=15\|R\|R\|R\|R\|1\| FT=7 \|Q\|P\|P\|0\| FT=8 \|Q\|P\|P\| f1(0..7) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f1(8..15) \| f1(16..23) \| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| .... \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f1(232..239) \|f1(243)\|P\|P\|P\|P\| f2(0..7) \| f2(8..15) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f2(16..23) \| f2(24..31) \| f2(32..38) \|P\|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
The following diagram shows an octet-aligned AMR payload carrying one AMR SID
frame (FT=8; 39 bits) as defined in Sections 7.4.3 and 7.4.4 of the main body
of this specification for Discontinuous Transmission (DTX):
0 1 2 3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| CMR=15\|R\|R\|R\|R\|0\| FT=8 \|Q\|P\|P\| f1(0..7) \| f2(8..15) \|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| f2(16..23) \| f2(24..31) \| f2(32..38) \|P\|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
The following diagram shows an octet-aligned AMR payload carrying one AMR
NO_DATA frame (FT=15; 0 bits) as defined in Sections 7.4.3 and 7.4.4 of the
main body of this specification when no speech or SID frame is available for a
period of 480 ms:
0 1
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
\| CMR=15\|R\|R\|R\|R\|0\| FT=15 \|Q\|P\|P\|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
Note that the preceding format shown above that results when no speech or SID
frame is received for 480 ms is necessary per Section 7.4.3 and Section 7.4.4.
But this formatting is an intentional deviation from Section 4.3.2 of RFC
3267, which says a packet containing only NO_DATA frames should not be
transmitted.
# A.2 (HS)CSD Framing over RTP
For radio interface rate of 3.6 kbps, the Terminal Adaptation Function (TAF)
in the MS produces a 72-bit frame every 20 ms. For transmission in RTP [35],
this 72-bit frame is packed into a 9 octet payload. The format of this 72-bit
frame is defined in [13].
For radio interface rate of 6 kbps, the Terminal Adaptation Function (TAF) in
the MS produces a 120-bit frame every 20 ms. For transmission in RTP [35],
this 120-bit frame is packed into a 15 octet payload. The format of this
120-bit frame is defined in [13].
For radio interface rate of 12 kbps, the Terminal Adaptation Function (TAF) in
the MS produces a 240-bit frame every 20 ms. For transmission in RTP [35],
this 240-bit frame is packed into a 30 octet payload. The format of this
240-bit frame is defined in [13].
For radio interface rate of 14.5 kbps, the Terminal Adaptation Function (TAF)
in the MS produces a 290-bit frame every 20 ms. For transmission in RTP [35],
this 290-bit frame is packed into a 37 octet payload beginning with a 6-bit
signature (binary 001100),. The format of this 290-bit frame is defined in
[13].
For radio interface rate of 29 kbps, the Terminal Adaptation Function (TAF) in
the MS produces a 580-bit frame every 20 ms. For transmission in RTP [35],
this 580-bit frame is packed into a 73 octet payload beginning with a 4-bit
signature (binary 1100),. The format of this 580-bit frame is defined in [13].
For radio interface rate of 43.5 kbps, the Terminal Adaptation Function (TAF)
in the MS produces a 870-bit frame every 20 ms. For transmission in RTP [35],
this 870-bit frame is packed into a 109 octet payload beginning with a 2-bit
signature (binary 01),. The format of this 870-bit frame is defined in [13].
Radio interface rate of 32kbps is FFS.
The IETF has defined RFC 4040 (\"RTP Payload Format for a 64 kbit/s
Transparent Call\") [51]. This RFC shall be used for the 64 kbps circuit
switched bearer required (for example) for a CS video call supported in GAN
mode.
###### ## Annex B (normative): Network QoS
# B.1 Introduction
The GAN-MS shall check DSCP/ToS information in incoming IP packets from the
GANC and if different from what currently used, copy received DSCP/ToS and use
it for outgoing IP packets.
For a tunnel mode SA, there is an \"outer\" IP header that specifies the IPsec
processing destination, plus an \"inner\" IP header that specifies the
ultimate destination for the packet.
# B.2 Network behaviour
When the GANC-SEGW receives an IP packet from the GANC, it shall make sure
that the DSCP (DiffServ Code Point) values from the \'inner\' IP header are
mapped to the \'outer\' IP header (according to operator configuration) before
forwarding the packet to the MS using the established SA. When several flows
are using the same IPsec tunnel and have a different QoS, e.g. a PS streaming
class flow and a PS background flow, the GANC may decide to assign a specific
DSCP value for each flow identified by its Packet Flow Identifier.
# B.3 MS behaviour
## B.3.1 Receiving of data
### B.3.1.1 Outer IP packet
When the MS receives an encrypted IP packet, it shall store the DSCP value
from the \'outer\' IP header in the context of this IPSec SA for this inner
DSCP value.
### B.3.1.2 Inner IP packet
Furthermore, the MS shall perform the following actions when handling the
received IP packet and UDP datagram or TCP data in the application layer (i.e.
GA-RC, GA-CSR or GA-PSR layers):
\- For a received RTP/UDP packet, read the DSCP value from the \'inner\' IP
header (i.e. using the UDP socket for the traffic channel). If this value is
different from what is currently being used for this RTP/UDP stream, then save
the received DSCP value and use it for all outgoing RTP/UDP packets for this
traffic channel (one way to achieve this is to set the DSCP value for the UDP
socket).
\- For a received GA-PSR-UNITDATA message, read the DSCP value from the
\'inner\' IP header. If this value is different from what is currently being
used for this flow within the GA-PSR TC, then save the received DSCP value and
use it for all outgoing GA-PSR-UNITDATA messages on this flow within the GA-
PSR TC.
\- For a received GA-RC message, GA-CSR message or GA-PSR message containing
signalling or SMS, read the DSCP value from the \'inner\' IP header (i.e.
using the TCP socket for the TCP connection to the GANC). If this value is
different from what is currently being used for this TCP connection, then save
the received DSCP value and use it for all outgoing GA-RC messages, GA-CSR
messages and GA-PSR messages containing signalling or SMS (one way to achieve
this is to set the DSCP value for the TCP socket).
## B.3.2 Sending of data
When the MS is sending an IP packet to the GANC, it shall make sure that the
DSCP (DiffServ Code Point) values for the \'inner\' IP header are computed
from the received IP packets, as described in B.3.1.2 above. Further, the DSCP
value for the \'outer\' IP header is obtained from the stored value in the
IPSec SA context for this inner DSCP value, as described in B.3.1.1 above,
before forwarding the packet to the GANC-SEGW using the established SA.
###### ## Annex C (normative): (Source-RAT) Measurement Report for Handover
and Cell Change Order to GAN
# C.1 Measurement Report for Handover and Cell Change Order to GAN A/Gb mode
The MS uses the (Source-RAT) measurement report procedure to \"request\"
handover to GANA/Gb mode for voice call or signalling session. It also uses it
to \"request\" a Cell Change Order to GAN A/Gb mode for packet data session.
The procedure is initiated after the MS has successfully registered with the
GANC, provided the following conditions are met:
\- the MS stays registered with GANC;
\- the GANC directs the MS to operate in GAN A/Gb mode;
\- the GANC includes the IE \"GAN Cell Description\" in the GA-RC REGISTER
ACCEPT message;
\- if the source RAT is GERAN/UTRAN, and the MS is in dedicated mode
(signalling only or speech mode), network has requested reports according to
NETWORK_CONTROL_ORDER or in DTM mode (simultaneous dedicated mode and packet
transfer mode) or UTRA RRC Connected Mode for CS domain services;
\- the ARFCN provided by the GANC (i.e. the GAN-ARFCN) is within the cell info
list used for measurement reporting in the source RAT;
\- no GSM neighbour cell matching the {GAN-ARFCN, GAN-BSIC} couple has been
detected by the MS.
The MS shall not be connected to more than one GANC at any one time, and
therefore shall not report more than one {GAN-ARFCN, GAN-BSIC} couple during
the period of the connection to the GANC.
The RR entity in the source RAT shall report that the cell associated with the
{GAN-ARFCN, GAN-BSIC} couple has the best possible receiving level (i.e.,
RxLev = 63).
# C.2 Measurement Report for Handover and Cell Change Order to GAN Iu mode
The MS uses the (Source-RAT) measurement report procedure to \"request\"
handover to GAN Iu mode for CS, PS or both CS and PS sessions. It also uses it
to \"request\" a Cell Change Order from GERAN to GAN Iu mode for PS sessions.
The procedure is initiated after the MS has successfully registered with GANC,
provided the following conditions are met:
\- the MS stays registered with GANC;
\- the GANC directs the MS to operate in GAN Iu mode;
\- the GANC includes the IE \"GAN Iu Mode Cell Description\" in the GA-RC
REGISTER ACCEPT message;
\- if the source RAT is GERAN, the MS is in dedicated mode and the network has
requested reports according to NETWORK_CONTROL_ORDER or in DTM mode
(simultaneous dedicated mode and packet transfer mode);
\- if the source RAT is UTRAN, the MS is in UTRA RRC Connected Mode (i.e., for
CS domain, PS domain or both CS and PS domain services);
\- the UARFCN and Primary Scrambling Code provided by GANC in the IE \"GAN Iu
Mode Cell Description\" (i.e. the GAN-UARFCN and GAN-PSC) are within the cell
info list used for measurement reporting in the source RAT;
\- no UTRAN neighbour cell matching the {GAN-UARFCN, GAN-PSC} couple has been
detected by the MS.
The MS shall not be connected to more than one GANC at any one time, and
therefore shall not report more than one {GAN-UARFCN, GAN-PSC} couple during
the period of the connection to the GANC.
The RR entity in the source RAT shall report that the cell associated with the
{GAN-UARFCN, GAN-PSC} couple has the best possible receiving level (i.e., RSCP
= 91 or Ec/No=63).
###### ## Annex D (normative): RFC 4867 Framing Parameters for GAN
# D.1 RFC 4867 Framing Parameters for GAN
When carrying AMR or AMR-WB voice in GAN, the following RTP framing parameters
shall be used:
\- Octet-aligned
\- No frame CRCs
\- No robust sorting
\- No frame interleaving
\- Single channel per session
\- Mode-change-period = 2 i.e. mode can change every 2nd speech frame
\- Mode-change-neighbor = 1 i.e. mode can only change to neighbouring mode in
the active mode set
\- Mode-set: signalled in _Multirate Configuration_ IE
\- Forward error correction: single or double retransmission of the previously
transmitted frame (s) (i.e. window size of 2 or 3). To request a concurrent
AMR and redundancy mode adaptation, the decoder (speech receiver) signals the
encoder (speech sender) the new AMR mode it prefers in Codec Mode Request
(CMR). The redundancy mode for each mode of the Active Codec Set is signaled
in the Redundancy Configuration IE. This way the preferred redundancy mode is
also implicitly requested with the CMR. (Triple redundancy is not used, as it
would add too much network load. When the third redundant frame has to be
used, there would also be too long delays.)
The frame loss rate for the received speech data is continuously monitored by
the MS and the network. If the sender is currently using codec mode N where
increasing N means a codec mode with higher bitrate, the following applies.
\- When the frame loss rate goes above Threshold N-1, the receiver signals the
sender to change to codec mode N-1 and thereby also to the redundancy mode
associated with codec mode N-1.
\- When the frame loss rate goes below Threshold N - Hysteresis N, the
receiver signals the sender to change to codec mode N+1 and thereby also to
the redundancy mode associated with codec mode N+1.
The frame loss rate threshold and hysteresis values used for triggering a
switch in AMR mode shall be given by the network in a consistent order, i.e.
such that:
\- THR_1 â‰¥ THR_2 â‰¥ THR_3, and
\- THR_1 - HYST_1 â‰¥ THR_2 - HYST_2 â‰¥ THR_3 - HYST_3.
The initial codec mode, and associated redundancy mode, to use, is signaled in
Multirate Configuration IE, at channel activation or at channel mode modify.
###### ## Annex E (normative): GAN Specific Requirements for Interworking with
UTRAN
# E.1 GAN A/Gb Mode Specific Requirements for Interworking with UTRAN
The UE shall include the _Support of Handover to GAN_ indication in the UE
Radio Access Capabilities provided to the RNC.
NOTE: The RNC support of functionality for UTRAN to GAN Handover is implied by
the inclusion of the ARFCN for GAN in the neighbour cell list of the UE.
The GAN and GERAN capable UE shall conform to all the requirements for Inter-
RAT events as defined in TS 25.331 for reporting GERAN cells.
W.r.t. reporting GAN cells, the UE can be in one of two modes:
> GAN preferred: the UE prefers to stay in GAN rather than GERAN or UTRAN.
>
> GERAN/UTRAN preferred: the UE prefers to stay in GERAN/UTRAN rather than
> GAN;
Reporting of GAN cells is only performed with event 3A; GAN cells are never
reported by events 3B, 3C, 3D or periodic reporting.
The GAN capable UE shall conform to all the requirements for Inter-RAT
measurement reporting as defined in TS 25.331 for reporting of GAN cells,
except when stated below:
\- For the reporting of a GAN cell in case of configured event 3A, the UE
shall act on the information originally received in the Measurement Control
message as follows:
\- Treat the value of the \"Hysteresis\" parameter as 0.
\- Ignore the \"Threshold other system\" parameter.
\- Treat the value of the \"Time to trigger\" parameter as 0ms.
\- When the UE is in GAN preferred mode and an event 3A has been configured,
the UE shall in addition act on the information originally received in the
Measurement Control message, as follows:
\- Treat the value of the \"Threshold own system\" parameter as 0.
As a result, the UE can report a GAN cell whenever it has successfully
registered on a GANC;
\- When the UE is in GERAN/UTRAN preferred mode and an event 3A has been
configured, the UE shall only send a measurement about the GAN cell to trigger
handover when no GERAN cells from the Inter-RAT measurement object list
satisfy the triggering condition of the configured Event (as described in TS
25.331).
\- When the UE is in GAN preferred mode and an event 3A has been configured,
the UE may send a measurement about the GAN cell to trigger handover
immediately following successful registration on the GANC.
\- When the UE is sending an event 3A related measurement report about a GAN
cell in order to trigger handover, the UE shall report that the GAN cell has
the best possible receiving level (i.e., GSM carrier RSSI = 63) and therefore
complies with the \"threshold other system\" signalled in the information
originally received in the Measurement Control message.
NOTE: If the UE is in GAN preferred mode and an event 3A has been configured,
it does not need to make inter-RAT measurements prior to including GAN cell
information in the Measurement Report message sent to the UTRAN to trigger
handover to GAN.
\- The UE shall not include GAN cells in other Inter-RAT measurement reporting
than when triggered by event 3A.
\- If an event 3A is configured only with Inter-RAT cells not within any of
the GERAN bands supported by the UE (as specified by the IE \"Inter-RAT
measurements object list\" and taking into account any restriction configured
by the IE \"cell for measurement\") this event shall not be counted as an
Inter-RAT reporting criterion with respect to the UE capability for the Inter-
RAT measurement category.
\- If the UE fails to complete the handover to GAN as requested by the
Handover From UTRAN Command message (e.g. UE loses connection to GAN), it
shall act as in the handover failure case specified in TS 25.331.
The selection of the RF channel number (ARFCN) used for the UTRAN to GAN
handover procedure should not correspond to a channel from any frequency band
defined in TS 45.005, to avoid UEs not requiring compressed mode for GSM
measurements from unnecessarily powering up their GSM receivers.
# E.2 GAN Iu Mode Specific Requirements for Interworking with UTRAN
When operating in GAN Iu mode, the GANC emulates a UTRAN RNC to the rest of
the network. Therefore, the UTRAN to GAN and GAN to UTRAN handovers are
considered to be intra-system (UTRAN-to-UTRAN) handovers. This differs from
the GAN A/Gb mode case where UTRAN to GAN and GAN to UTRAN handovers are
considered to be inter-system (i.e., inter-RAT) handovers.
In addition to the procedures described in sub-clauses 8a.10 and 8a.11, the
following procedures shall be followed with respect to GAN Iu mode handover to
and from UTRAN:
1\. When a UTRAN to GAN Iu mode to UTRAN handover sequence occurs:
\- The GANC shall retain the Chosen Integrity Protection Algorithm (CIPA),
Chosen Encryption Algorithm (CEA), Integrity Key (IK), Ciphering Key (CK) and
COUNT parameters received from the source RNC. The GAN shall relay these
parameters to the target RNC.
\- The MS shall store the START values that are in effect when entering GAN Iu
mode. The MS shall provide the START values to the GANC (i.e., in the GA-RRC
RELOCATION INFORMATION message) and the GANC shall forward the START values
with the other parameters (described above) to the target RNC.
2\. When a UTRAN to GAN Iu mode handover occurs (i.e., other than described in
bullet 1 above):
\- The MS shall store the START values that are in effect when entering GAN Iu
mode. When the MS transitions to the idle state (i.e., GA-RRC IDLE state for
both CS and PS domains) while in GAN Iu mode, then the MS shall compare the
START values with THRESHOLD and set the START values and key status as
described in TS 25.331 [40] (i.e., behave as if the connection was released in
UTRAN).
3\. When a GAN Iu mode to UTRAN handover occurs (i.e., other than described in
bullet 1 above):
\- The GANC relays the RRC message (e.g., Physical Channel Reconfiguration)
provided by the target RNC in the Relocation Request Ack message to the MS in
the GA-RRC RELOCATION COMMAND. This message includes the Integrity Protection
Activation Info which includes the FRESH value.
\- The GANC shall include the current settings for the security algorithms and
keys (e.g., CIPA, IK, CEA, and CK parameters) in the Source RNC to Target RNC
Transparent Container.
\- The GANC shall obtain the START value(s) from the MS (i.e., in the GA-RRC
RELOCATION INFORMATION message) and include them in the RRC Container sent to
the target RNC in the Source RNC to Target RNC Transparent Container
parameter.
\- The GANC shall initialize the relevant COUNT value(s) to zero and include
them in the RRC Container sent to the target RNC in the Source RNC to Target
RNC Transparent Container parameter.
###### ## Annex F (normative): 3G Cell Identity coding
# F.1 3G Cell Identity coding -- 28 bitstring
* * *
8 7 6 5 4 3 2 1  
3G Cell Identity octet n  
3G Cell Identity cont. octet n+1  
3G Cell Identity cont. octet n+2  
3G Cell Identity cont. Spare octet n+3
* * *
Figure F1.1.1: _3G_ _Cell Identity_ information element
The 3G Cell Identity is defined in 3GPP TS 25.331 and further clarified in
3GPP TS 25.401 as a 28 bit variable, which in the Up protocol has to be
included in 4 octets. Consequently 4 spare bits have to be placed within these
4 octets. Bit 8 in octet n is the most significant bit and bit 5 in octet n+3
is the least significant bit.
# F.2 3G Cell Identity coding -- RNC-Id + C-Id
* * *
8 7 6 5 4 3 2 1  
RNC-Id. octet n  
RNC-Id cont. C-Id Octet n+1  
C-Id cont. octet n+2  
C-Id cont. Spare octet n+3
* * *
Figure F1.2.1: _3G_ _Cell Identity_ information element
3GPP TS 25.401 indicates that the 28 bit 3G Cell Identity consist of a RNC-Id.
(12 bit) and a C-Id (16 bit).\ Bit 8 in octet n is the most significant bit
and bit 5 in octet n+1 is the least significant bit of the RNC-Id.\ Bit 4 in
octet n +1is the most significant bit and bit 5 in octet n+3 is the least
significant bit of the C-Id.
# F.3 3G ell Identity coding -- Extended RNC-Id + C-Id
* * *
8 7 6 5 4 3 2 1  
Extended RNC-Id. octet n  
Extended RNC-Id cont. Octet n+1  
C-Id octet n+2  
C-Id cont. Spare octet n+3
* * *
Figure F1.2.1: _3G_ _Cell Identity_ information element
With introduction of the Extended RNC-Id the 28 bit 3G Cell Identity consist
of a Extended RNC-Id. (16 bit) and a C-Id (12 bit).\ Bit 8 in octet n is the
most significant bit and bit 1 in octet n+1 is the least significant bit of
the Extended RNC-Id.\ Bit 8 in octet n +2 is the most significant bit and bit
5 in octet n+3 is the least significant bit of the C-Id.
###### ## Annex G (informative): Change History