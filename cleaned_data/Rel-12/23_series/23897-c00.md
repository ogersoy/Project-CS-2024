# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
During the production of the 3GPP Release 7 specifications it was recognized
that the IP Multimedia Subsystem was suitable for serving both mobile and
fixed installations and a number of specifications developed by ETSI TISPAN
were therefore embedded in the 3GPP specifications to form the Common IMS.
Among other aspects, Common IMS requires that the IMS is able to connect with
Next Generation Corporate Networks (NGCN), also known as IP-PBXs (see ETSI TS
181 019 [3]).
Managing the connection to IP-PBXs which do not use registration procedures
when connecting to the IMS and operate in a static mode that is to enable the
IMS to receive and send traffic to an IP-PBX, is realized by means of
configuration within the network. The static mode of operation can be used in
2 scenarios, peering based business trunking and subscription based business
trunking. The static mode of operation for both of the above mentioned
scenarios can be studied in this TR.
It was however observed that the number of implementations of IP-PBXs that are
operated in a static mode (e.g. based on the SIPConnect specifications
recently released by the SIP Forum) increases.
The purpose of this study is to enable the IMS to manage connections to a
large number of IP-PBXs that are operated in a static mode, with minimized
configuration in the network.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 41.001: \"GSM Release specifications\".
[3] ETSI TS 181 019: \"Business Communications Requirements\".
[4] 3GPP TS 33.310: \"Network Domain Security (NDS); Authentication Framework
(AF)\".
[5] 3GPP TS 23.228: \"IP Multimedia Subsystem (IMS) Stage 2\".
[6] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[7] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[8] ETSI TS 182 025: \"Business trunking; Architecture and functional
description\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**IP-PBX in Static Mode of Operation** : an IP-PBX (Next Generation Corporate
Network) where the IP-PBX does not initiate any IMS level registration
procedure for its users or itself towards the operator IMS, but rather the IP-
PBX maintains a static connection to the IMS.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.
**IP-PBX** : Internet Protocol Private Branch eXchange
# 4 Use cases
## 4.1 Small enterprise with single point of access
The PBX is connected via a single point of access, via a xDSL access with a
static IP address. Typically around 100 ports are operated at the PBX, but
only a very small number of users are connected simultaneously.
This scenario has the following characteristics:
A significant number of PBXs of this class are connected in total to the
network.
This class of PBXs has the following characteristics:
\- The dimension of the occurrence in the network will approximate that of a
normal UE.
\- The customer has a service profile in the HSS.
\- The generated traffic per customer is low.
\- The operator has to fulfil regulatory requirements for the customer.
\- Typically several services, beyond those usually considered for a Business
Trunking application, are executed by the network for this PBX type.
## 4.2 Medium enterprise with single point of access
The PBX is connected via a single point of access, via a fibre access with a
static IP address. Around 100 to 1000 ports are operated at the PBX. A very
large number of PBXs of this class are connected in total to the network.
This class of PBXs has the following characteristics:
\- The customer has a service profile in the HSS.
\- The generated traffic per customer is relevant.
\- The operator has to fulfil regulatory requirements for the customer.
\- Typically several services, beyond those usually considered for a Business
Trunking application, are executed by the network for this PBX type.
## 4.3 Large enterprise with multiple points of contact with the network
The PBX is connected via multiple access points, via Ethernet accesses with
static IP addresses. More than 1000 ports are operated at the PBX. Only a
small number of PBXs of this class are connected in total to the network.
This class of PBXs has the following characteristics:
\- The customer does not have a service profile in the HSS.
\- only a few services are executed in the network for this customer (e.g.
call diversion in case of error conditions).
\- The generated traffic per customer is huge.
\- In most cases the operator has to fulfil regulatory requirements for the
customer.
# 5 Architecture Requirements
The solution shall:
\- allow the IMS to handle sessions directed to the IP-PBX users and
originated from the IP-PBX users.
\- allow the IMS to execute functions subject to regulatory requirements
(emergency calling, legal interception).
\- be scalable.
\- be resilient against a single failure in the operator\'s network: the IP-
PBX users shall still be able to originate and receive new sessions during
such outage.
\- allow the IMS to authenticate the IP-PBXs and provide security according to
the network domain security TS 33.310 [4].
\- allow for the invocation of application servers in the operator\'s IMS
network to IP-PBX users.
Editor\'s note: Clarification of services to be supported by the operator\'s
IMS network is FFS.
# 6 Solution Alternatives
## 6.1 IBCF and Transit reuse
### 6.1.1 High level architecture
The architecture for the support of IP-PBX in static mode of operation based
on the reuse of the IBCF and transit function is shown in Figure 6.1-1.
Figure 6.1-1: High level architecture with using an IBCF and transit function
The architecture for the support of IP-PBX in static mode of operation based
on the reuse of the IBCF and transit function is shown in Figure 6.1-1,
according to TS 23.228 [5].
The solution has the following characteristics:
\- It allows the IMS to handle sessions directed to the IP-PBX users and
originated from the IP-PBX users based on the procedures of TS 23.228 [5],
clause 4.15.
\- It allows the IBCF and E-CSCF to execute functions subject to regulatory
requirements (emergency calling, legal interception) according to TS 23.167
[6].
\- Is scalable, as it uses registration independent load balancing of Transit
Functions according to TS 23.228 [5] clause 4.23.3, that allows that traffic
from the IP-PBX is distributed among different Transit Functions. As the IBCF
does not require downloaded user state, load sharing can also be done among
IBCFs.
\- It allows the IMS to authenticate the IP-PBXs and provide security
according to the network domain security TS 33.310 [4].
\- Routing of terminating sessions is done by a PBX routing functionality
hosted by an AS.
\- Identity assertion is done by a PBX identity assertion functionality hosted
by an AS.
\- It allows for the invocation of application servers in the operator\'s IMS
network to IP-PBX users according to TS 23.228 [5], clause 4.15.3, with the
restriction that for terminating sessions, no AS can be invoked after the PBX
routing functionality has been performed. The invocation of the AS is done on
an IP-PBX basis.
\- It allows multiple IBCF\'s to be used to reach the PBX if required.
\- The TRFs of the network need to be provisioned with Transit invocation
criteria containing all the individual and wildcarded Public User Identities
that belong to a PBX using this solution. This configuration needs to be
updated every time a PBX is added to the network and every time a Public User
Identity is added behind a PBX.
### 6.1.2 High level Flows
#### 6.1.2.1 General
Detailed flows can be found in TS 23.228 [5], clause 5.19.
#### 6.1.2.2 Terminating procedures
This clause depicts a terminating use case.
This scenario assumes that security and authentication between the PBX and IMS
is done using the TLS procedures according to TS 33.310 [4], using
certificates. The certificates need to be provided by a trusted root. The IBCF
is provisioned with its own certificate, and will receive the PBX certificate
during the TLS handshake.
In configurations where there is a NAT between the IP-PBX and the IBCF, the
TLS connection needs to be initiated and maintained by the IP-PBX.
If the network between the PBX and IBCF complies with the peering based
interconnect procedures according to ETSI TS 182 025 [8], the IBCF may deploy
the Gq\' interface. The Gq\' interface and its interactions are not depicted
in flows.
Figure 6.1-2: Terminating procedures
The following steps are performed:
1\. An INVITE is sent from the remote side via an incoming IBCF towards the
Transit function with a Request-URI targeting a user allocated to a particular
PBX.
NOTE 1: The INVITE from the IBCF may be sent via an I-CSCF before it ends up
in the Transit function. In such case, the I-CSCF will detect that this is not
a subscribed user, and therefore decide to route to the Transit function.
2\. The Transit function is configured with a set of Transit invocation
criteria that are triggered to determine the Application Servers to be
triggered, including the AS hosting the PBX routing functionality, which is
the last AS to be triggered. As this is a termination case, the Request-URI is
used to determine that the served user is a PBX using this solution.
NOTE 2: In general, the main information that can be used by the Transit
invocation criteria is the destination URI of the INVITE. Therefore, the
Transit invocation criteria need to contain the individual and wildcarded
Public User Identities that belong to all PBXs using this solution. For such
case, the way to avoid large configurations in the Transit function for each
enterprise is to assign a limited number of wildcarded Public User Identities
for all PBXs using this solution.
3\. The Transit function forwards the request to the required Application
Servers. Each of these Application Servers may identify the PBX the user
belongs to and perform any enterprise specific actions for the user if
required.
4\. The PBX routing functionality (hosted by the last AS in the chain)
identifies the particular PBX the enterprise user belongs to, and optionally
also the IBCF(s) serving the PBX, and forwards the INVITE toward the PBX by
creating a route to the PBX, adding the TRF, IBCF, and PBX in the route
headers.
NOTE 3: Inserting a route to the PBX in the Route headers will not allow to
trigger any AS after the PBX routing functionality. Similar to the T-ADS
functionality, the PBX routing functionality must be last in the chain of
Transit invocation criteria.
5\. The INVITE is forwarded using the normal Route header to the IBCF.
6\. The IBCF will forward the INVITE to the PBX using the Route information
provided by the AS. If no security association exist between the IBCF and PBX
(and TLS is used), TLS will be initiated as a result of trying to send the
INVITE. Once the TLS session is setup (using the certificates), the INVITE
will be sent over the secure connection.
7\. The session setup is completed.
#### 6.1.2.3 Originating procedures
This clause depicts a originating use case.
This scenario assumes that security and authentication between the PBX and IMS
is done using the TLS procedures according to TS 33.310 [4], using
certificates. The certificates need to be provided by a trusted root. The IBCF
is provisioned with its own certificate, and will receive the PBX certificate
during the TLS handshake.
If the network between the PBX and IBCF complies with the peering based
interconnect procedures according to ETSI TS 182 025 [8], the IBCF may deploy
the Gq\' interface. The Gq\' interface and its interactions are not depicted
in flows.
Figure 6.1-3: Originating procedures
The following steps are performed:
1\. A user within the PBX tries to establish a call. The PBX sends an INVITE
towards IMS via the IBCF (contact point for the PBX). If no security
association exist between the IBCF and PBX , TLS will be initiated as a result
of trying to send the INVITE. Once the TLS session is setup (using the
certificates), the INVITE will be sent over the secure connection. The INVITE
is assumed to include a calling party identity (such as in the P-Asserted-
Identity).
2\. The IBCF may apply general screening rules to the request, and also adds a
P-Served-User-Identity to the INVITE with the identity of the PBX (SIP URI
identifying the domain of the PBX retrieved from the certificate). By doing
so, the IBCF will not need to be provisioned with PBX specific rules.
Additionally, the IBCF adds the orig parameter to the INVITE to indicate that
this is an origination request. The IBCF sends the INVITE to the Transit
function (possibly via the I-CSCF).
NOTE: If 6.1 is used together with either 6.3 or 6.6, routing should always be
done via the I-CSCF to secure that any PBXs (and other users) handled by
subscriptions are identified and treated prior invocation of transit function.
3\. The Transit function is configured with a set of Transit invocation
criteria that are triggered to find a correct AS to route to. As this is an
origination case (as indicated by the Orig parameter), the P-Served-User-
Identity is used to identify the served user (PBX).
NOTE 1: To avoid large configurations in the Transit function for each
enterprise, it is possible to have generic filter criteria that triggers the
related ASs. The filter criteria information can be based on the same type of
information as configured in the transit routing tables.
4\. The Transit function forwards the request to the AS hosting the PBX
identity assertion. Based on the P-Served-User-Identity, this AS identifies
the PBX, verifies that this PBX is a valid subscriber and inserts a
P-Asserted-Identity. Other Application Servers may be triggered based on iFC
and may, based on the P-Asserted-Identity, apply any enterprise specific
actions for the user if required.
NOTE 2: The assertion of the identity can be used based on two different
components, the P-Served-User-Identity provided by the IBCF (that identifies
the trusted PBX used based on the certificate), and possibly additionally, the
IP address of the PBX provided in e.g., the Via header.
5\. The INVITE is forwarded for further onward routing towards the remote
side.
6\. Transit function performs onward routing towards the remote side.
7\. The session setup is completed.
### 6.1.3 Required provisioning in the network
#### 6.1.3.1 Initial configuration at solution roll-out
Root certificates from trusted Certification Authorities need to be
provisioned in every IBCF of the network.
A Transit invocation criterion is provisioned in every TRF of the network, to
trigger the AS hosting the PBX identity assertion functionality upon requests
originated from one IP-PBX. This criterion may for example be based on the
presence of a P-Served-User-Identity and orig parameter (inserted by the
IBCF).
#### 6.1.3.2 Provisioning when adding a new IP-PBX
One or more AS is provisioned with the IP-PBX profile, containing the SIP URI
of the IP-PBX and the individual and wildcarded Public User Identities that
belong to the IP-PBX.
The transit invocation criteria that are stored in every TRF of the network
need to be updated, so that the AS hosting the PBX routing functionality will
be triggered when the Request-URI matches one of the individual or wildcarded
Public User Identities that belong to the IP-PBX being added.
#### 6.1.3.3 Provisioning when adding/modifying extensions behind an IP-PBX
The Public User Identities that are added or removed to the PBX profile need
to be updated in the Application Server(s) hosting the PBX identity assertion
functionality or the PBX routing functionality (or in the HSS if used by these
Application Servers for subscription storage), and also in the transit
invocation criteria that are stored in every TRF of the network.
## 6.2 enhanced IBCF
### 6.2.1 High level architecture
The architecture for the support of IP-PBX in static mode of operation based
on enhancements to the IBCF is shown in Figure 6.2-1
Figure 6.2-1: High level architecture with using an enhanced IBCF
Editor\'s note: It is for further study what services besides routing are
provided by the IMS to the IP-PBX users.
Editor\'s note: The need and requirements for Xya and Cx\' interface is for
further study.
#### 6.2.1.1 eIBCF
The eIBCF terminates the Xya reference point from the HSS as well as the Xyb
reference point towards the NGCN SIP connect 1.1 IP-PBX operating in Static
Mode.
The eIBCF also supports the establishment of security association and can
handle request URI in the format specified in TS 24.229 [7] for GINI.
#### 6.2.1.2 Cx\' reference point
The Cx reference point between the HSS and the S-CSCF is also enhanced in
order to support reception of information pushed by the HSS.
### 6.2.2 Session setup
Figure 6.2-2 shows the IP-PBX session set up procedures.
Figure 6.2-2: Session set up for eIBCF alternative
1-2. The HSS pushes the diameter IP-PBX data to the eIBCF. This data include
the IP address of the IP-PBX, the IP-PBX name, the number blocks assigned to
the PBX as well as the IP-PBX certificates used to established a security
association with TLS.
Editor\'s note: It is for further study what trigger is used for the HSS to
initiate this procedure.
3-4. The HSS also pushes the IP-PBX data to the S-CSCF. This completes the
registration simulation procedures on the S-CSCF side.
Editor\'s note: The complete set of data that needs to be sent by the HSS is
for further study. Also how the information is used is for further study.
5-6. The eIBCF subscribes to user profile updates.
7-8. The S-CSCF subscribes to the user profile updates.
9\. A security association using TLS is set up between the IMS and the IP-PBX.
10\. The IP-PBX in static mode of operation performs a DNS query which returns
the address of the eIBCF or the IP-PBX is provisioned with the eIBCF IP-
address.
11\. The S-CSCF sets up the service profile for the IP-PBX.
Editor\'s note: It needs to be determined if HSS interaction is required.
12a. The IP-PBX user sets up a call.
12b. The IMS receives a call for the IP-PBX.
13\. The eIBCF progresses the session according to TS 24.229 [7].
### 6.2.3 PBX is deleted in the HSS
As no registration of the IP-PBX users takes place in this alternative, the
HSS must inform the S-CSCF and the eIBCF when the PBX is deleted.
Deregistration equivalent procedure, consisting in the S-CSCF and eIBCF
deleting the IP-PBX service profile must be performed.
## 6.3 IBCF and S-CSCF reuse
### 6.3.1 High level architecture
The architecture for the support of IP-PBX in static mode of operation based
on the reuse of the IBCF and S-CSCF function is shown in Figure 6.3-1. This
model is based on the existing ETSI TS 182 025 [8] clause 5.3 for connecting a
PBX in peering mode (which is as applicable for static mode).
Figure 6.3-1: High level architecture with using an IBCF and S-CSCF
The architecture for the support of IP-PBX in static mode of operation based
on the reuse of the IBCF and S-CSCF function is shown in Figure 6.3-1,
according to TS 23.228 [5] and ETSI TS 182 025 [8].
The AS is necessary for terminating procedures and, is invoked based on
Initial Filter Criteria contained in the unregister part of the user profile
associated to the IP- PBX, retrieved from the HSS (not represented on the
Figure).
NOTE: The users of an IP-PBX may be split into multiple groups, each of which
having its own PBX user profile and list of associated identities.
The solution has the following characteristics:
\- It allows the IMS to handle sessions directed to the IP-PBX users and
originated from the IP-PBX users based on the procedures of TS 23.228 [5] and
ETSI TS 182 025 [8].
\- It allows the IBCF and E-CSCF to execute functions subject to regulatory
requirements (emergency calling, legal interception) according to TS 23.167
[6].
\- It allows the IMS to authenticate the IP-PBXs and provide security
according to the network domain security TS 33.310 [4].
\- Routing of terminating sessions is done by a PBX routing functionality
hosted by an AS.
\- Identity assertion is done by a PBX identity assertion functionality hosted
by an AS.
\- It allows for the invocation of application servers in the operator\'s IMS
network to IP-PBX users according to TS 23.228 [5], with the restriction that
for terminating sessions, no AS can be invoked after the PBX routing
functionality has been performed.
\- It allows multiple IBCF\'s to be used to reach the PBX if required.
### 6.3.2 High level Flows
#### 6.3.2.1 Terminating procedures
This clause depicts a terminating use case. A pre-requisite is that the
enterprise is provisioned as a user (possible wildcard user) in the HSS and
have correct iFCs provisioned. . Any AS configured in the iFC chain after the
AS hosting the PBX routing functionality will be ignored.
In configurations where there is a NAT between the IP-PBX and the IBCF, the
TLS connection needs to be initiated and maintained by the IP-PBX.
This scenario assumes that security and authentication between the PBX and IMS
is done using the TLS procedures according to TS 33.310 [4], using
certificates. The certificates need to be provided by a trusted root. The IBCF
is provisioned with its own certificate, and will receive the PBX certificate
during the TLS handshake.
If the network between the PBX and IBCF complies with the peering based
interconnect procedures according to ETSI TS 182 025 [8], the IBCF may deploy
the Gq\' interface. The Gq\' interface and its interactions are not depicted
in flows.
Figure 6.3-2: Terminating procedures
The following steps are performed:
1\. An INVITE is sent from the remote side via an incoming IBCF towards the
I-CSCF with a Request-URI targeting a user allocated to a particular PBX.
2\. The I-CSCF performs the normal user location request towards HSS to find
the served user and an S-CSCF.
3\. The I-CSCF forwards the request to the S-CSCF.
4\. If the PBX subscriber is not allocated to the S-CSCF, the S-CSCF contacts
HSS to download the subscriber information for the un-registered user.
5\. The S-CSCF performs normal (un-registered) terminating service invocation
for the incoming request.
6\. The S-CSCF forwards the request to the Application Servers to be triggered
per iFC. Each of these Application Servers may identify the PBX the user
belongs to and perform any enterprise specific actions for the user if
required.
7\. Each of the triggered Application Servers may optionally query HSS for any
subscriber information if required using the Sh interface.
8\. The PBX routing functionality (hosted by the last AS in the iFC chain)
identifies the particular PBX the enterprise user belongs to, and also the
IBCF(s) serving the PBX, and forwards the INVITE toward the PBX (by creating a
route to the PBX, adding the S-CSCF, IBCF, and PBX in the Route headers).
NOTE: Inserting a route to the PBX in the Route headers will not allow to
trigger any AS after the PBX routing functionality. Similar to the T-ADS
functionality, the PBX routing functionality must be last in the chain of
iFCs.
9\. The INVITE is forwarded using the Route header to the IBCF.
10\. The IBCF will forward the INVITE to the PBX using the Route information
provided by the PBX routing functionality. If no security association exist
between the IBCF and PBX (and TLS is used), TLS will be initiated as a result
of trying to send the INVITE. Once the TLS session is setup (using the
certificates), the INVITE will be sent over the secure connection.
11\. The session setup is completed.
#### 6.3.2.2 Originating procedures
This clause depicts a originating use case. A pre-requisite is that the
enterprise is provisioned as a user (possible wildcard user) in the HSS and
have correct iFCs provisioned.
This scenario assumes that security and authentication between the PBX and IMS
is done using the TLS procedures according to TS 33.310 [4], using
certificates. The certificates need to be provided by a trusted root. The IBCF
is provisioned with its own certificate, and will receive the PBX certificate
during the TLS handshake.
If the network between the PBX and IBCF complies with the peering based
interconnect procedures according to ETSI TS 182 025 [8], the IBCF may deploy
the Gq\' interface. The Gq\' interface and its interactions are not depicted
in flows.
Figure 6.3-3: Originating procedures
The following steps are performed:
1\. A user within the PBX tries to establish a call. The PBX sends an INVITE
towards IMS via the IBCF (contact point for the PBX). If no security
association exist between the IBCF and PBX, TLS will be initiated as a result
of trying to send the INVITE. Once the TLS session is setup (using the
certificates), the INVITE will be sent over the secure connection. The INVITE
is assumed to include a calling party identity (such as in the P-Asserted-
Identity).
2\. The IBCF may apply general screening rules to the request, and also adds a
P-Served-User-Identity to the INVITE with the identity of the PBX (SIP URI
identifying the domain of the PBX retrieved from the certificate). By doing
so, the IBCF will not need to be provisioned with PBX specific rules.
Additionally, the IBCF adds the orig parameter to the INVITE to indicate that
this is an origination request. The IBCF forwards the INVITE to the I-CSCF.
3\. The I-CSCF performs the normal (originating request) user location request
towards HSS to find the served user and an S-CSCF. If there is no subscription
in the HSS, the I-CSCF forwards the request to a Transit Function (and routing
may continue as described in clause 6.1.2.3 if this solution is deployed);
otherwise, the following steps are performed.
4\. The I-CSCF forwards the request to the S-CSCF.
5\. If the PBX subscriber is not allocated to the S-CSCF, the S-CSCF contacts
HSS to download the subscriber information for the un-registered user.
6\. The S-CSCF performs normal (un-registered) originating service invocation
for the incoming request.
7\. The S-CSCF forwards the request to the AS hosting the PBX identity
assertion. Based on the P-Served-User-Identity, this AS identifies the PBX and
inserts a P-Asserted-Identity. Other Application Servers may be triggered
based on iFC and may, based on the P-Asserted-Identity, perform any enterprise
specific actions for the user if required.
8\. Each of the triggered Application Servers AS may optionally query HSS for
any subscriber information if required using the Sh interface.
9\. The INVITE is forwarded to S-CSCF for further onward routing towards the
remote side.
10\. The S-CSCF performs onward routing towards the remote side.
11\. The session setup is completed.
### 6.3.3 Required provisioning in the network
#### 6.3.3.1 Initial configuration at solution roll-out
Root certificates from trusted Certification Authorities need to be
provisioned in every IBCF of the network.
#### 6.3.3.2 Provisioning when adding a new IP-PBX
The IP-PBX is provisioned as a user in the HSS, as for subscription based
business trunking. This includes the Public User Identities that belong to the
IP-PBX being added and iFCs to trigger the Application Server(s) hosting the
PBX identity assertion functionality or the PBX routing functionality.
One or more AS (or the subscription profile in HSS if this AS uses the HSS for
subscription storage) is provisioned with the IP-PBX profile, containing the
SIP URI of the IP-PBX, the IBCF(s) serving the PBX, and the individual and
wildcarded Public User Identities that belong to the IP-PBX.
#### 6.3.3.3 Provisioning when adding/modifying extensions behind an IP-PBX
The Public User Identities that are added or removed to the PBX profile need
to be updated in the IP-PBX profile stored in the HSS, as with subscription-
based business trunking. They also need to be updated in the Application
Server(s) hosting the PBX identity assertion functionality or the PBX routing
functionality (or in the HSS if used by these Application Servers for
subscription storage).
## 6.4 P-CSCF based
### 6.4.1 High level architecture
This architecture alternative relates to the subscription based business
trunking way to connect NGCNs / IP-PBXs to a IMS public network as described
in ETSI TS 182 025 [8] where the P-CSCF is the entry point at the IMS service
layer.
Subscription based business trunking keeps the enterprise details in the HSS.
Management is therefore dealt with in the same manner as any other end user.
This carries one set of conveniences/advantages for the operator.
Peering based business trunking keeps the enterprise details as configuration
details in the interfacing IMS entity. Management is therefore dealt with in
the same manner as the peering arrangements with any other public network
operator. This carries a different set of conveniences/advantages for the
operator.
The architecture for the support of IP-PBX in static mode of operation is
based on enhancements to the P-CSCF and is shown in Figure 6.4-1.
Figure 6.4-1: High level architecture with using a P-CSCF
The P-CSCF performs all the normal functions of a P-CSCF and in addition the
P-CSCF will register on behalf of the IP-PBX with an IMS public identity of
the IP-PBX when the connection with the IP-PBX is set.
The S-CSCF performs all the normal functions of an S-CSCF. In particular, when
registering the IP-PBX main public identity, it will receive the service
profiles of the IMS public identities (e.g. PBX extensions or ranges of PBX
extensions) that may be defined in the implicit registration set associated to
the main public identity of the IP-PBX.
The other IMS procedures such as session set up are not impacted.
The P-CSCF must support a registration restart algorithm allowing the P-CSCF
to repeatedly retry registering the IP-PBX in case an initial register or a
register refresh fails and until registration succeeds or until specified
error codes are received. An alarm must be raised when the P-CSCF is unable to
register the IP-PBX.
### 6.4.2 P-CSCF preconfigured with IP-PBX data
The P-CSCF is preconfigured with IP-PBX data (the IP address of the IP-PBX,
the IP-PBX main IMS public identity and private identity and a SIP transport
option as well as optionally the IP-PBX certificates used to establish a
security association with TLS).
Possible SIP transport options are:
\- Re-using a pseudo-permanent TCP or TLS connection: In this case, the IP-PBX
and P-CSCF must use either the procedures in RFC 5923 or the procedures in
RFC5626. Prior to being able to place and receive calls, the IP-PBX initiates
the TLS or TCP session with the P-CSCF, this triggers the registration on
behalf of the PBX. The P-CSCF asks and validate the IP-PBX for a client
certificate if an IP-PBX certificates is configured for the IP-PBX source IP
address.
\- Use UDP or TCP connections: In this case the IP-PBX and P-CSCF must follow
procedures in RFC3261. In order to send SIP requests toward the IP-PBX, the
P-CSCF must be configured with an address of contact specifying the UDP port
and TCP port that can be used to contact the IP-PBX as well as a preferred
transport protocol. The P-CSCF must register the IP-PBX when the P-CSCF is
started.
The main drawback of this solution is that it requires a provisioning of IP-
PBX data in the P-CSCF by OAM. Currently P-CSCF, to ensure its IMS functions
for IMS subscribers, does not require any subscriber data to be provisioned by
OAM, so it would be the first exception to this principle. This solution is
presented for the sake of the study but is not retained as a candidate.
### 6.4.3 P-CSCF without provisioning of IP-PBX data
#### 6.4.3.1 High-level principles
In this solution, there is no provisioning of IP-PBX data in the P-CSCF. It is
applicable with a TLS connection to ensure authentication of the IP-PBX and of
its identity. The technical characteristics of this solution are hereafter
presented:
\- the P-CSCF is not provisioned with the PBX identity and PBX contact
address.
\- the PBX will always initiate the TLS connection (since P-CSCF is not
provisioned with the PBX address, it relies on the PBX to initiate the TLS
connection establishment.)
\- Mutual authentications (both server and client authentication) are enabled
at the P-CSCF and based on TLS. The assumption is that the P-CSCF performing
the TLS client authentication is equivalent of an IMS authentication (since
P-CSCF is a trusted entity by the IMS).
\- the P-CSCF will dynamically acquire IMS identities and the Contact address
though the TLS handshake (P-CSCF having successfully authenticated the PBX),
as follows:
\- An IMS Private Identity and an IMS Public identity are derived from the
identity information in the TLS client certificate, e.g., the \"Subject\"
field or the \"Subject Alternative name\" field. These IMS identities match
those provisioned in the subscriber IMS profile of the IP-PBX in the HSS. This
does not preclude configuring other identities in the HSS in addition to these
ones.
\- P-CSCF acquires the PBX address as Contact address from the transport layer
address.
\- P-CSCF performs registration with the S-CSCF on behalf of the PBX using the
\"derived\" IMS identities and PBX address from the TLS handshake.
\- The registration needs not to be authenticated by the S-CSCF as already
done through TLS, This can rely on the authentication procedure specified in
clause 5.4.1.2.2E of TS 24.229 [7].
Regarding resiliency, two solutions are possible:
\- if a P-CSCF fails, the IP-PBX may set up another TLS connection with
another P-CSCF;
\- the IP-PBX may set up connections with several P-CSCFs and the IMS multiple
registrations feature is used: each of these P-CSCFs will register on behalf
of the IP-PBX; in this case, all the P-CSCFs will generate an instance-ID from
the \"Subject\" field or the \"Subject Alternative name\" field of the TLS
client certificate, using the same algorithm, and will insert a reg-id that is
specific to the P-CSCF (but not specific to the IP-PBX). This ensures that the
same instance-ID will always be used for a given IP-PBX, that two different
IP-PBX will never be registered with the same instance-ID, and that
registration of an IP-PBX by different P-CSCFs is done with different reg-ids.
Multiple registration may also be used to share the load of one IP-PBX by
several P-CSCFs.
The use of multiple registration in combination with trusted authentication
involved a minor impact on the S-CSCF, because this is currently prohibited by
TS 24.229 [7].
The main characteristics of this solution are:
\- IP-PBX does not need to do a registration but needs to initiate and
maintain a TLS connection to the P-CSCF.
NOTE: This also allows to ensure that any NAT between the IP-PBX and the
P-CSCF can be traversed.
\- There is no provisioning of IP-PBX data in the P-CSCF
\- Authentication relies on TLS
\- Authorization relies on standard IMS registration procedure between S-SCSF
and HSS
\- Service profiles may be dedicated to an IP-PBX extension or to a range of
extensions.
\- Possibility of using another P-CSCF when a P-CSCF fails.
\- The load of one IP-PBX can be shared by several P-CSCFs.
#### 6.4.3.2 IMS Registration flow
Figure 6.4-2
1\. IP-PBX initiates a TCP connection with the P-CSCF (this will typically be
performed when the PBX is started).
2\. IP-PBX initiates TLS handshake
3\. P-CSCF requests client certificate for mutual authentication
4\. IP-PBX provides its assigned certificate
5\. IP-PBX proves it owns the private key associated to the certificate (and
then authenticates)
6\. P-CSCF registers on behalf of the PBX in the same way as the MSC Server
enhanced for ICS does when performing an IMS registration on behalf of a UE
(with \"auth-done\", cf. TS 24.292 Â§ 6.3.2), and thanks to identities derived
from the certificate subjectAltName. The contact is populated with the source
IP address and port of the TLS connection. If connection to several P-CSCFs is
supported, the P-CSCF inserts an instance-ID generated from the certificate
subjectAltName, and a reg-id specific to the P-CSCF.
7\. The S-CSCF performs the registration procedure according to current IMS
standards. According to TS 24.229 [7] clause 5.4.1.2.2E, \"auth-done\" will
indicate that authentication has already been performed and cause the S-CSCF
to bypass authentication.
8\. P-CSCF acquires IP-PBX associated identities through P-Associated-URI from
the 200 OK response, and reg-event subscription (not shown) that will be used
for identity assertion on originating requests, as usual.
#### 6.4.3.3 Required provisioning in the network
##### 6.4.3.3.1 Initial configuration at solution roll-out
The operator needs to define derivation rules that will be used to derive the
IMS Private Identity and IMS Public identity from the identity information in
the TLS client certificate.
Every P-CSCF of the network that may be used by an IP-PBX needs to be
configured with:
\- root certificates from trusted Certification Authorities;
\- the derivation rules defined by the operator;
\- a home network domain name to be inserted in registration requests
generated on behalf of PBXs.
##### 6.4.3.3.2 Provisioning when adding a new IP-PBX
The IP-PBX is provisioned as a user in the HSS, as for subscription based
business trunking, with the specificity that the IMS Private Identity and the
Main URI of the IP-PBX assigned by the operator to this user profile need to
be the results of the derivation rules defined at solution roll-out, taking
the identity information in the TLS client certificate as input.
##### 6.4.3.3.3 Provisioning when adding/modifying extensions behind an IP-PBX
The Public User Identities that are added or removed to the PBX profile need
to be updated in the IP-PBX profile stored in the HSS, as with subscription-
based business trunking.
## 6.5 Standalone BusTI-GW solution
### 6.5.1 High level architecture
The architecture for the support of IP-PBX in static mode of operation based
on BusTI-GW is shown in Figure 6.5-1.
Figure 6.5-1: high level architecture with using an BusTI-GW
All the IP-PBXs belong to one enterprise connect to the same BusTI-GW. The
BusTI-GW makes IMS registration on behalf of IP-PBX user. The BusTI-GW can
handle the MO according to TS 23.228 [5]. For the MT, the BusTI-GW can select
an IP-PBX to deliver the call.
The BusTI-GW is the signalling anchor point. The media still can be delivered
end to end. When the BusTI-GW fails, the backup BusTI-GW can take over the IP-
PBXs users of enterprise by making IMS registration on behalf of IP-PBX user
of enterprise.
#### 6.5.1.1 BusTI-GW
The BusTI-GW performs IMS registration on behalf IP-PBX user. And it acts as a
SIP B2BUA in the MO and MT. The BusTI-GW is pre-configured or provisioned with
IP-PBX user information.
### 6.5.2 Registration and session setup
Figure 6.5-2 shows the IP-PBX registration and session set up procedures.
Figure 6.5-2: Registration and session establishment using BusTI-GW
1\. The BusTI-GW is pre-configured or provisioned with IP-PBX user
information.
2\. BusTI-GW performs IMS registration on behalf of IP-PBX users in accordance
to the procedures described in TS 23.228 [5].
3a. The IP-PBX user sets up a call.
3b. The P-CSCF receives a session to IP-PBX user.
4\. The session set up progresses then according to TS 23.228 [5].
Editor\'s note: Whether multiple simultaneous interconnection/peering points
can be supported is FFS.
### 6.5.3 Deregistration
De-registration procedures is the same with TS 23.228 [5].
### 6.5.4 Required provisioning in the network
#### 6.5.4.1 Initial configuration at solution roll-out
None.
#### 6.5.4.2 Provisioning when adding a new IP-PBX
The IP-PBX is provisioned as a user in the HSS, as for subscription based
business trunking.
The BusTI-GW is provisioned with IP-PBX user information.
#### 6.5.4.3 Provisioning when adding/modifying extensions behind an IP-PBX
The Public User Identities that are added or removed to the PBX profile need
to be updated in the IP-PBX profile stored in the HSS, as with subscription-
based business trunking.
## 6.6 S-CSCF Based Routing
### 6.6.1 General
The user profile in the HSS contains a provisioned default contact address
enabling routing to the PBX, via the IBCF.
NOTE: The users of an IP-PBX may be split into multiple groups, each of which
having its own PBX user profile and list of associated identities.
The solution has the following characteristics:
\- It allows the IMS to handle sessions directed to the IP-PBX users and
originated from the IP-PBX users based on the procedures of TS 23.228 [5] and
ETSI TS 182 025 [8].
\- It allows the IBCF and E-CSCF to execute functions subject to regulatory
requirements (emergency calling, legal interception) as per TS 23.167 [6].
\- It allows the IMS to authenticate the IP-PBXs and provide security
according to the network domain security TS 33.310 [4].
\- It allows for the invocation of application servers in the operator\'s IMS
network to IP-PBX users according to TS 23.228 [5].
\- It allows multiple IBCF\'s to be used to reach the PBX if required.
\- The use of an AS is not necessary. The AS, if any, is invoked based on
Initial Filter Criteria contained in the unregister part of the user profile
associated to the IP- PBX, retrieved from the HSS (not represented on the
Figure). This solution does not break the AS triggering model.
\- There is no interface between the IBCF and the HSS.
Detailed flows are shown as follows.
### 6.6.2 Terminating Session Setup
This clause depicts a terminating use case. A pre-requisite is that the
enterprise is provisioned as a user (possibly wildcard user) in the HSS and
have correct iFCs provisioned. There is no constraint on the order of the
Application Servers in the iFC chain.
In configurations where there is a NAT between the IP-PBX and the IBCF, the
TLS connection needs to be initiated and maintained by the IP-PBX.
Figure 6.6.2-1 shows the terminating procedure.
Figure 6.6.2-1: Terminating session set up
1\. I-CSCF receives a call from the network.
2\. The I-CSCF performs Location Query procedure with the HSS to acquire the
Sâ€‘CSCF address or the Sâ€‘CSCF capabilities, including the destination address.
3\. The HSS returns the Sâ€‘CSCF address/capabilities to the Iâ€‘CSCF according to
the destination address.
4\. Iâ€‘CSCF forwards the INVITE request towards the selected Sâ€‘CSCF from the
query.
5-6. The Sâ€‘CSCF sends Cx-Put/Cx-Pull to the HSS. The HSS then returns the
information flow Cx-Put Resp/Cx-Pull Resp (user information, including the
binding data of user identity and IBCF address as part of the user profile XML
file) to the Sâ€‘CSCF. The Sâ€‘CSCF shall store it. This completes the
registration simulation procedures on the S-CSCF side. The S-CSCF knows from
the information provided in the user profile that the user is an IP-PBX and
remains allocated to this IP-PBX user for a configurable time, in order to
save traffic on Cx.
7\. If the user profile includes an iFC pointing to an Enterprise AS, the SIP
INVITE request is forwarded to the Enterprise AS.
8\. The INVITE is processed by the Application Server. The AS optionally
retrieves user information from HSS and returns the INVITE to the Sâ€‘CSCF.
9\. If the INVITE message request does not contain a route header, the S-CSCF
creates a route header from information found in the user profile received
from the HSS (i.e. provisioned default contact address). The INVITE is
forwarded using the Route header to the IBCF.
10\. The IBCF forwards the INVITE request to IP-PBX using the Route
information provided by the S-CSCF. If no security association exist between
the IBCF and PBX (and TLS is used), TLS will be initiated as a result of
trying to send the INVITE. Once the TLS session is setup (using the
certificates), the INVITE will be sent over the secure connection.
11\. The session establishment is completed.
### 6.6.3 Originating Session Setup
Same as Alternative 6.3 with the following addition: the S-CSCF receives
binding data of user identity and IBCF address as part of the user profile XML
file; this is not used for routing the originating session, but allows the
S-CSCF to know that the user is an IP-PBX and to remain allocated to this IP-
PBX user for a configurable time, in order to save traffic on Cx.
### 6.6.4 Required provisioning in the network
#### 6.6.4.1 Initial configuration at solution roll-out
Root certificates from trusted Certification Authorities need to be
provisioned in every IBCF of the network.
#### 6.6.4.2 Provisioning when adding a new IP-PBX
One or more AS is provisioned with the IP-PBX profile, containing the SIP URI
of the IP-PBX and the individual and wildcarded Public User Identities that
belong to the IP-PBX.
The IP-PBX is provisioned as a user in the HSS, as for subscription based
business trunking. This includes the Public User Identities that belong to the
IP-PBX being added and iFCs to trigger an AS hosting the PBX identity
assertion functionality. In addition, the user profile in the HSS contains a
provisioned default contact address enabling routing to the PBX, via the IBCF.
#### 6.6.4.3 Provisioning when adding/modifying extensions behind an IP-PBX
The Public User Identities that are added or removed to the PBX profile need
to be updated in the IP-PBX profile stored in the HSS, as with subscription-
based business trunking. They also need to be updated in the AS hosting the
PBX identity assertion functionality.
# 7 Alternatives Assessment and Conclusions
## 7.1 Alternatives evaluation criteria and scoring
The following table provides a summary of the solutions currently described in
the TR and their characteristics when measured against compliance to the
requirements as well as impact on the system.
Table 7.1-1
+---------+---------+---------+---------+---------+---------+---------+ | | IBCF | E | IBCF | P-CSCF | Sta | S-CSCF | | | and | nhanced | and | based | ndalone | based | | | Transit | IBCF | S-CSCF | | BusTI | routing | | | Re-Use | | reuse | | GW | | +---------+---------+---------+---------+---------+---------+---------+ | TR | 6.1 | 6.2 | 6.3 | 6.4 | 6.5 | 6.6 | | clause | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Desc | Allows | IBCF | Allows | P-CSCF | A | Allows | | ription | the IMS | so | the IMS | makes | Sta | the IMS | | | to | lution, | to | IMS | ndalone | to | | | handle | where | handle | regis | entity | handle | | | s | PBX | s | tration | B | s | | | essions | info | essions | on | usTI-GW | essions | | | d | rmation | d | behalf | makes | d | | | irected | is | irected | IP-PBX | IMS | irected | | | to the | prov | to the | user. | regis | to the | | | IP-PBX | isioned | IP-PBX | The MO | tration | IP-PBX | | | users | from | users | and MT | on | users | | | and | HSS to | and | for | behalf | and | | | ori | IBCF | ori | IP-PBX | IP-PBX | ori | | | ginated | and | ginated | user | user. | ginated | | | from | S-CSCF. | from | based | The MO | from | | | the | | the | on | and MT | the | | | IP-PBX | | IP-PBX | T | for | IP-PBX | | | users | | users | S 23.22 | IP-PBX | users | | | based | | based | 8 [5] | user | | | | on the | | on the | | based | | | | pro | | pro | | on | | | | cedures | | cedures | | T | | | | of | | of | | S 23.22 | | | | TS | | T | | 8 [5] | | | | 23.228 | | S 23.22 | | | | | | [5], | | 8 [5] | | | | | | Clause | | and | | | | | | 4.15. | | ETSI | | | | | | | | TS | | | | | | | | 182 02 | | | | | | | | 5 [8] | | | | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | N/A | No | No | No | No | No | | on | | | | | | | | I-CSCF | | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | N/A | N/A | No | Yes: | No | No | | on | | | | h | | | | P-CSCF | | | | andling | NOTE: | | | | | | | of TLS | TLS | | | | | | | and | h | | | | | | | regis | andling | | | | | | | tration | and | | | | | | | on | regis | | | | | | | behalf | tration | | | | | | | of the | on | | | | | | | IP-PBX | behalf | | | | | | | | of the | | | | | | | | IP-PBX | | | | | | | | is in | | | | | | | | BusTI | | | | | | | | GW. | | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | N/A | New | No | Removal | No | Default | | on | | pro | | of the | | r | | S-CSCF | | cedures | | proh | | outeing | | | | for Cx | | ibition | | info | | | | | | of | | rmation | | | | | | m | | is | | | | | | ultiple | | r | | | | | | regist | | eceived | | | | | | rations | | from | | | | | | with | | the HSS | | | | | | trusted | | in the | | | | | | a | | user | | | | | | uthenti | | profile | | | | | | cation. | | instead | | | | | | | | of | | | | | | | | being | | | | | | | | det | | | | | | | | ermined | | | | | | | | at | | | | | | | | regis | | | | | | | | tration | | | | | | | | time. | | | | | | | | | | | | | | | | Keeps | | | | | | | | itself | | | | | | | | al | | | | | | | | located | | | | | | | | after | | | | | | | | unreg | | | | | | | | istered | | | | | | | | pro | | | | | | | | cedure. | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | A | New | A | N/A | No | A | | on IBCF | ddition | in | ddition | | | ddition | | | of PSU | terface | of PSU | | | of PSU | | | from | to HSS | from | | | from | | | certi | | certi | | | certi | | | ficate. | | ficate. | | | ficate. | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | No | New | No but | No | No | Default | | on HSS | | in | dimen | | | routing | | | | terface | sioning | | | info | | | | to IBCF | to be | | | rmation | | | | | adapted | | | added | | | | Cx | due to | | | to the | | | | updated | extra | | | profile | | | | | Cx | | | | | | | | traffic | | | | | | | | (up to | | | | | | | | one | | | | | | | | tran | | | | | | | | saction | | | | | | | | per PBX | | | | | | | | se | | | | | | | | ssion). | | | | +---------+---------+---------+---------+---------+---------+---------+ | Impacts | BT AS | N/A | BT AS | IP-PBX | No | No | | on | | | | needs | | | | other | Transit | | | to | | | | IMS | f | | | i | | | | nodes | unction | | | nitiate | | | | | | | | TLS | | | | | | | | conn | | | | | | | | ection. | | | +---------+---------+---------+---------+---------+---------+---------+ | Scal | All | An IBCF | All | All | All | All | | ability | nodes | needs | nodes | nodes | sig | nodes | | re | can be | to be | except | except | nalling | except | | garding | sta | s | S-CSCF | S-CSCF | traffic | S-CSCF | | the | teless. | elected | are | are | to and | are | | support | | for | sta | sta | from a | sta | | of | As a | each | teless. | teless. | par | teless. | | large | result, | PBX. | | | ticular | | | number | can | | S-CSCF | One or | ent | S-CSCF | | of PBX | scale | One | will be | more | erprise | will be | | users | dyna | S-CSCF | al | P-CSCF | network | al | | | mically | will be | located | (and | will go | located | | | and | all | (as | eve | through | (as | | | indepe | ocated. | unreg | ntually | the | unreg | | | ndently | As | istered | a back | same | istered | | | to the | impli | state). | up one) | Bu | state). | | | size of | cation, | As | needs | sTI-GW. | As | | | enterp | only | impli | to be | | impli | | | rises.. | one | cation, | s | S-CSCF | cation, | | | | S-CSCF | only | elected | will be | only | | | | at time | one | by | all | one | | | | will be | S-CSCF | IP-PBX | ocated. | S-CSCF | | | | used | at time | at TLS | AS | at time | | | | for all | will be | con | impli | will be | | | | traffic | used | nection | cation, | used | | | | for a | for all | set | only | for all | | | | par | traffic | up.. | one | traffic | | | | ticular | for a | | S-CSCF | for a | | | | PBX | par | S-CSCF | at time | par | | | | (subsc | ticular | will be | will be | ticular | | | | riber). | PBX | all | used | PBX | | | | | user | ocated. | for all | user | | | | | p | As | traffic | p | | | | | rofile, | impli | for a | rofile, | | | | | but | cation, | par | but | | | | | load | only | ticular | load | | | | | can be | one | IP- PBX | can be | | | | | can be | S-CSCF | user | can be | | | | | dist | at time | p | dist | | | | | ributed | will be | rofile, | ributed | | | | | across | used | but | across | | | | | m | for all | load | m | | | | | ultiple | traffic | can be | ultiple | | | | | S-CSCFs | for a | can be | S-CSCFs | | | | | by | par | dist | by | | | | | sp | ticular | ributed | sp | | | | | litting | IP- PBX | across | litting | | | | | users | user | m | users | | | | | into | p | ultiple | into | | | | | m | rofile, | S-CSCFs | m | | | | | ultiple | but | by | ultiple | | | | | groups. | load | sp | groups. | | | | | | can be | litting | | | | | | | can be | users | | | | | | | dist | into | | | | | | | ributed | m | | | | | | | across | ultiple | | | | | | | m | groups. | | | | | | | ultiple | | | | | | | | S-CSCFs | | | | | | | | by | | | | | | | | sp | | | | | | | | litting | | | | | | | | users | | | | | | | | into | | | | | | | | m | | | | | | | | ultiple | | | | | | | | groups. | | | +---------+---------+---------+---------+---------+---------+---------+ | Provi | Certi | HSS | Certi | No | The | Certi | | sioning | ficates | single | ficates | IP-PBX | IP-PBX | ficates | | and | r | point | r | data to | sub | r | | config | equired | of | equired | be | scriber | equired | | uration | in IBCF | provis | in IBCF | prov | p | in IBCF | | | (e | ioning. | (e | isioned | rofiles | (e | | | xisting | | xisting | in | needs | xisting | | | T | | T | P-CSCF. | to be | T | | | S 33.31 | | S 33.31 | Certi | prov | S 33.31 | | | 0 [4] | | 0 [4] | ficates | isioned | 0 [4] | | | require | | require | r | or | require | | | ments). | | ments). | equired | pre-con | ments). | | | | | | in | figured | | | | Transit | | Sub | P-CSCF | in | Sub | | | f | | scriber | (cf | Bu | scriber | | | unction | | p | TS | sTI-GW. | p | | | con | | rofiles | 33.310 | | rofiles | | | figured | | of the | [4]). | Sub | of the | | | with | | PBX in | | scriber | PBX in | | | Transit | | HSS | Sub | p | HSS | | | Inv | | needs | scriber | rofiles | needs | | | ocation | | to be | p | of the | to be | | | Cr | | prov | rofiles | PBX in | prov | | | iteria. | | isioned | of the | HSS | isioned | | | | | for | PBX in | needs | for | | | AS (or | | each | HSS | to be | each | | | its | | PBX. | needs | prov | PBX. | | | data | | | to be | isioned | | | | s | | The PBX | prov | for | The PBX | | | torage) | | routing | isioned | each | routing | | | needs | | info | for | PBX. | info | | | to be | | rmation | each | | rmation | | | prov | | needs | PBX. | | needs | | | isioned | | to be | | | to be | | | with | | prov | | | prov | | | the PBX | | isioned | | | isioned | | | related | | in the | | | in the | | | data | | PBX | | | sub | | | (in | | P | | | scriber | | | cluding | | rofile, | | | profile | | | IP/FQDN | | either | | | | | | of | | in the | | | | | | PBX). | | AS or | | | | | | | | in the | | | | | | | | HSS. | | | | +---------+---------+---------+---------+---------+---------+---------+ | Em | Su | Su | Su | Su | Su | Su | | ergency | pported | pported | pported | pported | pported | pported | | calls | ac | ac | ac | ac | ac | ac | | and | cording | cording | cording | cording | cording | cording | | other | to | to | to | to | to | to | | reg | current | current | current | current | current | current | | ulatory | pro | pro | pro | pro | pro | pro | | requi | cedures | cedures | cedures | cedures | cedures | cedures | | rements | of | of | of | of | of | of | | | TS | TS | TS | TS | TS | TS | | | 23.167 | 23.167 | 23.167 | 23.167 | 23.167 | 23.167 | | | [6]. | [6]. | [6]. | [6]. | [6]. | [6]. | +---------+---------+---------+---------+---------+---------+---------+ | Res | All | Not | All | All | S-CSCF | All | | iliency | nodes | de | nodes | nodes | failure | nodes | | | can be | scribed | except | except | handled | except | | | sta | | S-CSCF | S-CSCF | using | S-CSCF | | | teless. | | are | are | rest | are | | | | | sta | sta | oration | sta | | | M | | teless. | teless. | pro | teless. | | | ultiple | | | | cedures | | | | paths | | M | P-CSCF | | S-CSCF | | | can | | ultiple | red | When | failure | | | always | | IBCFs | undancy | the | handled | | | be used | | can be | p | B | using | | | to | | used to | rovided | usTI-GW | rest | | | handle | | handle | by | fails. | oration | | | node | | node | m | The | pro | | | fa | | fa | ultiple | backup | cedures | | | ilures. | | ilures. | regist | B | (as in | | | | | | rations | usTI-GW | un-reg | | | | | S-CSCF | or | will | istered | | | | | failure | re-se | take | state, | | | | | handled | lection | over | no | | | | | using | of the | the | dep | | | | | rest | P-CSCF | user by | endency | | | | | oration | by the | making | to | | | | | pro | PBX. | IMS | restore | | | | | cedures | | regis | full | | | | | (as in | Two | tration | regis | | | | | un-reg | di | on | tration | | | | | istered | fferent | behalf | state). | | | | | state, | s | of | | | | | | no | olution | IP-PBX | M | | | | | dep | alter | user. | ultiple | | | | | endency | natives | | IBCFs | | | | | to | are | NOTE: | can be | | | | | restore | des | This | used to | | | | | full | cribed. | could | handle | | | | | regis | | be | node | | | | | tration | S-CSCF | solved | f | | | | | state). | failure | by | ailure. | | | | | | handled | e | | | | | | | using | xisting | | | | | | | rest | he | | | | | | | oration | artbeat | | | | | | | pro | mec | | | | | | | cedures | hanisms | | | | | | | | which | | | | | | | | are not | | | | | | | | de | | | | | | | | scribed | | | | | | | | in the | | | | | | | | TR. | | +---------+---------+---------+---------+---------+---------+---------+ | Scal | Su | Su | Su | Su | Su | Su | | ability | pported | pported | pported | pported | pported | pported | | re | but | but | but | but | | but | | garding | each | each | each | either | | each | | the | PBX | PBX | PBX | each | | PBX | | support | need to | need to | need to | PBX | | need to | | of a | obtain | obtain | obtain | obtains | | obtain | | large | a | a | a | a | | a | | number | cert | cert | cert | cert | | cert | | of | ificate | ificate | ificate | ificate | | ificate | | small | and the | and the | and the | and the | | and the | | PBXs | o | o | o | o | | o | | (Small | perator | perator | perator | perator | | perator | | Office | needs | needs | needs | needs | | needs | | Home | to | to | to | to | | to | | Office) | handle | handle | handle | handle | | handle | | | a large | a large | a large | a large | | a large | | | variety | variety | variety | variety | | variety | | | of | of | of | of | | of | | | Cert | Cert | Cert | Cert | | Cert | | | ificate | ificate | ificate | ificate | | ificate | | | Autho | Autho | Autho | Auth | | Autho | | | rities. | rities. | rities. | orities | | rities. | | | | | | or by | | | | | When a | | | using | | | | | large | | | pre-con | | | | | number | | | figured | | | | | of | | | IP | | | | | small | | | ad | | | | | ente | | | dresses | | | | | rprises | | | in | | | | | or | | | P-CSCF | | | | | ente | | | which | | | | | rprises | | | is used | | | | | using | | | to | | | | | numbers | | | authe | | | | | in | | | nticate | | | | | m | | | small | | | | | ultiple | | | PBXs. | | | | | ranges | | | | | | | | are | | | | | | | | used, | | | | | | | | the | | | | | | | | config | | | | | | | | uration | | | | | | | | table | | | | | | | | in | | | | | | | | every | | | | | | | | Transit | | | | | | | | f | | | | | | | | unction | | | | | | | | may | | | | | | | | become | | | | | | | | large. | | | | | | | | This | | | | | | | | config | | | | | | | | uration | | | | | | | | table | | | | | | | | also | | | | | | | | needs | | | | | | | | to be | | | | | | | | updated | | | | | | | | every | | | | | | | | time a | | | | | | | | Public | | | | | | | | I | | | | | | | | dentity | | | | | | | | is | | | | | | | | added | | | | | | | | behind | | | | | | | | a PBX. | | | | | | +---------+---------+---------+---------+---------+---------+---------+ | Support | Su | Not | Su | Su | P | Su | | of | pported | clear | pported | pported | ossible | pported | | geograp | | how | (with | (with | to | (with | | hically | | scal | above | above | Support | above | | dist | | ability | lim | lim | ( | lim | | ributed | | and | itation | itation | pending | itation | | ente | | res | that | that | the | that | | rprises | | ilience | only | only | res | only | | (mult | | should | one | one | olution | one | | i-site) | | be | S-CSCF | S-CSCF | of the | S-CSCF | | | | done. | at time | at time | FFS in | at time | | | | | will be | will be | the | will be | | | | | used). | used).. | alte | used). | | | | | | | rnative | | | | | | | | descri | | | | | | | | ption). | | +---------+---------+---------+---------+---------+---------+---------+ | Main | Issue | R | No AS | More | A | | | issues | with | equires | can be | pos | ddition | | | | large | new | tr | itioned | of a | | | | number | inte | iggered | for | new | | | | of | rfaces. | in | small | entity | | | | small | | term | and | to the | | | | ente | Not | inating | medium | IMS | | | | rprises | clear | after | size | archit | | | | (see | how | the AS | IP-PBX. | ecture. | | | | above). | scal | hosting | | | | | | | ability | the PBX | | For a | | | | No AS | and | routing | | geograp | | | | can be | res | f | | hically | | | | tr | ilience | unction | | dist | | | | iggered | will be | ality.\ | | ributed | | | | in | h | Extra | | ent | | | | term | andled. | load on | | erprise | | | | inating | | Cx to | | (multi | | | | after | | provide | | -site), | | | | the AS | | unreg | | all the | | | | hosting | | istered | | sig | | | | the PBX | | service | | nalling | | | | routing | | info | | traffic | | | | functio | | rmation | | will | | | | nality. | | to the | | ag | | | | | | S-CSCF. | | gregate | | | | | | | | in the | | | | | | | | one | | | | | | | | Bu | | | | | | | | sTI-GW. | | +---------+---------+---------+---------+---------+---------+---------+ | Main | P | | Only | Full | There | Only | | adv | rovides | | minor | IMS | is no | minor | | antages | f | | enhan | Service | impact | enhan | | | lexible | | cements | with | on the | cements | | | scal | | to IBCF | HSS | IMS | to IBCF | | | ability | | r | service | core. | r | | | within | | equired | p | | equired | | | a given | | for the | rofiles | | for the | | | nu | | PSU | | | PSU | | | mbering | | ha | NAT | | ha | | | range, | | ndling. | tr | | ndling. | | | and | | | aversal | | | | | resi | | In line | is | | In line | | | lience. | | with | sup | | with | | | Only | | e | ported. | | e | | | minor | | xisting | | | xisting | | | enhan | | T | | | IMS | | | cements | | S 23.22 | | | pro | | | to IBCF | | 8 [5] | | | cedures | | | r | | pro | | | | | | equired | | cedures | | | Does | | | for the | | and | | | not | | | PSU | | TISPAN | | | require | | | ha | | peering | | | de | | | ndling. | | based | | | ploying | | | | | prin | | | an AS | | | Inline | | ciples. | | | (fully | | | with | | | | | in line | | | e | | | | | with | | | xisting | | | | | ETSI | | | T | | | | | TS 1 | | | S 23.22 | | | | | 82 025) | | | 8 [5] | | | | | | | | pro | | | | | | | | cedures | | | | | | | | and | | | | | | | | TISPAN | | | | | | | | peering | | | | | | | | based | | | | | | | | prin | | | | | | | | ciples. | | | | | | +---------+---------+---------+---------+---------+---------+---------+
## 7.2 Overview of provisioning efforts
The following table gives an outlook of provisioning efforts in network
elements:
\- the normal text shows the provisioning needed only when adding a new IP-PBX
\- the **bold text** shows the provisioning needed when adding a new IP-PBX or
when adding/modifying extensions behind an IP-PBX.
Table 7.2-1: Overview of provisioning efforts
+----------+----------+----------+----------+----------+----------+ | | IBCF and | IBCF and | P-CSCF | St | S-CSCF | | | Transit | Sâ€‘CSCF | based | andalone | based | | | Re-Use | reuse | | BusTI GW | routing | +----------+----------+----------+----------+----------+----------+ | TR | 6.1 | 6.3 | 6.4.3 | 6.5 | 6.6 | | clause | | | | | | +----------+----------+----------+----------+----------+----------+ | HSS | - | IP-PBX | IP-PBX | IP-PBX | IP-PBX | | | | profile, | profile, | profile, | profile, | | | | | | | | | | | **Public |** Public | **Public |** Public | | | | User | User | User | User | | | | Iden | Iden | Iden | Iden | | | | tities**| tities** | tities**| tities** | +----------+----------+----------+----------+----------+----------+ | TRFs | **Public | - | - | - | - | | | User | | | | | | | Iden | | | | | | | tities** | | | | | +----------+----------+----------+----------+----------+----------+ | AS | IP-PBX | IP-PBX | - | - | IP-PBX | | | profile, | profile, | | | profile, | | | | | | | | | | **Public |** Public | | | **Public | | | User | User | | | User | | | Iden | Iden | | | Iden | | | tities** | tities**| | | tities** | +----------+----------+----------+----------+----------+----------+ | IBCFs | - | - | - | - | - | +----------+----------+----------+----------+----------+----------+ | P-CSCFs | - | - | - | - | - | +----------+----------+----------+----------+----------+----------+ | BusTI-GW | N/A | N/A | N/A | IP-PBX | N/A | | | | | | profile | | +----------+----------+----------+----------+----------+----------+
The absence of provisioning in P-CSCFs or IBCFs is a communality of all
solutions. However, the solution \"Standalone BusTI GW\" requires provisioning
in the BusTI-GW (which can be seen as an extension of the P-CSCF) when adding
a new IP-PBX.
All solutions require the Public User Identities used by the IP-PBX to be
provisioned in the HSS and updated when adding/modifying extensions behind an
IP-PBX, except for \"IBCF and Transit Re-Use\" (6.1), where this is done in
the TRFs.
In addition, solutions relying on an AS for routing and/or for identity
assertion require the Public User Identities used by the IP-PBX to be
provisioned in at least one AS, and updated when adding/modifying extensions
behind an IP-PBX.
## 7.3 Conclusions
The following conclusions have been drawn:
\- Solution 6.3 is proposed as base for normative specification.
\- Solution 6.1 can as a result also be provided as a deployment option for
e.g. large scale scenarios, as it is based on the same extensions as Solution
6.3.
\- Solution of 6.5 can be applied for small and medium size IP-PBXs. For this
solution, the BusTI-GW does not impact IMS core and it is not expected to
require normative work.
#