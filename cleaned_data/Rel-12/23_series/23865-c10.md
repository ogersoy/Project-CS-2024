# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
This Technical Report describes enhancements to solutions for WLAN network
selection. The solutions are based on architectures as specified in TS 23.402
[9] and will take into account Hotspot 2.0 specifications developed by the
WFA. 3GPP operator\'s policies for WLAN network selection will be provisioned
on 3GPP terminals via pre-configuration or using the ANDSF server for their
delivery. The scope of the technical report will be as follows:
1\. Evaluate existing 3GPP WLAN PLMN and access network selection procedures
for 3GPP terminals which use Hotspot 2.0 procedures and provisioned network
operator policy (e.g. mechanisms based on WLAN and ANDSF) for any needed
changes to current specifications. This may require enhancements to the ANDSF
framework. The established 3GPP PLMN network selection (according to TS
23.122) shall not be impacted. The work must ensure there are no conflicts
between existing 3GPP PLMN network selection and the 3GPP WLAN PLMN access
network selection procedures defined by this WID.
2\. Ensure that the content in the Management Object related to 3GPP operator
policy provisioning for WLAN network selection procedures and the operator
policy provisioning in WFA MO for WLAN network selection are consistent.
3\. Identify solutions to resolve potential conflicts between policies
provided by non-3GPP providers via Hotspot 2.0 mechanisms and policies
provided by 3GPP operators using ANDSF.
This work applies to non-seamless WLAN offload as well as to trusted and
untrusted WLAN access to EPC with/without seamless offload. It will be
investigated whether changes to 3GPP specifications are needed and if so which
ones.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] Void.
[3] 3GPP TS 24.312: \"Access Network Discovery and Selection Function (ANDSF)
Management Object (MO)\".
[4] 3GPP TS 24.234: \"3GPP System to Wireless Local Area Network (WLAN)
interworking; WLAN User Equipment (WLAN UE) to network protocols; Stage 3\".
[5] 3GPP TS 24.235: \"3GPP System to Wireless Local Area Network (WLAN)
interworking Management Object (MO)\".
[6] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via
non-3GPP access networks; Stage 3\".
[7] 3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity
Module (USIM) application\".
[8] 3GPP TS 23.234: \"3GPP system to Wireless Local Area Network (WLAN)
interworking; System description\".
[9] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] apply.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] apply.
# 4 Architectural assumptions
Editor\'s note: This clause will describe the assumptions for WLAN network
selection for 3GPP terminals.
For WLAN network discovery and selection in dual mode handset user
subscription to a single 3GPP home network is assumed.
# 5 Key Issues
Editor\'s note: This clause will contain description of key issues related to
WLAN network selection for 3GPP terminals.
## 5.1 Key Issue #1: Support WLAN access through roaming agreements
### 5.1.1 Description
Many 3GPP operators rely on roaming agreements for supporting WLAN access. An
example deployment is shown in the Figure 5.1.1-1 below, where the 3GPP
operator has roaming agreements with Partner X and Partner Y. Each of these
partners acts as a \"roaming consortium\" and maintains its own roaming
agreements with individual hotspot providers (shown as WLAN A, B and C). In
such deployments the 3GPP operator may provide SSID preferences to UEs in
order to guide their WLAN selection process. However, maintaining an up-to-
date list of all SSIDs used by hotspot providers may become very cumbersome
and inconvenient, especially since roaming agreements may change and since the
hotspot providers may modify or extend their SSIDs.
Figure 5.1.1-1: Supporting WLAN access through roaming agreements
In such a deployment scenario, which becomes more and more common today, the
3GPP operator is not really interested in providing SSID preferences to UEs
and, in addition, may not know all the SSIDs supported by the hotspot
providers that interwork with partners X and Y. Instead, the 3GPP operator is
interested in providing preferences based on the interworking capabilities of
a WLAN, such as \"WLANs that interwork with Partner X have the highest
selection priority\" and \"WLANs that interwork with Partner Y have the second
highest priority\". This is however not possible since the current ANDSF
specifications (see e.g. TS 23.402 [9] and TS 24.312 [3]) support WLAN network
selection policies based on SSID only.
In general, using only the SSID in the WLAN selection policies can create
several issues as discussed above. Thus there is need to extend the WLAN
selection policies so that parameters other than SSID can be used too (e.g.
parameters such as the realms supported by a WLAN network). Such parameters
can be discovered by the UE with the applicable Hotspot 2.0 procedures.
## 5.2 Key Issue #2: Delivery of consistent information for WLAN network
selection
### 5.2.1 Description
WLAN network selection in a dual mode handset may be based on information
provided to the handset by 3GPP System to WLAN interworking Management Object
as specified in TS 24.235 [5], by ANDSF Management Object as specified in TS
24.312 [3], by USIM as specified in TS 31.102 [7] or based on Management
Object currently being defined by the WFA Hotspot 2.0 Release 2 specifications
or both. This information can also be pre-configured in a dual mode handset.
Since there is an overlap between the information being provisioned in the UE,
an inconsistent set of information from different sources and/or by different
management objects in a dual mode handset can result in conflicting set of
rules for the UE. One of the tasks in this work item is to address such
potential conflicts. It is important that components of WFA network discovery
and selection information that are relevant for a dual mode handset are
identified and potential conflicts resolved.
### 5.2.2 Required functionality
Potential conflicts in information between WFA Hotspot 2.0 specifications and
relevant components in 3GPP will be resolved.
## 5.3 Key Issue #3: Applicability of I-WLAN network selection
### 5.3.1 Description
Based on the current stage 3 specifications (see TS 24.234 [4], clause 5.2.1),
the I-WLAN network selection procedure is applicable to initial network
selection at WLAN UE switch-on and following recovery from lack of WLAN radio
coverage. It is not clear however if I-WLAN network selection is applicable in
other scenarios except from switch-on and recovery from lack of radio
coverage. Given this lack of clarity, an assumption has been made that I-WLAN
network selection should be executed by the WLAN UE every time it activates
its WLAN radio interface. However, this assumption may not be necessarily
correct especially after the introduction of ANDSF which can trigger the UE to
activate its WLAN radio interface in order to perform access selection (within
the same PLMN) and/or IP flow mobility.
This key issue aims to clarify when the I-WLAN network selection procedure (as
specified in TS 24.234 [4]) should be executed by the UE given that there are
scenarios where the I-WLAN network selection may not be necessary. For
example:
\- A UE is registered to HPLMN over 3GPP access and an ISMP policy gets active
indicating that EPC access is preferable over SSID-X. In this case, the ISMP
policy aims to steer the UE to a specific WLAN network and offload the 3GPP
radio network. So, the UE could possibly skip the I-WLAN network selection and
attempt to select SSID-X (if available), as requested by the ISMP policy.
\- A UE is registered to HPLMN over 3GPP access and an ISRP policy gets active
indicating that certain IP flows should be offloaded to SSID-X. In this case,
the ISRP policy aims to steer some traffic to a specific WLAN network. So, the
UE could possibly skip the I-WLAN network selection and attempt to select
SSID-X (if available), as requested by the ISRP policy.
Furthermore, if the UE does not perform the I-WLAN network selection procedure
(according to TS 24.234 [4]) and the UE attempts EAP-AKA over an SSID (e.g.
provided by the ANDSF), it is not clear how the UE selects a NAI when the
selected SSID does not support interworking with the HPLMN.
### 5.3.2 Required functionality
Based on the above discussion, it is necessary to clarify when the execution
of I-WLAN network selection is applicable when the UE activates its WLAN radio
interface. There is also need to clarify how the UE selects the PLMN, e.g. for
constructing the NAI for EAP-AKA authentication, when the I-WLAN network
selection procedure is not performed.
## 5.4 Key Issue #4: Use WLAN load information for network selection
### 5.4.1 Description
Currently the ANDSF does not provide any network selection policies to the UE
that take load or congestion indication from WLAN networks into account.
Providing such policies can improve the existing WLAN network selection
decisions.
As part of WFA Hotspot 2.0 specifications, an AP compliant with Hotspot 2.0
broadcasts the BSS Load information and supports the WAN Metrics ANQP Element.
The BSS Load information element contains information on the current mobile
device population and channel utilization in the BSS. The WAN Metrics ANQP
element provides information about the WAN link of a WLAN access network.
The WFA Hotspot 2.0 specifications take into account the BSS Load and backhaul
parameters to specify BSS Load policy to prevent a mobile device from joining
a WLAN network that may be overly congested with traffic and/or interference.
The dual mode UE shall only use policies as specified by 3GPP specifications
(e.g. ANDSF MO, I-WLAN IWK MO) for WLAN network selection. It should be
investigated if the policies specified by 3GPP specifications for WLAN network
selection may be enhanced to take these parameters into account and align with
WFA Hotspot 2.0 specifications.
### 5.4.2 Required functionality
Define if and how the 3GPP specifications may use the combination of WLAN BSS
load, backhaul network speed, and load information as described by WFA Hotspot
2.0 specifications to specify WLAN selection policies.
The solution should prevent frequent reselection due to changing load
conditions.
## 5.5 Key Issue #5: Interaction between WLAN network selection and network-
provided policies for WLAN selection
### 5.5.1 Description
Currently, an operator may provide ANDSF policies to the UE in order to allow
the UE to route traffic to specific WLAN access network (e.g. a specific SSID)
based on the policy rules. The current policy rules could be enhanced by
adopting parts of the WFA Hotspot 2.0 specifications that allow for developing
policies for WLAN network selection by making use of IEEE 802.11u ANQP query
response mechanisms, use of realms information, venues information, network
load, etc. In the current 3GPP specifications, the applicability of such ANDSF
rule is restricted to the WLAN access network that is selected during the WLAN
network selection since ANDSF rules are evaluated only after WLAN network
selection is performed. The ANDSF rules cannot trigger the UE to select
another WLAN access network (e.g. in a different PLMN), and therefore all the
active rules directing the UE to use other WLAN access networks cannot be
used.
As an example, a 3GPP operator wants to have policies whereby traffic can be
offloaded to its roaming partners but only in a certain time window and at a
particular geographic location, for example during rush hour in a busy
downtown area. Let\'s say that operator A has relationship with operator #1
with SSID1 and operator #2 with SSID2. The ANDSF rules specify that if you are
in location x and between time y and z then prefer SSID1 but for other
location or times prefer SSID2. The PLMN priority list in the UE has SSID2
higher in preference than SSID1. Now if the user is at location x between time
y and z, would the UE, using the current I-WLAN procedures, be able to select
the SSID that ANDSF has prioritized?
In some scenarios, the operator:
\- may decide not to provide any or partial WLAN information (e.g. a list of
SSIDs) in the I-WLAN MO or in the USIM, while still providing the PLMN
information in the I-WLAN MO.
\- may decide not to provide the I-WLAN MO.
In such scenarios, even though the operator provides ANDSF policy rules to the
UE, such policy rules cannot be used to assist the UE in selecting a WLAN
access network.
### 5.5.2 Required functionality
Investigate enhancements to WLAN network selection that enables the
(re)selection of a PLMN based e.g. on time, location, etc. using policies
provided by the 3GPP network (e.g. in the case of different roaming partners),
with the assumption that continued support for the legacy terminals shall be
possible.
## 5.6 Key Issue #6: Simultaneous connectivity to multiple VPLMNs
### 5.6.1 Description
As described in TS 24.234 [4], clause 5.1, the NW and PLMN selection in WLAN
is independent if PLMN selection that is performed in 3GPP access: \"_Network
selection procedure is completely independent of the result of the PLMN
selection under other radio access technologies that are specified in TS
23.122_ \". There is thus the possibility that a UE simultaneously connected
to both 3GPP access and WLAN access selects different VPLMN in the two
accesses.
For the case of ePDG selection, the procedures defined in TS 24.302 [6] can
result in one of the following options:
\- If the UE is attached to a VPLMN in 3GPP access, the UE may either find an
ePDG in the VPLMN used in 3GPP access or an ePDG in HPLMN.
\- If the UE is attached to HPLMN in 3GPP access, the UE finds an ePDG in
HPLMN.
\- If the UE is not attached in 3GPP access, the UE may either find an ePDG in
the VPLMN selected in WLAN access or an ePDG in HPLMN.
For further details, see TS 23.402 [9]. The ePDG selection procedure can thus
result in an ePDG located in VPLMN selected for 3GPP access, in VPLMN selected
for WLAN access or in HPLMN.
Two example scenarios are shown in the figures below:
Scenario 1: The UE ends up with different VPLMN in 3GPP access and WLAN
access. This scenario may happen e.g. in SaMOG case when UE attaches in both
3GPP and WLAN access and the PLMN selection procedures end up in separate
VPLMN.
Figure 5.6.1-1: Example scenario 1 with different VPLMN in 3GPP access and
WLAN access
Scenario 2: Different VPLMN in 3GPP access and WLAN access, and ePDG selected
in 3GPP VPLMN. This scenario may happen e.g. in case when UE first attaches in
3GPP, then attaches in WLAN access and then finds an ePDG in 3GPP VPLMN
Figure 5.6.1-2: Example scenario 2 with different VPLMN in 3GPP access and
WLAN access
The scenario with multiple simultaneous serving PLMNs has not been
sufficiently addressed in 3GPP. For a roaming UE in such a scenario, issues
that may need further resolution include:
\- Is the scenario described above valid or should it be avoided, e.g. by
appropriate specification changes-
\- Even though mobility and routing policies from H-ANDSF should as of today
not impact the PLMN selection procedures, it is not clear if policies from
H-ANDSF policies apply since an access change would also result in PLMN
change.
It is not clear if policies from any of the two V-ANDSF can apply in such a
scenario.
### 5.6.2 Required functionality
There is a need to clarify (V-)ANDSF usage (e.g. which ANDSF is used at each
mobility/selection step) and other aspects related to scenarios where a UE is
served by different VPLMN in 3GPP access and WLAN access.
## 5.7 Key Issue #7: Use WLAN Access Network Type and Venue Information for
network selection
### 5.7.1 Description
Currently the ANDSF does not provide any operator policies that make use of
venue related information of WLAN access networks. Providing such policies can
improve existing WLAN network selection decisions.
As part of WFA Hotspot 2.0 (Release 1) specifications, a Hotspot 2.0 compliant
AP provides the Access Network type information in the Interworking
information element. The Interworking information element also includes
support for Venue Info. Hotspot 2.0 also support for the Venue Name ANQP IE.
The Access Network Type IE identifies a WLAN network as a private, public,
free, personal, emergency, etc. type of network. The Venue information such as
venue type and venue name helps to identify the venue where WLAN network may
be deployed, e.g. school, hospital, hotel, professional office, etc. In some
countries the same SSID is used for public hotspots which are charged and
hotel hotspots that are free of charge. This type of information would allow
operators and service providers to apply different policies for different
types of WLAN networks such as public hotspots, home or enterprise based WLAN
networks. It would also result in improved WLAN network selection. New
policies for network selection, ISMP and ISRP types can be enabled that
utilize this information about WLAN networks.
### 5.7.2 Required functionality
Define if and how the 3GPP specifications may use the WLAN Access Network Type
and Venue information as described by WFA Hotspot 2.0 specifications to
specify WLAN selection policies.
## 5.8 Key Issue #8: Use Connection Capability during WLAN network selection
### 5.8.1 Description
WFA Hotspot 2.0 specifications specify a range of WLAN capabilities and other
parameters that can be used by UEs to select a WLAN network. The Connection
Capability is one of the WLAN capabilities defined by WFA Hotspot 2.0
specifications to provide information on the connection status within the WLAN
network and corresponding policy MO is also defined in WFA MO. The content of
the Connection Capability indicates that the WLAN network allows communication
on certain IP protocols and ports while blocks communication on others. For
example, a firewall or a NAT function in the WLAN network blocks the IP flows
associated with certain IP protocols and ports.
But the ANDSF doesn\'t take into account the Connection Capability of the WLAN
networks when the ANDSF specifies policies. So when the UE selects a WLAN
network using an ANDSF policy, the WLAN network may block the IP flows of the
UE. As a result, the user experience is reduced. So it needs to be analyzed
whether the Connection Capability of the WLAN network defined by WFA Hotspot
2.0 specifications should be taken into account when making the ANDSF policies
related to WLAN selection.
### 5.8.2 Required functionality
It needs to be analyzed if and how the Connection Capability of the WLAN
network defined by WFA Hotspot 2.0 specifications should be taken into account
when making the ANDSF policies related to WLAN selection.
## 5.9 Key issue #9: How can a UE discover WLANs having S2a connectivity to a
given PLMN?
### 5.9.1 Description
In order to ensure seamless continuity in a S2a local break out scenario for
services that require IP address preservation such as VoIMS, the UE needs to
use the \"active\" ISRP rule from the rules provided by the VPLMN (V-ANDSF).
But it is expected that an operator will wish to ensure that a UE will be able
to select a WLAN that can provide both VoIMS and home routed services such as
Corporate VPN and https banking transactions (which require IP address
preservation), as well as other home routed services such as parental control.
However V-ANDSF does not ensure that the selected WLAN has connectivity via
S2a interface with PGWs in the UE\'s Home PLMN.
### 5.9.2 Required functionality
Investigate if enhancements are needed to WLAN network selection that enable,
upon operator configuration, a UE to select a WLAN that can provide home
routed services via S2a interface.
Investigate if enhancements are needed to WLAN network selection that enable,
upon operator configuration, a UE to select a WLAN that can provide both local
break out services and home routed services via S2a interface.
# 6 Solutions
Editor\'s note: This clause will describe the solution(s) for WLAN network
selection for 3GPP terminals.
## 6.1 Solution #1: ANDSF Policies with Extended Selection Preferences
### 6.1.1 Description
This solution addresses the key issue of \"Support WLAN access through roaming
agreements\". However, it is applicable also to scenarios where WLAN access is
provided without roaming agreements.
This solution proposes to extend the ANDSF selection policies to support also
selection policies based on the Realms and/or the Organizational Unique
Identifiers (OUIs) which are supported by Hotspot 2.0 compliant WLAN networks.
The ANDSF may send policies to UE based on Realms and/or OUIs to indicate for
example that \"WLANs that interwork with Realm=PartnerX.com have the highest
access priority\". The UE uses the Realms and/or OUIs as an alternative way
(instead of using SSID) to identify and prioritize the discovered WLAN access
networks.
A Hotspot 2.0 compliant UE is capable to discover the Realms and/or OUIs
supported by a specific WLAN access network prior to association by using the
applicable discovery procedures (e.g. based on the ANQP protocol) and/or by
receiving the beacon transmissions of APs (some OUIs are included in the AP
beacon messages).
Editor\'s note: The text above suggests extending the ANDSF policies to
support also preferences based on Realm and/or OUIs. It is FFS if preferences
based on other Hotspot 2.0 parameters should also be supported.
NOTE: The UE uses the provisioned Realms/OUIs only when applying ANDSF
policies after the PLMN selection, according to the current specifications.
### 6.1.2 Impacts on existing nodes or functionality
The ANDSF access selection policies need to be extended in order to include
additional selection preferences.
### 6.1.3 Evaluation
## 6.2 Solution #2: ANDSF policies used in (V)-PLMN
### 6.2.1 Description
This solution addresses Key Issue # 6 - Simultaneous Connectivity to Multiple
V-PLMNs.
An ANDSF server provides policy towards a given UE in order for that UE to be
able to use more extensive decision-making criteria when determining which
access the UE should connect to.
A V-ANDSF server associated with a given V-PLMN could be used to download
access network selection policies to determine the best access network
associated to a given V-PLMN. This implies that a V-ANDSF server, belonging to
Operator X, may provide policies towards a UE belonging to Operator Y. The
current solution is that the UE reconciles the policies from V-ANDSF and
H-ANDSF and, if there is overlap, gives precedence to policies from the
V-ANDSF.
As described in Key Issue #6, the UE may be connected to two different VPLMNs
simultaneously, one in 3GPP access and one in WLAN access. For these scenarios
the UE may potentially receive policies from two V-ANDSF servers, one in each
VPLMN. It is not clear which V-ANDSF, if any, shall be used for the policy
information or if one of the V-ANDSF servers has precedence over the other
one.
According to the proposed solution:
\- 3GPP system will be enhanced to allow the V-ANDSF policies to be taken into
account for the case when both 3GPP and non-3GPP accesses connect via the same
V-PLMN. For this solution, the UE in Key Issue # 6, Scenario 1, could not use
the V-ANDSF in V-PLMN1 or V-PLMN2, while the UE in Key Issue # 6, Scenario 2
could use the V-ANDSF for both accesses in V-PLMN1.
### 6.2.2 Impacts on existing nodes or functionality
The UE can accept policies received from the V-ANDSF server only if the UE has
single selected V-PLMN for all attached accesses.
Editor\'s note: In case the UE is connected to multiple V-PLMNs via different
3GPP and non-3GPP accesses, it is FFS whether there are cases when the UE may
choose to use policies from one or both V-ANDSF servers.
### 6.2.3 Evaluation
## 6.3 Solution #3: WLAN selection based on ANDSF rules
### 6.3.1 Overview
This solution describes how a UE selects a WLAN access network (out of many
available) based on the preferences included in the \"active\" ISMP or ISRP
rule in the UE. The \"active\" ISMP / ISRP rule is the rule applied by the UE.
The solution is characterized by the following:
1\. The UE (re-)selects a WLAN based on provisioned ISMP / ISRP rules. The
WLAN (re-)selection procedure is triggered in the UE after an ISMP / ISRP rule
becomes active. How the UE selects the active ISMP / ISRP rule is specified in
clause 6.3.3.
2\. The WLAN selection in the UE is based on enhanced ISMP / ISRP rules. The
enhanced ISMP / ISRP rules can include not only SSID preferences but also
additional preferences such as realms (i.e. preferred service providers),
OUIs, available backhaul bandwidth, connectivity capabilities, etc. The UE can
discover the supported realms, bandwidth and other properties of HS2.0 capable
WLANs by means of HS2.0 discovery mechanisms (e.g. ANQP).
An example of an enhanced ISRP rule is shown below. This example is only
provided to aid the understanding of the proposed WLAN selection procedure.
Details of how ISRP rules will be enhanced is for stage 3 to define.
Example of enhanced ISRP rule:
\- **Rule Priority 1:** Flow distribution rule for NSWO: Route traffic from
YouTube application the following prioritized accesses:
\- **Access Priority 1:** WLAN, SSID = \"myOperator\"
\- **Access Priority 2:** WLAN, any SSID, realm = \"example1.com\", minimum
backhaul bandwidth = 1000 kbps
\- **Access Priority 3:** WLAN, any SSID, realm = \"example1.com\"
\- Rule Priority 2: Flow distribution rule for IFOM: Route traffic to IMS APN
to the following prioritized accesses:
\- **Access Priority 1:** WLAN, any SSID, realm = \"example2.com\"
\- **Access Priority 2:** 3GPP access
3\. For this solution, the WLAN selection procedure does not require the UE to
support the I-WLAN and PLMN selection procedures specified in TS 23.234 [8]
and TS 24.234 [4].
#### 6.3.1.1 WLANs that _best match_ the ISMP / ISRP rules
The proposed WLAN selection procedure (see section 6.3.2) requires the UE to
identify the available WLANs that _best match_ the active ISMP / ISRP rule.
This section explains how the UE can determine these WLANs (the details should
be specified by stage 3).
When the UE has an active ISMP rule (i.e. the UE cannot simultaneously route
IP traffic over multiple radio accesses), then the WLANs that best match the
active ISMP rule are derived by comparing the available WLANs against the
prioritized list of WLAN networks in this rule (included in the
_PrioritizedAccess_ node). For example, when the active ISMP rule is the one
shown below, the WLANs that best match this rule are the WLANs that match
access priority 1. If none of the available WLANs match access priority 1,
then the WLANs that best match the active ISMP rule are the WLANs that match
access priority 2, etc.
Example of active ISMP rule:
\- Access to EPC should be obtained over the following prioritized accesses:
\- Access Priority 1: WLAN, SSID = \"myOperator\"
\- Access Priority 2: WLAN, any SSID, realm = \"partner1.com\", minimum
backhaul bandwidth = 1000 kbps
\- Access Priority 3: WLAN, any SSID, realm = \"partner1.com\"
When the UE has an active ISRP rule (i.e. the UE can simultaneously route IP
traffic over multiple radio accesses), the determination of the WLANs that
best match this rule is not very straightforward. This is because the active
ISRP rule may include multiple sets of WLAN preferences. This is illustrated
in the figure below, which shows an ISRP rule with three different sets of
WLAN preferences: one set for IFOM, a second set for MAPCON and a third set
for NSWO. Although these multiple sets give the operator the flexibility to
define different WLAN preferences for IFOM, MAPCON and NSWO, yet, they make
the WLAN selection in the UE more complex. Up to now, how the UE selects a
WLAN in this scenario has been left up to the UE implementation. However, if a
consistent UE behaviour is expected, the WLAN selection procedure specified in
this TR should clearly specify the UE behaviour.
Figure 6.3.1.1-1: Multiple sets of WLAN preferences in an ISRP rule
It is noted that, in most practical scenarios, it is expected that operators
will have either (i) one list of preferred WLANs for IFOM, MAPCON and NSWO or
(ii) two lists of preferred WLANs: one list of preferred WLANs for IFOM/MAPCON
(i.e. for EPC access) and another list of preferred WLANs for NSWO, and that
all IFOM/MAPCON rules and NSWO rules respectively are populated with the same
list. Therefore, in most practical scenarios, the active ISRP rule will
include only two different sets of WLAN preferences.
Given the above note, a UE selects a WLAN based on the active ISRP rule by
using the following principles:
\- The UE can be configured to \"prefer WLANs for NSWO\" or not. Such
configuration can be included in the active ISRP rule.
\- If the UE is configured to prefer WLANs for NSWO, then the UE determines
the WLANs that best match the active ISRP rule by checking first which WLANs
match the WLAN preferences for NSWO. If there is no match, then the UE checks
which WLANs match the WLAN preferences for IFOM/MAPCON.
\- If the UE is not configured to prefer WLANs for NSWO, then the UE
determines the WLANs that best match the active ISRP rule by checking first
which WLANs match the WLAN preferences for IFOM/MAPCON. If there is no match,
then the UE checks which WLANs match the WLAN preferences for NSWO.
\- The UE performs the WLAN selection based on the above two bullets and does
not take into account real-time events associated with the active ISRP rule.
For example, when a new IP flow in the UE matches the traffic selector in an
ISRP rule, this event should not trigger WLAN re-selection. Also, if the
active ISRP rule is the one shown if figure 6.3.1.1-1, the UE does not take
into account whether the YouTube application is running or not. If the
conditions for WLAN selection change every time a new application runs or when
certain IP flows are detected, the WLAN selection in the UE will be complex
and may lead to frequent WLAN re-selections that would negatively affect the
user experience and the battery consumption. In general, when an IP flow
matches the active ISRP rule, this rule is used to determine how the IP flow
should be routed across the existing radio accesses and should not trigger
WLAN (re-)selection.
NOTE: Events such as change of WLAN load information, change of UE location,
change of time of day may lead to WLAN (re-)selection.
Editor\'s note: There are still issues that need further consideration. For
example, when IP traffic matches an ISRP rule that has SSID-x as the highest
access priority and 3GPP access as the second highest priority, and the UE is
connected to SSID-y, will the UE route this IP traffic to SSID-y or to 3GPP
access? Or, is it possible to have multiple \"ISRP for NSWO\" rules with
different WLAN preferences?
Editor\'s note: The above solution does not require any changes to the
existing ISRP. However, alternative solutions that may change the structure of
ISRP may be also investigated.
It is possible that multiple WLANs _best match_ the preferred WLANs in the
active ISMP / ISRP rule. The UE behaviour is this case is described in section
6.3.2.
### 6.3.2 WLAN selection based on ANDSF rules
The proposed WLAN selection procedure is described below:
1\. First, the UE compares the available (discovered) WLANs against the
preferred WLANs in the active ISMP / ISRP rule and determines the list of
available WLANs that best match the preferred WLANs (clause 6.3.1.1 specifies
how this can be done). This determination takes into account all preferences
in the active ISMP / ISRP rule, including realms, OUIs, etc.
a. When there is only one WLAN that best matches the preferred WLANs, the UE
selects this WLAN.
b. When there are multiple WLANs that best match the preferred WLANs, the UE
selects one out of these multiple WLANs by determining which one supports
interworking with the most preferred Service Provider.
\- The UE has one or more preferred Service Providers (e.g. PLMNs) provided by
the home operator, as specified in clause 6.3.4.
2\. If the UE has to perform EAP-AKA authentication over the selected WLAN
network (the one selected in the previous step). The UE constructs the NAI
that corresponds to the most preferred Service Provider supported by the
selected WLAN network.
\- Again, the UE uses the list of preferred Service Providers (e.g. PLMNs)
provided by the home operator. Details about this list are provided in clause
6.3.4.
3\. During power-up the UE is not registered to a PLMN over any access and
thus (according to the current specifications) it has no active ISMP / ISRP
rule. However, in order to enable WLAN selection with the enhanced ISMP / ISRP
rules during power-up, one of the ISMP / ISRP rules provisioned by the HPLMN
can be considered active during power-up as if the UE were registered to the
HPLMN. In order to enable WLAN selection with the enhanced ISMP/ISRP rules
following recovery from loss of WLAN signal, the UE applies the active
ISMP/ISRP rule.
### 6.3.3 Selection of active ISMP/ISRP rule
When the UE is roaming and is provisioned with valid ISMP/ISRP rules from
VPLMN and HPLMN, the UE selects the \"active\" ISMP/ISRP rule to apply for the
(re)selection of WLAN as follows:
1) When the UE uses ISMP rules, it selects the \"active\" ISMP rule as
currently specified (i.e. it selects an \"active\" rule from the rules
provided by the VPLMN).
2) When the UE uses ISRP rules, it selects the \"active\" ISRP rule as
follows:
a) The UE is configured to either \"prefer WLANs provided by the HPLMN\" or
not. This configuration can be done either by the home operator or by the
user. User configuration takes precedence over the home operator
configuration.
b) If the UE is not configured to prefer WLANs provided by the HPLMN, then the
UE selects the \"active\" ISRP rule from the rules provided by the VPLMN. The
UE uses this rule also for routing decisions.
c) If the UE is configured to prefer WLANs provided by the HPLMN, then the UE
checks if any of the \"WLANs for NSWO\" provided by the HPLMN are available.
i) If at least one of these WLANs is available, then the UE selects the
\"active\" ISRP rule from the rules provided by the HPLMN and selects a WLAN
based on the \"WLANs for NSWO\" included in this rule.
Editor\'s note: If the \"active\" ISRP rule from the HPLMN contains rules for
IFOM and/or MAPCON, it is FFS if the UE uses these rules for subsequent
routing decisions.
ii) If none of these WLANs is available, then the UE selects the \"active\"
ISRP rule from the rules provided by the VPLMN. When the UE determines that at
least one of the \"WLANs for NSWO\" provided by the HPLMN becomes available,
it operates as in bullet i) above.
Editor\'s note: It is for FFS if the last bullet ii) needs further
consideration as the change of the \"active\" ISRP rule may result in a
service disruption.
Editor\'s note: It is FFS if the configuration to prefer WLANs from the HPLMN
is also applicable when the UE uses ISMP rules.
Editor\'s note: It is FFS if the above solution can work without the need to
configure the UE to \"prefer WLANs provided by the HPLMN\".
### 6.3.4 Preferred Service Providers List
The ANDSF MO is enhanced to include a Preferred Service Providers List (PSPL)
that contains a list of 3GPP service providers preferred by the UE\'s 3GPP
home operator. This list is used by the UE (i) to construct a NAI when it
attempts EAP-AKA authentication over a selected WLAN access network and (ii)
to select a WLAN access network when there are multiple WLANs available that
best match the preferences in the \"active\" ISMP/ISRP rule.
PSPL contains 3GPP Service providers that can be identified as realms,
possibly with the domain name derived from a PLMN ID. This allows a UE to
select the preferred 3GPP service provider to authenticate with upon selecting
WLAN based, among other information, on the list of 3GPP service providers
that the UE may discover from the WLAN AP, e.g. by means of HS2.0 ANQP query
if the AP is HS2.0 capable.
The UE uses the PSPL to identify whether a 3GPP service provider is an
equivalent HPLMN or a 3GPP roaming partner.
The PSPL also contains a policy whether or not a UE prefers the 3GPP RPLMN
also for WLAN access. If the policy is set to \"prefer 3GPP RPLMN\" and the
active ANDSF rule is provided by the 3GPP RPLMN, the UE selects the 3GPP RPLMN
(or a PLMN equivalent to 3GPP RPLMN) as the PLMN selected for WLAN access. If
the active ANDSF rule is provided by another PLMN than the current 3GPP RPLMN,
or the policy is not set, the UE uses the PSPL as described above.
The Preferred Service Providers List (PSPL) is always provided by the HPLMN
through H-ANDSF or can be statically provisioned in the UE. The UE shall
ignore the PSPL information provided by the V-ANDSF, if any. If the UE has
both an MO from the V-ANDSF and the H-ANDSF, the UE uses only the PSPL of the
H-ANDSF MO.
NOTE: The data structure of the PSPL will be defined by stage 3.
## 6.4 Solution #4: ANDSF-based enhanced I-WLAN selection procedure
### 6.4.1 Overview
The solution addresses Key Issue #5 (Interaction between WLAN network
selection and network-provided policies for WLAN selection).
Background:
\- In existing TS 24.234 [4] specification, WLAN selection is made of the
combination of I-WLAN selection and PLMN selection procedures, where the
I-WLAN selection procedure is used to assist the Service Provider / PLMN
selection procedure. According to clause 5.2.1, the UE scans - in a specified
order, which depends on the HPLMN Priority Indication - prioritized lists of
WLANs that are stored in the SIM/USIM and/or in the ME and for each available
WLAN in the order of the candidate WLAN list, PLMN selection procedure
described in clauses 5.2.3 and 5.2.4 applies. Scanning stops when the best
PLMN is found.
\- The PLMN selection procedure can be automatic or manual. Automatic mode
PLMN selection procedure uses a predefined algorithm described in TS 24.234
[4] clauses 5.2.3 and 5.2.4, which depends on the HPLMN Priority Indication
and utilizes a few parameters stored in the SIM/USIM or in the ME, such as
Last Registered PLMN, EHPLMN list, HPLMN, User Controlled PLMN Selector and
Operator Controlled PLMN Selector.
The solution consists in:
\- Re-using from I-WLAN procedure (TS 24.234 [4]) only the PLMN selection
algorithm as it is specified in TS 24.234 [4] clauses 5.2.3 and 5.2.4, but
where:
\- the \"Operator Controlled PLMN Selector for I-WLAN access\" input is
replaced by the \"Service provider List\" provided by the ANDSF, and
\- the candidate list of WLAN AN is not coming from I-WLAN MO but provided by
ANDSF.
Therefore, I-WLAN MO is not used in the proposed solution.
\- Derivation of the candidate list of WLANs can be performed by running the
active ANDSF WLANSP rule that provides a list of accesses ordered by \"access
priority\". A list of preferred accesses can be built ordered by a
\"preference\", the same way as in solution #10.
\- The \"Service Provider List\" can be provided by adding to the H-ANDSF root
a node object containing the ordered list of operator controlled PLMNs. The
Preferred Service Provider List (PSPL) is added to the ANDSF MO the same way
as described in Solution #10.
\- The main difference from solution #10 is that there is no selection of a
WLAN without taking into account the PLMN priorities. In other words, finding
a WLAN with the best priority PLMN is more important than selecting the best
match WLAN.
### 6.4.2 Selection of Active ISMP/ISRP rule and WLANSP rule
The UE may be provisioned with multiple valid ISMP, ISRP and WLANSP rules. Out
of all these valid rules the UE selects and applies only two rules: one ISMP
or ISRP rule and one WLANSP rule. The UE selects the active ISRP/ISMP rule and
WLANSP rule in the same way as described in solution #10.
### 6.4.3 Preferred Service Providers List
The _Preferred Service Provider List_ (PSPL) is added to the ANDSF MO the same
way as described in solution #10, clause 6.10.5.
### 6.4.4 WLAN and PLMN selection based on WLANSP and PSLP
The UE discovers the available WLANs and builds a candidate WLAN list in
priority order based on the \"active\" WLANSP rule. e.g.
\- WLAN-1 (priority 1)
\- WLAN-4, WLAN-2 (priority 2)
\- WLAN-3 (priority 3)
After the candidate list of WLAN ANs is built thanks to ANDSF, the UE follows
the PLMN selection procedure defined for I-WLAN architecture except that the
ANDSF based candidate list of WLANs is used instead of the WLAN Specific
Identifier lists defined for I-WLAN in TS 24.234 [4]. An overview of the
I-WLAN network selection procedure can be found in Annex A. Note that a UE
implementation can easily perform scanning and discovery of supported realms
of the available HS2.0 capable WLANs in a single step.
For EAP-AKA authentication the UE constructs a NAI based on the preferred
service provider that was used to select the WLAN. e.g.
\- NAI = \@\, if the selected WLAN interworks with the
HPLMN; or
\- NAI = \\@\, if the selected WLAN
interworks with PSP-A
NOTE: The UE performs the WLAN selection based on the active WLANSP rule (as
described above) without taking into account real-time events associated with
the active ISRP rule. For example, when a new IP flow in the UE matches the
traffic selector in the active ISRP rule, this event should not trigger WLAN
re-selection. If the conditions for WLAN selection change every time a new
application runs or when certain IP flows are detected, the WLAN selection in
the UE will be complex and may lead to frequent WLAN re-selections that would
negatively affect the user experience and the battery consumption.
For better understanding of how WLAN selection works in this solution, if
thresholds on specific parameters (e.g. load) are added to ANDSF rules, WLANs
with a value of the specific parameter exceeding the ANDSF thresholds
corresponding to that parameter are excluded from the list of candidate WLANs.
The above Preference can take into account the WLAN specific parameter value
in order to build a WLAN list whose order takes that WLAN parameter into
account, however in this solution the best PLMN has higher weight than WLAN
specific parameters, which may lead the UE to select a WLAN that is not the
best with regards to that parameter (although satisfying the ANDSF
thresholds).
### 6.4.5 Summary
The solution:
\- reuses existing PLMN selection process in I-WLAN selection (TS 24.234 [4]);
\- does not impact PLMN selection algorithms;
\- allows ANDSF to trigger a PLMN change;
\- allows more intelligent WLAN selection to help to form a more optimized
candidate WLAN list for PLMN selection, since ANDSF will select a WLAN or a
set of WLANs based on e.g. the existing validity areas, time of the day, etc.
;
\- satisfies manual PLMN selection and operator controlled PLMN selection:
allows the user and the operator to force the UE to prefer a WLAN that can
access a desired user selected or operator controlled PLMN.
### 6.4.6 Impacts on existing nodes or functionality
Impacts on the UE: implementing ANDSF changes; reuse existing PLMN selection
algorithms (TS 24.234 [4]) unchanged.
### 6.4.7 Evaluation
## 6.5 Solution #5: Provide both HS2.0 MO and ANDSF MO to the UE
### 6.5.1 Relation to key issues and other solution alternatives
This solution addresses key issue 1, 2, 4, 7 and 8.
The ANDSF policies are extended to include also HS2.0 policies. Three
principles are possible for how to extend the ANDSF MO with policies related
to HS2.0:
1\. Provide both HS2.0 MO and ANDSF MO to the UE.
2\. ANDSF Management Object enhanced with policies related to information
elements available in HS2.0 Release 1.
3\. ANDSF MO includes (possibly several different copies of) relevant parts of
HS2.0 MO.
The alternative 1 solution is described below. The alternatives 2 and 3 are
described in clauses 6.6 and 6.7 respectively.
### 6.5.2 Description
In this solution both HS2.0 MO and ANDSF MO is provided to the UE.
**Principles:**
A 3GPP operator provides both the ANDSF policies and the HS2.0 policies to a
3GPP UE. Both ANDSF MO and HS2.0 MO may be provided by the ANDSF Server. This
is illustrated in Figure 6.5.2-1 below.
Figure 6.5.2-1: ANDSF Server provides both ANDSF MO (with ISMP, ISRP etc.) and
HS2.0 MO to the UE. Only the relevant subset of the HS2.0 MO would be used /
populated
This UE may then evaluate the policies as follows:
The terminal will first evaluate the ANDSF ISMP or ISRP. If the highest
priority access technology is WLAN, the UE will select an AP (if any)
satisfying the HS2.0 policies.
This implies for example:
\- the load of the AP is less than the Maximum BSS load threshold,
\- at least one of the FQDN announced by the AP in Domain Name List is
included in the PreferredRoamingPartnerList,
\- WAN Metric fulfils the MinimumBackhaulBandwidth policy.
NOTE 1: The full set of HS2.0 policies are defined by Wi-Fi Alliance HS2.0
Release 2.
When an operator wishes that the UE selects the WLAN access network according
to the HS2.0 policies such as BSS load, domain name list etc., there are two
options for how to handle the WLAN Access Network Identity information for
WLAN (SSID, HESSID) currently available in the ISRP/ISMP:
\- If WLAN Access Identity info (SSID etc.) is not provided in ISRP/ISMP, WLAN
access NW selection is completely up to HS2.0 MO, taking into account HS2.0 MO
policy such as BSS load, etc.
\- If WLAN Access Identity info (SSID etc.) is provided in ISRP/ISMP, the UE
would apply the HS2.0 MO and try to select an AP only for the SSID / HESSID
/BSSID contained in the prioritized access selected from ISMP/ISRP.
If the corresponding HS2.0 policies are not fulfilled the terminal will
consider that this ANDSF prioritized access as not valid. The UE will then go
on to evaluate the next access in the prioritized access list, For example,
the next prioritized access can be another WLAN access network with another
SSID, which will be also tested against HS 2.0 policies.
There ANDSF Server will only provide to the UE that subset of the HS2.0 MO
that is relevant to a 3GPP operator.
NOTE 2: If HS2.0 MO is not provided to the UE, the legacy ANDSF behaviour
applies (e.g. with SSID in ISRP/ISMP).
### 6.5.3 Impacts on existing nodes or functionality
The ANDSF MO need to be extended to included additional policies related to
HS2.0 parameters.
### 6.5.4 Evaluation
**Advantages:**
\- No dependency between 3GPP ANDSF work and Wi-Fi Alliance HS2.0 work.
Policies defined by any future extensions of HS20 Rel‑2 MO in WFA will
automatically be applicable to 3GPP scenarios as well.
\- Minimal work needed in the UE on top of the current TS 24.312 [3]
implementation and the HS20 implementation.
**Disadvantages:**
\- HS2.0 policies are \"global\". It is not possible to have HS2.0 policies
with validity conditions defined by ANDSF (e.g. time-of-day, validity area) to
make more \"intelligent\" WLAN network selection. In order to add validity
conditions to the HS2.0 MO, 3GPP would need to work with Wi-Fi Alliance for
enhancing HS2.0 to support validity conditions. . This would make any work
progress in 3GPP dependent upon WFA discussions and agreements.
\- Anything not covered by HS20 Rel‑2 (e.g. access network type and venue
information as discussed in key issue #7) needs special solution. May still
need ANDSF MO extensions.
\- It needs to be ensured that the two MOs are configured in a consistent way.
This could e.g. however be handled by the ANDSF Server providing both MOs to
the UE.
The solution alternative addresses the key issues in the following way:
\- Key issue 1 Support WLAN access through roaming agreements:
\- The roaming consortium OIs of the home operator, as well as preferred
roaming partner realms would be included with the HS2.0 Management Object.
\- Key issue 2: Delivery of consistent information for WLAN network selection:
\- Inconsistencies between ANDSF policies and HS2.0 policies are resolved by
the ANDSF Server populating the two MOs in such a way that the resulting
policy is consistent. More analysis may be needed to determine what subset of
the ANDSF MO and/or HS2.0 MO can be provided to the UE.
\- Key issue 4: Use WLAN load Information for network selection:
\- The policies for Max BSS load threshold as well as backhaul link speed
would be included with the HS2.0 MO policy.
\- Key issue 7: Use WLAN Access Network Type and Venue Information for network
selection:
\- Policies for WLAN Access Network Type and Venue Information are not
included in HS2.0 MO in HS2.0 release 2. If 3GPP concludes that it is
desirable to include such policies, 3GPP could liaise with Wi-Fi Alliance for
inclusion into the HS2.0 MO in a later release. In order to keep 3GPP and Wi-
Fi Alliance policies related to HS2.0 aligned, it is proposed to not introduce
these policies in ANDSF outside of the HS2.0 policies.
\- Key issue 8: Use Connection Capability during WLAN network selection:
\- The policies for connection capability would be included with the HS2.0 MO
policy.
## 6.6 Solution #6: ANDSF MO enhanced with policies related to information
elements available in HS2.0 Release 1
### 6.6.1 Relation to key issues and other solution alternatives
This solution addresses key issue 1, 2, 4, 7 and 8.
The ANDSF policies are extended to include also HS2.0 policies. Three
principles are possible for how to extend the ANDSF MO with policies related
to HS2.0:
1\. Provide both HS2.0 MO and ANDSF MO to the UE.
2\. ANDSF Management Object enhanced with policies related to information
elements available in HS2.0 Release 1.
3\. ANDSF MO includes (possibly several copies of) the HS2.0 MO (full HS2.0 MO
or a subset).
The alternative 2 solution is described below. The alternatives 1 and 3 are
described in clause 6.5 and 6.7 respectively.
### 6.6.2 Description
In this solution, the ANDSF Management Object is enhanced with policies
related to information elements available in HS2.0 Release 1.
**Principles:**
3GPP extends the existing ANDSF policies with new policy elements based on
HS2.0 Release 1 information. This is decoupled from the policies defined by
WFA for HS2.0 Release 2.
For example, 3GPP may add different policies than those contained in HS2.0 R2
and may also use different definitions compared to what Wi-Fi Alliance uses in
the HS2.0 MO
Such 3GPP-defined policies could be put, e.g.
\- in the ISRP and ISMP as extensions to the prioritized access descriptions
for the case where the access technology is WLAN; or
\- in a new sub-tree (e.g. called WLANSP) in the ANDSF Management Object,
separate from ISMP and ISRP.
**For example:**
\- To address key issue #4, BSSLoadThreshold,
MinimumBackhaulAvailableBandwidthThreshold could be added to ANDSF MO.
\- To address key issue #1: NAI Realms, RoamingConsortiumOI could be used as
new values in to identify access network in addition to SSID. In this case the
SSID or HESSID currently provided with the ISRP/ISMP do not need be
provisioned.
\- To address key issue #7 and #8, policies related to WLAN access network
type, Venue Information and Connection Capability may be added directly to the
ANDSF MO.
NOTE: We expect it is too late to have HS2.0 include such elements to the
HS2.0 MO defined as part of HS2.0 Rel‑2.
An example where new policies are included as an extension to the ISMP is
illustrated in Figure 1 below (note that the figures are only for
illustration, the details would be specified by stage 3).
Figure 6.6.2-1: Example of \"enhanced\" ISMP policy where new policies are
included as a new sub-tree (right) and as an extension to the ISRP (left)
For policies defined in HS2.0 MO, 3GPP could choose to simply copy-paste the
definition into ANDSF MO. This would simplify UE implementation since each
policy is defined in the same way in both HS2.0 MO and ANDSF MO. Alternatively
3GPP could make its own definitions of the ANDSF policies which may however
result in different policy definitions in 3GPP and Wi-Fi Alliance for the same
HS2.0 parameter(s).
For policies related to parameters available in HS2.0 Release 1, but not
included in the HS2.0 MO, 3GPP needs to make its own definition.
### 6.6.3 Impacts on existing nodes or functionality
The ANDSF MO need to be extended to included additional policies related to
HS2.0 parameters.
### 6.6.4 Evaluation
**Advantages:**
\- Full flexibility in 3GPP to define WLAN selection policies.
\- Possible to make use of ANDSF validity conditions, priorities etc. also for
policies related to HS2.0 capabilities.
\- Policies not covered by HS20 Rel‑2 (e.g. access network type and venue
information as discussed in key issue #7) could be added in similar way. No
need to wait for WFA.
**Disadvantages:**
\- Risk for diverging policy definitions. HS2.0 MO policies defined by any
future extensions of HS2.0 Rel‑2 in WFA will not automatically be applicable
to 3GPP scenarios as well, and may conflict with HS2.0-related policies
already defined by 3GPP. If the UE implementation wants to fulfil both HS2.0
specifications and ANDSF specifications, then different policy definitions
will cause increased implementation complexity.
The solution alternative addresses the key issues in the following way:
\- Key issue 1 Support WLAN access through roaming agreements:
\- The ANDSF MO can be extended to include policies related to e.g. roaming
consortium OIs of the home operator.
\- Key issue 2: Delivery of consistent information for WLAN network selection:
\- Inconsistencies between ANDSF policies and HS2.0 policies may be introduced
if 3GPP defines ANDSF policies without taking HS2.0 policies into account.
\- Key issue 4: Use WLAN load Information for network selection:
\- The ANDSF MO can be extended to include policies for Max BSS load threshold
as well as backhaul link speed.
\- Key issue 7: Use WLAN Access Network Type and Venue Information for network
selection:
\- The ANDSF MO can be extended to include policies for WLAN Access Network
Type and Venue Information.
NOTE: These are however not included in HS2.0 MO in HS2.0 release 2.
\- Key issue 8: Use Connection Capability during WLAN network selection:
\- The ANDSF MO can be extended to include policies for connection capability.
## 6.7 Solution #7: ANDSF MO includes instances of the HS2.0 MO
### 6.7.1 Relation to key issues and other solution alternatives
This solution addresses key issue 1, 2, 4, 7 and 8.
The ANDSF policies are extended to include also HS2.0 policies. Three
principles are possible for how to extend the ANDSF MO with policies related
to HS2.0:
1\. Provide both HS2.0 MO and ANDSF MO to the UE.
2\. ANDSF Management Object enhanced with policies related to information
elements available in HS2.0 Release 1.
3\. ANDSF MO includes relevant parts of HS2.0 MO.
The alternative 3 solution is described below. The alternatives 1 and 2 are
described in clauses 6.5 and 6.6 respectively.
### 6.7.2 Description
In this solution the ANDSF MO is enhanced to include relevant parts of HS2.0
MO.
**Principles:**
Instances of the HS2.0 policies (in format defined by HS2.0) are included
(copy-and-pasted) into the ANDSF Management Object.
Such instances can be put, e.g.
\- In the ISRP and ISMP as extensions to the prioritized access descriptions
for the case where the access technology is WLAN; or
\- In a new sub-tree (e.g. called WLANSP) in the ANDSF Management Object,
separate from ISMP and ISRP. Such a sub-tree would be dedicated for selecting
WLAN access network. Validity conditions (e.g. time-of-day and validity area)
should be added to that sub-tree to define under what conditions the HS2.0
policies are applicable to allow a more \"intelligent\" WLAN network
selection. No traffic descriptors (IP filters etc.) would however be included
in such a separate sub-tree.
An example of this alternative for the case when the HS2.0 MO is included in a
new sub-tree is shown in Figure 3 below (note that the figures are only for
illustration, the details would be specified by stage 3).
Figure 6.7.2-1: Example of enhanced ANDSF MO where HS2.0 MOs are included in a
new sub-tree (right) and where the HS2.0 MO is included in the ISRP (left).
Only the relevant subset of the HS2.0 MO would be used/ populated
The terminal will first evaluate the ANDSF ISMP or ISRP. If the highest
priority access technology is WLAN, the UE will select the WLAN AP according
to the related instance of the HS2.0 policies, i.e. HS2.0 policies located in
the prioritized access description of the active ISMP/ISRP rule, or located in
the active WLANSP rule.
When operator wishes that the UE selects the WLAN access network according to
the BSS load, domain name list, etc., there are two options for how to handle
the WLAN Access Network Identity information for WLAN (SSID, HESSID) currently
available in the ISRP/ISMP:
\- If WLAN Access Identity information (e.g. SSID etc.) is not provided in
ISRP/ISMP, WLAN access NW selection is completely up to the related instance
of the HS2.0 policies, taking into account HS2.0 MO policy such as BSS load,
etc.
\- If WLAN Access Identity information (e.g. SSID etc.) is provided in
ISRP/ISMP, the UE would apply the related instance of the HS2.0 policies and
select an AP corresponding only to the SSID / HESSID /BSSID contained in the
prioritized access selected from ISMP/ISRP.
Possibly some of the HS2.0 MO is not relevant for a 3GPP operator and/or may
cause conflict with other 3GPP-defined policies. 3GPP should analyze what
parts of the HS2.0 MO should be included with the ANDSF policies. Part of this
analysis could possibly be done together with CT1. The ANDSF Server will only
include the subset of the HS2.0 MO that is relevant to a 3GPP operator.
### 6.7.3 Impacts on existing nodes or functionality
Instances of the HS2.0 policies (in format defined by HS2.0) are included
(copy-and-pasted) into the ANDSF Management Object.
### 6.7.4 Evaluation
**Advantages:**
\- Minimal dependency between 3GPP ANDSF work and Wi-Fi Alliance HS2.0 work.
Policies defined by any future extensions of HS2.0 Rel‑2 MO in WFA can easily
be applicable to 3GPP scenarios as well.
\- Possible to make use of ANDSF validity conditions, priorities etc. also for
policies related to HS2.0 capabilities.
\- HS2.0 and ANDSF WLAN policy definitions kept aligned. If the UE
implementation wants to fulfil both HS2.0 specifications and ANDSF
specifications, the methods for selecting WLAN access network are re-usable.
**Disadvantages:**
\- If 3GPP desires to include anything not covered by HS2.0 Rel‑2 (e.g.
policies for venue type information) it needs to define how to integrate such
information directly into the ANDSF MO, or work in Wi-Fi Alliance to extend
the HS2.0 MO. This can make work progress in 3GPP dependent upon WFA
discussions and agreements
NOTE: Due to HS2.0 deadlines, we expect it is too late to have HS2.0 include
such elements to the HS2.0 MO. However, such elements can be included in the
ANDSF MO and possibly integrated in HS MO in release 3.
The solution alternative addresses the key issues in the following way:
\- Key issue 1 Support WLAN access through roaming agreements:
\- The roaming consortium OIs of the home operator, as well as preferred
roaming partner realms would be included with the HS2.0 Management Object.
\- Key issue 2: Delivery of consistent information for WLAN network selection:
\- Inconsistencies between ANDSF policies and HS2.0 policies are resolved by
integrating the HS2.0 MO with the ANDSF MO. More analysis may be needed to
determine if the full HS2.0 MO or a subset of the HS2,0 MO is reasonable to
include in the ANDSF MO.
\- Key issue 4: Use WLAN load Information for network selection:
\- The policies for Max BSS load threshold as well as backhaul link speed
would be included with the HS2.0 MO policy.
\- Key issue 7: Use WLAN Access Network Type and Venue Information for network
selection:
\- Policies for WLAN Access Network Type and Venue Information are not
included in HS2.0 MO in HS2.0 release 2. If 3GPP concludes that it is
desirable to include such policies, 3GPP may add Venue Information and
Connection Capability directly to ANDSF MO. Alternatively in order to keep
specifications in line with future releases of HS specifications, 3GPP could
liaise with Wi-Fi Alliance for inclusion into the HS2.0 MO in a later release.
\- Key issue 8: Use Connection Capability during WLAN network selection:
\- The policies for connection capability would be included with the HS2.0 MO
policy.
## 6.8 Solution #8: Load and QoS information for network selection
### 6.8.1 Description
This solution addresses Key Issue # 4 - Use WLAN load Information for network
selection.
As described in Key Issue #4, the WFA Hotspot 2.0 specifications mandate an
HS2.0 AP to support the BSS load information element (in the beacon) and the
WAN metrics ANQP elements. Both BSS Load information and WAN metrics,
obtainable through ANQP requests, when available, can be used by the UE before
WLAN selection is performed.
However, BSS load itself does not provide a direct measure of achievable
service over the WLAN network, since additional parameters (e.g. path loss,
interference conditions) are needed in order to determine the achievable
throughput over the air interface, which, together with the available backhaul
throughput will provide a more accurate figure to determine the achievable
service offered.
In the context of switching to/from a 3GPP network, the UE should only switch
to the WLAN network when the achievable service (i.e. throughput) on the WLAN
will be above a minimum desired level (e.g. as characterised by the user
subscription information or the minimum service level expected on cellular).
The definition of minimum service is defined by an operator policy within
ANDSF MO and takes into consideration the backhaul status (in the form of
achievable backhaul throughput), as well as air interface throughput.
Once the UE has selected the WLAN AP, it can evaluate the achieved throughput
in order to determine whether to stay on the WLAN AP. In order to avoid ping-
pong, the UE should stay for a minimum amount of time (indicated as part of
the operator policy) on the selected AP even if the desired service level is
not met.
In order to interpret the operator defined policy, the UE should be able to
estimate the achievable throughput (DL/UL) on the target WLAN AP as the
minimum of the achievable air interface throughput and achievable backhaul
throughput:
**Achievable Throughput = min (achievable air i/f throughput, achievable
backhaul throughput)**
Where the **Achievable air interface throughput will be** a function of the
air interface physical layer capability (which depends on UE and AP
capabilities), BSS load information, received RSSI level for the AP and
current interference levels. An implementation should be able to estimate what
air interface throughput a UE can expect to get under such observed
conditions.
UE should also be able to estimate the **Achievable backhaul throughput**
considering ANQP WAN metrics information and additionally information from BSS
load information element like the number of associated UEs on the BSS. The
details of working out the achievable backhaul throughput are left to UE
implementation.
NOTE: It is assumed that the UE implementations will not be specified and thus
not harmonized, however, it is expected that the estimations of the achievable
throughputs will not differ substantially from one UE implementation to
another, since the parameters taken into account are the same.
### 6.8.2 Impacts on existing nodes or functionality
The ANDSF MO (both ISMP and ISRP) needs to be extended in order to include new
validity conditions in the form of minimum acceptable uplink and downlink
throughput thresholds, used to compare with the achievable throughput which UE
can derive from the available BSS load information and WAN metrics information
from the WLAN AP and achieved throughput thresholds which UE can evaluate once
connected to the WLAN AP.
Editor\'s note: It is FFS whether an evaluation time needs to be added to the
ANDSF MO to be used by the UE for hysteresis handling.
The details of the thresholds policy, i.e. node, leaf, etc, will be defined in
stage 3.
### 6.8.3 Evaluation
## 6.9 Solution #9: ANDSF Policies with WLAN load information
### 6.9.1 Description
This solution addresses the key issue #4, \"Use WLAN load information for
network selection\".
It is proposed to extend the ANDSF policies to support the selection policies
based on the WLAN Load information which can be supported by WLAN networks.
Currently, there are two metrics related to the load condition in WLAN, BSS
load element and WAN metrics. The BSS load element corresponds to the
information on the actual access channel between UE and WLAN AP, whereas the
WAN metrics are link related information between WLAN AP and WAN. Prior to
association, the UE is capable to obtain the BSS load element of a specific
WLAN by receiving the beacon frame and the WAN metrics by using the ANQP
procedure.
The ANDSF may send policies to UE based on WLAN load information. With these
policies, the UE uses the WLAN load level to determine whether the discovered
WLAN access networks can be used without a severe degradation in user
experience or not.
Load condition on the WLAN may be specified as access network selection
condition. Similar to PerProviderSubscription MO defined by HS 2.0, the
extended ANDSF rules may have the WLAN load condition(s) which can be
described by BSS load element or WAN metrics. The load value(s) in the rule
should be used as threshold value(s) to decide whether the access network can
be a candidate for the traffic offloading or not. That is, when the WLAN (or
BSS) cannot meet the load condition(s), it should be eliminated from the
candidate for access network selection.
### 6.9.2 Impacts on existing nodes or functionality
The ANDSF access selection policies need to be extended in order to include
additional selection condition based on WLAN load.
### 6.9.3 Evaluation
## 6.10 Solution #10: WLAN selection based on WLANSP rules
### 6.10.1 Overview
This solution extends the ANDSF MO to include a new set of rules and describes
how a UE uses these rules for selecting the most preferred WLAN access
network. The following extensions to the ANDSF MO are specified:
1\. A _Preferred Service Provider List_ (PSPL) node is added to the ANDSF MO
that contains a list of service providers preferred by the home operator.
These service providers support AAA interworking with the HPLMN and can be
used to authenticate the UE with EAP-AKA. This node is included only by the
home ANDSF. The use of PSPL is described in clause 6.10.5.
2\. A _PreferVplmnWlans_ node is added to the ANDSF MO that can contain a list
of PLMNs. When the UE is roaming to one of these PLMNs, the UE is configured
to prefer WLAN access networks policies provided by this VPLMN over the WLANs
provided by the HPLMN. When the UE is roaming to any other PLMN, the UE is
configured to prefer WLAN access networks policies provided by the HPLMN.
3\. A new _WLAN Selection Policy_ (WLANSP) node is added to the ANDSF MO. This
node includes one or more WLANSP rules, each one specifying a priority value,
a set of validity conditions and list of a preferred WLAN attributes (such as
supported realms, BSS load, SSIDs, OUIs, etc.). The UE determines which WLANSP
rules are valid and selects one of these valid rules to apply, as specified in
clause 6.10.2. The applied WLANSP rule is used by the UE to select the most
preferred WLAN access network, as specified in clause 6.10.4.
It is also noted that:
1\. The Policy node (ISMP) in the ANDSF MO remains unchanged and it can still
include a prioritized list of 3GPP and WLAN access networks, e.g.: WLAN-A
priority 1, 3GPP priority 2, WLAN-B priority 3. This prioritized list is used
to define the relative priority of 3GPP access with respect to WLAN access or
with respect to certain WLAN access networks. How the UE uses the active ISMP
rule when it also has an active WLANSP rule is specified in clause 6.10.3.
a. If the prioritized list of access networks in an ISMP rule include only
WLAN access networks, this list is not used since WLAN selection is based on
WLANSP only.
2\. The ISRP node and the internal \"ForFlowBased\", \"ForServiceBased\" and
\"ForNonSeamlessOffload\" nodes in the ANDSF MO remain unchanged. So, the ISRP
rules for IFOM and for MAPCON can still include a prioritized list of 3GPP and
WLAN access networks, e.g.: WLAN-A priority 1, 3GPP priority 2, WLAN-B
priority 3. This prioritized list is used to define the relative priority of
3GPP access with respect to WLAN access or with respect to certain WLAN access
networks. How the UE uses the active ISRP rule when it also has an active
WLANSP rule is specified in clause 6.10.3.
a. If the prioritized list of access networks in an ISRP for IFOM rule or in
an ISRP for MAPCON rule include only WLAN access networks, this list is not
used for WLAN selection since WLAN selection is based on WLANSP only. The list
is still used by the UE to make IP traffic routing decisions.
b. The prioritized list of access networks in an ISRP for NSWO rule is not
used for WLAN selection since WLAN selection is based on WLANSP only. The list
is still used by the UE to make IP traffic routing decisions.
It is assumed that the active ISMP/ISRP rule in the UE can always be used to
determine the relative priority of the most preferred WLAN (selected based on
the active WLANSP rule) over 3GPP access.
### 6.10.2 Selection of active rules
The UE may be provisioned with multiple valid ISMP, ISRP and WLANSP rules. Out
of all these valid rules the UE selects and applies only two rules: one WLANSP
rule and either one ISMP or one ISRP rule. A rule applied by the UE is called
an \"active\" rule. Specifically:
\- A UE that cannot simultaneously route IP traffic over multiple radio
accesses selects an active ISMP rule and an active WLANSP rule.
\- A UE that can simultaneously route IP traffic over multiple radio accesses
selects an active ISRP rule and an active WLANSP rule.
When the UE is not roaming, it selects the active ISMP/ISRP rule and the
active WLANSP rule to apply from the valid rules provided by the HPLMN based
on the individual priorities of these rules (or based on other criteria
already specified in TS 24.312 [3]). For example, the highest priority valid
WLANSP rule is selected as the active WLANSP rule.
When the UE is roaming, it may have valid rules from both HPLMN and VPLMN. In
this case, the active ISMP/ISRP rule and the active WLANSP rule are selected
by the UE as follows:
a) The UE is configured to either \"prefer WLAN access networks policies
provided by the HPLMN\" or not. This configuration can be done either by the
user or by the home ANDSF via the PreferVplmnWlans node (see clause 6.10.1).
User configuration takes precedence over the home ANDSF configuration.
b) If the UE is configured not to prefer WLAN access network policies provided
by the HPLMN (i.e. the VPLMN to which the UE is registered is included in the
PreferVplmnWlans node), then the UE selects the active WLANSP rule and the
active ISMP/ISRP rule from the valid rules provided by the VPLMN.
c) If the UE is configured to prefer WLAN access networks policies provided by
the HPLMN (i.e. the VPLMN to which the UE is registered is not included in the
PreferVplmnWlans node), then the UE checks the WLANSP rule provided by the
HPLMN and determines if any of the WLAN access networks in this rule are
available.
i) If at least one of these WLAN access networks is available, then the UE
selects the active WLANSP rule and the active ISMP/ISRP rule from the valid
rules provided by the HPLMN (e.g. based on their priority values).
ii) If none of these WLAN access networks is available, then the UE selects
the active WLANSP rule and the active ISMP/ISRP rule from the valid rules
provided by the VPLMN. When the UE determines that at least one of the WLAN
access networks in the WLANSP provided by the HPLMN becomes available, it
operates as in bullet i) above and may re-select to such WLAN access network.
During power-up while UE has not registered to any PLMN, the UE considers the
WLANSP rules provided by the HPLMN as valid and selects an active WLANSP rule
as described above (e.g. the one with the highest priority). Thus during
power-up the UE can select a WLAN network based on the WLANSP rules provided
by HPLMN.
### 6.10.3 Interactions between active rules
After the UE selects an active ISMP/ISRP rule and an active WLANSP rule as
described in the previous clause, the UE behaves as follows:
(i) If the UE selects an active ISMP rule because it cannot simultaneously
route IP traffic over multiple radio accesses:
\- The UE uses the active ISMP rule to determine if EPC connectivity is
preferred over WLAN access or over 3GPP access.
\- If EPC connectivity is preferred over WLAN access (i.e. the highest
priority access in the active ISMP rule corresponds to WLAN access
technology), the UE uses the active WLANSP rule to determine the most
preferred available WLAN access network (as specified in clause 6.10.4).
\- If the most preferred available WLAN access network has higher priority
than 3GPP access (according to the prioritized accesses in the active ISMP
rule), then the UE connects to EPC over the most preferred available WLAN
access network. Otherwise, the UE connects to EPC over 3GPP access. For
example:
\- If the prioritized access networks in the active ISMP rule are the
following: WLAN-A priority 1, 3GPP priority 2, WLAN-B priority 3; then
\- The UE determines that EPC connectivity is preferred over WLAN access
because a WLAN access network (WLAN-A) has higher priority than 3GPP access.
\- Subsequently, the UE uses the active WLANSP rule to determine the most
preferred available WLAN access network (as specified in clause 6.10.4).
\- If the most preferred available WLAN access network has lower priority than
3GPP access (e.g. WLAN-B), then the UE connects to EPC over 3GPP access.
\- If the most preferred available WLAN access network has higher priority
than 3GPP access (e.g. WLAN-A), then the UE connects to EPC over most
preferred available WLAN access network.
(ii) If the UE selects an active ISRP rule because it can simultaneously route
IP traffic over multiple radio accesses:
\- The UE uses the active WLANSP rule to select and connect to the most
preferred available WLAN access network as specified in clause 6.10.4.
\- If an IP flow matches an active ISRP for IFOM rule which contains a
prioritized list of access networks, then the UE determines if the selected
WLAN access network has higher priority than 3GPP access and routes the IP
flow accordingly. For example:
\- If the prioritized access networks in the active ISRP for IFOM rule are the
following: WLAN-A priority 1, 3GPP priority 2, WLAN-B priority 3; then
\- If the UE has selected WLAN-B (or any WLAN network with lower priority than
3GPP access), it routes the IP flow over 3GPP access.
\- If the UE has selected WLAN-A (or any WLAN network with higher priority
than 3GPP access), it routes the IP flow over WLAN access.
\- If the UE attempts a PDN connection establishment for an APN that matches
an active ISRP for MAPCON rule and if this rule contains a prioritized list of
access networks, then the UE determines if the selected WLAN access network
has higher priority than 3GPP access and establishes the PDN connection
accordingly. For example:
\- If the prioritized access networks in the active ISRP for MAPCON rule are
the following: WLAN-A priority 1, 3GPP priority 2, WLAN-B priority 3; then
\- If the UE has selected WLAN-B (or any WLAN network with lower priority than
3GPP access), it establishes the PDN connection over 3GPP access.
\- If the UE has selected WLAN-A (or any WLAN network with higher priority
than 3GPP access), it establishes the PDN connection over WLAN access.
\- If an IP flow matches an active ISRP for NSWO rule the UE routes this IP
flow over the selected WLAN access network.
### 6.10.4 WLAN Selection based on WLANSP
The UE uses the active WLANSP rule to select the most preferred available WLAN
access network and then performs EAP-AKA/EAP-AKA\' authentication over this
WLAN access network (if EAP-AKA/EAP-AKA\' authentication is needed). This WLAN
selection is performed with the following steps.
i. Step 1: The UE discovers the available WLANs and puts them in priority
order based on the active WLANSP rule. E.g.
\- WLAN-1 (priority 1)
\- WLAN-4, WLAN-2 (priority 2)
\- WLAN-3 (priority 3)
ii. Step 2: The UE selects the WLAN with the highest priority (best match),
e.g. WLAN-1.
\- If there are multiple WLANs with the same highest priority, the UE selects
the WLAN that interworks with the most preferred service provider in the PSP
list.
iii. Step 3: For EAP-AKA//EAP-AKA\' authentication (if needed) the UE
determines from the PSP list which preferred service providers interwork with
the selected WLAN and constructs a NAI that corresponds to the most preferred
service provider. E.g.
\- NAI = \!\@\, if PSP-A is the most
preferred service provider that interworks with the selected WLAN.
NOTE 1: Step 3 above is only required when the UE decides to connect to the
most preferred WLAN access network that is determined in Step 2.
NOTE 2: The UE performs the WLAN selection based on the active WLANSP rule (as
described above) without taking into account real-time events associated with
the active ISRP rule. The active ISRP rule is used only for routing decisions
and does not impact the selection or reselection of the WLAN access network.
For example, when a new IP flow in the UE matches the traffic selector in the
active ISRP rule, this event should not trigger WLAN re-selection. If the
conditions for WLAN selection change every time a new application runs or when
certain IP flows are detected, the WLAN selection in the UE will be complex
and may lead to frequent WLAN re-selections that would negatively affect the
user experience and the battery consumption.
NOTE 3: Events such as change of WLAN load information, change of UE location,
change of time of day may lead to WLAN (re-)selection based on the WLANSP
rule.
### 6.10.5 Preferred Service Provider List
The Preferred Service Providers List (PSPL) contains a list of 3GPP service
providers preferred by the UE\'s 3GPP home operator. As specified above, this
list is used by the UE (i) to construct a NAI when it attempts EAP-AKA/EAP-
AKA\' authentication over a selected WLAN access network and (ii) to select a
WLAN access network when there are multiple WLANs available that best match
the preferences in the active WLANSP rule.
PSPL contains 3GPP Service providers that can be identified as realms,
possibly with the domain name derived from a PLMN ID. This allows a UE to
select the preferred 3GPP service provider to authenticate with upon selecting
WLAN based, among other information, on the list of 3GPP service providers
that the UE may discover from the WLAN AP, e.g. by means of HS2.0 ANQP query
if the AP is HS2.0 capable.
The UE uses the PSPL to identify whether a 3GPP service provider is an
equivalent HPLMN or a 3GPP roaming partner.
The PSPL also contains a policy whether or not a UE prefers the 3GPP RPLMN
also for WLAN access. If the policy is set to \"prefer 3GPP RPLMN\" and the
active ANDSF rule is provided by the 3GPP RPLMN, the UE selects the 3GPP RPLMN
(or a PLMN equivalent to 3GPP RPLMN) as the PLMN selected for WLAN access. If
the active ANDSF rule is provided by another PLMN than the current 3GPP RPLMN,
or the policy is not set, the UE uses the PSPL as described above.
The Preferred Service Providers List (PSPL) is always provided by the HPLMN
through H-ANDSF or can be statically provisioned in the UE. The UE shall
ignore the PSPL information provided by the V-ANDSF, if any. If the UE has
both an MO from the V-ANDSF and the H-ANDSF, the UE uses only the PSPL of the
H-ANDSF MO.
## 6.11 Solution #11: ANDSF policies with WLAN connection capability
information
### 6.11.1 Description
This solution addresses the key issue #8, \"Use Connection Capability during
WLAN network selection\".
Connection capability is specified by WFA Hotspot 2.0 specification to provide
information on the connection status within the WLAN network. The connection
capability of a WLAN network indicates the WLAN network that allows
communication on certain IP protocols and ports while blocks communication on
others. For example, a firewall or a NAT function in the WLAN network blocks
the IP flows associated with certain IP protocols and ports. Prior to
association, the UE is capable to obtain the connection capability of a
specific WLAN through the ANQP procedure.
It is proposed to extend the ANDSF policies to support the connection
capability of the WLAN networks defined in HS2.0 Release 1. The ANDSF server
sends ANDSF policies including WLAN connection capability information to UE.
The information contains the IP protocol and port tuples that are allowed by
the WLAN networks and/or the IP protocol and port tuples that are blocked by
the WLAN networks. Then the UE uses the connection capability information to
determine whether the discovered WLAN access networks can be the candidates
for access network selection.
### 6.11.2 Impacts on existing nodes or functionality
The ANDSF policies need to be extended in order to include additional
selection condition based on connection capability.
### 6.11.3 Evaluation
## 6.12 Solution #12: ANDSF MO enhanced with HS2.0 MO components and with
policies related to information elements available in HS2.0 Release 1
### 6.12.1 Relation to key issues and other solution alternatives
This solution addresses key issue 1, 2, 4, 7 and 8.
The ANDSF Management Object is enhanced with policies related to information
elements available in HS2.0 Release 1. At the same time the ANDSF MO may
include parts of the HS2.0 MO components as defined in HS2.0 Release 2.
### 6.12.2 Description
This solution proposes to use HS2.0 policies as deemed relevant, while 3GPP
can define its own extensions to the ANDSF MO using the information elements
available in HS2.0 release 1 as needed.
**Principles:**
3GPP extends the existing ANDSF policies with new policy elements based on
HS2.0 information.
NOTE: Which components of HS2.0 MO can be included into ANDSF MO will be
defined by the solutions of the individual key issues in which those
components of HS2.0 MO are relevant.
The principles are listed as follows:
1\. If HS2.0 MO has already defined the network selection policy corresponding
to information elements being considered by 3GPP, then 3GPP re-uses the
suitable components of HS2.0 MO in the 3GPP ANDSF MO.
2\. For policies related to information elements that are available in HS2.0
specifications and relevant to 3GPP, but for which there are no policy
components included in the HS2.0 MO, 3GPP defines its own policies in ANDSF
MO.
### 6.12.3 Impacts on existing nodes or functionality
The ANDSF MO needs to be extended to include additional policy elements
related to HS2.0 parameters.
### 6.12.4 Evaluation
**Advantages:**
\- Full flexibility in 3GPP to define WLAN selection policies.
\- Possible to make use of ANDSF validity conditions, priorities etc. also for
policies related to HS2.0 capabilities.
\- Policies not covered by HS20 Rel‑2 (e.g. access network type and venue
information as discussed in key issue #7) could be added in similar way. No
need to wait for WFA.
**Disadvantages:**
\- Risk for diverging policy definitions if there is no good collaboration
between WFA and 3GPP. HS2.0 MO policies defined by any future extensions of
HS2.0 Rel‑2 in WFA may not be applicable to 3GPP scenarios as well, and may
conflict with HS2.0-related policies already defined by 3GPP. If the UE
implementation wants to fulfil both HS2.0 specifications and ANDSF
specifications, then different policy definitions will cause increased
implementation complexity.
The solution alternative addresses the key issues in the following way as
examples:
NOTE: The final decision on what MO shall be used to address those individual
key issue will be concluded in each individual key issue\'s solution. The
followings are just examples.
\- Key issue 1 Support WLAN access through roaming agreements:
\- The ANDSF MO can be extended to include policies related to e.g. roaming
consortium OIs of the home operator.
\- Key issue 2: Delivery of consistent information for WLAN network selection:
\- Reuse of parts of HS2.0 MO will limit the inconsistencies in policy
elements between WFA HS2.0 MO and 3GPP ANDSF MO and may simplify UE
implementation.
\- Key issue 4: Use WLAN load Information for network selection:
\- The ANDSF MO can be extended to include the MaximumBSSLoadValue and
MinBackhaulThreshold sub-tree as defined in HS2.0 MO or define new policies
for Max BSS load threshold and backhaul link speed.
\- Key issue 7: Use WLAN Access Network Type and Venue Information for network
selection:
\- The ANDSF MO can be extended to include new policies defined by 3GPP for
WLAN Access Network Type and Venue Information.
\- Key issue 8: Use Connection Capability during WLAN network selection:
\- The ANDSF MO can be extended to include policies defined by HS2.0 MO for
connection capability or define new ANDSF policies if needed.
## 6.13 Solution #13: Enabling WLAN network selection without using Hotspot
2.0 dependent policies
### 6.13.1 Relation to key issues and other solution alternatives
This solution addresses key issues 1and 2.
Descriptions of existing solutions do not address the case of how to perform
WLAN network selection when HS2.0 dependent policies cannot be applied, e.g.
due to the fact there is no available WLAN AP that supports HS2.0, or an
operator would like to select WLAN networks without HS2.0 dependent policies.
This solution could be considered as an option (enhancement) to Solutions 5, 7
and 10.
### 6.13.2 Description
In this solution an approach for dealing with legacy (non HS2.0 capable WLANs)
is described both for the case where WLAN network selection is based around
information provided in ANDSF (ISMP/ISRP) as well as for the case where WLAN
network selection is performed based on information provided in a new ANDSF
WLAN_SP branch (see Solution 7).
##### WLAN network selection based on information provided in ISMP/ISRP
{#wlan-network-selection-based-on-information-provided-in-ismpisrp .H6}
Where WLAN network selection is performed based on information provided in
ISMP/ISRP WLAN network selection can be done by using only existing ANDSF WLAN
related rules or by referring to Release 12 enhanced ANDSF that utilizes HS2.0
dependent policies (with possible 3GPP specific extensions). The relative
importance between these alternatives can be defined by the operator using the
priority settings already defined in ANDSF. The reference to enhanced Release
12 ANDSF that utilized components of HS2.0 is made via a new \'HS2.0\' Access
Technology type in the existing PrioritizedAccess and RoutingRule nodes in the
ANDSF MO. The AccessTechnology leaf would need to be introduced also into NSWO
specific RoutingRule node. It would have two possible types: the existing
\'WLAN\' and a new \'HS2.0\' value.
If ANDSF policy indicates that the \'HS2.0\' is the next highest priority
network technology and all higher priority networks did not provide result for
the network selection then WLAN network selection is performed according to
the available enhanced Released 12 ANDSF that utilizes HS 2.0 dependent
policies.
If the device does not have HS2.0 capability or network selection logic is not
able to select a WLAN network based on available operator provided policies
that have HS 2.0 dependencies, then operator can define a set of SSIDs for
WLAN selection. According to this proposal if the next highest priority
network is WLAN then a WLAN is selected based on SSIDs provided in ANDSF
rules. In this way ANDSF can help in selecting legacy WLANs having no HS2.0
capabilities.
Actually with this approach an operator can create an arbitrary priority among
WLAN identified according to the legacy identifiers (SSID or HESSID) and WLAN
selection used based on Release 12 enhanced ANDSF that utilizes
HS2.0capabilities.
##### WLAN network selection based on information provided in WLAN_SP {#wlan-
network-selection-based-on-information-provided-in-wlan_sp .H6}
In the case of legacy WLAN\'s it is not possible for the device to query the
AP prior to authentication to determine what service providers are supported
by that AP. For this reason it can be useful if the operator supplies the
device with a list of SSID\'s since this can improve the speed and efficiency
with which the device can select a WLAN. For this reason the WLAN_SP branch
would also need to include a leaf which lists the operator preferred SSID\'s.
It is worth noting that all legacy WLANs (SSID\'s) would be of equivalent
priority from a network selection point of view, however, as in the case with
pre Release 12 3GPP releases, it may be useful for the operator to define an
order with which the device should query the legacy WLANs when determining the
supported SP\'s/PLMN\'s since this will sometimes enable a more efficient and
speedier network selection process.
NOTE 1: The applicability of the solution does not depend on how ANDSF is
enhanced to include HS2.0 aspects.
NOTE 2: 3GPP operator can only influence WLAN network selection when UE
applies 3GPP operator credentials for WLAN access.
NOTE 3: In the alternative approach where all the information relevant to WLAN
network selection is to be included in a new ANDSF branch (WLAN_SP) a new leaf
can be included that contains the access technology type with the same values
as AccessTechnology in current ISRPs. This new leaf enables the operator to
indicate whether the device should attempt to preferentially select an HS2.0
capable WLAN or a legacy WLAN (e.g. based on SSID). In this way the above
described WLAN network selection solution supporting the selection both HS2.0
and non-HS2.0 capable WLAN can be achieved.
### 6.13.3 Impacts on existing nodes or functionality
The AccessTechnology leaf in the ANDSF MO needs to be extended to include new
Access Technology type \'HS2.0\' for every AccessTechnology instance in the
ANDSF MO. AccessTechnology leaf needs to be added to
\/ISRP/\/ForNonSeamlessOffload/\/ RoutingRule/\/ to allow also
NSWO policy to choose whether to use legacy (pre-Rel‑12) WLAN network
selection or perform WLAN selection based on enhanced Release 12 ANDSF that
utilizes HS2.0 capabilities.
It should be possible for the operator to specify a list of SSID\'s that are
relevant for the purposes of selecting legacy WLANs.
### 6.13.4 Evaluation
**Advantages:**
\- WLAN network selection can also be performed based on ANDSF policies when
network selection based on enhanced Release 12 ANDSF that utilizes HS2.0
capabilities is not possible.
\- Backward compatibility.
**Disadvantages:**
\- In the case where information provided in ISMP/ISRP is to be used for WLAN
network selection, the Rel‑11 behaviour that ISRP/ISMP rules are not used for
WLAN selection is changed, as when the access technology is set to WLAN,
ISRP/ISMP rules are used for both selection and routing purposes.
## 6.14 Solution #14: H-ANDSF only provides realms corresponding to S2a
connectivity
### 6.14.1 Description
A simple solution is that, if the Home Operator considers that the UE needs to
only select WLANs that have S2a connectivity with the UE\'s HPLMN, H-ANDSF
only provides realms and/or SSIDs corresponding to WLANs that have S2a
connectivity with that HPLMN. It is assumed that a WLAN can be configured with
one set of Realms/SSIDs per PLMN it has S2a connectivity for.
In this solution, there is no need for the HPLMN to inform the UE that it
should select a WLAN with S2a connectivity with its HPLMN, as it is implicit.
Editor\'s note: It is FFS how in this solution a UE can select a WLAN that has
S2a connectivity with both the VPLMN PGW and the HPLMN PGW.
## 6.15 Solution #15: H-ANDSF provides UE with an indication on whether S2a
connectivity to the HPLMN is required
### 6.15.1 Description
Another solution is to use HS 2.0 Realms via differentiating Realms per
service type. For example
\- 3GPP-Service-Provider-Name-S2A.mnc480.mcc123 can be used to indicate that
the WLAN has S2a connectivity to PLMN mnc480.mcc123;
\- 3GPP Service Provider-Name-NSWO.mnc480.mcc123 can be used to indicate that
the only service is NSWO if the home PLMN is mnc480.mcc123.
In this solution, the coding of the Realm needs to have a particular coding in
order for the UE to recognize whether S2a connectivity to its Home PLMN is
supported by the WLAN or not.
### 6.15.2 How to inform the UE that it should select a WLAN with S2a
connectivity with its HPLMN?
The Home Operator can wish to configure a UE on whether the UE should select
WLANs with S2a connectivity or not. It is therefore necessary for the HPLMN to
provide an additional configuration indication to the UE. This additional UE
configuration indication could take two values:
\- \"HPLMN S2a connectivity not required\";
\- \"HPLMN S2a connectivity required\".
Editor\'s note: It is FFS how in this solution a UE can select a WLAN that has
S2a connectivity with both the VPLMN PGW and the HPLMN PGW.
## 6.16 Solution #16: Extension of ANQP with per-PLMN S2a connectivity
information
### 6.16.1 Description
This solution extends ANQP information defined by 3GPP or defined by HS2.0 to
provide, in addition to the existing list of PLMNs used for authentication and
specified in TS 24.234 [4], annex A (using IEEE Std 802.11u™-2011 Generic
Container), the list of PLMNs a WLAN has S2a connectivity with.
This could be implemented by adding to the Generic Container information in
ANQP (defined in TS 24.234 [4]) or by defining a new HS2.0 ANQP elements
containing a list of PLMNs the WLAN has S2a connectivity to. The solution
allows the UE to also determine, using ANQP queries, which available WLAN has
S2a connectivity to one or more specific PLMNs.
With such information, the UE will be able to select a WLAN that has
connectivity to its Home PLMN.
The solution is based on the following:
\- The WLAN advertises in ANQP responses the list of PLMNs that the WLAN has
S2a connectivity to;
\- The UE may query the WLAN about which PLMNs the WLAN has S2a connectivity
to.
In addition, a WLANSP rule from the H-ANDSF can contain following non-mutually
exclusive WLAN attributes used as selection criteria for the selection of the
WLAN:
\- Preference for WLANs that provides S2a connectivity to the HPLMN;
\- Preference for WLANs that provides S2a connectivity to the RPLMN.
These selection criteria are expected, as other selection criteria, to be
assigned a priority order: when preference to WLANs with S2a connectivity to
HPLMN and preference to WLANs with S2a connectivity to RPLMN are both set, and
if there is no WLAN providing S2a connectivity to both HPLMN and RPLMN, the
priority order allows to know whether S2a connectivity to HPLMN is more
important or less important than S2a connectivity to RPLMN.
The V-ANDSF does not contain these criteria that can only be set by the Home
Operator. The solution therefore assumes that in order to apply S2a preference
policies, the WLANSP used by the UE is provided by the HPLMN.
Based on the list advertised in ANQP and the UE S2a preferences in the
selection criteria, the UE prioritizes WLAN networks that support S2a
connectivity to the desired PLMN(s).
Figure 6.16.1-1: ANDSF rules for LBO services and ANQP connectivity
information for HR services
### 6.16.2 Void
# 7 Evaluation
Editor\'s note: This clause will provide evaluation of different solutions.
# 8 Conclusions
Editor\'s note: This clause will provide conclusions and what further
specification work is required for WLAN network selection for 3GPP terminals.
This clause contains the agreed conclusions for 3GPP specifications work.
1) ANDSF policies need to be enhanced to support WLAN selection based on
identifiers other than just SSIDs as described in solution #1 in clause 6.1.
Realms shall be added as additional identifiers when specifying all WLAN
selection policies in ANDSF.
2) ANDSF policies need to be enhanced to contain WLAN load thresholds in terms
of BSS load and WAN metrics for WLAN network selection. If available, Local
Operating Environment Information shall be considered, as specified in TS
24.302 [6].
3) The WLAN selection will be based on a new WLAN Selection Policy (WLANSP)
node in ANDSF. WLANSP is described in solution #10 in clause 6.10. The WLANSP
node should be specified and be aligned with the HS2.0 Policy node (see the
HS2.0 Rel-2 specification) as follows:
a) The overall structure of the WLANSP node shall be specified by 3GPP.
b) The WLANSP node should include the following sub-nodes which already exist
in the HS2.0 Policy node: _PreferredRoamingPartnerList,
MinimumBackhaulThreshold, MaximumBSSLoad, SPExclusionList_ ,
_RequiredProtoPortTuple_. These sub-nodes in WLANSP are not specified again
but they simply reference the corresponding HS2.0 Policy sub-nodes in the
HS2.0 Rel‑2 specification.
NOTE: The _MaximumBSSLoad_ defined in HS2.0 Rel-2 specification indicates the
maximum desired utilization of the air-interface channel and can be used to
prevent a UE from selecting an AP whose channel is overly congested with
traffic and/or interference. The _MinimumBackhaulThreshold_ defined in HS2.0
Rel-2 specification indicates the minimum desired bandwith of the backhaul in
the uplink and downlink direction, and can be used to prevent a UE from
selecting an AP that uses a backhaul with very limited bandwidth. The
_PreferredRoamingPartnerList_ includes a list of FQDNs.
c) The following sub-nodes defined in the HS2.0 Rel‑2 specification are not
applicable to 3GPP and shall not be included in the ANDSF MO:
_SubcriptionPriority, SubscriptionParameters_ , _Subscription Remediation_ ,
_SubscriptionUpdate_ , _AAAServerTrustRoot_ , _Credential_ , _PolicyUpdate_.
d) The WLANSP node can include 3GPP-specific sub-nodes which are not defined
in the HS2.0 Rel‑2 specification. Such sub-nodes are required to meet 3GPP-
specific requirements for WLAN selection and will be decided during the
normative specification work. They could include, for example, sub-nodes that
enable selection of non-HS2.0-compliant APs.
4) A Preferred Service Provider List (PSPL) node will be added to the ANDSF MO
that contains a list of service providers preferred by the home operator.
5) When the UE has valid 3GPP subscription credentials (i.e. a valid USIM) and
valid WLANSP policies, the UE will perform WLAN selection based on these
policies, the applicable user preferences and the corresponding procedures
specified by 3GPP. User preferences take precedence over the WLANSP policies.
6) WLAN selection shall be done based on solution #10 in clause 6.10.
7) The UE shall support discovery of WLANs that support S2a connectivity to
HPLMN, to RPLMN and to both HPLMN and RPLMN. This discovery is enabled by the
IEEE 802.11u Generic Container that indicates also the PLMNs to which S2a
connectivity is supported.
8) The UE may decide to select a WLAN that supports S2a connectivity to HPLMN,
to RPLMN or both to HPLMN and RPLMN. This decision is based on UE
implementation specific mechanisms and the \"S2a connectivity preference\"
provisioned in the UE by the home ANDSF (see details in clause 4.8.2b of TS
23.402 [9]).
9) When the UE attempts to select a WLAN that supports S2a connectivity to
HPLMN, to RPLMN or both to HPLMN and RPLMN, it shall use the procedure
specified in clause 4.8.2b of TS 23.402 [9].
###### ### Annex A: WLAN selection overview
This annex summarizes current stage 3 procedures for WLAN selection.
NOTE: The information in this section has not been reviewed by stage 3 groups.
It is provided for reference only and should not be used to generate other
material in the TR. Authors should consult appropriate stage 3 documents.
I-WLAN PLMN selection was developed in Release 6. The selection consists of
two steps:
\- WLAN selection;
\- PLMN selection.
The procedure is applicable to initial network selection (i.e. at WLAN UE
switch on) and upon recovery from lack of WLAN coverage. In this 2 step
process I-WLAN PLMN selection is based mainly on the optional files stored in
the USIM as defined in TS 31.102 [7] or the WLAN MO (i.e. the 3GPP System to
Wireless Local Area Network interworking Management Object) defined in TS
24.235 [5] and used by TS 23.234 [8] and TS 24.234 [4]. In terms of
information contained:
\- The USIM contains, in summary, Wi-Fi information such as a list of SSIDs,
and PLMN information (i.e. PLMNs defined by MCC, MNC).
\- The MO contains, in summary, Wi-Fi information such as a list of SSIDs, and
PLMN information (i.e. PLMN realms, defined according to RFC 4282).
Since PLMN selection is the driving factor, then once a PLMN has been chosen
the UE can then only use an SSID (specific WLAN) that connects to that PLMN.
If none of the above data exists, then PLMN selection is still performed based
on TS 24.234 [4] but just for (E)HPLMN selection. (E)HPLMN selection can be
based upon:
\- UE pre-configuration or else by selecting SSID\'s at random.
\- HPLMN selection is based on using the EFEHPLMN file in the USIM (see TS
31.102 [7]).
\- If the EHPLMN file is not present, the UE chooses the EHPLMN based on the
IMSI (see TS 31.102 [7]).
The UE is expected to either have the necessary files in the USIM, or be
configured in some proprietary way. The home operator can provision the
information in the USIM (to be used as above) or in the WLAN MO (to be used
according to TS 24.234 [4] procedures).
ANDSF has introduced mechanisms to enable WLAN selection under specific
conditions, defined by ANDSF rules. ANDSF assists the UE in discovering
available WLANs, and it assists the UE in using the WLAN vs. cellular
interface. The ANDSF MO has a rich set of information and rules to achieve
traffic routing and access selection based on the desired policies, whereas
the WLAN MO does not contain any information e.g. on APNs, application related
filters, etc. that are present in the ANDSF MO. However, when ANDSF is
deployed, the WLAN selection is still determined by the PLMN selection
procedure which takes into account the WLAN MO if present. In fact, the ANDSF
MO is not used by the UE in PLMN selection, and it is not meant for PLMN
selection. After PLMN selection has taken place, the UE can apply active ANDSF
policies for traffic routing according to TS 24.302.
The following diagrams provide a diagrammatic view of PLMN selection.
Figure A.1 provides a high level description of SSID / PLMN selection.
Figure A.1: SSID and PLMN Selection
Figure A.2 provides a high level description of ANDSF policy selection.
Figure A.2: ANDSF policy selection
Figure A.3 provides a more detailed view of how SSIDs are chosen and then used
to obtain PLMN information.
Figure A.3: Details of SSID and PLMN Selection
#