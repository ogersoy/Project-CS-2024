# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document describes all procedures that assign, reconfigure and
release radio resources. Included are e.g. procedures for transitions between
different states and substates, handovers and measurement reports. The
emphasis is on showing the combined usage of both peer-to-peer messages and
interlayer primitives to illustrate the functional split between the layers,
as well as the combination of elementary procedures for selected examples. The
peer-to-peer elementary procedure descriptions and interlayer dependencies are
described in the related protocol descriptions /1, 2, 3/ and they are thus not
within the scope of the present document.
The interlayer procedures and interlayer dependencies in the present document
are informative.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or non‑specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 25.321: \"Medium Access Control (MAC) protocol specification\".
[2] 3GPP TS 25.322: \"Radio Link Control (RLC) protocol specification\".
[3] 3GPP TS 25.331: \"Radio Resource Control (RRC) protocol specification\".
[4] 3GPP TS 25.304: \"UE Procedures in Idle Mode and Procedures for Cell
Reselection in Connected Mode\".
[5] 3GPP TS 25.301: \"Radio Interface Protocol Architecture\".
[6] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[7] 3GPP TS 25.323: \"Packet Data Convergence Protocol (PDCP) specification\".
[8] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
[8] apply.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ASC Access Service Class
DC‑SAP Dedicated Control SAP
DCH Dedicated transport CHannels
RNTI Radio Network Temporary Identity
# 4 General Description of Connected Mode
The connected mode is entered when the RRC connection is established. The UE
is assigned a Radio Network Temporary Identity (RNTI) to be used as UE
identity on common transport channels. Two types of RNTI exist. The Serving
RNC allocates an s-RNTI for all UEs having an RRC connection. The combination
of s-RNTI and an RNC-ID is unique within a PLMN. c-RNTI is allocated by each
Controlling RNC through which UE is able to communicate on DCCH. c‑RNTI is
always allocated by UTRAN when a new UE context is created to an RNC, but the
UE needs its c-RNTI only for communicating on common transport channels.
The UE leaves the connected mode and returns to idle mode when the RRC
connection is released or at RRC connection failure.
Within connected mode the level of UE connection to UTRAN is determined by the
quality of service requirements of the active radio bearers and the
characteristics of the traffic on those bearers.
The UE-UTRAN interface is designed to support a large number of UEs using
packet data services by providing flexible means to utilize statistical
multiplexing. Due to limitations, such as air interface capacity, UE power
consumption and network h/w availability, the dedicated resources cannot be
allocated to all of the packet service users at all times.
Variable rate transmission provides the means that for services of variable
rate the data rate is adapted according to the maximum allowable output power.
The UE state in the connected mode defines the level of activity associated to
the UE. The key parameters of each state are the required activity and
resources within the state and the required signalling prior to the data
transmission. The state of the UE shall at least be dependent on the
application requirement and the period of inactivity.
The different levels of UE connection to UTRAN are listed below:
\- No signalling connection exists\ The UE is in idle mode and has no relation
to UTRAN, only to CN. For data transfer, a signalling connection has to be
established.
\- Signalling connection exists\ When at least one signalling connection
exists, the UE is in connected mode and there is normally an RRC connection
between UE and UTRAN. The UE position can be known on different levels:
\- UTRAN Registration Area (URA) level\ The UE position is known on URA level.
The URA is a set of cells
\- Cell level\ The UE position is known on cell level. Different transport
channel types can be used for data transfer:
\- Common transport channels (RACH / FACH, DSCH)
\- Dedicated transport CHannels (DCH)
Assuming that there exists an RRC connection, there are two basic families of
RRC connection mobility procedures, URA updating and handover. Different
families of RRC connection mobility procedures are used in different levels of
UE connection (cell level and URA level):
\- URA updating is a family of procedures that updates the UTRAN registration
area of a UE when an RRC connection exists and the position of the UE is known
on URA level in the UTRAN;
\- handover is a family of procedures that adds or removes one or several
radio links between one UE and UTRAN when an RRC connection exists and the
position of the UE is known on cell level in the UTRAN.
# 5 Radio Bearer Control - Overview of Procedures
## 5.1 Configurable parameters
The following layer 1, MAC and RLC parameters should be configurable by RRC.
The list is not complete.
\- Radio bearer parameters, e.g.:
\- RLC parameters per RLC link (radio bearer), which may include e.g. PDU size
and timeout values. Used by RLC.
\- Multiplexing priority per DCCH/DTCH. Used by MAC in case of MAC
multiplexing of logical channels.
\- Transport channel parameters, e.g.:
\- Scheduling priority per transport channel. Used by MAC in case of layer
1multiplexing of transport channels.
\- Transport format set (TFS) per transport channel. Used by MAC and L1.
\- Transport format combination set (TFCS) per UE. Used by MAC and L1.
\- Allowed subset of TFCS per UE. Used by MAC.
\- Physical channel parameters, which may include e.g. carrier frequency and
codes. Used by L1.
## 5.2 Typical configuration cases
Table 1 gives a proposal which main combination cases of parameter
configuration that shall be supported, in terms of which parameters that shall
be able to configure simultaneously (by one procedure). Note that the
\"Transport channel type switching\" is not a parameter as such, it only
indicates that switching of transport channel type may take place for that
combination case.
Table 1: Typical configuration cases.\ An \"X\" indicates that the parameter
can (but need not) be configured
* * *
Parameter Layer A B C D E F  
Radio bearer parameters RLC parameters RLC X  
Logical channel multiplexing priority MAC X  
Transport channel parameters Transport channel scheduling priority MAC X  
TFS L1+MAC X X  
TFCS L1+MAC X X  
Subset of TFCS MAC X X Transport channel type switching MAC X X X  
Physical channel parameters L1 X X X X
* * *
Case A is typically when a radio bearer is established or released, or when
the QoS of an existing radio bearer need to be changed.
Case B is when the traffic volume of a radio bearer has changed so the TFS
used on the DCH need to be changed, which may in turn affect any assigned set
of physical channels. Another example is to make the UE use a new transport
channel and at the same time supplying the TFS for that channel.
Case C is when the traffic volume of one radio bearer has changed so that the
used transport channel type is changed, e.g. from CELL_FACH to CELL_DCH. This
case includes the assignment or release of a set of physical channels.
Case D is e.g. the change of used DL channelisation code, when a DCH is
currently used. No transport channel type switching takes place.
Case E is a temporary restriction and/or a release of restriction for usage of
the TFCS by the UE (total uplink rate).
Case F is used to dynamically control the allocation of resources on uplink
DCHs in the CRNC, using broadcast information such as transmission probability
and maximum bit rate.
## 5.3 RRC Elementary Procedures
### 5.3.1 Category 1: Radio Bearer Configuration
The first category of procedures includes Case A and are characterized by:
\- are executed upon request by higher layers and the parameter configuration
is based on QoS;
\- affects L1, MAC and RLC.
There are three RRC procedures included in this category:
**\- Radio Bearer Establishment:** this procedure establishes a new radio
bearer. The establishment includes, based on QoS, assignment of RLC
parameters, multiplexing priority for the DTCH, scheduling priority for DCH,
TFS for DCH and update of TFCS. It may also include assignment of a physical
channel(s) and change of the used transport channel types / RRC state.
**\- Radio Bearer Release:** this procedure releases a radio bearer. The RLC
entity for the radio bearer is released. The procedure may also release a DCH,
which affects the TFCS. It may include release of physical channel(s) and
change of the used transport channel types / RRC state.
**\- Radio Bearer Reconfiguration:** this procedure reconfigures parameters
for a radio bearer (e.g. the signalling link) to reflect a change in QoS. It
may include change of RLC parameters, change of multiplexing priority for
DTCH/DCCH, change of DCH scheduling priority, change of TFS for DCH, change of
TFCS, assignment or release of physical channel(s) and change of used
transport channel types.
### 5.3.2 Category 2: Transport Channel Configuration
The second category of procedures includes Case B and are characterized by:
\- configuration of TFS for a transport channel and reconfiguration of TFCS is
done, but sometimes also physical channel parameters;
\- affects L1 and MAC;
\- switching of used transport channel(s) may take place.
There is one RRC procedure included in this category:
**\- Transport Channel Reconfiguration:** this procedure reconfigures
parameters related to a transport channel such as the TFS. The procedure also
assigns a TFCS and may change physical channel parameters to reflect a
reconfiguration of a transport channel in use.
NOTE: It is expected that the configuration of TFS/TFCS needs to be done more
seldom than the assignment of physical channel. A \"pre-configuration\" of
TFS/TFCS of a transport channel not in use can be done by this procedure, to
be used after transport channel type switching when the physical channel is
assigned.
### 5.3.3 Category 3: Physical Channel Configuration
The third category of procedures includes the cases C and D and are
characterized by:
\- may assign or release a physical channel for the UE (which may result in
transport channel type switching);
\- may make a combined release and assignment (replacement) of a physical
channel in use (which does not result in transport channel type switching /
change of RRC state);
\- affects mainly L1, and only the transport channel type switching part of
MAC;
\- the transport format sets (TFS and TFCS) are not assigned by this type of
procedure. However, the UE can be directed to a transport channel, which TFS
is already assigned to the UE.
There is one RRC procedure included in this category:
**\- Physical Channel Reconfiguration:** this procedure may assign, replace or
release a set of physical channels used by an UE. As a result of this, it may
also change the used transport channel type (RRC state). For example, when the
first physical channel is assigned the UE enters the DCH/DCH state. When the
last physical channel is released the UE leaves the CELL_DCH state and enters
a state (and transport channel type) indicated by the network. A special case
of using this procedure is to change the DL channelisation code of a dedicated
physical channel.
NOTE: The procedure does not change the active set, in the downlink the same
number of physical channels are added or replaced for each radio link.
### 5.3.4 Category 4: Transport Format Combination Restriction
The fourth category of procedures includes Case E and are characterized by:
\- does only control MAC by means of the transport format combinations that
may be used within the set without affecting L1.
There is one RRC procedure included in this category:
**\- Transport format combination control:** the network uses this procedure
towards an UE, to control the used transport format combinations in the uplink
within the transport format combination set.
### 5.3.5 Category 5: Uplink Dedicated Channel Control in CRNC
The fifth category of procedures includes Case F and are characterized by:
\- does control UE MAC by means of broadcasting transmission probability and
maximum total bit rate that shall be used for uplink DCHs, which are under
control by this procedure.
There is one RRC procedure included in this category:
**\- Dynamic Resource Allocation Control of Uplink DCHs:** the network uses
this procedure towards all UEs, to control the probability of transmission and
the maximum total bit rate used by uplink DCHs, which are under control by
this procedure.
# 6 Examples of procedures
These sequences are examples and do not provide a comprehensive set of all
different scenarios.
In cases where the logical and / or transport channel for a given message is
known, it can be shown in front of the message name (_Logical_Ch:
Transport_Ch: Message)._ For example: DCCH:RACH:Acknowledged Data indicates a
data message on DCCH mapped onto RACH. Either logical or transport channel can
be omitted, if it is unspecified for the message.
## 6.1 RRC Connection Establishment and Release Procedures
### 6.1.1 RRC connection establishment
RRC connection establishment (see [5]) is shown in figure 1 (protocol
termination for common channels is shown according to former case A, case C
can be found for comparison in annex A). The RRC layer in the UE leaves the
idle mode and initiates an RRC connection establishment by sending an RRC
Connection Request message using transparent mode on CCCH logical channel, and
it is transmitted by MAC on the RACH transport channel.
On the network side, upon the reception of RRC Connection Request, the RRC
layer performs admission control, assigns an s-RNTI for the RRC connection and
selects radio resource parameters (such as transport channel type, transport
format sets etc). If a DCH is to be established, CPHY-RL-Setup and CPHY-TrCH-
Config request primitives (transmitted as one RADIO LINK SETUP PDU) are sent
to all Node Bs that would be involved in the channel establishment. The
physical layer operation is started and confirmation primitives are returned
from each Node B. RRC configures parameters on layer 2 to establish the DCCH
logical channel locally. The selected parameters including the RNTI, are
transmitted to the UE in an RRC Connection Setup message using unacknowledged
mode on the CCCH logical channel.
Upon reception of the RRC Connection Setup message, the RRC layer in the UE
configures the L1 and L2 using these parameters to locally establish the DCCH
logical channel. In case of DCH, layer 1 indicates to RRC when it has reached
synchronisation.
The RLC signalling link is locally established on both sides. The
establishment can be mapped on either RACH / FACH or DCH by MAC. When the UE
has established the RLC signalling link, it transmits an RRC Connection Setup
Complete message to the network using acknowledged mode on the DCCH.
Figure 1: RRC connection establishment (with common channel termination case
A)
### 6.1.2 UE Initiated Signalling Connection Establishment
NOTE 1: In case additional UE capability information is needed at RRC
Connection Establishment, it is transmitted in the RRC Connection Setup
Complete message.
The sequence in figure 2 shows the establishment of the first Signalling
Connection for the UE, initiated by the UE.
RRC Signalling Connection Establishment is requested by the non access stratum
in the UE with a primitive over the Dedicated Control (DC) SAP. The primitive
contains an initial message to be transferred transparently by RRC to the non-
access stratum entity on the network side.
NOTE 2: The initial NAS message could for a GSM based Core Network be e.g. CM
Service Request, Location Update Request etc.
If no RRC connection exists, the RRC layer makes an RRC connection
establishment, which includes the transmission of UE capability information.
When the RRC connection establishment is completed, the signalling connection
establishment can be resumed.
The initial message from NAS is transferred in the RRC message \"Initial
Direct Transfer\" using acknowledged mode on the DCCH, to the network, where
it is passed on with an RRC Signalling Connection Establish IND primitive over
the DC‑SAP.
When the UE-RRC has requested UE-RLC to transmit the INITIAL DIRECT TRANSFER
message, the Signalling Connection Establishment is confirmed by the UE-RRC.
Figure 2: UE initiated Signalling Connection Establishment
### 6.1.3 Normal RRC Connection Release
A normal RRC Connection Release procedure is initiated on the network side by
an RRC Signalling Connection Release request for the last Signalling
Connection of a UE. The procedure is slightly different depending on whether
the UE has dedicated physical channel(s) allocated.
#### 6.1.3.1 RRC Connection Release from Dedicated Physical Channel
{width="9.915277777777778in" height="5.839583333333334in"}
Figure 3: RRC Connection Release from Dedicated Physical Channel
The RRC layer entity in the network issues an RRC CONNECTION RELEASE message
using unacknowledged mode on the DCCH. Upon reception of this message the UE-
RRC sends an RRC Signalling Connection Release Indication primitive to NAS The
UE replies with an RRC CONNECTION RELEASE COMPLETE message, which is sent in
unacknowledged-mode on the dedicated channel. To improve the reliability of
the message, quick repeat on RRC-level can be used. The UE will then proceed
to release RLC(s), MAC and the radio link(s) after which the UE RRC enters
Idle Mode.
The primary method to detect the release of the signalling link in the NW is
the RRC CONNECTION RELEASE COMPLETE-message from the UE. Should the message be
lost despite the use of quick repeat, the release of the signalling link is
detected by the out-of-sync primitive from either Node-B L1 or RNC-L1 to RNC
RRC. After receiving this primitive, the RNC-RRC layer releases L2 and L1
resources on the network side and enters the idle mode.
#### 6.1.3.2 RRC Connection Release without Dedicated Physical Channel
The RRC layer entity in the network issues an RRC CONNECTION RELEASE message
using unacknowledged or acknowledged mode on the DCCH. Upon reception of this
message the UE-RRC sends an RRC Signalling Connection Release Indication
primitive to NAS and an RRC CONNECTION RELEASE COMPLETE message to UTRAN using
acknowledged mode on the DCCH.
After receiving the RRC CONNECTION RELEASE COMPLETE message the network RRC
layer releases L2 resources, sends an RRC Signalling Connection Release
confirmation to DC-SAP and goes to Idle Mode (more precisely: only the RRC
entity dedicated to this UE goes to Idle Mode).
Figure 4: RRC Connection Release without Dedicated Physical Channel
## 6.2 Radio Bearer Control Procedures
### 6.2.1 Radio Bearer Configuration
#### 6.2.1.1 Radio Bearer Establishment
The procedures for establishing radio bearers may vary according to the
relation between the radio bearer and a dedicated transport channel. Depending
on the QoS parameters, there may or may not be a permanently allocated
dedicated channel associated with the RB. Circuit-switched bearers, or bearers
classified as real-time services typically need a permanent association to a
DCH to meet the delay requirements. Packet-switched bearers, or bearers
classified as non-real-time services can in many cases be served as best-
effort, requesting capacity from an associated DCH based on need.
When establishing an RB together with a DCH, the DCH may be attached to either
a newly activated physical channel or it may be accommodated by modifying an
existing physical channel. The modification is further broken down into two
different options: synchronised and unsynchronised. If the old and new
physical channel settings are compatible (TFCI etc.) in the sense that
executing the modification in the NW and the UE with arbitrary timing does not
introduce transmission errors, the unsynchronised procedure can be applied. If
the old and new settings are incompatible, due to e.g. assignment of the same
TFCI value to a new set of physical layer configuration, the synchronised
procedure must be used.
##### 6.2.1.1.1 Radio Bearer Establishment with Dedicated Physical Channel
Activation
The procedure in figure 5 is applied when a new physical channel needs to be
created for the radio bearer. A Radio Bearer Establishment is initiated when
an RB Establish Request primitive is received from the DC-SAP on the network
side of the RRC layer. This primitive contains a bearer reference and QoS
parameters. Based on these QoS parameters, L1 and L2 parameters are chosen by
the RRC entity on the network side.
The physical layer processing on the network side is started with the CPHY-RL-
Setup request primitive issued to all applicable Node Bs. If any of the
intended recipients is / are unable to provide the service, it will be
indicated in the confirmation primitive(s).After setting up L1 including the
start of Tx / Rx in Node B, the NW-RRC sends a RADIO BEARER SETUP message to
its peer entity (acknowledged or unacknowledged transmission optional for the
NW). This message contains L1, MAC and RLC parameters. After receiving the
message, the UE-RRC configures L1 and MAC.
When L1 synchronisation is indicated, the UE sends a RADIO BEARER SETUP
COMPLETE message in acknowledged-mode back to the network. The NW-RRC
configures MAC and RLC on the network side.
The UE-RRC creates a new RLC entity associated with the new radio bearer. The
applicable method of RLC establishment may depend on RLC transfer mode. The
RLC connection can be either implicitly established, or explicit signalling
can be applied.
Finally, an RB Establish Indication primitive is sent by UE-RRC and an RB
Establish Confirmation primitive is issued by the RNC-RRC.
Figure 5: Radio Bearer Establishment with Dedicated Physical Channel
Activation
##### 6.2.1.1.2 Radio Bearer Establishment with Unsynchronised Dedicated
Physical Channel Modification
{width="8.313194444444445in" height="5.759722222222222in"}
Figure 6: Radio Bearer Establishment with Unsynchronised Dedicated Physical
Channel Modification
The establishment of a radio bearer, when unsynchronised physical channel
modification is applicable, is shown in figure 6. If the old and new physical
layer configurations are compatible in the sense that they can coexist in the
peer entities, an unsynchronised procedure for radio bearer establishment can
be applied. In this case no fixed activation time is required.
The modifications on the physical layer in the network are done in response to
a CPHY_ modify request. Failure to comply is indicated in the confirmation
primitive. In an error-free case the RADIO BEARER SETUP message on L3 is
transmitted. Acknowledged or unacknowledged transmission is a network option.
Configuration changes on the UE-side proceed after this message has been
received. Reception of the RADIO BEARER SETUP COMPLETE message triggers
configuration changes in MAC and RLC in the network.
##### 6.2.1.1.3 Radio Bearer Establishment with Synchronised Dedicated
Physical Channel Modification
In this case the CPHY-RL-Modify request doesn\'t immediately cause any changes
in the physical layer configuration, it only checks the availability of the
requested configuration and makes a \"reservation\". After the confirmations
have been received from all applicable Node Bs, the RRC chooses the
appropriate \"activation time\" when the new configuration can be activated.
This information is signalled to MAC, RLC and also the physical layer
(CPHY_Commit request primitive).
After the RADIO BEARER SETUP message (acknowledged transmission on L2
required) between peer L3 entities the setup proceeds on the UE-side. The new
configuration is now available both on the UE and the network side, and at the
scheduled activation time the new configuration is assumed by all applicable
peer entities.
In case the old and the new physical channel configurations are incompatible
with each other (due to different DPCCH format, TFCI patterns or similar
differences), the modification on physical layer and L2 require exact
synchronisation between the UE and the NW, as shown in figure 7.
{width="8.152777777777779in" height="6.225694444444445in"}
Figure 7: Radio Bearer Establishment with Synchronised Dedicated Physical
Channel Modification
##### 6.2.1.1.4 Radio Bearer Establishment without Dedicated Physical Channel
{width="8.600694444444445in" height="5.977083333333334in"}
Figure 8: Radio Bearer Establishment without Dedicated Physical Channel
For some radio bearers dedicated radio resources are not permanently
associated. Therefore the setting up of the physical resource is separate from
the actual radio bearer setup, which involves only RLC and MAC.
MAC can be initially configured to operate either on existing dedicated
transport and physical channels or on common channels.
##### 6.2.1.1.5 Void
#### 6.2.1.2 Radio Bearer Release
Similar as for Radio Bearer Establishment procedure, the Radio Bearer Release
can include physical channel modification or physical channel deactivation
depending on the differences between new and old QoS parameters. These can
also be both synchronised and unsynchronised.
The Radio Bearer Release procedure is initiated when the release is requested
from the RRC layer on the NW side. This request contains a bearer reference,
and on retrieval a RB Release Confirm primitive is immediately returned to the
Non-Access Stratum.
New L1 and L2 parameters may be chosen for remaining radio bearers if any. A
RADIO BEARER RELEASE message is sent from the RRC layer in the network to its
peer entity in the UE. This message includes possible new L1, MAC and RLC
parameters for remaining radio bearers and identification of the radio bearer
to be released (note). An RB Release Indication is sent by the UE-RRC.
NOTE: In synchronised case a specific activation time would be needed for the
change of L1 and L2 configuration to avoid data loss.
The RRC on the UE side configures L1 and MAC, and releases the RLC entity
associated to the released radio bearer. After receiving a RADIO BEARER
RELEASE COMPLETE message from the UE, the NW-RRC does a similar
reconfiguration also on the network side.
##### 6.2.1.2.1 Radio Bearer Release with Unsynchronised Dedicated Physical
Channel Modification
The example in figure 10 shows the case where release can be executed as an
unsynchronised physical channel modification, i.e. without physical channel
deactivation.
After notifying upper layers of the release, a RADIO BEARER RELEASE message
(acknowledged or unacknowledged transmission optional for the network) is sent
to the UE triggering the reconfiguration in the UE. When this is finalised the
UE sends a RADIO BEARER RELEASE COMPLETE message to the network, after which
the reconfiguration is executed in the network.
{width="8.424305555555556in" height="6.227083333333334in"}
Figure 10: Radio Bearer Release with Unsynchronised Dedicated Physical Channel
Modification
#### 6.2.1.3 Radio Bearer Reconfiguration
For Radio Bearer Reconfiguration, both synchronised and unsynchronised
procedures are applicable. The unsynchronised procedure is shown as an
example.
##### 6.2.1.3.1 Unsynchronised Radio Bearer Reconfiguration
Because of the unsynchronised nature of the procedure in figure 11, there is
no activation time and no separate commit request for the Node B physical
layer is needed. The possibility for executing the requested modification will
be reported in the confirmation primitives from the physical layer. If the
modification involves the release of an old configuration, the release can be
postponed to the end of the procedure. After the reception of a RADIO BEARER
RECONFIGURATION from the RNC-RRC (acknowledged or unacknowledged transmission
optional for the network), the UE executes the modifications on L1 and L2.
Upon reception of a RADIO BEARER RECONFIGURATION COMPLETE message from the UE-
RRC, the NW-RRC executes the modifications on L1 and L2. Finally the old
configuration, if any, is released from Node B-L1.
{width="9.202777777777778in" height="6.128472222222222in"}
Figure 11: Unsynchronised Radio Bearer Reconfiguration
### 6.2.2 Transport Channel Reconfiguration
For transport channel reconfiguration, both synchronised and unsynchronised
procedures are applicable.
#### 6.2.2.1 Unsynchronised Transport Format Set Reconfiguration
Figure 12 illustrates an example of a procedure for a change of the Transport
Format Set for one transport channel. This is done with the Transport Channel
Reconfiguration procedure.
A change of the transport format set for a transport channel is triggered in
the RRC layer in the network. A TRANSPORT CHANNEL RECONFIGURATION message is
sent from the RRC layer in the network to its peer entity (acknowledged or
unacknowledged transmission is a network option). This message contains the
new transport format set and a new transport format combination Set, i.e. new
parameters for L1 and MAC (note). When this message is received in the UE a
reconfiguration of L1 and MAC is done. A similar reconfiguration is also done
on the network side after the reception of a TRANSPORT CHANNEL RECONFIGURATION
COMPLETE message.
NOTE: In a synchronised procedure a specific activation time is needed for the
change of L1 and L2 configuration to avoid data loss.
During the reconfiguration of the transport format set for a transport
channel, radio traffic on this channel could be halted temporarily since the
UE and the network are not necessarily aligned in their configuration. This
traffic can resume after the COMPLETE-message.
{width="9.91388888888889in" height="3.807638888888889in"}
Figure 12: Unsynchronised Transport Format Set Reconfiguration
### 6.2.3 Physical Channel Reconfiguration
For physical channel reconfiguration, both synchronised and unsynchronised
procedures are applicable.
#### 6.2.3.1 UE-Originated DCH Activation
Figure 13 illustrates an example of a procedure for a switch from common
channels (CELL_FACH) to dedicated (CELL_DCH) channels.
In the UE the traffic volume measurement function decides to send a
MEASUREMENT REPORT message to the network. In the network this measurement
report could trigger numerous different actions. For example the network could
do a change of transport format set, channel type switching or, if the system
traffic is high, no action at all. In this case a switch from CELL_FACH to
CELL_DCH is initiated.
Whether the report should be sent with acknowledged or unacknowledged data
transfer is configured by the network.
First, the modifications on L1 are requested and confirmed on the network side
with CPHY-RL-Setup primitives.
The RRC layer on the network side sends a PHYSICAL CHANNEL RECONFIGURATION
message to its peer entity in the UE (acknowledged or unacknowledged
transmission optional to the network). This message is sent on DCCH mapped to
FACH. The message includes information about the new physical channel, such as
codes and the period of time for which the DCH is activated (note).
NOTE: This message does not include new transport formats. If a change of
these is required due to the change of transport channel, this is done with
the separate procedure Transport Channel Reconfiguration. This procedure only
handles the change of transport channel.
When the UE has detected synchronisation on the new dedicated channel L2 is
configured on the UE side and a PHYSICAL CHANNEL RECONFIGURATION COMPLETE
message can be sent on DCCH mapped on DCH to RRC in the network. Triggered by
either the NW CPHY_sync_ind or the L3 complete message, the RNC-L1 and L2
configuration changes are executed in the NW.
{width="8.114583333333334in" height="6.182638888888889in"}
Figure 13: UE-Originated DCH Activation
#### 6.2.3.2 UE-terminated synchronised DCH Modify
{width="9.916666666666666in" height="5.701388888888889in"}
Figure 14: UE-terminated synchronised DCH Modify
Figure 14 illustrates an example of a synchronised procedure for DCH
modification. Triggering of this procedure could for example be accomplished
by an inactivity timer. The procedure can e.g. release all transport formats
of a radio bearer without releasing the DCH, due to another bearer using it.
The synchronised procedure is applied in the case when the old and new
configurations are not compatible e.g. change of channelisation code.
After the CPHY-RL-Modify requests have been confirmed, an activation time is
chosen by NW-RRC. After deciding upon the activation time, the NW-RRC sends a
PHYSICAL CHANNEL RECONFIGURATION message as acknowledged data transfer to the
UE. In both uplink and downlink this message is sent on DCCH mapped on DCH.
After reception the UE reconfigures L1 and L2 to DCH resources. If a complete
message is used it would be sent on DCCH mapped on DCH. In the unsynchronised
case this message could trigger a modification of L1 and L2 resources in the
network associated with the dedicated channel.
#### 6.2.3.3 UE-terminated DCH Release
Figure 15 illustrates an example of a procedure for a switch from dedicated
(CELL_DCH) to common (CELL_FACH) channels. All DCHs used by a UE are released
and all dedicated logical channels are transferred to CELL_FACH instead.
Triggering of this procedure could for example be an inactivity timer.
A switch from DCH to common channels is decided and a PHYSICAL CHANNEL
RECONFIGURATION message is sent (acknowledged or unacknowledged data transfer
is a network option) from the RRC layer in the network to the UE. This message
is sent on DCCH mapped on DCH.
NOTE 1: This message does not include new transport formats. If a change of
these is required due to the change of transport channel, this is done with
the separate procedure Transport Channel Reconfiguration. This procedure only
handles the change of transport channel.
If the loss of L1 sync is used to detect in the NW that the UE has released
the DCHs, as is one possibility in the figure, then there may be a need to
configure the Node B-L1 to a short timeout for detecting loss of sync. This is
presented by the CPHY-Out-of-Sync-Config primitives in the figure.
After reception the UE reconfigures L1 and L2 to release old DCH resources.
The PHYSICAL CHANNEL RECONFIGURATION COMPLETE message to the network is here
sent on DCCH mapped on RACH (message acknowledgement on FACH). This message
triggers a normal release of L1 and L2 resources in the network associated
with the dedicated channel.
NOTE 2: When a Switch to CELL_FACH is done it is important to free the old
code as fast as possible so that it can be reused. Therefore instead of
waiting for the Physical Channel Reconfiguration Complete message the network
can reconfigure L1 and L2 when the acknowledged data confirmation arrives and
the network is sure that the UE has received the Physical Channel
Reconfiguration message. To be even more certain that the UE has released the
old DCH resources the network can wait until after the Out of sync Indication
from L1.\ These steps including a timer starting when the Physical Channel
Reconfiguration is sent, gives the network four different indications that the
released DCH is really released, and that resources can be reused.
{width="9.91388888888889in" height="4.999305555555556in"}
Figure 15: UE-terminated DCH Release
### 6.2.4 Transport Format Combination Control
#### 6.2.4.1 Transport Format Combination Limitation
Figure 16: Transport Format Combination Limitation
Figure 16 illustrates an example of a Transport Format Combination Control
procedure. A congestion situation occurs and allowed transport format
combinations are restricted temporarily. When the congestion is resolved the
restriction is removed.
This procedure is initiated with a Transport Format Combination Control
message from the network to the UE (acknowledged, unacknowledged or
transparent transmission optional to the NW). This message contains a subset
of the ordinary Transport Format Combination Set. The UE then continues with a
reconfiguration of MAC. MAC sees the TFC subset as a completely new set.
Further, after a while when the congestion is resolved a new Transport Format
Combination Control message is sent to the UE from the RRC layer in the
network. This message contains a subset that is the entire original set.
Again, the UE reconfigures the MAC.
### 6.2.5 Dynamic Resource Allocation Control of Uplink DCHs
Figure 17: Dynamic Resource Allocation Control of Uplink DCHs
Figure 17 illustrates an example of a Dynamic Resource Allocation Control
(DRAC) procedure of uplink DCHs. The CRNC regularly broadcasts the following
parameters:
\- transmission probability ptr, which indicates the probability for a UE to
be allowed to transmit on its DCHs, which are under control by this procedure,
during the next period Tvalidity;
\- maximum total bit rate allowed to be used by the UE on its DCH which are
under controlled by this procedure, during the next allowed period Tvalidity.
Besides these parameters, the RNC has allocated the following parameters to
the UE:
\- transmission time validity, Tvalidity, which indicates the time duration
for which an access for transmission is granted;
\- reaccess time Tretry, which indicates the time duration before retrying to
access the resources, in case transmission has not been granted.
This procedure is initiated with a SYSTEM INFORMATION message containing the
above DRAC parameters regularly broadcast by the CRNC on the FACH. It applies
to all UEs capable of simultaneous reception of Secondary CCPCH and DPCH and
having DCHs that can be controlled dynamically. The UEs have to listen to this
message prior to transmission on these DCHs. The UE RRC checks whether
transmission is allowed, and then reconfigures MAC with a new subset of TFCS
derived from the maximum total bit rate parameter. This TFCS subset shall
control only the DCHs that are under control by this procedure.
In case of soft handover on the uplink DCH, The UE is requested either to
listen to broadcast information from its primary cell (the one with the lowest
pathloss), or from all cells involved in its Active Set, depending on its
class. In the latter case, the UE is expected to react according to the
stricter control information.
### 6.2.6 Variable Rate Transmission of Uplink DCHs
Figure 18: Variable Rate Transmission of Uplink DCHs
Figure 18 illustrates an example of the Variable Rate Transmission procedure
of uplink DCHs. With this procedure the QoS of service with variable rate can
be maintained and unnecessary interference can be avoided by a temporary
reduction of the data rate within the TFCS.
When a connection for a variable rate service is established the RRC assigns
the TFCS to MAC. At the radio bearer set-up procedure the maximum allowable Tx
power can also be set for each user if it shall be different from the UE
capability class.
With the CPHY-Measurement-REQ the power thresholds will be set to the UE. If
during a transmission the allowable transmit power is above the set threshold
the event will be signalled to the MAC that will decrease the data rate within
the set TFCS at the next transmission time interval. In the UE, the PDUs that
can not be transmitted in a TTI (i.e. MAC has indicated that some of the
available PDUs can not be transmitted) shall be buffered according to the
discard configuration set by RRC.
When channel conditions improve and the averaged transmission power falls
below the allowable transmission power the physical layer indicates this event
to the MAC. If there is enough data to be sent, the MAC in response increases
the data rate by increasing the number of transport blocks delivered to L1 and
the physical layer increases the total transmission power to the UE by the
predefined amount. This allows the data that was buffered during bad channel
conditions to be delivered to the UTRAN.
## 6.3 Data transmission
### 6.3.1 Void
### 6.3.2 Void
### 6.3.3 Void
### 6.3.4 Data transfer on USCH (TDD only)
In figure 23 a data transfer procedure on USCH is presented. It is assumed
that the RB establishment has been performed for example with the RB
Establishment procedure without Dedicated Physical Channel as illustrated in
subclause 6.2.1.1.4 and that the RB is mapped on the USCH and DSCH transport
channels. Use of the USCH is possible with or without an associated DCH.
In the UE the traffic measurement function decides to send a Capacity Request
to the network using the SHCCH logical channel mapped on the RACH or USCH. In
the C-RRC the USCH/DSCH scheduling function will decide to allocate physical
resources to this logical channel and RRC in C-RNC sends a PhyShChAllocation
to its peer entity in the UE. This message specifies the physical resources
and the period of time the MAC-c/sh can transfer the data on the USCH
transport channel.
Both RRC in the CRNC and the UE configure their respective Layer 1 and MAC for
the data transfer on the USCH and at the specified time MAC-c/sh in the UE
conveys the data using the specified PUSCH resources.
This operation may be repeated several times till the RLC buffer is empty.
In the diagram it is assumed that the PhyShChAllocation has allocated
additionally to the PUSCH resources some PDSCH resources, so that at the time
specified in the allocation message both RRC in the CRNC and the UE configure
their respective Layer 1 and MAC for the data transfer on the DSCH and at the
specified time MAC-c/sh in the C-RNC conveys the acknowledgement message of
the UTRAN RLC to its UE peer entity using the specified PDSCH resources.
Transmitting the acknowledgement message via FACH is also possible.
Figure 23: Data transfer on USCH
### 6.3.5 Data transfer on DSCH (TDD only)
In figure 24 a data transfer procedure on DSCH is presented. It is assumed
that the RB establishment has been performed for example with the RB
Establishment procedure without Dedicated Physical Channel as illustrated in
subclause 6.2.1.1.4 and that the RB is mapped on the USCH and DSCH transport
channels.
Use of the DSCH is possible with or without an associated DCH.
In the C-RRC the USCH/DSCH scheduling function will decide to allocate
physical resources in the downlink and RRC in C-RNC sends a PhyShChAllocation
message to its peer entity in the UE using SHCCH mapped on the FACH or DSCH.
This message specifies the physical resources and the period of time the
MAC-c/sh can transfer the data on the DSCH transport channel.
Both RRC in the CRNC and the UE configure their respective Layer 1 and MAC for
the data transfer on the DSCH and at the specified time MAC-c/sh in the C-RNC
conveys the data using the specified PDSCH resources.
This operation may be repeated several times till the RLC buffer is empty.
In the diagram it is assumed that the PhyShChAllocation has allocated
additionally to the PDSCH resources some PUSCH resources, so that at the time
specified in the allocation message both RRC in the CRNC and the UE configure
their respective Layer 1 and MAC for the data transfer on the USCH and at the
specified time MAC-c/sh in the UE conveys the acknowledgement message of the
UE to its C-RNC peer entity using the specified PUSCH resources.
Transmitting the acknowledgement message via RACH is also possible.
Figure 24: Data transfer on DSCH
## 6.4 RRC Connection mobility procedures
The RRC handover protocol must be common for the FDD and TDD modes. This means
that the same protocol must support all the following handover procedures.
### 6.4.1 Handover Measurement Reporting
Figure 25 illustrates an example where a measurement control and a measurement
report procedure is used for handover measurements. The NW RRC requests the UE
to start measurements and reporting with a MEASUREMENT CONTROL message. The
message includes an indication of a measurement type (e.g. intra-frequency
measurement), the radio links to evaluate, the reporting criteria and a
measurement identity number. The UE configures L1 to start measurements. When
measurement reporting criteria are fulfilled the UE sends a MEASUREMENT REPORT
message.
{width="4.247916666666667in" height="4.086805555555555in"}
Figure 25: Handover measurement reporting
### 6.4.2 Cell Update
Figure 26 illustrates an example of a cell update procedure.
The cell update procedure is triggered by the cell re-selection function in
the UE, which notifies which cell the UE should switch to. The UE reads the
broadcast information of the new cell. Subsequently, the UE RRC layer sends a
CELL UPDATE message to the UTRAN RRC via the CCCH logical channel and the RACH
transport channel. The RACH transmission includes the current U-RNTI (S-RNTI
and the SRNC Identity).
Upon reception of the CELL UPDATE, the UTRAN registers the change of cell. If
the registration is successful it replies with a CELL UPDATE CONFIRM message
transmitted on the DCCH/FACH to the UE. The message includes the current
U-RNTI (S-RNTI and SRNC Identity) and it may also include new C-RNTI and / or
U-RNTI (S-RNTI + SRNC Identity). By using DCCH for the confirm message the
contents of the message can be ciphered.
Figure 26: Cell update procedure
### 6.4.3 URA Update
Figure 27 illustrates an example of a URA Update procedure. For a more
detailed figure on the interlayer interaction for CCCH or DCCH transmission
please refer to \"Cell Update\" in the previous subclause.
When cell re-selection is triggered, the UE abandons the radio link in the old
cell and establishes a radio link to the new cell. The URA update procedure is
triggered when the UE reads the broadcast information of the new cell and
recognises that a URA update is required. After that, the UE RRC layer sends a
URA UPDATE on the CCCH to the UE MAC layer, which transfers the message on the
RACH to UTRAN. The RACH transmission includes the current U-RNTI (S‑RNTI and
SRNC Identity).
Upon reception of the URA UPDATE, the UTRAN registers the change of URA. Then
the CRNC-RRC requests the CRNC-MAC to send a URA UPDATE CONFIRM message on the
FACH to the UE. The message includes the current U-RNTI (S-RNTI and SRNC
Identity) and may also include new C-RNTI, U-RNTI (S-RNTI and SRNC Identity).
The logical channel used for URA UPDATE CONFIRM depends on the SRNC relocation
policy. If SRNC is always relocated before URA UPDATE CONFIRM is sent, a DCCH
should be used (to allow ciphering of the message contents). If SRNC is not
relocated, the CCCH logical channel should be used to be able to utilize the
RNSAP Iur procedures and not being forced to set up user plane on the Iur for
this procedure.
{width="7.336111111111111in" height="6.083333333333333in"}
Figure 27: Beginning of the URA update procedure -- continue either to case A
or case B
**Case A: URA UPDATE CONFIRM on DCCH:**
{width="7.157638888888889in" height="1.4493055555555556in"}
Figure 28: Case A continuation of URA update, CONFIRM message can be ciphered
**Case B: URA UPDATE CONFIRM on CCCH:**
In this case transmission between SRNC and CRNC takes place on the RNSAP
Downlink Signalling Transfer and the CCCH logical channel is used.
{width="7.157638888888889in" height="1.4493055555555556in"}
Figure 29: Case B continuation of URA update, CONFIRM message cannot be
ciphered
### 6.4.4 Radio Link Addition (FDD)
Figure 30: Radio Link Addition
Figure 30 illustrates a radio link addition procedure. Radio link addition is
triggered in the network RRC layer by measurement reports sent by the UE. The
NW RRC first configures the new radio link on the physical layer in Node B.
Transmission and reception begins immediately. The NW RRC then sends an RRC
ACTIVE SET UPDATE message to the UE RRC. The UE RRC configures layer 1 to
begin reception.
The UE shall send an ACTIVE SET UPDATE COMPLETE message to the RNC‑RRC without
waiting for an indication of synchronisation from the UE physical layer.
### 6.4.5 Radio Link Removal (FDD)
{width="4.385416666666667in" height="3.9305555555555554in"}
Figure 31: Radio link removal
Figure 31 illustrates a radio link removal procedure. Radio link removal is
triggered by an algorithm in the network RRC layer by measurement reports sent
by the UE. Radio link removal may also be triggered in the NW due to load
control algorithms. The radio link is first deactivated by the UE and then in
the NW.
The NW RRC sends an ACTIVE SET UPDATE message to the UE RRC. The UE RRC
requests UE L1 to terminate reception of the radio link(s) to be removed.
After this the UE RRC acknowledges radio link removal with an ACTIVE SET
UPDATE COMPLETE message to the NW RRC. The NW RRC proceeds to request the NW
L1 in both Node B and the RNC to release the radio link.
### 6.4.6 Combined radio link addition and removal
{width="5.013194444444444in" height="5.586111111111111in"}
Figure 32: Combined Radio Link Addition And Removal
Figure 32 illustrates a combined radio link addition and removal procedure.
The NW RRC determines the need for radio link replacement based on received
measurement reports or load control algorithms.
When radio links are to be replaced, the NW RRC first configures the NW L1 to
activate the radio link(s) that are being added. The NW RRC then sends an
ACTIVE SET UPDATE message to the UE RRC, which configures the UE L1 to
terminate reception on the removed radio link(s) and begin reception on the
added radio link(s).
If the UE active set is full, the replacement has to be performed in the order
defined in figure 32. If UE has only one radio link, then the replacement must
be done in reverse order (first add, then remove).
The UE RRC acknowledges the replacement with an ACTIVE SET UPDATE COMPLETE
message. The NW RRC then configures the NW L1 to terminate reception and
transmission on the removed radio link.
### 6.4.7 Hard Handover (FDD and TDD)
Figure 33: Hard handover
Figure 33 illustrates a hard handover. The NW RRC determines the need for hard
handover based on received measurement reports or load control algorithms.
For inter-frequency handover the measurements are assumed to be performed in
slotted mode.
The NW RRC first configures the NW L1 to activate the new radio links. The NW
L1 begins transmission and reception on the new links immediately. The NW RRC
then sends the UE RRC a PHYSICAL CHANNEL RECONFIGURATION message (several
other messages e.g. RADIO BEARER RECONFIGURATION and TRANSPORT CHANNEL
RECONFIGURATION can also be used to perform hard handover). The message
indicates the radio resources that should be used for the new radio link. The
UE RRC configures the UE L1 to terminate reception on the old radio link and
begin reception on the new radio link.
After the UE L1 has achieved downlink synchronisation on the new frequency, a
L2 link is established and the UE RRC sends a PHYSICAL CHANNEL RECONFIGURATION
COMPLETE message to the NW RRC. After having received the L3 acknowledgement,
the NW RRC configures the NW L1 to terminate reception and transmission on the
old radio link.
### 6.4.8 SRNS Relocation
The SRNS relocation procedure can be divided into two phases. The first phase
is relocation preparation; where the resources are reserved, new RABs are
established while the second phase is the transfer of the Serving RNS from
source to target RNC.
In what follows, lossless radio bearers are RBs using AM and configured to
support lossless SRNS relocation. Seamless radio bearers are RBs using UM or
AM not configured to support lossless SRNS relocation.
There are three cases in which an SRNS relocation can be performed:
\- Serving SRNS relocation: This is used to move the UTRAN to CN connection
point at the UTRAN side from the source SRNC to the target RNC.
\- Combined Hard Handover and SRNS relocation: This is used to move the UTRAN
to CN connection point at the UTRAN side from the source SRNC to the target
RNC, while performing a hard handover decided by the UTRAN.
\- Combined Cell/URA update and SRNS relocation: This is used to move the
UTRAN to CN connection point at the UTRAN side from the source SRNC to the
target RNC, while performing a cell re-selection in the UTRAN.
and these are described in subclauses 6.4.8.1, 6.4.8.2 (for lossless radio
bearers), 6.4.8.3, 6.4.8.4 (for seamless radio bearers), and in more detail in
[6].
#### 6.4.8.1 Combined Cell/URA Update and SRNS relocation (lossless radio
bearers)
The procedure is initiated by the source RNC deciding to perform a SRNS
relocation. The scenario below describes the SRNS Relocation of the type \"UE
not involved\". In Case I the SRNS relocation is triggered by the UTRAN
MOBILITY INFORMATION message. In Case II the SRNS relocation is triggered by
the CELL UPDATE CONFIRM message.
A RANAP Relocation Command is received by the source RNC from the CN,
indicating the RABs to be released and the RABs that are subject to data
forwarding. Lossless SRNS relocation is always, and only, configured for RABs
that are subject to data forwarding. The PDCP layer shall support PDCP
sequence numbering when lossless SRNS relocation is supported [7].
For the affected radio bearers, the RLC entity is stopped and the next PDCP
sequence numbers are retrieved by RRC. The next PDCP send and receive sequence
numbers are then transferred in the RNSAP Relocation Commit message from
source to target RNC for RABs that support lossless SRNS relocation. The
target RNC becomes the serving RNC when the RANAP Relocation Detect message is
sent.
The target RNC then sends on SRB#1 (UM/DCCH) a UTRAN MOBILITY INFORMATION
(Case I) or a CELL/URA UPDATE CONFIRM (Case II); which configures the UE with
the new U-RNTI and indicates the next uplink receive PDCP sequence number for
each radio bearer configured to support lossless SRNS relocation.
The target RNC establishes a UM RLC entity for SRB#1, and the DL HFN and the
VT(US) are set to the values in the RRC information container, respectively.
In the UM RLC entity, the \"Special LI\" is used to indicate that an RLC SDU
begins in the beginning of an RLC PDU.
Upon reception by the UE of the message, the UE compares the next uplink
receive PDCP sequence number with the UE next uplink send PDCP sequence
number. If this confirms PDCP SDUs successfully transferred before the start
of relocation i.e. already received by the source RNC then these are discarded
by the UE. The UE reinitialises the PDCP header compression entities of the
radio bearers configured to use a header compression protocol [7]. The AM RLC
entity for SRB#2 is (re-)established both on the UTRAN and UE sides, and their
HFN values are set to the MAX(UL HFN of SRB2 \| DL HFN of SRB2) incremented by
one.
If the UE has successfully configured itself, it shall send a UTRAN MOBILITY
INFORMATION CONFIRM (Case I and Case II). These messages contain the START
values and the next downlink receive PDCP sequence number for each radio
bearer configured to support lossless SRNS relocation.
Upon reception and acknowledgement by the UTRAN of the message, the UTRAN
compares the next downlink receive PDCP sequence number with the next downlink
send PDCP sequence number. The UTRAN initialises the PDCP header compression
entities of the radio bearers configured to use a header compression protocol
[7]. The RLC entities for affected radio bearers (other than SRB#2) are
(re-)established both on the UTRAN and UE side. The HFN values for each RB are
set to the START value in the message for the corresponding CN domain, and all
the RLC data buffers are flushed.
In case of failure, the UE shall send a UTRAN MOBILITY INFORMATION FAILURE
(Case I and Case II).
Upon reception of the UTRAN MOBILITY INFORMATION CONFIRM/FAILURE (Case I and
Case II), the relocation procedure ends.
Figure 34: Combined Cell/URA Update and SRNS relocation (lossless radio
bearers)
#### 6.4.8.2 Combined Hard Handover and SRNS relocation (lossless radio
bearers)
Based on measurement results and knowledge of the UTRAN topology, the source
SRNC decides to initiate a combined hard handover and SRNS relocation. The UE
is still under control of the SRNC but is moving to a location controlled by
the target RNC. The scenario below describes the SRNS Relocation of the type
\"UE involved\".
A RANAP Relocation Command is received by the source RNC from the CN,
indicating the RABs to be released, the Target RNC to Source RNC Transparent
Container and the RABs that are subject to data forwarding. Lossless SRNS
relocation is always, and only, configured for RABs that are subject to data
forwarding. The PDCP layer shall support PDCP sequence numbering when lossless
SRNS relocation is supported [7]. The Target RNC to Source RNC Transparent
Container includes the RRC message (e.g. PHYSICAL CHANNEL RECONFIGURATION) for
hard handover.
Upon reception of the RANAP Relocation Command, the RRC entity in the source
RNC stops the RLC entities for the affected radio bearers and retrieves the
PDCP sequence numbers. It then triggers the execution of the relocation of
SRNS by sending the RRC message to the UE using the acknowledged mode
dedicated signalling radio bearer (SRB #2). This message includes the new
U-RNTI (from the target RNC) and the next uplink receive PDCP sequence number
for each radio bearer configured to support lossless SRNS relocation (from the
source RNC). The UE reinitialises the PDCP header compression entities of the
radio bearers configured to use a header compression protocol [7].
The next PDCP send and receive sequence numbers are then transferred via the
CN during the forwarding of SRNS contexts from source to target RNC. The
target RNC becomes the serving RNC when the RANAP Relocation Detect message is
sent.
Upon reception and acknowledgment by the UE of the message, the RLC entity for
the acknowledged mode dedicated signalling radio bearer (SRB #2) is re-
established, both on the UTRAN and UE sides and their HFN values are set to
the MAX(uplink HFN of RB2 \| downlink HFN of RB2) + 1. Care should be taken by
UTRAN in timing the SRNS relocation so that there is no risk of a SN rollover
on SRB #2 during this procedure.
The UE compares the next uplink receive PDCP sequence number with the next
uplink send PDCP sequence number. If this confirms PDCP SDUs successfully
transferred before the start of relocation i.e. already received by the source
RNC then these are discarded by the UE.
If the UE has successfully configured itself, it sends a response message, in
this case a PHYSICAL CHANNEL RECONFIGURATION COMPLETE message to the target
RNC using the acknowledged mode dedicated signalling radio bearer (SRB #2).
This message contains the START values and the next downlink receive PDCP
sequence number for each radio bearer configured to support lossless SRNS
relocation.
Upon acknowledgement of the message, the RLC entities for affected radio
bearers are re-established both on the UTRAN and UE side. The HFN values for
each RB are set to the START value in the message for the corresponding CN
domain.
UTRAN compares the next downlink receive PDCP sequence number with the next
downlink send PDCP sequence number. The UTRAN initialises the PDCP header
compression entities of the radio bearers configured to use a header
compression protocol [7].
The UTRAN and the UE continue the RLC and PDCP entities of the affected RBs
and the relocation procedure ends.
Figure 35: Combined Hard Handover and SRNS relocation (lossless radio bearers)
#### 6.4.8.3 Combined Cell/URA Update and SRNS relocation (seamless radio
bearers)
The procedure is initiated by the source RNC deciding to perform a SRNS
relocation. The scenario below describes the SRNS Relocation of the type \"UE
not involved\". In Case I the SRNS relocation is triggered by the UTRAN
MOBILITY INFORMATION message. In Case II the SRNS relocation is triggered by
the CELL UPDATE CONFIRM message.
A RANAP Relocation Command is received by the source RNC from the CN,
indicating the RABs to be released. PDCP of the source RNC takes a snapshot of
the header compression context on the radio bearers and header compression
protocols configured to apply the context relocation [7] and transfers the
context information to target RNC. The source RNC continues the downlink data
transmission on radio bearers supporting seamless SRNS relocation until the
target RNC becomes the serving RNC. The target RNC becomes the serving RNC
when the RANAP Relocation Detect message is sent.
The target RNC sends on SRB#1 (UM/DCCH) a UTRAN MOBILITY INFORMATION (Case I)
or a CELL/URA UPDATE CONFIRM (Case II); which configures the UE with the new
U-RNTI.
The target RNC establishes a UM RLC entity for SRB#1, and the DL HFN and the
VT(US) are set to the values in the RRC information container, respectively.
In the UM RLC entity, the \"Special LI\" is used to indicate that an RLC SDU
begins in the beginning of an RLC PDU.
Upon reception by the UE of the message, the AM RLC entity for SRB#2 is
(re-)established both on the UTRAN and UE sides, and their HFN values are set
to the MAX(UL HFN of SRB2 \| DL HFN of SRB2) incremented by one.
If the UE has successfully configured itself, it shall send a UTRAN MOBILITY
INFORMATION CONFIRM (Case I and Case II). These messages contain the START
values (to be used in integrity protection and in ciphering on radio bearers
using UM and AM RLC).
Upon reception and acknowledgement by the UTRAN of the message, the UTRAN
initialises and the UE reinitialises the PDCP header compression protocols of
the radio bearers configured to use a header compression protocol without the
context relocation [7]. For the radio bearers and header compression protocols
applying context relocation, UTRAN initialises header compression protocols
based on the context information received from the source RNC and UE continues
header compression without re-initialisation. Further description of specific
actions in UTRAN and UE in the case of context relocation is found in [7]. The
RLC entities for affected radio bearers (other than SRB#2) are
(re-)established both on the UTRAN and UE side. The HFN values for each RB are
set to the START value in the message for the corresponding CN domain, and all
the RLC data buffers are flushed.
In case of failure, the UE shall send a UTRAN MOBILITY INFORMATION FAILURE
(Case I and Case II).
Upon reception of the UTRAN MOBILITY INFORMATION CONFIRM/FAILURE (Case I and
Case II), the relocation procedure ends.
[]{.underline}
Figure 36: Combined Cell/URA Update and SRNS relocation (seamless radio
bearers)
#### 6.4.8.4 Combined Hard Handover and SRNS relocation (seamless radio
bearers)
Based on measurement results and knowledge of the UTRAN topology, the source
SRNC decides to initiate a combined hard handover and SRNS relocation. The UE
is still under control of the SRNC but is moving to a location controlled by
the target RNC. The scenario below describes the SRNS Relocation of the type
\"UE involved\".
The source RNC continues the downlink data transmission on radio bearers
supporting seamless SRNS relocation until the target RNC becomes the serving
RNC. The target RNC becomes the serving RNC when the RANAP Relocation Detect
message is sent.
A RANAP Relocation Command is received by the source RNC from the CN,
indicating the RABs to be released. The Target RNC to Source RNC Transparent
Container includes the RRC message (e.g. PHYSICAL CHANNEL RECONFIGURATION) for
hard handover. This message includes the new U-RNTI.
Upon reception of the RANAP Relocation Command, the source RNC triggers the
execution of the relocation of SRNS by sending the RRC message to the UE using
the acknowledged mode dedicated signalling radio bearer. Simultaneously PDCP
of the source RNC takes a snapshot of the header compression contexts on each
of those radio bearers and header compression protocols configured to apply
the context relocation and transfers them to target RNC during the
\"forwarding of SRNS contexts via the CN\" phase [7].
Upon reception and acknowledgment by the UE of the PHYSICAL CHANNEL
RECONFIGURATION message, the RLC entity for the acknowledged mode dedicated
signalling radio bearer (SRB #2) is re-established, both on the UTRAN (target
SRNC) and UE sides, and their HFN values are set to MAX(uplink HFN of RB2 \|
downlink HFN of RB2) + 1. Care should be taken by UTRAN in timing the SRNS
relocation so that there is no risk of a SN rollover on SRB #2 during this
procedure.
If the UE has successfully configured itself, it sends a response message, in
this case PHYSICAL CHANNEL RECONFIGURATION COMPLETE message to the target RNC
using the acknowledged mode dedicated signalling radio bearer (SRB #2). This
message is transmitted based on the new RLC context and contains the START
values (to be used in integrity protection and in ciphering on radio bearers
using UM and AM RLC). The UTRAN initialises and the UE reinitialises the PDCP
header compression protocols of the radio bearers configured to use a header
compression protocol without the context relocation [7]. For those radio
bearers and header compression protocols applying context relocation, UTRAN
initialises header compression protocols based on the context information
received from the source RNC and UE continues header compression without re-
initialisation. Further description of specific actions in UTRAN and UE in the
case of context relocation is found in [7].
Upon acknowledgement of the message, the RLC entities for the rest of the
affected radio bearers are re-established both on the UTRAN and UE side. The
HFN values for each RB are set to the START value in the message for the
corresponding CN domain. The HFN values for each remaining signalling radio
bearer (other than SRB #2) are set to the START value in the message for the
last configured CN domain.
The relocation procedure ends.
Figure 37: Combined Hard Handover and SRNS relocation (seamless radio bearers)
### 6.4.9 RRC Connection re-establishment
Figure 38: RRC connection re-establishment
Figure 38 shows an example of the procedure when a UE loses radio connection
due to e.g. radio link failure. After having selected a new cell, the UE RRC
sends the NW RRC a CELL UPDATE message. The CELL UPDATE message contains
information to the network that it was sent due to a radio link failure. The
NW RRC configures the NW and acknowledges the connection re-establishment to
the UE RRC with a CELL UPDATE CONFIRM message. The UE RRC configures the UE L1
to activate the new radio link(s). After the UE has synchronised to at least
one radio link, the MAC and RLC layers can be configured (if necessary).
When the procedure is completed on the UE side, a PHYSICAL CHANNEL
RECONFIGURATION COMPLETE message is sent.
### 6.4.10 Inter-system Handover: GSM/BSS to UTRAN
The handover from GSM/BSS to UTRAN for a dual-mode GSM MS / UMTS UE is
illustrated in figure 39. On the network side, upon the reception of a HARD
HANDOVER PROCEED 2 command through the RANAP protocol, the RRC layer performs
admission control and radio resource allocation assigning an RNTI for the RRC
connection and selecting radio resource parameters (such as transport channel
type, transport format sets, etc). RRC configures these parameters on layer 1
and layer 2 to locally establish the DCH logical channel.
The selected parameters including the RNTI, were previously transmitted to UE
via RANAP message HARD HANDOVER PROCEED 1 and GSM upgraded message HANDOVER
COMMAND.
Upon reception of the HANDOVER COMMAND message, the GSM RR layer transmits the
required parameters to the UMTS RRC layer using an RR-Data-IND primitive. UE
RRC configures L1 and L2 using these parameters to locally establish the DCH
logical channel. Layer 1 indicates to RRC when it has reached synchronisation.
An RLC signalling link establishment is then initiated by the UE. A HANDOVER
COMPLETE message is finally sent by the UE.
.
Figure 39: GSM to UMTS inter-system handover
### 6.4.11 Inter-RAT Handover: UTRAN to GSM/BSS, CS domain services
Figure 40: UTRAN to GSM inter-RAT handover
NOTE: The scope of this description is restricted to a UE having a connection
only to CS domain services, i.e. no simultaneous PS signalling connection.
For CS domain services UTRAN to GSM inter-RAT Handover procedure is based on
measurement reports from the UE but initiated from the UTRAN. HANDOVER FROM
UTRAN COMMAND is sent using acknowledged data transfer on the DCCH. The UE
transition from UTRAN Connected Mode starts when an HANDOVER FROM UTRAN
COMMAND is received. The transition to GSM Connected mode is finished when
HANDOVER COMPLETE message is sent from the UE.
UTRAN sends a RELOCATION REQUIRED to CN/AS. This message contains information
needed for the GSM system to be able to perform a handover (e.g. serving cell,
target cell). Some parts of this information (e.g. MS classmark) have been
obtained at setup of the RRC Connection and are stored in CN.
The CN/AS sends a HANDOVER REQUEST message to BSC-RR allocating the necessary
resources to be able to receive the GSM MS and acknowledge this by sending
HANDOVER REQUEST ACKNOWLEDGE to CN/AS. The HANDOVER REQUEST ACKNOWLEDGE
contains a GSM-RR message with all radio-related information that the UE needs
for the handover.
CN/AS sends a RELOCATION COMMAND (type UTRAN-to-BSS HARD HANDOVER) to the
UTRAN to start the execution of the handover. This message contains a GSM-RR
message with all the information needed for the UE to be able to switch to the
GSM cell and perform a handover to GSM.
Upon reception of the HANDOVER FROM UTRAN COMMAND message in the UE, the UE-
RRC entity forwards the GSM-RR message to the MS-RR entity. To release the
UTRA resources the MS-RR entity requests the UE-RRC entity to release the RRC
connection locally . The UE-RRC entity can then locally release the resources
on the RLC, MAC and physical layers of the UE.
After having switched to the assigned GSM channel received in the HANDOVER
FROM UTRAN COMMAND, the GSM MS sends HANDOVER ACCESS in successive layer 1
frames, just as it typically would have done for a conventional GSM handover
initiation.
When the BSC-RR has received the HANDOVER ACCESS it indicates this to the
CN/AS by sending a HANDOVER DETECT message. The BSC-RR sends a PHYSICAL
INFORMATION message to the GSM MS in unacknowledged mode that contains various
fields of physical layer -related information allowing a proper transmission
by the MS.
After layer 1 and 2 connections are successfully established, the GSM MS
returns the HANDOVER COMPLETE message.
CN/AS is then able to release the UTRAN resources that were used for the UE in
UTRAN Connected Mode. The CN/AS send a IU RELEASE COMMAND to UTRAN, after
which UTRAN can release all NW resources from RLC, MAC and the physical layer.
When the release operation is complete, a IU RELEASE COMPLETE message is sent
to CN / AS.
## 6.5 CN originated paging request in connected mode
### 6.5.1 UTRAN coordinated paging using DCCH
Figure 41: Example sequence of CN initiated paging request using DCCH
The above sequence illustrates a CN originated paging request, when the UE is
in connected mode and can be reached on the DCCH. The coordination of the
paging request with the existing RRC connection is done in UTRAN.
The entity above RRC on the network side requests paging of a UE over the Nt-
SAP. The request contains a UE paging identity, an area where the page request
is to be broadcast, information for calculation of the paging group.
Since the UE can be reached on the DCCH, the RRC layer formats a PAGING TYPE 2
message containing the UE paging identity, and the message is transmitted
directly to the UE using unacknowledged data transfer.
## 6.6 UTRAN originated paging request and paging response
Figure 42: Example sequence for UTRAN initiated paging request with paging
response
The RRC layer in the network uses this sequence to trigger a switch to
CELL_FACH state, when the UE can only be reached on the PCH (the CELL_PCH
state or the URA_PCH state). A Paging Type 1 message is prepared, containing
the UTRAN UE identity (s-RNTI + RNC-ID). The RRC requests the transmission of
the message by MAC on the PCCH, indicating the paging group.
In the UE, the RRC layer continuously monitors the paging group on the PCH and
compares the UE identities in received paging request messages with its own
identities. A match occurs, and in this case the RRC layer changes state to
CELL_FACH state.
The UE prepares a Cell Update message, which is sent on CCCH.
When the network receives the Cell Update message, a c-RNTI is allocated and
signalled to UE using the Cell Update Confirm message, which is sent on DCCH
using unacknowledged mode. The latter message also acknowledges the reception
of the Cell Update message. The UE configures MAC to use the new c-RNTI and
prepares a UTRAN MOBILITY INFORMATION CONFIRM message. When the network
receives the UTRAN MOBILITY INFORMATION CONFIRM message on DCCH it can delete
any old c-RNTI and the DCCH/DTCH logical channels can be used also in the
downlink using the new c-RNTI.
## 6.7 Other procedures
### 6.7.1 UE Capability Information
Figure 43: UE Capability Information
The UE transfers its capability information to the network by transmitting the
RRC message UE Capability Information using acknowledged mode on the DCCH.
UTRAN confirms the reception of the UE capabilities by transmitting an UE
CAPABILITY INFORMATION CONFIRM message using acknowledged mode on the DCCH.
This procedure is performed during the lifetime of the RRC Connection if the
UE capability information changes (e.g. due to change in UE power class). UE
capability information can also explicitly be requested by UTRAN.
### 6.7.2 Random access transmission sequence (FDD)
Figure 44: Random access transmission sequence (FDD)
The RACH and AICH are configured once via a CPHY-TrCH-Config-REQ primitive.
This primitive is issued only for initial configuration or when a parameter
shall be changed, not for every RACH transmission.
The CMAC-Config-REQ primitive is used to configure MAC parameters required for
the random access procedure (e.g. persistence value, maximum number of
preamble ramping cycles, initial and subsequent backoff times).
When there is data to be transmitted on the RACH, i.e. reception of a MAC-
Data-REQ primitive, the RACH transmission control procedure is started, which
includes selection of Access Service Class (ASC).
After some initial backoff, a primitive PHY-Access-REQ containing the selected
ASC is sent to L1. This triggers the PRACH preamble transmission procedure,
i.e. the physical layer selects a PRACH access slot and signature without
further backoff delay imposed on L1, but within the constraints of the
selected ASC.
If the maximum permitted transmission power was reached without receiving an
acknowledgement, or a negative acknowledgement (Nack) has been received on
AICH, the preamble ramping cycle is repeated. The number of preamble ramping
cycles is counted in MAC.
Upon successful transmission of a preamble, MAC receives an acknowledgement
via PHY-Access-CNF primitive that the acquisition indicator was received. Then
message transmission is requested with the PHY-Data-REQ primitive.
### 6.7.3 Random access transmission sequence (TDD)
#### 6.7.3.1 Random access transmission sequence (3.84 Mcps TDD)
Figure 45: Random access transmission sequence (3.84 Mcps TDD)
The RACH is configured once via a CPHY-TrCH-Config-REQ primitive. This
primitive needs to be used only for initial configuration (e.g. power
parameter) or when a parameter shall be changed, not for every RACH
transmission.
The CMAC-Config-REQ primitive is used to configure MAC parameters required for
the random access procedure. The parameters could include random access
control parameters such as, persistence value and Access Service Class (ASC)
parameters.
When there is data to be transmitted on the RACH, i.e. reception of a MAC-
Data-REQ primitive, the RACH transmission control procedure is started, which
includes selection of an Access Service Class (ASC).
After some backoff, a primitive PHY-Data-REQ is sent to L1, which triggers the
PRACH message transmission, i.e. the physical layer selects a PRACH spreading-
code without further backoff delay imposed on L1, but within the constraints
of the selected ASC. Note that the backoff time on MAC may in certain
conditions be set to zero (e.g. when the uplink load is low).
At the UTRAN-side MAC the further processing of received RACH message depends
on the MAC header. An acknowledgement that the message was received correctly
is given by a RRC procedure. In case of transparent RLC, message
retransmission shall be handled entirely on RRC employing retransmission
timers. In case of non-transparent RLC, the timers are controlled by the RLC.
The parameters of PRACH transmission are chosen such that the number of
retransmissions for the messages are kept low. Message loss on the PRACH
should be due to a collision on the same spreading code.
#### 6.7.3.2 Random access transmission sequence (1.28 Mcps TDD)
Figure 46: Random access transmission sequence(1.28 Mcps TDD)
The RACH is configured once via a CPHY-TrCH-Config-REQ primitive. This
primitive needs to be used only for initial configuration or when a parameter
shall be changed, not for every RACH transmission.
The CMAC-Config-REQ primitive is used to configure MAC parameters required for
the random access procedure. The parameters could include random access
control parameters such as persistence value, Access Service Class (ASC)
parameters and maximum number of synchronisation attempts.
When there is data to be transmitted on the RACH, i.e. reception of a MAC-
Data-REQ primitive, the RACH transmission control procedure is started, which
includes selection of an Access Service Class (ASC).
After some backoff, a primitive PHY-Access-REQ is sent to L1, which triggers
the PRACH message transmission, i.e. the physical layer selects a SYNC_UL code
without further backoff delay imposed on L1, but within the constraints of the
selected ASC.
If PHY received no acknowledgement on the FPACH and the maximum number of
synchronisation attempts permitted has not been exceeded, the PHY-Access-REQ
procedure is repeated.
If the SYNC_UL burst has been acknowledged on the FPACH, MAC receives an
acknowledgement via PHY-Access-CNF primitive. Then data transmission is
requested with a PHY-DATA-REQ primitive, and the PRACH transmission procedure
shall be completed with transmission of the PRACH message on the PRACH
resources associated with FPACH.
### 6.7.4 Void
# 7 Traffic volume monitoring
An algorithm will be defined for the UE to trigger a message to the NW based
on transmitter buffer status.
Figure 48 illustrates the example of message sequence of traffic volume
monitoring procedure. RRC in UE gets the parameters necessary for traffic
volume measurement from Measurement Control message or System information
message sent by RRC in UTRAN. RRC in UE passes the MAC the parameters for
traffic volume measurement with the CMAC-Measurement-REQ. Meanwhile, RLC
passes the data to MAC with buffer status. There are two ways MAC indicates
the traffic volume measurement report to RRC, periodic and event-triggered. If
it is periodic report, the MAC reports the measurement result to RRC
periodically. If it is event-triggered, MAC in UE reports the measurement
result to RRC when the result is beyond the specified threshold value. After
that, based on the measurement report from MAC and reporting criteria received
from UTRAN, RRC makes a decision whether it should send Measurement Report
Message to UTRAN. When RRC in UTRAN receives the Measurement Report Message,
it takes a proper action based on the measurement report from UE. It can be
bearer reconfiguration, transport channel reconfiguration, physical channel
reconfiguration or transport channel combination control procedure. The report
mode, periodic and event-triggered, can be used exclusively, or simultaneously
as shown in figure 1.
Figure 48: Traffic Volume Measurement Report Procedure
#