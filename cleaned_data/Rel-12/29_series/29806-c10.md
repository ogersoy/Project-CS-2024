# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document analyses existing P-CSCF restoration mechanism
limitations and drawbacks, as defined by 3GPP TS 23.380 [2] and 3GPP TS 24.229
[3], and proposes alternative solutions that could minimize such limitations.
Expected output from this document is a proposal of an enhanced P-CSCF
restoration mechanism.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.380: \"IMS Restoration Procedures\".
[3] 3GPP TS 24.229: \"IP multimedia call control protocol based on Session
Initiation Protocol (SIP) and Session Description Protocol (SDP); Stage 3\".
[4] 3GPP TS 29.061: \"Interworking between the Public Land Mobile Network
(PLMN) supporting packet based services and Packet Data Networks (PDN)\".
[5] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[6] 3GPP TS 23.060: \"General Packet Radio Service (GPRS); Service
description; Stage 2\".
[7] GSMA IR.92: \"IMS Profile for Voice and SMS\".
[8] 3GPP TS 29.281: \"General Packet Radio System (GPRS) Tunnelling Protocol
User Plane (GTPv1-U)\".
[9] IETF RFC 4960 (September 2007): \"Stream Control Transmission Protocol\".
[10] 3GPP TS 24.303: \"Mobility management based on Dual-Stack Mobile
IPv6;Stage 3\".
[11] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols; Stage 3\".
[12] IETF RFC 5626 (October 2009): \"Managing Client-Initiated Connections in
the Session Initiation Protocol (SIP)\".
# 3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply.\ An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
AAA Authentication Authorization Answer
AAR Authentication Authorization Request
AS Application Server
ATCF Access Transfer Control Function
AVP Attribute Value Pair
IBCF Interconnection Border Control Function
iFC Initial Filter Criteria
GW Gateway
PCC Policy and Charging Control
PCO Protocol Configuration Options
PCRF Policy and Charging Rules Function
P-CSCF Proxy CSCF
P-GW PDN GW
RAA Re-Authorization Answer
RAR Re-Authorization Request
SRVCC Single Radio Voice Call Continuity
STN-SR Session Transfer Number for SRVCC
T-ADS Terminating Access Domain Selection
# 4 Existing restoration procedures
## 4.1 Introduction
### 4.1.1 Stage 2 description of existing restoration procedures
#### 4.1.1.1 Specified mechanisms
A mobile IMS UE on 3GPP access is unreachable for terminating calls after a
P-CSCF failure, either a node total failure or just loss of related UE
registration information (e.g. P-CSCF may have restarted and be up and
running, but any registration data is lost). Without any P-CSCF restoration
mechanism, the UE is reachable for terminating calls only when:
  * the UE's registration timer expires, which implies a new registration. This timer value depends on operator configuration preferences, but in the worst case it may take several hours.
  * the UE attempts to make an outgoing call.
Therefore, until any of these actions occur, any call for this UE arriving to
terminating S-CSCF is rejected.
From 3GPP Rel-9 onwards, P-CSCF restoration procedures were standardized,
trying to minimize the time a UE is unreachable for terminating calls after a
P-CSCF failure. 3GPP TS 24.229 [3] and 3GPP TS 23.380 [2] specify some
optional restoration procedures for handling of P-CSCF failure.
3GPP TS 23.380 [2] clause 5 specifies 3 mechanisms in Rel-9 for stage 2:
  * **\"Update PDP context/Bearer at P-CSCF failure\":**
> At IMS registration, the P-CSCF, via Rx, informs the PCRF which informs the
> PGW of the P-CSCF identity. Then the PGW monitors the health of the P-CSCF.
> In case of failure of the P-CSCF, the PGW updates the list of P-CSCFs in the
> UE using the PCO functionality. The UE selects another P-CSCF for a new
> initial IMS registration. This is described in more detail in clause
> 4.1.1.2.
>
> 3GPP TS 24.229 [3] clause B.2.2.1C specifies the stage 3 of this P-CSCF
> restoration procedure.
  * **\"Inform UE about P-CSCF failure\":**
> This is a variant of the above for UEs where the PGW only indicates a P-CSCF
> failure to the UE which selects another P-CSCF by another mean (e.g. with a
> DHCP).
>
> No stage 3 protocol support has been defined for this stage 2 solution.
  * **\"UE uses keep-alive mechanism\":**
> After IMS registration, the UE monitors the health of the P-CSCF. If it
> detects a failure, the UE selects another P-CSCF for a new initial
> registration.
>
> 3GPP TS 24.229 [3] clause B.2.2.1C specifies the stage 3 of this P-CSCF
> restoration procedure.
##### 4.1.1.2 \"Update PDP context/Bearer at P-CSCF failure\" mechanism
The \"Update PDP context/Bearer at P-CSCF failure\" mechanism is summarized in
figure 4.1.1.2-1
{width="4.586805555555555in" height="2.5381944444444446in"}
Figure 4.1.1.2-1: Existing P-CSCF restoration mechanism
Steps in figure 4.1.1.2-1 explanation follows:
1\. UE initially registers to IMS.
2\. In connection with the UE registration, the P-CSCF selected by the UE via
Rx provides the PCRF with its SIP address. The PCRF in its turn then uses a Gx
push procedure to provide this P-CSCF address to the P-GW/GGSN. P-CSCF address
is then stored by P-GW/GGSN.
3\. The P-GW/GGSN monitors periodically the availability of all P-CSCFs to
which the UEs it serves are attached to.
4\. When P-GW/GGSN considers a P-CSCF as failed, then P-GW/GGSN sends Update
Bearer Request/Update PDP Context Request to all UEs associated with this
P-CSCF, including a new PCO (Protocol Configuration Options) IE with a list of
available P-CSCF addresses, which does not include the failed P-CSCF address.
> The UE will perform upon receiving the Update Bearer Request/ Update PDP
> Context Request (with the list of P-CSCF addresses) a new initial
> registration towards IMS, by using a different P-CSCF, since former P-CSCF
> will not be included in the list.
### 4.1.2 Stage 3 description of existing restoration procedures and P-CSCF
discovery
#### 4.1.2.1 Introduction
Clause 4.1.2 describes the existing Stage 3 P-CSCF restoration procedures
according to the type of access. P-CSCF discovery methods defined per access
are summarized and it is highlighted which ones are used by the P-CSCF
restoration procedures to inform the UE of possible alternative P-CSCFs that
will replace the failed one.
#### 4.1.2.2 3GPP accesses
##### 4.1.2.2.1 GPRS
3GPP TS 24.229 [3] clause B.2.2.1 describes 4 methods for P-CSCF discovery:
\- Method I: Use of DHCP;
\- Method II: With the PDP context activation (PCO);
\- Method III: List stored in ISIM;
\- Method IV: List in P-CSCF management object.
3GPP TS 24.229 [3] clause B.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
_A if the UE used method II for P-CSCF discovery and if the UE receives one or
more P-CSCF address(es) in the Protocol Configuration Options information
element of an Modify EPS Bearer Context Request message the one or more P-CSCF
addresse(s) do not include the address of the currently used P-CSCF, then the
UE shall acquire a different P-CSCF address from the one or more P-CSCF
addresse(s) in the Modify EPS Bearer Context Request message. If more that one
P-CSCF address with the same container identifier (i.e. \"P-CSCF IPv6
Address\" or \"P-CSCF IPv4 Address\") are included, then the UE shall assume
that the more that one P-CSCF addresses with the same container identifier are
prioritised with the first P-CSCF address with the same container identifier
within the Protocol Configuration Options information element as the P-CSCF
address with the highest priority;_
_B if the UE uses RFC 6223 [143] as part of P-CSCF restoration procedures, and
if the P-CSCF fails to respond to a keep-alive request, then the UE shall
acquire a different P-CSCF address using one of the methods I, III and IV for
P-CSCF discovery described in the subclause L.2.2.1._
##### 4.1.2.2.2 E-UTRAN
3GPP TS 24.229 [3] clause L.2.2.1 describes 4 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: With the bearer context activation (PCO);
  * Method III: List stored in ISIM;
  * Method IV: List in P-CSCF management object.
3GPP TS 24.229 [3] in clause L.2.2.1C describes the P-CSCF restoration
procedures in the following extract:
_A if the UE used method II for P-CSCF discovery and if the UE receives one or
more P-CSCF address(es) in the Protocol Configuration Options information
element of an Modify EPS Bearer Context Request message the one or more P-CSCF
addresse(s) do not include the address of the currently used P-CSCF, then the
UE shall acquire a different P-CSCF address from the one or more P-CSCF
addresse(s) in the Modify EPS Bearer Context Request message. If more that one
P-CSCF address with the same container identifier (i.e. \"P-CSCF IPv6
Address\" or \"P-CSCF IPv4 Address\") are included, then the UE shall assume
that the more that one P-CSCF addresses with the same container identifier are
prioritised with the first P-CSCF address with the same container identifier
within the Protocol Configuration Options information element as the P-CSCF
address with the highest priority;_
_B if the UE uses RFC 6223 [143] as part of P-CSCF restoration procedures, and
if the P-CSCF fails to respond to a keep-alive request, then the UE shall
acquire a different P-CSCF address using one of the methods I, III and IV for
P-CSCF discovery described in the subclause L.2.2.1._
#### 4.1.2.3 Non-3GPP accesses
##### 4.1.2.3.1 WLAN
3GPP TS 24.229 [3] clause D.2.2.1 describes 3 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: Use of DNS;
  * Method III: List in P-CSCF management object.
3GPP TS 24.229 [3] clause D.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
> _If the P-CSCF fails to respond to keep-alive requests the WLAN UE shall
> acquire a different P-CSCF address using any of the methods described in the
> subclause D.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
##### 4.1.2.3.2 Fixed broadband connection
3GPP TS 24.229 [3] clause E.2.2.1 describes 3 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: List in P-CSCF management object.
3GPP TS 24.229 [3] clause E.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
> _If the P-CSCF fails to respond to keep-alive requests the UE shall acquire
> a different P-CSCF address using any of the methods described in the
> subclause E.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
##### 4.1.2.3.3 Data Over Cable Service Interface Specification (DOCSIS)
3GPP TS 24.229 [3] clause H.2.2.1 refers to clause 9.2.1 which describes
methods for P-CSCF discovery of which 2 seem here applicable:
  * Method I: Use of DHCP;
  * Method III: Pre-configured P-CSCF addresses.
3GPP TS 24.229 [3] in clause H.2.2.1C describes the P-CSCF restoration
procedures in the following extract:
> _If the P-CSCF fails to respond to the keep-alive request the UE shall
> acquire a different P-CSCF address using any of the methods described in the
> subclause H.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
##### 4.1.2.3.4 Cdma2000 packet data subsystem
3GPP TS 24.229 [3] clause M.2.2.1 describes 3 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: List stored in IMC;
  * Method III: List in P-CSCF management object.
3GPP TS 24.229 [3] clause M.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
> _If the P-CSCF fails to respond to the keep-alive request the UE shall
> acquire a different P-CSCF address using any of the methods described in the
> subclause M.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
##### 4.1.2.3.5 EPC via Cdma2000 High Rate Packet Data (HRPD)
3GPP TS 24.229 [3] clause O.2.2.1 describes 4 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: List stored in IMC;
  * Method III: List in P-CSCF management object;
  * Method IV: With the bearer context activation (PCO).
3GPP TS 24.229 [3] clause O.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
_A if the UE used method II for P-CSCF discovery and if the UE receives one or
more P-CSCF address(es) in an VSNCP Configure-Request message and the one or
more P-CSCF addresse(s) do not include the address of the currently used
P-CSCF, then the UE shall acquire a different P-CSCF address from the one or
more P-CSCF addresse(s) in the VSNCP Configure-Request message. The UE shall
assume that the more than one P-CSCF address are prioritised with the first
P-CSCF address within the Protocol Configuration Options information element
as the P-CSCF address with the highest priority;_
_B if the UE uses RFC 6223 [143] as part of P-CSCF restoration procedures, and
if the P-CSCF fails to respond to a keep-alive request, then the UE shall
acquire a different P-CSCF address using one of the methods I, II and III for
P-CSCF discovery described in the subclause O.2.2.1._
##### 4.1.2.3.6 WLAN using EPC
3GPP TS 24.229 [3] clause R.2.2.1 describes 4 methods for P-CSCF discovery:
  * Method I: Use of DHCP;
  * Method II: Use of DNS;
  * Method III: List in P-CSCF management object.
3GPP TS 24.229 [3] clause R.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
> _If the P-CSCF fails to respond to keep-alive requests the UE shall acquire
> a different P-CSCF address using any of the methods described in the
> subclause R.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
##### 4.1.2.3.7 Digital Video Broadcasting -- Return Channel via Satellite
(DVB-RCS2)
3GPP TS 24.229 [3] clause S.2.2.1 refers to clause 9.2.1 which describes
methods for P-CSCF discovery of which 2 seem here applicable:
  * Method I: Use of DHCP;
  * Method III: Pre-configured P-CSCF addresses.
3GPP TS 24.229 [3] clause S.2.2.1C describes the P-CSCF restoration procedures
in the following extract:
> _If the P-CSCF fails to respond to the keep-alive request the UE shall
> acquire a different P-CSCF address using any of the methods described in the
> subclause S.2.2.1 and perform an initial registration as specified in
> subclause 5.1._
### 4.1.3 GSMA specifications related to P-CSCF restoration
GSMA IR.92 [7] clause 4.4 describes the \"P-CSCF discovery\" in the following
extract:
> _The UE and packet core must support the procedures for P-CSCF discovery via
> EPS. These are described in 3GPP TS 24.229 [15], Annex L.2.2.1 as option II
> for P-CSCF discovery._
This P-CSCF discovery is based on the bearer context activation (PCO) (see
clause 4.1.2.2.2).
GSMA IR.92 [7] does not reference P-CSCF restoration procedures.
## 4.2 Limitations and drawbacks
### 4.2.1 Limitations of \"Update PDP context/Bearer at P-CSCF failure\"
This mechanism has the following limitations and drawbacks:
A) **Massive core and radio networks signalling**
> Once P-GW/GGSN determines that a P-CSCF is down, it has to send an Update
> Bearer Request/Update PDP Context Request for every UE currently registered
> with the failing P-CSCF, in order to provide the UE with an updated list of
> available P-CSCF addresses. Then, each of the notified UEs will register
> again to IMS, using one of the new provided P-CSCF addresses.
>
> The number of users that can be handled by a P-CSCF can be large which means
> that massive core and radio network signalling will be triggered due to the
> P-CSCF failure, both for sending the Update Bearer Request/Update PDP
> Context Request message to every UE as well as for the resulting new initial
> IMS registration attempts performed by every affected UE. This procedure may
> even involve paging the UEs, if the associated UEs are in idle mode.
B) **Not fully reliable**
The current restoration mechanism may in some cases not be fully reliable,
like in the following situations:
> \- In case of a P-CSCF partial failure (i.e. registration data is not
> available for a set of subscribers) or when P-CSCF has restarted after the
> failure (registration data is lost), P-GW/GGSN may consider this P-CSCF is
> available and therefore restoration mechanism is not performed. However,
> terminating calls will fail, either for all or just a set of subscribers,
> since registration data is not available.
>
> \- A (temporary) network problem may cause the P-GW/GGSN to assume the
> P-CSCF is down and thereby trigger the restoration procedure unnecessarily.
C) **UE support**
> The current restoration mechanism requires specific UE support, since the UE
> shall be able to re-register to any of the newly provided P-CSCF addresses.
>
> However, GSMA IR.92 [7] compliant UEs follow the Rel-8 3GPP TS 24.229 [3]
> that only include P-CSCF discovery mechanism not P-CSCF restoration
> procedures, since the P-CSCF restoration trigger based on Update Bearer
> Request/Update PDP Context Request was introduced in Rel-9 as an optional
> procedure in 3GPP TS 24.229 [3]. Therefore, the UE may ignore any P-CSCF
> address in an Update Bearer Request/Update PDP Context Request, and then
> will not perform a new registration and as a result continue to be
> unavailable.
D) **Poor service availability**
> UE registration with a new available P-CSCF may take a long time with the
> current restoration mechanism, since the request to re-register is sent to
> all UEs for a P-CSCF. This becomes even worst due to the chance to get into
> an overload situation. The time requested to process this restoration
> mechanism results in a loss of new terminating sessions when they occur
> between the P-CSCF failure and the new IMS registration.
>
> In the case of P-CSCF partial failure, as described above due to the
> mechanism unreliability, terminating calls keeps failing until the UE
> registration timer expires or it performs an outgoing call.
E) **Access applicability**
> This mechanism only applies over 3GPP accesses.
### 4.2.2 Limitations of \"Inform UE about P-CSCF failure\"
The limitations of this mechanism are the same as with the \"Update PDP
context/Bearer at P-CSCF failure\" mechanism.
Apart the above limitations, the P-CSCF restoration mechanism for the case
where the UE uses DHCP for initial P-CSCF discovery is not fully standardized.
Stage 2 behaviour for this case is described in 3GPP TS 23.380 [2] clause 5.2,
however this is not fully implemented in corresponding stage 3 TSs. More
specifically, when P-GW/GGSN detects P-CSCF failure, then it has to inform the
UE about this, however this indication is not standardized. It corresponds to
steps 12 and 13 in 3GPP TS 23.380 [2] figure 5.2.2a. Anyway, it has to be
noted that GSMA IR.92 [7] mandates to use PCO based P-CSCF discovery, since
this problem will only apply to non GSMA compliant UEs.
### 4.2.3 Limitations and criteria comparison of \"UE using keep-alive\"
#### 4.2.3.1 Limitations
The limitations of this mechanism are:
  * A continuous extra signalling between the UEs and the P-CSCF, involving resources in the RAN and in the CN.
  * A peak signalling when a P-CSCF failure occurs; it should be less important than the one with the two previous mechanisms as the expiry of the keep-alive timer will happen at a different time from an UE to another; nevertheless this will depend of the duration of the keep-alive timer;
  * A limited loss of new terminating sessions when they occur between the P-CSCF failure and the new IMS registration triggered by the expiration of the keep-alive timer
\- The keep-alive functionality is not supported in GSMA IR.92 [7]; many UEs
may not support this mechanism, with the consequence to wait for the expiry of
the IMS registration timer to initiate a new registration.
#### 4.2.3.2 Criteria analysis
The following table summarizes comparison criteria fulfilment as defined in
clause 7.1.2. This will allow comparing this existing mechanism with the
solutions presented in clause 6.
Table 4.2.3.2-1: Comparison criteria fulfilment
+---------------------------+------------+---------------------------+ | Criteria | Fulfilment | Evaluation | +---------------------------+------------+---------------------------+ | Avoid massive signalling | Partial | The keep-alive timers in | | | | the UEs do not stop at | | | | the same time. So there | | | | is a statistical spread | | | | of the new IMS | | | | registrations. As the | | | | keep-alive timer is | | | | short, the new | | | | registrations of UEs will | | | | mainly occur during this | | | | period and nevertheless | | | | maintain a peak | | | | signalling. | +---------------------------+------------+---------------------------+ | Improve reliability | Yes | The detection of the | | | | P-CSCF failure is done on | | | | a per UE basis. | +---------------------------+------------+---------------------------+ | Do not impact existing | No | The keep-alive mechanism | | GSMA compliant UE | | is not an option | | | | supported by GSMA. | | | | | | | | This does not provide a | | | | solution for legacy UEs | | | | not implementing this | | | | keep-alive mechanism. | +---------------------------+------------+---------------------------+ | Service availability | Almost | A limited loss of new | | | | terminating sessions when | | | | they occur between the | | | | P-CSCF failure and the | | | | new IMS registration | | | | triggered by the | | | | expiration of the | | | | keep-alive timer. | +---------------------------+------------+---------------------------+ | Minimize H-PLMN resource | Yes | No HPLMN resources are | | usage to provide visited | | involved for the | | P-CSCF recovery | | restoration mechanisms | +---------------------------+------------+---------------------------+ | Applicability | Partial | The keep- alive mechanism | | | | generates a small but | | | | permanent signalling for | | | | a P-CSCF failure event | | | | that will be exceptional. | | | | | | | | This additional | | | | signalling uses radio | | | | resources. It may cause | | | | frequent transitions from | | | | idle to connected mode | | | | and vice-versa, which | | | | causes signalling | | | | overhead in the RAN and | | | | EPC (MME/SGSN, SGW). | | | | | | | | This additional | | | | signalling should be | | | | acceptable on fixed lines | | | | or many non 3GPP accesses | | | | (e.g. Wi-Fi). | +---------------------------+------------+---------------------------+ | Impacted elements | 2 | The UE and the P-CSCF are | | | | the only impacted | | | | elements. | | | | | | | | The functional impacts | | | | are small (simple | | | | mechanism). | | | | | | | | The UE and the P-CSCF | | | | have to manage the | | | | keep-alive mechanism. | | | | | | | | No enhancements of the | | | | keep-alive mechanism are | | | | identified. | +---------------------------+------------+---------------------------+ | Impacted interfaces | 1 | The interface between the | | | | UE and the P-CSCF. | +---------------------------+------------+---------------------------+ | Complexity | Low | The UE and the P-CSCF | | | | have to support the | | | | keep-alive mechanism. | +---------------------------+------------+---------------------------+ | Performance impact | Low | There is a P-CSCF impact | | | | to simultaneously | | | | maintain many keep-alive, | | | | so requiring extra | | | | resources. | +---------------------------+------------+---------------------------+ | Roaming considerations | Yes | No impact. | +---------------------------+------------+---------------------------+ | PDN connection reattach | No | No PDN disconnection | | required | | required. | +---------------------------+------------+---------------------------+ | Coexistence with existing | - | It is an existing | | mechanism | | mechanism. | +---------------------------+------------+---------------------------+ | Added value | - | | +---------------------------+------------+---------------------------+ | Limitations or drawbacks | - | C.f. 4.2.3.1. | +---------------------------+------------+---------------------------+
# 5 Objectives
The present document is expected to agree on a mechanism to enhance existing
standardized P-CSCF restoration procedure for 3GPP accesses, therefore it
shall avoid or at least minimize existing limitations and drawbacks, as
described in clause 4.2.2:
**\- Avoid massive signalling over the core and radio networks.**
> This is of special importance when a P-CSCF handles a large number of UEs,
> since it may cause network overload.
**\- Improve reliability.**
> Avoid false positive or false negative detection scenarios, triggering
> P-CSCF restoration mechanism only when it is required.
**\- Do not impacting existing GSMA compliant UE.**
**\- Improve service availability.**
> Improve the perceived service availability for UEs.
  * Avoid losing new sessions establishments (e.g. voice, multimedia originating or terminating calls).
NOTE: There is some more flexibility for other services like SMS (it is
acceptable that the SMS may be delivered later) or for telepresence as an IMS
service it is acceptable to have some losses. In the same way, interruption of
IMS established sessions is accepted (according to 3GPP TR 23.820 clause 4.3).
At the same time, the new procedure should maintain one important benefit with
existing mechanisms, i.e.it does not impact H-PLMN resource usage to provide
recovery solution for a visited P-CSCF.
# 6 Solution alternatives
## 6.1 Introduction
This clause includes several alternative solutions.
Each one includes an overview of the solution, a detailed description, an
explanation of how this alternative can coexist with existing Rel-9 P-CSCF
Restoration mechanism and an argumentation on how objectives are fulfilled.
## 6.2 Sol-A: Double IMS registration
### 6.2.1 Overview
This solution relies on a double IMS registration of the UE via different
P-CSCFs. If one of the P-CSCF fails, new IMS sessions will go through the
available P-CSCF.
### 6.2.2 Principles
The UE supports the multiple IMS registration feature via two different
P-CSCFs. This feature has been specified in 3GPP TS 24.229 [3] from Rel8 and
is relying on the IETF RFC 5626 [12] which describes multiple registrations
with the main use case to support failures between the UA and the registrar.
IETF RFC 5626 [12] clause 3.4 describes a topology with multiple registrations
through two edge proxies between the UA and the registrar, so corresponding to
the configuration of two P-CSCFs between the UE and the S-CSCF. The UE has the
logic to manage a P-CSCF restoration.
Two UE behaviours are considered:
  * A mode where two PDN connections with the same APN are established with the same PGW but with different IP addresses, so with different IMS contact addresses. Then an IMS registration is set up via each PDN connection to a different P-CSCF.
  * A mode where one PDN connection is established with a PGW. Then two IMS registrations are set up over this PDN connection with the same IMS contact address towards different P-CSCFs.
When the P-CSF failure has been detected by the UE and the S-CSCF, the new IMS
sessions are handled though the second P-CSCF associated to the second
registration.
When ATCF and SRVCC are used, it is considered that, although there are
several IMS registrations, as there is only one UE, there is no issue in the
choice of the UE for the CS leg, but it will be associated to only one of the
IMS registration which will be selected by the SCC AS.
### 6.2.3 Description
#### 6.2.3.1 Detection of the P-CSCF failure
The UE may detect a P-CSCF failure when trying to establish a new IMS session
or when doing an IMS re-registration.
The S-CSCF may detect a P-CSCF failure when trying to establish a terminating
session.
#### 6.2.3.2 Registration
The UE supporting the double registration feature initiates and maintains two
IMS registrations via different P-CSCFs.
The UE after having detected the P-CSCF failure may:
\- try to do another registration to a 3rd P-CSCF, so to maintain a double
registration; this supposes that, in normal conditions, the UE has a list of
at least 3 P-CSCFs through which it can establish an IMS registration;
\- try new registration attempts towards the failed P-CSCF until it recovers,
while using the second P-CSCF for signalling traffic handling. This may happen
when the UE, in normal conditions, has a list of only two possible P-CSCFs.
The timer between two attempts can be long as the second P-CSCF is used in
parallel, allowing to limit the additional signalling and to spread it over
time.
#### 6.2.3.3 New originating sessions:
In normal conditions, the UE may use:
  * one IMS registration for some communications, and the second IMS registration for other communications;
  * use always the same IMS registration for all the communications. The second IMS registration is like a standby registration.
When the UE has detected a P-CSCF failure and needs to establish a new
session, it will use the available P-CSCF associated to the second
registration.
#### 6.2.3.4 New terminating sessions
In normal conditions, the S-CSCF may:
  * use one IMS registration for some communications, and the second IMS registration for other communications;
  * use always the same IMS registration for all the communications. The second IMS registration is like a standby registration.
The S-CSCF, after having detected the P-CSCF failure, will route the
terminating session to the P-CSCF associated to the second registration.
If the same IMS registration is not used by the UE and the S-CSCF (stand by
type), a failure of the associated P-CSCF may not be detected. It is
considered that the re-establishment of the failed IMS registration may wait
until a new re-registration occurs that will detect the failure on the UE
side. As in the meantime the other IMS registration is used by both the UE and
the S-CSCF to convey SIP signaling for calls, even if the second registration
is not immediately detected and re-established, this does not create an issue.
### 6.2.4 Coexistence with existing solution
Regarding the coexistence with the PCO based mechanism, 3GPP TS 24.229 [3] in
clause B.2.2.1C mentions:
> _B. if the UE uses RFC 6223 [143] as part of P-CSCF restoration procedures,
> and if the P-CSCF fails to respond to a keep-alive request, then the UE
> shall acquire a different P-CSCF address using one of the methods I, III and
> IV for P-CSCF discovery described in the subclause B.2.2.1._
>
> 3GPP TS 24.229 [3] in this case only mentions the use of methods I, III and
> IV, that apply to the solution A. So UE using solution A will not use the
> Method II (PCO based P-CSCF discovery) so without arising a coexistence
> issue. This is nevertheless a limitation of solution A.
Regarding the coexistence with the keep alive mechanism, 3GPP TS 24.229 [3] in
clause 9.2.2A mentions :
> _NOTE 2: A UE registered through the procedures described in RFC 5626 [92]
> can use the keep-alive mechanism to monitor the status of the P-CSCF._
>
> Although the keep-alive mechanism is not precluded to be used over 3GPP
> accesses, it creates significant traffic over the radio access. It is
> considered that the re-establishment of the failed IMS registration may wait
> until a new re-registration occurs that will detect the failure on UE side.
> As in the meantime, the other IMS registration is used by both the UE and
> the S-CSCF to convey SIP signaling for calls, even if the second
> registration is not immediately detected and re-established, this does not
> create an issue.If the \"Double IMS Registration\" solution is used for a
> UE, then the keep-alive mechanism may not be used by the UE.
### 6.2.5 Objective compliance
Hereafter is reviewed the compliance of the solution towards the objectives
listed in clause 5.
\- Avoid massive signalling over the core and radio networks.
> The reestablishment of the failed path with a new registration can be spread
> over time, as the second registration is used in the meantime. In addition,
> if the attempts to re-establish the failed registration are towards the
> failed P-CSCF, a rather long and defined on a per UE basis timer can be used
> to minimize the signalling traffic.
\- Improve reliability.
> Reliability is improved in comparison with existing mechanisms.
>
> The detection of the P-CSCF failure is done on a per UE basis when
> attempting the establishment of new IMS sessions, originating or
> terminating. This covers complete or partial failure of the P-CSCF.
\- Do not impact existing GSMA compliant UEs.
> This solution requires the support of the IMS multiple registration feature
> plus the additional functionality for the support of the P-CSCF restoration.
> This is not supported by existing GSMA compliant UEs.
\- Improve service availability.
> The double registration solution allows maintaining the service availability
> when establishing new IMS sessions, originating or terminating.
>
> Service availability is not dependent on massive signalling.
  * Minimize H-PLMN resource usage to provide recovery solution for a visited P-CSCF.
> The solution requires some resources in the S-CSCF to maintain two IMS
> registrations.
The solution A covers the main objectives, apart the impact on existing GSMA
compliant UEs and has the following other drawbacks:
\- It requires the UE to support the multiple registration mechanism for a use
with P-CSCF restoration, which represents a significant implementation impact.
\- It does not apply to existing terminals (in addition to the GSMA IR-92
compliant ones) which do not support multiple registrations.
\- It increases the resources to be allocated for the UE in the network. These
resources have no usage in normal conditions; MME/SGSN, SGW, PGW (when two PDN
connections), P-CSCF, S-CSCF (for the double IMS registration). They are only
used for an exceptional usage in case of a P-CSCF failure.
## 6.3 Sol-B: Alternative P-CSCF and PCRF based restoration
### 6.3.1 Overview
This solution uses an alternative P-CSCF and the (at the time of failure of
the original P-CSCF) associated PCRF to restore the IMS registration status.
For a terminating call to roaming users, the I-CSCF, IBCF or ATCF behaves as
the S-CSCF in this alternative.
### 6.3.2 Principles
This alternative is designed with the following concepts.
  * **Little impact to the HPLMN in case of roaming.**
This solution makes the P-CSCF failure recovery possible within the visited
operator domain in case of roaming. For terminating call to roaming users, the
IBCF or ATCF or other adjacent node behaves in this alternative as the S-CSCF
in the normal case. HPLMN will be impacted if NAT is performed in the P-CSCF
or multiple IP domains are deployed in the operator network.
  * **Strict confirmation of P-CSCF failure for deciding IMS re-registration.**
The IMS re-registration procedure generates a service disruption time and
should be avoided as much as possible. With this respect, the decision for the
IMS re-registration for UE should be made with as strict confirmation as
possible. There are two ways to detect if a P-CSCF fails, i.e. SIP keep-alive
mechanism and/or no response after sending terminating request to the P-CSCF
within a limited period. A SIP invite timeout in S-CSCF may not be enough
taken as a trigger for IMS re-registration since there are many possibilities
that generate a SIP invite timeout. Examples are I-CSCF failure/overload, IBCF
failure/overload, transit network failure/overload. With this consideration,
this solution proposes to monitor P-CSCF sanity by adjacent nodes as much as
possible. Partial failure of the P-CSCF in the case SIP works well on the
P-CSCF may not be detected, but it has no impact on the restoration mechanism
of the P-CSCF, since in this case the P-CSCF can behave the same as an
alternative P-CSCF.
  * **No impact to UE.**
> This solution does not have any impact to the UE. This is the strong
> requirement in this WID.
### 6.3.3 Description
#### 6.3.3.1 Procedures
The following figures illustrate the details of this alternative. Protocol
impacts with this alternative are indicated with Red.
Figure 6.3.3.1-1: Alternative P-CSCF and PCRF Based Restoration for 3GPP
accesses
Figure 6.3.3.1-2: Alternative P-CSCF and PCRF Based Restoration for S2a access
Figure 6.3.3.1-3: Alternative P-CSCF and PCRF Based Restoration for S2b access
Figure 6.3.3.1-4: Alternative P-CSCF and PCRF Based Restoration for S2c access
  1. An S-CSCF, IBCF or ATCF or other adjacent node of the failed P-CSCF node receives a SIP INVITE message. At this moment, the adjacent node knows that the associated P-CSCF is down or has restarted. This is known by a local management/supervision protocol within an operator network.\ Since this procedure does not deliver the incoming SIP INVITE message to the UE, the S-CSCF will eventually report the SIP time out to the originating party.
  2. An S-CSCF, IBCF or ATCF or any other adjacent node forwards the SIP INVITE message to an alternative P-CSCF. The alternative P-CSCF is chosen based on the local configuration. If the failed P-CSCF has been recovered, then the failed P-CSCF would most likely be the alternative P-CSCF. If multiple IMS services are provided in the operator network, an alternative P-CSCF is chosen by the adjacent node that is capable to provide the IMS service associated to the received INVITE message.\ \ The S-CSCF populates the IMSI information into the SIP INVITE message. The IMSI can be coded in the \"username\" header field parameter in the Authorization header field in accordance with 3GPP TS 24.229 [3].\ The IBCF or ATCF may also populate the IMSI information into the SIP INVITE message if the SIP INVITE message needs to be sent to the alternative P-CSCF and there is no IMSI yet populated at the S-CSCF.\ The IMSI information may be subtracted by the P-CSCF.
NOTE 1: The section 6.3.3.1.1 describes a possible standardized way to detect
an adjacent node failure.
> Then the alternative P-CSCF checks the received SIP INVITE message to
> determine whether this message is due to a P-CSCF failure. This check could
> be made by for example: Executing both 1) Checking whether corresponding
> subscriber data is already installed; and 2) Check the Route header field
> whether it contains the failed P-CSCF information.\ Alternatively, an
> S-CSCF, IBCF or ATCF or any other adjacent node generates a suitably defined
> SIP OPTION message that can indicate that the P-CSCF associated with the
> called UE has been unavailable and that the UE needs IMS re-registration.\
> Alternatively, an S-CSCF, IBCF or ATCF or any other adjacent node can set an
> explicit indication in the SIP INVITE message indicating that this SIP
> INVITE message is sent due to the P-CSCF failure.\ Once the alternative
> P-CSCF confirms that the terminating UE has most likely encountered the
> P-CSCF failure and not yet re-registered to the IMS, the following procedure
> takes place as an UE recovery procedure.
NOTE 2: The section 6.3.3.1.2 describes a possible standardized way to
configure an alternative P-CSCF per UE. At least, the PCRF associated with the
UE has to be accessible from the chosen alternative P-CSCF.
NOTE 3: The P-CSCF partial failure occurs, e.g. the SIP on the P-CSCF works
but the P-CSCF has no subscriber data, the S-CSCF, IBCF or ATCF or any other
adjacent node may not be able to detect such failure, and then just forwards
the SIP INVITE message to the partial failure P-CSCF. The partial failure
P-CSCF behaves the same as the alternative P-CSCF as described in the
following steps.
  1. The alternative P-CSCF sends a dedicated AAR command to the original PCRF that has been associated with the UE. This message should contain at least following information in order to find the associated PCRF for the terminating UE.
\- Auth-Session-State AVP: This AVP set to No_State_Maintained indicates that
this AAR/AAA command pair is used dedicatedly and transiently for the P-CSCF
restoration procedure. Stateless will be given, i.e. no resource reservation
or new session association is required.
\- User IP address: The User IP address is extracted from the Request-Line in
the received SIP INVITE message and set to either the Frame-IP-Address AVP or
the Framed-IPv6-Prefix AVP if alternative P-CSCF knows that there is no
address translation functions in the failed P-CSCF based on the operator
configuration. Note that the User IP address is populated to the Request-Line
in the SIP INVITE message by the S-CSCF after the called party identity is
properly translated.
\- Subscription-id AVP: The IMSI is set to the Subscription-id AVP if
available in the alternative P-CSCF. This information may be obtained from the
IMSI information in the received SIP INVITE message.
\- IP Domain: The alternative P-CSCF may set the IP-Domain-Id AVP based on the
local configuration.\ However, if the IMSI is not available in the alternative
P-CSCF there is a limitation that alternative P-CSCF has to be configured with
only one IP Domain to interwork with if IPv4 is assigned to the end user for
the IMS service and multiple IP domains are deployed in the operator network".
\- PDN ID: The alternative P-CSCF sets static characters of an APN, for
example \"IMS APN\" or \"Emergency APN\", or so-called \"well known IMS APN\"
as described in the GSMA IR.92 [7] to the Called-Station-Id AVP based on the
local configuration.
> Based on the Auth-Session-State AVP, the PCRF understands that this AAR
> command is specific for the P-CSCF restoration purpose and that no state is
> maintained. The PCRF sends a dedicated AAA command to the alternative
> P-CSCF.
  1. The PCRF sends a RAR command to the P-GW/GGSN that has been associated with the UE. This message contains an indication for P-CSCF Restoration.
> If the PCRF knows that the UE has accessed the IMS service from non-3GPP
> access, then the PDN GW initiated bearer deactivation procedure should be
> instructed. The access type the UE is connected for the IMS service can be
> known in the P-GW/GGSN by referring to internal information in the PGW/GGSN.
> For example, RAT Type information. The P-GW/GGSN sends an RAA command to the
> PCRF.
NOTE 4: It should be noted that the update bearer request message procedure
does not work for UEs based on release 8 and earlier.
NOTE 5: It should be noted that using the PDN GW initiated bearer deactivation
procedure is a relatively heavy procedure compared to the update bearer
request message procedure. Especially, if the UE has a single PDN connection
to the IMS, this procedure forces UE to detach from the EPS network.
Thereafter the UE attaches to the EPS again and the IMS level registration
procedure follows. With this observation, using the PDN GW initiated bearer
deactivation procedure causes not only many signalling messages but also a
long service disruption.
  1. Upon receiving an RAR with an indication for P-CSCF Restoration from the PCRF in the step 4, one of following procedure takes place.
\- The update bearer request message procedure as a subset of the existing
Release 9 based P-CSCF restoration procedure if the P-GW/GGSN knows that the
UE supports the PCO based P-CSCF restoration, see section 6.3.3.2.3.
\- The PDN GW initiated bearer deactivation procedure with \"reactivation
requested\" if the P-GW/GGSN has no knowledge if the UE supports the PCO based
P-CSCF restoration or knows that the UE does not support the PCO based P-CSCF
restoration.
\- For the S2a, the PDN GW initiated bearer deactivation procedure to the
trusted non 3GPP access domain.\ It should be noted that although this
procedure does not request UE to re-attach to the IMS explicitly by
signalling, it is assumed that IMS compliant UE shall re-attempt to obtain IMS
service soon after detached from the IMS service.
\- For the S2b, the PDN GW initiated bearer deactivation procedure to the
ePDG.\ It should be noted that although this procedure does not request UE to
re-attach to the IMS explicitly by signalling, it is assumed that IMS
compliant UE shall re-attempt to obtain IMS service soon after detached from
the IMS service.
\- For the S2c, the Network initiated detach procedure as described in the
3GPP TS 24.303 [10]).\ It should be noted that although this procedure does
not request UE to re-attach to the IMS explicitly by signalling, it is assumed
that IMS compliant UE shall re-attempt to obtain IMS service soon after
detached from the IMS service.
With this solution alternative, the following impacts on the
S-CSCF/P-CSCF/PCRF and Mw/Rx interfaces are expected:
\- The SIP Terminating Requests from the S-CSCF or the adjacent node to the
alternative P-CSCF over Mw interface may need to be enhanced to include an
indication for P-CSCF Restoration. Or the alternative P-CSCF may check the
received SIP INVITE message to determine whether this message is due to a
P-CSCF failure.
\- The dedicated AAR command over Rx interface needs to include an indication
for P-CSCF Restoration, and the corresponding information required to find the
PCRF and perform the session binding (i.e. the corresponding public IP address
or private IP address and if available, the IP address domain of the UE, or
Subscription-Id and the APN for IMS PDN Connection related to the terminating
request.
\- The S-CSCF may hold the SIP terminating request in case the original P-CSCF
fails. Once after the UE is registered again, the S-CSCF is able to continue
the pending terminating procedure.
\- The P-CSCF needs to identify the indication for P-CSCF Restoration within a
SIP Terminating Request from the S-CSCF for a user of which the P-CSCF does
not store any information, and sends a dedicated AAR command over Rx with an
indication for P-CSCF Restoration, the APN for IMS PDN Connection, the
corresponding IP address of the UE, the IP domain ID if received in the SIP
terminating request as part of the Contact address and/or Subscription-Id
related to the terminating request.
\- The PCRF needs to identify the indication for P-CSCF Restoration, the APN
for IMS PDN Connection and the corresponding IP address of the UE and/or
Subscription-Id for which the P-CSCF Restoration is to be performed within a
dedicated AAR command, and sends an RAR to PGW/SGW over Gx/Gxx in order to
update or release the IP-CAN session of the UE identified by the IP address
and/or Subscription-Id of the UE, corresponding to the IMS PDN connection. The
dedicated AAR will include the Auth-Session-State AVP set to
NO_STATE_MAINTAINED to indicate to the PCRF that stateless treatment is
expected, i.e. no resource reservation or new session association is required.
#### 6.3.3.2 Optional functions
Optional functions described in this clause may be standardized in Rel-12 only
if time allows and strong demand is identified during the present study.
Otherwise, it can be standardized in a later release.
##### 6.3.3.2.1 SIP level keep-alive function
Figure 6.3.3.1.1-1 illustrates a possible standardized way to detect adjacent
node failure. This SIP level keep-alive function should be very similar with
the GTP echo as defined in 3GPP TS 29.281 [8] or SCTP heartbeat mechanism as
defined in IETF RFC 4960 [9]. SIP nodes maintain a restart counter, which is
incremented after every node restart.
{width="6.496527777777778in" height="2.261111111111111in"}
Figure 6.3.3.2.1-1: SIP level keep-alive function
  1. A SIP OPTION message is sent from one SIP node to an adjacent SIP node, including its current restart counter.
  2. The adjacent SIP node replies to the requesting SIP node by a SIP OPTION message, including its restart counter.
##### 6.3.3.2.2 Dynamic alternative P-CSCF configuration at adjacent node
Figure 6.3.3.1.2-1 illustrates a possible standardized way to configure an
alternative P-CSCF per UE. The purpose is to inform SIP nodes adjacent to a
P-CSCF about configured alternative P-CSCFs (to be used when the considered
P-CSCF fails). This function should be executed in every SIP registration.
{width="6.507638888888889in" height="2.213888888888889in"}
Figure 6.3.3.2.2-1: Dynamic alternative P-CSCF configuration at adjacent node
  1. A SIP REGISTER message is sent to P-CSCF.
  2. The P-CSCF adds its list of alternative P-CSCFs onto the SIP message and forwards it to the adjacent SIP node.
  3. Adjacent SIP nodes remove the list of alternative P-CSCFs from the SIP REGISTER message and forward it to the next SIP node.
##### 6.3.3.2.3 Indication of UE supporting the PCO based P-CSCF restoration
###### 6.3.3.2.3.1 Introduction
If the P-GW/GGSN is able to know that the UE supports the Rel-9 PCO based
P-CSCF restoration, the P-GW/GGSN can initiate an update bearer request
procedure to trigger an IMS re-registration during P-CSCF restoration
procedure as described in step 5 in section 6.3.3.1. Otherwise, bearer
deactivation procedure has to be applied.
The P-CSCF may by configuration derive the capability of the UE from the
IMEISV of the UE, however the derivation may not be accurate.
There are two alternative ways for the P-GW/GGSN to explicitly know that if
the UE supports the Rel-9 PCO based P-CSCF restoration or not.
###### 6.3.3.2.3.2 Option 1 -- IMS Registration based Indication
During the IMS Registration procedure, the UE could indicate its support of
the PCO based P-CSCF restoration capability to the S-CSCF as a new feature tag
in the Contact header within the SIP REGISTER message. Afterwards, the UE
capability is provided from the S-CSCF to the alternative P-CSCF and then to
the P-GW/GGSN via PCRF, during P-CSCF restoration procedure as described in
section 6.3.3.1.
###### 6.3.3.2.3.3 Option 2 -- PCO based Indication
If the UE supports the PCO based P-CSCF restoration for associated PDN
connection, it may indicate its support in a new PCO parameter to the
P-GW/GGSN when establishing the IMS PDN connection/PDP context.
### 6.3.4 Coexistence with existing solution
Since this solution utilizes the existing Rel-9 solution between P-GW/GGSN and
UE, it can perfectly coexist with the Rel-9 solution, based on a small
exclusive logic in the P-GW/GGSN. The difference from Rel-9 mechanism is only
the trigger of the IMS restoration related PDN connection re-establishment at
the P-GW/GGSN. While this solution can be considered as a \"Reactive
approach\", the Rel-9 mechanism can be considered as a \"Proactive approach\"
for the P-CSCF failure recovery. It is then up to the operator, for the
purpose of gaining the benefits of both solution, to combine them.
### 6.3.5 Objective compliance
This solution alternative fully complies with the objective of the study for a
mechanism to enhance existing standardized P-CSCF restoration procedure to
overcome existing limitations and drawbacks. With this solution alternative,
the P-CSCF restoration during terminating procedure is triggered per UE need,
which avoids massive signalling and specific UE support with the existing
standardized P-CSCF restoration mechanism. Details of the compliance are as
follows.
\- Avoid massive signalling over the core and radio networks.
> Similar as described in the clause 6.4.5 for Sol-C.
\- Improve reliability.
Similar as described in the clause 6.4.5 for Sol-C.
\- Do not impact existing GSMA compliant UEs.
> Similar as described in the clause 6.4.5 for Sol-C.
>
> To support the optional function of indication of UE supporting the PCO
> based P-CSCF restoration, the UE needs to provide its capability regarding
> supporting the PCO based P-CSCF restoration to the network, which would
> introduce some impacts on the UE.
\- Improve service availability.
> The service is recovered once there is a terminating request to the UE, and
> if the S-CSCF continues the terminating procedure after the UE completes the
> IMS registration, there would be no service loss at all to the UE.
  * Minimize H-PLMN resource usage to provide recovery solution for a visited P-CSCF.
> This alternative has little impact on H-PLMN for roaming cases.
### 6.3.6 Solution B Roaming considerations
The conclusion in clause 7.2 is that both solution B (PCRF-based) and D (HSS-
based) are subject for standardization, then it is relevant to analyze the
interactions between solutions B and D for the roaming scenarios such that an
operator can deploy one of the solutions independently from other operators.
In a home routed scenario, i.e., S-GW(or any other gateway node) is in VPLMN
and P-GW and P-CSCF are in HPLMN, the PCRF based solution can work within
HPLMN that supports the PCRF based solution, no matter VPLMN supports the
solution or not.
The following procedures only apply to the local breakout scenario.
In roaming scenarios, the VPLMN and HPLMN operators may deploy the same or
different P-CSCF restoration mechanisms, amongst those described in 3GPP TS
23.380 [2] clause 5.1 (Update PDP context/bearer at P-CSCF failure), clause
6.3 (HSS based) and clause 6.5 (PCRF based), independently from each other.
The PCRF based P-CSCF restoration can work in roaming scenarios if:
1) Both HPLMN and VPLMN support the PCRF based P-CSCF restoration; or
2) When the HPLMN does not support the PCRF based P-CSCF restoration but VPLMN
does and NAT is not performed.
NOTE: If the HPLMN does not support the PCRF based P-CSCF restoration, IMSI
may not be available on terminating INVITE message.
Alternatively, based on the operator policy or roaming agreement, the VPLMN
can use the \"Update PDP context/bearer at P-CSCF failure\" mechanism
described in 3GPP TS 23.380 [2] clause 5.1.
For a terminating call to outbound roamers, the S-CSCF may not populate IMSI
to terminating INVITE message if HPLMN knows, e.g. by configuration in the
S-CSCF according to roaming agreements, that VPLMN for outbound roamer does
not support the PCRF based P-CSCF restoration.
## 6.4 Sol-C: Alternative with AS (via ISC and Sh)
### 6.4.1 Overview
This alternative requires AS as a mandatory element.
S-CSCF identifies when a terminating message cannot reach destination UE based
on P-CSCF lack of response or specific information on error codes, then it
informs AS (via ISC) that asks HSS (via Sh) to request UE to release IMS PDN
connection.
HSS forwards this request to MME/SGSN that is able to send it to corresponding
UE. Then, this UE registers again to IMS, becoming reachable for any
terminating message.
### 6.4.2 Principles
The general restoration principle in this solution is based on that the P-CSCF
restoration is only triggered when the UE is involved in an activity, as
follows:
  * For non-active UEs, the IMS re-registration timer ensures that the UE becomes available again, as in this case, the UE will detect the P-CSCF failure when it tries to re-register. In fact, it is likely that most UEs will restore the P-CSCF as a result of re-registration.
  * For originating requests, the UE detects that the P-CSCF is unavailable and selects a new P-CSCF.
  * For terminating requests, the UE performs new procedures as described below.
As a result of the above, the main part of the procedures for restoration,
i.e. when UE performs re-registration or outgoing call, which will be the
majority of the users, can be handled today as already standardized in 3GPP TS
24.229 [3] and 3GPP TS 29.061 [4]. What still needs to be solved is how the
P-CSCF restoration can be triggered in case a terminating request is received
for the UE.
When a P-CSCF is down, the only communication between IMS and EPC that is
available is through the HSS (as the Rx is tied to the P-CSCF which is down).
This implies that a natural way to inform EPC (and indirectly the UE) of the
failed P-CSCF is that IMS notifies EPC via HSS.
The S-CSCF can identify when a terminating message cannot reach the
destination UE based on lack of response from the P-CSCF or based on error
responses including specific information. The S-CSCF then informs an AS (via
ISC) that asks the HSS (via Sh) to request the MME/SGSN to release the IMS PDN
connection. The voice centric UE will setup a new PDN connection, perform
P-CSCF discovery and registers again to IMS. Therefore, the UE becomes
reachable again for any terminating message.
This solution is based on the following principles:
A) Detection and triggering:
> The S-CSCF/AS is responsible to identify when P-CSCF restoration shall be
> initiated, based on the following triggers:
  * The terminating P-CSCF is not reachable; or
\- The terminating P-CSCF does not have corresponding subscriber registration
data available.
B) Restoration procedure:
> The AS, based on a response from the S-CSCF, initiates the restoration
> procedure by sending a notification via HSS to the MME/SGSN that the IMS PDN
> connection has to be released.
>
> The HSS forwards (without the need for any specific processing) this
> notification to the MME/SGSN.
>
> MME/SGSN requests the UE to release the IMS PDN connection.
>
> Based on the release of the IMS PDN connection, the UE will re-establish a
> new IMS PDN connection and perform a new P-CSCF discovery (according to
> existing procedures), and then register again to IMS.
### 6.4.3 Description
#### 6.4.3.1 Procedures
This solution is described in figure 6.4.3.1-1.
Figure 6.4.3.1-1: Alternative with AS (via ISC and Sh)
This solution is explained in the following steps in figure 6.4.3.1-1:
  1. Terminating S-CSCF receives a message for a UE.
  2. The call is routed via the AS using iFC.
> This alternative describes the functionality as an AS based function. Some
> new functionality needs to be implemented to be able to run in any AS.
> Therefore, a new AS is not required, but this specific new functionality
> shall be in one of the deployed ASs.
  1. The S-CSCF forwards the received message towards the terminating P-CSCF.
  2. New (or modified) error codes, or no response, are received by S-CSCF.
> The error codes provide enough information for the S-CSCF to identify
> whether corresponding subscriber registration data is not available or
> whether P-CSCF is down.
>
> When P-CSCF is down, the S-CSCF will either:
a) not receive an answer, in case there are no other SIP nodes in between.
b) receive a response code that identifies that the P-CSCF is down, if there
are other SIP nodes between S-CSCF and destination P-CSCF, e.g. when the UE is
roaming. This response code is included by the SIP node closest to destination
P-CSCF.
Detection by S-CSCF is described in detailed in clause 6.4.3.2.
  1. The AS receives an error back (via ISC).
> In step 2 an AS that implements the new P-CSCF restoration functionality was
> included into the call flow by an iFC, therefore when the message cannot
> proceed this AS receives back an error indication.
>
> The AS decides, based on the error information received, whether it has to
> send a request to HSS (via Sh) to request the UE to release IMS PDN
> connection. In addition, the AS can provide some added value functionality
> that could minimize damage due to P-CSCF failure and improve calling user
> perception, like for example:
  * Keep terminating call on hold until called UE is again registered (using an available P-CSCF) and then continue the call establishment. Meanwhile an announcement can be played to the calling UE.
  * Redirect terminating call to called user voice mail.
  * Redirect call via CS.
> This functionality is out of the 3GPP standardization scope.
  1. AS requests HSS (via Sh) to convey the P-CSCF Restoration indication.
> Final expectation is to reach called UE from IMS. For this purpose, in
> current 3GPP specifications an AS communicates already with MME/SGSN via Sh
> to obtain some information like T-ADS and Location Information, or to update
> some info like STN-SR. This alternative follows a similar approach.
>
> Therefore, either Sh-Pull or Sh-Update commands could be extended, but a new
> procedure is [not]{.underline} needed.
  1. HSS forwards the P-CSCF Restoration indication to MME/SGSN.
> HSS forwards the P-CSCF Restoration indication received from AS to MME/SGSN,
> using S6a/S6d/Gr.
>
> These interfaces can be extended to accommodate this new indication, as done
> already for others indications, as mentioned for Sh. A new command is not
> required.
  1. Upon reception of this indication from HSS, the MME/SGSN sends an IMS PDN connection release request to the UE.
> Destination subscriber identities are used by MME/SGSN to identify to which
> UE the request applies, and based on that it can find corresponding IMS APN
> for this user. The possibility to release the PDN connection from MME/SGSN
> is already supported according to 3GPP TS 23.401 [5] and 3GPP TS 23.060 [6].
  1. UE re-establishment of PDN connection and IMS registration.
> As a result of the release of the IMS PDN connection, the voice centric UE
> re-establishes the IMS PDN connection, and also performs a new P-CSCF
> discovery (as the PDN was lost). After discovering a new P-CSCF, the UE will
> perform a new initial IMS registration towards IMS.
>
> This step does not require any updates, since it follows already
> standardized procedures (see 3GPP TS 29.061 [4]). For this registration, if
> PCO was used for P-CSCF discovery, the UE takes one of the P-CSCF addresses
> from the list it has received at initial attach. In case, the prioritized
> address is not available, then it has to take another one from the list (if
> any). If none of them is available, the UE requests a new PCO from
> P-GW/GGSN. PCO contains an up to date list of available P-CSCF addresses
> since P-GW/GGSN keeps monitoring P-CSCF(s) availability. If PCO is not used,
> the UE will perform relevant P-CSCF discovery after the PDN re-establishment
> (e.g., using DHCP), however, GSMA IR.92 [7] mandates PCO as the mechanism
> for P-CSCF discovery.
There exists a possible variant to step 6 above, when HSS requires MAP as the
interface for AS communication, then MAP shall be modified to include the IMS
PDN release indication. Similar extensions have already been considered as
explained for Sh above (T-ADS, Location Information, STN-SR).
#### 6.4.3.2 S-CSCF/AS detection
##### 6.4.3.2.1 General
During UE registration, P-CSCF informs S-CSCF if this new feature is supported
(e.g. a new feature-capability indicator dedicated for the P-CSCF
restoration), what means that this P-CSCF is able to trigger restoration
(including information in corresponding error responses as described along
this clause).
In case this feature supporting indication is not received by S-CSCF, it
should be interpreted by S-CSCF as this feature is not supported by V-PLMN,
then as an alternative (it could be up to operator policy), in order to
increase service availability, the S-CSCF may decrease UE registration
expiration timer in the registration response then the time the corresponding
UE (in the V-PLMN) is not reachable for terminating calls is minimized. As the
number of roaming users is usually low in comparison to the non-roaming, this
should not affect the overall network dimensioning, however it should be taken
into account that timer modification increases radio signalling towards the
terminal. Therefore, if a large number of users are roaming, it is recommended
to always support the enhanced P-CSCF restoration procedures.
When this feature is supported, following procedures apply.
The S-CSCF keeps a list of non-working P-CSCFs. When the S-CSCF has not been
able to contact P-CSCF even when all retransmission timers have expired (see
clause 6.4.3.2.2 for more detail) then S-CSCF adds the P-CSCF to the list of
non-working P-CSCFs and keeps it there for a certain time. As long as the
P-CSCF is in that list, the S-CSCF initiates the procedure for releasing the
PDN connection for all incoming requests towards a UE registered with this
P-CSCF.
The S-CSCF removes a P-CSCF from the list of non-working P-CSCFs as soon as a
SIP request, including REGISTER, is received from that P-CSCF.
The S-CSCF/AS can detect that the destination P-CSCF is not working either
\- by receiving an indication with additional information indicating that the
P-CSCF is not working (e.g. a reason header field with a SIP reject code and
text) along with an indication that P-CSCF restoration is supported (e.g. a
new feature-capability indicator dedicated for the P-CSCF restoration). The
exact coding details are left to stage 3; or
\- by not receiving any SIP response when the S-CSCF sends a request directly
to the P-CSCF.
The S-CSCF learns that the AS supports the P-CSCF restoration procedure by
reception of a feature-capability indicator, indicating that P-CSCF
restoration is supported, in the INVITE SIP request, in step 2 in figure
6.4.3.1-1.
Any other proprietary additional mechanisms may be used for detection of
P-CSCF unavailability, such as TCP connection errors etc.
##### 6.4.3.2.2 S-CSCF adjacent SIP node to P-CSCF
This is the normal case when the terminating user is not roaming.
When the S-CSCF receives a terminating request towards a UE registered to a
P-CSCF that is not in the list of non-working P-CSCFs, the S-CSCF:
\- executes the normal procedures for a terminating request, including
executing filter criteria and replacing the Request-URI with the Contact
address;
\- forwards the request to the P-CSCF; and
\- starts a re-transmission timer.
If the re-transmission timer expires, S-CSCF retransmits this request a
configurable number of times. When all retransmissions expire, then the
S-CSCF:
\- returns a 408 (Request Timeout) response to AS;
\- provides an indication with additional information indicating that the
retransmissions has expired (e.g. in a reason header field with a SIP reject
code and text) along with an indication that P-CSCF restoration is supported
(e.g. a new feature-capability indicator dedicated for the P-CSCF
restoration). The exact coding details are left to stage 3. The additional
information is used by AS to decide whether to trigger P-CSCF restoration
mechanism; and
\- adds the P-CSCF to the list of non-working P-CSCFs.
NOTE: Since the detection is based on timers, a CANCEL may be received from
originating side. See clause 6.4.3.2.4 for more information.
If on the contrary, the S-CSCF receives a terminating request towards a UE
registered to a P-CSCF that is already in the list of non-working P-CSCFs, the
S-CSCF:
\- returns a 408 (Request Timeout) response to AS;
\- provides an indication with additional information indicating that the
retransmissions has expired, as explained above.
##### 6.4.3.2.3 S-CSCF not adjacent SIP node to P-CSCF
This is the normal case when the terminating user is **roaming** and there are
IBCFs between the S-CSCF and the P-CSCF. It can also be that an ATCF is
inserted between the S-CSCF and the P-CSCF. It is the SIP node closest to the
P-CSCF that will be responsible for detecting that the P-CSCF is not working.
When the SIP node closest to the P-CSCF detects that the P-CSCF is not
responding, the SIP node rejects the request with a SIP error response with an
indication that the P-CSCF is not working (e.g. a Reason header field
indicating that the P-CSCF is not working) along with an indication that
P-CSCF restoration is supported (e.g. a feature capability indicator dedicated
for the P-CSCF restoration). The exact coding details are left to stage 3.
This procedure does not require a roaming agreement with V-PLMN. In case
V-PLMN implements this new restoration mechanism it means that V-PLMN P-CSCF
triggers restoration including information in corresponding error responses
(as described in clause 6.4.3.2) that is used by H-PLMN to request UE IMS PDN
connection release.
On the contrary, if V-PLMN does not implement this feature, then the
alternative is that S-CSCF decreases registration expiration timers for
roaming users, then the time the corresponding UE (in the V-PLMN) is not
reachable for terminating calls is minimized. This does not require a roaming
agreement, since the UE timer provided in the REGISTER can be lowered by
S-CSCF in their response, only in case S-CSCF is not informed by P-CSCF that
the V-PLMN supports this feature.
##### 6.4.3.2.4 The originating user cancels the call
Since the SIP timers take a long time to expire it is likely that the
originating user cancels the call before the request has expired. In this case
it is a local policy whether the SIP node detecting the failure should trigger
the restoration function when a CANCEL is received.
If the restoration function is to be triggered, the node detecting the failure
provides an indication in the 487 (Request Terminated) response, that informs
that the P-CSCF is not working (e.g. in a reason header field with a SIP
reject code and text) along with an indication that P-CSCF restoration is
supported (e.g. a new feature-capability indicator dedicated for the P-CSCF
restoration). The exact coding details are left to stage 3.
### 6.4.4 Coexistence with existing solution
This solution is proposed as a new optional mechanism.
If this new mechanism is deployed in a network, although it does not preclude
the existing mechanism deployment, the recommendation is to just deploy the
new one. Since this mechanism avoids existing limitations and drawbacks (see
clause 6.4.5), existing mechanism may not need to be deployed any longer.
However, if existing mechanism is already deployed, for backward compatibility
reasons it is important that both mechanisms could coexist. In fact, in a
roaming scenario it may occur that the visited network has deployed the
existing mechanism while the home network deploys the new proposed one.
If the existing mechanism is deployed, as soon as a P-CSCF failure is
detected, as explained in clause 4, it triggers massive radio signalling first
and then massive IMS registration, with limitations and drawbacks already
highlighted. Therefore, this new proposed mechanism triggering use case will
not occur in most cases, therefore benefits will be minimal, i.e. in case of
coexistence existing mechanism will in most case take precedence over the new
one.
### 6.4.5 Objective compliance
This solution alternative covers main objectives, avoiding existing P-CSCF
restoration mechanism limitations and drawbacks:
\- Avoid massive signalling over the core and radio networks.
> The triggering use case is per UE need basis, when a message shall reach
> destination UE, therefore massive signalling is avoided.
\- Improve reliability.
> Reliability is improved in comparison with existing mechanism for the
> following reasons:
  * Network failure.
> With the existing mechanism, P-CSCF may be considered down even when its SIP
> capabilities are up and running.
>
> The reason is that according to 3GPP TS 29.061 [4] the GGSN/P-GW may use a
> keep-alive mechanism to be able to detect a failure of a P-CSCF. This keep-
> alive mechanism should make use of STUN or CRLF as specified for the UE in
> 3GPP TS 24.229 [3], clause K.2.1.5. As an alternative, ICMP echo
> request/response may be used. However, the lack of STUN, CRLF or ICMP
> responses do not mean that the SIP part of the P-CSCF is down, but could as
> well be either communication problems between the GGSN/P-GW and P-CSCF, or
> the STUN/CRLF/ICMP part of the P-CSCF is temporarily down. Hence, triggering
> of P-CSCF restoration may happen without the SIP part of P-CSCF being down,
> and it would affect **all** users for this P-CSCF.
>
> On the contrary, this proposed mechanism triggering is only done on a per UE
> basis, and based on a well-defined set of SIP error responses (see clause
> 6.4.3.2).
  * Partial P-CSCF failure.
> The existing procedures cannot handle the case where only some subscriber's
> registration data is not available but P-CSCF is working, as it only
> monitors whether it can communicate with the P-CSCF as such.
>
> On the contrary, this proposed mechanism as based on a well-defined set of
> SIP error responses (see clause 6.4.3.2) is able to consider this case.
\- Do not impact existing GSMA compliant UEs.
> This alternative is based on new UE registration to IMS when it receives a
> request to release IMS PDN connection. This does not require specific UE
> support.
\- Improve service availability.
> Service availability is not dependent on massive signalling that may even
> get into overload, what may delay failed P-CSCF recovery, but the service is
> recovered as soon as a terminating message cannot reach the destination UE.
>
> A part from that, P-CSCF partial failure is identified immediately and
> P-CSCF restoration is triggered.
  * Minimize H-PLMN resource usage to provide recovery solution for a visited P-CSCF.
> This mechanism is triggered for terminating requests and since the number of
> roaming users is usually very low in comparison to the non-roamers, it
> implies that most times the P-CSCF to be recovered is in the home network.
> Therefore, the H-PLMN resource usage to provide visited P-CSCF recovery is
> very small, moreover when impacts on home elements are considered low (see
> clause 7.1.2). This feature does not affect home network dimensioning.
## 6.5 Sol-D: Alternative with direct Cx communication
### 6.5.1 Overview
The S-CSCF detects that a terminating message cannot reach the destination UE
based on P-CSCF lack of response or specific information on error codes, then
it informs the HSS (directly via Cx) to provide the P-CSCF Restoration
indication to MME/SGSN.
Based on the possibility for the MME/SGSN to know whether or not affected UE
supports Rel-9 based PCO P-CSCF Restoration procedures, the MME/SGSN is able
to either:
\- When the UE does not support this capability, or this capability is
unknown, it requests IMS PDN connection release to the corresponding UE, what
implies the UE reactivates an IMS PDN connection and registers to IMS using an
available P-CSCF, or
\- When the UE supports this capability, it may request to P-GW/GGSN to
provide to the corresponding UE a PCO with the new list of available P-CSCF
addresses, reusing part of existing restoration procedures, what implies that
the UE registers to IMS using one of the available P-CSCF addresses.
### 6.5.2 Principles
This solution is based on the same principles as solution C with AS (via ISC
and Sh) described in clause 6.4, except for the difference that the S-CSCF
triggers the restoration procedure by contacting HSS directly via Cx.
As an optional solution extension, the MME/SGSN may be informed about whether
the UE supports Rel-9 based PCO P-CSCF Restoration procedures, and in that
case, instead of requesting IMS PDN connection release to the UE, it may
request to P-GW/GGSN to provide to the corresponding UE a PCO with the new
list of available P-CSCF addresses, reusing part of existing restoration
procedures, what implies that the UE registers to IMS using one of the
received P-CSCF addresses.
### 6.5.3 Description
#### 6.5.3.1 Procedures
This solution is described in figure 6.5.3.1-1.:
Figure 6.5.3.1-1: Alternative with direct Cx communication -- IMS PDN release
This solution is explained following steps in figure 6.5.3.1-1:
  1. Terminating S-CSCF receives a message for a UE.
  2. S-CSCF tries to reach this called UE terminating P-CSCF.
  3. New (or modified) error codes, or no response, are received by S-CSCF.
> P-CSCF shall provide enough information to S-CSCF to be able to start P-CSCF
> recovery mechanism, i.e. to be able to identify whether corresponding
> subscriber registration data is not available, or when P-CSCF is down.
>
> This step is the same as step 4 described for alternative with AS (via ISC
> and Sh) describes in clause 6.4.
Detection by S-CSCF is described in detailed in clause 6.4.3.2.
  1. S-CSCF directly requests HSS (via Cx) to convey the P-CSCF Restoration indication.
> There are two implementation possibilities to convey this indication in Cx,
> either a new procedure is used, what would require creating a new Diameter
> application for interoperability reason, according to Diameter extensibility
> rules, or it could be analyzed whether it may be incorporated into one of
> the existing procedures (e.g SAR may be a candidate for this, defining a new
> feature). A conclusion on this subject is left to stage 3.
Steps 5, 6 and 7 are the same as steps 7, 8 and 9 in the solution C with AS
(via ISC and Sh) described in clause 6.4.
#### 6.5.3.2 Reuse of Rel-9 PCO based P-CSCF Restoration procedures
##### 6.5.3.2.1 Introduction
Solution D can be optionally extended by reusing a part of the Rel-9 PCO based
P-CSCF Restoration procedures with one of the following extensions avoiding
the release of the IMS PDN connection.
##### 6.5.3.2.2 Extension 1 -- Decision at MME/SGSN
###### 6.5.3.2.2.1 Extension 1 - Procedure description
This extension is based on the possibility for the MME/SGSN to know whether or
not the UE supports Rel-9 PCO based P-CSCF Restoration procedures. Two methods
on how to provide this information to MME/SGSN are described in detailed in
clause 6.5.3.2.2.2.
When the UE supports this capability, the MME/SGSN may request the P-GW/GGSN
to provide to the corresponding UE a PCO with the new list of available P-CSCF
addresses, reusing part of existing restoration procedures, which implies that
the UE registers to IMS using one of the available P-CSCF addresses. This has
the advantage that IMS PDN connection does not need to be deactivated and
reactivated again.
This extension procedure is described by figure 6.5.3.2.2.1-1 (for EPC) and
6.5.3.2.2.1-2 (for GPRS).
Figure 6.5.3.2.2.1-1: UE does support Rel-9 P-CSCF Restoration procedures --
Decision at MME/S4-SGSN - EPC
Figure 6.5.3.2.2.1-2: UE does support Rel-9 P-CSCF Restoration procedures --
Decision at Gn SGSN - GPRS
Steps from 1 to 4 are the same as explained in figure 6.5.3.1-1 above.
  1. The MME/SGSN receives P-CSCF Restoration indication
> In this example, it is considered that UE supports Rel-9 P-CSCF Restoration
> procedures and that MME/SGSN is informed about this capability, two methods
> could be considered for this, as described in clause 6.5.3.2.2.2. Therefore,
> the MME/SGSN may avoid requesting IMS PDN connection release to the UE, and
> instead of that, reuse part of existing P-CSCF Restoration procedures as
> described in following steps.
  1. If this optional extension is supported, the MME/SGSN sends Modify Bearer Request / Modify PDP Context to the P-GW/GGSN, for corresponding UE
> This request already exists, but a new indication shall be included to
> identify that this request is related to a P-CSCF Restoration procedure.
>
> MME provides this indication to P-GW via S-GW. When Modify Bearer Request is
> received by S-GW with an indication of P-CSCF Restoration, this message is
> forwarded to P-GW.
>
> The new P-CSCF Restoration indication in the existing Modify Bearer Request
> / Modify PDP Context message is interpreted by P-GW/GGSN as a request to
> initiate UE update with newly available P-CSCF addresses as per existing
> P-CSCF Restoration procedure. Therefore, P-GW/GGSN includes a list of new
> available P-CSCFs in the PCO that is sent to UE in following steps 7 and 8.
  1. The P-GW/GGSN sends Update Bearer Request / Update PDP Context message back to the MME/SGSN
> This message includes a PCO with a list of available P-CSCF addresses, as
> per existing P-CSCF Restoration procedures.
  1. The MME/SGSN sends Modify EPS Bearer Context Request / Modify PDP Context Request to corresponding UE.
> This request includes the PCO with the list of available P-CSCF addresses.
> Then, the UE as per existing P-CSCF Restoration procedures described in 3GPP
> TS 24.229 [3] and 3GPP TS 29.061 [4] will select one available P-CSCF from
> the list for IMS registration.
###### 6.5.3.2.2.2 Methods to indicate the UE's support for Rel-9 PCO based
P-CSCF Restoration to MME/SGSN
Extension described in 6.5.3.2.1 is based on the possibility by MME/SGSN to
identify whether or not affected UE supports Rel-9 PCO based P-CSCF
Restoration procedures.
In following clauses, some possible methods are described to provide this
indication from UE to MME/SGSN.
###### # 6.5.3.2.2.2.1 Method 1 -- NAS based
One possible method is that the UE indicates this capability to the MME/SGSN,
based on transferring capabilities procedures described in 3GPP TS 23.401 [5]
and 3GPP TS 23.060 [6].
###### # 6.5.3.2.2.2.2 Method 2 -- IMS registration based
Another possible method is that the UE provides at IMS registration an
indication in case it supports Rel-9 P-CSCF Restoration as described in figure
6.5.3.2.1.1.2-1.
Figure 6.5.3.2.1.1.2-1: UE capability provided at IMS registration
  1. UE may provide its capability at IMS registration.
> If the UE supports Rel-9 P-CSCF Restoration it may provide an indication
> within REGISTER message. This indication could be provided in the Contact
> header as a feature tag.
  1. UE capability is forwarded to S-CSCF
> If this indication is included in REGISTER, it is forwarded to S-CSCF, where
> it is stored for this destination user.
Then, during P-CSCF restoration procedure as described in figures 6.5.3.1-1,
UE capability is provided first from S-CSCF to HSS in step 4 and second from
HSS to MME/SGSN in step 5.
##### 6.5.3.2.3 Extension 2 -- Decision at P-GW/GGSN
###### 6.5.3.2.3.1 Extension 2 - Procedure description
This extension is based on the possibility for the P-GW/GGSN to know whether
or not the UE supports Rel-9 PCO based P-CSCF Restoration procedures, which is
described in clause 6.5.3.2.3.2.
In this extension, the MME/SGSN, when receiving a P-CSCF restoration
indication from the HSS, transfers this indication to the P-GW/GGSN.
  * When the UE supports the PCO based P-CSCF Restoration procedure, the P-GW/GGSN provides the UE a PCO with the new list of available P-CSCF addresses, reusing part of existing P-CSCF restoration procedures, which implies that the UE registers to IMS using one of the available P-CSCF addresses. This has the advantage that IMS PDN connection does not need to be deactivated and reactivated again.
> This extension procedure is described by figure 6.5.3.2.3.1-1 (for EPC) and
> 6.5.3.2.3.1-2 (for GPRS).
  * When the UE does not supports the PCO based P-CSCF Restoration procedure, the P-GW/GGSN initiates a release of the IMS PDN disconnection.
Figure 6.5.3.2.3.1-1: UE supporting the PCO based P-CSCF restoration --
Decision at P-GW/GGSN - EPC
Figure 6.5.3.2.3.1-2: UE supporting the PCO based P-CSCF restoration --
Decision at P-GW/GGSN - GPRS
Steps from 1 to 4 are the same as explained in figure 6.5.3.1-1 above.
  1. The MME/SGSN receives P-CSCF Restoration indication for the UE.
  2. If this optional extension is supported, the MME/SGSN sends Modify Bearer Request / Modify PDP Context to the P-GW/GGSN for this UE.
> This request already exists, but a new indication shall be included to
> identify that this request is related to a P-CSCF Restoration procedure.
>
> MME/S4 SGSN provides this indication to P-GW via S-GW. When Modify Bearer
> Request is received by the S-GW with an indication of P-CSCF Restoration,
> this message is forwarded to the P-GW.
>
> The new P-CSCF Restoration indication in the existing Modify Bearer Request
> / Modify PDP Context message is interpreted by P-GW/GGSN as a request to
> initiate an UE update with newly available P-CSCF addresses as per existing
> PCO based P-CSCF Restoration procedure, if the UE has previously indicated
> this support.
>
> If the UE does not support the PCO based P-CSCF Restoration procedure, the
> P-GW/GGSN releases the IMS PDN connection/PDP context by sending a Delete
> Bearer Request / Delete PDP Context Request to the MME/SGSN (not described
> in the figures).
  1. The P-GW/GGSN sends Update Bearer Request / Update PDP Context message back to the MME/SGSN.
> This message includes a PCO with a list of available P-CSCF addresses, as
> per existing P-CSCF Restoration procedures.
  1. The MME/SGSN sends Modify EPS Bearer Context Request / Modify PDP Context Request to the UE.
> This request includes the PCO with the list of available P-CSCF addresses.
  1. The UE as per existing P-CSCF Restoration procedures described in 3GPP TS 24.229 [3] and 3GP TS 29.061 [4] selects one available P-CSCF from the list for IMS registration.
###### 6.5.3.2.3.2 Method to indicate the UE support for Rel-9 PCO based
P-CSCF Restoration to PGW/GGSN
The extension described in 6.5.3.2.3.1 is based on the possibility for the
P-GW/GGSN to identify whether or not the UE supports the Rel-9 PCO based
P-CSCF Restoration procedures.
The proposed method is that the UE indicates this capability to the P-GW/GGSN
at the establishment of the IMS PDN connection /PDP context, in a new PCO
parameter which is added to the existing PCO for P-CSCFs addresses described
in 3GPP TS 24.008 [11].
This method has no impact on MME, S-GW or SGSN as PCO information is
transparently transferred through these network elements.
This method can be used for roaming users without impacting the HPLMN of the
roamer.
### 6.5.4 Coexistence with existing solution
Similar as in solution C with AS (via ISC and Sh) described in clause 6.4.4.
For the optional extensions described in clause 6.5.3.2, both with decision at
MME/SGSN or PGW/GGSN, part of existing P-CSCF Restoration mechanism is reused.
### 6.5.5 Objective compliance
Similar as in solution C with AS (via ISC and Sh) described in clause 6.4.5.
For the optional extensions described in clause 6.5.3.2, both with decision at
MME/SGSN or PGW/GGSN, that reuse Rel-9 PCO based P-CSCF restoration
procedures, the objective \"do not impact existing GSMA compliant UEs\" is not
fulfilled, since in order to avoid the IMS PDN deactivation and reactivation,
these extensions require the UE supports Rel-9 PCO based P-CSCF Restoration
procedures, what is not included in GSMA IR.92 [7]. Therefore, it would be
relevant that GSMA considers either recommending or requiring such support for
UEs.
A part from that, the extension that proposes decision at MME/SGSN, described
in clause 6.5.3.2.1, is based on the possibility by MME/SGSN to identify
whether or not affected UE supports Rel-9 PCO based P-CSCF Restoration
procedures. Proposed methods in clause 6.5.3.2.1.1 require UE impacts:
  * Method described in clause 6.5.3.2.1.1.1 requires UE impacts in order for the UE to be able to provide its capability to the MME/SGSN, impacting NAS protocol.
  * Method described in clause 6.5.3.2.1.1.2 requires UE impacts in order to include a feature tag indicating this capability support.
Therefore, according to the selected method, it would be relevant that GSMA
considers to either recommending or requiring the corresponding UE support.
The extension that proposes decision at P-GW/GGSN described in clause
6.5.3.2.2 is based on the possibility for the P-GW/GGSN to identify whether or
not the UE supports Rel-9 PCO based P-CSCF Restoration procedures. The
proposed method in clause 6.5.3.2.3.2 impacts the UE to be able to provide its
capability to the P-GW/GGSN. Therefore, it would be relevant that GSMA
considers to either recommending or requiring UE support for such indication.
### 6.5.6 Roaming considerations
#### 6.5.6.1 Introduction
The conclusion in clause 7.2 is that both solution B (PCRF-based) and D (HSS-
based) are subject for standardization, then it is relevant to analyze the
interactions between solutions B and D for the roaming scenarios such that an
operator can deploy one of the solutions independently from other operators.
The following clauses describe the different possible alternatives for inbound
roaming cases when the VPLMN supports the HSS-based mechanism. Then a
conclusion is proposed.
#### 6.5.6.2 Rel-9 P-CSCF Restoration for roamers [only]{.underline} when
HPLMN does not support the HSS based mechanism
This alternative assumes the VPLMN supports the Rel-9 P-CSCF Restoration
mechanism in addition to the HSS based mechanism.
In this alternative, for inbound roamers, the VPLMN executes the HSS-based
mechanism only if the HPLMN has triggered the HSS-based mechanism; otherwise,
if the HPLMN does not support the HSS-based mechanism, the VPLMN executes the
Rel-9 P-CSCF Restoration mechanism.
The HPLMN only triggers the HSS based mechanism when it knows that the VPLMN
supports the HSS based mechanism. This avoids sending unnecessary
AVPs/messages. The HPLMN may get this knowledge by means of e.g. HPLMN
corresponding node(s) configuration according to a roaming agreement, by the
use of 3GPP Supported Features mechanism or by signalling from VPLMN.
The VPLMN needs to identify whether a user is an inbound roamer. This is
identified by the PGW/GGSN by checking the IMSI received from the MME/SGSN at
PDN connection establishment. The PGW/GGSN also needs to know (e.g. by
configuration) if the HPLMN of the inbound roamer does not support the HSS
based P-CSCF restoration mechanism, so to apply the Rel9 P-CSCF restoration
mechanism for this roamer without waiting for HSS-based restoration mechanism
being triggered by the HPLMN.
#### 6.5.6.3 Rel-9 P-CSCF Restoration always for roamers
This alternative assumes the VPLMN supports the Rel-9 P-CSCF Restoration
mechanism in addition to the new mechanism. In this alternative, for inbound
roamers, the VPLMN always executes the Rel-9 P-CSCF Restoration mechanism,
instead of the HSS based mechanism.
The VPLMN needs to identify whether a user is an inbound roamer. This is
identified by the PGW/GGSN by checking the IMSI received from the MME/SGSN at
PDN connection establishment.
#### 6.5.6.4 No P-CSCF Restoration mechanism for roamers when HPLMN does not
support the HSS based mechanism
In this alternative, for inbound roamers, the VPLMN executes the HSS-based
mechanism only if the HPLMN has triggered the HSS-based mechanism; otherwise
the VPLMN does not execute any P-CSCF restoration mechanism, which means that
inbound roamers are unreachable until they make an outgoing request or the IMS
re-registration timers expire.
The HPLMN only triggers the HSS based mechanism when it knows that the VPLMN
supports the HSS based mechanism. This avoids sending unnecessary
AVPs/messages. The HPLMN may get this knowledge by means of e.g. HPLMN
corresponding node(s) configuration according to a roaming agreement, by the
use of 3GPP Supported Features mechanism or by signalling from VPLMN.
The VPLMN needs to identify whether a user is an inbound roamer. This is
identified by the PGW/GGSN by checking the IMSI received from the MME/SGSN at
PDN connection establishment.
#### 6.5.6.5 Conclusions
The proposal in clause 6.5.6.4 is recommended since it has following
advantages:
  * This solution does not require operator support for the existing Rel-9 P-CSCF Restoration mechanism.
  * This solution does not have any extra cost. Even a specific roaming agreement is not necessary.
Alternatively, if the V-PLMN operator has already deployed the existing Rel-9
P-CSCF restoration mechanism, it may take profit of this by implementing
proposals in clauses 6.5.6.2 or 6.5.6.3, or even other possible alternatives,
like e.g. reduce the roamers' UE IMS re-registration timers. Therefore, the
V-PLMN may choose the most appropriate proposal based on operator policies.
### 6.5.7 Solutions B and D commonalities
#### 6.5.7.1 Basic mechanism
Both solutions B and D basic mechanisms execute a PDN disconnection,
The basic mechanisms are not different from the UE perspective, which is an
important commonality.
P-CSCF failure detection by the S-CSCF based on error responses is common
between solutions B and D.
#### 6.5.7.2 Optional extension
Both solutions B and D are enhanced with an optional extension reusing the
Rel-9 PCO based P-CSCF restoration mechanism, which requires the UE to support
this mechanism.
As both solutions are selected for standardization, an important requirement
is that the solutions B and D have no difference from the UE perspective.
The optional extension requires the UE to indicate the support of the Rel-9
PCO based P-CSCF restoration mechanism to the network. To convey this UE
capability, both solutions B and D propose the following alternatives:
\- either based an IMS registration;
\- or based on a new PCO parameter.
If the UE notifies its capability (i.e. support of the Rel-9 PCO based P-CSCF
Restoration mechanism) with a new PCO parameter, there is no difference
between solutions B and D, so this is common.
If the UE notifies its capability via IMS registration:
\- There is no difference between solutions B and D regarding the transfer of
information from the UE to the S-CSCF that stores this UE capability
information. This is common.
\- There is a difference for the transfer of this UE capability from the
S-CSCF to the MME/SGSN and then to the PGW/GGSN via the HSS in solution D and
the transfer from the S-CCSF to the PGW/GGSN via the PCRF in the solution B.
No commonality is identified here.
The use of the Rel-9 PCO based P-CSCF restoration mechanism between the
PGW/GGSN and the UE in the optional extension is common for both solutions B
and D.
#### 6.5.7.3 Conclusions on Solutions B and D Commonalities
The analysis on solutions B and D have commonalities in several areas,
especially those ensuring no difference from the UE perspective.
There are more commonalities for the alternative that use a new PCO parameter
to transfer the UE capability information. From the commonality view point,
this gives a slight preference to use a new PCO parameter to transfer the UE
capability.
## 6.6 P-CSCF restart case
### 6.6.1 Introduction
This 6.6 clause addresses the impact of the restart of the failed P-CSCF in
the solutions B and D, when the extension option of the mechanism is used.
After some considerations, two solutions which can be part of the solutions B
and D are described; then after a comparison, a recommendation is proposed.
### 6.6.2 Considerations regarding a restarted P-CSCF
In the Rel-9 P-CSCF restoration, the PGW detects the P-CSCF failure and sends
a PCO with a new list of available P-CSCFs not including the failed P-CSCF.
Then the UE, supporting Rel-9 P-CSCF restoration, will initiate a new IMS
registration if the used P-CSCF is not in the list (see 3GPP TS 23.380 [2]
clause 5.1.2, steps 11, 13 and 3GPP TS 24.229 [3] clauses B.2.2.1C and
L.2.2.1C).
With Rel-12 enhanced P-CSCF restoration, there may be some time (which can be
long e.g. half an hour) between the P-CSCF failure and the triggering event
(due to a terminating call) generating the PCO message from PGW to the UE. In
the meantime, P-CSCF may have restarted and the PGW may now have this P-CSCF
in its list of available P-CSCFs that PGW will send to the UE. According to
3GPP TS 24.229 [3] clauses B.2.2.1C and L.2.2.1C, as the P-CSCF of the UE is
in the list, the UE does not do a new IMS registration, although it needs to
do it as this UE is no more known from the restarted P-CSCF.
The restarted P-CSCF is an available and valuable resource that could be used;
otherwise all UEs previously on that P-CSCF will do IMS registrations on other
P-CSCFs so increasing their load and not on the restarted P-CSCF which will be
under-utilised with a small load only increasing by new UEs doing an initial
registration. In some circumstances, it may even be the only available P-CSCF.
This restarted P-CSCF case is the same for the PCRF based solution B (clause
6.3) and the HSS based solution D (clause 6.5).
It is considered that the Rel-12 P-CSCF restoration should allow reusing the
restarted P-CSCF for UEs previously connected through it when they are
triggered for a new IMS registration.
### 6.6.3 Solutions addressing P-CSCF restart
#### 6.6.3.1 Solution with a new indicator
1) For a Rel-12 UE and a Rel-12 PGW supporting this solution, when the
extension option of the mechanism is used and the UE has previously indicated
the support of Rel-12 P-CSCF restoration to the PGW:
\- the PGW, when triggered, generates an Update Bearer Request / Update PDP
Context with:
\- a PCO list of available P-CSCFs, taking into account their health status.
This list may contain the P-CSCF used by the UE if this P-CSCF has restarted
and is again available;
\- a PCO indicator that a new IMS registration is required;
\- the UE will then do a new IMS registration through a P-CSCF selected in the
received PCO-list of P-CSCFs.
For backward compatibility reasons, if this UE receives a Modify EPS Bearer
Context Request / Modify PDP Context Request (triggered by an Update Bearer
Request / Update PDP Context) with a PCO List of P-CSCFs, but with no PCO
indication that a new IMS registration is required, (e.g when accessing a
network deploying the Rel-9 P-CSCF restoration), the UE behaves as for Rel-9
P-CSCF restoration (see 3GPP TS 24.229 [3] clauses B.2.2.1C and L.2.2.1C),
i.e. will do a new IMS registration only if the received P-CSCF list does not
contain the used P-CSCF address.
2) For a pre-Rel-12 UE (or a Rel-12 UE not supporting P-CSCF restoration) and
a Rel-12 PGW supporting the solution:
\- the UE does not send a PCO indication for the support of P-CSCF restoration
at PDN creation;
\- the PGW, when triggered for P-CSCF restoration, will do a PDN
disconnection;
\- the UE never receives a PCO list for P-CSCF restoration;
\- the UE behaviour is not impacted by the solution.
#### 6.6.3.2 Solution without a new indicator
1) For a Rel-12 UE and a Rel-12 PGW supporting this solution, when the
extension option of the mechanism is used and the UE has previously indicated
the support of Rel-12 P-CSCF restoration to the PGW at PDN creation:
\- the PGW, when triggered for P-CSCF restoration, sends a PCO list of P-CSCFs
which may or may not contain the restarted P-CSCF;
\- the UE always do a new IMS registration when it receives a PCO list of
P-CSCFs in an Update Bearer/Update PDP Context request by selecting a P-CSCF
in the list.
To avoid useless new IMS registrations, the PGW never sends a PCO list of
P-CSCFs in an Update Bearer/Update PDP Context request outside a P-CSCF
restoration.
2) For a Rel-12 UE supporting this solution and accessing a network supporting
the Rel-9 P-CSCF restoration, as according to 3GPP TS 23.380 [2] clause 5.1
and 3GPP TS 24.229 [3], the PGW sends a PCO list of P-CSCFs without the failed
P-CSCF to UEs using this P-CSCF, so the Rel-12 UE will do a new IMS
registration as expected.
\- To avoid useless IMS registration by Rel12 UE, the Rel9 PGW should not send
PCO list in Update bearer/Update PDP Context requests outside P-CSCF
restoration. This should be clarified in the Rel9 specifications as no other
use is described outside P-CSCF restoration;
3) For a pre-Rel-12 UE (or a Rel-12 UE not supporting P-CSCF restoration) and
a Rel-12 PGW supporting the solution, the description in clause 6.6.3.1
paragraph 2) applies; there is no impact on the UE behaviour.
### 6.6.4 Comparison of solutions for P-CSCF restart
Both solutions can be part of the solutions B and D.
Both solutions have no impact on the pre-Rel-12 UEs.
To avoid useless IMS registrations, the solution without a new indicator,
assumes that PCO lists of P-CSCFs are not sent to the UE outside P-CSCF
restoration . This point is justified independently of the chosen solution.
The solution with a new indicator has as a higher impact on the UE as
requesting to handle this new indicator and support two behaviours according
to the presence or absence of this indicator,
There is a preference for the solution without a new indicator described in
6.6.3.2 clause as minimizing the impact to the UE.
### 6.6.5 Recommendation on P-CSCF restart
As the restarted P-CSCF being a valuable resource to be used for the new IMS
registrations resulting of its failure, it is first recommended to standardise
a solution where the PGW can request the UE to do a new IMS registration with
a possible reuse of the restarted P-CSCF used by the UE, without generating
useless IMS registrations.
Both solutions described in clause 6.6.3 answers this objective.
The comparison made in clause 6.6.4 gives a preference to the solution without
a new indicator described in clause 6.6.3.2, this solution is then
recommended.
# 7 Conclusions
## 7.1 Comparison analysis
### 7.1.1 Comparison criteria
Comparison among different solution alternatives should be based on the
following comparison criteria:
a) Objective compliance.
> Compliance to objectives is key for comparison. Each alternative is
> documenting its own compliance, in this clause it should be qualified from
> fully compliance to non-compliance at all to ease comparison. See clause 5.
b) Applicability.
> For each solution it is documented whether it covers 3GPP accesses and/or
> non-3GPP accesses.
c) Impacted network elements.
> The number of impacted network elements should be minimized, although
> complexity should be considered as well.
d) Impacted interfaces.
> The number of impacted interfaces should be minimized, although complexity
> should be considered as well.
e) Complexity.
> Complexity should be considered from different points of views:
  * Implementation complexity: it refers to impacts on interfaces and node behaviour.
  * Signalling complexity: it considers whether signalling flows complexity is increased.
  * Configuration complexity: it considers whether configuration is impacted or its complexity increases.
f) Performance.
> In case performance may be impacted, it should be properly highlighted. It
> is related to implementation and signalling complexity.
g) Roaming considerations.
> Specific operator agreements, limitations or any other consideration for
> roaming scenarios should be highlighted.
h) PDN connection reactivation required.
> Reactivation of the PDN connection may lead to poor subscriber experience,
> therefore if required it should be highlighted.
i) Coexistence with existing mechanism.
> Coexistence with existing mechanism shall be analysed for each alternative
> in its corresponding clause. Here it shall be highlighted whether this is
> possible, required or recommended, or whether there are complex interactions
> to take into account.
j) Added value.
> Any extra benefits by each solution should as well be highlighted.
k) Limitation or drawback.
> Document any already identified limitation or drawback, if any.
### 7.1.2 Sol-A: Double IMS registration
Table 7.1.2.-1 summarizes the comparison criteria fulfilment for this
alternative. Objective compliance is grey shaded.
Table 7.1.2-1 : Criteria evaluation table
+-----------------------+-------------------+-----------------------+ | Criteria | Fulfilment | Evaluation | +-----------------------+-------------------+-----------------------+ | Avoid massive | Yes | The reestablishment | | signalling | | of the failed path | | | | with a new | | | | registration can be | | | | spread over time. If | | | | the attempts are | | | | towards the failed | | | | P-CSCF, the timer | | | | between attempts | | | | should not be short. | | | | | | | | See clause 6.2.5. | +-----------------------+-------------------+-----------------------+ | Improve reliability | Yes | The detection of the | | | | P-CSCF failure is | | | | done on a per UE | | | | basis when attempting | | | | the establishment of | | | | new IMS sessions, | | | | originating or | | | | terminating. | | | | | | | | See clause 6.2.5 | +-----------------------+-------------------+-----------------------+ | Do not impact | No | This solution | | existing GSMA | | requires, apart from | | compliant UE | | specific | | | | functionality to | | | | support new proposed | | | | restoration | | | | mechanism, the | | | | support of the IMS | | | | multiple registration | | | | feature with its use | | | | in the context of | | | | P-CSCF restoration. | | | | This is not supported | | | | by existing GSMA | | | | compliant UEs. | | | | | | | | See clause 6.2.5. | +-----------------------+-------------------+-----------------------+ | Service availability | Yes | This solution allows | | | | maintaining the | | | | service availability | | | | when establishing new | | | | IMS sessions, | | | | originating or | | | | terminating. | | | | | | | | See clause 6.2.5. | +-----------------------+-------------------+-----------------------+ | Minimize H-PLMN | Yes | It only requires | | resource usage to | | S-CSCF to support the | | provide visited | | IMS double | | P-CSCF recovery | | registration. | | | | | | | | See clause 6.2.5. | +-----------------------+-------------------+-----------------------+ | Applicability | - | Applicable to all | | | | types of accesses. | +-----------------------+-------------------+-----------------------+ | Impacted elements | 2 | UE and S-CSCF. | +-----------------------+-------------------+-----------------------+ | Impacted interfaces | 0 | Interfaces are not | | | | impacted. | +-----------------------+-------------------+-----------------------+ | Complexity | Low | The UE and S-CSCF | | | | have to support the | | | | multiple IMS | | | | registration feature, | | | | to detect the P-CSCF | | | | failure and then to | | | | use the second | | | | registration. | | | | | | | | Functional impacts | | | | are small (simple | | | | mechanism) if the UE | | | | and the S-CSCF | | | | support the multiple | | | | registration feature. | | | | | | | | It is required to use | | | | a second P-CSCF. | +-----------------------+-------------------+-----------------------+ | Performance impact | Low | Low impacts since | | | | restoration | | | | triggering is done on | | | | per UE need basis and | | | | node behaviour | | | | complexity is low. | +-----------------------+-------------------+-----------------------+ | Roaming | Roaming agreement | This solution | | considerations | | requires the home | | | | S-CSCF to support the | | | | multiple IMS | | | | registration and its | | | | use with a P-CSCF | | | | failure. | +-----------------------+-------------------+-----------------------+ | PDN connection | No | | | reactivation required | | | +-----------------------+-------------------+-----------------------+ | Coexistence with | Not precluded | UE can use PCO based | | existing mechanism | | discovery mechanism | | | | when the mode with | | | | two PDN connections | | | | is used. | | | | | | | | Preferable to avoid | | | | its use when the mode | | | | with one PDN | | | | connection and two | | | | IMS registrations is | | | | used. | +-----------------------+-------------------+-----------------------+ | Other Added value | - | | +-----------------------+-------------------+-----------------------+ | Other limitations or | - | | | drawbacks | | | +-----------------------+-------------------+-----------------------+
### 7.1.3 Sol-C: Alternative with AS (via ISC and Sh)
Table 7.1.3.-1 summarizes the comparison criteria fulfilment for this
alternative. Objective compliance is grey shaded.
Table 7.1.3-1 :
+----------------------+----------------------+----------------------+ | **Alternative with | | | | AS (via ISC and | | | | Sh)** | | | +----------------------+----------------------+----------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +----------------------+----------------------+----------------------+ | Avoid massive | Fully compliant | Triggering only when | | signalling | | UE perform activity, | | | | which avoids mass | | | | signalling. | | | | | | | | See clause 6.4.5. | +----------------------+----------------------+----------------------+ | Improve reliability | Fully compliant | Reliability is | | | | improved as the | | | | triggering is only | | | | done on a per UE | | | | basis, and based on | | | | a well-defined set | | | | of error responses. | | | | | | | | See clause 6.4.5. | +----------------------+----------------------+----------------------+ | Do not impact | Fully compliant | No specific UE | | existing GSMA | | procedures required. | | compliant UE | | | | | | See clause 6.4.5. | +----------------------+----------------------+----------------------+ | Service availability | Fully compliant | Recovery is not | | | | dependent on massive | | | | signally that | | | | overloads the system | | | | and delays | | | | re-registration. | | | | | | | | Partial failure is | | | | detected and P-CSCF | | | | restoration is | | | | triggered | | | | immediately. | | | | | | | | See clause 6.4.5. | +----------------------+----------------------+----------------------+ | Minimize H-PLMN | Compliant | It just applies to | | resource usage to | | roaming users (very | | provide visited | | low number) and | | P-CSCF recovery | | impact on home | | | | elements is low. | | | | | | | | Home network | | | | dimensioning is not | | | | impacted. | | | | | | | | See clause 6.4.5. | +----------------------+----------------------+----------------------+ | Applicability | - | 3GPP accesses. | +----------------------+----------------------+----------------------+ | Impacted elements | 5 | P-CSCF, S-CSCF, AS, | | | | HSS, MME/SGSN. | +----------------------+----------------------+----------------------+ | Impacted interfaces | 5 | Sh/MAP, S6a/S6d/Gr. | +----------------------+----------------------+----------------------+ | Complexity | Low | Low implementation | | | | complexity, since | | | | interface | | | | modifications do not | | | | require new | | | | commands, but a new | | | | IE. Same type of | | | | extension is already | | | | done for other | | | | existing IEs. | | | | | | | | Very low impacts on | | | | HSS and MME/SGSN. | | | | Low impact in | | | | S-CSCF. | | | | | | | | Low impact in AS | | | | (see \"Added value\" | | | | criteria as well). | +----------------------+----------------------+----------------------+ | Performance impact | Very Low | Very low impacts | | | | since restoration | | | | triggering is done | | | | on per UE need basis | | | | and node behaviour | | | | complexity is low. | +----------------------+----------------------+----------------------+ | Roaming | Roaming agreement | This procedure does | | considerations | not required | not require a | | | | roaming agreement | | | | with V-PLMN. | | | | | | | | a) Both V-PLMN and | | | | H-PLMN supports | | | | this mechanism: | | | | | | | | > V-PLMN P-CSCF | | | | > triggers | | | | > restoration | | | | > including | | | | > information in | | | | > corresponding | | | | > error that is used | | | | > by H-PLMN to | | | | > request UE IMS PDN | | | | > connection | | | | > release. | | | | | | | | b) V-PLMN does not | | | | support this | | | | mechanism: | | | | | | | | > S-CSCF may | | | | > decrease | | | | > registration | | | | > expiration timers | | | | > for roaming users | | | | > in the REGISTER | | | | > response, only | | | | > when P-CSCF does | | | | > not include | | | | > information on | | | | > support of this | | | | > new feature. | | | | | | | | . | | | | | | | | See clause | | | | 6.4.3.2.3. | +----------------------+----------------------+----------------------+ | PDN connection | Yes | This mechanism is | | reactivation | | based on UE release | | required | | of formed IMS PDN | | | | connection and new | | | | PDN connection | | | | reactivation plus | | | | re-registration to a | | | | newly available | | | | P-CSCF. | +----------------------+----------------------+----------------------+ | Coexistence with | Not precluded | See clause 6.4.4. | | existing mechanism | | | | | Not recomm. | | +----------------------+----------------------+----------------------+ | Added value | Yes | AS could provide | | | | some added value | | | | functionality that | | | | could minimize | | | | damage due to P-CSCF | | | | failure and improve | | | | calling user | | | | perception, like for | | | | example: | | | | | | | | - Keep terminating | | | | call on hold until | | | | called UE is newly | | | | registered (using an | | | | available P-CSCF) | | | | and then continue | | | | the call | | | | establishment. | | | | Meanwhile an | | | | announcement can be | | | | played to the | | | | calling UE. | | | | | | | | - Redirect | | | | terminating call to | | | | called user voice | | | | mail, | | | | | | | | - Redirect call via | | | | CS. | | | | | | | | This functionality | | | | is out of the 3GPP | | | | standardization | | | | scope. | +----------------------+----------------------+----------------------+ | Limitations or | None | - | | drawbacks | | | +----------------------+----------------------+----------------------+
### 7.1.4 Sol-D: Alternative with direct Cx communication
#### 7.1.4.1 Basic mechanism -- PDN disconnection
Table 7.1.4.1-1 summarizes the comparison criteria fulfilment for this
alternative. Objective compliance is grey shaded.
Table 7.1.4.1-1 :
+----------------------+----------------------+----------------------+ | **Alternative with | | | | direct Cx | | | | communication -- PDN | | | | disconnection** | | | +----------------------+----------------------+----------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +----------------------+----------------------+----------------------+ | Avoid massive | Fully compliant | Similar to Sol-C. | | signalling | | | | | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Improve reliability | Fully compliant | Similar to Sol-C. | | | | | | | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Do not impact | Fully compliant | Similar to Sol-C. | | existing GSMA | | | | compliant UE | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Service availability | Fully compliant | Similar to Sol-C. | | | | | | | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Minimize H-PLMN | Compliant | Similar to Sol-C. | | resource usage to | | | | provide visited | | See clause 7.1.3. | | P-CSCF recovery | | | +----------------------+----------------------+----------------------+ | Applicability | - | 3GPP accesses | +----------------------+----------------------+----------------------+ | Impacted elements | 5 | P-CSCF, S-CSCF, HSS, | | | | MME/SGSN. | +----------------------+----------------------+----------------------+ | Impacted interfaces | 4 | Cx, S6a/S6d/Gr. | +----------------------+----------------------+----------------------+ | Complexity | Low OR Medium | Impacts on Cx | | | | interface depends on | | | | the implementation | | | | option finally | | | | selected at stage 3, | | | | if an existing | | | | procedure can be | | | | used cost is low, | | | | but if a new command | | | | is required, since | | | | it implies | | | | definition of a | | | | diameter application | | | | the implementation | | | | cost will increase. | | | | | | | | Very low impacts on | | | | HSS and MME/SGSN. | | | | Low impact in | | | | S-CSCF. | +----------------------+----------------------+----------------------+ | Performance impact | Very Low | Similar to Sol-C. | | | | | | | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Roaming | Roaming agreement | Similar to Sol-C. | | considerations | not required | | | | | See clause 7,1,3. | +----------------------+----------------------+----------------------+ | PDN connection | Yes | Similar to Sol-C. | | reactivation | | | | required | | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Coexistence with | Not precluded | Similar to Sol-C. | | existing mechanism | | | | | Not recomm. | See clause 7.1.3. | +----------------------+----------------------+----------------------+ | Added value | None | - | +----------------------+----------------------+----------------------+ | Limitations or | None | - | | drawbacks | | | +----------------------+----------------------+----------------------+
#### 7.1.4.2 Reuse of Rel-9 PCO based P-CSCF Restoration procedures extensions
##### 7.1.4.2.1 Extension 1 -- Decision at MME/SGSN
###### 7.1.4.2.1.1 Extension 1 Comparison criteria
Table 7.1.4.2.1.1-1 summarizes the comparison criteria fulfilment for the
optional extension to solution D that reuses part of existing Rel-9 based PCO
P-CSCF Restoration procedures based on decision at MME/SGSN. This table just
includes changes to base solution comparison table 7.1.4.1-1.
Table 7.1.4.2.1.1-1:
+-------------------------+----------------+-------------------------+ | **Alternative with | | | | direct Cx communication | | | | -- Reuse of Rel-9 PCO | | | | based P-CSCF | | | | Restoration procedures | | | | extension -- Decision | | | | at MME/SGSN** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not compliant | This alternative | | GSMA compliant UE | | requires UE Rel-9 PCO | | | | based P-CSCF | | | | Restoration procedures | | | | support, what is not | | | | included in GSMA IR.92 | | | | [7]. | | | | | | | | Therefore, it would be | | | | relevant that GSMA | | | | considers either | | | | recommending or | | | | requiring such support | | | | for UEs. | +-------------------------+----------------+-------------------------+ | Impacted elements | 5 | EPC: MME, S-GW, P-GW | | | | | | | | GPRS: SGSN, GGSN | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 4 | EPC: S11, S5 | | | | | | | | GPRS: Gn/Gp | +-------------------------+----------------+-------------------------+ | Complexity | Low | MME, SGSN, S-GW, P-GW | | | | and GGSN (and related | | | | interfaces) impacts. | +-------------------------+----------------+-------------------------+ | PDN connection | No | Update Bearer Request / | | reactivation required | | Update PDP Context is | | | | used instead of IMS PDN | | | | release | +-------------------------+----------------+-------------------------+ | Coexistence with | Partial reuse | Part of existing P-CSCF | | existing mechanism | | Restoration mechanism | | | | is required | +-------------------------+----------------+-------------------------+
###### 7.1.4.2.1.2 Methods to indicate the UE's support for Rel-9 PCO based
P-CSCF Restoration procedures to MME/SGSN
###### 7.1.4.2.1.2.1 Introduction
The optional extension that reuses Rel-9 based PCO P-CSCF Restoration
procedures is based on the possibility by MME/SGSN to identify whether or not
affected UE supports Rel-9 PCO based P-CSCF Restoration procedures.
Following methods are defined to provide such information to MME/SGSN
###### 7.1.4.2.1.2.2 Method 1 -- NAS based
One possible method is that the UE indicates this capability to the MME/SGSN,
as described in clause 6.5.3.2.2.2.1. Table 7.1.4.2.1.2.2-1 summarizes the
comparison criteria fulfilment for this method implementation, just including
changes to base solution comparison table 7.1.4.1-1.
Table 7.1.4.2.1.2.2-1:
+-------------------------+----------------+-------------------------+ | **Alternative with | | | | direct Cx communication | | | | -- UE Rel-9 PCO based | | | | P-CSCF Restoration | | | | procedures support | | | | indication -- Decision | | | | at MME/SGSN - NAS | | | | based** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not compliant | UE is impacted to be | | GSMA compliant UE | | able to provide to | | | | MME/SGSN an indication | | | | of its Rel-9 PCO based | | | | P-CSCF Restoration | | | | procedures support. | | | | | | | | Therefore, it would be | | | | relevant that GSMA | | | | considers either | | | | recommending or | | | | requiring such | | | | indication. | +-------------------------+----------------+-------------------------+ | Impacted elements | 3 | UE, MME/SGSN | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 1 | NAS | | | | | | | | Note: NAS impacts | | | | should be minimized, | | | | and then they are not | | | | normally accepted by | | | | CT1 unless they could | | | | be highly justified. | | | | Therefore, this | | | | proposal should be | | | | shared with CT1 in | | | | order to determine | | | | whether this could be | | | | considered as a | | | | feasible alternative. | +-------------------------+----------------+-------------------------+ | Complexity | Low | MME/SGSN new indication | | | | processing | +-------------------------+----------------+-------------------------+
###### 7.1.4.2.1.2.3 Method 2 -- IMS registration based
Same approach is followed for the method described in clause 6.5.3.2.2.2.2,
where the UE provides this capability to S-CSCF during IMS registration, while
during P-CSCF restoration procedure it is provided to HSS and then to
MME/SGSN. Table 7.1.4.2.1.2.3-1 covers this case.
Table 7.1.4.2.1.2.3-1:
+-------------------------+----------------+-------------------------+ | **Alternative with | | | | direct Cx communication | | | | -- UE Rel-9 PCO based | | | | P-CSCF Restoration | | | | procedures support | | | | indication -- Decision | | | | at MME/SGSN - IMS | | | | registration based** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not compliant | UE is impacted to | | GSMA compliant UE | | include a feature tag | | | | at IMS registration | | | | that indicates Rel-9 | | | | PCO based P-CSCF | | | | Restoration procedures | | | | support. | | | | | | | | Therefore, it would be | | | | relevant that GSMA | | | | considers either | | | | recommending or | | | | requiring such feature | | | | tag. | +-------------------------+----------------+-------------------------+ | Impacted elements | 2 | UE, S-CSCF | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 1 | New indication in SIP | | | | REGISTER. | | | | | | | | It could be a feature | | | | tag in Contact header. | +-------------------------+----------------+-------------------------+ | Complexity | Very low | Storing of indication | | | | in S-CSCF and | | | | indication forwarding | +-------------------------+----------------+-------------------------+
###### 7.1.4.2.2 Extension 2 -- Decision at P-GW/GGSN
###### # 7.1.4.2.2.1 Extension 2 - Comparison criteria
Table 7.1.4.2.2.1-1 summarizes the comparison criteria fulfilment for the
optional extension to solution D that reuses part of existing Rel-9 based PCO
P-CSCF Restoration procedures and is based on decision at P-GW/GGSN. This
table just includes changes to the base solution comparison table 7.1.4.1-1.
Table 7.1.4.2.2.1-1:
+-------------------------+----------------+-------------------------+ | **Alternative with | | | | direct Cx communication | | | | -- Reuse of Rel-9 PCO | | | | based P-CSCF | | | | Restoration procedures | | | | -- Decision at | | | | P-GW/GGSN** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not compliant | This alternative | | GSMA compliant UE | | requires UE Rel-9 PCO | | | | based P-CSCF | | | | Restoration procedures | | | | support. what is not | | | | included in GSMA IR.92 | | | | [7]. | | | | | | | | Therefore, it would be | | | | relevant that GSMA | | | | considers either | | | | recommending or | | | | requiring such support | | | | for UEs. | +-------------------------+----------------+-------------------------+ | Impacted elements | 5 | EPC: MME, S-GW, P-GW | | | | | | | | PC: SGSN, GGSN | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 4 | EPC: S11, S5 | | | | | | | | PC: Gn/Gp | +-------------------------+----------------+-------------------------+ | Complexity | Low | MME, SGSN, S-GW, P-GW | | | | and GGSN (and related | | | | interfaces) impacts. | +-------------------------+----------------+-------------------------+ | PDN connection | No | Update Bearer Request / | | reactivation required | | Update PDP Context is | | | | used instead of IMS PDN | | | | release | +-------------------------+----------------+-------------------------+ | Coexistence with | Partial reuse | Part of existing P-CSCF | | existing mechanism | | Restoration mechanism | | | | is required | +-------------------------+----------------+-------------------------+
###### 7.1.4.2.2.2 Method to indicate the UE's support for Rel-9 PCO based
P-CSCF Restoration procedures to P-GW/GGSN
The optional extension described in clause 6.5.3.2.3.1 that reuses Rel-9 based
PCO P-CSCF Restoration procedures is based on the possibility for the
P-GW/GGSN to identify whether or not affected UE supports Rel-9 PCO based
P-CSCF Restoration procedures. The possible method described in clause
6.5.3.2.3.2 is that the UE indicates this capability to the P-GW/GGSN.
Table 7.1.4.2.2.2-1 summarizes the comparison criteria fulfilment for this
method implementation, just including changes to the base solution comparison
table 7.1.4.1-1.
Table 7.1.4.2.2.2-1:
+-------------------------+----------------+-------------------------+ | **Alternative with | | | | direct Cx communication | | | | -- UE Rel-9 PCO based | | | | P-CSCF Restoration | | | | procedures support | | | | indication - Decision | | | | at P-GW/GGSN -- | | | | Indication from UE to | | | | P-GW/GGSN** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not compliant | UE is impacted to be | | GSMA compliant UE | | able to provide to | | | | P-GW/GGSN an indication | | | | of its Rel-9 PCO based | | | | P-CSCF Restoration | | | | procedures support. | | | | | | | | Therefore, it would be | | | | relevant that GSMA | | | | considers either | | | | recommending or | | | | requiring such | | | | indication. | +-------------------------+----------------+-------------------------+ | Impacted elements | 3 | UE, P-GW/GGSN | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 1 | NAS | | | | | | | | Impact limited to an | | | | additional PCO | | | | parameter, transparent | | | | to MME or SGSN | +-------------------------+----------------+-------------------------+ | Complexity | Low | P-GW/GGSN additional | | | | PCO processing | +-------------------------+----------------+-------------------------+
##### 7.1.4.2.3 Optional extensions comparison and selection
###### 7.1.4.2.3.1 Introduction
As a summary, solution D can be optionally extended to avoid PDN deactivation
and reactivation. Extensions are based on partial reuse of the existing Rel-9
PCO-based restoration mechanism.
Alternatives are compared in the following clauses, taking into account the
feedback received from CT1 (see LS CT4-141165).
###### 7.1.4.2.3.2 NAS based
See clause 7.1.4.2.1.2.2.
This option is discarded according to CT1 comments: \"This option seems to
imply that the SGSN/MME needs to handle a non-NAS capability in NAS and based
on that select a NAS procedure. This would break the layering principles\".
###### 7.1.4.2.3.3 IMS registration based
See clause 7.1.4.2.1.2.3.
CT1 does not have any feasibility concerns: \"It is possible to do this using
e.g. a media feature tag.\"
UE impacts are small. The UE has to include a media feature tag at IMS
registration (SIP REGISTER) that indicates Rel-9 PCO based P-CSCF Restoration
procedures support.
The use of an IMS registration to convey this UE capability impacts the same
network elements and interfaces as those impacted by the implementation of the
basic mechanism (see clause 7.1.4.1), i.e.: network elements: P-CSCF, S-CSCF,
HSS, MME/SGSN; interfaces: Cx, S6a/S6d/Gr.
This solution requires to include a new indication (that identifies UE support
for Rel-9 P-CSCF Restoration mechanism) coupled with the P-CSCF Restoration
Indication, therefore the impacts on several nodes and interfaces, on top of
basic mechanism, is small. The S-CSCF needs to store this new indication, to
be able to forward it later when a P-CSCF failure is identified.
This optional extension, on top of the basic mechanism (see clause 7.1.4.1),
impacts some new network elements and interfaces, i.e.: network elements:
S-GW, P-GW, GGSN; interfaces: S11, S5, Gn/Gp, for the MME/SGSN to trigger the
Update Bearer Request /Update PDP Context Request from PGW/GGSN when the UE
supports the PCO based restoration mechanism. This impact is small.
In a roaming case, this procedure impacts the HPLMN, through the new
indication at IMS registration plus indication conveyance. This procedure
cannot be used by the VPLMN if the HPLMN of the roamer has not implemented
this optional extension on top of the basic mechanism.
###### 7.1.4.2.3.4 PCO based
See clause 7.1.4.2.2.2.
CT1 does not have any feasibility concerns: \"It is possible to use the PCO IE
to transfer the capability indication to the PGW/GGSN\".
The UE impact is small, it has to indicate Rel-9 PCO based P-CSCF Restoration
procedures support to the P-GW/GGSN at the establishment of the IMS PDN
connection /PDP context, in a new PCO parameter.
This optional extension, on top of the basic mechanism (see clause 7.1.4.1),
impacts some new network elements and interfaces, i.e.: network elements:
S-GW, P-GW, GGSN; interfaces: S11, S5, Gn/Gp for the MME/SGSN to trigger the
Update Bearer Request /Update PDP Context Request from P-GW/GGSN. This impact
is small.
This solution requires the MME/SGSN to contact the PGW/GGSN in order to check
UE capability. Complexity is small. The PGW/GGSN needs to store UE capability,
since it needs to trigger PDN deactivation only when UE does not support Rel-9
P-CSCF Restoration procedure.
In a roaming case, this optional extension does not impact the HPLMN.
###### 7.1.4.2.3.5 Selection
Both solutions have following similarities:
  * UE impacts are required, although impacts are small.
  * Procedures and protocol complexity is small.
  * Both are impacting the MME/SGSN, SGW, P-GW/GGSN signalling path to trigger Update Bearer Request /Update PDP Context Request from the PGW/GGSN.
  * IMS registration based alternative have some particularities:Disadvantages:
\- In a roaming case, this optional extension impacts the HPLMN. This
procedure cannot be used by the VPLMN if the HPLMN of the roamer has not
implemented this optional extension on top of the basic mechanism of solution
D.
\- Although conveyance of the UE capability information does not impact any
new network element on top of the basic mechanism, it does impact several
network elements (i.e. P-CSCF, S-CSCF, HSS and MME). This impact for each
network element is small as it is transferred coupled with the P-CSCF
restoration indication, required for the basic mechanism, in the same
messages.
\- The S-CSCF is required to store the UE capability that is used for 3GPP
accesses only, when at the moment the S-CSCF is completely access technology
independent, with any such capabilities being constrained to the P-CSCF.
  * PCO based alternative have some particularities:Advantages:
> \- Conveyance of the UE capability information only impacts the PGW/GGSN
> network element.
\- In a roaming case, this optional extension does not impact the HPLMN.
However, the basic mechanism always impacts HPLMN, since it is triggered by
HPLMN.
\- This optional alternative has more commonalities in solution B (PCRF-based)
and solution D (HSS-based) than the IMS based alternative (see clause
6.5.7.3). Taking into account the conclusion in clause 7.2 that both solution
B and D are subject to standardization, having more commonalities can be
considered to be an advantage.
  * Disadvantages:
\- An additional message is required on the signaling path between the
MME/SGSN and the PGW/GGSN to trigger Update Bearer Request /Update PDP Context
Request from the PGW/GGSN when the UE does not support the PCO based P-CSCF
restoration mechanism.
As the new PCO parameter based alternative has advantages over the IMS
registration based alternative, the PCO parameter based alternative is
selected for standardization as an optional extension for the HSS-based
solution basic mechanism.
### 7.1.5 Sol-B: Alternative P-CSCF and PCRF based restoration
#### 7.1.5.1 Introduction
The comparison criteria fulfilment of Sol-B and its extension with support of
indication of UE supporting the PCO based P-CSCF restoration is described in
this section.
#### 7.1.5.2 Basic mechanism -- PDN disconnection
Table 7.1.5.2-1 summarizes the comparison criteria fulfilment for this
alternative. Objective compliance is grey shaded.
Table 7.1.5.2-1:
+------------------------+-----------------+------------------------+ | **Alternative P-CSCF | | | | and PCRF based | | | | Restoration** | | | +------------------------+-----------------+------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +------------------------+-----------------+------------------------+ | Avoid massive | Fully compliant | Since the proposed | | signalling | | P-CSCF recovery | | | | procedure is triggered | | | | only when an | | | | associated P-CSCF | | | | receives incoming IMS | | | | call. | +------------------------+-----------------+------------------------+ | Improve reliability | Fully compliant | Since the proposed | | | | P-CSCF recovery | | | | procedure is triggered | | | | only when an | | | | associated P-CSCF | | | | receives incoming IMS | | | | call. | +------------------------+-----------------+------------------------+ | Do not impact existing | Fully compliant | No specific UE | | GSMA compliant UE | | procedures required. | +------------------------+-----------------+------------------------+ | Service availability | Fully compliant | Recovery is not | | | | dependent on massive | | | | signally that | | | | overloads the system | | | | and delays | | | | re-registration. | | | | | | | | If the S-CSCF | | | | continues the | | | | terminating procedure | | | | after the UE completes | | | | the IMS registration, | | | | there would be no | | | | service loss at all to | | | | the UE. | +------------------------+-----------------+------------------------+ | Minimize H-PLMN | Compliant | Little impact to the | | resource usage to | | HPLMN for the IMS | | provide visited P-CSCF | | service to roaming | | recovery | | users. | +------------------------+-----------------+------------------------+ | Applicability | Compliant | 3GPP accesses and | | | | Non-3GPP accesses. | +------------------------+-----------------+------------------------+ | Impacted elements | 8 | S-CSCF/ATCF/IBCF, | | | | P-CSCF, PCRF and | | | | P-GW/GGSN. | +------------------------+-----------------+------------------------+ | Impacted interfaces | 3 | Rx, Gx and Mw. | +------------------------+-----------------+------------------------+ | Complexity | Medium | Impacts on an | | | | alternative P-CSCF | | | | could be considered as | | | | medium impacts since | | | | alternative P-CSCF has | | | | to receive and treat a | | | | SIP INVITE message | | | | that has no UE context | | | | in the P-CSCF. | | | | | | | | Impacts on Rx could be | | | | considered as medium | | | | impacts since STR | | | | command must be sent | | | | without session ID. | | | | | | | | Impacts on S-CSCF | | | | could be considered as | | | | medium impacts if it | | | | is to support | | | | continuation of | | | | terminating procedure. | +------------------------+-----------------+------------------------+ | Performance impact | Very Low | Very low impacts since | | | | restoration triggering | | | | is done on per UE need | | | | basis and node | | | | behaviour complexity | | | | is low. | +------------------------+-----------------+------------------------+ | Roaming considerations | Yes | Both HPLMN and VPLMN | | | | network have to be | | | | upgraded to support | | | | this feature. | +------------------------+-----------------+------------------------+ | PDN connection | Yes | | | reactivation required | | | +------------------------+-----------------+------------------------+ | Coexistence with | Yes | It is possible since | | existing mechanism | | this alternative is | | | | basically reusing the | | | | Rel-9 based solution. | +------------------------+-----------------+------------------------+ | Added value | None | - | +------------------------+-----------------+------------------------+ | Limitations or | Yes | The PDN connection | | drawbacks | | shall be disconnected | | | | and established again | | | | even UE supports the | | | | Release 9 PCO based | | | | behaviour due to lack | | | | of UE capability | | | | information in EPC | +------------------------+-----------------+------------------------+
#### 7.1.5.3 Extension -- Reuse of Rel-9 PCO based P-CSCF restoration
##### 7.1.5.3.1 General
This extension is based on Sol-B with additional support of the indication of
UE supporting the PCO based P-CSCF restoration. There are two options for the
UE to indicate its support of the Rel-9 PCO based P-CSCF restoration to the
P-GW/GGSN, as described in section 6.3.3.2.3.
Table 7.1.5.3.1-1 summarizes the comparison criteria fulfilment which is
different from the basic mechanism for the extension with IMS Registration
based Indication.
Table 7.1.5.3.1-1:
+-------------------------+----------------+-------------------------+ | **Alternative P-CSCF | | | | and PCRF based | | | | Restoration -- | | | | extension with IMS | | | | Registration based | | | | Indication** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not Compliant | To support the optional | | GSMA compliant UE | | function of indication | | | | of UE supporting the | | | | PCO based P-CSCF | | | | restoration, the UE | | | | needs to provide its | | | | capability regarding | | | | supporting the PCO | | | | based P-CSCF | | | | restoration to the | | | | network, which would | | | | introduce some impact | | | | on the UE. | +-------------------------+----------------+-------------------------+ | Impacted elements | 2 | UE, S-CSCF | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 1 | New indication in SIP | | | | REGISTER. | | | | | | | | It could be a feature | | | | tag in Contact header. | +-------------------------+----------------+-------------------------+ | Complexity | Medium | SIP REGISTER is | | | | impacted with addition | | | | of a new feature tag in | | | | the Contact header. | +-------------------------+----------------+-------------------------+ | PDN connection | No | | | reactivation required | | | +-------------------------+----------------+-------------------------+ | Limitations or | No | | | drawbacks | | | +-------------------------+----------------+-------------------------+
Table 7.1.5.3.1-2 summarizes the comparison criteria fulfilment which is
different from the basic mechanism for the extension with PCO based
Indication.
Table 7.1.5.3.1-2:
+-------------------------+----------------+-------------------------+ | **Alternative P-CSCF | | | | and PCRF based | | | | Restoration -- | | | | extension with PCO | | | | based Indication** | | | +-------------------------+----------------+-------------------------+ | **Criteria** | **Fulfilment** | **Evaluation** | +-------------------------+----------------+-------------------------+ | Do not impact existing | Not Compliant | To support the optional | | GSMA compliant UE | | function of indication | | | | of UE supporting the | | | | PCO based P-CSCF | | | | restoration, the UE | | | | needs to provide its | | | | capability regarding | | | | supporting the PCO | | | | based P-CSCF | | | | restoration to the | | | | network, which would | | | | introduce some impact | | | | on the UE. | +-------------------------+----------------+-------------------------+ | Impacted elements | 3 | UE, P-GW/GGSN | +-------------------------+----------------+-------------------------+ | Impacted interfaces | 1 | NAS | | | | | | | | Impact limited to an | | | | additional PCO | | | | parameter, transparent | | | | to MME or SGSN | +-------------------------+----------------+-------------------------+ | Complexity | Low | Addition of a new PCO | | | | parameter, transparent | | | | to MME and SGW. | +-------------------------+----------------+-------------------------+ | PDN connection | No | | | reactivation required | | | +-------------------------+----------------+-------------------------+ | Limitations or | No | | | drawbacks | | | +-------------------------+----------------+-------------------------+
## 7.2 Final conclusion
This chapter compares proposed alternative solutions and recommends one of
them as the final alternative to be considered for standardization.
Solution A has the following drawbacks:
  * It requires the UE to support the multiple registration mechanism, which represents a significant implementation impact.
  * It does not apply to existing terminals (in particular GSMA IR-92 compliant ones) since they do not support multiple registration mechanism.
  * It increases the resources to be allocated to the UE in the network, i.e. MME/SGSN, SGW, PGW (when two PDN connections), P-CSCF, S-CSCF for double IMS registration. Moreover, these resources are only used for the exceptional case of a P-CSCF failure.
These drawbacks are sufficient to discard the solution at this stage.
The main disadvantage of solution C as considered by some vendors and
operators seems to be that it always requires an AS to be deployed. Therefore,
solution D is considered to have some advantages over solution C.
Therefore, alternatives for comparison could be shortlisted and it is enough
to compare between solutions B and D.
Based on analysis done in this document, following conclusions are reached:
  * Both solution B and D are technically feasible.
  * After exhaustive comparison, as per analysis done in clause 7.1 (Comparison analysis), key criteria to select just one of them for standardization has not been agreed.
CT4 conducted a technical voting. The voting resulted that neither solution B
nor D reached the majority.
Therefore, this document concludes that both solutions, B and D, are selected
for standardization.
Both solutions consist of a basic mechanism that requires the deactivation and
reactivation of the IMS PDN connection and an optional extension avoiding this
deactivation. There are different optional extension proposals. According to
comparison analysis performed in clause 7.1.4.2.3, it is concluded that the
PCO based extension (i.e. a new PCO parameter to indicate the UE Rel-9 PCO
based P-CSCF restoration capability), common to both solutions B and D, is
selected for standardization. According to the clause 6.6.5, the solution
without a new indicator for P-CSCF restart described in clause 6.6.3.2 is part
of the recommended solutions B and D.
Following roaming conclusions are reached, as described in clause 6.5.6.5:
\- The HPLMN triggers the same restoration mechanism as the one supported by
the VPLMN, either HSS-based or PCRF-based, when the HPLMN knows that both the
HPLMN and the VPLMN support the same.
\- For inbound roamers to a VPLMN that implements HSS-based mechanism, the
VPLMN executes the HSS-based mechanism as long as the HPLMN has triggered it;
otherwise the VPLMN does not execute any P-CSCF restoration mechanism.
\- For inbound roamers to a VPLMN that implement PCRF-based mechanism, the
VPLMN executes the PCRF-based mechanism as long as the HPLMN has triggered it;
otherwise the VPLMN does not execute any P-CSCF restoration mechanism. Even in
case the HPLMN does not support PCRF-based mechanism, the VPLMN is able to
execute PCRF-based mechanism as long as NAT is not performed.
\- Alternatively, the VPLMN may, by e.g. configuration, execute the \"Update
PDP context/bearer at P-CSCF failure\" mechanism described in 3GPP TS 23.380
[2] clause 5.1, or other possible alternatives, like, e.g., reduce the
roamers' UE IMS re-registration timers.
###### ## Annex A (Informative): Solution D extension for non-3GPP access
A.1 Principles
This extension of the solution D describes the support of P-CSCF restoration
over non-3GPP access and is based on the same principles as the solution D
(c.f. clause 6.5.2), with the difference that the HSS will forward a request
for a release of the IMS PDN connection to the AAA server that will forward it
to the P-GW.
If the UE is registered to a non-3GPP accesses and has an IMS APN subscription
over non-3GGP accesses, the HSS forwards (without the need for any specific
processing) a request for the release of the IMS PDN connection to the AAA
Server which transfers it to the P-GW. The P-GW initiates the release of the
IMS PDN connection towards the UE via the non-3GPP access.
Based on the release of the IMS PDN connection, the UE will re-establish a new
IMS PDN connection and perform a new P-CSCF discovery (according to existing
procedures), and then register again to IMS.
A.2 Procedures for the extension to non-3GPP accesses
A.2.1 Procedures description
This solution is described in figure A.2.1-1.
{width="6.500694444444444in" height="5.840972222222222in"}
Figure A.2.1-1: Extension with non-3GPP access
This solution is an extension of the solution explained in the 6.5.3.1 clause:
For non-3GPP access, as there is no PCO based equivalent mechanism, the way to
request the UE to do a new IMS registration is to request a release of the IMS
PDN connection over the interface (S2a or S2b or S2c) through which the UE is
connected. The solution avoids disconnecting other PDN connections than the
IMS PDN one.
Steps 1 to 4 are common with the steps 1 to 4 of 6.5.3.1 clause.
> 5\. If the user has a non-3GPP access subscription with an IMS APN
> configuration and if the user has a non-3GPP access registration in the HSS,
> the HSS forwards an IMS PDN release indication to the AAA Server over SWx.
>
> An existing command pair should be reused to convey this indication over
> SWx. Push-Profile-Request/Answer (PPR/PPA) is proposed with a new flag in
> the PPR-Flags AVP.
If the user also has an IMS APN configuration subscribed over a 3GPP access
and is registered to a 3GPP access, the procedure described in 6.5.3.1 from
step 5 onwards applies in addition. As the HSS is not informed of the access
to which the UE is connected, this may result in a procedure to the AAA server
with no result.
Steps 6a and 7a describe the variant a:
> 6a If the AAA Server has the information that an IMS PDN connection is
> established for the user, the AAA Server sends an indication to the P-GW
> over S6b, via eventually a AAA Proxy over SWd if a VPLMN is involved, to
> proceed to the release of this IMS PDN connection.
>
> An existing command pair should be reused to convey this indication over S6b
> and SWd; the Abort Session Request/ Answer (ASR/ASA) is proposed with a new
> AVP.
>
> 7a To proceed with the release of the IMS PDN connection:
>
> \- For S2a, the P-GW initiates a bearer deactivation procedure (GTP) or a
> Proxy Mobile IPv6 LMA Initiated PDN Connection Deletion procedure (PMIP) to
> the trusted non 3GPP access domain.
>
> \- For S2b, the P-GW initiates a bearer deactivation procedure (GTP) or
> aProxy Mobile IPv6 LMA Initiated PDN Connection Deletion procedure (PMIP) to
> the ePDG.
>
> \- For S2c, the P-GW initiates a detach procedure as described in 3GPP TS
> 24.303 [10]).
>
> This procedure does not explicitly request the UE to re-establish the IMS
> PDN connection and do a new IMS registration; it is assumed that an IMS
> compliant UE shall re-attempt to obtain IMS service soon after detached from
> the IMS service.
Steps 6b and 7b describe the variant b:
> 6b If the AAA Server has the information that an IMS PDN connection is
> established for the user, the AAA Server sends an indication to the ePDG
> over SWm or to the trusted non-3GPP access network over STa, via eventually
> a AAA Proxy Server over SWd if a VPLMN is involved, to proceed to the
> release of the IMS PDN connection.
>
> An existing command pair should be reused to convey this indication over SWm
> or STa. R-Auth-Request/Answer (RAR/RAA) with a new AVP is proposed to be
> used over STa and over SWm.
>
> 7b It is assumed that the ePDG over S2b or the trusted non-3GPP access
> network over S2a can initiate the IMS APN PDN disconnection with the UE.
Step8 is common to variants a and b:
> 8\. As a result of the release of the IMS PDN connection, the UE re-
> establishes the IMS PDN connection, and also performs a new P-CSCF discovery
> (as the PDN was lost). After discovering a new P-CSCF, the UE will perform a
> new initial IMS registration towards IMS.
Regarding the two variants a and b, it is observed that:
> \- The functional impact is limited to S6b in the variant a, instead of STa,
> SWm and still S6b (for the S6c DSMIP case) with variant b.
>
> \- The variant b, by addressing network elements of the non-3GPP access, has
> homogeneity with the Solution D using the MME/SGSN to release the IMS PDN
> connection.
>
> \- In the case of STa, if the trusted non-3GPP access does not support the
> new STa enhancements, the IMS PDN connection will not be torn down and the
> UE will not perform a new IMS registration. Which means signalling will have
> been triggered uselessly from the S-CSCF to the HSS, 3GPP AAA Server (and
> possibly Proxy) and the non-3GPP access network, and may be repeated again
> by the S-CSCF e.g. at a subsequent SIP INVITE targeting the user.
>
> \- In the case of STa, the trusted 3GPP network access may be not under the
> responsibility of the HPLMN operator or of the VPLMN operator, which would
> need additional agreements.
From these observations, it is preferred to rely on the variant a and to use
the same procedure between the AAA Server and the P-GW over S6b, which is
applicable if the user is connected via S2a, S2b or S2c,
A.2.2 Future evolution
The procedures described in clause A.2.1 result in the release of the IMS PDN
connection, It would be worthwhile to avoid the release of the PDN connection
as this has been analysed for the solution D with 3GPP accesses.
3GPP, through the eSAMOG work item, is defining WLCP protocol which is a NAS
like protocol. This would give the possibility to use it to transfer PCO
equivalent information related to the PCO based P-CSCF restoration,
The changes would be very similar to the changes defined in a variant for
E-UTRAN access, i.e. UE indicating the support for PCO based P-CSCF
restoration at the time of IMS PDN connection and later the PGW provides the
updated list of P-CSCF addresses at the time of P-CSCF restoration.
There is a preliminary point which is to use a PCO like mechanism for P-CSCF
discovery through a WLAN; this point is outside this P-CSCF restoration study.
If this feature is introduced in 3GPP standards, it could be completed with a
PCO indicating the support of a PCO based P-CSCF restoration over WLAN. This
is a FFS item.
A.2.3 Coexistence with existing solution
Regarding the extension to support P-CSCF restoration over non-3GPP accesses,
there is no impact as the existing PCO based P-CSCF restoration does not apply
for non-3GPP accesses.
A.2.4 Objective compliance
Similar as in solution D described in clause 6.5.5.
Regarding the extension to support P-CSCF restoration over non 3GPP accesses,
the objective \"do not impact existing GSMA compliant UEs\" does not apply as
GSMA has not defined the use of IMS over non-3GPP accesses and EPC.
#