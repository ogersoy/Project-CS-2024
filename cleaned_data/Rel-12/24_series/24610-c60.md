# Foreword
This Technical Specification (TS) was been produced by ETSI Technical
Committee Telecommunications and Internet converged Services and Protocols for
Advanced Networking (TISPAN) and originally published as ETSI TS 183 010 [7].
It was transferred to the 3^rd^ Generation Partnership Project (3GPP) in
December 2007.
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document specifies the stage three Protocol Description of the
Communication Hold (HOLD) services, based on stages one and two of the ISDN
Hold (HOLD) supplementary services. It provides the protocol details in the IP
Multimedia (IM) Core Network (CN) subsystem based on the Session Initiation
Protocol (SIP) and the Session Description Protocol (SDP).
The present document is applicable to User Equipment (UE) and Application
Servers (AS) which are intended to support the HOLD supplementary service.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
  * References are either specific (identified by date of publication, > edition number, version number, etc.) or nonâ€‘specific.
  * For a specific reference, subsequent revisions do not apply.
  * For a non-specific reference, the latest version applies. In the > case of a reference to a 3GPP document (including a GSM document), > a non-specific reference implicitly refers to the latest version > of that document _in the same Release as the present document_.
[1] 3GPP TS 24.229: \"Internet Protocol (IP) multimedia call control protocol
based on Session Initiation Protocol (SIP) and Session Description Protocol
(SDP); Stage 3\".
[2] Void.
[3] Void
[4] IETF RFC 3264 (2002): \"An Offer/Answer Model with the Session Description
Protocol (SDP)\".
[5] 3GPP TS 22.173: \"IP Multimedia Core Network Subsystem (IMS) Multimedia
Telephony Service and supplementary services; Stage 1\".
[6] 3GPP TS 24.628: \"Common Basic Communication procedures; Protocol
specification\".
[7] ETSI TS 183 010 V1.2.2: \"Telecommunications and Internet converged
Services and Protocols for Advanced Networking (TISPAN); NGN Signalling
Control Protocol; Communication HOLD (HOLD) PSTN/ISDN simulation services;
Protocol specification\".
[8] IETF RFC 7090 (April 2014): \"Public Safety Answering Point (PSAP)
Callback\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TS 22.173 [5] apply.
## 3.2 Abbreviations
For the purposes of the present document, the following abbreviations apply:
ACR/CB Anonymous Communication Rejection and Communication Barring
AS SIP Application Server
CDIV Communication DIVersion
CSCF Call Session Control Function
ECT Explicit Communication Transfer
HOLD communication session HOLD
IMS IP Multimedia Subsystem
IP Internet Protocol
ISDN Integrated Service Digital Network
MCID Malicious Communication IDentification
OIP Originating Identification Presentation
OIR Originating Identification Restriction
P-CSCF Proxy-CSCF
PSAP Public Safety Answering Point
PSTN Public Switched **Telephone** Network
S-CSCF Serving-CSCF
SDP Session Description Protocol
SIP Session Initiation Protocol
TIP Terminating Identification Presentation
TIR Terminating Identification Restriction
UE User Equipment
# 4 Communication Hold (HOLD)
## 4.1 Void
## 4.2 Description
### 4.2.1 General description
The Communication Hold supplementary service enables a user to suspend the
reception of media stream(s) of an established IP multimedia session, and
resume the media stream(s) at a later time.
## 4.3 Operational requirements
### 4.3.1 Provision/withdrawal
The HOLD service that includes announcements shall be provided after prior
arrangement with the service provider.
### 4.3.2 Requirements on the originating network side
No specific requirements are needed in the network.
### 4.3.3 Requirements in the network
No specific requirements are needed in the network.
### 4.3.4 Requirements on the terminating network side
No specific requirements are needed in the network.
## 4.4 Coding requirements
No specific coding requirements are needed.
## 4.5 Signalling requirements
### 4.5.1 Activation/deactivation
The HOLD service is activated at provisioning and deactivated at withdrawal.
4.5.1A Registration/erasure
The HOLD service requires no registration. Erasure is not applicable.
4.5.1B Interrogation
Interrogation of HOLD is not applicable.
### 4.5.2 Invocation and operation
#### 4.5.2.1 Actions at the invoking UE
In addition to the application of procedures according to 3GPP TS 24.229 [1],
the following procedures shall be applied at the invoking UE in accordance
with RFC 3264 [4].
A UE shall not invoke the HOLD service on a dialog associated with an
emergency call the UE has initiated.
If not all the media streams are affected, the invoking UE shall generate a
new SDP offer where:
1) for each media stream that is to be held, the SDP offer contains:
\- an \"inactive\" SDP attribute if the stream was previously set to
\"recvonly\"; or
\- a \"sendonly\" SDP attribute if the stream was previously set to
\"sendrecv\";
NOTE 1: If the directionality attribute of the media stream is currently
\"sendonly\" or \"inactive\", then that media stream is not put on hold and,
in the SDP offer, the directionality for that media stream remains unchanged.
2) for each held media stream that is to be resumed, the SDP offer contains:
\- a \"recvonly\" SDP attribute if the stream was previously an inactive media
stream; or
\- a \"sendrecv\" SDP attribute if the stream was previously a sendonly media
stream, or the attribute may be omitted, since sendrecv is the default; and
3) for each media stream that is unaffected, the media parameters in the SDP
offer remain unchanged from the previous SDP.
If all the media streams are to be held:
\- if they all have identical directionality, the invoking UE shall generate
an SDP offer containing a session level direction attribute, or separate media
level direction attributes, in the SDP that is set to:
1) \"inactive\" if the streams were previously set to \"recvonly\"; or
2) \"sendonly\" if the streams were previously set to \"sendrecv\"; and
NOTE 2: If the directionality attribute of all the media streams is currently
\"sendonly\" or \"inactive\", then all these media streams are not put on hold
and, in the SDP offer, the directionality for these media streams will remain
unchanged.
\- if they all do not have identical directionality, then for each media
stream in the session, the invoking UE shall follow the procedure listed above
for individual media streams.
If all the media streams were previously on hold and are to be resumed:
\- if they all have identical directionality, the invoking UE shall generate a
session level direction attribute, or separate media level direction
attributes, in the SDP that is set to:
1) \"recvonly\" if the streams were previously inactive media streams; or
2) \"sendrecv\" if the streams were previously sendonly media streams, or the
attribute may be omitted, since sendrecv is the default; and
\- if they all do not have identical directionality, then for each media
stream in the session, the invoking UE shall follow the procedure listed above
for individual media streams.
If, in the generated SDP offer, there is at least one media stream whose
directionality has changed from the previous SDP, the UE shall send the
generated SDP offer in a re-INVITE request (or UPDATE request) to the remote
UE.
#### 4.5.2.2 Void
#### 4.5.2.3 Void
#### 4.5.2.4 Actions at the AS of the invoking UE
As a network option, for each media stream marked \"recvonly\" in the SDP
answer sent to the invoking UE, the AS of the invoking UE shall lower the
bandwidth by setting the \"b=AS:\" parameter to a small value, e.g.
\"b=AS:0\". The \"b=RR:\" and \"b=RS:\" parameters shall be set to values
large enough to enable continuation of the RTCP flow, e.g. \"b=RR:800\" and
\"b=RS:800\".
As a network option, for each media stream marked \"inactive\" in the SDP
answer sent to the invoking UE, the AS of the invoking UE shall lower the
bandwidth by setting the \"b=AS:\" parameter to a small value, e.g.
\"b=AS:0\". The \"b=RR:\" and \"b=RS:\" parameters shall be set to values
large enough to enable continuation of the RTCP flow, e.g. \"b=RR:800\" and
\"b=RS:800\".
NOTE 1: A media stream in the SDP answer can be marked as \"recvonly\" at
media description level or/and at session description level (i.e. all the
media streams are marked \"recvonly\").
As a network option, the AS of the invoking UE shall initiate the procedures
for the provision of an announcement to the held user in accordance with 3GPP
TS 24.628 [6].
NOTE 2: Not providing an announcement allows the service provider to provide
the possibility to change from bidirectional to unidirectional media streams.
NOTE 3: A service provider can decide to provide announcements only if a pre-
defined set of media streams are put on HOLD.
The AS shall based on local policy on how to handle PSAP callbacks reject any
HOLD invocation request from the served UE by sending a 403 (Forbidden)
response.
The mechanism to identify an INVITE request as a PSAP callback depends on
local policy and can be based on the PSAP callback indicator specified in IETF
RFC 7090 [8].
#### 4.5.2.5 Void
#### 4.5.2.6 Void
#### 4.5.2.7 Void
#### 4.5.2.8 Void
#### 4.5.2.9 Actions at the held UE
3GPP TS 24.229 [1] shall apply.
## 4.6 Interaction with other services
### 4.6.1 Communication Hold (HOLD)
Not applicable.
### 4.6.2 Terminating Identification Presentation (TIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.3 Terminating Identification Restriction (TIR)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.4 Originating Identification Presentation (OIP)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.5 Originating identification restriction (OIR)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.6 Conference calling (CONF)
If a participant of a conference invokes the HOLD service, it is not desirable
to provide an announcement to the conference. If the AS supporting the HOLD
supplementary service receives a re-INVITE (or UPDATE) request on a dialog for
which the \"isfocus\" feature parameter was included in the Contact header
from the remote end-point, the AS shall not initiate the procedures for the
provision of an announcement to the held user(s).
### 4.6.7 Communication DIVersion services (CDIV)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.8 Malicious Communication IDentification (MCID)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.9 Anonymous Communication Rejection and Communication Barring (ACR/CB)
No impact, i.e. neither service shall affect the operation of the other
service.
### 4.6.10 Explicit Communication Transfer (ECT)
No impact, i.e. neither service shall affect the operation of the other
service.
## 4.7 Interactions with other networks
### 4.7.1 Void
### 4.7.2 Void
### 4.7.3 Void
## 4.8 Parameter values (timers)
Not applicable.
###### ## Annex A (informative): Signalling Flows
# A.1 HOLD communication
Assumption is that a session has been established between UE-A and UE-B using
basic communication procedures according to 3GPP TS 24.229 [1], therefore the
following signalling flows do not apply to the initial INVITE.
## A.1.1 HOLD communication without announcement
The following diagram shows a communication session put on hold using a re-
INVITE request . The same can be achieved by sending an UPDATE request.
{width="6.6930555555555555in" height="4.346527777777778in"}
Figure A.1.1.1: HOLD communication without announcement to the held user
1\. UE-A sends a re- INVITE to UE-B to hold the session - see example in table
A.1.1.1-1. Hold is done by changing the SDP attribute. For each media stream
that shall be held:
\- \"a=sendonly\", if the stream was previously a sendrecv media stream;
\- \"a=inactive\", if the stream was previously a recvonly media stream.
Table A.1.1.1-1: re-INVITE request (UE to P-CSCF)
> INVITE
> user2_public1\@home2.net;gr=urn:uuid:2ad8950e-48a5-4a74-8d99-ad76cc7fc74
> ;comp=sigcomp SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171828
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel, gruu, 199
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \ gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6
> ;comp=sigcomp>;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:75
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendonly
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:25.4
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendonly
>
> a=sendonly
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
## A.1.2 HOLD communication with announcement
The following diagram shows a communication session put on hold using a re-
INVITE request with an announcement being played by the AS to the held party.
The same can be achieved by sending an UPDATE request.
Figure A.1.2.1: HOLD communication with announcement to the held user
1\. UE-A sends a SIP INVITE request to UE-B to hold the session - see example
in table A.1.2.1-1. Hold is done by changing the SDP attribute. For each media
stream that shall be held:
\- \"a=sendonly\", if the stream was previously a sendrecv media stream;
Table A.1.2.1-1: re-INVITE request (UE to P-CSCF)
> INVITE
> user2_public1\@home2.net;gr=urn:uuid:2ad8950e-48a5-4a74-8d99-ad76cc7fc74
> ;comp=sigcomp SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171828
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel, gruu, 199
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \ gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6
> ;comp=sigcomp>;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:75
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendonly
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:25.4
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendonly
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
2\. P-CSCF A forwards the SIP INVITE request towards S-CSCF.
3\. S-CSCF forwards the SIP INVITE request towards the AS/MRF.
4\. AS/MRF decides to configure an announcement towards UE-B. It acts as a B2B
UA, inserts MRFP in the media path and reserves resources. Each UA is
represented by a separate vertical line in the figure.
5\. AS/MRF sends a SIP INVITE request towards UE-B.
6\. S-CSCF forwards the SIP INVITE request towards UE-B.
7\. P-CSCF B forwards the SIP INVITE request to UE-B.
8\. UE-B sends SIP 200 (OK) response towards AS/MRF.
9\. P-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
10\. S-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
11\. AS/MRF starts playing announcement to UE-B, following the procedures in
3GPP TS 24.628 [6].
12\. AS/MRF sends a SIP 200 (OK) response towards UE-A.
13\. S-CSCF forwards the SIP 200 (OK) response towards UE-A.
14\. P-CSCF A forwards the SIP 200 (OK) response towards UE-A.
15\. UE-A sends a SIP ACK request towards AS/MRF.
16\. P-CSCF forwards the SIP ACK request towards AS/MRF.
17\. S-CSCF forwards the SIP ACK request towards AS/MRF.
18\. AS/MRF sends a SIP ACK request towards UE-B.
19\. S-CSCF forwards the SIP ACK request towards UE-B.
20\. P-CSCF B forwards the SIP ACK request towards UE-B.
21\. RTCP packets are exchanged between UE-A and AS/MRF. No RTP packets are
sent/received by UE-A.
## A.1.3 HOLD communication with modification of the SDP answer
The following diagram shows a communication session put on hold using a re-
INVITE request with an announcement being played by the AS to the held party.
The same can be achieved by sending an UPDATE request.
Figure A.1.3.1: HOLD communication with modification of the SDP answer
1\. UE-A sends a SIP INVITE request to UE-B to hold the session by changing
the direction attribute to \"a=sendonly\".
Table A.1.3-1: re-INVITE request (UE to P-CSCF)
> INVITE
> user2_public1\@home2.net;gr=urn:uuid:2ad8950e-48a5-4a74-8d99-ad76cc7fc74
> ;comp=sigcomp SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171828
>
> To: \; tag=24615
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel, gruu, 199
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \ gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6
> ;comp=sigcomp>;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:75
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendonly
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:25.4
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendonly
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
2\. P-CSCF A forwards the SIP INVITE request towards S-CSCF.
3\. S-CSCF forwards the SIP INVITE request towards the AS/MRF.
4\. AS/MRF decides to configure an announcement towards UE-B. It acts as a B2B
UA, inserts MRFP in the media path and reserves resources. Each UA is
represented by a separate vertical line in the figure.
5\. AS/MRF sends a SIP INVITE request towards UE-B.
6\. S-CSCF forwards the SIP INVITE request towards UE-B.
7\. P-CSCF B forwards the SIP INVITE request to UE-B.
8\. UE-B sends a SIP 200 (OK) response towards AS/MRF.
9\. P-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
10\. S-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
11\. AS/MRF starts playing announcement to UE-B, following the procedures in
3GPP TS 24.628 [6].
12\. The AS/MRF modifies the bandwidth attribute in the SIP 200 (OK) response.
Table A.1.3-2: 200 (OK) response (AS to S-CSCF)
> SIP/2.0 200 OK
>
> Via: SIP/2.0/UDP pcscf1.visited1.net;branch=z9hG4bk120f34.1
>
> Via: SIP/2.0/UDP 1.2.3.4:1357;branch=z9hG4bKnashds7
>
> From: \;tag=171828
>
> To: \; tag=24615
>
> Contact:
> \;+g.3gpp.icsi-
> ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> CSeq: 127 INVITE
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933817 2987933817 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:0
>
> b=RS:800
>
> b=RR:2400
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos mandatory remote sendrecv
>
> a=recvonly
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:0
>
> b=RS:800
>
> b=RR:800
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos mandatory remote sendrecv
>
> a=recvonly
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
13\. S-CSCF forwards the SIP 200 (OK) response towards UE-A.
14\. P-CSCF A forwards the SIP 200 (OK) response towards UE-A.
15\. UE-A sends a SIP ACK request towards AS/MRF.
16\. P-CSCF forwards the SIP ACK request towards AS/MRF.
17\. S-CSCF forwards the SIP ACK request towards AS/MRF.
18\. AS/MRF sends a SIP ACK request towards UE-B.
19\. S-CSCF forwards the SIP ACK request towards UE-B.
20\. P-CSCF B forwards the SIP ACK request towards UE-B.
21\. RTCP packets are exchanged between UE-A and AS/MRF. No RTP packets are
sent/received by UE-A.
# A.2 RESUME Communication
## A.2.1 RESUME communication without announcement
The following diagram shows how a communication session is resumed using a re-
INVITE request; The same can be achieved by sending an UPDATE request.
{width="6.6930555555555555in" height="4.346527777777778in"}
Figure A.2.1.1: RESUME communication without announcement to the held user
1\. UE-A sends an INVITE to UE-B to resume the session - see example in table
A.2.1.1-1. Resume is done by changing the SDP attribute. For each media stream
that shall be resumed:
\- \"a=sendrecv\", if the stream was previously a sendonly media stream, or
the attribute can be omitted, since sendrecv is the default;
\- \"a=recvonly\", if the stream was previously an inactive media stream.
Table A.2.1.1-1: re-INVITE request (UE to P-CSCF)
> INVITE
> user2_public1\@home2.net;gr=urn:uuid:2ad8950e-48a5-4a74-8d99-ad76cc7fc74
> ;comp=sigcomp SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171828
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel, gruu, 199
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \ gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6
> ;comp=sigcomp>;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:75
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendrecv
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:25.4
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendrecv
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
## A.2.2 RESUME communication with announcement
The following diagram shows how a communication session is resumed using a re-
INVITE request after it was held with an announcement being played by the AS
to the held party. The same can be achieved by sending an UPDATE request.
Figure A.2.2.1: RESUME communication with announcement to the held user
1\. UE-A sends a SIP INVITE request to UE-B to resume the session - see
example in table A.2.2.1-1. Resume is done by changing the SDP attribute. For
each media stream that shall be resumed:
\- \"a=sendrecv\", if the stream was previously a sendonly media stream, or
the attribute can be omitted, since sendrecv is the default;
Table A.2.2.1-1: re-INVITE request (UE to P-CSCF)
> INVITE
> user2_public1\@home2.net;gr=urn:uuid:2ad8950e-48a5-4a74-8d99-ad76cc7fc74
> ;comp=sigcomp SIP/2.0
>
> Via: SIP/2.0/UDP
> [5555::aaa:bbb:ccc:ddd]:1357;comp=sigcomp;branch=z9hG4bKnashds7
>
> Max-Forwards: 70
>
> Route: \,
> \
>
> P-Preferred-Identity: \"John Doe\" \
>
> P-Access-Network-Info: 3GPP-UTRAN-TDD; utran-cell-id-3gpp=234151D0FCE11
>
> Privacy: none
>
> From: \; tag=171828
>
> To: \
>
> Call-ID: cb03a0s09a2sdfglkj490333
>
> Cseq: 127 INVITE
>
> Require: sec-agree
>
> Proxy-Require: sec-agree
>
> Supported: precondition, 100rel, gruu, 199
>
> Security-Verify: ipsec-3gpp; q=0.1; alg=hmac-sha-1-96; spi-c=98765432;
> spi-s=87654321; port-c=8642; port-s=7531
>
> Contact: \ gr=urn:uuid:f81d4fae-7dec-11d0-a765-00a0c91e6bf6
> ;comp=sigcomp>;+g.3gpp.icsi-ref=\"urn%3Aurn-7%3gpp-service.ims.icsi.mmtel\"
>
> Allow: INVITE, ACK, CANCEL, BYE, PRACK, UPDATE, REFER, MESSAGE, SUBSCRIBE,
> NOTIFY
>
> Content-Type: application/sdp
>
> Content-Length: (...)
>
> v=0
>
> o=- 2987933615 2987933615 IN IP6 5555::aaa:bbb:ccc:ddd
>
> s=-
>
> c=IN IP6 5555::aaa:bbb:ccc:ddd
>
> t=0 0
>
> m=video 3400 RTP/AVPF 98 99
>
> b=AS:75
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendrecv
>
> a=rtpmap:98 H263
>
> a=fmtp:98 profile-level-id=0
>
> a=rtpmap:99:MPVMP4V-ES
>
> m=audio 3456 RTP/AVPF 97 96
>
> b=AS:25.4
>
> a=curr:qos local sendrecv
>
> a=curr:qos remote sendrecv
>
> a=des:qos mandatory local sendrecv
>
> a=des:qos optional remote sendrecv
>
> a=sendrecv
>
> a=rtpmap:97 AMR
>
> a=fmtp:97 mode-set=0,2,5,7; maxframes=2
>
> a=rtpmap:96 telephone-event
2\. P-CSCF A forwards the SIP INVITE request towards S-CSCF.
3\. S-CSCF forwards the SIP INVITE request towards the AS/MRF.
4\. AS/MRF stops playing announcement to UE-B, following the procedures in
3GPP TS 24.628 [6].
5\. AS/MRF forwards the SIP INVITE request towards UE-B, resulting in the
removal of MRFP from the media path.
6\. S-CSCF forwards the SIP INVITE request towards UE-B.
7\. P-CSCF B forwards the SIP INVITE request to UE-B.
8\. UE-B sends a SIP 200 (OK) response towards AS/MRF.
9\. P-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
10\. S-CSCF forwards the SIP 200 (OK) response towards AS/MRF.
11\. AS/MRF releases the resources allocated previously for the announcemnt
12\. AS/MRF forwards the SIP 200 (OK) response towards UE-A.
13\. S-CSCF forwards the SIP 200 (OK) response towards UE-A.
14\. P-CSCF A forwards the SIP 200 (OK) response towards UE-A.
15\. UE-A sends SIP ACK request towards AS/MRF.
16\. P-CSCF forwards the SIP ACK request towards AS/MRF.
17\. S-CSCF forwards SIP ACK request towards AS/MRF.
18\. AS/MRF forwards the SIP ACK request towards UE-B.
19\. S-CSCF forwards the SIP ACK request towards UE-B.
20\. P-CSCF B forwards the SIP ACK request towards UE-B.
###### ## Annex B (informative): Example of filter criteria
An example of an IFC Trigger Point configuration where the S-CSCF invokes the
HOLD AS:
\- Method=\"INVITE\".
An example of an IFC Trigger Point configuration where the S-CSCF does not
invoke the HOLD AS for a PSAP callback:
\- Method=\"INVITE\" and not Priority header field with a \"psap-callback\"
header field value.
NOTE: Not invoking the HOLD AS assumes that the HOLD invocation request can be
handled elsewhere in the network, e.g. in the PSAP itself.
#