# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the set of protocols and APIs for 5G Media
Streaming (5GMS) services based on the 5G Media Streaming Architecture
(5GMSA). 5GMS supports services including MNO and third-party Downlink Media
Streaming Services, and MNO and third-party Uplink Media Streaming Services.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 26.501: \"5G Media Streaming (5GMS); General description and
architecture\".
[3] DASH Industry Forum, \"Specification of Live Media Ingest\",\
https://dashif-documents.azurewebsites.net/Ingest/master/DASH-IF-Ingest.pdf
[4] 3GPP TS 26.247: \"Transparent end-to-end Packet-switched Streaming Service
(PSS); Progressive Download and Dynamic Adaptive Streaming over HTTP (3GP-
DASH)\".
[5] Standard ECMA-262, 5.1 Edition: \"ECMAScript Language Specification\",
June 2011.
[6] IETF RFC 6234: \"US Secure Hash Algorithms (SHA and SHA-based HMAC and
HKDF)\".
[7] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[8] ITU-T Recommendation X.509 (2005) \| ISO/IEC 9594-8:2005: \"Information
Technology -- Open Systems Interconnection -- The Directory: Public-key and
attribute certificate frameworks\".
[9] IETF RFC 7230: \"Hypertext-Transfer Protocol (HTTP/1.1): Message Syntax
and Routing\".
[10] IETF RFC 4648: \"The Base16, Base32, and Base64 Data Encodings\".
[11] IEEE Standard 1003.1™, Issue 7: \"The Open Group Base Specifications\",
2018.\ https://pubs.opengroup.org/onlinepubs/9699919799/
[12] 3GPP TS 29.571: \"Common Data Types for Service Based Interfaces; Stage
3\".
[13] 3GPP TS 38.321: \"NR; Medium Access Control (MAC) protocol
specification\".
[14] 3GPP TS 36.321: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Medium Access Control (MAC) protocol specification\".
[15] 3GPP TS 27.007: \"AT Command set for User Equipment (UE)\".
[16] IETF RFC 8446: \"The Transport Layer Security (TLS) Protocol Version
1.3\", August 2018.
[17] IETF RFC 7468: \"Textual Encodings of PKIX, PKCS, and CMS Structures\",
April 2015.
[18] ISO 3166‑1: \"Codes for the representation of names of countries and
their subdivisions --- Part 1: Country codes\".
[19] ISO 3166‑2: \"Codes for the representation of names of countries and
their subdivisions --- Part 2: Country subdivision code\".
[20] IETF RFC 5280: \"Internet X.509 Public Key Infrastructure Certificate and
Certificate Revocation List (CRL) Profile\", May 2008.
[21] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[22] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[23] OpenAPI: \"OpenAPI 3.0.0 Specification\", https://github.com/OAI/OpenAPI-
Specification/blob/master/versions/3.0.0.md.
[24] IETF RFC 7230: \"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax
and Routing\".
[25] IETF RFC 7231: \"Hypertext Transfer Protocol (HTTP/1.1): Semantics and
Content\".
[26] IETF RFC 7232: \"Hypertext Transfer Protocol (HTTP/1.1): Conditional
Requests\".
[27] IETF RFC 7233: \"Hypertext Transfer Protocol (HTTP/1.1): Range
Requests\".
[28] IETF RFC 7234: \"Hypertext Transfer Protocol (HTTP/1.1): Caching\".
[29] IETF RFC 7235: \"Hypertext Transfer Protocol (HTTP/1.1):
Authentication\".
[30] IETF RFC 5246: \"The Transport Layer Security (TLS) Protocol Version
1.2\".
[31] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[32] ISO/IEC 23009-1: \"Information technology; Dynamic adaptive streaming
over HTTP (DASH) --- Part 1: Media presentation description and segment
formats\".
[33] 3GPP TS 23.503: \"Policy and charging control framework for the 5G System
(5GS); Stage 2\".
[34] 3GPP TS 29.514: \"5G System; Policy Authorization Service; Stage 3\".
[35] 3GPP TS 26.511: \"5G Media Streaming (5GMS); Profiles, codecs and
formats\".
[36] Void.
[37] 3GPP TS 26.244: \"Transparent end-to-end packet switched streaming
service (PSS); 3GPP file format (3GP)\".
[38] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\", December 2017.
[39] **ISO 14496-12:** \"**Information technology -- Coding of audio-visual
objects -- Part 12: ISO base media file format** \"**.**
> [40] **ISO 23000-19:** \"**Information technology -- Coding of audio-visual
> objects -- Part 19: Common media application format (CMAF) for segmented
> media** \"**.**
[41] IETF RFC 3986: \"URI Generic Syntax\".
[42] 3GPP TS 26.118: \"Virtual Reality (VR) profiles for streaming
applications\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
Void.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5GMS 5G Media Streaming
5GMSd 5GMS downlink
5GMSu 5GMS uplink
5GMSA 5GMS Architecture
BMFF (ISO) Base Media File Format
ABR Adaptive Bit Rate
AF Application Function
ANBR Access Network Bit rate Recommendation
AS Application Server
CDN Content Delivery Network / Content Distribution Network
CGI Cell Global Identifier
CMAF Common Media Application Format
CRUD Create, Read, Update, Delete
CNAME Canonical Name
CORS Cross-Origin Resource Sharing
CRL Certificate Revocation List
DASH Dynamic Adaptive Streaming over HTTP
DER Distinguished Encoding Rule
DNN Domain Name News
DNS Domain Name Server
ECGI E-UTRAN Cell Global Identifier
ECMA European Computer Manufacturers Association
FQDN Fully Qualified Domain Name
GPSI Generic Public Subscription Identifier
HLS HTTP Live Streaming
ISO International Organization for Standardization
JSON JavaScript Object Notation
LCID Logical Channel IDentifier
MFBR Maximum Flow Bit Rate
MIME Multipurpose Internet Mail Extensions
MNO Mobile Network Operator
MPD Media Presentation Description
> MSISDN Mobile Subscriber ISDN number
NCGI NR Cell Global Identifier
NEF Network Exposure Function
OAM Operations, Administration and Maintenance
PCC Policy Control and Charging
PCF Policy Control Function
PEM Privacy-Enhanced Mail
PFD Packet Flow Description
PFDF Packet Flow Description Function
QoE Quality of Experience
QoS Quality of Service
SDF Service Data Flow
SHA Secure Hash Algorithm
TLS Transport Layer Security
URI Uniform Resource Identifier
URL Uniform Resource Locator
UTC Coordinated Universal Time
# 4 Procedures for Downlink Media Streaming
## 4.1 General
This clause defines all procedures for Downlink Media Streaming using the
different 5G Media Streaming Reference Points.
> NOTE: The descriptions of certain M1 interface procedures in clause 4.3, and
> of certain M5 interface procedures in clause 4.7, indicate applicability of
> those procedures to both downlink and uplink media streaming. This avoids
> redundant duplication of normative text in clause 5, regarding M1 and M5
> procedures for uplink media streaming.
## 4.2 APIs relevant to Downlink Media Streaming
Table 4.2‑1 summarises the APIs used to provision and use the various downlink
media streaming features specified in TS 26.501 [2].
Table 4.2‑1: Summary of APIs relevant to downlink media streaming features
5GMSd feature Abstract Relevant APIs
* * *
                                                                                                                                                                                                                                                       Interface       API name                                         Clause
Content protocols discovery Used by the 5GMSd Application Provider to
interrogate which content ingest protocols are supported by 5GMSd AS(s). M1d
**Content Protocols Discovery API** 7.5 Content hosting Content is ingested,
hosted and distributed by the 5GMSd AS according to a Content Hosting
Configuration associated with a Provisioning Session. M1d Provisioning
Sessions API 7.2 Server Certificates Provisioning API 7.3 Content Preparation
Templates Provisioning API 7.4 Content Hosting Provisioning API 7.6 M2d HTTP-
pull based content ingest protocol 8.2 DASH-IF push based content ingest
protocol 8.3 M4d DASH [4] or 3GP [37] 10 M5d Service Access Information API
11.2 Metrics reporting The 5GMSd Client uploads metrics reports to the 5GMSd
AF according to a provisioned Metrics Reporting Configuration it obtains from
the Service Access Information for its Provisioning Session. M1d Provisioning
Sessions API 7.2 Metrics Reporting Provisioning API 7.8 M5d Service Access
Information API 11.2 Metrics Reporting API 11.4 Consumption reporting The
5GMSd Client provides feedback reports on currently consumed content according
to a provisioned Consumption Reporting Configuration it obtains from the
Service Access Information for its Provisioning Session. M1d Provisioning
Sessions API 7.2 Consumption Reporting Provisioning API 7.7 M5d Service Access
Information API 11.2 Consumption Reporting API 11.3 Dynamic Policy invocation
The 5GMSd Client activates different traffic treatment policies selected from
a set of Policy Templates configured in its Provisioning Session. M1d
Provisioning Sessions API 7.2 Policy Templates Provisioning API 7.9 M5d
Service Access Information API 11.2 Dynamic Policies API 11.5 Network
Assistance The 5GMSd Client requests bit rate recommendations and delivery
boosts from the 5GMSd AF. M5d Service Access Information API 11.2 Network
Assistance API 11.6
## 4.3 Procedures of the M1 (5GMS Provisioning) interface
### 4.3.1 General
A 5GMS Application Provider may use the procedures in this clause to provision
the network for media streaming sessions that are operated by that 5GMS
Application Provider. For downlink media streaming, these sessions may be DASH
streaming sessions, progressive download sessions, or any other type of media
streaming or distribution (e.g. HLS) sessions. For uplink media streaming, the
content format and delivery protocol are defined by the 5GMSu Application
Provider, and may be either non-fully standardized or employ standardized
HTTP-based streaming of ISO BMFF content fragments as profiled by CMAF [39].
The M1 interface offers three different sets of procedures:
\- For downlink media streaming, configuration of content ingest at M2d for
onward distribution over M4d by the 5GMSd AS: designed as an API that is
equivalent to the functionality of a public CDN. For uplink media streaming,
configuration of content egest at M2u for the media content received by the
5GMSu AS from the 5GMSu Client over M4u. The resource types involved in
content hosting configuration are provisioning session (see clause 4.3.2),
content hosting procedures (see clause 4.3.3), ingest protocols (see clause
4.3.4), content preparation template (see clause 4.3.5), and server
certificates (see clause 4.3.6).
\- Configuration of dynamic policies: allows the configuration of Policy
Templates at M5 that can be applied to M4 downlink/uplink media streaming
sessions.
\- Configuration of reporting: permits the MNO to collect, at M5, QoE metrics
and consumption reports about M4 downlink sessions, as well as permits the MNO
to collect, at M5, QoE metrics reports about M4 uplink sessions.
A 5GMS Application Provider may use any of these procedures, in any
combination, to support its media streaming sessions.
### 4.3.2 Provisioning Session procedures
#### 4.3.2.1 General
Prior to configuring content hosting, dynamic policies, or reporting, the 5GMS
Application Provider shall create a new Provisioning Session. The following
CRUD operations are used to manage a provisioning session.
#### 4.3.2.2 Create Provisioning Session
This procedure is used by the 5GMS Application Provider to create a new
Provisioning Session. The 5GMS Application Provider shall use the HTTP POST
method to create a new Provisioning Session. Upon successful creation, the
5GMS AF shall respond with a _201 (Created)_ response message that includes
the resource identifier of the newly created Provisioning Session in the body
of the reply and the URL of the resource, including its resource identifier,
shall be returned as part of the HTTP Location header field.
#### 4.3.2.3 Read Provisioning Session properties
This procedure is used by the 5GMS Application Provider to obtain the
properties of the Provisioning Session from the 5GMS AF. The 5GMS Application
Provider uses the GET method for this purpose.
#### 4.3.2.4 Update Provisioning Session properties
The Update operation is not allowed on Provisioning Sessions.
#### 4.3.2.5 Destroy Provisioning Session
This procedure is used by the 5GMS Application Provider to destroy a
Provisioning Session. The 5GMS AF will release any associated resources, purge
any cached data, delete all QoS and reporting configurations associated with
this Provisioning Session. The 5GMS AF shall use the HTTP DELETE method for
this purpose.
### 4.3.3 Content Hosting Provisioning procedures
#### 4.3.3.1 General
These procedures are used by the 5GMSd Application Provider and the 5GMSd AF
on M1d to provision the content hosting feature for downlink streaming.
#### 4.3.3.2 Create Content Hosting Configuration
This procedure is used by the 5GMSd Application Provider to create a new
Content Hosting Configuration. The 5GMSd Application Provider shall use the
HTTP POST method for this purpose and the request message body shall include a
_ContentHostingConfiguration_ resource, as specified in clause 7.6.3.1.
\- If the Content Hosting Configuration uses the Pull-based content ingest
method, i.e. the _pull_ attribute is set to True, then the
_IngestConfiguration.baseURL_ property shall be nominated by the 5GMSd
Application Provider in the request message body.
\- If the Content Hosting Configuration uses the Push-based content ingest
method, i.e. the _pull_ attribute is set to False, then the
_IngestConfiguration.baseURL_ property shall be nominated by the 5GMSd AF and
returned in the response message body. It shall not be set by the 5GMSd
Application Provider in the request message body.
In all cases, the _DistributionConfiguration.baseURL_ property is read-only:
it shall be omitted from the creation request and shall be assigned by the
5GMSd AF, allowing the value to be inspected by the 5GMSd Application Provider
in the returned _ContentHostingConfiguration_ resource representation, or by
using the procedure specified in clause 4.3.3.3 below.
If the procedure is successful, the 5GMSd AF shall generate a resource
identifier representing the new Content Hosting Configuration. In this case,
the 5GMSd AF shall respond with a _201 (Created)_ HTTP response message and
shall provide the URL to the newly created resource in the Location header
field. The response message body may include a _ContentHostingConfiguration_
resource (see clause 7.6.3.1) that represents the current state of the Content
Hosting Configuration, including any fields set by the 5GMSd AF.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.3.3 Read Content Hosting Configuration properties
This procedure is used by the 5GMSd Application Provider to obtain the
properties of an existing Content Hosting Configuration resource from the
5GMSd AF. The HTTP GET method shall be used for this purpose.
If the procedure is successful, the 5GMSd AF shall respond with a _200 (OK)_
response message that includes the _ContentHostingConfiguration_ resource in
the response message body.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.3.4 Update Content Hosting Configuration properties
The update operation is invoked by the 5GMSd Application Provider to modify
the properties of an existing _ContentHostingConfiguration_ resource. All
writeable properties except _domainNameAlias_ may be updated. The HTTP PATCH
or HTTP PUT methods shall be used for the update operation.
If the procedure is successful, the 5GMSd AF shall respond with a _200 (OK)_
and provide the content of the resource in the response, confirming the
successful update operation.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.3.5 Destroy Content Hosting Configuration
This operation is used by the 5GMS Application Provider to destroy a Content
Hosting Configuration resource and to terminate the related distribution. The
HTTP DELETE method shall be used for this purpose. As a result, the 5GMS AF
will release any associated network resources, purge any cached content, and
delete any corresponding configurations.
If the procedure is successful, the 5GMSd AF shall respond with a _200 (OK)_
response message.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
### 4.3.4 Content Protocols Discovery procedures
#### 4.3.4.1 General
The set of downlink content ingest or uplink content egest protocols supported
by the 5GMS AS at interface M2 is described by the _ContentProtocols_ resource
at M1, as specified in clause 7.5.3.1.
#### 4.3.4.2 Create Content Protocols
The Create operation is not permitted for the _ContentProtocols_ resource.
#### 4.3.4.3 Read Content Protocols
This procedure is used by the 5GMS Application Provider to retrieve a list of
content ingest protocols supported by the 5GMS AS. The HTTP GET method shall
be used for this purpose.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response that includes a _ContentProtocols_ resource in the response message
body, as specified in clause 7.5.3.1. If the procedure is not successful, the
5GMS AF shall provide a response code as defined in clause 6.3.
#### 4.3.4.4 Update Ingest Protocols
The Update operation is not permitted for the _ContentProtocols_ resource.
#### 4.3.4.5 Destroy Ingest Protocols
The Delete operation is not permitted for the _ContentProtocols_ resource.
### 4.3.5 Content Preparation Template Provisioning procedures
#### 4.3.5.1 General
For downlink media streaming, the 5GMSd AS may be required to process content
ingested at interface M2d before serving it on interface M4d. For uplink media
streaming, the 5GMSu AS may be required to process content it receives from
the 5GMSu Client before passing it to the 5GMSu Application Provider on the
egest interface M2u. The content processing operations are specified in a
Content Preparation Template resource, as specified in clause 7.4.2.
#### 4.3.5.2 Create Content Preparation Template
This procedure is used by the 5GMS Application Provider to register a new
Content Preparation Template with a Provisioning Session. The 5GMS Application
Provider shall use the HTTP POST method to upload a new Content Preparation
Template resource. The MIME content type of the Content Preparation Template
shall be supplied in the Content-Type HTTP request header.
Upon successful creation, the 5GMS AF shall respond with a _201 (Created)_
response message and the URL of the newly created resource, including its
resource identifier, shall be returned as part of the HTTP Location header
field.
If the MIME content type indicated in Content-Type is not understood by the
5GMS AF, the creation of the Content Preparation Template resource shall fail
with HTTP error response status code _422 (Unprocessable entity)_.
If the 5GMS AF is unable to provision the resources indicated in the supplied
Content Preparation Template, the creation operation shall fail with an HTTP
response status code of _503 (Service Unavailable)_.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
#### 4.3.5.3 Read Content Preparation Template
This procedure is used by the 5GMS Application Provider to download a copy of
a Content Preparation Template resource from the 5GMS AF. The 5GMS Application
Provider shall use the GET method for this purpose.
If the procedure is successful, the 5GMS AF shall respond with _200 (OK)_ and
shall provide the requested resource in the HTTP message response body. The
Content-Type response header shall have the same value as that supplied when
the Content Preparation Template resource was created.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
#### 4.3.5.4 Update Content Preparation Template
The update procedure is used by the 5GMS Application Provider to modify or
replace an existing Content Preparation Template resource. The HTTP PATCH or
HTTP PUT methods shall be used for the update operation.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
and provide the content of the resource in the response, reflecting the
successful update operation.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
#### 4.3.5.5 Destroy Content Preparation Template
This operation is used by the 5GMS Application Provider to destroy a Content
Preparation Template resource. The HTTP DELETE method shall be used for this
purpose.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response message.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3. If the Content Preparation Template is in use as
part of a Content Hosting Configuration, the procedure shall fail with HTTP
error response status code _409 (Conflict)_.
### 4.3.6 Server Certificate Provisioning procedures
#### 4.3.6.1 General
Each X.509 server certificate [8] presented by the 5GMSd AS at interface M4d
is represented by a Server Certificate resource at M1d. The Server
Certificates Provisioning API as specified in clause 7.3 enables a Server
Certificate resource to be created within the scope of a Provisioning Session,
and subsequently referenced by a Content Hosting Configuration created in the
scope of the same Provisioning Session. That API supports two alternative
provisioning methods for Server Certificate resources: one in which a
certificate is generated by the 5GMS System operator on behalf of the 5GMSd
Application Provider; the other in which a certificate is generated by the
5GMSd Application Provider from a Certificate Signing Request solicited from
the 5GMSd AF. Both methods shall be supported by implementations of the 5GMSd
AF.
#### 4.3.6.2 Create Server Certificate
This procedure is used by the 5GMSd Application Provider to request that the
5GMS System generates a new X.509 certificate on its behalf within the scope
of a Provisioning Session. In this case, the certificate\'s Common Name (_CN_)
is assigned in a domain under the control of the 5GMSd System operator and the
use of supplementary domain name aliases is not supported.
The 5GMSd Application Provider shall use the HTTP POST method to create a new
Server Certificate resource. Upon successful creation, the 5GMSd AF shall
respond with a _201 (Created)_ response message and the URL of the resource,
including its resource identifier, shall be returned in the HTTP Location
header. The response message body may optionally include a copy of the X.509
certificate corresponding to the newly created Server Certificate resource, as
specified in clause 7.3.3.2.
NOTE: The X.509 certificate corresponding to the newly created Server
Certificate resource may not be available immediately for interrogation and
use. See clause 4.3.6.4 below for more details.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.6.3 Reserve Server Certificate
This procedure is used by the 5GMSd Application Provider to solicit a
Certificate Signing Request from the 5GMSd AF for the purpose of generating an
X.509 certificate independently of the 5GMSd System. In this case, the
certificate\'s Common Name (_CN_) is assigned in a domain under the control of
the 5GMSd Application Provider itself, or that of a third party acting on its
behalf. The 5GMSd Application Provider shall separately arrange for the FQDN
carried in the Common Name of the certificate generated, or that of a Subject
Alternative Name (_subjectAltName_) extension in the same certificate (see
section 4.2.1.6 of RFC 5280 [20]), to resolve to the address of a 5GMSd AS in
the target 5GMS System.
The 5GMSd Application Provider may specify additional domain name aliases in
its certificate reservation request to the 5GMSd AF. If provided, these shall
be included in the returned Certificate Signing Request using the Subject
Alternative Name (_subjectAltName_) extension (see section 4.2.1.6 of RFC 5280
[20]). In this case, the 5GMSd Application Provider is responsible for
ensuring that these FQDN aliases resolve to the Common Name of the 5GMSd AS in
the target 5GMS System.
The 5GMSd Application Provider shall use the HTTP POST method to create a new
Server Certificate. Upon successful creation of the resource, the 5GMSd AF
shall respond with a _201 (Created)_ response message and the URL of the
resource, including its resource identifier, shall be returned in the HTTP
Location header. The Content‑Type response header and the body of the HTTP
response message shall be as specified in clause 7.3.3.1.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.6.4 Retrieve Server Certificate
This procedure is used by the 5GMSd Application Provider to download a Server
Certificate resource for inspection. The HTTP GET method shall be used for
this purpose. If the requested resource exists and is populated with an X.509
certificate, the 5GMSd AF shall respond with _200 (OK)_ and shall return the
requested Server Certificate in accordance with clause 7.3.3.2.
In the case where the X.509 certificate was provisioned by the 5GMSd System on
behalf of the 5GMSd Application Provider according to clause 4.3.6.2 above,
the HTTP response _503 (Service Unavailable)_ shall be returned until such
time as the X.509 certificate is generated and available for download. The
optional HTTP response header Retry-After should be included in such a
response, indicating when the certificate is expected to become available for
inspection and use.
In cases where the X.509 certificate is to be generated by the 5GMSd
Application Provider from a Certificate Signing Request obtained according to
clause 4.3.6.3 above, the HTTP response _204 (No Content)_ shall be returned
until such time as the X.509 certificate has been uploaded using the procedure
specified in clause 4.3.6.5 below.
#### 4.3.6.5 Upload Server Certificate
This procedure is used by a 5GMSd Application Provider to upload an X.509
certificate that it has generated in response to a Certificate Signing Request
solicited using the reservation procedure specified in clause 4.3.6.3 above.
The HTTP PUT method shall be used for this purpose. The Content‑Type request
header and the body of the HTTP request message shall be as specified in
clause 7.3.3.2.
Before accepting the supplied X.509 certificate, the 5GMSd AF shall verify
that the party originating the upload is the same party that reserved the
Server Certificate resource using the procedure specified in clause 4.3.6.3
above. If there is a mismatch, the HTTP response _403 (Forbidden)_ shall be
returned.
Attempting to upload an X.509 certificate to a Server Certificate resource
that has not been reserved shall elicit a _404 (Not Found)_ HTTP response.
#### 4.3.6.6 Update Server Certificate
Updating a previously uploaded Server Certificate is not permitted for
security reasons. Any attempt to do so using the PUT method shall result in
the HTTP response _405_ _(Method Not Allowed)_.
To supply a replacement X.509 certificate, for example when a previously
supplied certificate is shortly due to expire, the 5GMSd Application Provider
should instead use one of the procedures specified in clause 4.3.6.2 or
4.3.6.3 above to create or reserve a new Server Certificate resource and, once
the certificate is available for use, update the Content Hosting Configuration
to reference it.
#### 4.3.6.7 Destroy Server Certificate
This procedure is used to remove a Server Certificate resource from a
Provisioning Session. The HTTP DELETE method shall be used for this purpose.
On success, the HTTP response _200 (OK)_ or _204 (No content)_ shall be
returned and afterwards the identifier of the Service Certificate resource is
no longer valid.
Only the party that created (see clause 4.3.6.2) or reserved (see clause
4.3.6.3) the Server Certificate resource is permitted to destroy it. Any
attempt by another party to destroy a Server Certificate resource shall elicit
the HTTP response _405 (Method Not Allowed)_.
The HTTP response _409 (Conflict)_ shall be returned if an attempt is made to
destroy a Server Certificate resource that is currently referenced by a
Content Hosting Configuration resource.
Attempting to destroy a Server Certificate resource that has been reserved but
never uploaded shall elicit a _200 (OK)_ HTTP response. In this case, the
5GMSd AF should release any resources associated with the reservation.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
### 4.3.7 Dynamic Policy Provisioning procedures
#### 4.3.7.1 General
These procedures are used by the 5GMS Application Provider to configure the
Policy Templates for streaming sessions of a particular Provisioning Session.
Figure 4.3.7.1‑1 below is a state diagram showing the life-cycle of a Policy
Template resource.
Figure 4.3.7.1‑1: Policy Template Resource State Diagram
Since Policy Templates require 5GMS System operator verification, a Policy
Template resource that is newly created cannot be used immediately. Upon
creation, a Policy Template resource shall be in the _PENDING_ state. Once all
mandatory properties are provided, the 5GMS AF triggers validation. If the
Policy Template is not deemed to be valid by the operator of the 5GMS System,
it shall move to the _INVALID_ state, from where it can be updated to remedy
the defect. Once it has been successfully validated by the 5GMS System
operator, a Policy Template resource shall take the _READY_ state, indicating
that it may be applied to media streaming sessions. If it is subsequently
updated by the 5GMS Application Provider, a Policy Template resource shall
return to the _PENDING_ state, awaiting revalidation by the operator of the
5GMS System. Finally, a Policy Template resource may be _SUSPENDED_ by the
5GMS System operator, e.g. in case of a violation of the usage terms or for
some other reasons, which renders it unusable. The update of any property
moves the state into _PENDING_ and triggers revalidation.
A Policy Template resource may be destroyed when it is in any of the
abovementioned states.
The 5GMS AF shall verify the status of a Policy Template resource prior to
allowing a Dynamic Policy Instance to instantiate it. Only a Policy Template
resource in the _READY_ state is eligible to be instantiated in this way.
The 5GMS AF shall indicate the current state of a Policy Template in the
Policy Template resource in machine-readable form as well as indicating a
human-readable reason for this state.
#### 4.3.7.2 Create Policy Template
This procedure is used by the 5GMS Application Provider to create a new Policy
Template resource. The HTTP POST method shall be used for this purpose.
If the procedure is successful, the 5GMS AF shall generate a resource
identifier to uniquely identify the newly created Policy Template resource. In
that case, it shall respond with a _201 (Created)_ HTTP response message and
provide the URL to the newly created resource in the Location header field.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
The default state of a newly created Policy Template resource is _PENDING_. If
all mandatory property values have been provided, the Policy Template resource
is eligible for validation.
#### 4.3.7.3 Read Policy Template
This procedure is used by the 5GMS Application Provider and other 5GMS AFs to
query the properties of an existing Policy Template resource from the 5GMS AF.
The HTTP GET method shall be used for this purpose.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response that includes a copy of the Policy Template resource in the response
message body.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
#### 4.3.7.4 Update Policy Template
The update operation is invoked by the 5GMS Application Provider to modify the
properties of an existing Policy Template resource. All available properties
except _state_ may be updated. The HTTP PATCH or HTTP PUT methods shall be
used for the update operation.
Any update to the Policy Template resource will change its state back to
_PENDING_ , which makes it temporarily unusable. If all mandatory property
values have been provided, the Policy Template is eligible for revalidation.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response message that includes a copy of the Policy Template resource in the
response message body. Modifications to read-only properties, such as changes
to the state of a Policy Template, shall be rejected with a _403 (Forbidden)_
HTTP response.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
#### 4.3.7.5 Destroy Policy Template
This operation is used by the 5GMS Application Provider to destroy a Policy
Template resource. The HTTP DELETE method shall be used for this purpose. As a
result, the 5GMS AF will remove the Policy Template from any Provisioning
Sessions that reference it.
Currently active media streaming sessions using the destroyed Policy Template,
if any exist, shall be stopped by the removal of the Policy Template.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response message.
If the procedure is not successful, the 5GMS AF shall provide a response code
as defined in clause 6.3.
### 4.3.8 Consumption Reporting Configuration procedures
#### 4.3.8.1 General
These procedures are used by the 5GMSd Application Provider to activate and to
configure consumption reporting. This clause defines the basic procedures.
More details are provided in clause 7.7.
#### 4.3.8.2 Create Consumption Reporting Configuration
This procedure is used by the 5GMSd Application Provider to activate
consumption reporting for a particular Provisioning Session. The 5GMSd
Application Provider shall use the HTTP POST method to activate the
consumption reporting procedure and to transmit the Consumption Reporting
Configuration to the 5GMSd AF. Upon successful operation, the 5GMSd AF shall
respond with a _201 (Created)_ response message and the same resource URL
shall be returned in the Location header field.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.8.3 Read Consumption Reporting Configuration
This procedure is used by the 5GMSd Application Provider to obtain the current
Consumption Reporting Configuration from the 5GMSd AF. The 5GMSd Application
Provider uses the GET method for this purpose.
#### 4.3.8.4 Update Consumption Reporting Configuration
The update operation is invoked by the 5GMSd Application Provider to modify
the current Consumption Reporting Configuration. All available parameters may
be updated. The HTTP PATCH or HTTP PUT methods shall be used for the update
operation.
If the procedure is successful, the 5GMSd AF shall respond with a _200 (OK)_
reflecting the successful update operation.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3.
#### 4.3.8.5 Destroy Consumption Reporting Configuration
This operation is used by the 5GMSd Application Provider to terminate the
related consumption reporting procedure. The HTTP DELETE method shall be used
for this purpose. As a result, the 5GMSd AF will release any associated
resources, purge any cached data, and delete any corresponding configurations.
If the procedure is successful, the 5GMSd AF shall respond with a _200 (OK)_
response message. If the procedure is not successful, the 5GMSd AF shall
provide a response code as defined in clause 6.3.
### 4.3.9 Metrics Reporting Provisioning procedures
#### 4.3.9.1 General
These procedures are used by the 5GMS Application Provider to configure QoE
metrics reporting functionality associated with downlink or uplink media
streaming. This clause defines the basic procedures. More details are provided
in clause 7.8.3.1.
A given instance of a Metrics Reporting Configuration resource is identified
by the _metricsReportingConfigurationId_ property of the
_MetricsReportingConfiguration_ resource, The properties of that resource, as
described in clause 7.8.3.1, pertain to metrics collection and reporting by
the Media Session Handler to the 5GMS AF.
#### 4.3.9.2 Create Metrics Reporting Configuration
This procedure is used by the 5GMS Application Provider to create a Metrics
Reporting Configuration resource for a particular Provisioning Session. The
5GMS Application Provider shall use the HTTP POST method for this purpose and
the request message body may include a _MetricsReportingConfiguration_
resource, as specified in clause 7.8.3.1. Upon successful operation, the 5GMS
AF shall respond with a _201 (Created)_ response message and the resource URL
for the newly-created Metrics Reporting Configuration resource shall be
returned in the Location header field. If the procedure is unsuccessful, the
5GMS AF shall provide a response code as defined in clause 6.3.
This procedure may be performed multiple times to provision different Metrics
Reporting Configurations in the scope of a particular Provisioning Session.
Each such configuration resource is represented by a different value of
_metricsReportingConfigurationId_.
#### 4.3.9.3 Read Metrics Reporting Configuration
This procedure is used by the 5GMS Application Provider to obtain the
properties of an existing Metrics Reporting Configuration resource from the
5GMS AF. The 5GMS Application Provider shall use the GET method for this
purpose. If successful, the 5GMS AF shall respond with a _200 (OK)_ and the
requested _MetricsReportingConfiguration_ resource (see clause 7.8.3.1) shall
be returned in the body of the HTTP response message. If the procedure is
unsuccessful, the 5GMS AF shall provide a response code as defined in clause
6.3.
#### 4.3.9.4 Update Metrics Reporting Configuration
The update operation is invoked by the 5GMS Application Provider to initially
upload the Metrics Reporting Configuration resource, or in the case of an
existing Metrics Reporting Configuration resource, to entirely replace or
modify certain properties of that resource. All available properties may be
updated. The HTTP PATCH or HTTP PUT methods shall be used for the update
operation.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
reflecting the successful update operation. If the procedure is unsuccessful,
the 5GMS AF shall provide a response code as defined in clause 6.3.
#### 4.3.9.5 Destroy Metrics Reporting Configuration
This operation is used by the 5GMS Application Provider to destroy a Metrics
Reporting Configuration resource and to terminate the related metrics
reporting procedure. The HTTP DELETE method shall be used for this purpose. As
a result, the 5GMS AF should release any associated resources, discard any
pending metrics reports, and delete any corresponding configurations.
If the procedure is successful, the 5GMS AF shall respond with a _200 (OK)_
response message. If the procedure is unsuccessful, the 5GMS AF shall provide
a response code as defined in clause 6.3.
## 4.4 Procedures of the M2d (5GMS content ingest) interface
The following 5GMS AS content ingest protocols are specified by the present
document at reference point M2d to support downlink media streaming:
\- An _HTTP pull-based content ingest protocol_ is specified in clause 8.2,
including specific handling for HTTP redirects issued to the 5GMS AS by the
5GMS Application Provider\'s origin server.
\- A _DASH-IF push-based content ingest protocol_ is specified in clause 8.3.
## 4.5 Procedures of the M3d interface
Interface M3d is internal and no procedures on this interface are specified.
## 4.6 Procedures of the M4d (Media Streaming) interface
### 4.6.1 Procedures for DASH Session
This procedure is used by a 5GMSd Client to establish a DASH session via the
M4d interface. In order to establish such a session, the 5GMSd AS shall host
an MPD as defined in ISO/IEC 23009-1 [32] or TS 26.247 [4] and the MPD URL is
known to the 5GMSd Client typically using M8d.
The Media Player receives an MPD URL from the 5GMSd-Aware Application through
M7d by methods defined in clause 13. The Media Player shall send an HTTP GET
message to the 5GMSd AS including the URL of the MPD resource. On success, the
5GMSd AS shall respond with a _200 (OK)_ message that includes the requested
MPD resource.
Additional procedures for reactions to different HTTP status codes are
provided in TS 26.247 [4], clause A.7 and ISO/IEC 23009-1 [32] clause A.7.
Additional procedures for handling partial file responses are provided in TS
26.247 [4], clause A.9.
This information is provided through M7d to the application for selection. In
addition, the currently used service description parameters are provided as
status information through M7d in order for the Media Session Handler to make
use of this information, for example for Dynamic Policy and Network
Assistance.
The detailed handling of service description information is documented in
clause 13.2 of the present document.
### 4.6.2 Procedures for Progressive Download Session
This procedure is used by a 5GMSd client to establish a Progressive Download
session via the M4d interface. In order to establish such a session, the 5GMSd
AS shall host an 3GP/MP4 file as defined in TS 26.247 [4]. The 3GP/MP4 URL is
known to the Media Player (in this case a progressive download player),
typically by using M8d.
The Media Player receives a URL from the 5GMSd-Aware Application through M7d
by methods defined in clause 13. The Media Player shall send an HTTP GET
message to the 5GMSd AS including the URL of the 3GP/MP4 resource. On success,
the 5GMSd AS shall respond with a _200 (OK)_ message that includes the
requested 3GP/MP4 resource.
Additional procedures for reactions to different HTTP status codes are
provided in TS 26.247 [4].
## 4.7 Procedures of the M5 (Media Session Handling) interface
### 4.7.1 Introduction {#introduction-1}
The M5 APIs are used by a Media Session Handler within a 5GMS Client to invoke
services relating to downlink or uplink media streaming at the 5GMS AF.
### 4.7.2 Procedures for Service Access Information
#### 4.7.2.1 General
Service Access Information is the set of parameters and addresses needed by
the 5GMSd Client to activate reception of a downlink media streaming session
or by a 5GMSu Client to activate an uplink media streaming session for
contribution. The data model of the _ServiceAccessInformation_ resource
acquired by the Media Session Handler of the 5GMS Client is shown in clause
11.2.3. Service Access Information additionally includes configuration
information to allow the Media Session Handler to invoke procedures for
dynamic policy (see clause 4.7.3), consumption reporting (clause 4.7.4),
metrics reporting (clause 4.7.5) and network assistance (clause 4.7.6).
\- For downlink media streaming, the Media Session Handler may obtain Service
Access Information from either the 5GMSd-Aware Application (via M6d) or the
5GMSd AF (via M5d). In the former case, the Service Access Information is
initially acquired by the 5GMSd-Aware Application from the 5GMSd Application
Provider via M8d. In the latter case, the Service Access Information is
derived by the 5GMSd AF from the Provisioning Session established via M1d.
Typically, the Service Access Information for downlink media streaming
includes a media entry point (e.g. a URL to a DASH MPD or a URL to a
progressive download file) that can be consumed by the Media Player and is
handed to the Media Player through M7d.
\- For uplink media streaming, the 5GMSu Client may obtain Service Access
Information from either the 5GMSu-Aware Application (via M6u/M7u) or the 5GMSu
AF (via M5u). In the former case, the Service Access Information is initially
acquired by the 5GMSu-Aware Application from the 5GMSu Application Provider
via M8u. In the latter case, the Service Access Information is derived by the
5GMSu AF from the Provisioning Session established via M1u.
This clause specifies the procedures whereby the 5GMS Client fetches Service
Access Information from the 5GMS AF.
#### 4.7.2.2 Create Service Access Information
The Create operation is not allowed on Service Access Information.
#### 4.7.2.3 Retrieve Service Access Information properties
This procedure shall be used by the Media Session Handler to acquire Service
Access Information from the 5GMS AF. The Media Session Handler uses the GET
method for this purpose.
The downlink or uplink media streaming session for which the Media Session
Handler is requesting data is identified by a unique reference contained in
the path of the URL, as specified in clause 11.2.2.
Once it has obtained an initial set of Service Access Information, the Media
Session Handler shall periodically check for updated Service Access
Information by issuing a conditional HTTP GET request containing either:
> \- an If-None-Match request header with the value of the entity tag (ETag)
> that was returned with the most recently acquired _ServiceAccessInformation_
> resource; or else
>
> \- an If-Modified-Since request header with the Last-Modified value of that
> most recently acquired resource.
The periodicity of polling for updated Service Access Information shall be
guided by the value of the Expires and/or Cache-control: max-age headers that
shall be included along with every response message for this procedure.
#### 4.7.2.4 Update Service Access Information properties
The Update operation is not allowed on Service Access Information.
#### 4.7.2.5 Destroy Service Access Information properties
The Destroy operation is not allowed on Service Access Information.
### 4.7.3 Procedures for dynamic policy invocation
This procedure is used by a Media Session Handler to manage Dynamic Policy
Instance resources via the M5 interface. A dynamic policy invocation consists
of a Policy Template Id, flow description(s), a 5GMS Application Service
Configuration Id and potentially other parameters, according to TS 26.501
clause 5.7.
A Policy Template Id identifies the desired Policy Template to be applied to
an application flow. A Policy Template includes properties such as specific
QoS (e.g. background data) or different charging treatments. The 5GMS AF
combines the information from the Policy Template with dynamic information
from the Media Session Handler to gather a complete set of parameters to
invoke the N33 or N5 API call. The Policy Template may contain for example the
AF identifier.
The flow description allows the identification and classification of the media
traffic, such as the packet filter sets given in clause 5.7.6 of [2].
In order to instantiate a new dynamic policy, the Media Session Handler shall
first create a resource for the Dynamic Policy Instance on the 5GMS AF. When
the Media Session Handler needs several dynamic policies, it repeats the step
as often as needed.
The Media Session Handler creates a new Dynamic Policy Instance by sending an
HTTP POST message to the 5GMS AF. The body of the HTTP POST message shall
include a Provisioning Session Id, the Policy Template Id and the Service Data
Flow description. The Service Data Flow description identifies the actual
application flow(s) to be policed according to the Policy Template. If the
operation is successful, the 5GMS AF creates a new resource URL representing
the Dynamic Policy Instance. In this case, the 5GMS AF shall respond to the
Media Session Handler with a _201 Created_ HTTP response message, including
the URL for the newly created Dynamic Policy Instance resource as the value of
the Location header field.
When the Dynamic Policy Instance is successfully instantiated, the 5GMS AF
triggers the creation of a corresponding policy in the 5G System. Depending on
the selected _sdfMethod_ , the 5GMS AF fills in a _flowDescription_ object and
/ or provides an application identifier referring to a _PFD_ (Packet Flow
Description) object containing the domain name.
NOTE 1: It is not defined in this Release how a 5GMS AF in an external Data
Network provides an application identifier.
NOTE 2: It is not defined in this Release how a 5GMS AF in an external Data
Network selects a specific DNN or S‑NSSAI.The Media Session Handler can modify
the parameters of an existing Dynamic Policy Instance resource using either
the HTTP PUT or PATCH methods, as appropriate to the desired update. The 5GMS
AF shall trigger the appropriate actions towards other Network Functions like
PCF or NEF when all information is set.
The Media Session Handler can destroy a Dynamic Policy Instance resource using
the HTTP DELETE method. As a result, the 5GMS AF shall trigger the appropriate
actions towards other Network Functions like PCF or NEF to remove the
associated PCC rule.
### 4.7.4 Procedures for consumption reporting
These procedures are used by the Media Session Handler and the Consumption
Reporting functions of the 5GMSd Client to submit a consumption report via the
M5d interface if Consumption Reporting is applied for a downlink streaming
session.
The Service Access Information indicating whether Consumption Reporting is
provisioned for downlink streaming sessions is described in clause 11.2.3.
When the _clientConsumptionReportingConfiguration.samplePercentage_ value is
100, the Media Session Handler shall activate the consumption reporting
procedure. If the _samplePercentage_ is less than 100, the Media Session
Handler shall generate a random number which is uniformly distributed in the
range of 0 to 100, and the Media Session Handler shall activate the
consumption report procedure when the generated random number is of a lower
value than the _samplePercentage_ value.
If the consumption reporting procedure is activated, the Media Session Handler
shall produce and submit a consumption report to the 5GMSd AF when any of the
following conditions occur:
> \- Start of consumption of a downlink streaming session;
>
> \- Stop of consumption of a downlink streaming session;
>
> \- Upon determining the need to report ongoing 5GMS consumption at periodic
> intervals determined by the
> _clientConsumptionReportingConfiguration.reportingInterval_ property.
>
> \- Upon determining a location change, if the
> _clientConsumptionReportingConfiguration.locationReporting_ property is set
> to _True_.
Whenever a consumption report is produced, the Media Session Handler shall
reset its reporting interval timer to the value of the c
_lient‌Consumption‌Reporting‌Configuration.‌reportingInterval_ property and it
shall begin countdown of the timer again. Whenever the Media Session Handler
stops the consumption of a downlink streaming session, it shall disable its
reporting interval timer.
In order to submit a consumption report, the Media Session Handler shall send
an HTTP POST message to the 5GMSd AF. If several 5GMSd AF addresses are listed
in the c _lient‌Consumption‌Reporting‌Configuration.‌serverAddresses_ array
(see table 11.2.3.1-1), the Media Session Handler shall choose one at random
and shall send the consumption report to the selected server endpoint. The
request body shall be a _ConsumptionReport_ structure, as specified in clause
11.3.3.1. The server shall respond with a _200 (OK)_ message to acknowledge
successful processing of the consumption report.
NOTE: If the connection via M5d for consumption reporting is temporarily
unavailable, the consumption reports are expected to be stored on the UE for
some time until connectivity to the 5GMSd AF is restored and sent later to the
5GMSd AF as a collection. Details are left to implementation.
The Consumption Reporting API, defining the data formats and structures and
related procedures for consumption reporting, is described in clause 11.3.
A reporting client identifier shall be included in the consumption report. If
available to the Media Session Handler, its value should be a GPSI value as
defined by TS 23.003 [7]. Otherwise, the reporting client identifier should be
represented by a stable and globally unique string.
### 4.7.5 Procedures for metrics reporting
The M5 procedures for QoE metrics reporting pertain to the combination of the
provisioning of metrics collection and reporting in the Media Session Handler
using relevant Service Access Information, and the sending of collected
metrics by the Media Session Handler to the 5GMS AF in accordance with the
configured metrics scheme(s). A metrics scheme may be 3GPP-defined or
non-3GPP-defined.
When the metrics collection and reporting feature is activated for a downlink
media streaming session, one or more metrics configuration sets, each
associated with a metrics scheme, may be provided to the 5GMS Client. A given
metrics configuration set contains information such as the 5GMS AF address(es)
to which metrics are to be sent by the Media Session Handler, metrics
reporting interval, target percentage of media streaming sessions for which
reports should be sent, and the set of metrics to be collected and reported.
See TS 26.501 [2] for additional details.
For progressive download and DASH streaming services, the listed metrics in a
given metrics configuration set are associated with the 3GPP metrics scheme
and shall correspond to one or more of the metrics as specified in clauses
10.3 and 10.4, respectively, of TS 26.247 [4]. Metrics related to virtual
reality media, as specified in TS 26.118 [42] clause 9.3, may also be listed
in the metrics configuration.
Whenever a metrics report is produced for a given metrics configuration, the
Media Session Handler shall reset its reporting interval timer for that
configuration to the value of the c
_lientMetrics‌Reporting‌Configurations[].‌reportingInterval_ property and it
shall begin countdown of the timer again. Whenever the Media Session Handler
stops the consumption of a downlink streaming session, it shall disable its
reporting interval timer for all metrics configurations.
In order to submit a metrics report, the Media Session Handler shall send an
HTTP POST message to the 5GMS AF. If several 5GMS AF addresses are listed in
the c _lientMetrics‌Reporting‌Configurations[].‌serverAddresses_ array (see
table 11.2.3.1-1), the Media Session Handler shall choose one at random and
shall send the metrics report to the selected server endpoint. The request
body shall be formatted according to the metrics scheme indicated in
_clientMetrics‌Reporting‌Configurations[].‌metrics‌Reporting‌ConfigurationId_
(see table 11.2.3.1-1), as specified in clause 11.4.3. The server shall
respond with a _200 (OK)_ message to acknowledge successful processing of the
metrics report.
NOTE: If the connection via M5 for metrics reporting is temporarily
unavailable, the metrics reports are expected to be stored on the UE for some
time until connectivity to 5GMS AF is restored and sent later to the 5GMS AF
as a collection. Details are left to implementation.
Details of the metrics reporting API are provided in clause 11.4, and for 3GP-
DASH based downlink media streaming services, the 3GPP-defined metrics
reporting scheme and metrics report format are defined in clause 11.4.3.
A reporting client identifier may be included in the metrics report. If
available to the Media Session Handler, its value should be a GPSI value as
defined by TS 23.003 [7]. Otherwise, the reporting client identifier should be
represented by a stable and globally unique string.
### 4.7.6 Procedures for network assistance
These procedures are used by the 5GMS Client to request Network Assistance
from one of the 5GMS AF instances listed in the
_networkAssistanceConfiguration.serverAddresses_ property of the Service
Access Information resource retrieved using the procedure in clause 4.7.2.3.
Details of the APIs supporting these procedures are specified in clause 11.6.
The 5GMS Client first creates a Network Assistance Session with its chosen
5GMS AF instance. It provides information that will later be used by the 5GMS
AF to request a particular network QoS to be applied by the PCF to one or more
application data flows, and to recommend a bit rate to the 5GMS Client. This
procedure is further specified in clause 11.6.4.1.
The _NetworkAssistanceSession_ resource may be retrieved by the Media Session
Handler using the procedure specified in clause 11.6.4.2.
When a Network Assistance Session is created, the responding 5GMS AF instance
may nominate an MQTT endpoint URL in the
_NetworkAssistanceSession.notificationURL_ property. The Media Session Handler
may subscribe to the MQTT channel provided at this endpoint and receive
notifications with an up-to-date bit rate recommendation whenever this
changes.
At any time after the Network Assistance Session resource is created, the 5GMS
Client may use the Network Assistance Session identifier to explicitly request
a bit rate recommendation by invoking a remote procedure call provided for
this purpose by the 5GMS AF. This procedure is further specified in clause
11.6.4.3.
Using the Network Assistance identifier, the 5GMS Client may also request a
delivery boost to be provided by the 5G System at any time by invoking a
remote procedure call provided for this purpose by the 5GMS AF. This procedure
is further specified in clause 11.6.4.4.
The information provided when first creating a Network Assistance Session may
be modified subsequently by the Media Session Handler using the session
modification procedure specified in clause 11.6.4.5.
In order to terminate a Network Assistance Session, the 5GMS Client deletes
the Network Assistance session resource. This procedure is further specified
in clause 11.6.4.6.
## 4.8 Procedures of the M6d (UE Media Session Handling) interface
### 4.8.1 General
This clause contains the procedures for the interaction between the 5GMSd-
Aware application or the Media Player and the Media Session Handler through
the M6d API. Details are provided in clause 12.
### 4.8.2 Consumption reporting procedures
Before a streaming session is started, the Media Session Handler shall check
if the Service Access Information contains any Consumption reporting
configuration, as specified in clause 4.7.3. If such a configuration is
present, the Media Session Handler shall initiate consumption reporting based
on this configuration for the current streaming session.
The Media Session Handler shall first determine whether consumption reporting
is active for the session. The determination shall be based on the
_samplePercentage_ attribute specified in the consumption reporting
configuration. When the _samplePercentage_ is not present or its value is 100,
consumption reporting is active for the session. If the _samplePercentage_ is
less than 100, the Media Session Handler generates a random number which is
uniformly distributed in the range 0 to100; consumption reporting is active
for the session when the generated random number is of a lower value than the
_samplePercentage_ value.
If consumption reporting for this session is active, the Media Session Handler
shall regularly determine the consumption reporting parameters defined in
clause 11.3.2.4 from the Media Player through the M7d interface and shall
report these values according to the _reportingInterval_ specified in the
Client Consumption Reporting Configuration.
## 4.9 Procedures of the M7d (UE Media Player) interface
### 4.9.1 General
This clause contains the procedures for the interaction between the 5GMSd-
Aware Application or the Media Session Handler and the Media Player through
the M7d API. Details are provided in clause 13.
### 4.9.2 Metrics reporting procedures
These procedures shall be used by the Media Session Handler function to
control metrics reporting when such reporting is configured via metadata sent
in-band via the media manifest.
When a streaming session is started, the Media Session Handler shall check if
the manifest contains any metrics configuration, as specified in TS 26.247
clauses 10.4 and 10.5, or TS 26.118 [42] clause 9.3. If such a configuration
is found, the Media Session Handler shall use it for the current streaming
session.
The Media Session Handler shall first determine whether metrics from this
session shall be reported. The determination shall be based on the
_samplePercentage_ attribute specified in the metrics configuration, according
to TS 26.247 clause 10.5.
If metrics are reported for the session, the Media Session Handler shall
request the Media Player to create a metrics collection job. The Media Player
shall return a reference to the created job, which the Media Session Handler
shall use in all subsequent actions related to this job.
The Media Session Handler shall configure the metrics collector job with the
set of metrics which shall be collected during the session. The format of the
configuration shall be according to TS 26.247 Annex L.2, but note that only
the _metrics_ attribute in the configuration shall be used for this purpose.
The Media Session Handler shall regularly request the collected metrics from
the Media Player according to the _reportingInterval_ specified in the metrics
configuration. The metrics returned by the Media Player shall use the format
as described in TS 26.247 clause 10.6, and (for virtual reality media) in TS
26.118 [42] clause 9.4 and the Media Session Handler shall forward these to
the server address _(es) specified in the metrics configuration_ using the
specified _DNN_ according to the procedures described in TS 26.247 clause
10.6.
When the session is finished the Media Session Handler shall delete the
metrics collection job.
## 4.10 Procedures of the M8d interface
This clause defines basic procedures for M8d.
No specific procedures are defined but it is expected that the 5GMSd
Application Provider can provide media session entry points to a 5GMSd-Aware
Application through M8d. The 5GMSd-Aware Application would then initiate the
media session by providing such an entry point to the 5GMSd Client through
M7d.
# 5 Procedures for Uplink Media streaming
## 5.1 General
Uplink media streaming functional entities in the 5GMS System include the
5GMSu Application Provider, 5GMSu AF, 5GMSu AS and the UE. To make use of
these other entities, the UE includes a 5GMSu-Aware Application that is
provided by the 5GMS Application Provider and a 5GMSu Client comprising the
Media Session Handler and the Media Streamer.
The M1 Provisioning API enables the 5GMSu Application Provider to establish
and manage the uplink media session handling and streaming options of the
5GMSu system.
The M2u Egest interface enables Uplink media streaming content sent by the
5GMSu Client to the 5GMSu AS over interface M4u to be subsequently delivered
to the 5GMSu Application Provider. Uplink media streaming media transfer from
the 5GMSu AS to the 5GMSu Application Provider may be either pull-based and
initiated by the 5GMSu Application Provider using the HTTP GET method, or
push-based and initiated by the 5GMSu AS using the HTTP PUT method. The
resource identifier of the 5GMSu Application Provider for push-based streaming
content delivery is provided to the 5GMSu AS by the 5GMSu AF over the M3u
interface, as part of the M1 Provisioning Session.
The 5GMSu AF, having acquired M1 Provisioning information, sets up the M5
interface that the 5GMSu Client can use for Uplink media streaming session
management, remote control, metrics reporting, network assistance and request
for policy and/or charging treatment. Certain types of configuration and
policy information accessed over M5 by the Media Session Handler, such as
uplink metrics reporting, QoS policy, or support for AF-based network
assistance are further passed to the Media Streamer via the M7u API.
Based on the configuration information received on M5 and a request from the
Media Streamer received over the M6u interface, the Media Session Handler sets
up an Uplink media streaming session with the 5GMSu AF. Upon successful
session establishment, the Media Session Handler triggers the Media Streamer
to begin Uplink media streaming of media content to the 5GMSu AS over the M4u
interface.
Subscription to status and other event notification services are offered by
the Media Session Handler to the 5GMSu-Aware Application and to the Media
Streamer via the M6u APIs exposed by the Media Session Handler.
Subscription to status and other event notification services are also offered
by the Media Streamer to the 5GMSu-Aware Application and to the Media Session
Handler via the M7u APIs exposed by the Media Player.
## 5.2 APIs relevant to Uplink Media Streaming
Table 5.2‑1 summarises the APIs used to provision and use the various uplink
media streaming features specified in TS 26.501 [2].
Table 5.2‑1: Summary of APIs relevant to uplink media streaming features
5GMSu feature Abstract Relevant APIs
* * *
                                                                                                                                                                                                                                   Interface       API name                                             Clause
Content protocols discovery Used by the 5GMSu Application Provider to query
which content egest protocols are supported by 5GMSu AS(s). M1u **Content
Protocols Discovery API** **7.5** Content preparation Supports manipulation by
the 5GMSu AS of streaming media content uploaded by 5GMSu Client over M4u,
prior to egest of the manipulated content over M2u. M1u **Content Preparation
Templates Provisioning API** 7.4 Metrics reporting The 5GMSu Client uploads
metrics reports to the 5GMSu AF according to a provisioned Metrics Reporting
Configuration it obtains from the Service Access Information for its
Provisioning Session. M1u Provisioning Sessions API 7.2 Metrics Reporting
Provisioning API 7.8 M5u Service Access Information API 11.2 Metrics Reporting
API 11.4 Dynamic Policy invocation The 5GMSu Client activates different
traffic treatment policies selected from a set of Policy Templates configured
in its Provisioning Session. M1u Provisioning Sessions API 7.2 Policy
Templates Provisioning API 7.9 M5u Service Access Information API 11.2 Dynamic
Policies API 11.5 Network Assistance The 5GMSu Client requests bit rate
recommendations and delivery boosts from the 5GMSu AF. M5u Service Access
Information API 11.2 Network Assistance API 11.6
# 6 General aspects of APIs for 5G Media Streaming
## 6.1 HTTP resource URIs and paths
The resource URI used in each HTTP request to the API provider shall have the
structure defined in subclause 4.4.1 of TS 29.501 [22], i.e.:
_{apiRoot}_ /_{apiName}_ /_{apiVersion}_ /_{apiSpecificResourceUriPart}_
with the following components:
\- _{apiRoot}_ shall be set as described in TS 29.501 [22].
\- _{apiName}_ shall be set as defined by the following clauses.
\- _{apiVersion}_ shall be set to \"v1\".
\- _{apiSpecificResourceUriPart}_ shall be set as described in the following
clauses.
## 6.2 Usage of HTTP
### 6.2.1 HTTP protocol version
#### 6.2.1.1 5GMS AF
Implementations of the 5GMS AF shall expose both HTTP/1.1 [24] and HTTP/2 [31]
endpoints at interfaces M1 and M5, including support for the HTTP/2 starting
mechanisms specified in section 3 of RFC 7540 [31]. In both protocol versions,
TLS [29] shall be supported and HTTPS interactions should be used on these
interfaces in preference to cleartext HTTP.
The 5GMS Application Provider may use any supported HTTP protocol version at
interface M1.
The Media Session Handler may use any supported HTTP protocol version at
interface M5.
All responses from the 5GMS AF that carry a message body shall include a
strong entity tag in the form of an ETag response header and a modification
timestamp in the form of a Last-Modified response header.
All endpoints shall support the conditional HTTP requests If-None-Match and
If-Modified-Since.
#### 6.2.1.2 5GMS AS
Implementations of the 5GMS AS shall expose HTTP/1.1 [24] endpoints at
interfaces M2 and M4 and may additionally expose HTTP/2 [31] endpoints at
these interfaces. In both protocol versions, TLS [30] shall be supported and
HTTPS interactions should be used on these interfaces in preference to
cleartext HTTP.
For pull-based content ingest, the 5GMS Application Provider shall expose an
HTTP/1.1-based origin endpoint to the 5GMSd AS at interface M2 and may
additionally expose an HTTP/2-based origin endpoint.
For push-based content ingest, the 5GMS Application Provider may use any
supported HTTP protocol version at interface M2.
The Media Stream Handler may use any supported HTTP protocol version at
interface M4.
### 6.2.2 HTTP message bodies for API resources
The OpenAPI [23] specification of HTTP messages and their content bodies is
contained in annex C.
### 6.2.3 Usage of HTTP headers
#### 6.2.3.1 General
Standard HTTP headers shall be used in accordance with clause 5.2.2 of TS
29.500 [21] for both HTTP/1.1 and HTTP/2 messages.
#### 6.2.3.2 User Agent identification
##### 6.2.3.2.1 Media Stream Handler identification
The Media Stream Handler in the 5GMS Client shall identify itself to the 5GMS
AS at interface M4 using a User-Agent request header (see section 5.5.3 of RFC
7231 [25]) that should include the _product_ token 5GMS‌Media‌Stream‌Handler.
If this product identifier is supplied, the optional _product-version_ suffix
shall be present. This should indicate the version number of the present
document (without the leading \"V\") with which the Media Stream Handler
implementation complies and shall, at minimum, indicate the 3GPP release
number with which the implementation complies.
The Media Stream Handler may additionally supply a _comment_ element in the
User-Agent request header containing vendor-specific information.
EXAMPLE 1: 5GMSMediaStreamHandler/17.5.0 (build2634) ExoPlayerLib/2.17.1
EXAMPLE 2: 5GMSMediaStreamHandler/17
##### 6.2.3.2.2 Media Session Handler identification
The Media Session Handler in the 5GMS Client shall identify itself to the
5GMSd AF at interface M5d using a User-Agent request header (see section 5.5.3
of RFC 7231 [25]) in which the first element shall be a _product_ identified
by the token 5GMSMediaSessionHandler. The optional _product-version_ suffix
shall be present. This should indicate the version number of the present
document (without the leading \"V\") with which the Media Session Handler
implementation complies and shall, at minimum, indicate the 3GPP release
number with which the implementation complies.
The Media Session Handler may supply additional vendor-specific product
identifiers in the User-Agent request header and may additionally supply a
_comment_ element containing vendor-specific information.
EXAMPLE 1: 5GMSMediaSessionHandler/17.5.0 (build1536) lib5gmsclient/0.3.1
EXAMPLE 2: 5GMSMediaSessionHandler/17
#### 6.2.3.3 Server identification
##### 6.2.3.3.1 5GMS AF identification
The 5GMS AF shall identify itself at reference points M1 and M5 using a Server
response header (see section 7.4.2 of RFC 7231 [25]) that includes a product
string of the following form:
5GMSAF-_{FQDN}_ /_{complianceInformation}_
where _{FQDN}_ shall be the Fully-Qualified Domain Name of the 5GMSd AF
exposed to the requesting client, and _{complianceInformation}_ should
indicate the version number of the present document (without the leading
\"V\") with which the 5GMS AF implementation complies and shall, at minimum,
indicate the 3GPP release number with which the implementation complies.
The Server response header may also include comments strings and vendor-
specific subproduct strings compliant with the syntax and guidance provided in
section 7.4.2 of [25].
EXAMPLE 1: 5GMSAF-vm10664.mno.net/16.9.0 (api=1.1.0) libsbi/2.1 libnf/1.2
libaf/1.1
EXAMPLE 2: 5GMSAF-vm10664.mno.net/16 (api=1.1.0) libsbi/2.1 libnf/1.2
libaf/1.1
#### 6.2.3.4 Support for conditional HTTP GET requests
All responses from the 5GMS AF that carry a resource message body shall
include:
\- a strong entity tag for the resource, conveyed in an ETag response header,
\- a resource modification timestamp, conveyed in a Last-Modified response
header, and
\- a predicted time-to-live period for the resource, conveyed in a Cache-
Control: max-age response header.
All API endpoints on the 5GMS AF that expose the HTTP GET method shall support
conditional requests using the If-None-Match and If-Modified-Since request
headers. API clients should not attempt to revalidate their cached copy of a
resource using a conditional GET request before the indicated time-to-live
period has elapsed.
#### 6.2.3.5 Support for conditional HTTP POST, PUT, PATCH and DELETE requests
All API endpoints on the 5GMS AF that expose the HTTP POST, PUT, PATCH or
DELETE methods shall support conditional requests using the If-Match request
header. The API client should supply a strong entity tag in an ETag request
header when invoking any of these HTTP methods.
## 6.3 HTTP response codes
Guidelines for error responses to the invocation of APIs of NF services are
specified in clause 4.8 of TS 29.501 [22]. API-specific error responses are
specified in the respective technical specifications.
## 6.4 Common API data types
### 6.4.1 General
The data types defined in this clause are intended to be used by more than one
of the 5GMS APIs.
### 6.4.2 Simple data types
Table 6.4.2-1 below specifies common simple data types used within the 5GMS
APIs, including a short description of each. In cases where types from other
specifications are reused, a reference is provided.
Table 6.4.2-1: Simple data types
* * *
Type name Type definition Description Reference _ResourceId_ string String
chosen by the 5GMS AF to serve as an identifier in a resource URL.  
_Uri_ string Uniform Resource Identifier conforming with the URI Generic
Syntax. TS 29.571 [12] table 5.2.2‑1 _Url_ string Uniform Resource Locator,
conforming with the URI Generic Syntax. IETF RFC 3986 [41] _Percentage_ number
A percentage expressed as a floating point value between 0.0 and 100.0
(inclusive).  
_DurationSec_ integer An unsigned integer identifying a period of time
expressed in units of seconds. TS 29.571 [12] table 5.2.2‑1 _DateTime_ string
An absolute date and time expressed using the OpenAPI _date-time_ string
format. TS 29.571 [12] table 5.2.2‑1
* * *
### 6.4.3 Structured data types
#### 6.4.3.1 IpPacketFilterSet type
Table 6.4.3.1-1: Definition of type IpPacketFilterSet
Property name Data type Cardinality Usage Description
* * *
_srcIp_ String 0..1 Source IP address or IPv6 prefix. _dstIp_ String 0..1
Destination IP address or IPv6 prefix. _protocol_ Integer 0..1 Protocol.
_srcPort_ Integer 0..1 Source port. _dstPort_ Integer 0..1 Destination Port.
_toSTc_ String 0..1 Type of Service (TOS) (IPv4) / Traffic class (IPv6) and
Mask. _flowLabel_ Integer 0..1 Flow Label (IPv6). _spi_ Integer 0..1 Security
Parameter Index. _direction_ String 1..1 Packet Filter Set Direction.
#### 6.4.3.2 ServiceDataFlowDescription type
Table 6.4.3.2-1: Definition of type ServiceDataFlowDescription
Property name Data type Cardinality Usage Description
* * *
_flowDescription_ IpPacketFilterSet 0..1 Service Data Flow Description.
_domainName_ string 0..1 FQDN of the 5GMS AS. NOTE: Exactly one property shall
be populated in objects of this type.
#### 6.4.3.3 M5QoSSpecification type
Table 6.4.3.2-1: Definition of type M5QoSSpecification
Property name Data type Cardinality Usage Description
* * *
_marBwDlBitRate_ BitRate 1..1 Maximum requested bit rate for the Downlink.
_marBwUlBitRate_ BitRate 1..1 Maximum requested bit rate for the Uplink.
_minDesBwDlBitRate_ BitRate 0..1 Minimum desired bit rate for the Downlink.
_minDesBwUlBitRate_ BitRate 0..1 Minimum desired bit rate for the Uplink.
_mirBwDlBitRate_ BitRate 1..1 Minimum requested bit rate for the Downlink.
_mirBwUlBitRate_ BitRate 1..1 Minimum requested bandwidth for the Uplink.
_desLatency_ Integer 0..1 Desire Latency. _desLoss_ Integer 0..1 Desired Loss
Rate.
#### 6.4.3.4 M1QoSSpecification type
Table 6.4.3.2-1: Definition of type M1QoSSpecification
Property name Data type Cardinality Usage Description
* * *
_qosReference_ String 0..1 As defined in clause 5.6.2.7 of TS 29.514 [34].
_maxBtrUl_ BitRate 0..1 RO Maximum Bitrate Uplink. _maxBtrDl_ BitRate 0..1 RO
Maximum Bitrate Downlink. _maxAuthBtrUl_ BitRate 0..1 RW Maximum Authorized
Bitrate Uplink by 5GMS Application Provider. _maxAuthBtrDl_ BitRate 0..1 RW
Maximum Authorized Bitrate Downlink by 5GMS Application Provider.
_defPacketLossRateDl_ Integer 0..1 Default packet loss rate for Downlink.
_defPacketLossRateUl_ Integer 0..1 Default packet loss rate for Uplink.
#### 6.4.3.5 ChargingSpecification type
Table 6.5.3.2-1: Definition of type ChargingSpecification
Property name Data type Cardinality Usage Description
* * *
_sponId_ SponId 0..1 As defined in clause 5.6.2.3 of TS 29.514 [34].
_sponStatus_ SponsoringStatus 0..1  
_gpsi_ Array(Gpsi) 0..1 List of UEs permitted to instantiate this Policy
Template.
#### 6.4.3.6 TypedLocation type
Table 6.4.3.6-1: Definition of TypedLocation type
Property name Data type Cardinality Description
* * *
_locationIdentifierType_ CellIdentifierType 1..1 The type of cell location
present in the _location_ property. _location_ string 1..1 Identifies the cell
location.
#### 6.4.3.7 Operation Success Response type
The data model for the _OperationSuccessResponse_ type is specified in table
6.4.3.7-1 below:
Table 6.4.3.7-1: Definition of OperationSuccessResponse type
Property name Type Cardinality Description
* * *
_success_ Boolean 1..1 Indicates whether an operation was successful (_TRUE_)
or not (_FALSE_). _reason_ String 0..1 Optional explanation of the success or
otherwise of the operation.
### 6.4.4 Enumerated data types
#### 6.4.4.1 CellIdentifierType enumeration
The data model for the _CellIdentifierType_ enumeration which indicates the
type of cell identifier as defined in TS 23.003 [7], is specified in Table
6.4.4.1-1 below:
Table 6.4.4.1‑1: Definition of CellIdentifierType enumeration
Enumeration value Description
* * *
_CGI_ Cell Global Identification. _ECGI_ E-UTRAN Cell Global Identification.
_NCGI_ NR Cell Global Identity.
#### 6.4.4.2 SdfMethod enumeration
The data model for the _SdfMethod_ enumeration is specified in table 6.4.4.2-1
below:
Table 6.4.4.2‑1: Definition of SdfMethod enumeration
Enumeration value Description
* * *
_5_TUPLE_ The Media Session Handler shall use 5-Tuples for Service Data Flow
descriptions. The 5‑Tuple shall not contain a wildcard. _2_TUPLE_ The Media
Session Handler shall use a 2-Tuple of UE IP and Server IP as Service Data
Flow Description. _TYPE_OF_SERVICE_MARKING_ The Media Session Handler shall
apply Type of Service (ToS) marking to the Service Data Flow. _FLOW_LABEL_ The
Media Session Handler shall apply IPv6 flow label marking and provide the IPv6
flow label of the Service Data Flow. _DOMAIN_NAME_ The Media Session Handler
shall provide the domain name of the 5GMSd AS.
#### 6.4.4.3 ProvisioningSessionType enumeration
The data model for the _ProvisioningSessionType_ enumeration is specified in
Table 6.4.4.3-1 below:
Table 6.4.4.3‑1: Definition of ProvisioningSessionType enumeration
Enumeration value Description
* * *
_DOWNLINK_ Downlink media streaming _UPLINK_ Uplink media streaming
## 6.5 Explanation of API data model notation
The data models in the following API clauses are specified using the following
notational conventions:
1\. Data models are expressed as an unordered list of JSON properties [38]
with one property defined in each row of the data model table.
2\. The _Data type_ column defines the type of the property, according to JSON
notation [38].
3\. The keyword \"Array\" in the _Data type_ column indicates that zero or
more elements of the data type in brackets are included. The number of
elements in the array may additionally be constrained by normative text in the
_Description_ column.
4\. The _Cardinality_ column defines whether a property is optional or
mandatory. An array with cardinality 0 indicates that the array property is
optional in the data structure. An array with cardinality 1 indicates that the
property is mandatory in the data structure, even when the array is empty.
5\. The keyword \"Object\" in the _Data type_ column indicates a structured
sub-object of an unnamed type whose properties are defined inline in the
indented table rows immediately afterwards. The \"Object\" type may be
combined with the \"Array\" type.
6\. In the case of data types specifying RESTful resources, the additional
_Usage_ column defines the property behaviour for each CRUD Operation as
follows:
\- \"C\" (Create), \"R\" (Read) and \"U\" (Update) refers to the CRUD
procedure during which the property is present in the resource type. (The
Delete operation never takes any input data type.)
\- \"RO\" signifies a read-only property. Only the API provider function is
permitted to modify the property value. The API invoker can only read the
value.
\- \"RW\" signifies a read/write property. The API provider and API invoker
may both modify the property value.
7\. An additional read-only property is included at the start of all data
models defining resources that are members of a RESTful collection. This
property is populated with the unique identifier of the resource within its
parent collection, and corresponds to the leaf path element in the RESTful URL
of that resource.
# 7 Provisioning (M1) APIs
## 7.1 General
This clause defines the provisioning API used by a 5GMS Application Provider
to configure downlink or uplink 5G Media Streaming services.
## 7.2 Provisioning Sessions API
### 7.2.1 Overview
The Provisioning Sessions API is used by the 5GMS Application Provider to
instantiate and manipulate Provisioning Sessions in the 5GMS System, as
described in clause 4.3.2. Having created a Provisioning Session, the 5GMS
Application Provider can then go on to provision other 5GMS features in the
context of that Provisioning Session, using the APIs specified in clause 7.3
_et seq_. Certain of these features are only applicable to the type of
Provisioning Session created.
### 7.2.2 Resource structure
The Provisioning Sessions API is accessible through the following URL base
path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/
Table 7.4.2‑1 specifies the operations and the corresponding HTTP methods that
are supported by this API. In each case, the sub-resource path specified in
the second column of the table shall be appended to the above URL base path.
Table 7.2.2‑1: Operations supported by the Provisioning Sessions API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create | | POST | Used to create | | Provisioning | | | a new | | Session | | | Provisioning | | | | | Session | | | | | resource. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created | | | | | Provisioning | | | | | Session | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response. | +----------------+----------------+----------------+----------------+ | Retrieve | _{provision | GET | Used to | | Provisioning | ingSessionId}_ | | retrieve a | | Session | | | Provisioning | | | | | Session | | | | | resource for | | | | | inspection. | +----------------+----------------+----------------+----------------+ | Destroy | | DELETE | Used to | | Provisioning | | | destroy an | | Session | | | existing | | | | | Provisioning | | | | | Session | | | | | resource. | +----------------+----------------+----------------+----------------+
### 7.2.3 Data model
#### 7.2.3.1 ProvisioningSession resource
The data model for the _ProvisioningSession_ resource is specified in Table
7.2.3.1-1 below. Different properties are present in the resource depending on
the type of Provisioning Session indicated in the _provisioningSessionType_
property, and this is specified in the _Applicability_ column.
Table 7.2.3.1‑1: Definition of ProvisioningSession resource
+----------+----------+----------+--------+----------+----------+ | Property | Type | Car | Usage | Des | Appli | | name | | dinality | | cription | cability | +==========+==========+==========+========+==========+==========+ | > | Re | 1..1 | C: R | A unique | All | | _provis | sourceId | | | id | types. | | ioningSe | | | R: RO | entifier | | | ssionId_ | | | | for this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+ | > _p | P | 1..1 | C: RW\ | The type | All | | rovision | rovision | | R: RO | of | types. | | ingSessi | ing‌Sess | | | Prov | | | on‌Type_ | ion‌Type | | U: -- | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+ | > | AspId | 0..1 | C: W | The | All | | _aspId_ | | | | identity | types. | | | | | R: RO | of the | | | | | | | App | | | | | | | lication | | | | | | | Service | | | | | | | Provider | | | | | | | res | | | | | | | ponsible | | | | | | | for this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session, | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | clause | | | | | | | 5.6.2.3 | | | | | | | of | | | | | | | T | | | | | | | S 29.514 | | | | | | | [34]. | | +----------+----------+----------+--------+----------+----------+ | > _serve | A | 0..1 | C: -- | A list |_ d | | rCertifi | rray(Res | | | of | ownlink _| | cateIds_ | ourceId) | | R: RO | Server | | | | | | | Cer | | | | | | | tificate | | | | | | | ide | | | | | | | ntifiers | | | | | | | c | | | | | | | urrently | | | | | | | as | | | | | | | sociated | | | | | | | with | | | | | | | this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+ | > | A | 0..1 | C: -- | A list | _do | |_ content | rray(Res | | | of | wnlink,_| | Preparat | ourceId) | | R: RO | Content | | | ion‌Temp | | | | Pre |_ uplink _| | lateIds_ | | | | paration | | | | | | | Template | | | | | | | ide | | | | | | | ntifiers | | | | | | | c | | | | | | | urrently | | | | | | | as | | | | | | | sociated | | | | | | | with | | | | | | | this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+ | > _me | A | 0..1 | C: -- | A list |_ do | | tricsRep | rray(Res | | | of | wnlink _, | | orting‌C | ourceId) | | R: RO | Metrics | | | onfigura | | | | R |_ uplink _| | tionIds_ | | | | eporting | | | | | | | Confi | | | | | | | guration | | | | | | | ide | | | | | | | ntifiers | | | | | | | c | | | | | | | urrently | | | | | | | as | | | | | | | sociated | | | | | | | with | | | | | | | this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+ | > _po | A | 0..1 | C: -- | A list |_ do | | licyTemp | rray(Res | | | of | wnlink _, | | lateIds_ | ourceId) | | R: RO | Policy | | | | | | | Template | _uplink_ | | | | | | ide | | | | | | | ntifiers | | | | | | | c | | | | | | | urrently | | | | | | | as | | | | | | | sociated | | | | | | | with | | | | | | | this | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+--------+----------+----------+
## 7.3 Server Certificates Provisioning API
### 7.3.1 Overview
The Server Certificates Provisioning API is used to provision X.509 [8] server
certificates that can be referenced by a Content Hosting Configuration and
subsequently presented by the 5GMSd AS when it distributes content to 5GMSd
Clients at interface M4d using Transport Layer Security [30]. Server
Certificate resources are provisioned within the scope of an enclosing
Provisioning Session.
### 7.3.2 Resource structure
The Server Certificates Provisioning API is accessible through the following
URL base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.3.2‑1 specifies the operations and the corresponding HTTP methods that
are supported by this API. In each case, the Provisioning Session identifier
shall be substituted into _{provisioningSessionId}_ in the above URL template
and the sub-resource path specified in the second column shall be appended to
the URL base path.
Table 7.3.2‑1: Operations supported by the Server Certificates Provisioning
API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Server | certificates | POST | Invoked on the | | Certificate | | | Server | | | | | Certificates | | | | | collection | | | | | associated | | | | | with a | | | | | Provisioning | | | | | Session to | | | | | request that | | | | | the 5GMS | | | | | System creates | | | | | a new Server | | | | | Certificate on | | | | | behalf of the | | | | | 5GMSd | | | | | Application | | | | | Provider. | | | | | | | | | | The request | | | | | message body | | | | | shall be | | | | | empty. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created Server | | | | | Certificate | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response and | | | | | this shall | | | | | comply with | | | | | the | | | | | sub-resource | | | | | path specified | | | | | below for | | | | | manipulating | | | | | Server | | | | | Certificate | | | | | resources in | | | | | the | | | | | collection. | | | | | | | | | | The body of | | | | | the response | | | | | message may | | | | | include a copy | | | | | of the created | | | | | X.509 | | | | | certificate, | | | | | as specified | | | | | in | | | | | clause 7.3.3.2 | | | | | below. | +----------------+----------------+----------------+----------------+ | Reserve Server | ce | POST | Invoked on the | | Certificate | rtificates?csr | | Server | | | | | Certificates | | | | | collection | | | | | associated | | | | | with a | | | | | Provisioning | | | | | Session to | | | | | solicit a | | | | | Certificate | | | | | Signing | | | | | Request for a | | | | | new Server | | | | | Certificate. | | | | | | | | | | The request | | | | | message body | | | | | shall be a | | | | | JSON array of | | | | | domain name | | | | | aliases or (if | | | | | no domain name | | | | | aliases are | | | | | required) | | | | | empty. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | reserved | | | | | Server | | | | | Certificate | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response and | | | | | this shall | | | | | comply with | | | | | the | | | | | sub-resource | | | | | path specified | | | | | below for | | | | | manipulating | | | | | Server | | | | | Certificate | | | | | resources in | | | | | the | | | | | collection. | | | | | | | | | | The body of | | | | | the response | | | | | shall be a | | | | | PEM-encoded | | | | | X.509 | | | | | Certificate | | | | | Signing | | | | | Request, as | | | | | specified in | | | | | clause 7.3.3.1 | | | | | below. | +----------------+----------------+----------------+----------------+ | Retrieve | ce | GET | Used to | | Server | rtificates/_{c | | retrieve a | | Certificate | ertificateId}_ | | previously | | | | | created or | | | | | uploaded | | | | | Server | | | | | Certificate. | | | | | | | | | | If a Server | | | | | Certificate | | | | | resource has | | | | | been reserved | | | | | but not yet | | | | | uploaded, this | | | | | operation | | | | | shall return | | | | | _204 (No | | | | | Content)_. | +----------------+----------------+----------------+----------------+ | Upload Server | | PUT | Used by the | | Certificate | | | 5GMSd | | | | | Application | | | | | Provider to | | | | | supply a new | | | | | Server | | | | | Certificate in | | | | | response to a | | | | | solicited | | | | | Certificate | | | | | Signing | | | | | Request. | | | | | | | | | | The body of | | | | | the request | | | | | message shall | | | | | be a | | | | | PEM-encoded | | | | | X.509 | | | | | certificate | | | | | signed with | | | | | the public key | | | | | of the | | | | | Certificate | | | | | Signing | | | | | Request, as | | | | | specified in | | | | | clause 7.3.3 | | | | | below. | | | | | | | | | | The 5GMSd AF | | | | | shall | | | | | associate the | | | | | Server | | | | | Certificate | | | | | with the | | | | | private key it | | | | | generated | | | | | alongside the | | | | | Certificate | | | | | Signing | | | | | Request. | | | | | | | | | | Attempting to | | | | | update a | | | | | previously | | | | | uploaded | | | | | Server | | | | | Certificate is | | | | | an error. | +----------------+----------------+----------------+----------------+ | Destroy Server | | DELETE | Removes the | | Certificate | | | specified | | | | | Server | | | | | Certificate | | | | | from the set | | | | | of | | | | | certificates | | | | | associated | | | | | with the | | | | | Provisioning | | | | | Session. | +----------------+----------------+----------------+----------------+ | NOTE: The | | | | | Server | | | | | Certificate | | | | | resource | | | | | identifier | | | | | _{c | | | | | ertificateId}_ | | | | | differs from | | | | | the serial | | | | | number of the | | | | | X.509 | | | | | certificate. | | | | +----------------+----------------+----------------+----------------+
### 7.3.3 Data model
#### 7.3.3.1 Certificate Signing Request
The Certificate Signing Request shall comply with the Privacy-Enhanced Mail
(PEM) textual format specified in RFC 7468 [17], i.e. a Base64-encoded DER
certificate request or certificate, including leading and trailing
encapsulation boundary lines.
The MIME content type shall be _application/x-pem-file_.
#### 7.3.3.2 Server Certificate resource
The Server Certificate resource shall comply with the Privacy-Enhanced Mail
(PEM) textual format specified in RFC 7468 [17], i.e. a Base64-encoded DER
certificate request or certificate, including leading and trailing
encapsulation boundary lines. The resource shall include only the public parts
of the X.509 certificate. In particular, the private key shall not be
included.
The MIME content type shall be _application/x-pem-file_.
### 7.3.4 Operations
Under no circumstances shall the 5GMSd AF reveal the private key associated
with the Certificate Signing Request to the 5GMSd Application Provider.
## 7.4 Content Preparation Templates Provisioning API
### 7.4.1 Overview
Content Preparation Templates are used to specify manipulations applied by a
5GMS AS to downlink media resources ingested at interface M2d for distribution
at interface M4d, or to uplink media resources contributed at interface M4u
for egest at interface M2u. The Content Preparation Templates Provisioning API
is used to provision a Content Preparation Template within the scope of a
Provisioning Session that can subsequently be referenced from a Content
Hosting Configuration.
### 7.4.2 Resource structure
The Content Preparation Templates Provisioning API is accessible through the
following URL base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.4.2‑1 specifies the operations and the corresponding HTTP methods that
are supported by this API. In each case, the Provisioning Session identifier
shall be substituted into _{provisioningSessionId}_ in the above URL template
and the sub-resource path specified in the second column shall be appended to
the URL base path.
Table 7.4.2‑1: Operations supported by the Content Preparation Templates
Provisioning API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Content | c | POST | Invoked on a | | Preparation | ontent-prepara | | Content | | Template | tion-templates | | Preparation | | | | | Templates | | | | | collection | | | | | when supplying | | | | | a new Content | | | | | Preparation | | | | | Template | | | | | resource. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | newly created | | | | | Content | | | | | Preparation | | | | | Template | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response and | | | | | this shall | | | | | comply with | | | | | the | | | | | sub-resource | | | | | path specified | | | | | below for | | | | | manipulating | | | | | Content | | | | | Preparation | | | | | Templates. | +----------------+----------------+----------------+----------------+ | Retrieve | content | GET | Used to | | Content | ‑preparation‑t | | retrieve a | | Preparation | emplates/‌ _{co | | Content | | Template | ntentPreparati | | Preparation | | | onTemplateId}_ | | Template | | | | | resource. | +----------------+----------------+----------------+----------------+ | Update Content | | PUT, | Used to modify | | Preparation | | | an existing | | Template | | PATCH | Content | | | | | Preparation | | | | | Template | | | | | resource. | +----------------+----------------+----------------+----------------+ | Destroy | | DELETE | Used to | | Content | | | destroy an | | Preparation | | | existing | | Template | | | Content | | | | | Preparation | | | | | Template | | | | | resource. | +----------------+----------------+----------------+----------------+
### 7.4.3 Data model
The data model of the Content Preparation Template resource shall be
determined by its MIME content type.
### 7.4.4 Operations
The operations shall be determined by the MIME content type of the Content
Preparation Template resource.
## 7.5 Content Protocols Discovery API
### 7.5.1 Overview
The Content Protocols Discovery API is used by a 5GMS Application Provider to
find out which content ingest or egest protocols are supported by the 5GMS AS
instance(s) associated with a 5GMS AF. One of the supported ingest protocols
is subsequently indicated in a Content Hosting Configuration for downlink
media streaming.
### 7.5.2 Resource structure
The Content Protocols Discovery API is accessible through the following URL
base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.5.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the Provisioning Session
identifier shall be substituted into _{provisioningSessionId}_ in the above
URL template and the sub-resource path specified in the second column of the
table shall be appended to the URL base path.
Table 7.5.2‑1: Operations supported by the Ingest Protocols Discovery API
Operation Sub‑resource path Allowed HTTP method(s) Description
* * *
Fetch list of supported content protocols _protocols_ GET This operation is
used to retrieve a list of supported content protocols.
### 7.5.3 Data model
#### 7.5.3.1 ContentProtocols resource
The data model for the _ContentProtocols_ resource is specified in Table
7.5.3.1-1 below:
Table 7.5.3.1-1: Definition of ContentProtocols resource
+-----------------+-----------------+-------------+-----------------+ | Property name | Data Type | Cardinality | Description | +=================+=================+=============+=================+ | _downlinkI | Arra | 0..1 | An array of | | ngestProtocols_ | y(Content‌Proto | | _ContentProt | | | col‌Descriptor) | | ocolDescriptor_ | | | | | objects, as | | | | | specified in | | | | | clause 7.5.3.2, | | | | | each one | | | | | uniquely | | | | | identifying a | | | | | content ingest | | | | | protocol | | | | | supported at | | | | | interface M2d | | | | | by the | | | | | 5GMSd AS(s) | | | | | associated with | | | | | the | | | | | corresponding | | | | | 5GMSd AF. | +-----------------+-----------------+-------------+-----------------+ | _uplink | Arra | 0..1 | An array of | | EgestProtocols_ | y(Content‌Proto | | _ContentProt | | | col‌Descriptor) | | ocolDescriptor_ | | | | | objects, as | | | | | specified in | | | | | clause 7.5.3.2, | | | | | each one | | | | | uniquely | | | | | identifying a | | | | | content egest | | | | | protocol | | | | | supported at | | | | | interface M2u | | | | | by the | | | | | 5GMSu AS(s) | | | | | associated with | | | | | the | | | | | corresponding | | | | | 5GMSu AF. | +-----------------+-----------------+-------------+-----------------+ | _geoFenci | Array(Uri) | 0..1 | An array of | | ngLocatorTypes_ | | | fully-qualified | | | | | term | | | | | identifiers, | | | | | each one | | | | | indicating a | | | | | content | | | | | geo-fencing | | | | | locator type | | | | | supported by | | | | | the 5GMS | | | | | System. | | | | | | | | | | Every 5GMS | | | | | System shall | | | | | support at | | | | | least the | | | | | locator type | | | | | _urn:3 | | | | | gpp:5gms:locato | | | | | rtype:iso3166_. | +-----------------+-----------------+-------------+-----------------+
#### 7.5.3.2 ContentProtocolDescriptor type
The data model for the _ContentProtocolDescriptor_ type is specified in table
7.5.3.2-1 below:
Table 7.5.3.2-1: Definition of ContentProtocolDescriptor type
Property name Data Type Cardinality Description
* * *
_termIdentifier_ Uri 1..1 A fully-qualified term identifier from the
controlled vocabulary _urn:3gpp:5gms:content-protocol_ , as specified in
clause 8. _descriptionLocator_ Url 0..1 The location of a description of the
content protocol, for example the public web URL of its specification.
## 7.6 Content Hosting Provisioning API
### 7.6.1 Overview
This clause specifies the API that a 5GMSd Application Provider uses at
interface M1d to provision and manage 5GMSd AS Content Hosting Configurations
by interacting with a 5GMSd AF. Each such configuration is represented by a
_ContentHostingConfiguration_ , the data model for which is specified in
clause 7.6.3 below. The RESTful resources for managing Content Hosting
Configurations are specified in clause 7.6.2 and the operations on these
resources are further elaborated in clause 7.6.4.
### 7.6.2 Resource structure
The Content Hosting Provisioning API is accessible through this URL base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.6.2-1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the Provisioning Session
identifier shall be substituted into _{provisioningSessionId}_ in the above
URL template and the sub-resource path specified in the second column shall be
appended to the URL base path.
Table 7.6.2‑1: Operations supported by the Content Hosting Provisioning API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Content | c | POST | Used to create | | Hosting | ontent-hosting | | a Content | | Configuration | -configuration | | Hosting | | | | | Configuration | | | | | resource. | +----------------+----------------+----------------+----------------+ | Retrieve | | GET | Used to | | Content | | | retrieve an | | Hosting | | | existing | | Configuration | | | Content | | | | | Hosting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Update Content | | PUT, | Used to modify | | Hosting | | | an existing | | Configuration | | PATCH | Content | | | | | Hosting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Delete Content | | DELETE | Used to delete | | Hosting | | | an existing | | Configuration | | | Content | | | | | Hosting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Purge Content | content | POST | This operation | | Hosting | -hosting-confi | | is used to | | Configuration | guration/purge | | invalidate | | cache | | | some or all | | | | | cached media | | | | | resources | | | | | associated | | | | | with this | | | | | Content | | | | | Hosting | | | | | Configuration. | +----------------+----------------+----------------+----------------+
### 7.6.3 Data model
#### 7.6.3.1 ContentHostingConfiguration resource
The data model for the _ContentHostingConfiguration_ resource is specified in
table 7.6.3.1-1 below:
Table 7.6.3.1-1: Definition of ContentHostingConfiguration resource
+-----------------+-----------------+-------------+-----------------+ | Property name | Data Type | Cardinality | Description | +=================+=================+=============+=================+ | _name_ | String | 1..1 | A name for this | | | | | Content Hosting | | | | | Configuration. | +-----------------+-----------------+-------------+-----------------+ | * | RelativeUrl | 0..1 | An entry point | | entryPointPath _| | | for a single | | | | | content item | | | | | expressed as a | | | | | relative path | | | | | (i.e. without a | | | | | scheme or any | | | | | leading forward | | | | | slash | | | | | characters). | | | | | The semantics | | | | | of the entry | | | | | point are | | | | | dependent on | | | | | the value of | | | | | * | | | | | ingestConfigura | | | | | tion.protocol_ , | | | | | as specified in | | | | | clause 8. | | | | | | | | | | If provided, | | | | | the path shall | | | | | be valid at | | | | | reference point | | | | | M2d when | | | | | appended to the | | | | | ingest base URL | | | | | and at | | | | | reference point | | | | | M4d when | | | | | appended to all | | | | | distribution | | | | | base URLs. | +-----------------+-----------------+-------------+-----------------+ | _inges | Object | 1..1 | Describes the | | tConfiguration_ | | | 5GMSd | | | | | Application | | | | | Provider\'s | | | | | origin server | | | | | from which | | | | | media resources | | | | | will be | | | | | ingested via | | | | | interface M2d. | +-----------------+-----------------+-------------+-----------------+ | _pull_ | Boolean | 1..1 | Indicates | | | | | whether to the | | | | | 5GMSd AS shall | | | | | use Pull or | | | | | Push for | | | | | ingesting the | | | | | content. | +-----------------+-----------------+-------------+-----------------+ | _protocol_ | Uri | 1..1 | A | | | | | fully-qualified | | | | | term identifier | | | | | allocated in | | | | | the name space | | | | | _u | | | | | rn:3gpp:5gms:co | | | | | ntent-protocol_ | | | | | that identifies | | | | | the content | | | | | ingest | | | | | protocol. | | | | | | | | | | The set of | | | | | supported | | | | | protocols is | | | | | defined in | | | | | clause 8. | +-----------------+-----------------+-------------+-----------------+ | _baseURL_ | AbsoluteUrl | 0..1 | A base URL | | | | | (i.e. one that | | | | | includes a | | | | | scheme, | | | | | authority and, | | | | | optionally, | | | | | path segments) | | | | | from which | | | | | content is | | | | | ingested at | | | | | reference point | | | | | M2d for this | | | | | ingest | | | | | configuration. | | | | | | | | | | In the case of | | | | | Pull-based | | | | | content ingest | | | | | (_pull_ flag is | | | | | set to _True_), | | | | | the base URL | | | | | shall be | | | | | provided to the | | | | | 5GMSd AF to | | | | | indicate the | | | | | location from | | | | | which content | | | | | is to be pulled | | | | | for this | | | | | Content Hosting | | | | | Configuration. | | | | | A request | | | | | received at | | | | | reference point | | | | | M4d is mapped | | | | | by the 5GMSd AS | | | | | to a URL at | | | | | reference point | | | | | M2d whose base | | | | | is the value of | | | | | this property. | | | | | | | | | | In the case of | | | | | Push-based | | | | | content ingest | | | | | (_pull_ flag is | | | | | set to False), | | | | | this property | | | | | is populated by | | | | | the 5GMSd AF | | | | | and returned to | | | | | the 5GMSd | | | | | Application | | | | | Provider to | | | | | indicate the | | | | | base URL to | | | | | which content | | | | | for this | | | | | Content Hosting | | | | | Configuration | | | | | is to be | | | | | published. | +-----------------+-----------------+-------------+-----------------+ | _distribution | Array(Object) | 1..1 | Specifies the | | Configurations_ | | | distribution | | | | | method and | | | | | configuration | | | | | for the | | | | | ingested | | | | | content. | | | | | | | | | | More than one | | | | | distribution | | | | | may be | | | | | configured for | | | | | the ingested | | | | | content, e.g. | | | | | to offer | | | | | different | | | | | distribution | | | | | configurations | | | | | such as DASH | | | | | and HLS. | +-----------------+-----------------+-------------+-----------------+ | _contentPrepara | ResourceId | 0..1 | Indicates that | | tionTemplateId_ | | | content | | | | | preparation | | | | | prior to | | | | | distribution is | | | | | requested by | | | | | the 5GMSd | | | | | Application | | | | | Provider. It | | | | | identifies the | | | | | Content | | | | | Preparation | | | | | Template that | | | | | shall be used | | | | | as defined in | | | | | clause 7.4. | +-----------------+-----------------+-------------+-----------------+ | _supple | Arr | 0..1 | Specifies that | | mentary‌Distrib | ay(\  | | configuration | | | | | is to be | | | | | distributed via | | | | | one of more | | | | | supplementary | | | | | networks. Each | | | | | member of the | | | | | array is a | | | | | duple mapping a | | | | | type of | | | | | distribution | | | | | network to a | | | | | mode of | | | | | distribution. | | | | | | | | | | The same | | | | | _Distribut | | | | | ionNetworkType_ | | | | | value shall | | | | | appear at most | | | | | once in the | | | | | array. | +-----------------+-----------------+-------------+-----------------+ | _canon | String | 0..1 | All resources | | icalDomainName_ | | | of the current | | | | | distribution | | | | | shall be | | | | | accessible | | | | | through this | | | | | _default_ Fully | | | | | Qualified | | | | | Domain Name | | | | | assigned by the | | | | | 5GMSd AF. | +-----------------+-----------------+-------------+-----------------+ | _d | String | 0..1 | The 5GMSd | | omainNameAlias_ | | | Application | | | | | Provider may | | | | | assign another | | | | | Fully-Qualified | | | | | Domain Name | | | | | through which | | | | | media resources | | | | | are | | | | | additionally | | | | | accessible at | | | | | M4d. | | | | | | | | | | This domain | | | | | name is used by | | | | | the 5GMSd AS to | | | | | select an | | | | | appropriate | | | | | Server | | | | | Certificate to | | | | | present at M4d, | | | | | and to set | | | | | appropriate | | | | | CORS HTTP | | | | | response | | | | | headers at M4d. | | | | | | | | | | If this | | | | | property is | | | | | present, the | | | | | 5GMSd | | | | | Application | | | | | Provider is | | | | | responsible for | | | | | providing in | | | | | the DNS a CNAME | | | | | record that | | | | | resolves | | | | | _d | | | | | omainNameAlias_ | | | | | to | | | | | _canoni | | | | | calDomainName_. | +-----------------+-----------------+-------------+-----------------+ | _baseURL_ | AbsoluteUrl | 0..1 | A base URL | | | | | (i.e. one that | | | | | includes a | | | | | scheme, | | | | | authority and, | | | | | optionally, | | | | | path segments) | | | | | from which | | | | | content is made | | | | | available to | | | | | 5GMS Clients at | | | | | reference point | | | | | M4d for this | | | | | distribution | | | | | configuration. | | | | | | | | | | The value is | | | | | chosen by the | | | | | 5GMSd AF when | | | | | the Content | | | | | Hosting | | | | | Configuration | | | | | is provisioned. | | | | | It is an error | | | | | for the 5GMSd | | | | | Application | | | | | Provider to set | | | | | this. | +-----------------+-----------------+-------------+-----------------+ | _pa | Array(Object) | 0..1 | An ordered list | | thRewriteRules_ | | | of rules for | | | | | rewriting the | | | | | request URL | | | | | paths of media | | | | | resource | | | | | requests | | | | | handled by the | | | | | 5GMSd AS. | | | | | | | | | | If multiple | | | | | rules match a | | | | | particular | | | | | resource\'s | | | | | path, only the | | | | | first matching | | | | | rule, in order | | | | | of appearance | | | | | in this array, | | | | | shall be | | | | | applied. | +-----------------+-----------------+-------------+-----------------+ | _requ | String | 1..1 | A regular | | estPathPattern_ | | | expression | | | | | [5] against | | | | | which the path | | | | | part of each | | | | | 5GMSd AS | | | | | request URL, | | | | | including the | | | | | leading \"/\", | | | | | and up to and | | | | | including the | | | | | final \"/\", | | | | | shall be | | | | | compared. (Any | | | | | leaf path | | | | | element | | | | | following the | | | | | final \"/\" | | | | | shall be | | | | | excluded from | | | | | this | | | | | comparison.) | | | | | | | | | | In the case of | | | | | Pull-based | | | | | ingest, the M4d | | | | | download | | | | | request path is | | | | | used in the | | | | | comparison. | | | | | | | | | | In the case of | | | | | Push-based | | | | | ingest, the M2d | | | | | upload request | | | | | path is used in | | | | | the comparison. | | | | | | | | | | In either case, | | | | | if the request | | | | | path matches | | | | | this pattern, | | | | | the path | | | | | mapping | | | | | specified in | | | | | the | | | | | corresponding | | | | | _mappedPath_ | | | | | shall be | | | | | applied. | +-----------------+-----------------+-------------+-----------------+ | _mappedPath_ | String | 1..1 | A replacement | | | | | for the portion | | | | | of the 5GMSd AS | | | | | request path | | | | | that matches | | | | | _reque | | | | | stPathPattern_. | | | | | | | | | | In the case of | | | | | Pull-based | | | | | ingest, | | | | | _i | | | | | ngestConfigurat | | | | | ion.entryPoint_ | | | | | is concatenated | | | | | with the mapped | | | | | path and any | | | | | leaf path | | | | | element from | | | | | the original | | | | | M4d download | | | | | request to form | | | | | the M2d origin | | | | | request URL. | | | | | | | | | | In the case of | | | | | Push-based | | | | | ingest, | | | | | _canon | | | | | icalDomainName_ | | | | | (and, | | | | | optionally, | | | | | _do | | | | | mainNameAlias_) | | | | | are | | | | | concatenated | | | | | with the mapped | | | | | path and any | | | | | leaf path | | | | | element from | | | | | the original | | | | | M2d upload | | | | | request to form | | | | | the | | | | | distribution | | | | | URL(s) exposed | | | | | over M4d. | +-----------------+-----------------+-------------+-----------------+ | _caching | Array(Object) | 0..1 | Defines a | | Configurations_ | | | configuration | | | | | of the 5GMSd AS | | | | | cache for a | | | | | matching subset | | | | | of media | | | | | resources | | | | | ingested in | | | | | relation to | | | | | this Content | | | | | Hosting | | | | | Configuration. | +-----------------+-----------------+-------------+-----------------+ | _ur | String | 1..1 | A pattern that | | lPatternFilter_ | | | will be used to | | | | | match media | | | | | resource URLs | | | | | to determine | | | | | whether a given | | | | | media resource | | | | | is eligible for | | | | | caching by the | | | | | 5GMSd AS. The | | | | | format of the | | | | | pattern shall | | | | | be a regular | | | | | expression as | | | | | specified in | | | | | [5]. | +-----------------+-----------------+-------------+-----------------+ | _cac | Object | 1..1 | If a | | hingDirectives_ | | | _ur | | | | | lPatternFilter_ | | | | | applies to a | | | | | resource, then | | | | | the provided | | | | | _cac | | | | | hingDirectives_ | | | | | shall be | | | | | applied by the | | | | | 5GMSd AS at | | | | | M4d, | | | | | potentially | | | | | overwriting any | | | | | origin caching | | | | | directives | | | | | ingested at | | | | | M2d. | +-----------------+-----------------+-------------+-----------------+ | _sta | Array(Integer) | 0..1 | The set of HTTP | | tusCodeFilters_ | | | origin response | | | | | status codes to | | | | | which these | | | | | _cac | | | | | hingDirectives_ | | | | | apply. The | | | | | filter shall be | | | | | provided as a | | | | | regular | | | | | expression as | | | | | specified in | | | | | [5]. | | | | | | | | | | If the list is | | | | | empty, the | | | | | _Cac | | | | | hingDirectives_ | | | | | shall apply to | | | | | all HTTP origin | | | | | response status | | | | | codes at M2d. | +-----------------+-----------------+-------------+-----------------+ | _noCache_ | Boolean | 1..1 | If set to | | | | | _True_ , this | | | | | indicates that | | | | | the media | | | | | resources | | | | | matching the | | | | | filters shall | | | | | not be cached | | | | | by the 5GMSd AS | | | | | and shall be | | | | | marked as not | | | | | to be cached | | | | | when served by | | | | | the 5GMSd AS at | | | | | M4d. | +-----------------+-----------------+-------------+-----------------+ | _maxAge_ | Integer | 0..1 | The caching | | | | | time-to-live | | | | | period that | | | | | shall be set on | | | | | ingested media | | | | | resources | | | | | matching the | | | | | filters. This | | | | | determines the | | | | | minimum period | | | | | for which the | | | | | 5GMSd AS shall | | | | | cache matching | | | | | media resources | | | | | as well as the | | | | | time-to-live | | | | | period | | | | | signalled by | | | | | the 5GMSd AS at | | | | | interface M4d | | | | | when it serves | | | | | such media | | | | | resources. | | | | | | | | | | The | | | | | time-to-live | | | | | for a given | | | | | media resource | | | | | shall be | | | | | calculated | | | | | relative to the | | | | | time it was | | | | | ingested. | +-----------------+-----------------+-------------+-----------------+ | _geoFencing_ | Object | 0..N | Limit access to | | | | | the content to | | | | | the indicated | | | | | geographic | | | | | areas. | +-----------------+-----------------+-------------+-----------------+ | _locatorType_ | Uri | 1..1 | The type of the | | | | | locators shall | | | | | be indicated | | | | | using a | | | | | fully-qualified | | | | | term identifier | | | | | URI from the | | | | | controlled | | | | | vocabulary | | | | | _urn:3gpp:5gms: | | | | | ‌locator‑type_ , | | | | | as specified in | | | | | clause 7.6.4.6, | | | | | or else from a | | | | | vendor-specific | | | | | vocabulary. | +-----------------+-----------------+-------------+-----------------+ | _locators_ | Array(String) | 1..1 | Array of | | | | | locators from | | | | | which access to | | | | | the resources | | | | | is to be | | | | | allowed. The | | | | | format of the | | | | | locator strings | | | | | shall be | | | | | determined by | | | | | the value of | | | | | _locatorType_ , | | | | | as specified in | | | | | clause 7.6.4.6. | +-----------------+-----------------+-------------+-----------------+ | _urlSignature_ | Object | 0..1 | Defines the URL | | | | | signing scheme. | | | | | Only correctly | | | | | signed and | | | | | valid URLs will | | | | | be allowed to | | | | | access the | | | | | content | | | | | resource at | | | | | M4d. | +-----------------+-----------------+-------------+-----------------+ | _urlPattern_ | String | 1..1 | A pattern that | | | | | shall be used | | | | | by the 5GMSd AS | | | | | to match M4d | | | | | media resource | | | | | URLs. The | | | | | 5GMSd AS shall | | | | | not serve a | | | | | matching media | | | | | resource at M4d | | | | | unless it | | | | | includes a | | | | | valid | | | | | authentication | | | | | token | | | | | calculated over | | | | | the portion of | | | | | the M4d request | | | | | URL that | | | | | matches this | | | | | pattern. The | | | | | format of the | | | | | pattern shall | | | | | be a regular | | | | | expression as | | | | | specified in | | | | | [5]. | +-----------------+-----------------+-------------+-----------------+ | _tokenName_ | String | 1..1 | The name of the | | | | | M4d request | | | | | query parameter | | | | | that the Media | | | | | Player should | | | | | use to present | | | | | the | | | | | authentication | | | | | token when | | | | | required to do | | | | | so. | +-----------------+-----------------+-------------+-----------------+ | * | String | 1..1 | The name of the | | passphraseName _| | | query parameter | | | | | that is used to | | | | | refer to the | | | | | passphrase when | | | | | constructing | | | | | the | | | | | authentication | | | | | token. | | | | | | | | | | Note that the | | | | | token is not | | | | | included in the | | | | | cleartext part | | | | | of the M4d URL | | | | | query | | | | | component. | +-----------------+-----------------+-------------+-----------------+ |_ passphrase _| String | 1..1 | The shared | | | | | secret between | | | | | the 5GMSd | | | | | Application | | | | | Provider and | | | | | the 5GMSd AS | | | | | for this | | | | |_ distribution | | | | | Configuration _. | | | | | | | | | | The passphrase | | | | | is used in the | | | | | computation and | | | | | verification of | | | | | the M4d | | | | | authentication | | | | | token but is | | | | | never sent | | | | | in-the-clear | | | | | over that | | | | | interface. | +-----------------+-----------------+-------------+-----------------+ |_ t | String | 1..1 | The name of the | | okenExpiryName _| | | M4d request | | | | | query parameter | | | | | that the Media | | | | | Player should | | | | | use to present | | | | | the token | | | | | expiry field. | +-----------------+-----------------+-------------+-----------------+ |_ useIPAddress _| Boolean | 1..1 | If set to | | | | |_ True _, the IP | | | | | address of the | | | | | UE is included | | | | | in the | | | | | computation of | | | | | the | | | | | authentication | | | | | token for | | | | | resources that | | | | | match | | | | |_ urlPattern _| | | | | and access to | | | | | matching media | | | | | resources shall | | | | | be allowed by | | | | | the 5GMSd AF | | | | | only when the | | | | | M4d request is | | | | | made from a UE | | | | | with this IP | | | | | address. | +-----------------+-----------------+-------------+-----------------+ |_ ipAddressName _| String | 0..1 | The name of the | | | | | M4d request | | | | | query parameter | | | | | that is encoded | | | | | as part of the | | | | | authentication | | | | | token if the | | | | |_ useIPAddress _| | | | | flag is set to | | | | |_ True _. | | | | | | | | | | Note that the | | | | | IP address is | | | | | not passed in | | | | | the cleartext | | | | | part of the M4d | | | | | URL query | | | | | component. | +-----------------+-----------------+-------------+-----------------+ |_ certificateId* | ResourceId | 0..1 | When content is | | | | | distributed | | | | | using TLS | | | | | [16], the | | | | | X.509 [8] | | | | | certificate for | | | | | the origin | | | | | domain is | | | | | shared with the | | | | | 5GMSd AF so | | | | | that it can be | | | | | presented by | | | | | the 5GMSd AS in | | | | | the TLS | | | | | handshake at | | | | | M4d. This | | | | | attribute | | | | | indicates the | | | | | identifier of | | | | | the certificate | | | | | to use. | +-----------------+-----------------+-------------+-----------------+
### 7.6.4 Operations
#### 7.6.4.1 Overview
This clause defines the behaviour that is expected from the 5GMSd AS when the
Content Hosting Configuration has been successfully provisioned. The main
operations that are performed affect the caching and purging of cached content
as well as the processing for media preparation and at the edge.
#### 7.6.4.2 Content caching
A Content Hosting Configuration may specify caching rules to be applied to
media resources when they are distributed by the 5GMSd AS over interface M4d.
The distribution shall use the _urlPatternFilter_ in the
_CachingConfiguration_ object to determine which caching directives apply to
that object. In case a media resource\'s URL matches the pattern filter of
more than one _CachingConfiguration,_ the first match shall apply. In case no
_CachingConfiguration_ is identified as a match, the 5GMSd AS shall apply the
caching directives that were received from the origin. In the case where no
match is found and the origin server does not supply caching directives at
M2d, then default caching directives based on the media resource type shall be
applied.
A caching directive shall either indicate that a matching media resource is
not to be cached by the 5GMSd AS, nor by downstream M4d clients (_noCache_ set
to _True_), or that the 5GMSd AS and downstream M4d clients are to cache it
for _maxAge_ seconds. The _maxAge_ value applies relative to the time when a
media resource was ingested, _t_ingest_. For an HTTP-based ingest, this
corresponds to the _Date_ header field in the HTTP request/response that
carries the media resource at M2d. At the time _t_ingest + maxAge_ , the
object is considered stale and should not be served at M4d from the 5GMSd AS
cache. The 5GMSd AS shall compensate for any synchronization skew between the
origin and its own clock. This can be for instance done by including the max-
stale HTTP cache directive in its M4d responses.
The _maxAge_ value may be signalled at M4d by the 5GMSd AS using the Expires
HTTP response header or the HTTP Cache-Control directives max‑age or s‑maxage.
When distributing a media resource using HTTP, a _no-cache_ request may be
translated into a no-cache and no-store HTTP Cache-Control directive and/or a
max-age=0 HTTP Cache-Control directive.
By default, all origin HTTP header fields shall be assumed as not forwarded by
the 5GMSd AS, unless specified otherwise by setting the flag
_originCacheHeaders_ to _True_.
#### 7.6.4.3 Cache purging
The 5GMSd Application Provider may perform a purge operation to invalidate
some or all cached media resources of a particular Content Hosting
Configuration. A regular expression describing the set of media resource URLs
to be purged from the 5GMSd AS cache for the Content Hosting Configuration in
question shall be supplied in the body of the request. The body shall be
encoded using the _application/x-www-form-urlencoded_ MIME content type as a
key--value pair, with the key being the string _pattern_ and the value being
the regular expression.
On receiving a purge request, the 5GMSd AF shall immediately invalidate all
media resources in the 5GMSd AS cache matching the regular expression by
declaring them as stale. Any request at reference point M4d for a purged media
resource will trigger the fetching (and possible caching) of the current
version from the origin via M2d in case of a Pull-based ingest. For Push-based
ingest, M4d requests for purged content shall be responded to with a _404 (Not
Found)_ HTTP response, until a new version of the object is pushed by the
origin to the 5GMSd AS via M2d.
If the procedure is successful, the 5GMSd AF shall respond with one of the
following response messages:
\- _204 (No Content)_ if no cache entries were purged, for example because no
current cache entries matched the regular expression supplied in the original
request.
\- _200 (OK)_ if some cache entries were purged. The body of the response
message shall indicate the total number of cache entries purged in all 5GMSd
AS instances distributing the Provisioning Session in question.
If the procedure is not successful, the 5GMSd AF shall provide a response code
as defined in clause 6.3. In addition, the HTTP response _422 (Unprocessable
Entity)_ shall be returned in the case where the request message body -- or
the regular expression contained in it -- are found by the 5GMSd AF to be
syntactically malformed.
#### 7.6.4.4 Content processing
The 5GMSd AS can perform various content processing tasks (such as
repackaging, encryption, ABR transcoding) on media resources ingested at M2d
prior to serving them at M4d. These processing tasks shall be specified in a
Content Preparation Template resource referenced from the Content Hosting
Configuration object.
#### 7.6.4.5 URL signing
The URL signing procedure allows the 5GMSd Application Provider to prevent
deep linking and unauthorized access to M4d media resources. It works by
cryptographically signing some elements of the M4d request URL and then
appending this authentication token to the URL as an additional query
parameter. The token is generated by the 5GMSd Application Provider and
supplied to the player, for example as part of an initial URL. When it
receives a request that requires URL signing, the 5GMSd AS verifies the
presence and validity of the token in the M4d request URL before allowing
access to the requested media resource. The 5GMSd AS(s) and the origin share a
secret that is encoded as part of the query parameter hash, but not shared
with the 5GMSd Media Player.
The validity of the authentication token can also be limited to a single UE.
If _useIPAddress_ is set to True, then the public IP address of the UE as
viewed by the 5GMSd AS, _ue_public_ip_address_ , shall be incorporated into
the token calculation. The parameter name shall be indicated by
_ipAddressName_.
The shared secret shall be provided in _UrlSignature.passphrase_ as a string
of length between 6 and 50 characters. The parameter name for the passphrase
shall be provided by _passphraseName_.
The expiry time of the signed URL, _tokenExpiry_ , shall be included as an
additional query parameter in the URL exposed at M4d with the name indicated
in _tokenExpiryName_. The expiry time shall be the string representation of
the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC
date/time, ignoring leap seconds, as defined in section 4.16 of POSIX.1 [11].
Given the above, the authentication token shall be calculated as:
_token_ := SHA512(_url_ &_UrlSignature.tokenExpiryName_ =_token_expiry_
&_UrlSignature.ipAddressName_ =‌ _ue_public_ip_address_ &‌
_UrlSignature.passphraseName_ =_passphrase_)
where the SHA512 function shall be the SHA‑512 hash [6] of the enclosed
string. The _url_ parameter shall be the original M4d media resource request
URL, including the scheme, authority and path components but excluding any
query and fragment components.
The resulting token value shall be \"base64url\" encoded, as specified in
section 5 of RFC 4648 [10], prior to inclusion in the M4d URL.
The query part of the signed URL presented by the 5GMSd Media Player at M4d as
proof of authenticity shall be composed as follows:
> _query_ := _UrlSignature.tokenExpiryName_ =_token_expiry_
> &_UrlSignature.tokenName_ =base64url(_token_)
For all media resources requested at reference point M4d that match the
regular expression specified in _UrlSignature.urlPattern_ , the 5GMSd AS shall
validate the _query_ presented in the request URL according to the following
steps:
1) If the parameter indicated by _UrlSignature.tokenName_ is absent from
_query_ , or if the supplied _token_ value is malformed, the 5GMSd AS shall
respond with a _403 (Forbidden)_ error response message and terminate further
processing of the M4d request.
2) If the parameter indicated by _UrlSignature.tokenExpiryName_ is absent from
_query_ , or if the supplied _token_expiry_ value has expired, or if the
supplied _token_expiry_ is malformed, the 5GMSd AS shall respond with a _403
(Forbidden)_ error response message and terminate further processing of the
M4d request.
3) The 5GMSd AS shall compute the authentication token according to the
_token_ production specified above using the requesting UE\'s public IP
address as the value of _ue_public_ip_address_ if required by
_UrlSignature.useIPAddress_ being set to _True_. After applying \"base64url\"
encoding, the 5GMSd AS shall compare this with the value supplied in the URL
_query_ parameter whose name is _UrlSignature.tokenName_. If the two values
differ, the 5GMSd AS shall respond with a _403 (Forbidden)_ error response
message and terminate further processing of the M4d request.
4) Otherwise, the presented authentication token is valid. The 5GMSd AS shall
either return the media resource in a _200 (OK)_ response message (if it is
able to serve that media resource), or else return an appropriate error
response, such as _404 (Not Found)_ or _503 (Service Unavailable_)_._
#### 7.6.4.6 Geofencing
The 5GMSd Application Provider may wish to limit access to its media content
at interface M2d to UEs located in certain geographical zones. Geofencing is
used to configure the zone from which content is accessible.
Two different types of locator are specified here:
**\- Administrative area locator:** the value of _GeoFencing.locatorType_
shall be _urn:3gpp:5gms:locator‑type:‌iso3166_ and each member of the
_GeoFencing.locators_ array shall be either a string representation of an ISO
3166‑1 alpha‑2 country code [18] (e.g. _US_ , _CN_ , _KR_ , _GB_ , _FR_) or an
ISO 3166-2 code [19] comprising an alpha‑2 country code and a country
subdivision code valid for that country (e.g. _US‑CA_ , _CN-GD_ , _KR‑26_ ,
_GB‑ENG_ , _GB‑WSM_ , _FR‑IDF_ , _FR‑75_).
**[-** **Tracking Area locator:** the value of _GeoFencing.locatorType_ shall
be _urn:3gpp:5gms:locatortype:‌trackingAreaCode_ and each member of the
_GeoFencing.locators_ array shall be the Fully-Qualified Domain Name
representation of a Tracking Area Code, as defined in clause 19.4.2.3 of TS
23.003 [7].]
## 7.7 Consumption Reporting Provisioning API
### 7.7.1 Overview
The Consumption Reporting Provisioning API is a RESTful API that allows a
5GMSd Application Provider to configure the Consumption Reporting Procedure
for a particular downlink media streaming Provisioning Session at interface
M1d. The different procedures are described in clause 4.3.8. The Consumption
Reporting Configuration is represented by a
_ConsumptionReportingConfiguration_ , the data model for which is specified in
clause 7.7.3 below. The RESTful resources for managing the Consumption
Reporting Configuration are specified in clause 7.7.2.
### 7.7.2 Resource structure
The Consumption Reporting Provisioning API is accessible through the following
URL base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.7.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the Provisioning Session
identifier shall be substituted into _{provisioningSessionId}_ in the above
URL template and the sub-resource path specified in the second column shall be
appended to the URL base path.
Table 7.7.2‑1: Operations supported by the Consumption Reporting Provisioning
API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Activate | consump | POST | Activate the | | Consumption | tion‑reporting | | consumption | | Reporting | ‑configuration | | reporting | | procedure with | | | procedure and | | a Consumption | | | to set the | | Reporting | | | Consumption | | Configuration | | | Reporting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Fetch | | GET | Retrieve an | | Consumption | | | existing | | Reporting | | | Consumption | | Configuration | | | Reporting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Update | | PUT, | Modify an | | Consumption | | | existing | | Reporting | | PATCH | Consumption | | Configuration | | | Reporting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Delete | | DELETE | Deactivate the | | Consumption | | | consumption | | Reporting | | | reporting | | Configuration | | | procedure for | | | | | that | | | | | particular | | | | | session. | +----------------+----------------+----------------+----------------+
### 7.7.3 Data model
#### 7.7.3.1 ConsumptionReportingConfiguration resource
The data model for the _ConsumptionReportingConfiguration_ resource is
specified in table 7.7.3.1‑1.
Table 7.7.3.1-1: ConsumptionReportingConfiguration resource
+-------------------+-------------+-------------+-------------------+ | Property name | Type | Cardinality | Description | +===================+=============+=============+===================+ | _r | DurationSec | 0..1 | The interval | | eportingInterval_ | | | between two | | | | | consecutive | | | | | consumption | | | | | reports. The | | | | | value shall be | | | | | greater than | | | | | zero. | | | | | | | | | | If absent, a | | | | | single final | | | | | report shall be | | | | | sent immediately | | | | | after the media | | | | | streaming session | | | | | has ended. | +-------------------+-------------+-------------+-------------------+ | * | Percentage | 0..1 | The proportion of | | samplePercentage _| | | media streaming | | | | | clients that | | | | | shall report | | | | | media | | | | | consumption, | | | | | expressed as a | | | | | floating point | | | | | value between 0.0 | | | | | and 100.0. | | | | | | | | | | If not specified, | | | | | all clients shall | | | | | send consumption | | | | | reports. | +-------------------+-------------+-------------+-------------------+ |_ l | boolean | 0..1 | Stipulates | | ocationReporting* | | | whether the Media | | | | | Session Handler | | | | | is required to | | | | | provide location | | | | | data to the 5GMSd | | | | | AF in consumption | | | | | reporting | | | | | messages (in case | | | | | of MNO or trusted | | | | | third parties). | +-------------------+-------------+-------------+-------------------+
## 7.8 Metrics Reporting Provisioning API
### 7.8.1 Overview
The Metrics Reporting Provisioning API allows an 5GMS System operator or a
5GMS Application Provider to configure the Metrics Collection and Reporting
procedure for a particular downlink or uplink media streamingProvisioning
Session at interface M1.
### 7.8.2 Resource structure
The Metrics Reporting Provisioning API is accessible through the following URL
base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.8.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the Provisioning Session
identifier shall be substituted into _{provisioningSessionId}_ in the above
URL template and the sub-resource path specified in the second column of the
table shall be appended to the URL base path.
Table 7.8.2-1: Operations supported by the Metrics Reporting Provisioning API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Metrics | metr | POST | Create and | | Reporting | ics‑reporting‑ | | optionally | | Configuration | configurations | | provide a | | | | | configuration. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created | | | | | Metrics | | | | | Reporting | | | | | Configuration | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response. | +----------------+----------------+----------------+----------------+ | Read Metrics | metrics‑repor | GET | Retrieve the | | Reporting | ting‑configura | | values of an | | Configuration | tions/‌ _{metri | | existing | | | csReportingCon | | Metrics | | | figurationId}_ | | Reporting | | | | | Configuration. | +----------------+----------------+----------------+----------------+ | Update Metrics | | PUT, | Provide | | Reporting | | | initial upload | | Configuration | | PATCH | of a new | | | | | configuration, | | | | | or either the | | | | | modification | | | | | of, or | | | | | replacement to | | | | | an existing | | | | | configuration. | +----------------+----------------+----------------+----------------+ | Delete Metrics | | DELETE | Delete a | | Reporting | | | configuration, | | Configuration | | | disables | | | | | reporting. | +----------------+----------------+----------------+----------------+
### 7.8.3 Data model
#### 7.8.3.1 MetricsReportingConfiguration resource
The data model for the _MetricsReportingConfiguration_ resource is specified
in table 7.8.3-1 below:
Table 7.8.3‑1: Definition of MetricsReportingConfiguration resource
+------------------+---------------+-------------+------------------+ | Property name | Type | Cardinality | Description | +==================+===============+=============+==================+ | > * | ResourceId | 1..1 | An identifier | | metricsReporting | | | for this Metrics | | ConfigurationId _| | | Reporting | | | | | Configuration | | | | | assigned by the | | | | | 5GMS AF that is | | | | | unique within | | | | | the scope of the | | | | | enclosing | | | | | Provisioning | | | | | Session. | +------------------+---------------+-------------+------------------+ | > _scheme _| Uri | 0..1 | The scheme | | | | | associated with | | | | | this Metrics | | | | | Reporting | | | | | Configuration. A | | | | | scheme may be | | | | | associated with | | | | | 3GPP or with a | | | | | non-3GPP entity. | | | | | | | | | | For downlink | | | | | media streaming, | | | | | if not | | | | | specified, the | | | | | 3GPP metrics | | | | | scheme | | | | |_ urn:‌3GPP:‌ns:‌ | | | | | PSS:‌DASH:‌QM10 _| | | | | from TS 26.247 | | | | | shall apply. | | | | | | | | | | For uplink media | | | | | streaming, if | | | | | not specified, | | | | | the implication | | | | | is that no | | | | | associated | | | | | uplink metrics | | | | | reporting shall | | | | | be performed. | +------------------+---------------+-------------+------------------+ | > * | Dnn | 0..1 | The Data Network | | dataNetworkName_ | | | Name (DNN) which | | | | | shall be used | | | | | when sending | | | | | metrics reports. | | | | | | | | | | If not | | | | | specified, the | | | | | default DNN | | | | | shall be used. | +------------------+---------------+-------------+------------------+ | > _re | DurationSec | 0..1 | The time | | portingInterval_ | | | interval between | | | | | successive | | | | | metrics reports. | | | | | The value shall | | | | | be greater than | | | | | zero. | | | | | | | | | | If not | | | | | specified, a | | | | | single final | | | | | report shall be | | | | | sent after the | | | | | media streaming | | | | | session has | | | | | ended. | +------------------+---------------+-------------+------------------+ | > _s | Percentage | 0..1 | The proportion | | amplePercentage_ | | | of media | | | | | streaming | | | | | sessions for | | | | | which metrics | | | | | shall be | | | | | reported, | | | | | expressed as a | | | | | floating-point | | | | | value between | | | | | 0.0 and 100.0. | | | | | | | | | | If not | | | | | specified, | | | | | reports shall be | | | | | sent for all | | | | | sessions. | +------------------+---------------+-------------+------------------+ | > _urlFilters_ | array(String) | 0..1 | A non-empty list | | | | | of Media Entry | | | | | Point URL | | | | | patterns for | | | | | which metrics | | | | | shall be | | | | | reported. | | | | | | | | | | If not | | | | | specified, | | | | | reporting shall | | | | | be done for all | | | | | media streaming | | | | | sessions | | | | | initiated within | | | | | the scope of the | | | | | parent | | | | | Provisioning | | | | | Session. | +------------------+---------------+-------------+------------------+ | > | DurationSec | 1..1 | The time | | _samplingPeriod_ | | | interval the | | | | | 5GMS Client | | | | | should wait | | | | | between sampling | | | | | the QoE metrics | | | | | specified by | | | | | this metrics | | | | | reporting | | | | | configuration. | +------------------+---------------+-------------+------------------+ | > _metrics_ | array(String) | 0..1 | If present, a | | | | | non-empty list | | | | | of metrics which | | | | | shall be | | | | | collected and | | | | | reported. | | | | | | | | | | In the case of | | | | | downlink media | | | | | streaming and | | | | | for the 3GPP | | | | | scheme | | | | | _urn:‌3GPP:‌ns:‌ | | | | | PSS:‌DASH:‌QM10_ | | | | | the listed | | | | | metrics shall | | | | | correspond to | | | | | one or more of | | | | | the metrics as | | | | | specified in | | | | | clauses 10.3 | | | | | and 10.4 of | | | | | TS 26.247 [7], | | | | | and the quality | | | | | reporting scheme | | | | | and quality | | | | | reporting | | | | | protocol as | | | | | defined in | | | | | clauses 10.5 | | | | | and 10.6, | | | | | respectively, | | | | | of [7] shall | | | | | be used to | | | | | produce and send | | | | | metrics reports. | | | | | | | | | | Metrics related | | | | | to virtual | | | | | reality media, | | | | | as specified in | | | | | TS 26.118 [42] | | | | | clause 9.3, may | | | | | also be listed | | | | | in the metrics | | | | | configuration, | | | | | and shall be | | | | | reported | | | | | according to the | | | | | quality | | | | | reporting scheme | | | | | defined in | | | | | clause 9.4 | | | | | of [42]. | | | | | | | | | | In the case of | | | | | uplink | | | | | streaming, no | | | | | standardized | | | | | metrics nor | | | | | metrics | | | | | reporting | | | | | protocol are | | | | | defined in the | | | | | present | | | | | document. It is | | | | | assumed that | | | | | those quality | | | | | metrics and | | | | | reporting | | | | | protocol are | | | | | defined by the | | | | | metrics scheme. | | | | | | | | | | If omitted, the | | | | | complete (or | | | | | default, as | | | | | applicable) set | | | | | of metrics | | | | | associated with | | | | | the specified | | | | | scheme shall be | | | | | collected and | | | | | reported. | +------------------+---------------+-------------+------------------+
## 7.9 Policy Templates Provisioning API
### 7.9.1 Overview
The Policy Templates Provisioning API allow a 5GMS Application Provider to
configure a set of Policy Templates within the scope of a Provisioning Session
that can subsequently be applied to downlink or uplink media streaming
sessions belonging to that Application Provider using the Dynamic Policies API
specified in clause 11.5. A Policy Template is used to specify the traffic
shaping and charging policies to be applied to these media streaming sessions.
A Policy Template, identified by its _policyTemplateId_ , represents a set of
PCF/NEF API parameters which defines the service quality and associated
charging for the corresponding downlink or uplink media streaming session(s).
The Policy Template is configured as part of the provisioning procedures with
the 5GMS AF and is then used by the 5GMS AF to request specific QoS and
charging policies for that session from the PCF or NEF.
The state of a Policy Template can be:
\- _pending_ : The Policy Template is awaiting validation, potentially because
not all required parameters have yet been provided. This is the default state
after Policy Template creation.
\- _invalid_ : One or more of the Policy Template\'s properties failed
validation by the 5GMS AF.
\- _ready_ : After successful validation by the 5GMS AF the Policy Template
moves into this state.
\- _suspended_ : The 5GMS AF may move a Policy Template into this state under
certain conditions defined within the Service Level Agreement.
When the Policy Template is used for QoS Flows, the _qoSSpecification_ object
(of type _M1QoSSpecification_) shall be present:
\- The _qosReference_ value is obtained with the Service Level Agreement. See
TS 23.502 for detailed usage.
\- The _maxBtrUl_ and _maxBtrDl_ properties define the maximal bit rate which
can be used for QoS Flows. This value is defined by the 5G System.
\- The _maxAuthBtrUl_ and _MaxAuthBtrDl_ properties define the maximal
authorized bit rate values which can be requested by a Media Session Handler.
Higher bit rate values are not authorized for use by the 5GMS Application
Provider.
\- The _minPacketLossRateDl_ and _minPacketLossRateUl_ properties define the
minimal authorized packet loss rate, which can be requested by a Media Session
Handler.
When the Policy Template is used for differential charging the
_chargingSpecification_ property shall be present.
_applicationSessionContext_ is a mandatory child object, which contains at
least the _aspId_ property.
\- The _aspId_ identifies the API invoker.
\- The _dnn_ property contains the Data Network Name of the data network, in
which the 5GMS AF is hosted.
\- When Network Slicing is used, the _sliceInfo_ property contains information
about the network slice, which is serving the UE.
\- When present, the _afAppId_ property contains an application identifier
referencing one or more _PFD_ objects. The value of the _afAppId_ property is
provided to the PCF with each new _Npcf_PolicyAuthorization_ service instance.
### 7.9.2 Resource structure
The Policy Template Provisioning API is accessible through the following URL
base path:
_{apiRoot}_ /3gpp-m1/v1/provisioning-sessions/_{provisioningSessionId}_ /
Table 7.9.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the Provisioning Session
identifier shall be substituted into _{provisioningSessionId}_ in the above
URL template and the sub-resource path specified in the second column shall be
appended to the URL base path.
Table 7.9.2‑1: Operations supported by the Policy Template Provisioning API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create a new | po | POST | Used to create | | Policy | licy-templates | | a new Policy | | Template | | | Template | | | | | resource. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created Policy | | | | | Template | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response. | +----------------+----------------+----------------+----------------+ | Fetch a Policy | policy-tem | GET | Used to | | Template | plates/‌ _{poli | | retrieve an | | | cyTemplateId}_ | | existing | | | | | Policy | | | | | Template | | | | | resource. | +----------------+----------------+----------------+----------------+ | Update a | | PUT, | Used to modify | | Policy | | | the | | Template | | PATCH | configuration | | | | | of an existing | | | | | Policy | | | | | Template. | +----------------+----------------+----------------+----------------+ | Delete a | | DELETE | Used to delete | | Policy | | | an existing | | Template | | | Policy | | | | | Template | | | | | resource. | +----------------+----------------+----------------+----------------+
### 7.9.3 Data model
#### 7.9.3.1 PolicyTemplate resource
The data model for the _PolicyTemplate_ resource is specified in table 7.9.3‑1
below:
Table 7.9.3.1-1: Definition of PolicyTemplate resource
+--------------+--------------+-------------+--------+--------------+ | Property | Type | Cardinality | Usage | Description | +==============+==============+=============+========+==============+ | _polic | ResourceId | 1..1 | C: RO\ | Identifier | | yTemplateId_ | | | R: RO\ | of this | | | | | U: RO | Policy | | | | | | Template | | | | | | assigned by | | | | | | the 5GMS AF | | | | | | that is | | | | | | unique | | | | | | within the | | | | | | scope of the | | | | | | Provisioning | | | | | | Session. | +--------------+--------------+-------------+--------+--------------+ | _state_ | string enum | 1..1 | C: RO\ | A Policy | | | | | R: RO\ | Template may | | | | | U: RO | be in the | | | | | | _PENDING_ , | | | | | | _INVALID_ , | | | | | | _READY_ , or | | | | | | _SUSPENDED_ | | | | | | state. | | | | | | | | | | | | Only a | | | | | | Policy | | | | | | Template in | | | | | | the _READY_ | | | | | | state may be | | | | | | instantiated | | | | | | as a Dynamic | | | | | | Policy | | | | | | Instance and | | | | | | applied to | | | | | | media | | | | | | streaming | | | | | | sessions. | +--------------+--------------+-------------+--------+--------------+ | * | Pro | 1..1 | C: RO\ | Additional | | stateReason _| blem‌Details | | R: RO\ | details | | | | | U: -- | about the | | | | | | current | | | | | | state of | | | | | | this Policy | | | | | | Template | | | | | | exposed to | | | | | | the 5GMS | | | | | | Application | | | | | | Provider by | | | | | | the 5GMS AF. | | | | | | | | | | | | The | | | | | |_ instance _| | | | | | sub-property | | | | | | shall be | | | | | | present and | | | | | | shall | | | | | | indicate the | | | | | | URL of this | | | | | | Policy | | | | | | Template | | | | | | resource. | | | | | | | | | | | | The_ title _| | | | | | sub-property | | | | | | shall be | | | | | | present and | | | | | | shall | | | | | | indicate a | | | | | | hu | | | | | | man-readable | | | | | | re | | | | | | presentation | | | | | | of the | | | | | |_ state _| | | | | | property | | | | | | specified | | | | | | above, e.g. | | | | | | \"Policy | | | | | | Template | | | | | | ready for | | | | | | use\" or | | | | | | \"Policy | | | | | | Template | | | | | | invalid\". | | | | | | | | | | | | The_ detail _| | | | | | sub-property | | | | | | shall be | | | | | | present and | | | | | | shall | | | | | | indicate a | | | | | | hu | | | | | | man-readable | | | | | | status/error | | | | | | message. | | | | | | | | | | | | All other | | | | | | properties | | | | | | shall be | | | | | | omitted. | +--------------+--------------+-------------+--------+--------------+ |_ extern | string | 1..1 | C: RW\ | Additional | | alReference _| | | R: RO\ | identifier | | | | | U: RW | for this | | | | | | Policy | | | | | | Template, | | | | | | unique | | | | | | within the | | | | | | scope of its | | | | | | Provisioning | | | | | | Session, | | | | | | that can be | | | | | | cros | | | | | | s-referenced | | | | | | with | | | | | | external | | | | | | metadata | | | | | | about the | | | | | | media | | | | | | streaming | | | | | | session. | +--------------+--------------+-------------+--------+--------------+ |_ qoSSp | M1‌QoS‌S | 0..1 | C: RW\ | Specifies | | ecification _| pecification | | R: RO\ | the network | | | | | U: RW | quality of | | | | | | service to | | | | | | be applied | | | | | | to media | | | | | | streaming | | | | | | sessions at | | | | | | this Policy | | | | | | Template. | +--------------+--------------+-------------+--------+--------------+ |_ appl | Object | 1..1 | | Specifies | | ication‌Sess | | | | information | | ion‌Context _| | | | about the | | | | | | application | | | | | | session | | | | | | context to | | | | | | which this | | | | | | Policy | | | | | | Template can | | | | | | be applied. | +--------------+--------------+-------------+--------+--------------+ |_ sliceInfo _| Snssai | 0..1 | C: RW\ | As defined | | | | | R: RW | in | | | | | | cl | | | | | U: RW | ause 5.4.4.2 | | | | | | of | | | | | | TS 29 | | | | | | .571 [12]. | +--------------+--------------+-------------+--------+--------------+ |_ dnn _| Dnn | 0..1 | C: RW\ | As defined | | | | | R: RW | in | | | | | | clause 5.3.2 | | | | | U: RW | of | | | | | | TS 29 | | | | | | .571 [12]. | +--------------+--------------+-------------+--------+--------------+ |_ charging‌Sp | Charging‌S | 0..1 | C: RW\ | Provides | | ecification* | pecification | | R: RW | information | | | | | | about the | | | | | U: RW | charging | | | | | | policy to be | | | | | | used for | | | | | | this Policy | | | | | | Template. | +--------------+--------------+-------------+--------+--------------+
# 8 Media Ingest and Publish (M2) protocols
## 8.1 General
The set of content protocols supported by the 5GMS AS is listed in table 8.1-1
below:
Table 8.1-1: Supported content protocols
Description Term identifier Clause
* * *
Content ingest protocols at interface M2d  
HTTP pull-based content ingest protocol _urn:3gpp:5gms:content-protocol:http-
pull-ingest_ 8.2 DASH-IF push-based content ingest protocol
_urn:3gpp:5gms:content-protocol:dash-if-ingest_ 8.3 Content egest protocols at
interface M2u
## 8.2 HTTP pull-based content ingest protocol
If _IngestConfiguration.protocol_ is set to _urn:3gpp:5gms:content-
protocol:http-pull-ingest_ in the Content Hosting Configuration, media
resources shall be ingested by the 5GMSd AS using HTTP [9]. The
_IngestConfiguration.pull_ property shall be set to _True_ , indicating that a
Pull-based protocol is used. The _IngestConfiguration.baseURL_ property shall
point at the 5GMSd Application Provider\'s origin server, as specified in
table 7.6.3.1‑1, and may indicate the use of HTTPS [16].
When the 5GMSd AS receives a request for a media resource at interface M4d
that cannot be satisfied from its content cache, the request shall be
transformed into a corresponding HTTP GET request directed to the 5GMSd
Application Provider\'s origin server via interface M2d as follows:
1\. The prefix of the request URL indicated in the
_Distribution‌Configuration.‌baseURL_ of the applicable Content Hosting
Configuration is replaced with that of the corresponding
_Ingest‌Configuration‌.baseURL_.
NOTE 1: It is the responsibility of the 5GMSd AF to assign unique M4d base
URLs to each provisioned Content Hosting Configuration so as to ensure that
this substitution is unambiguous.
2\. The path rewrite rules (if provisioned in
_DistributionConfiguration.PathRewriteRules_) are applied in strict order to
the remainder of the request URL (i.e., the path segments following
_Distribution‌Configuration.‌baseURL_). The _requestPathPattern_ of the first
matching path rewrite rule is replaced with the corresponding _mappedPath_.
In the case where the 5GMSd Application Provider\'s origin server issues an
HTTP _3xx_ redirect at reference point M2d pointing to another location, the
5GMSd AS shall issue an equivalent HTTP redirect to the Media Player via
reference point M4d whose location is a dynamically generated M4d endpoint.
Requests to this location shall be rewritten by the 5GMSd AS to the target
location of the M2d redirection.
NOTE 2: This explicit handling of HTTP redirects received by the 5GMSd AS at
reference point M2d ensures that it is not bypassed by the Media Player. The
general concept underlying this is commonly referred to as a \"reverse mapping
rule\" by HTTP reverse proxies.
## 8.3 DASH-IF push-based content ingest protocol
If _IngestConfiguration.protocol_ is set to _urn:3gpp:5gms:content-
protocol:dash-if-ingest_ in the Content Hosting Configuration, media resources
shall be ingested by the 5GMSd AS as specified by the DASH‑IF Live Media
Ingest specification [3]. The _IngestConfiguration.pull_ property shall be set
to False, indicating that a Push-based protocol is used. The
_IngestConfiguration.baseURL_ property shall be set by the 5GMSd AF to the
base URL that is to be used by the 5GMSd Application Provider to upload the
DASH segments and MPD(s) to the 5GMSd AS at reference point M2d.
# 9 Internal (M3) APIs
APIs of this reference point are not specified within this release.
# 10 Media Streaming (M4) APIs
## 10.1 General
This clause deals with the interface and APIs for media streaming for
different distribution formats and protocols.
## 10.2 DASH Distribution
In the case of DASH distribution, M4d is relevant for the distribution as
shown in Figure 10.2-1.
Figure 10.2-1: M4d usage for DASH distribution
For DASH-based distribution according to TS 26.247 [4] and ISO/IEC 23009-1
[32], two main formats are of relevance:
1) The Media Presentation Description (MPD) that is processed in the DASH
Access Client.
2) The Segment formats that are passed through the DASH Access Client and
processed in the Media Playback and Content Decryption Platform. Note that the
DASH Access Client may parse Segments to extract for example Inband Events or
producer reference times.
Other resources may be referenced in the MPD, for example DRM related
information.
The Segment formats for DASH Streaming in the context of 5G Media Streaming
are defined in TS 26.511 [35] based on the CMAF encapsulation. The DASH Access
Client downloads the Segments from the 5GMSd AS based on the instructions in
the MPD and the instructions from the 5GMSd-Aware Application through M7d (see
clause 13 for details).
The interface between the DASH Access Client and the Media Playback and
Content Decryption Platform as well as the 5GMSd Client requirements for media
codecs are documented in TS 26.511 [35].
The following requirements apply for M4d:
1) The Media Presentation Description (MPD) and Segments shall conform to an
MPD according to ISO/IEC 23009-1 [32] or TS 26.247 [4].
2) The Segment formats should conform to CMAF addressable resources as well as
to the requirements in TS 26.511 [35].
3) The Media Presentation should conform to the 5G Media Streaming DASH
Interoperability Point as defined in clause 7.3.11 of TS 26.247 [4].
A 5GMSd Client shall support the 5G Media Streaming DASH Interoperability
Point as defined in TS 26.247 [4], clause 7.3.11. A 5GMSd Client may support
additional DASH profiles and interoperability points.
The MPD may contain a one or several **ServiceDescription** elements that
include operational parameters. The MPD may also include multiple
configurations for the media (different codecs, different content protection,
different resolutions, etc.), for example for playback under different
operating policies. The handling of this information is documented in clause
13.2.
# 11 Media Session Handling (M5) APIs
## 11.1 General
This clause defines the Media Session Handling APIs used by the Media Session
Handler to access resources exposed by the 5GMS AF at interface M5.
NOTE: While the entirety of the Media Session Handling APIs apply to downlink
media streaming, only a subset is applicable to uplink media streaming.
Specifically, the Consumption Reporting API is not applicable to uplink media
streaming.
## 11.2 Service Access Information API
### 11.2.1 General
The Service Access Information API is used by the Media Session Handler to
obtain configuration information from the 5GMS AF that enables it to use the
other Media Session Handling APIs specified in clause 11.3 _et seq._
### 11.2.2 Resource structure
The Service Access Information API is accessible through the following URL
base path:
_{apiRoot}_ /3gpp-m5/v1/service-access-information/
The operations and the corresponding HTTP methods in Table 11.2.2-1 are
supported. In each case, the sub-resource path specified in the second column
shall be appended to the URL base path.
Table 11.2.2‑1: Operations supported by the Service Access Information API
+----------------+----------------+----------------+----------------+ | Operation | Sub-resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Fetch Service | _{provision | GET | Used to | | Access | ingSessionId}_ | | acquire the | | Information | | | Service Access | | | | | Information | | | | | resource for | | | | | the specified | | | | | Provisioning | | | | | Session. | | | | | | | | | | The | | | | | _{provision | | | | | ingSessionId}_ | | | | | uniquely | | | | | identifies the | | | | | Service Access | | | | | Information | | | | | Resource and | | | | | is allocated | | | | | by the 5GMS AF | | | | | during | | | | | creation of a | | | | | Provisioning | | | | | Session. | +----------------+----------------+----------------+----------------+
### 11.2.3 Data model
#### 11.2.3.1 ServiceAccessInformation resource type
The data model for the _ServiceAccessInformation_ resource is specified in
table 11.2.3.1-1 below. Different properties are present in the resource
depending on the type of Provisioning Session from which the Service Access
Information is derived (as indicated in the _provisioningSessionType_
property) and this is specified in the _Applicability_ column.
Table 11.2.3.1‑1: Definition of ServiceAccessInformation resource
+----------+----------+----------+-------+----------+----------+ | Property | Type | Car | Usage | Des | Appli | | name | | dinality | | cription | cability | +==========+==========+==========+=======+==========+==========+ | _provis | Re | 1..1 | RO | Unique | All | | ioningSe | sourceId | | | identi | types | | ssionId_ | | | | fication | | | | | | | of the | | | | | | | M1 | | | | | | | Prov | | | | | | | isioning | | | | | | | Session. | | +----------+----------+----------+-------+----------+----------+ | _p | P | 1..1 | RO | The type | All | | rovision | rovision | | | of | types. | | ingSessi | ing‌Sess | | | Prov | | | on‌Type_ | ion‌Type | | | isioning | | | | | | | Session. | | +----------+----------+----------+-------+----------+----------+ | * | object | 0..1 | RO | | _d | | streamin | | | | | ownlink_ | | gAccess _| | | | | | +----------+----------+----------+-------+----------+----------+ | > _ent | Abs | 0..1 | RO | A | | | ryPoint _| oluteUrl | | | pointer | | | | | | | to a | | | | | | | document | | | | | | | at | | | | | | | r | | | | | | | eference | | | | | | | point M2 | | | | | | | that | | | | | | | defines | | | | | | | a media | | | | | | | pres | | | | | | | entation | | | | | | | e.g. MPD | | | | | | | for DASH | | | | | | | content | | | | | | | or URL | | | | | | | to a | | | | | | | video | | | | | | | clip | | | | | | | file. | | +----------+----------+----------+-------+----------+----------+ |_ c | object | 0..1 | RO | | _d | | lientCon | | | | | ownlink_ | | sumption | | | | | | | Reportin | | | | | | | g‌Config | | | | | | | uration _| | | | | | +----------+----------+----------+-------+----------+----------+ | > _re | Dur | 0..1 | RO | The time | | | portingI | ationSec | | | i | | | nterval _| | | | nterval, | | | | | | | e | | | | | | | xpressed | | | | | | | in | | | | | | | seconds, | | | | | | | between | | | | | | | con | | | | | | | sumption | | | | | | | report | | | | | | | messages | | | | | | | being | | | | | | | sent by | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handler. | | | | | | | The | | | | | | | value | | | | | | | shall be | | | | | | | greater | | | | | | | than | | | | | | | zero. | | | | | | | | | | | | | | When | | | | | | | this | | | | | | | property | | | | | | | is | | | | | | | omitted, | | | | | | | a single | | | | | | | final | | | | | | | report | | | | | | | shall be | | | | | | | sent | | | | | | | imm | | | | | | | ediately | | | | | | | after | | | | | | | the | | | | | | | media | | | | | | | s | | | | | | | treaming | | | | | | | session | | | | | | | has | | | | | | | ended. | | +----------+----------+----------+-------+----------+----------+ | > * | ar | 1..1 | RO | A list | | | serverAd | ray(Abso | | | of 5GMSd | | | dresses_ | luteUrl) | | | AF | | | | | | | a | | | | | | | ddresses | | | | | | | (URLs) | | | | | | | where | | | | | | | the | | | | | | | con | | | | | | | sumption | | | | | | | r | | | | | | | eporting | | | | | | | messages | | | | | | | are sent | | | | | | | by the | | | | | | | Media | | | | | | | Session | | | | | | | Handler. | | | | | | | See | | | | | | | NOTE. | | | | | | | | | | | | | | Each | | | | | | | address | | | | | | | shall be | | | | | | | an | | | | | | | opaque | | | | | | | base | | | | | | | URL, | | | | | | | f | | | | | | | ollowing | | | | | | | the 5GMS | | | | | | | URL | | | | | | | format | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | cl | | | | | | | ause 6.1 | | | | | | | up to | | | | | | | and | | | | | | | i | | | | | | | ncluding | | | | | | | the | | | | | | | _{apiV | | | | | | | ersion}_ | | | | | | | path | | | | | | | element. | | +----------+----------+----------+-------+----------+----------+ | > _lo | boolean | 1..1 | RO | St | | | cationRe | | | | ipulates | | | porting_ | | | | whether | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handler | | | | | | | is | | | | | | | required | | | | | | | to | | | | | | | provide | | | | | | | location | | | | | | | data to | | | | | | | the | | | | | | | 5GMSd AF | | | | | | | in | | | | | | | con | | | | | | | sumption | | | | | | | r | | | | | | | eporting | | | | | | | messages | | | | | | | (in case | | | | | | | of MNO | | | | | | | or | | | | | | | trusted | | | | | | | third | | | | | | | p | | | | | | | arties). | | +----------+----------+----------+-------+----------+----------+ | > * | boolean | 1..1 | RO | St | | | accessRe | | | | ipulates | | | porting _| | | | whether | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handler | | | | | | | is | | | | | | | required | | | | | | | to | | | | | | | provide | | | | | | | con | | | | | | | sumption | | | | | | | r | | | | | | | eporting | | | | | | | messages | | | | | | | to the | | | | | | | 5GMSd AF | | | | | | | when the | | | | | | | access | | | | | | | network | | | | | | | changes | | | | | | | during a | | | | | | | media | | | | | | | s | | | | | | | treaming | | | | | | | session. | | +----------+----------+----------+-------+----------+----------+ | > _s | Pe | 1..1 | RO | The | | | amplePer | rcentage | | | pe | | | centage _| | | | rcentage | | | | | | | of media | | | | | | | s | | | | | | | treaming | | | | | | | sessions | | | | | | | that | | | | | | | shall | | | | | | | send | | | | | | | con | | | | | | | sumption | | | | | | | reports, | | | | | | | e | | | | | | | xpressed | | | | | | | as a | | | | | | | floating | | | | | | | point | | | | | | | value | | | | | | | between | | | | | | | 0.0 and | | | | | | | 100.0. | | +----------+----------+----------+-------+----------+----------+ |_ dynami | object | 0..1 | RO | | _do | | cPolicyI | | | | | wnlink,_ | | nvocatio | | | | | | | n‌Config | | | | | _uplink_ | | uration _| | | | | | +----------+----------+----------+-------+----------+----------+ | > * | ar | 1..1 | RO | A list | | | serverAd | ray(Abso | | | of 5GMSd | | | dresses_ | luteUrl) | | | AF | | | | | | | a | | | | | | | ddresses | | | | | | | (URLs) | | | | | | | which | | | | | | | offer | | | | | | | the APIs | | | | | | | for | | | | | | | dynamic | | | | | | | policy | | | | | | | in | | | | | | | vocation | | | | | | | sent by | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handler. | | | | | | | See | | | | | | | NOTE. | | | | | | | | | | | | | | Each | | | | | | | address | | | | | | | shall be | | | | | | | an | | | | | | | opaque | | | | | | | base | | | | | | | URL, | | | | | | | f | | | | | | | ollowing | | | | | | | the 5GMS | | | | | | | URL | | | | | | | format | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | cl | | | | | | | ause 6.1 | | | | | | | up to | | | | | | | and | | | | | | | i | | | | | | | ncluding | | | | | | | the | | | | | | | _{apiV | | | | | | | ersion}_ | | | | | | | path | | | | | | | element. | | +----------+----------+----------+-------+----------+----------+ | > | a | 1..1 | RO | A list | | | _validPo | rray(Res | | | of | | | licyTemp | ourceId) | | | Policy | | | lateIds_ | | | | Template | | | | | | | ide | | | | | | | ntifiers | | | | | | | which | | | | | | | the 5GMS | | | | | | | Client | | | | | | | is | | | | | | | au | | | | | | | thorized | | | | | | | to use. | | +----------+----------+----------+-------+----------+----------+ | > _sdf | array(Sd | 1..1 | RO | A list | | | Methods_ | fMethod) | | | of | | | | | | | rec | | | | | | | ommended | | | | | | | service | | | | | | | data | | | | | | | flow | | | | | | | des | | | | | | | cription | | | | | | | methods | | | | | | | (descr | | | | | | | iptors), | | | | | | | e.g. | | | | | | | 5-Tuple, | | | | | | | ToS, | | | | | | | 2-Tuple, | | | | | | | etc., | | | | | | | which | | | | | | | should | | | | | | | be used | | | | | | | by the | | | | | | | Media | | | | | | | Session | | | | | | | Handler | | | | | | | to | | | | | | | describe | | | | | | | the | | | | | | | service | | | | | | | data | | | | | | | flows | | | | | | | for the | | | | | | | traffic | | | | | | | to be | | | | | | | policed. | | +----------+----------+----------+-------+----------+----------+ | > _ext | array | 0..1 | RO | Ad | | | ernalRef | (String) | | | ditional | | | erences_ | | | | id | | | | | | | entifier | | | | | | | for this | | | | | | | Policy | | | | | | | T | | | | | | | emplate, | | | | | | | unique | | | | | | | within | | | | | | | the | | | | | | | scope of | | | | | | | its | | | | | | | Prov | | | | | | | isioning | | | | | | | Session, | | | | | | | that can | | | | | | | be | | | | | | | cross-re | | | | | | | ferenced | | | | | | | with | | | | | | | external | | | | | | | metadata | | | | | | | about | | | | | | | the | | | | | | | media | | | | | | | s | | | | | | | treaming | | | | | | | session. | | | | | | | | | | | | | | Example: | | | | | | | \"HD_Pr | | | | | | | emium\". | | +----------+----------+----------+-------+----------+----------+ | _client | array | 0..1 | RO | |_ do | | MetricsR | (Object) | | | | wnlink _, | | eporting | | | | | | | ‌Configu | | | | |_ uplink _| | rations_ | | | | | | +----------+----------+----------+-------+----------+----------+ | > _m | Re | 1..1 | RO | The | | | etricsRe | sourceId | | | id | | | porting‌ | | | | entifier | | | Configur | | | | of this | | | ationId_ | | | | metrics | | | | | | | r | | | | | | | eporting | | | | | | | config | | | | | | | uration, | | | | | | | unique | | | | | | | within | | | | | | | the | | | | | | | scope of | | | | | | | _provisi | | | | | | | oningSes | | | | | | | sionId_. | | | | | | | | | | | | | | The | | | | | | | value | | | | | | | shall be | | | | | | | the same | | | | | | | as the | | | | | | | corre | | | | | | | sponding | | | | | | | id | | | | | | | entifier | | | | | | | pro | | | | | | | visioned | | | | | | | at | | | | | | | r | | | | | | | eference | | | | | | | p | | | | | | | oint M1. | | +----------+----------+----------+-------+----------+----------+ | > * | ar | 1..1 | RO | A list | | | serverAd | ray(Abso | | | of 5GMS | | | dresses _| luteUrl) | | | AF | | | | | | | a | | | | | | | ddresses | | | | | | | to which | | | | | | | metrics | | | | | | | reports | | | | | | | shall be | | | | | | | sent. | | | | | | | See | | | | | | | NOTE. | | | | | | | | | | | | | | Each | | | | | | | address | | | | | | | shall be | | | | | | | an | | | | | | | opaque | | | | | | | base | | | | | | | URL, | | | | | | | f | | | | | | | ollowing | | | | | | | the 5GMS | | | | | | | URL | | | | | | | format | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | cl | | | | | | | ause 6.1 | | | | | | | up to | | | | | | | and | | | | | | | i | | | | | | | ncluding | | | | | | | the | | | | | | |_{apiV | | | | | | | ersion}_| | | | | | | path | | | | | | | element. | | +----------+----------+----------+-------+----------+----------+ | > | Uri | 1..1 | RO | A URI | | | _scheme _| | | | ide | | | | | | | ntifying | | | | | | | the | | | | | | | metrics | | | | | | | r | | | | | | | eporting | | | | | | | scheme | | | | | | | that | | | | | | | metrics | | | | | | | reports | | | | | | | shall | | | | | | | use (see | | | | | | | clause | | | | | | | 4.7.5). | | +----------+----------+----------+-------+----------+----------+ | > * | Dnn | 0..1 | RO | The name | | | dataNetw | | | | of the | | | orkName_ | | | | Data | | | | | | | Network | | | | | | | which | | | | | | | shall be | | | | | | | used to | | | | | | | send | | | | | | | metrics | | | | | | | reports. | | | | | | | If not | | | | | | | sp | | | | | | | ecified, | | | | | | | the name | | | | | | | of the | | | | | | | default | | | | | | | DN shall | | | | | | | be used. | | +----------+----------+----------+-------+----------+----------+ | > _re | Dur | 0..1 | RO | The time | | | portingI | ationSec | | | i | | | nterval_ | | | | nterval, | | | | | | | e | | | | | | | xpressed | | | | | | | in | | | | | | | seconds, | | | | | | | between | | | | | | | metrics | | | | | | | reports | | | | | | | being | | | | | | | sent by | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handler. | | | | | | | The | | | | | | | value | | | | | | | shall be | | | | | | | greater | | | | | | | than | | | | | | | zero. | | | | | | | | | | | | | | When | | | | | | | this | | | | | | | property | | | | | | | is | | | | | | | omitted, | | | | | | | a single | | | | | | | final | | | | | | | report | | | | | | | shall be | | | | | | | sent | | | | | | | imm | | | | | | | ediately | | | | | | | after | | | | | | | the | | | | | | | media | | | | | | | s | | | | | | | treaming | | | | | | | session | | | | | | | has | | | | | | | ended. | | +----------+----------+----------+-------+----------+----------+ | > _s | Pe | 1..1 | RO | The | | | amplePer | rcentage | | | pe | | | centage_ | | | | rcentage | | | | | | | of media | | | | | | | s | | | | | | | treaming | | | | | | | sessions | | | | | | | that | | | | | | | shall | | | | | | | report | | | | | | | metrics, | | | | | | | e | | | | | | | xpressed | | | | | | | as a | | | | | | | floating | | | | | | | point | | | | | | | value | | | | | | | between | | | | | | | 0.0 and | | | | | | | 100.0. | | +----------+----------+----------+-------+----------+----------+ | > _url | array | 0..1 | RO | A | | | Filters_ | (String) | | | n | | | | | | | on-empty | | | | | | | list of | | | | | | | Media | | | | | | | Entry | | | | | | | Point | | | | | | | URL | | | | | | | patterns | | | | | | | for | | | | | | | which | | | | | | | metrics | | | | | | | r | | | | | | | eporting | | | | | | | shall be | | | | | | | done. | | | | | | | The | | | | | | | format | | | | | | | of each | | | | | | | pattern | | | | | | | shall be | | | | | | | a | | | | | | | regular | | | | | | | ex | | | | | | | pression | | | | | | | as | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | [5]. | | | | | | | | | | | | | | If not | | | | | | | sp | | | | | | | ecified, | | | | | | | r | | | | | | | eporting | | | | | | | shall be | | | | | | | done for | | | | | | | all | | | | | | | media | | | | | | | s | | | | | | | treaming | | | | | | | s | | | | | | | essions. | | +----------+----------+----------+-------+----------+----------+ | > | Dur | 1..1 | RO | The time | | | _samplin | ationSec | | | interval | | | gPeriod_ | | | | the | | | | | | | 5GM | | | | | | | S Client | | | | | | | should | | | | | | | wait | | | | | | | between | | | | | | | sampling | | | | | | | the QoE | | | | | | | metrics | | | | | | | s | | | | | | | pecified | | | | | | | by this | | | | | | | metrics | | | | | | | r | | | | | | | eporting | | | | | | | config | | | | | | | uration. | | +----------+----------+----------+-------+----------+----------+ | > * | array | 1..1 | RO | A list | | | metrics _| (String) | | | of | | | | | | | metrics | | | | | | | which | | | | | | | shall be | | | | | | | r | | | | | | | eported. | | | | | | | | | | | | | | If | | | | | | | empty, | | | | | | | the | | | | | | | complete | | | | | | | (or | | | | | | | default | | | | | | | if | | | | | | | app | | | | | | | licable) | | | | | | | set of | | | | | | | metrics | | | | | | | as | | | | | | | sociated | | | | | | | with the | | | | | | | s | | | | | | | pecified | | | | | | |_ scheme _| | | | | | | shall be | | | | | | | c | | | | | | | ollected | | | | | | | and | | | | | | | r | | | | | | | eported. | | +----------+----------+----------+-------+----------+----------+ | * | object | 0..1 | RO | |_ do | | networkA | | | | | wnlink _, | | ssistanc | | | | | | | e‌Config | | | | |_ uplink _| | uration_ | | | | | | +----------+----------+----------+-------+----------+----------+ | > * | ar | 1..1 | RO | A list | | | serverAd | ray(Abso | | | of | | | dresses _| luteUrl) | | | 5GMS AF | | | | | | | a | | | | | | | ddresses | | | | | | | (URLs) | | | | | | | that | | | | | | | offer | | | | | | | the APIs | | | | | | | for | | | | | | | 5GMS | | | | | | | AF-based | | | | | | | Network | | | | | | | Ass | | | | | | | istance, | | | | | | | for | | | | | | | access | | | | | | | by the | | | | | | | 5GMSd | | | | | | | Media | | | | | | | Session | | | | | | | Handler. | | | | | | | See | | | | | | | NOTE. | | | | | | | | | | | | | | Each | | | | | | | address | | | | | | | shall be | | | | | | | an | | | | | | | opaque | | | | | | | URL, | | | | | | | f | | | | | | | ollowing | | | | | | | the 5GMS | | | | | | | URL | | | | | | | format | | | | | | | s | | | | | | | pecified | | | | | | | in | | | | | | | cl | | | | | | | ause 6.1 | | | | | | | up to | | | | | | | and | | | | | | | i | | | | | | | ncluding | | | | | | | the | | | | | | |_{apiV | | | | | | | ersion}* | | | | | | | path | | | | | | | element. | | +----------+----------+----------+-------+----------+----------+ | NOTE: In | | | | | | | dep | | | | | | | loyments | | | | | | | where | | | | | | | multiple | | | | | | | i | | | | | | | nstances | | | | | | | of the | | | | | | | 5GMSd AF | | | | | | | expose | | | | | | | the | | | | | | | Media | | | | | | | Session | | | | | | | Handling | | | | | | | APIs at | | | | | | | M5, the | | | | | | | 5G | | | | | | | System | | | | | | | may use | | | | | | | a | | | | | | | suitable | | | | | | | m | | | | | | | echanism | | | | | | | (e.g. | | | | | | | HTTP | | | | | | | load | | | | | | | b | | | | | | | alancing | | | | | | | or | | | | | | | D | | | | | | | NS-based | | | | | | | host | | | | | | | name | | | | | | | res | | | | | | | olution) | | | | | | | to | | | | | | | direct | | | | | | | requests | | | | | | | to a | | | | | | | suitable | | | | | | | AF | | | | | | | i | | | | | | | nstance. | | | | | | +----------+----------+----------+-------+----------+----------+
### 11.2.4 Operations
This clause defines the behaviour that is expected from the 5GMS AF when a
Service Access Information resource is acquired by the Media Session Handler.
The main operation that is performed is to look up or generate the Service
Access Information corresponding to the requested Provisioning Session.
## 11.3 Consumption Reporting API
### 11.3.1 General
The Consumption Reporting API allows the Media Session Handler to report
downlink media consumption to the 5GMSd AF. The API defines data models,
resources and the related procedures for the creation and management of the
consumption reporting procedures. This procedure is configured by the
_ServiceAccessInformation_ resource, as defined in clause 11.2.3.
### 11.3.2 Reporting procedure
Consumption reports shall be submitted to a 5GMSd AF endpoint according to the
following general URL format:
_{apiRoot}_ /3gpp-m5 _/{apiVersion}/_ consumption-
reporting/_{provisioningSessionId}_
where the first three elements shall be substituted by the 5GMSd Client with
one of the base URLs selected from the
_client‌Consumption‌Reporting‌Configuration.‌serverAddresses_ array of the
_ServiceAccessInformation_ resource (see clause 11.2.3.1) and
_{provisioningSessionId}_ shall be substituted with the relevant Provisioning
Session identifier obtained from Service Access Information (see clause
11.2.3).
The only HTTP method supported by this endpoint is POST.
### 11.3.3 Report format
#### 11.3.3.1 ConsumptionReport format
This type represents the format of consumption report instance. This structure
is used by the Media Session Handler to report the consumption.
Table 11.3.3.1-1: Definition of ConsumptionReport format
+-----------------+-----------------+-------------+-----------------+ | Property name | Data type | Cardinality | Description | +=================+=================+=============+=================+ | _me | AbsoluteUrl | 1..1 | Identifies the | | diaPlayerEntry_ | | | Media Entry | | | | | Point. | | | | | | | | | | In the case of | | | | | DASH, thisshall | | | | | be the URL of | | | | | the MPD at | | | | | reference point | | | | | M4d. | +-----------------+-----------------+-------------+-----------------+ | _rep | string | 1..1 | Identifier of | | ortingClientId_ | | | the reporting | | | | | client that | | | | | consumed the | | | | | streaming media | | | | | service | | | | | associated with | | | | | this | | | | | consumption | | | | | report. | | | | | | | | | | If available to | | | | | the Media | | | | | Session | | | | | Handler, a GPSI | | | | | value (see | | | | | clause 28.8 of | | | | | TS 23.003 | | | | | [7]); | | | | | otherwise, a | | | | | stable and | | | | | globally unique | | | | | string. | +-----------------+-----------------+-------------+-----------------+ | _consumption | Arr | 1..1 | An array of | | ReportingUnits_ | ay(Consumption‌ | | consumption | | | Reporting‌Unit) | | reporting | | | | | units. | +-----------------+-----------------+-------------+-----------------+
#### 11.3.3.2 ConsumptionReportingUnit type
This type represents a single consumption reporting unit.
Table 11.3.3.2-1: Definition of type ConsumptionReportingUnit
+-----------------+-----------------+-------------+-----------------+ | Attribute name | Data type | Cardinality | Description | +=================+=================+=============+=================+ | _mediaConsumed_ | string | 1..1 | Identifies the | | | | | media consumed. | | | | | | | | | | In the case of | | | | | DASH, the value | | | | | of the | | | | | **Repre | | | | | sentation** \@id | | | | | attribute shall | | | | | be quoted. | +-----------------+-----------------+-------------+-----------------+ | _startTime_ | DateTime | 1..1 | The time when | | | | | this | | | | | consumption | | | | | reporting unit | | | | | started. | +-----------------+-----------------+-------------+-----------------+ | _duration_ | DurationSec | 1..1 | The duration of | | | | | this | | | | | consumption | | | | | reporting unit. | +-----------------+-----------------+-------------+-----------------+ | _locations_ | Array | 0..1 | Identifies the | | | (TypedLocation) | | UE location(s) | | | | | where the media | | | | | was consumed if | | | | | location | | | | | reporting is | | | | | enabled in the | | | | | Consumption | | | | | Reporting | | | | | Configuration | | | | | (only for | | | | | trusted AF). | | | | | | | | | | The cardinality | | | | | of objects in | | | | | this array is | | | | | 1..N. | +-----------------+-----------------+-------------+-----------------+
## 11.4 Metrics Reporting API
### 11.4.1 General
The Metrics Reporting API allows the Media Session Handler to send QoE metrics
reports to the 5GMS AF. This procedure is configured by the
_ServiceAccessInformation_ resource, as defined in clause 11.2.3. Note that
multiple metrics configurations can be active at the same time, each
identified by a unique _metricsReportingConfigurationId_.
### 11.4.2 Reporting procedure
Metrics reports related to a specific _metricsReportingConfigurationId_ shall
be submitted according to the following general format:
{apiRoot}/3gpp-m5 _/_{apiVersion}_/_ metrics-
reporting/‌{provisioningSessionId}/‌{metricsReporting‌ConfigurationId}
where the first three elements shall be substituted by the 5GMS Client with
one of the base URLs selected from the
_client‌Metrics‌Reporting‌Configurations.serverAddresses_ array of the
_ServiceAccessInformation_ resource (see clause 11.2.3.1),
_{provisioning‌Session‌Id}_ shall be substituted with the relevant
Provisioning Session identifier obtained from Service Access Information (see
clause 11.2.3) and _{metricsReportingConfigurationId}_ shall be substituted
with the relevant Metrics Reporting Configuration identifier.
The only HTTP method supported by this endpoint is POST.
### 11.4.3 Report format
Metrics reports shall be submitted by the Media Session Handler in a format
specified by the metrics reporting scheme in question. The Content-Type HTTP
request header shall be set in accordance with the relevant metrics reporting
scheme specification.
NOTE: For downlink media streaming, TS 26.247 [7] clauses 10.6.1 and 10.6.2
specify the required MIME content type and metrics report format for the 3GPP
_urn:‌3GPP:‌ns:‌PSS:‌DASH:‌QM10_ metrics reporting scheme. For virtual reality
media the report format is further extended as defined in TS 26.118 [42]
clause 9.4.
In XML documents representing metrics reports for 3GP-DASH downlink media
streaming services, the **ReceptionReport** \@clientID attribute, if present
and is available to the Media Session Handler, should be a GPSI value as
defined by TS 23.003 [7]. Otherwise, this attribute should be represented by a
stable and globally unique string.
## 11.5 Dynamic Policies API
### 11.5.1 Overview
The Dynamic Policies API allows the Media Session Handler to request a
specific policy and charging treatment to be applied to a particular
application data flow of a downlink or uplink media streaming session by
invoking RESTful operations on the 5GMS AF at interface M5. The API defines a
set of data models, resources and the related procedures for the creation and
management of the dynamic policy request.
Application Identifiers, referring to one or more Packet Flow Description
(PFD), may be used as alternative traffic filtering parameters for dynamic
policy invocation. The 5GMSd AF shall first provision a PFD in the PFDF for
one or more (external) Application IDs by sending an HTTP POST message to the
NEF as specified in clause 4.4.10 of TS 29.122 [12]. The mapping between the
(external) Application Identifiers and PFDs stored in the PFDF will then be
pushed to or pulled from the SMF and installed in the UPF for future traffic
identifications.
NOTE: The PFDF is a functionality within the NEF.
### 11.5.2 Resource structure
The Dynamic Policies API is accessible through the following URL base path:
_{apiRoot}_ /3gpp-m5 _/_ v1 _/_ dynamic-policies/
where the first three elements shall be substituted by the 5GMS Client with
one of the URLs selected from the
_dynamicPolicy‌Invocation‌Configuration.serverAddresses_ array of the
_ServiceAccessInformation_ resource (see clause 11.2.3.1).
Table 11.5.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. The sub-resource path specified in the
second column shall be appended to the URL base path.
Table 11.5.2-1: Operations supported by the Dynamic Policies API
+----------------+----------------+----------------+----------------+ | Resource name | Sub-resource | Allowed HTTP | Description | | | path | methods | | +================+================+================+================+ | Dynamic | | POST | Create a new | | Policies | | | Dynamic Policy | | | | | resource. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created | | | | | Dynamic Policy | | | | | Instance | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response. | +----------------+----------------+----------------+----------------+ | Dynamic Policy | _{dyn | GET | Retrieve an | | | amicPolicyId}_ | | existing | | | | | Dynamic Policy | | | | | resource. | +----------------+----------------+----------------+----------------+ | | | PUT | Replace an | | | | | existing | | | | | Dynamic Policy | | | | | resource. | +----------------+----------------+----------------+----------------+ | | | PATCH | Modify an | | | | | existing | | | | | Dynamic Policy | | | | | resource. | +----------------+----------------+----------------+----------------+ | | | DELETE | Delete an | | | | | existing | | | | | Dynamic Policy | | | | | resource. | +----------------+----------------+----------------+----------------+
### 11.5.3 Data model
#### 11.5.3.1 DynamicPolicy resource
The _DynamicPolicy_ resource is specified in table 11.5.3.1-1 below.
Table 11.5.3.1-1: Definition of Dynamic Policy resource
+--------------+--------------+-------------+--------+--------------+ | Property | Data type | Cardinality | Usage | Description | | name | | | | | +==============+==============+=============+========+==============+ | _dyna | ResourceId | 1..1 | RO | Unique | | micPolicyId_ | | | | identifier | | | | | | for this | | | | | | Dynamic | | | | | | Policy. | +--------------+--------------+-------------+--------+--------------+ | _polic | ResourceId | 1..1 | C: RW\ | Identifies | | yTemplateId_ | | | R: RO\ | the Policy | | | | | U: RW | Template | | | | | | which should | | | | | | be applied | | | | | | to the | | | | | | application | | | | | | flow(s). | +--------------+--------------+-------------+--------+--------------+ | _serv | array(Servic | 1..1 | C: RW\ | Describes | | iceDataFlowD | e‌Data‌Flow‌ | | R: RO\ | the service | | escriptions_ | Description) | | U: RW | data flows | | | | | | managed by | | | | | | this Dynamic | | | | | | Policy. | +--------------+--------------+-------------+--------+--------------+ | _mediaType_ | MediaType | 0..1 | C: RW\ | The type of | | | | | R: RO\ | media | | | | | U: RW | carried by | | | | | | the | | | | | | application | | | | | | flows listed | | | | | | in | | | | | | _service | | | | | | ‌DataFlow‌De | | | | | | scriptions_. | +--------------+--------------+-------------+--------+--------------+ | _provisioni | ResourceId | 1..1 | C: RW\ | Provisioning | | ngSessionId_ | | | R: RO\ | Session | | | | | U: RW | identifier | | | | | | obtained | | | | | | from Service | | | | | | Access | | | | | | Information | | | | | | (see | | | | | | cla | | | | | | use 11.2.3). | | | | | | | | | | | | Uniquely | | | | | | identifies | | | | | | Provisioning | | | | | | Session, | | | | | | which is | | | | | | linked to | | | | | | the | | | | | | Application | | | | | | Service | | | | | | Provider. | +--------------+--------------+-------------+--------+--------------+ | _qosSp | M5‌QoS‌S | 0..1 | C: RW\ | Describes | | ecification_ | pecification | | R: RO\ | the network | | | | | U: RW | Quality of | | | | | | Service | | | | | | properties | | | | | | of this | | | | | | Dynamic | | | | | | Policy. | +--------------+--------------+-------------+--------+--------------+ | _enforc | string | 0..1 | C: RO\ | Description | | ementMethod_ | | | R: RO\ | of the | | | | | U: RO | Policy | | | | | | Enforcement | | | | | | Method. The | | | | | | parameter is | | | | | | set by the | | | | | | 5GMSd AF. | +--------------+--------------+-------------+--------+--------------+ | _enforce | integer | 0..1 | C: RO\ | Description | | mentBitRate_ | | | R: RO\ | of the | | | | | U: RO | enforcement | | | | | | bit rate. | +--------------+--------------+-------------+--------+--------------+
### 11.5.4 Operations
This clause defines the behaviour that is expected when activating a Dynamic
Policy Instance.
The _policyTemplateId_ property uniquely identifies the Policy Template with
which the Dynamic Policy Instance is associated.
The _provisioningSessionId_ property associates the Dynamic Policy Instance
with a Provisioning Session.
The Dynamic Policy resource contains a _serviceDataFlowDescriptions_ property
which contains a set of service data flow templates according to TS 23.503
[33]. Each service data flow template contains one of:
\- a _flowDescription_ object (including 5-tuples, Type of Service, Security
Parameter Index, etc.).
\- a _domainName._
When the Media Session Handler is attempting to activate a QoS-related Dynamic
Policy Template, then the _qosSpecification_ property shall be present and it
shall contain the following properties:
\- _marBwDlBitRate_ or _marBwUlBitRate_ , indicating the maximum requested bit
rate by the Media Session Handler.
\- _mirBwDlBitRate_ or _mirBwUlBitRate_ , indicating the minimum requested bit
rate by the Media Session Handler.
\- _minDesBwDlBitRate_ or _minDesBwUlBitrate_ , indicating the minimum bit
rate desired by the Media Session Handler.
When the 5G System employs a traffic enforcement function to ensure that the
traffic is complying a certain traffic policy, the Dynamic Policy resource may
contain the following two properties:
\- an _enforcementMethod_ , indicating the type of enforcement method (like
leaky bucket).
\- an _enforcementBitrate_ property, indicating the maximal permitted bit
rate.
## 11.6 Network Assistance API
### 11.6.1 Overview
If AF-based Network Assistance is supported, then the Network Assistance API
component of interface M5, as defined in the present sub-clause, is first used
to provision a Network Assistance Session resource. The Network Assistance
Resource can then be used to obtain bit rate recommendations and to issue
delivery boost requests during the ongoing media streaming session.
### 11.6.2 Resource structure
The Network Assistance API is accessible via the following URL base path:
_{apiRoot}_ /3gpp‑m5 _/_ v1 _/_ network-assistance/
where the first three elements shall be substituted by the 5GMS Client with
one of the URLs selected from the
_network‌Assistance‌Configuration.serverAddresses_ array of the
_ServiceAccessInformation_ resource (see clause 11.2.3.1).
Table 11.6.2‑1 below specifies the operations and the corresponding HTTP
methods that are supported by this API. In each case, the sub-resource path
specified in the second column of the table shall be appended to the URL base
path.
Table 11.6.2-1: Operations supported by the Network Assistance API
+----------------+----------------+----------------+----------------+ | Operation | Sub‑resource | Allowed HTTP | Description | | | path | method(s) | | +================+================+================+================+ | Create Network | | POST | Provision a | | Assistance | | | new Network | | Session | | | Assistance | | resource | | | Session. | | | | | | | | | | If the | | | | | operation | | | | | succeeds, the | | | | | URL of the | | | | | created | | | | | Network | | | | | Assistance | | | | | Session | | | | | resource shall | | | | | be returned in | | | | | the Location | | | | | header of the | | | | | response. | +----------------+----------------+----------------+----------------+ | Fetch a | * | GET | Fetch the | | Network | {naSessionId}_| | properties of | | Assistance | | | an existing | | Session | | | Network | | resource | | | Assistance | | | | | Session. | +----------------+----------------+----------------+----------------+ | Update a | * | PUT, | Update the | | Network | {naSessionId}_ | | properties of | | Assistance | | PATCH | an existing | | Session | | | Network | | resource | | | Assistance | | | | | Session. | +----------------+----------------+----------------+----------------+ | Request a bit | _{ | GET | Obtain a bit | | rate | naSessionId}_ / | | rate | | recommendation | recommendation | | recommendation | | | | | for the next | | | | | recommendation | | | | | window. | +----------------+----------------+----------------+----------------+ | Request a | * | POST | Request a | | delivery boost | {naSessionId}_| | delivery boost | | | /boost-request | | for the next | | | | | recommendation | | | | | window. | +----------------+----------------+----------------+----------------+ | Terminate | * | DELETE | Terminate a | | Network | {naSessionId}_ | | Network | | Assistance | | | Assistance | | Session | | | session. | +----------------+----------------+----------------+----------------+
### 11.6.3 Data model
#### 11.6.3.1 NetworkAssistanceSession resource
The _NetworkAssistanceSession_ resource is specified in table 11.6.3.1-1
below.
Table 11.6.3.1-1: Definition of NetworkAssistanceSession resource
+--------------+--------------+-------------+--------+--------------+ | Property | Type | Cardinality | Usage | Description | | name | | | | | +==============+==============+=============+========+==============+ | * | ResourceId | 1..1 | C: RO | Unique | | naSessionId _| | | | identifier | | | | | R: RO | for this | | | | | | Network | | | | | U: RO | Assistance | | | | | | Session. | +--------------+--------------+-------------+--------+--------------+ |_ provisioni | ResourceId | 1..1 | C: RW\ | Provisioning | | ngSessionId _| | | R: RO\ | Session | | | | | U: RW | identifier | | | | | | obtained | | | | | | from Service | | | | | | Access | | | | | | Information | | | | | | (see | | | | | | cla | | | | | | use 11.2.3). | | | | | | | | | | | | Uniquely | | | | | | identifies | | | | | | Provisioning | | | | | | Session, | | | | | | which is | | | | | | linked to | | | | | | the | | | | | | Application | | | | | | Service | | | | | | Provider. | +--------------+--------------+-------------+--------+--------------+ |_ serv | array(Ser | 1..1 | C: RW | Identifying | | iceDataFlowD | viceDataFlow | | | one or more | | escriptions _| Description) | | R: RO | application | | | | | | flows for | | | | | U: RW | which | | | | | | Network | | | | | | Assistance | | | | | | is sought, | | | | | | e.g. 2-tuple | | | | | | (IP | | | | | | addresses) | | | | | | or 5-tuple | | | | | | (IP | | | | | | Addresses, | | | | | | protocol and | | | | | | ports). | +--------------+--------------+-------------+--------+--------------+ |_ mediaType _| MediaType | 0..1 | C: RW | The type of | | | | | | media | | | | | R: RO | carried by | | | | | | the | | | | | U: RW | application | | | | | | flows listed | | | | | | in | | | | | |_ service | | | | | | ‌DataFlow‌De | | | | | | scriptions _. | +--------------+--------------+-------------+--------+--------------+ |_ polic | ResourceId | 0..1 | C: RW | Id | | yTemplateId _| | | | entification | | | | | R: RO | of the | | | | | | policy (if | | | | | U: RW | any) that is | | | | | | in force for | | | | | | the media | | | | | | streaming | | | | | | session. | +--------------+--------------+-------------+--------+--------------+ |_ r | M5QoSS | 0..1 | C: RW | The | | equestedQoS _| pecification | | | requested | | | | | R: RO | QoS | | | | | | parameters. | | | | | U: RW | | +--------------+--------------+-------------+--------+--------------+ |_ rec | M5QoSS | 0..1 | C: RO | The QoS | | ommendedQoS _| pecification | | | parameters | | | | | R: RO | currently | | | | | | recommended | | | | | U: RO | by the 5GMS | | | | | | AF. | +--------------+--------------+-------------+--------+--------------+ |_ not | AbsoluteUrl | 0..1 | C: RO | A URL to the | | ficationURL _| | | | MQTT channel | | | | | R: RO | over which | | | | | | n | | | | | U: RO | otifications | | | | | | are to be | | | | | | sent by the | | | | | | 5GMS AF for | | | | | | this | | | | | | session. | | | | | | | | | | | | When set, | | | | | | the Media | | | | | | Session | | | | | | Handler | | | | | | shall | | | | | | subscribe to | | | | | | this | | | | | | channel. The | | | | | | notification | | | | | | messages | | | | | | shall be in | | | | | | the form of | | | | | | the | | | | | |_ M5QoSSp | | | | | | ecification* | | | | | | data type. | +--------------+--------------+-------------+--------+--------------+
### 11.6.4 Operations
#### 11.6.4.1 Create Network Assistance session
This clause defines the behaviour that is expected when creating a Network
Assistance session.
The Media Session Handler uses the POST HTTP method to create a Network
Assistance session with the 5GMS AF. The request includes a
_NetworkAssistanceSession_ resource representation in the message body.
The _provisioningSessionId_ property associates the Network Assistance session
with a Provisioning Session.
The Media Session Handler populates the _NetworkAssistanceSession_ resource
representation in the request with service data flow information and
optionally the Policy Template identifier of the network QoS policy currently
in force on the media streaming session for which Network Assistance
operations are to be performed. (The 5GMS AF subsequently uses this
information to execute Network Assistance operations in the 5GC.)
The _serviceDataFlowDescriptions_ property contains a set of service data flow
templates according to TS 23.503 [33]. Each service data flow template
contains one of:
\- a _flowDescription_ object (including 5-tuples, Type of Service, Security
Parameter Index, etc.).
\- a _domainName._
The _requestedQoS_ property is used by the Media Session Handler to specify a
network QoS it initially wishes to use for the media streaming session. If the
_policyTemplateId_ property is also populated in the
_NetworkAssistanceSession_ resource, the 5GMS AF shall return a _400 Bad
Request_ HTTP response message if the requested network QoS lies outside the
limits specified in the referenced Policy Template.
If the _requestedQoS_ property is omitted from the _NetworkAssistanceSession_
resource but the _policyTemplateId_ is populated, the 5GMS AF shall use the
network QoS currently provisioned in the referenced Policy Template as the
floor/ceiling for bit rate recommendations and delivery boosts within the
scope of the Network Assistance session.
If neither a _policyTemplateId_ nor a _requestedQoS_ are supplied when
creating a Network Assistance session, operations invoked on the 5GMS AF
within the scope of the Network Assistance session are constrained only by the
policies of the PCF.
The 5GMS AF returns the Network Assistance session identifier if session setup
was successful, otherwise an error code is returned without a Network
Assistance session identifier.
The 5GMS Client uses the Network Assistance session resource identifier
(_naSessionId_) provided by the 5GMS AF to refer all subsequent API calls to
the 5GMS AF applicable to that Network Assistance session.
#### 11.6.4.2 Retrieve Network Assistance session
The 5GMS Client uses the GET HTTP method with the Network Assistance Session
resource identifier to retrieve a Network Assistance Session resource from the
5GMS AF. The 5GMS AF returns the Network Assistance Session resource if
retrieval was successful, otherwise an appropriate error code is returned
without the session resource in case of failure.
#### 11.6.4.3 Request bit rate recommendation
The Media Session Handler uses the GET HTTP method with the sub-resource path
specified in table 11.6.2‑1 to request a bit rate recommendation from the 5GMS
AF. The 5GMS AF shall return the recommended bit rate in an HTTP response body
of type _M5QoSSpecification_ if a bit rate recommendation could be obtained,
otherwise an appropriate HTTP error code shall be returned with no response
body.
\- For a downlink media streaming session, the recommended minimum and maximum
downlink bit rates shall be indicated in the properties _mirBwDlBitRate_ and
_marBwDlBitRate_ respectively. The 5GMSd Client shall ignore the mandatory
properties related to uplink streaming, i.e. _mirBwUlBitRate_ and
_marBwUlBitRate_.
\- For an uplink media streaming session, the recommended minimum and maximum
uplink bit rates shall be indicated in the properties _mirBwUlBitRate_ and
_marBwUlBitRate_ , respectively. The 5GMSu Client shall ignore the mandatory
properties related to downlink streaming, i.e. _mirBwDlBitRate_ and
_marBwDlBitRate_.
If a unique recommendation is given by the 5GMS AF then this recommended bit
rate shall be set in both of these properties. The optional properties
_minDesBwDlBitRate_ , _minDesBwUlBitRate_ , _desLatency_ and _desLoss_ shall
not be included in the response.
#### 11.6.4.4 Request delivery boost
The Media Session Handler uses the POST HTTP method with the sub-resource path
specified in table 11.6.2‑1 to request a delivery boost from the 5GMS AF. The
5GMS AF shall respond with the _OperationSuccessResponse_ data type indicating
whether or not the delivery boost will be attempted by the network within an
upcoming nominal time period.
#### 11.6.4.5 Update Network Assistance session
The Media Session Handler uses the PUT or PATCH HTTP methods to replace the
existing steaming session parameters with new settings. For example, any
change to the Policy Template currently in force resulting from an invocation
of the Dynamic Policies API (see clause 11.5) should also be notified to the
5GMS AF using this operation if a Network Assistance session has been created
for the media streaming session in question.
The 5GMS AF returns the _NetworkAssistanceSession_ resource with settings
resulting from the PUT or PATCH update operation.
#### 11.6.4.6 Destroy Network Assistance session
The Media Session Handler uses the DELETE HTTP method to terminate the
indicated Network Assistance session. The 5GMS AF returns an appropriate
response code. If the termination was successful, then any subsequent calls
referring to the terminated session will result in the error _404 (Not
Found)_.
# 12 UE Media Session Handling (M6) APIs for uplink and downlink
## 12.1 General
This clause defines the client APIs for Media Session Handling to be used by
other 5G System components such as a Media Player in a 5GMSd client or the
Media Streamer in a 5GMSu client.
## 12.2 Media Session Handling for Downlink media streaming -- APIs and
Functions
### 12.2.1 Overview
In the following, it is assumed that the Media Session Handler for downlink
media streaming adheres to a basic set of functionalities as shown in Figure
12.2.1-1.
Figure 12.2.1-1: Usage of M6d in Media Downlink Streaming
The Media Session Handler is considered to run as a service in the background,
and is invoked for a media session once a media player in the 5GMSd streaming
client is activated with an MPD URL of media MIME type
\"application/dash+xml\". Based on the MPD URL, the Media Session Handler may
initiate communication with the 5GMSd AF through M5d.
NOTE: The initiation of the Media Session Handler for other media types than
DASH is for further study.
For an ongoing 5G Media Streaming session, the Media Session Handler is given
the following authorizations:
> 1) The ability to do status query on M7d. For details see clause 13.
>
> 2) The ability to process notifications and error on M7d. For details see
> clause 13.
>
> 3) The ability to configure certain parameters on the media player based on
> M7d. For details again see clause 13.
In addition, the MSH can provide information on M6d to the application and
possibly delegated to Media Player using M6d for each of the Media Session
Handler functionalities, namely providing:
> 1) Notification and Error Events;
>
> 2) Status Information.
### 12.2.2 Media Session Handler model
#### 12.2.2.1 State model
An informative state model for the Media Session Handler is for further study.
#### 12.2.2.2 Media Session Handler internal properties
The Media Session Handler maintains internal properties as defined Table
12.2.2.2-1. Note that the parameters are conceptual and internal and only
serve for the purpose to describe message generation on the API calls.
Table 12.2.2.2-1: Parameters of Media Session Handler
States and Parameters Definition
* * *
__Configuration_  
__networkAssistance_ Network Assistance configuration. __policyTemplate_
Policy Template configuration. __consumptionReporting_ Consumption reporting
configuration. __metricsReporting_ Metrics reporting configuration.
__status[]_ The Media Session Handler maintains a status record.
#### 12.2.2.3 Media Session Handler internal operations
This aspect is for further study.
#### 12.2.2.4 Starting and Stopping a Media Session Handler
There are different ways to start a Media Session Handler. The most typical
one is that the start is bound to the call of a Media Player with an MPD URL.
That start method offers a client--server like interface realized by M6d. The
service is bound such that the Media Session Handler communicates back to the
Media Player.
### 12.2.3 General
Table 12.2.3-1 provides a list status information that can be obtained from
the Media Session Handler through reference point M6d.
Table 12.2.3-1: General Status Information
Status Type Parameter Definition
* * *
Table 12.2.3-2 provides a list of general notification events exposed at
reference point M6d.
Table 12.2.3-2: General Notification Events
Event Definition Payload
* * *
_SESSION_HANDLING_ACTIVATED_ Triggered when media session handling was
activated for a specific Media Entry Point. Media Entry Point URL.
_SESSION_HANDLING_STOPPED_ Triggered when media session handling stopped for a
specific Media Entry Point. Media Entry Point URL.
Table 12.2.3-3 provides a list of general error events exposed at reference
point M6d.
Table 12.2.3-3: General Error Events
Status Definition Payload
* * *
_ERROR_SESSION_HANDLING_ Triggered when there is an error in the media session
handling. Not applicable.
### 12.2.4 Dynamic Policy Information
Details are for further study.
### 12.2.5 Network Assistance Information
Details are for further study.
### 12.2.6 Consumption Reporting Information
Table 12.2.6-1 provides a list status information that can be obtained from
the Media Session Handler through reference point M6d.
Table 12.2.6-1: Status Information relating to Consumption Reporting
Status Type Parameter Definition
* * *
_consumptionReport_ Object The most recently sent consumption report.
Table 12.2.6-2 provides a list of general notification events exposed by the
Media Session Handler at reference point M6d.
Table 12.2.6-2: Notification Events relating to Consumption Reporting
Status Definition Payload
* * *
_CONSUMPTION_REPORTING_ACTIVATED_ Consumption reporting has been activated.
Not applicable. _CONSUMPTION_REPORTING_STOPPED_ Consumption reporting has been
stopped. Not applicable. _NEW_CONSUMPTION_REPORT_ A new consumption report is
available and has been sent. Not applicable.
Table 12.2.6-3 provides a list of general error events exposed by the Media
Session Handler at reference point M6d.
Table 12.2.6-3: Error Events relating to Consumption Reporting
* * *
Status Definition Payload
* * *
_ERROR_CONSUMPTION_REPORTING_ Error in consumption reporting occurred. Server
address,\ Provisioning Session Id,\ HTTP response code\ Error message.
* * *
### 12.2.7 Metrics Reporting Information
Table 12.2.7-1 provides a list of status information that can be obtained from
the Media Session Handler through M6d.
Table 12.2.7-1: Status Information relating to Metrics Reporting
Status Type Definition
* * *
_lastMetricsReport_ Object Status information relating to the last sent
metrics report. _provisioningSessionId_ ResourceId The Provisioning Seession
identifier for this metrics report. _metricsReportingConfigurationId_
ResourceId The metrics reporting configuration identifier for this report.
_scheme_ Uri The metrics reporting scheme used by this metrics report (see
clause 4.7.5). _metricsReport_ Object The most recently sent metrics report.
Table 12.2.7-2 provides a list of general notification events exposed at
reference point M6d.
Table 12.2.7-2: Notification Events relating to Metrics Reporting
Event Definition Payload
* * *
_METRICS_REPORTING_ACTIVATED_ Metrics reporting has been activated. Not
applicable. _METRICS_REPORTING_STOPPED_ Metrics reporting has been stopped.
Not applicable. _NEW_METRICS_REPORT_ A new metrics report is available and has
been sent. Not applicable.
Table 12.2.7-3 provides a list of general error events exposed at reference
point M6d.
Table 12.2.7-3: Error Events relating to Metrics Reporting
* * *
Error event Definition Payload
* * *
_ERROR_METRICS_REPORTING_ Error in metrics reporting occurred. Server
address,\ Provisioning Session Id,\ Metrics Reporting Configuration Id,\ HTTP
response code\ Error message.
* * *
Details of status information for RAN-based metrics reporting are for further
study.
## 12.3 Media Session Handling for Uplink Streaming -- APIs and Functions
Details are for further study.
# 13 UE Media Stream Handler (M7) APIs for uplink and downlink
## 13.1 General
This clause defines a set of APIs and methods that permit an application or
other UE functions to communicate with a Media Player or Media Streamer. The
main focus of this clause is to formalize and harmonize commonly available
proprietary APIs in order to support the usage of a Media Player or a Media
Streamer in a 5G Media Streaming context.
The APIs specified in this clause are language- and runtime-independent.
Implementations are expected to provide language bindings appropriate to the
UE runtime environment.
## 13.2 DASH Media Player -- APIs and Functions
### 13.2.1 Overview
In the following, it is assumed that the Media Player (in this case a DASH
client) adheres to a basic set of functionalities as shown in Figure 13.2-1.
The DASH client downloads, processes and presents a DASH Media Presentation by
instruction of a 5GMSd-Aware Application using the M7d interface.
The 5GMSd-Aware Application can, in addition, configure the presentation of
the media, can receive notifications on events, or can query the internal
status of the DASH Player, also supported through M7d. Different functions of
the DASH Access Client that are typically necessary to process a DASH Media
Presentation, are shown in Figure 13.2-1. Additional functions may be
available as well.
Figure 13.2.1-1: DASH Client Architecture
The key functionalities of each of the functions as shown in Figure 13.2-1 are
summarized in the following:
> \- _5GMSd-Aware Application:_ Application that makes use of the DASH/Media
> Player to playback a DASH Media Presentation using the APIs defined in this
> clause.
>
> \- _Media Player:_ A complete player for the playback of a Media
> Presentation, including the Media Playback and Content Decryption Platform
> as defined in TS 26.511 [35].
>
> \- _Access Client:_ A part of the DASH Player that accesses and downloads of
> the resources and provides the downloaded resources to the Media Playback
> Platform and Content Decryption for the playback of DASH content.
>
> \- _Management:_ Controls all internal processes and the communication with
> the 5GMSd-aware application. In particular this includes the handling of
> service descriptions and operation points.
>
> \- _MPD Processing:_ parses and processes the MPD and extracts the relevant
> information.
>
> \- _Adaptation Set Selection:_ selects the Adaptation Set based on user,
> application and/or device capability information. Information provided
> through M7d may be used.
>
> \- _ABR Controller and Dynamic Switching:_ runs adaptive bit rate logic and
> triggers adaptive switching of Representations. Information provided to the
> DASH client through M7d may be used.
>
> \- _Throughput Estimation:_ estimates the throughput from the 5GMSd
> Application Server.
>
> \- _Metrics Logging:_ logs relevant low-level metrics and provides those to
> the metrics aggregation and reporting functions in the Media Session
> Handler.
>
> \- _Media Playback Management and Protection Controller:_ manages the media
> playback by moving downloaded information into media playback platform and
> also addresses handling of protection and DRM related information.
>
> \- _Media Playback and Content Decryption Platform:_ plays back CMAF-based
> media content according to the playback requirements in TS 26.511 [35]. It
> also provides status information as well as events that maybe be provided
> through M7d.
>
> \- _Event Processing:_ Processes DASH events and provides information to
> application as defined in TS 26.247 [4].
This clause focuses on Media Player related communication through M7d. In
particular, the following aspects of M7d are defined:
> 1) Methods to interact with the Media Player are defined in clause 13.2.3.
>
> 2) Notification and Error Events are defined in clause 13.2.4.
>
> 3) Configuration and Settings APIs are defined in clause 13.2.5.
>
> 4) Status Information API is defined in clause 13.2.6.
The communication to the media playback platform is defined through the
details in TS 26.511 [35].
A 5GMSd client for DASH distribution shall support the APIs defined in this
clause 13.
NOTE: The initial APIs have largely been designed based on the dash.js APIs
documented here: http://cdn.dashjs.org/latest/jsdoc.
### 13.2.2 Media Player model
Figure 13.2.2-1 provides an informative client state model in order to
appropriately describe the messages on the Media streaming service API. Six
different states are defined.
State changes may happen based on:
\- Calls from application.
\- Information provided in the Media Presentation Description (MPD).
{width="6.489583333333333in" height="4.159419291338582in"}
Figure 13.2.2-1: State Diagram for Media Player
Table 13.2.2-1 defines states for the Media Player. Detailed descriptions are
provided in the following subclauses.
Table 13.2.2-1: States of Media Player
States Definition
* * *
_IDLE_ The Media Player is not associated with any application. _INITIALIZED_
The Media Player is associated with an application and the M7d API
communication is established. _READY_ The Media Player has loaded an MPD and
is able to playback the media in this Media Presentation. It also updates the
MPD according to the MPD update mechanism. _PRELOADED_ The Media Player has
pre-loaded all media information in order to start playback instantaneously.
It also updates the MPD according to the MPD update mechanism. _PLAYING_ The
Media Player is playing the Media Presentation. It also updates the MPD
according to the MPD update mechanism. _PAUSED_ The playback of the Media
Presentation is paused. It also updates the MPD according to the MPD update
mechanism.
It is assumed that the DASH Access Client manages the playback of at most one
CMAF track for each media type, namely one for video, one for audio and one
for subtitles as defined in TS 26.511 [35]. Playback of multiple CMAF tracks
of the same media type is not excluded for 5GMS, but details is for further
study.
### 13.2.3 Methods
#### 13.2.3.1 General
Based on the state model in clause 13.2.2, this clause introduces relevant
procedures and API calls.
Table 13.2.3.1-1 provides an overview over the methods defined for the DASH-
based streaming API. Note that in implementations, additional methods may be
supported.
Table 13.2.3.1-1: Methods defined for DASH Streaming API
Method State after success Brief description Clause
* * *
initialize() _INITIALIZED_ The Media Player is created. 13.2.3.2 attach(MPD)
_READY_ sets a source URL to an MPD file or a previously downloaded and parsed
MPD. 13.2.3.3 preload(MPD) _PRELOADED_ Streaming the media is initiated.
13.2.3.4 play(MPD) _PLAYING_ Playback of the media is initiated. 13.2.3.5
pause() _PAUSED_ Playback of the media is paused. 13.2.3.6 seek(MPD, time)
_PLAYING_ The playback time of the media is altered. 13.2.3.7 reset()
_INITIALIZED_ All media related information is reset. 13.2.3.8 destroy()
_IDLE_ All media player related information is reset and API communication is
stopped. 13.2.3.9
#### 13.2.3.2 Initialize
This clause defines the initialize() method.
The Media Player is created by initializing using the initialize() method. The
following functions are initialized:
\- Media Playback Management in order to enable API-based communication
through M7d. In particular, the M7d _Notifications and Errors API_ (see clause
13.2.4) and the _Status Query_ (see clause 13.2.5) are established.
#### 13.2.3.3 Attach
This clause defines the attach() method.
The following pre-conditions apply:
\- The MediaPlayer is be in _INITIALIZED_ state.
An 5GMSd-Aware Application calls attachMPD() to set a source URL to an MPD
file or a previously downloaded and parsed MPD.
The parameters of the method are defined in Table 13.2.3.3-1.
Table 13.2.3.3-1: Parameters for attachMPD()
+------------+------------------+------------------------------------+ | Name | Type | Description | +============+==================+====================================+ | _urlOrMPD_ | string \| Object | A URL to a valid MPD or a valid | | | | MPD as defined in ISO/IEC 23009-1 | | | | [32] or TS 26.247 [4]. | | | | | | | | The URL may be augmented by MPD | | | | Anchors as defined in ISO/IEC | | | | 23009-1 [32], Annex C.4. | +------------+------------------+------------------------------------+
The following Media Player Actions are expected:
\- The _Request Scheduling_ and _Download_ functions are established.
\- If the input is a URL, the Media Player requests the MPD at the
corresponding URL through M4d.
\- If the MPD is not found after multiple retries, an error
_ERROR_MPD_NOT_FOUND_ is returned and the process is terminated.
\- The _MPD Processing_ function is established and the MPD parsed.
\- If the MPD is not valid, an error _ERROR_MPD_NOT_VALID_ is returned and the
process is terminated.
\- If the DASH Player does not support the profiles as indicated in the MPD,
an error _ERROR_PROFILE_NOT_SUPPORTED_ is returned and the process is
terminated.
\- Depending on the type of the MPD, possibly present anchors as well as the
wall-clock time, the Media Player selects the Period in the content that is
expected to be played next.
\- The _Media Playback Management and Protection Controller_ is established.
\- The MPD is parsed for available Service Descriptions (including Media
Subsets and Adaptation Sets). By using capability mechanisms defined in TS
26.511 [35] as well as using other information (language settings, output
capabilities, accessibility settings), the Media Player identifies a set of
permissible Service Descriptions including Media Subsets and Adaptation Sets.
If no Adaptation Sets are capable to be played, an error
_ERROR_MEDIA_NOT_SUPPORTED_ is returned and the process is terminated.
\- The available Service Descriptions including included Adaptation Sets are
provided to the application through M7d.
\- The application may select a Service Description instance as well as
Adaptation Sets. Additional Service Descriptions parameters may be configured
through M7d.
\- Based on the service description parameters and selected Adaptation Sets:
\- the Operation Point parameters are set.
\- the _Media Playback Platform and Content Decryption_ is established using
the methods defined in TS 26.511.
\- The selected Adaptation Sets are initialized by downloading the relevant
Initialization Segments/CMAF Headers through M4d in the Media Playback
Platform as in TS 26.511 [35] establishing a track buffer for each selected
media type.
\- Depending on the MPD information and/or M7d configuration, one or more of
the following functions may be established:
\- Metrics Logging and Collection
\- Event Processing and Notification
\- Client Metadata handling
\- The Media Player is left in the _READY_ state.
An application may use this method to load an MPD and in order to prepare
playback. In case of errors notifications, it is up to the application to
initiate appropriate actions.
#### 13.2.3.4 Pre-load
This clause defines the preload() method.
The following pre-conditions apply:
\- The MediaPlayer is in _INITIALIZED_ or _READY_ state.
An 5GMSd-Aware Application calls preload() to cause the player to begin
streaming the media as set by the attach() method in preparation for playing.
The parameters of the method are defined in Table 13.2.3.4-1.
Table 13.2.3.4-1: Parameters for attachSource()
+------------+------------------+------------------------------------+ | Name | Type | Description | +============+==================+====================================+ | _urlOrMPD_ | string \| Object | A URL to a valid MPD or a valid | | | | MPD as defined in ISO/IEC 23009-1 | | | | [32] or TS 26.247 [4]. | | | | | | | | The URL may be augmented by MPD | | | | Anchors as defined in ISO/IEC | | | | 23009-1 [32], Annex C.4. | +------------+------------------+------------------------------------+
The following Media Player Actions are expected:
\- If in _INITIALIZED_ state, the attach() method is invoked.
\- Depending on the type of the MPD, possibly present anchors as well as the
wall-clock time, and other MPD information, the earliest media time span for
pre-loading is identified.
\- The Access Client schedules and generates requests for the relevant media
segments based on the ABR Controller information, as well as the throughput
estimation and downloads this media.
\- The Segments are downloaded from the corresponding URLs through M4d
earliest at the segment availability start time of the Segments.
\- The Segments ate appropriately appended to the track buffers as established
according to _Media Playback Platform and Content Decryption_ APIs, following
the description in TS 26.511 [35] for playback requirements.
\- Configuration and service description parameters are taking into account,
for example the content is continuously loaded to remain at the live edge
following the latency requirements provided in the service description
setting. Content not at the live edge is removed. For static services, the
content is loaded from the beginning up to a suitable buffer duration,
possibly as configured, and then downloading is stopped.
\- Appropriate notifications and error messages are generated. For details
refer to clause 13.2.5.
\- Appropriate Status Information is generated. For details refer to clause
13.2.6.
\- The Media Player is in _PRELOADED_ state.
An application may use this method to preload media into the player in order
minimize the start-up time.
#### 13.2.3.5 Play
This clause defines the play() method.
The following pre-conditions apply:
> \- The MediaPlayer is in _INITIALIZED_ or _READY_ or _PRELOADED_ or _PAUSED_
> state.
An 5GMSd-Aware Application calls play() to cause the player to begin playback
of the media as set by the attach() method.
The parameters of the method are defined in Table 13.2.3.5-1.
Table 13.2.3.5-1: Parameters for play()
+------------+------------------+------------------------------------+ | Name | Type | Description | +============+==================+====================================+ | _urlOrMPD_ | string \| Object | A URL to a valid MPD or a valid | | | | MPD as defined in ISO/IEC 23009-1 | | | | [32] or TS 26.247 [4]. | | | | | | | | The URL may be augmented by MPD | | | | Anchors as defined in ISO/IEC | | | | 23009-1 [32], Annex C.4. | +------------+------------------+------------------------------------+
The following Media Player Actions are expected:
\- If in _INITIALIZED_ state, the attach() method is invoked.
\- If in _PAUSED_ state, the earliest media time is _MEDIA_TIME_ (for details
see clause 13.2.3.6), else, depending on the type of the MPD, possibly present
anchors as well as the wall-clock time, and other MPD information, the
earliest media time for start-up is identified.
\- The Access Client checks the available buffer state of media in the Media
Playback Platform. Based on this, the Access Client schedules and generates
requests for the relevant media segments based on the ABR Controller
information, as well as the throughput estimation and downloads this media.
\- The Segments are downloaded from the corresponding URLs through M4d
earliest at the segment availability start times.
\- The media is appropriately appended to the _Media Playback Platform and
Content Decryption_ APIs, following the description in TS 26.511 [35] for
playback requirements.
\- Once a threshold for sufficient buffering is reached, the Media Playback
platform is initiated to be started, i.e. a playback is initiated, following
the description in TS26.511 [35] for playback requirements.
\- The content is continuously streamed, downloaded and played back.
\- Appropriate notifications and error messages are generated. For details
refer to clause 13.2.4.
\- Appropriate Status Information is generated. For details refer to clause
13.2.5.
\- The Media Player is in _PLAYING_ state.
An application may use this method to initiate playback of media.
#### 13.2.3.6 Pause
This clause defines pause() method.
The following pre-conditions apply:
> \- The Media Player is in _PLAYING_ state.
An 5GMSd-Aware Application calls pause() to cause the Media Playback Platform
to pause playback.
No parameters are attached.
The following Media Player Actions are expected:
\- The playback on the playback platform is paused and the media time is
maintained as _MEDIA_TIME_.
\- The Access Client checks the available buffer state of media in the Media
Playback Platform. Based on this, the Access Client schedules and generates
requests for the relevant media segments based on the ABR Controller
information, as well as the throughput estimation and downloads this media.
\- The media is downloaded from the corresponding URL through M4d earliest at
the segment availability start time of the media.
\- The media is appropriately appended to the _Media Playback Platform and
Content Decryption_ APIs, following the description in TS 26.511 [35] for
playback requirements.
\- Once the buffers are sufficiently filled, the client stops downloading.
\- Appropriate notifications and error messages are generated. For details
refer to clause 13.2.4.
\- Appropriate Status Information is generated. For details refer to clause
13.2.5.
\- The Media Player is in _PAUSED_ state.
An application may use this method to play back media.
#### 13.2.3.7 Seek
This clause defines seek() method.
The following pre-conditions apply:
> \- The MediaPlayer is in _INITIALIZED_ , _READY_ , _PRELOADED_ or _PAUSED_
> state.
An 5GMSd-Aware Application calls seek() to cause the player to go a specific
media time.
The parameters of the method are defined in Table 13.2.3.7-1.
Table 13.2.3.7-1: Parameters for seek()
+-------------+------------------+-----------------------------------+ | Name | Type | Description | +=============+==================+===================================+ | _urlOrMPD_ | string \| Object | A URL to a valid MPD or a valid | | | | MPD. | | | | | | | | The URL may be augmented by MPD | | | | Anchors as defined in ISO/IEC | | | | 23009-1 [32], Annex C.4. | +-------------+------------------+-----------------------------------+ | _mediaTime_ | Unsigned integer | The media time in milliseconds | | | | for playback. | +-------------+------------------+-----------------------------------+
The following Media Player Actions are expected:
\- If in _INITIALIZED_ state, the attach() method is carried out.
\- If the mediaTime is not accessible return an error
_ERROR_MEDIA_TIME_NOT_ACCESSIBLE_ and terminate the process.
\- The earliest media time is set to the mediaTime.
\- The state is set to _PAUSED_.
\- The play() command is issued.
An application may use this method to initiate playback of media.
#### 13.2.3.8 Reset
This clause defines the reset() method.
The following pre-conditions apply:
> \- The Media Player may be in any state.
An 5GMSd-Aware Application calls reset()resets all information related to the
media and the Media Presentation described by the MPD is destroyed.
No parameters are attached.
The following Media Player Actions are expected:
\- The playback on the playback platform terminated.
\- All open requests are cancelled.
\- All scheduled requests are deleted.
\- The current MPD is removed.
\- The Media Player is left in the _INITIALIZED_ state.
An application may use this method to terminate the playback of any media.
#### 13.2.3.9 Destroy
This clause defines destroy() method.
The following pre-conditions apply:
> \- The Media Player may be in any state.
An 5GMSd-Aware Application calls destroy()resets all information related to
the media and the network.
No parameters are attached.
The following Media Player Actions are expected:
\- The playback on the playback platform terminated.
\- All open requests are cancelled.
\- All scheduled requests are deleted.
\- The current MPD is removed.
\- All network information is history is cleared.
\- The Media Player is left in the _IDLE_ state.
An application may use this method to terminate the playback of any media
clear and download related information.
### 13.2.4 Configurations and settings API
DASH streaming may be configured with the parameters provided in Table
13.2.4-1. Note that these parameters may be set and they may also be observed.
Table 13.2.4-1: Configuration API
+----------------+----------------+----------------+----------------+ | Status | Type | Definition | | +================+================+================+================+ | _source_ | Object | Provides the | | | | | MPD and all | | | | | contained | | | | | information. | | +----------------+----------------+----------------+----------------+ | _co | Enum | Defines two | | | nsumptionMode_ | | modes: | | | | | | | | | | _live_ : in | | | | | this case the | | | | | target latency | | | | | is maintained, | | | | | if specified | | | | | in the service | | | | | description, | | | | | according to | | | | | the parameters | | | | | | | | | | _vod_ : in this | | | | | case the | | | | | latency is set | | | | | by the | | | | | application | | | | | and the | | | | | latency | | | | | settings are | | | | | ignored. | | +----------------+----------------+----------------+----------------+ | * | Integer | Maximum buffer | | | maxBufferTime _| | time in | | | | | milliseconds | | | | | for the | | | | | service. | | +----------------+----------------+----------------+----------------+ |_ service | id | Selects a | | | DescriptionId _| | service | | | | | description by | | | | | selecting an | | | | | identifier. | | +----------------+----------------+----------------+----------------+ |_ serviceDes | Service | Configures a | | | criptions[]_| description | service | | | | parameters | description as | | | | | defined in | | | | | ISO/IEC | | | | | 23009-1 | | | | | [32], Annex | | | | | K. This allows | | | | | the | | | | | application to | | | | | define | | | | | additional | | | | | service | | | | | descriptions | | | | | beyond those | | | | | defined in the | | | | | MPD. | | +----------------+----------------+----------------+----------------+ | |_ id _| id | Sets a service | | | | | description | | | | | identifier | | | | | different from | | | | | the ones | | | | | available in | | | | | the service | | | | | descriptions | | | | | in the MPD or | | | | | modifies | | | | | existing | | | | | service | | | | | descriptions. | +----------------+----------------+----------------+----------------+ | |_ s | Object | Sets service | | | erviceLatency _| | description | | | | | parameters for | | | | | the service | | | | | latency, as | | | | | defined in | | | | | ISO/IEC | | | | | 23009-1 | | | | | [32], Table | | | | | K.1. | +----------------+----------------+----------------+----------------+ | |_ playBackRate _| Object | Sets service | | | | | description | | | | | parameters for | | | | | the playback | | | | | rate, as | | | | | defined in | | | | | ISO/IEC | | | | | 23009-1 | | | | | [32], Table | | | | | K.2 when the | | | | | service is | | | | | consumed in | | | | | live mode. | +----------------+----------------+----------------+----------------+ | |_ ope | Object | Sets service | | | ratingQuality _| | description | | | | | parameters for | | | | | the operating | | | | | quality, as | | | | | defined in | | | | | ISO/IEC | | | | | 23009-1 | | | | | [32], Table | | | | | K.3. | +----------------+----------------+----------------+----------------+ | |_ opera | Object | Sets service | | | tingBandwidth _| | description | | | | | parameters for | | | | | the operating | | | | | bandwidth, as | | | | | defined in | | | | | ISO/IEC | | | | | 23009-1 | | | | | [32], Table | | | | | K.4. | +----------------+----------------+----------------+----------------+ |_ medi | Media type | Sets the | | | aSettings[]_| audio, video, | selected | | | | subtitle | Adaptation Set | | | | | based on the | | | | | available | | | | | Adaptation | | | | | Sets for each | | | | | media type. | | +----------------+----------------+----------------+----------------+ |_ metricsConf | Object | Defines the | | | iguration[]* | | setting for | | | | | collecting | | | | | metrics. | | +----------------+----------------+----------------+----------------+
### 13.2.5 Notifications and error events
Table 13.2.5-1 provides a list of notification events that are provided by the
Media Player.
Table 13.2.5-1: Notification events
+----------------------+----------------------+----------------------+ | Status | Definition | Payload | +======================+======================+======================+ | _AST_IN_FUTURE_ | Triggered when | Time before playback | | | playback will not | will start. | | | start yet as the | | | | MPD\'s | | | | a | | | | vailabilityStartTime | | | | is in the future. | | +----------------------+----------------------+----------------------+ | _AVAILA | The list of | Media type: | | BLE_MEDIA_CHANGED_ | available media has | | | | changed. | video, audio, | | | | subtitle, all | +----------------------+----------------------+----------------------+ | _BUFFER_EMPTY_ | Triggered when the | Media Type | | | media playback | | | | platform\'s buffer | | | | state changes to | | | | stalled. | | +----------------------+----------------------+----------------------+ | _BUFFER_LOADED_ | Triggered when the | Media Type | | | media playback | | | | platform\'s buffer | | | | state changes to | | | | loaded. | | +----------------------+----------------------+----------------------+ | _CAN_PLAY_ | Sent when enough | Not applicable. | | | data is available | | | | that the media can | | | | be played. | | +----------------------+----------------------+----------------------+ | _MANIFEST_LOADED_ | Triggered when the | Not applicable. | | | manifest load is | | | | complete | | +----------------------+----------------------+----------------------+ | _METRIC_ADDED_ | Triggered every time | | | | a new metric is | | | | added. | | +----------------------+----------------------+----------------------+ | _METRIC_CHANGED_ | The minimum bit rate | | | | that the ABR | | | | algorithms will | | | | choose. Use NaN for | | | | no limit. | | +----------------------+----------------------+----------------------+ | _METRIC_UPDATED_ | Set to true if you | | | | would like DASH | | | | Client to keep | | | | downloading | | | | fragments in the | | | | background when the | | | | video element is | | | | paused. | | +----------------------+----------------------+----------------------+ | _METRICS_CHANGED_ | Triggered whenever | | | | there is a change to | | | | the overall metrics. | | +----------------------+----------------------+----------------------+ | _OPERAT | Triggered whenever | External reference | | ION_POINT_CHANGED_ | there is a change of | identifier of | | | an operation point | currently selected | | | parameter. | Service Operation | | | | Point. | +----------------------+----------------------+----------------------+ | _PLAYBACK_ENDED_ | Sent when playback | | | | completes. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_ERROR_ | Sent when an error | Error attribute. | | | occurs. The | | | | element\'s error | | | | attribute contains | | | | more information. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_PAUSED_ | Sent when playback | | | | is paused. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_PLAYING_ | Sent when the media | | | | begins to play | | | | (either for the | | | | first time, after | | | | having been paused, | | | | or after ending and | | | | then restarting). | | +----------------------+----------------------+----------------------+ | _PLAYBACK_SEEKED_ | Sent when a seek | | | | operation completes. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_SEEKING_ | Sent when a seek | | | | operation begins. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_STALLED_ | Sent when the media | | | | playback platform | | | | reports stalled | | +----------------------+----------------------+----------------------+ | _PLAYBACK_STARTED_ | Sent when playback | | | | of the media starts | | | | after having been | | | | paused; that is, | | | | when playback is | | | | resumed after a | | | | prior pause event. | | +----------------------+----------------------+----------------------+ | _PLAYBACK_WAITING_ | Sent when the media | | | | playback has stopped | | | | because of a | | | | temporary lack of | | | | data. | | +----------------------+----------------------+----------------------+ | _SERVICE_DE | sent when the DASH | | | SCRIPTION_SELECTED_ | client has selected | | | | a service | | | | description. | | +----------------------+----------------------+----------------------+ | _SERVICE_D | Sent when the DASH | | | ESCRIPTION_CHANGED_ | client has changed a | | | | service description. | | +----------------------+----------------------+----------------------+ | _SERVICE_DE | Provides | Parameters of | | SCRIPTION_VIOLATED_ | notification that | service description | | | the service | that are not met. | | | description | | | | parameters are | | | | currently not met. | | +----------------------+----------------------+----------------------+ | * | Triggered when the | | | SOURCE_INITIALIZED* | source is setup and | | | | ready. | | +----------------------+----------------------+----------------------+
Table 13.2.5-2 provides a list of error events.
Table 13.2.5-2: Error events
Status Definition Payload
* * *
_ERROR_MPD_NOT_FOUND_ Triggered when the MPD is not found.  
_ERROR_MEDIA_PLAYBACK_ Triggered when there is an error from the media
playback platform buffer.  
_ERROR_MPD_NOT_VALID_ The provided MPD is not valid according to the XML
schema and schematron rules. Detailed error information.
_ERROR_MEDIA_TIME_NOT_ACCESSIBLE_ After seek operation, the media time is not
accessible.  
_ERROR_PROFILE_NOT_SUPPORTED_ The profile of the Media Presentation is not
supported.
### 13.2.6 Status Information
Table 13.2.6-1 provides a list of dynamically changing status information that
can be obtained from the client.
Table 13.2.6-1: Dynamic Status information
+----------------+----------------+----------------+----------------+ | Status | Type | Parameter | Definition | +================+================+================+================+ | _state_ | Enumeration | | An enumerated | | | | | value from | | | | | table 13.2.2‑1 | | | | | indicating the | | | | | current state | | | | | of the Media | | | | | Player. | +----------------+----------------+----------------+----------------+ | _aver | float | none | Current | | ageThroughput_ | | | average | | | | | throughput | | | | | computed in | | | | | the ABR logic | | | | | in bit/s. | +----------------+----------------+----------------+----------------+ | _bufferLength_ | float | MediaType | Current length | | | | | of the buffer | | | | \"video\", | for a given | | | | \"audio\" and | media type, in | | | | \"subtitle\" | seconds. If no | | | | | type is passed | | | | | in, then the | | | | | minimum of | | | | | video, audio | | | | | and subtitle | | | | | buffer length | | | | | is returned. | | | | | NaN is | | | | | returned if an | | | | | invalid type | | | | | is requested, | | | | | the | | | | | presentation | | | | | does not | | | | | contain that | | | | | type, or if no | | | | | arguments are | | | | | passed and the | | | | | presentation | | | | | does not | | | | | include any | | | | | adaption sets | | | | | of valid media | | | | | type. | +----------------+----------------+----------------+----------------+ | _liveLatency_ | float | none | Current live | | | | | stream latency | | | | | in seconds | | | | | based on the | | | | | latency | | | | | measurement. | +----------------+----------------+----------------+----------------+ | _med | MP | MediaType | Current media | | iaSetting[]_ | DAdaptationSet | | settings for | | | | \"video\", | each media | | | | \"audio\" and | type based on | | | | \"subtitle\" | the CMAF | | | | | Header and the | | | | | MPD | | | | | information | | | | | based on the | | | | | selected | | | | | Adaptation Set | | | | | for this media | | | | | type. | +----------------+----------------+----------------+----------------+ | _mediaTime_ | float | None | Current media | | | | | playback time | | | | | from media | | | | | playback | | | | | platform. The | | | | | media time is | | | | | in seconds and | | | | | is relative to | | | | | the start of | | | | | the playback | | | | | and provides | | | | | the media that | | | | | is actually | | | | | rendered. | +----------------+----------------+----------------+----------------+ | _playbackRate_ | float | None | The current | | | | | rate of | | | | | playback. For | | | | | a video that | | | | | is playing | | | | | twice as fast | | | | | as the default | | | | | playback, the | | | | | _playbackRate_ | | | | | value should | | | | | be 2.00. | +----------------+----------------+----------------+----------------+ | _avail | Provides the | | Provides the | | ableServiceDes | available | | list of | | criptions[]_ | service | | available | | | descriptions | | selectable | | | | | service | | | | | descriptions | | | | | with an id to | | | | | select from. | | | | | Those are | | | | | either | | | | | configured | | | | | ones or the | | | | | ones in the | | | | | MPD. | +----------------+----------------+----------------+----------------+ | _availableMed | List of | MediaType | Provides the | | iaOptions[]_ | Adaptation Set | | list of | | | or | \"video\", | available | | | Preselection | \"audio\" | media options | | | ids | \"subtitle\"\ | that can be | | | | \"all\" | selected by | | | | | the | | | | | application | | | | | based on the | | | | | capability | | | | | discovery and | | | | | the subset | | | | | information. | +----------------+----------------+----------------+----------------+ | _service‌Ope | Ar | | The set of | | ration‌Points_ | ray(Service‌Op | | Service | | | eration‌Point) | | Operation | | | | | Points | | | | | declared in | | | | | the | | | | | presentation | | | | | manifest (e.g. | | | | | DASH MPD) of | | | | | the current | | | | | media | | | | | presentation. | +----------------+----------------+----------------+----------------+ | _operat | integer | | A zero-based | | ive‌Service‌Op | | | index into the | | eration‌Point_ | | | _service‌Ope | | | | | ration‌Points_ | | | | | array | | | | | indicating the | | | | | Service | | | | | Operation | | | | | Point | | | | | currently | | | | | operative in | | | | | the playback | | | | | session. | | | | | | | | | | Set to -1 if | | | | | the array is | | | | | empty. | +----------------+----------------+----------------+----------------+ | _me | Metrics | | A data blob of | | trics[][]_ | | | metrics for | | | | | each | | | | | configured | | | | | metrics | | | | | collecting | | | | | scheme. | +----------------+----------------+----------------+----------------+
Table 13.2.6-2 provides a list of configured operation point information that
can be obtained from the client. Any change to a parameter below shall be
announced with a notification _OPERATION_POINT_CHANGED_.
Table 13.2.6-2: Service Operation Point Information
+-------------+-------------+-------------+-------------+-------------+ | Parameter | Type | Definition | | | +=============+=============+=============+=============+=============+ | * | Object | The | | | | ServiceOper | | currently | | | | ationPoint _| | configured | | | | | | operation | | | | | | point | | | | | | parameters | | | | | | according | | | | | | to which | | | | | | the DASH | | | | | | client is | | | | | | operating. | | | +-------------+-------------+-------------+-------------+-------------+ | |_ external | String | The | | | | Identifier _| | external | | | | | | identifier | | | | | | uniquely | | | | | | identifying | | | | | | this | | | | | | Operation | | | | | | Point in | | | | | | the | | | | | | p | | | | | | resentation | | | | | | manifest | | | | | | (e.g. | | | | | | DASH MPD). | | +-------------+-------------+-------------+-------------+-------------+ | |_ mode _| Enum | The | | | | | | following | | | | | | operation | | | | | | modes are | | | | | | defined: | | | | | | | | | | | |_ live _: The | | | | | | DASH client | | | | | | operates to | | | | | | maintain | | | | | | configured | | | | | | target | | | | | | latencies | | | | | | using | | | | | | playback | | | | | | rate | | | | | | adjustments | | | | | | and | | | | | | possibly | | | | | | resync. | | | | | | | | | | | |_ Vod _: The | | | | | | DASH client | | | | | | operates | | | | | | without | | | | | | latency | | | | | | r | | | | | | equirements | | | | | | and | | | | | | rebuffering | | | | | | may result | | | | | | in | | | | | | additional | | | | | | latencies | | +-------------+-------------+-------------+-------------+-------------+ | |_ max | Integer | maximum | | | | BufferTime _| | buffer time | | | | | | in | | | | | | m | | | | | | illiseconds | | | | | | for the | | | | | | service. | | +-------------+-------------+-------------+-------------+-------------+ | |_ switch | Integer | buffer time | | | | BufferTime _| | threshold | | | | | | below which | | | | | | the DASH | | | | | | clients | | | | | | attempts to | | | | | | switch | | | | | | Repre | | | | | | sentations. | | +-------------+-------------+-------------+-------------+-------------+ | |_ latency _| Object | Defines the | | | | | | latency | | | | | | parameters | | | | | | used by the | | | | | | DASH client | | | | | | when | | | | | | operating | | | | | | in live | | | | | | mode. | | +-------------+-------------+-------------+-------------+-------------+ | | |_ target _| Integer | The target | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | | |_ max _| Integer | The maximum | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | | |_ min _| Integer | The maximum | | | | | | latency for | | | | | | the service | | | | | | in | | | | | | mi | | | | | | lliseconds. | +-------------+-------------+-------------+-------------+-------------+ | |_ pl | MediaType | Defines the | | | | aybackRate _| | playback | | | | |_ audio _, | rate | | | | |_ video _, | parameters | | | | |_ all _| used by the | | | | | | DASH client | | | | | | for catchup | | | | | | mode and | | | | | | d | | | | | | eceleration | | | | | | to avoid | | | | | | buffer | | | | | | underruns | | | | | | and | | | | | | maintaining | | | | | | target | | | | | | latencies. | | +-------------+-------------+-------------+-------------+-------------+ | | |_ max _| Real | The maximum | | | | | | playback | | | | | | rate for | | | | | | the | | | | | | purposes of | | | | | | au | | | | | | tomatically | | | | | | adjusting | | | | | | playback | | | | | | latency and | | | | | | buffer | | | | | | occupancy | | | | | | during | | | | | | normal | | | | | | playback, | | | | | | where 1.0 | | | | | | is normal | | | | | | playback | | | | | | speed. | +-------------+-------------+-------------+-------------+-------------+ | | |_ min _| Real | The minimum | | | | | | playback | | | | | | rate for | | | | | | the | | | | | | purposes of | | | | | | au | | | | | | tomatically | | | | | | adjusting | | | | | | playback | | | | | | latency and | | | | | | buffer | | | | | | occupancy | | | | | | during | | | | | | normal | | | | | | playback, | | | | | | where 1.0 | | | | | | is normal | | | | | | playback | | | | | | speed. | +-------------+-------------+-------------+-------------+-------------+ | |_ bitRate _| | Defines the | | | | | | operating | | | | | | bandwidth | | | | | | parameters | | | | | | used by the | | | | | | DASH client | | | | | | used for a | | | | | | specific | | | | | | media type | | | | | | or | | | | | | aggregated. | | | | | | The values | | | | | | are on IP | | | | | | level. | | +-------------+-------------+-------------+-------------+-------------+ | | |_ target _| Integer | The target | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | | |_ max _| Integer | The maximum | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | | |_ min _| Integer | The minimum | | | | | | bandwidth | | | | | | for the | | | | | | service in | | | | | | bit/s that | | | | | | the client | | | | | | is | | | | | | configured | | | | | | to consume. | +-------------+-------------+-------------+-------------+-------------+ | |_ pla | | Play | | | | yerSpecific | | er-specific | | | | Parameters* | | parameters | | | | | | may be | | | | | | provided, | | | | | | for example | | | | | | about the | | | | | | used | | | | | | algorithm, | | | | | | etc. | | +-------------+-------------+-------------+-------------+-------------+
### 13.2.7 Usage of M7d Information by Media Session Handler
The media session handler may use the notifications, errors and status
information provided through M7d to execute relevant tasks.
# 14 Application (M8) APIs for uplink and downlink
APIs of this reference point are not specified within this release.
# 15 Miscellaneous UE-internal APIs
## 15.1 General
While the core functionality of 5GMS is specified in terms of the dedicated
system interfaces and APIs that impact the UE, specified in clauses 10 to 14
(M4 to M8 respectively), certain features of 5GMS rely on interfaces and APIs
that are essentially UE-internal.
Each usage of a UE-internal interface is specified in subsequent sub-clauses
of the present clause.
## 15.2 RAN Signaling-based Network Assistance API
If RAN Signaling-based Network Assistance is supported, the Media Session
Handler uses an interface to the RAN Modem (specifically, the UE MAC entity in
the modem) to send and receive bit rate recommendation messages. The interface
to the modem may be based on the AT commands _+CGBRRREQ_ and _+CGBRRREP_ as
defined in [15].
Furthermore, messaging across that interface corresponds to the logical
translations of the _Bit Rate Recommendation_ and/or _Bit Rate Recommendation
Query_ messages, carried by the Recommended bit rate MAC CE, exchanged between
the RAN Modem and the RAN, as specified in [13] for 5G NR and [14] for LTE.
The association between the LCID for which the recommendation applies and the
actual flow (including the intermediate RLC channel) is performed by the
modem.
NOTE: The _+C5GQOSRDP=?_ command may be used to get a list of CID values that
are associated with QoS flows (both network and MT/TE initiated).When used for
requesting a bit rate boost, the query shall not request a bit rate that may
exceed the MFBR for the corresponding QoS Flow. Failure to ensure this may
result in unexpected congestion-induced packet delays and dropping.
The _Bit Rate Recommendation Query_ shall indicate the bit rate desired by the
application, as described by [13] and [14]. This request may be used by the
5GMSd Media Session Handler to request for a temporary increase in bit rate
for the corresponding flow (bit rate boost). The RAN responds with a Bit Rate
Recommendation message that confirms the recommended bit rate after the boost
grant. Once the bit rate drops again after a boost grant, the network shall
inform the Media Session Handler about the new recommended bit rate by means
of an ANBR message.
Whenever the Media Session Handler receives a message from the RAN Modem,
corresponding to the logical translation of the _Bit Rate Recommendation_
message for the associated RAN uplink or downlink, it shall indicate the
associated bit rate recommendation to either the Media Player (via M7d, in the
case of downlink streaming) or Media Streamer (via M7u, in the case of uplink
streaming) function of an affiliated PDU session. Furthermore, whenever the
Media Session Handler receives a request for a bit rate boost from either the
Media Player (via M6d in the case of downlink streaming) or the Media Streamer
(via M6u, in the case of uplink streaming) function of an affiliated PDU
session, it may send a bit rate boost message to the RAN Modem. That bit rate
boost request is logically translated by the modem to the _Bit Rate
Recommendation Query_ message which is then sent to the RAN on the associated
RAN uplink or downlink.
It is left to the implementer of the media player to decide how to best use
the bit rate recommendation and the bit rate recommendation query information
for the media streaming sessions.
## 15.3 RAN-based Metrics Reporting API
These procedures shall be used by the Media Session Handler to control metrics
reporting when such reporting is configured by the OAM via the 5G control
channel.
The Media Session Handler shall subscribe to metrics configurations from the
OAM according to TS 26.247 Annex L.1. This configuration may also include
virtual reality metrics as specified in TS 26.118 [42] clause 9.3. When a
metrics configuration is received, the Media Session Handler shall store this
configuration and use it for all subsequent streaming sessions.
When a streaming session is started the Media Session Handler shall determine
whether metrics from this session shall be reported. The determination shall
be based on the _sample percentage_ and _streaming source filter_ specified in
the stored metrics configuration, according to TS 26.247 Annex F.
If metrics are to be reported for the session, the Media Session Handler shall
request the Media Player to create a metrics collection job. The Media Player
shall return a reference to the created job, which the Media Session Handler
shall use in all subsequent actions related to this job.
The Media Session Handler shall configure the metrics collection job with the
set of metrics that shall be collected during the session. The format of the
configuration shall be according to TS 26.247 Annex L.2, but note that only
the _metrics_ attribute in the configuration shall be used for this purpose.
The Media Session Handler shall regularly request the collected metrics from
the Media Player according to the _reportingInterval_ specified in the metrics
configuration. The metrics returned by the Media Player shall use the format
as described in TS 26.247 clause 10.6, and (for virtual reality media) in TS
26.118 [42] clause 9.4, and the Media Session Handler shall forward these to
the OAM according to TS 26.247 Annex L.1.
When the session is finished the Media Session Handler shall delete the
metrics collection job.
# 16 Usage of 5GC interfaces and APIs
## 16.1 General
While the core functionality of 5GMS is specified in terms of the dedicated
system interfaces and APIs specified in clauses 7 to 14 (for M1 to M8
respectively), certain features of 5GMS rely on interfaces and APIs defined
within the scope of the 5GC.
Each such case of usage of a 5GC interface and API is documented in subsequent
sub-clauses of the present clause.
NOTE: The 5GMS architecture may be applied to an EPS although such an
application is not specified in the present document and is left to the
discretion of deployments and implementations.
## 16.2 Usage of N5/N33 for AF-based Network Assistance
The AF-based Network Assistance feature operates at reference point M5 between
the Media Session Handler in the 5GMS Client and a 5GMS AF that provides
Network Assistance capabilities. The Network Assistance API at reference point
M5 (see clause 11.6) is specified in a generic way such that the associated
Network Assistance functionality in the 5GC may be realised by various means.
NOTE 1: This clause does not limit the possible set of 5G System exposure
functionalities for obtaining Network Assistance information.
In this release, the 5GMS AF converts Network Assistance API invocations
received at reference point M5 into direct or indirect invocations of the
Policy Authorization Service exposed by the PCF, and converts responses and
notifications from the PCF into their equivalents at reference point M5 for
delivery to the Media Session Handler.
If it supports the Network Assistance feature, the 5GMS AF shall offer the bit
rate recommendation (throughput estimation) and delivery boost request API
based on existing Policy Templates that match the filtering criteria for a
media streaming session, and the 5GMS AF shall interact with the PCF using one
of the following methods:
A. If the 5GMS AF is deployed in the Trusted DN, it may directly invoke the
_Npcf_Policy‌Authorization_ service at reference point N5, as specified in TS
29.514 [34].
NOTE 2: It is the responsibility of the 5GMS AF in this case to discover and
track changes to the PCF instance responsible for the PDU Session supporting
the media streaming session at reference point M4 using the discovery services
provided by the NRF and/or BSF.
B. If the 5GMS AF is deployed outside the Trusted DN, or if it is more
convenient for a 5GMS AF deployed in the Trusted DN to do so, it invokes the
_Nnef_AFSessionWithQoS_ service exposed by the NEF, as specified in clause
4.4.9 of TS 29.522 [50], to indirectly invoke the PCF at reference point N33.
NOTE 3: Per clause 4.4.9 of TS 29.522 [50], the _Nnef_AFSession‌With‌QoS_
service is realised at reference point N33 by the _AsSession‌With‌QoS_
exposure API.
NOTE 4: Configuration of the NEF endpoint address and access credentials in
the 5GMS AF in this case is beyond the scope of the present document.
When a Network Assistance session is created by the Media Session Handler (per
clauses 4.7.6 and 11.6.4.1), the 5GMS AF shall create an _AF application
session context_ in the PCF responsible for the PDU Session corresponding to
the M4 application flows listed in the
_NetworkAssistanceSession.‌serviceDataFlow‌Descriptions_ property.
If no corresponding AF application session context already exists, the 5GMS AF
shall use the _Npcf_‌Policy‌Authorization_‌Create_ operation at reference
point N5 (or, if deployed outside the Trusted DN, the equivalent
_AsSession‌WithQoS_ service operation) with the appropriate service
information to create and provision a new AF application session context. The
information in the _AppSessionContext‌ReqData_ shall be derived from the
service data flow descriptions in the Network Assistance session resource, as
well as from the referenced Policy Template (if any) and/or the requested QoS.
The AF application session context shall declare exactly one media component
per media streaming session. A separate sub-component shall be declared for
each M4 application flow listed in the
_NetworkAssistanceSession.‌serviceDataFlow‌Descriptions_ array.
For each of the Network Assistance sessions it is managing, the 5GMS AF shall
subscribe to the following PCF notifications on the corresponding AF
application session context:
\- Service Data Flow QoS notification control;
\- Service Data Flow deactivation;
\- Resources allocation outcome.
When requesting QoS provisioning for a media streaming session, the 5GMS AF
shall use the configured Policy Templates of the Provisioning Session to
determine the list of the QoS references within the \"altSerReqs\". The lowest
priority index shall be assigned to the policy template with the lowest QoS
requirement, and the highest priority shall be assigned to the requested
operation point by the UE (if the UE is allowed to use that operation point).
When a Network Assistance session is subsequently destroyed by the Media
Session Handler (per clauses 4.7.6 and 11.6.4.6), the 5GMS AF shall destroy
the corresponding AF application session context in the relevant PCF instance.
## 16.3 Usage of N5/N33 for dynamic policies
The dynamic policies feature operates at reference point M5 between the Media
Session Handler in the 5GMS Client and a 5GMS AF that has been appropriately
provisioned with Policy Templates. The Dynamic Policies API at reference point
M5 (see clause 11.5) is specified in a generic way such that the associated
functionality in the 5GC may be realised by various means.
NOTE 1: This clause does not limit the possible set of 5G System exposure
functionalities for realising dynamic policies.
In this release, the 5GMS AF converts Dynamic Policies API invocations
received at reference point M5 into direct or indirect invocations of the
Policy Authorization Service exposed by the PCF, and converts responses from
the PCF into their equivalents at reference point M5 for return to the Media
Session Handler.
To realise dynamic policies, the 5GMS AF shall interact with the PCF using one
of the following methods:
A. If the 5GMS AF is deployed in the Trusted DN, it may directly invoke the
_Npcf_Policy‌Authorization_ service at reference point N5, as specified in TS
29.514 [34].
NOTE 2: It is the responsibility of the 5GMS AF in this case to discover and
track changes to the PCF instance responsible for the PDU Session supporting
the media streaming session at reference point M4 using the discovery services
provided by the NRF and/or BSF.
B. If the 5GMS AF is deployed outside the Trusted DN, or if it is more
convenient for a 5GMS AF deployed in the Trusted DN to do so, it invokes the
_Nnef_AFSession‌With‌QoS_ and/or _Nnef_Chargeable‌Party_ services exposed by
the NEF, as specified in clauses 4.4.9 and 4.4.8 respectively of TS 29.522
[50], to indirectly invoke the PCF at reference point N33.
NOTE 3: Per clause 4.4.9 of TS 29.522 [50], the _Nnef_AFSession‌With‌QoS_
service is realised at reference point N33 by the _AsSession‌With‌QoS_
exposure API. Similarly, the _Nnef_Chargeable‌Party_ service is realised by
the _Chargeable‌Party_ exposure API per clause 4.4.8 of [50].
NOTE 4: Configuration of the NEF endpoint address and access credentials in
the 5GMS AF in this case is beyond the scope of the present document.
When a dynamic policy is instantiated by the Media Session Handler (per clause
4.7.3), the 5GMS AF shall create an _AF application session context_ in the
PCF responsible for the PDU Session corresponding to the M4 application flows
listed in the _DynamicPolicy.‌serviceDataFlow‌Descriptions_ property.
If no corresponding AF application session context already exists, the 5GMS AF
shall use the _Npcf_‌Policy‌Authorization_‌Create_ operation at reference
point N5 (or, if deployed outside the Trusted DN, the equivalent
_AsSession‌WithQoS_ service operation) with the appropriate service
information to create and provision a new AF application session context. The
information in the _AppSessionContext‌ReqData_ shall be derived from the
service data flow descriptions in the dynamic policy resource and/or the
requested QoS.
The AF application session context shall declare exactly one media component
per media streaming session. A separate sub-component shall be declared for
each M4 application flow listed in the
_NetworkAssistanceSession.‌serviceDataFlow‌Descriptions_ array.
For each of the dynamic policies it is managing, the 5GMS AF shall subscribe
to the following PCF notifications on the corresponding AF application session
context:
\- Service Data Flow QoS notification control;
\- Service Data Flow deactivation;
\- Resources allocation outcome.
When requesting QoS provisioning for a media streaming session, the 5GMS AF
shall use the configured Policy Template of the dynamic policy to determine
the list of the QoS references within the \"altSerReqs\". The lowest priority
index shall be assigned to the policy template with the lowest QoS
requirement, and the highest priority shall be assigned to the requested
operation point by the UE (if the UE is allowed to use that operation point).
When a dynamic policy is subsequently destroyed by the Media Session Handler
(per clause 4.7.3), the 5GMS AF shall destroy the corresponding AF application
session context in the relevant PCF instance.
###### ## Annex A (informative): 5GMS Parameter propagation for DASH Streaming
# A.1 End-to-end model
Figure A.1‑1 below depicts an end-to-end model for the 5GMS parameter
propagation for DASH streaming with dynamic policy. The arrows indicate the
main information flow. The interfaces specified in TS 26.501 [2] are used
throughout. However, there are additional interfaces (i.e. P1 or U1), which
are not in the 5GMS Architecture.
{width="6.75in" height="2.8333333333333335in"}
Figure A.1‑1: End-to-end model for dynamic policy parameter propagation
The interfaces involved and their roles in this feature are as follows:
> \- M1: Provisioning interface between the 5GMS Application Provider and the
> 5GMS AF.
>
> \- P1: The 5GMS Application Provider provisions the DASH MPD generator, e.g.
> by annotating the MPD with Service Descriptions.
>
> \- U1: User Interface to the 5GMS-Aware Application.
NOTE: The 5GMS Application Provider controls the application, i.e. controls
the GUI choices.
> \- M8: Non-standardized input from the 5GMS Application Provider to the
> 5GMS-Aware Application, such as country-specific application behaviours
> (languages, on-demand catalogue, etc).
\- Input on subscriptions (e.g. 4K subscription versus SD subscription).
\- Device-specific content selection rules (e.g. SmartPhone versus Smart TV).
\- Additional service offering features (e.g. background download possible).
> \- C1 (one of M6 or M7): Information from the 5GMS-Aware Application to the
> 5GMS Client, e.g. user content selections.
>
> \- M6: Information flow from the DASH Player to the Media Session Handler.
>
> \- M7: Information flow from the Media Session Handler to the DASH Player.
>
> \- M5_1: Information flow into the Media Session Handler for parameter
> provisioning (Policy Descriptions, which originate from 5GMS AF and 5GMS
> Application Provider). The Policy Descriptions contain or reference the
> detailed Service Access Information, i.e. URLs to activate a certain policy.
>
> \- M5_2: Information flow from the Media Session Handler to the 5GMS AF.
> This includes:
\- input to create the Service Data Flow Templates (see TS 23.503 [33]) for
identifying the application data flows within a PDU Session,
\- an identifier for the Dynamic Policy instance (e.g. QoS, Conditional Zero-
rating, charging, etc) and
\- optionally, Network Assistance information, e.g. bit rate recommendations.
In its Annex K, the DASH standard [32] specifies so-called \"Service
Descriptions\". The purpose of Service Descriptions is to provide additional
information to a DASH player to influence its \"Selection Logic\", e.g. a DASH
player should prefer a certain set of representations within an adaptation
set. It is assumed in the following that the DASH MPD can be annotated using
Service Descriptions to give hints for subscription models and different
device types.
The 5G System specifies a number of different means to detect application
flows. When activating a Dynamic Policy, the Media Session Handler provides a
Service Data Flow Template to the 5GMS System, which identifies the
application flow(s) of interest. It is assumed here that multiple applications
are executing simultaneously on a given UE and that each application may
independently access the network. Therefore, the Media Session Handler needs
to provide (and update) these Service Data Flow Templates in order that the
application traffic can be treated according to the corresponding Dynamic
Policy.
In the following clauses, the parameter propagation for a number of different
use cases is described.
# A.2 Premium QoS dynamic policy
## A.2.1 General
To realise a Premium QoS service offering, the 5GMS Client should activate a
QoS Flow with characteristics matching the service needs. It is assumed that
the DASH content is prepared for different subscription levels, e.g. 4K, HDR
or SD, and for different target device types, e.g. SmartPhone or SmartTV. When
commencing playback of a DASH presentation according to a particular
subscription level (e.g. 4K), the 5GMS Client needs to activate a QoS Flow
with a matching bit rate setting.
NOTE: The 5GMS Client may choose to activate a QoS Flow with a lower bit rate
than the maximum supported by the 5G System, e.g. a small screen SmartPhone
may select different QoS settings from a large screen device.
The per-title quality and the subscription levels of an example on-demand
catalogue are illustrated in the figure below. The subscription levels in this
example are 4K, FullHD, HD, SD and 480p. Only devices entitled to activate a
4K quality should actually select the according representations from the MPDs.
In this example, all titles are available in SD and HD quality. Often, not all
titles are available in 4K quality. Thus, a device with a 4K subscription can
only activate reception of the HD or SD representations.
{width="5.09375in" height="3.75in"}
Figure A.2.1‑1: Subscription Levels for Premium QoS
The bit rate required to sustain a certain quality varies from title to title.
In the figure, the bit rate needed for _Title4_ in HD is in the same range as
SD quality of _Title3_.
The various consumer-facing Network Subscription Levels define a set of
bounded Operation Ranges, as illustrated on the right side of the figure. Each
such Operation Range is conveniently modelled in the 5GMS architecture as a
Policy Template. The Policy Template for SD subscription level (_SD Operation
Range_) is authorized to activate a maximal bit rate of _btr#1_. The Policy
Template for 4K subscription level is authorized to activate between any low
bit rate and a maximal bit rate of _btr#3_.
When activating a Dynamic Policy instance, the 5GMSd Client provides a desired
bit rate for the selected title. The desired bit rate can be smaller than the
maximal bit rate allowed by the Policy Template. The 5GMSd Client always
activates a Dynamic Policy instance from its assigned Network Subscription
Level, even when the desired bit rate justifies a different Policy Template.
When activating a QoS Flow for a certain subscription level and title, the
5GMSd Client should preferably select a desired bit rate matching the quality
needed. For example, a device with an _HD Operation Range_ subscription needs
a higher desired bit rate when consuming _Title3_ in HD quality and a lower
desired bit rate when consuming _Title4_ in HD quality.
In some cases, the system rejects a requested QoS Flow or drops an established
QoS Flow due to insufficient available network resource. The 5GMSd Client can
then try to activate a different QoS Flow with a lower desired bit rate.
## A.2.2 Procedure
The procedure for activating a Premium Qos dynamic policy is illustrated in
figure A.2.2‑1 below.
Figure A.2.2-1: Procedure for activating Premium QoS dynamic policy
Steps:
1\. The 5GMS Application Provider interacts with the 5GMS AF to set up one or
more Policy Templates (using M1). Each Policy Template is identified by a
Policy Template identifier and contains information about how to activate the
corresponding policy within the 5G System (e.g. N5 URLs and parameters).
2\. The 5GMS Application Provider interacts with its DASH content generation
function (e.g. an MPD provider) to annotate the DASH MPD with Service
Descriptions (using P1). The Service Descriptions define the Operational
Ranges within the Media Player should operate. The DASH MPD and the DASH Media
Segments are then ingested by the 5GMS AS.
3\. The 5GMS-Aware Application is configured via M8 (step 3) with information
about the available content catalogue (e.g. resolving MPD URLs), the available
subscription identifiers (e.g. the user has a 4K subscription or the user has
an SD subscription), device type identifiers and network policy identifiers.
The subscription identifiers and the device type identifiers are collectively
referred to as Service Description Filters in the following.
NOTE 1: It is for further study whether network policy identifiers are
embedded in the MPD Service Descriptions or derived from the Service
Descriptions.
NOTE 2: The network policy identifier can be equal to a Policy Template
identifier when the 5GMS-Aware Application is aware about its usage (e.g. for
QoS streaming or background download). It is assumed here, that a unique
Network Policy identifier is assigned to each subscription level.
4\. When the user selects an item via the User Interface (U1), the 5GMS-Aware
Application translates the input to the needed 5GMSd API calls.
5\. The 5GMS-Aware Application provides input (via C1) on the selected
presentation entry (i.e. MPD URL) together with a Network Policy Identifier
(the value indicates here a \"HD Premium QoS\" policy (alternative Network
Policy Identifiers can refer to e.g. 4K quality), i.e. make the Media Session
Handler request a QoS Flow) and Service Description Filters. The Service
Description Filter is used by the Media Player to identify the usable Service
Descriptions from the MPD. The Network Policy Identifier is used by the Media
Session Handler to find the according Policy Description containing
information on the Dynamic Policy instantiation method (i.e. procedure and
parameters such as Policy Template identifier).
6\. The DASH player fetches the MPD.
7\. The Media Player selects the Service Description and applies the Service
Description Filter.
8\. The DASH player indicates to the Media Session Handler (M6) that a \"HD
Premium QoS\" network service should be activated (value of the Network Policy
Identifier). The DASH player provides input on bit rate ranges (which may
depend on the device type and the title quality). The Media Session Handler
has received one or more Policy Descriptions together with matching Service
Access Information (via M5_1). When the Media Session Handler has received the
policy indication, the Media Session Handler uses the Network Policy
Identifier to find the procedure and the parameters to activate the Dynamic
Policy instance (i.e. find the matching Policy Description). The Media Session
Handler activates a Dynamic Policy instance in the 5GMS AF, providing Service
Data Flow Templates identifying the DASH media flows (audio, video, etc) and
to provide the desired bit rate of the video.
9\. The Media Session Handler activates a Dynamic Policy instance with the
5GMS AF. The 5GMS AF uses the Policy Template identifier to look up the
matching Policy Template in order to create the PCF or NEF API invocation. As
result, the Media Session Handler receives the enforcement bit rate in the
5GMS AF response. The 5GMS Client should not exceed this bit rate threshold.
The Service Access Information (via M5_1) includes a list of recommended
traffic detection methods. The Media Session Handler selects a Service Data
Flow description method (e.g. 5-Tuples). When the Media Session Handler
selects:
\- 5-Tuples: For each new TCP connection, the Media Session Handler updates
the Dynamic Policy instances and adds a new 5-Tuple. For each closed TCP
connection, the Media Session Handler updates the Dynamic Policy instances and
removes the 5-Tuple of the closed TCP connection.
\- TOS or Traffic Class: The Media Session Handler sets the TOS or Traffic
Class for each new TCP connection.
\- Domain name: The Media Session Handler provides the domain name with the
Dynamic Policy Instance.
## A.2.3 Example parameters
Table A.2.3‑1: M5_1 parameters for Policy Descriptions (used by the Media
Session Handler)
+------------------+--------+------------------+------------------+ | Parameter | Type | Purpose | Example Values | +==================+========+==================+==================+ | Policy | Object | | | | Description | | | | +------------------+--------+------------------+------------------+ | Network Policy | String | Identifies the | \"4K Premium | | Identifier | | Policy | QoS\", | | | | Description. | | | | | | \"HD Premium | | | | | QoS\". | +------------------+--------+------------------+------------------+ | Service Access | URL | References the | | | Information URL | | associated | | | | | Service Access | | | | | Information. | | +------------------+--------+------------------+------------------+
Table A.2.3‑2: M5_1 parameters for Service Access Information
+-----------------+------------+-----------------+-----------------+ | Parameter | Type | Purpose | | +=================+============+=================+=================+ | Service Access | Object | | | | Information | | | | +-----------------+------------+-----------------+-----------------+ | Policy Template | String | Identifies the | \"HD QoS\". | | identifier | | Policy | | | | | Template. | | +-----------------+------------+-----------------+-----------------+ | 5GMS AF URL | URL | Used to invoke | | | | | the 5GMS AF. | | +-----------------+------------+-----------------+-----------------+ | Mandatory | List | Desired bit | Policy Template | | Request M5 | | rate, which | identifier, | | information | | should be | | | | | provided by the | Desired Bit | | | | network for the | Rate, | | | | application. | | | | | | Packet | | | | | Detection | | | | | Filters. | +-----------------+------------+-----------------+-----------------+ | M5 Response | List | Information to | OK (requested | | information | | the Media | bit rate is | | | | Session Handler | accepted), | | | | on the response | | | | | parameters. | Proposed Lower | | | | | Bit rate | | | | | (requested bit | | | | | rate cannot be | | | | | provided). | +-----------------+------------+-----------------+-----------------+ | sdfMethod | [String] | Indicates which | \"5-Tuple\", | | | | Service Data | | | | | Flow | \"domainName\", | | | | Description | | | | | methods are | \"TOS=xx\", | | | | recommended to | etc. | | | | be used by the | | | | | Media Session | | | | | Handler. | | +-----------------+------------+-----------------+-----------------+
# A.3 (Conditional) Zero Rating dynamic policy
## A.3.1 General
In the case of (Conditional) Zero Rating, the quality of a video streaming
service should not exceed a certain bit rate threshold (called the policy
threshold). This can be realized by deploying a traffic shaper in the network
(e.g. a policing function in the UPF) or by instructing the DASH Player not to
exceed a certain policy threshold bit rate. The policy threshold may be
network-specific, i.e. depending on the 5G System. The following realization
assumes the latter, i.e. the DASH Player is not exceeding the bit rate policy
and the UPF is just monitoring the compliance of the application flows (one or
more TCP and/or UDP flows). The MPD is annotated using DASH Service
Descriptions in such a way that the DASH Player can identify which maximal
representation bit rates still comply with the policy threshold.
Figure A.3.1-1 below illustrates the per-title quality and the policy
threshold. For _Title1_ and _Title2_ , the 5GMSd Client can activate the SD
and HD representations. For _Title3_ , the 5GMSd Client can activate the 480p
and the SD representations. For _Title4_ , the 5GMSd Client can activate all
available representations (i.e. SD and HD).
{width="4.916868985126859in" height="3.46875in"}
Figure A.3.1‑1: Policy threshold versus quality
When the 5GMSd Client receives the bit rate of the policy threshold from the
network, the 5GMSd Client filters the MPD for policy-compliant representations
(i.e. those that lie at or below the policy threshold).
## A.3.2 Procedure
The procedure for activating a (Conditional) Zero Rating dynamic policy is
illustrated in figure A.3.2‑1 below.
Figure A.3.2‑1: Procedure for activating (Conditional) Zero Rating dynamic
policy
Steps:
1\. The 5GMS Application Provider interacts with the 5GMS AF to set up one or
more Policy Templates. Each Policy Template is identified by a Policy Template
identifier and contains information about how to activate the corresponding
policy within the 5G System (e.g. N5 URLs and parameters).
2\. The 5GMS Application Provider interacts with its DASH content generation
function (e.g. an MPD provider) to annotate the DASH MPD with Service
Descriptions (step 2). The intention of the Service Descriptions here is that
the DASH Player can identify those representation combinations which do not
exceed the bit rate requirement.
3\. The 5GMSAware Application is configured via M8 with information about the
available content catalogue (e.g. resolving MPD URLs), the available
subscription identifiers (e.g. the user has a 4K content subscription or the
user has an SD subscription), device type identifiers.
The 5GMSd-Aware Application is configured via M8 about the available
(Conditional) Zero Rating policy. This includes the Network Policy Ids.
4\. When a user selects an item via the User Interface (U1), the 5GMS-Aware
Application translates the input to the needed 5GMSd API calls.
5\. The 5GMS Aware Application provides input (via C1) on the selected
presentation entry (i.e. MPD URL) and also on the Network Policy Id (the value
in this case indicates a (Conditional) Zero-Rating policy, i.e. make the Media
Session Handler request the policy threshold parameter from the network).
NOTE: C1 is an abstract interface and indicates that the 5GMS-Aware
Application may either first use M6 or M7 for the interactions with the 5GMS
Client.
6\. The Media Session Handler uses the Network Policy Identifier to find the
procedure and the parameters to activate the Dynamic Policy Instance (here a
(Conditional) Zero Rating policy). The Media Session Handler has received one
or more Policy Descriptions together with matching Service Access Information
(via M5_1). The Media Session Handler uses the Network Policy Identifier as a
key to find the correct Policy Description. Here, the Network Policy
Identifier indicates a (Conditional) Zero Rating policy. The Media Session
Handler should activate a dynamic policy in the 5GMS AF, providing Service
Data Flow Template information about the DASH media flows (audio, video, etc.)
and retrieving the bit rate threshold, which cannot be exceeded to comply with
the policy. The Media Session Handler receives (as result of the Dynamic
Policy activation) some information on the policy enforcement
(_enforcementMethod_ and/or _enforcementBitrate_), so that the representation
selection logic (bit rate adaptation function) in the DASH Player can consider
the effects of the enforcement scheme.
7\. The Media Session Handler activates the Dynamic Policy instance on M5,
providing a Policy Template identifier. Upon positive response, the Media
Session Handler notifies the DASH Player, providing Service Descriptor
Filters. The Media Session Handler may receive these Service Descriptor
Filters with the response, or it may look up the Service Descriptor Filter
values by a response value. Alternatively, the Media Session Handler receives
a maximum bit rate with the response and the Media Session Handler derives the
Service Descriptor Filter. The Media Session Handler may also receive
information about Policy Enforcement, e.g. what type of traffic shaper will
throttle the bit rate.
The Media Session Handler may need to update the Dynamic Policy instance,
depending on the selected traffic detection method. For example, when the
Media Session Handler uses 5-Tuples, the Media Session Handler needs to update
the Dynamic Policy instance with every newly opened and every closed TCP
connection.
8\. The DASH Player fetches the MPD of the selected content.
9.The Service Descriptor Filter is used by the DASH Player to filter policy-
compliant Service Descriptions from the MPD. The DASH Access Engine or
Selection Logic (see ISO/IEC 23009-1 [32] figure K.1) selects only adaptation
sets and representations according to the filter. Here, the DASH Player
fetches the MPD after the notification from the Media Session Handler.
## A.3.3 Example parameters
Table A.3.3‑1: M5_1 parameters for Policy Descriptions (used by the Media
Session Handler)
Parameter Type Purpose Example Values
* * *
Policy Description Object  
Network Policy Id String Identifies the Policy Description. \"(Conditional)
Zero Rating\". Service Access Information URL URL References the associated
Service Access Information.
Table A.3.3.‑2: M5_1 parameters for Service Access Information
+-----------------+------------+-----------------+-----------------+ | Parameter | Type | Purpose | | +=================+============+=================+=================+ | Service Access | Object | | | | Information | | | | +-----------------+------------+-----------------+-----------------+ | Policy Template | String | Identifies the | \"not exceed | | Id | | Policy | bit rate\" | | | | Template. | | +-----------------+------------+-----------------+-----------------+ | 5GMS AF URL | URL | Used to invoke | | | | | the 5GMS AF. | | +-----------------+------------+-----------------+-----------------+ | sdfMethods | [String] | Indicates which | \"5-Tuple\", | | | | Service Data | | | | | Flow | \"domainName\", | | | | Description | | | | | methods are | \"TOS=xx\", | | | | recommended for | etc. | | | | use by the | | | | | Media Session | | | | | Handler. | | +-----------------+------------+-----------------+-----------------+ | Mandatory M5 | List | | Policy Template | | Request | | | identifier, | | information | | | | | | | | Service Data | | | | | Flow Template. | +-----------------+------------+-----------------+-----------------+ | M5 Response | List | Information to | Bit rate Policy | | information | | the Media | Threshold | | | | Session Handler | (upper bit rate | | | | on the response | bound, which | | | | parameters. | should not be | | | | | exceeded). | +-----------------+------------+-----------------+-----------------+
# A.4 Background Download
## A.4.1 General
In the case of Background Download, the asset is acquired in the background,
prior to viewing. Many application services offer the capability of acquiring
a VoD item for later consumption. The 5GMS-Aware Application triggers the
Media Session Handler to acquire the item, providing a background download
network policy id.
NOTE: Here, the DASH Player is handling the acquisition, since the DASH Player
contains the MPD processing and the DASH Access engine parts. Other
realizations would use a separate background download agent, which is not even
try to decode and render the video.
Figure A.4.1‑1 below illustrates the representation marking for background
download. The MPD may be annotated with Service Descriptions clearly
identifying representations intended for download. Here, _Title1_ should be
downloaded in Full HD quality and all other titles in regular HD quality.
{width="4.644667541557306in" height="4.010416666666667in"}
Figure A.4.1‑1: Background Download Representations
## A.4.2 Procedure
The procedure for activating a Background Download dynamic policy is
illustrated in figure A.3.2‑1 below.
Figure A.3.2‑1: Procedure for activating Background Download dynamic policy
Steps:
1\. The 5GMS Application Provider interacts with the 5GMS AF to set up one or
more Policy Templates (M1). Each Policy Template is identified by a Policy
Template identifier and contains information about how to activate the
according policy within the 5G System (e.g. N5 URLs and parameters).
2\. The 5GMS Application Provider also interacts with its DASH content
generation function (e.g. an MPD provider) to annotate the DASH MPD with
Service Descriptions, e.g. to identify, which representation is intended for
background download.
3\. The 5GMS-Aware Application is configured via M8 with information about the
available content catalogue (e.g. resolving MPD URLs), the available
subscription identifiers (e.g. the user has a 4K subscription or the user has
an SD subscription), device type identifiers.
The 5GMSd-Aware Application is configured via M8 about the available
background download policy. This includes the Network Policy Id which hints a
background download policy.
4\. When a user selects an item via the User Interface (U1) for Background
Download the 5GMS-Aware Application translates the input to the needed 5GMSd
API calls.
5\. The 5GMS-Aware Application provides input (via C1) on the selected
presentation entry (i.e. MPD URL) and also on the Network Policy Identifier
(indicating a background download policy, i.e. make the Media Session Handler
request a bearer suitable for Background Download).
NOTE: C1 is an abstract interface and indicates that the 5GMS-Aware
Application may either first use M6 or M7 for the interactions with the 5GMS
Client.
6\. The Media Session Handler uses the Network Policy Identifier to find the
procedure and the parameters to activate the Dynamic Policy Instance (here a
Background Download policy). The Media Session Handler has received one or
more Policy Descriptions together with matching Service Access Information
(via M5_1). The Media Session Handler uses the Network Policy Identifier as a
key to find the correct Policy Description. The Media Session Handler should
activate a Dynamic Policy in the 5GMS AF, providing Service Data Flow Template
information of the media flows (audio, video, etc). The Media Session Handler
can also receive information on a bit rate policing (_enforcementMethod_
and/or _enforcementBitrate_), e.g. that the bit rate is actively limited.
7\. The Media Session Handler activates the Dynamic Policy instance on M5,
providing the Policy Template identifier and additional parameters. Upon
positive response, the Media Session handler notifies the DASH Player to start
the Background Download. The notification contains a Service Descriptor
Filters, which is used by the DASH Player to filter policy-compliant Service
Descriptions from the MPD. The Media Session Handler may receive the Service
Descriptor Filters with the response or may look up the Service Descriptor
Filter values by a response value (e.g. derived from a maximum bit rate
indication).
The Media Session Handler may need to update the Dynamic Policy instance,
depending on the selected traffic detection method. For example, when the
Media Session Handler uses 5-Tuples, it needs to update the Dynamic Policy
instance with every newly opened and every closed TCP connection.
8\. The DASH Player fetches the MPD of the selected content.
9\. The DASH Access Engine / Selection Logic (see ISO 23009-1 [32] figure K.1)
selects only adaptation sets and representations according to the filter (i.e.
suitable for Background Download). Here, the DASH Player fetches the MPD after
the notification from the Media Session Handler.
## A.4.3 Example parameters
Table A.4.3‑1: M5_1 Parameters for Policy Descriptions (used by the Media
Session Handler)
Parameter Type Purpose Example Values
* * *
Policy Description Object  
Network Policy Id String Identifies the Policy Description. \"Background
Download\". Service Access Information URL URL References the associated
Service Access Information.
Table A.4.3‑2: M5_1 Parameters for Service Access Information
+-----------------+------------+-----------------+-----------------+ | Parameter | Type | | | +=================+============+=================+=================+ | Service Access | Object | | | | Information | | | | +-----------------+------------+-----------------+-----------------+ | Policy Template | String | Identifies the | \"ba | | Id | | Policy | ckgrounddata\". | | | | Template. | | +-----------------+------------+-----------------+-----------------+ | 5GMS AF URL | URL | Used to invoke | | | | | the 5GMS AF. | | +-----------------+------------+-----------------+-----------------+ | sdfMethods | [String] | Indication, | \"5-Tuple\", | | | | which Service | | | | | Data Flow | \"domainName\", | | | | Description | | | | | methods are | \"TOS=xx\", | | | | recommended to | etc. | | | | use by the | | | | | media session | | | | | handler. | | +-----------------+------------+-----------------+-----------------+ | Mandatory M5 | List | Desired bit | Policy Template | | Request | | rate, to be | Id, | | information | | provided by the | | | | | network for the | Average Bit | | | | application. | rate, | | | | | | | | | | Service Data | | | | | Flow Template. | +-----------------+------------+-----------------+-----------------+ | M5 Response | List | Information to | | | information | | the Media | | | | | Session Handler | | | | | on the response | | | | | parameters. | | +-----------------+------------+-----------------+-----------------+
###### ## Annex B (informative): Content Hosting Configuration examples
# B.1 Pull-based content ingest example
## B.1.1 Overview
1\. The 5GMSd Client on the UE requests a media resource via M4d.
2\. The 5GMSd AS determines that it does not have a cached copy of the
requested media resource.
3\. The 5GMSd AS transforms the M4d request URL into a request to the 5GMSd
Application Provider\'s origin server via M2d.
## B.1.2 Desired URL mapping
In the example shown in table B.1.2‑1 below, media resources are exposed at
M4d from a default canonical domain 5gmsd-as.mno.net determined by the 5GMSd
System operator, and also from a custom domain name alias mno‑cdn.5gmsd-ap.com
that has been configured by the 5GMSd Application Provider.
Table B.1.2‑1: Example URL mapping for pull-based ingest
* * *
M4d request from 5GMSd Client Mapped M2d request to origin server\ on 5GMSd AS
cache miss
* * *
https://**5gmsd-as.mno.net** /m4d/provisioning-session9876/‌**asset123456**
/**video1** /segment1000.mp4 https://origin.5gmsd-
ap.com/‌media/‌**asset123456** /**video1** /segment1000.mp4
https://**mno-cdn.5gmsd-ap.com** /m4d/provisioning-
session9876/‌**asset123456** /**video1** /segment1000.mp4
https://**5gmsd-as.mno.net** /m4d/provisioning-session9876/‌**asset123456**
/**video2** /segment1000.mp4 https://origin.5gmsd-
ap.com/‌media/‌**asset123456** /**video2** /segment1000.mp4
https://**mno-cdn.5gmsd-ap.com** /m4d/provisioning-
session9876/‌**asset123456** /**video2** /segment1000.mp4
https://**5gmsd-as.mno.net** /m4d/provisioning-session9876/‌**asset123456**
/**audio1** /segment1000.mp4 https://origin.5gmsd-
ap.com/‌media/‌**asset123456** /**audio1** /segment1000.mp4
https://mno-cdn.5gmsd-ap.com/m4d/provisioning-session9876/‌**asset123456**
/**audio1** /segment1000.mp4
* * *
## B.1.3 Content Hosting Configuration
Table B.1.3‑1 below shows the relevant Content Hosting Configuration
parameters needed to achieve the example mapping described in table B.1.2‑1
above.
Table B.1.3‑1: Content Hosting Configuration properties relevant to pull-based
ingest
+----------------------+----------------------+----------------------+ | Property | Example value | Set by | +======================+======================+======================+ | * | | | | IngestConfiguration _| | | +----------------------+----------------------+----------------------+ |_ protocol _| urn:3gpp:5g | 5GMSd Application | | | ms:content-protocol: | Provider | | |__http-pull-ingest_ _| | +----------------------+----------------------+----------------------+ |_ pull _| true | | +----------------------+----------------------+----------------------+ |_ baseURL _| https://origi | | | | n.5gmsd-ap.com/media | | +----------------------+----------------------+----------------------+ |_ Distri | | | | butionConfiguration _| | | +----------------------+----------------------+----------------------+ | * | 5gmsd-as.mno.net | 5GMSd AF | | canonicalDomainName_ | | | | | | _(M1d response)_ | +----------------------+----------------------+----------------------+ | _domainNameAlias_ | mno-cdn.5gmsd-ap.com | 5GMSd Application | | | | Provider | +----------------------+----------------------+----------------------+ | _baseURL_ | https://mno-cdn.5gm | 5GMSd AF\ | | | sd-ap.com/m4d/‌provi | _(M1d response)_ | | | sioning-session9876/ | | +----------------------+----------------------+----------------------+
# B.2 Push-based content ingest example
## B.2.0 Overview
1\. The 5GMSd Application Provider uploads content to the 5GMSd AS via M2d.
2\. The 5GMSd AS rewrites the M2d upload URL to an M4d downlink URL that is
exposed to the 5GMSd Client on the UE.
## B.2.1 Desired URL mapping
In the example shown in table B.2.1‑1, media resources are pushed into the
5GMSd AS at M2d by the 5GMSd Application Provider and exposed to the 5GMSd
Client at M4d using the canonical name of the 5GMSd AF 5gmsd-as.mno.net and an
additional domain name alias mno-cdn.5gmsd-ap.com configured by the 5GMSd
Application Provider.
Table B.2.1‑1: Example URL mapping for pull-based ingest
M2d ingest URL pushed to 5GMSd AS M4d URL exposed to 5GMSd Client
* * *
https://5gmsd-as.mno.net/m2d/provisioning-session9876/‌**asset123456**
/**video1** /segment1000.mp4 https://**5gmsd-as.mno.net** /m4d/provisioning-
session9876/‌**asset123456** /**video1** /segment1000.mp4 https://**mno-
cdn.5gmsd-ap.com** /m4d/provisioning-session9876/‌**asset123456** /**video1**
/segment1000.mp4 https://5gmsd-as.mno.net/m2d/provisioning-
session9876/‌**asset123456** /**video2** /segment1000.mp4 https://**5gmsd-
as.mno.net** /m4d/provisioning-session9876/‌**asset123456** /**video2**
/segment1000.mp4 https://**mno-cdn.5gmsd-ap.com** /m4d/provisioning-
session9876/‌**asset123456** /**video2** /segment1000.mp4 https://5gmsd-
as.mno.net/m2d/provisioning-session9876/‌**asset123456** /**audio1**
/segment1000.mp4 https://**5gmsd-as.mno.net** /m4d/provisioning-
session9876/‌**asset123456** /**audio1** /segment1000.mp4 https://**mno-
cdn.5gmsd-ap.com** /m4d/provisioning-session9876/‌**asset123456** /**audio1**
/segment1000.mp4
## B.2.2 Content Hosting Configuration
Table B.2.2‑1 below shows the relevant Content Hosting Configuration
parameters needed to achieve the example mapping described in table B.2.1‑1
above.
Table B.2.2‑1: Content Hosting Configuration properties relevant to push-based
ingest
* * *
Property Example value Set by
* * *
_IngestConfiguration_
_protocol_ urn:3gpp:5gms:content-protocol:**dash-if-ingest** 5GMSd Application
Provider\ _(M1d request)_
_pull_ false
_baseURL_ https://5gmsd-as.mno.net/‌m2d/‌provisioning-session9876/
_DistributionConfiguration_
_canonicalDomainName_ 5gmsd-as.mno.net 5GMSd Application Provider\ _(M1d
response)_
_domainNameAlias_ mno-cdn.5gmsd-ap.com 5GMSd Application Provider\ _(M1d
response)_
_baseURL_ https://5gmsd-as.mno.net/‌m4d/‌provisioning-session9876/ 5GMSd
Application Provider\ _(M1d response)_
* * *
###### ## Annex C (normative): OpenAPI representation of the 5GMS HTTP REST
APIs
# C.1 General
This annex is based on the OpenAPI 3.0.0 specification [23] and provides
corresponding representations of all APIs defined in the present document.
NOTE 1: An OpenAPIs representation embeds JSON Schema representations of HTTP
message bodies.
This Annex shall take precedence when being discrepant to other parts of the
present document with respect to the encoding of information elements and
methods within the API(s).
NOTE 2: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
# C.2 Data Types applicable to several APIs
For the purpose of referencing entities defined in this clause, it shall be
assumed that the OpenAPI definitions below are contained in a physical file
named \"TS26512_CommonData.yaml\".
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: 5GMS Common Data Types | | | | version: 1.0.2 | | | | description: \| | | | | 5GMS Common Data Types | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: 5GMS Common Data Types | | | | description: \'5G Media Streaming: Common Data Types\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | paths: {} | | | | components: | | | | schemas: | | | | | | ################################# | | | | # Clause 6.4.2: Simple data types | | | | | | ################################# | | | | ResourceId: | | | | type: string | | | | description: Strin | | g chosen by the 5GMS AF to serve as an identifier in a resource URI. | | | | Percentage: | | | | type: number | | | | minimum: 0.0 | | | | maximum: 100.0 | | | | #DurationSec is defined in TS29571_CommonData | | | | #DateTime is defined in TS29571_CommonData | | | | #Uri is defined in TS29571_CommonData | | | | Url: | | | | type: string | | | | format: uri-reference | | | | descriptio | | n: \'Uniform Resource Locator, conforming with the \"URI-reference\" | | production specified in IETF RFC 3986, section 4.1.\' | | | | RelativeUrl: | | | | type: string | | | | format: uri-reference | | | | description: \'Relative Uniform Resource Locator, conforming | | with the \"relative-ref\" production specified in IETF RFC 3986, | | section 4.2. Note that both \"query\" and \"fragment\" suffixes are | | permitted by this production.\' | | | | AbsoluteUrl: | | | | type: string | | | | format: uri | | | | description: \'Absolute Uniform Resource Locator, conforming | | with the \"absolute-URI\" production specified in IETF RFC 3986, | | section 4.3 in which the scheme part is \"http\" or \"https\". Note | | that the \"query\" suffix is permitted by this production but the | | \"fragment\" suffix is not.\' | | | | ### | | ################################## | | | | # Clause 6.4.3: Structured data types | | | | ### | | ################################## | | | | IpPacketFilterSet: | | | | type: object | | | | required: | | | | - direction | | | | properties: | | | | srcIp: | | | | type: string | | | | dstIp: | | | | type: string | | | | protocol: | | | | type: integer | | | | srcPort: | | | | type: integer | | | | dstPort: | | | | type: integer | | | | toSTc: | | | | type: string | | | | flowLabel: | | | | type: integer | | | | spi: | | | | type: integer | | | | direction: | | | | type: string | | | | ServiceDataFlowDescription: | | | | oneOf: | | | | - type: object | | | | required: | | | | - flowDescription | | | | properties: | | | | flowDescription: | | | | \$ref: \'#/components/schemas/IpPacketFilterSet\' | | | | - type: object | | | | required: | | | | - domainName | | | | properties: | | | | domainName: | | | | type: string | | | | M5QoSSpecification: | | | | type: object | | | | required: | | | | - marBwDlBitRate | | | | - marBwUlBitRate | | | | - mirBwDlBitRate | | | | - mirBwUlBitRate | | | | properties: | | | | marBwDlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | marBwUlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | minDesBwDlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | minDesBwUlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | mirBwDlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | mirBwUlBitRate: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | desLatency: | | | | type: integer | | | | minimum: 0 | | | | desLoss: | | | | type: integer | | | | minimum: 0 | | | | M1QoSSpecification: | | | | type: object | | | | properties: | | | | qosReference: | | | | type: string | | | | maxBtrUl: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | maxBtrDl: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | maxAuthBtrUl: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | maxAuthBtrDl: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/BitRate\' | | | | defPacketLossRateDl: | | | | type: integer | | | | minimum: 0 | | | | defPacketLossRateUl: | | | | type: integer | | | | minimum: 0 | | | | ChargingSpecification: | | | | type: object | | | | properties: | | | | sponId: | | | | type: string | | | | sponStatus: | | | | \$ref: \'TS29514_Np | | cf_PolicyAuthorization.yaml#/components/schemas/SponsoringStatus\' | | | | gpsi: | | | | type: array | | | | items: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Gpsi\' | | | | TypedLocation: | | | | type: object | | | | required: | | | | - locationIdentifierType | | | | - location | | | | properties: | | | | locationIdentifierType: | | | | \$ref: \'#/components/schemas/CellIdentifierType\' | | | | location: | | | | type: string | | | | OperationSuccessResponse: | | | | type: object | | | | required: | | | | - success | | | | properties: | | | | success: | | | | type: boolean | | | | reason: | | | | type: string | | | | ### | | ################################## | | | | # Clause 6.4.4: Enumerated data types | | | | ### | | ################################## | | | | CellIdentifierType: | | | | anyOf: | | | | - type: string | | | | enum: [CGI, ECGI, NCGI] | | | | - type: string | | | | description: > | | | | This string provides forward-compatibility with future | | | | extensions to the enumeration but is not used to encode | | | | content defined in the present version of this API. | | | | SdfMethod: | | | | anyOf: | | | | - type: string | | | | enum: [5_TUPL | | E, 2_TUPLE, TYPE_OF_SERVICE_MARKING, FLOW_LABEL, DOMAIN_NAME] | | | | - type: string | | | | description: > | | | | This string provides forward-compatibility with future | | | | extensions to the enumeration but is not used to encode | | | | content defined in the present version of this API. | | | | ProvisioningSessionType: | | | | anyOf: | | | | - type: string | | | | enum: [DOWNLINK, UPLINK] | | | | - type: string | | | | description: > | | | | This string provides forward-compatibility with future | | | | extensions to the enumeration but is not used to encode | | | | content defined in the present version of this API. | +----------------------------------------------------------------------+
# C.3 OpenAPI representation of the M1 APIs
## C.3.1 M1_ProvisioningSessions API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ProvisioningSessions | | | | version: 1.1.1 | | | | description: \| | | | | 5GMS AF M1 Provisioning Sessions API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ProvisioningSessions | | | | description: \ | | '5G Media Streaming: Provisioning (M1) APIs: Provisioning Sessions\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.9.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisioning-sessions: | | | | post: | | | | operationId: createProvisioningSession | | | | summary: \'Create a new Provisioning Session\' | | | | responses: | | | | \'201\': | | | | description: \'Provisioning Session Created\' | | | | headers: | | | | Location: | | | | description: \'URL including | | the resource identifier of the newly created Provisioning Session.\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/ProvisioningSession\' | | | | /provisioning-sessions/{provisioningSessionId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | get: | | | | operationId: getProvisioningSessionById | | | | summary: \'Retrieve an existing Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/ProvisioningSession\' | | | | delete: | | | | operationId: destroyProvisioningSession | | | | summary: \'Destroy an existing Provisioning Session\' | | | | responses: | | | | \'204\': | | | | description: \'Provisioning Session Destroyed\' | | | | # No Content | | | | components: | | | | schemas: | | | | ProvisioningSession: | | | | type: object | | | | description: \"A representation of a Provisioning Session.\" | | | | required: | | | | - provisioningSessionId | | | | - provisioningSessionType | | | | properties: | | | | provisioningSessionId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | provisioningSessionType: | | | | \$ref: \'TS2 | | 6512_CommonData.yaml#/components/schemas/ProvisioningSessionType\' | | | | aspId: | | | | \$ref: \' | | TS29514_Npcf_PolicyAuthorization.yaml#/components/schemas/AspId\' | | | | serverCertificateIds: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | minItems: 1 | | | | contentPreparationTemplateIds: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | minItems: 1 | | | | metricsReportingConfigurationIds: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | minItems: 1 | | | | policyTemplateIds: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | minItems: 1 | +----------------------------------------------------------------------+
## C.3.2 M1_ServerCertificatesProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ServerCertificatesProvisioning | | | | version: 1.1.1 | | | | description: \| | | | | 5GMS AF M1 Server Certificates Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ServerCertificatesProvisioning | | | | description: \'5G Media S | | treaming: Provisioning (M1) APIs: Server Certificates Provisioning\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.10.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisioning-sessions/{provisioningSessionId}/certificates: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descrip | | tion: The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: createOrReserveServerCertificate | | | | summary: \'Create or reserve a Service Certificate resource\' | | | | description: \'Without the o | | ptional csr query parameter, an X.509 certificate is generated and t | | his is returned. If the csr query parameter is present, a Certificat | | e Signing Request is instead generated and returned, allowing the X. | | 509 certificate to be generated by the invoker and later uploaded.\' | | | | parameters: | | | | - in: query | | | | name: csr | | | | schema: | | | | type: string | | | | description: \'When present, return a Cert | | ificate Signing Request instead of generating an X.509 certificate\' | | | | requestBody: | | | | description: \'An optional list of domain name aliases to be | | included in the returned Certificate Signing Request\' | | | | content: | | | | \'application/json\': | | | | schema: | | | | type: array | | | | items: | | | | type: string | | | | responses: | | | | \'200\': | | | | description: \'Server Certificate Created\' | | | | headers: | | | | Location: | | | | d | | escription: \'URL of the newly created Server Certificate resource\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Url\' | | | | content: | | | | \'application/x-pem-file\': | | | | schema: | | | | type: string | | | | | | | | /provisi | | oning-sessions/{provisioningSessionId}/certificates/{certificateId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descrip | | tion: The resource identifier of an existing Provisioning Session.\' | | | | - name: certificateId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descri | | ption: \'The resource identifier of an existing Server Certificate\' | | | | put: | | | | operationId: uploadServerCertificate | | | | summary: \"Upload the X.509 | | certificate for a previously reserved Server Certificate resource\" | | | | requestBody: | | | | required: true | | | | content: | | | | application/x-pem-file: | | | | schema: | | | | type: string | | | | responses: | | | | \'204\': | | | | description: \'Server Certificate Updated\' | | | | get: | | | | operationId: retrieveServerCertificate | | | | summary: \'Retrieve the X.509 certi | | ficate representation of the specified Server Certificate resource\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | \'application/x-pem-file\': | | | | schema: | | | | type: string | | | | \'204\': | | | | description: \'Awaiting Upload\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyServerCertificate | | | | summary: \'Destroy an existing Server Certificate resource\' | | | | responses: | | | | \'200\': | | | | # OK | | | | description: \'Server Certificate Destroyed\' | | | | content: | | | | \'application/x-pem-file\': | | | | schema: | | | | type: string | | | | \'204\': | | | | # No Content | | | | description: \'Server Certificate Destroyed\' | | | | \'404\': | | | | # Not Found | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/404\' | | | | \'409\': | | | | # Conflict | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/409\' | | | | \'410\': | | | | # Gone | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/410\' | +----------------------------------------------------------------------+
## C.3.3 M1_ContentPreparationTemplatesProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ContentPreparationTemplatesProvisioning | | | | version: 1.1.0 | | | | description: \| | | | | 5GMS AF M1 Content Preparation Templates Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ContentPreparationTemplatesProvisioning | | | | description: \'5G Media Streaming: | | Provisioning (M1) APIs: Content Preparation Templates Provisioning\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.9.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisio | | ning-sessions/{provisioningSessionId}/content-preparation-templates: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: createContentPreparationTemplate | | | | summary: \'Create (and optionally upload) a new C | | ontent Preparation Template for the specified Provisioning Session\' | | | | requestBody: | | | | description: \'A Content Preparation Template of any type\' | | | | required: true | | | | content: | | | | \'*/*\': | | | | schema: | | | | type: string | | | | responses: | | | | \'201\': | | | | description: \'Content Preparation Template Created\' | | | | headers: | | | | Location: | | | | des | | cription: \'URL of the newly created Content Preparation Template.\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | /provisioning-sessions/{provisioningSess | | ionId}/content-preparation-templates/{contentPreparationTemplateId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | - name: contentPreparationTemplateId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | description: \'Th | | e resource identifier of an existing Content Preparation Template.\' | | | | get: | | | | operationId: retrieveContentPreparationTemplate | | | | summary: \'Retrieve the specified | | Content Preparation Template of the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | \'*/*\': | | | | schema: | | | | type: string | | | | put: | | | | operationId: updateContentPreparationTemplate | | | | summary: \'Update the specified C | | ontent Preparation Template for the specified Provisioning Session\' | | | | requestBody: | | | | description: \'A Content Preparation Template of any type\' | | | | required: true | | | | content: | | | | \'*/*\': | | | | schema: | | | | type: string | | | | responses: | | | | \'204\': | | | | description: \'Updated Content Preparation Template\' | | | | \'404\': | | | | description: \'Not Found\' | | | | patch: | | | | operationId: patchContentPreparationTemplate | | | | summary: \'Patch the specified C | | ontent Preparation Template for the specified Provisioning Session\' | | | | requestBody: | | | | | | description: \'A Content Preparation Template patch of any type\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | type: string | | | | application/json-patch+json: | | | | schema: | | | | type: string | | | | responses: | | | | \'200\': | | | | description: \'Patched Content Preparation Templates\' | | | | content: | | | | \'*/*\': | | | | schema: | | | | type: string | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyContentPreparationTemplate | | | | summary: \'Destroy the specified | | Content Preparation Template of the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | # OK | | | | description: \'Content Preparation Template Destroyed\' | | | | content: | | | | \'*/*\': | | | | schema: | | | | type: string | | | | \'204\': | | | | # No Content | | | | description: \'Content Preparation Template Destroyed\' | | | | \'404\': | | | | # Not Found | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/404\' | | | | \'409\': | | | | # Conflict | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/409\' | | | | \'410\': | | | | # Gone | | | | \$ref: | | \'TS29571_CommonData.yaml#/components/responses/410\' | +----------------------------------------------------------------------+
## C.3.4 M1_ContentProtocolsDiscovery API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ContentProtocolsDiscovery | | | | version: 1.0.1 | | | | description: \| | | | | 5GMS AF M1 Content Protocols Discovery API | | | | © 2021, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ContentDiscovery | | | | description: \'5G Me | | dia Streaming: Provisioning (M1) APIs: Content Protocols Discovery\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.7.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisioning-sessions/{provisioningSessionId}/protocols: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | get: | | | | operationId: retrieveContentProtocols | | | | summary: \'Retrieve the set of | | Content Protocols supported by the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/ContentProtocols\' | | | | components: | | | | schemas: | | | | ContentProtocolDescriptor: | | | | type: object | | | | description: \"A descriptor describing a content protocol.\" | | | | required: | | | | - termIdentifier | | | | properties: | | | | termIdentifier: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | descriptionLocator: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Url\' | | | | ContentProtocols: | | | | type: object | | | | | | description: \"A representation of the Content Protocols resource.\" | | | | properties: | | | | downlinkIngestProtocols: | | | | type: array | | | | items: | | | | | | \$ref: \'#/components/schemas/ContentProtocolDescriptor\' | | | | minItems: 1 | | | | uplinkEgestProtocols: | | | | type: array | | | | items: | | | | | | \$ref: \'#/components/schemas/ContentProtocolDescriptor\' | | | | minItems: 1 | | | | geoFencingLocatorTypes: | | | | type: array | | | | items: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | minItems: 1 | +----------------------------------------------------------------------+
## C.3.5 M1_ContentHostingProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ContentHostingProvisioning | | | | version: 1.3.0 | | | | description: \| | | | | 5GMS AF M1 Content Hosting Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ContentHostingProvisioning | | | | description: \'5G Med | | ia Streaming: Provisioning (M1) APIs: Content Hosting Provisioning\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.9.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisio | | ning-sessions/{provisioningSessionId}/content-hosting-configuration: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: createContentHostingConfiguration | | | | summary: \'Create (and optionally upload) the Co | | ntent Hosting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | descr | | iption: \'A JSON representation of a Content Hosting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | responses: | | | | \'201\': | | | | description: \'Content Hosting Configuration Created\' | | | | headers: | | | | Location: | | | | description: \'URL of the | | newly created Content Hosting Configuration (same as request URL).\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | get: | | | | operationId: retrieveContentHostingConfiguration | | | | summary: \'Retrieve the C | | ontent Hosting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | put: | | | | operationId: updateContentHostingConfiguration | | | | summary: \'Update the Co | | ntent Hosting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | descr | | iption: \'A JSON representation of a Content Hosting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | responses: | | | | \'204\': | | | | description: \'Updated Content Hosting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | patch: | | | | operationId: patchContentHostingConfiguration | | | | summary: \'Patch the Co | | ntent Hosting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | descr | | iption: \'A JSON representation of a Content Hosting Configuration\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | application/json-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | responses: | | | | \'200\': | | | | description: \'Patched Content Hosting Configuration\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ContentHostingConfiguration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyContentHostingConfiguration | | | | summary: \'Destroy the current C | | ontent Hosting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'204\': | | | | description: \'Destroyed Content Hosting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | | | | | /provisioning-s | | essions/{provisioningSessionId}/content-hosting-configuration/purge: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | description: A unique identifier of the Provisioning | | | | post: | | | | operationId: purgeContentHostingCache | | | | summary: \'Purge the content of the cache for the C | | ontent Hosting Configuration of the specified Provisioning Session\' | | | | requestBody: | | | | description: \'Th | | e regular expression pattern for resources to purge from the cache\' | | | | required: true | | | | content: | | | | application/x-www-form-urlencoded: | | | | schema: | | | | properties: | | | | pattern: | | | | description: \'The regular expression\' | | | | type: string | | | | responses: | | | | \'200\': | | | | description: \'Content Purged\' | | | | components: | | | | schemas: | | | | IngestConfiguration: | | | | type: object | | | | description: \'A configuration for content ingest.\' | | | | properties: | | | | pull: | | | | type: boolean | | | | protocol: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | baseURL: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | PathRewriteRule: | | | | type: object | | | | description: \'A rule to manipulate URL paths.\' | | | | required: | | | | - requestPathPattern | | | | - mappedPath | | | | properties: | | | | requestPathPattern: | | | | type: string | | | | mappedPath: | | | | type: string | | | | CachingConfiguration: | | | | type: object | | | | description: \'A content caching configuration.\' | | | | required: | | | | - urlPatternFilter | | | | properties: | | | | urlPatternFilter: | | | | type: string | | | | cachingDirectives: | | | | type: object | | | | required: | | | | - noCache | | | | properties: | | | | statusCodeFilters: | | | | type: array | | | | items: | | | | type: integer | | | | noCache: | | | | type: boolean | | | | maxAge: | | | | type: integer | | | | format: int32 | | | | DistributionConfiguration: | | | | type: object | | | | description: \'A content distribution configuration.\' | | | | properties: | | | | contentPreparationTemplateId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | canonicalDomainName: | | | | type: string | | | | domainNameAlias: | | | | type: string | | | | baseURL: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | pathRewriteRules: | | | | type: array | | | | items: | | | | \$ref: \'#/components/schemas/PathRewriteRule\' | | | | cachingConfigurations: | | | | type: array | | | | items: | | | | \$ref: \'#/components/schemas/CachingConfiguration\' | | | | geoFencing: | | | | type: object | | | | required: | | | | - locatorType | | | | - locators | | | | properties: | | | | locatorType: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | locators: | | | | type: array | | | | items: | | | | type: string | | | | descri | | ption: \'Format of individual locators depends on the locatorType.\' | | | | minItems: 1 | | | | urlSignature: | | | | type: object | | | | required: | | | | - urlPattern | | | | - tokenName | | | | - passphraseName | | | | - passphrase | | | | - tokenExpiryName | | | | - useIPAddress | | | | properties: | | | | urlPattern: | | | | type: string | | | | tokenName: | | | | type: string | | | | passphraseName: | | | | type: string | | | | passphrase: | | | | type: string | | | | tokenExpiryName: | | | | type: string | | | | useIPAddress: | | | | type: boolean | | | | ipAddressName: | | | | type: string | | | | certificateId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | # Schema for the resource itself | | | | ContentHostingConfiguration: | | | | type: object | | | | descriptio | | n: \"A representation of a Content Hosting Configuration resource.\" | | | | required: | | | | - name | | | | - ingestConfiguration | | | | - distributionConfigurations | | | | properties: | | | | name: | | | | type: string | | | | entryPointPath: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/RelativeUrl\' | | | | ingestConfiguration: | | | | \$ref: \'#/components/schemas/IngestConfiguration\' | | | | distributionConfigurations: | | | | type: array | | | | items: | | | | | | \$ref: \'#/components/schemas/DistributionConfiguration\' | +----------------------------------------------------------------------+
## C.3.6 M1_ConsumptionReportingProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_ConsumptionReportingProvisioning | | | | version: 1.0.2 | | | | description: \| | | | | 5GMS AF M1 Consumption Reporting Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_ConsumptionReportingProvisioning | | | | description: \'5G Media Str | | eaming: Provisioning (M1) APIs: Consumption Reporting Provisioning\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.9.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisioning-s | | essions/{provisioningSessionId}/consumption-reporting-configuration: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: activateConsumptionReporting | | | | summary: \'Ac | | tivate the consumption reporting procedure for the specified Provisi | | oning Session by providing the Consumption Reporting Configuration\' | | | | requestBody: | | | | description | | : \'A JSON representation of a Consumption Reporting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | responses: | | | | \'201\': | | | | | | description: \'Consumption Reporting Configuration Created\' | | | | headers: | | | | Location: | | | | description: \'URL of the newly | | created Consumption Reporting Configuration (same as request URL).\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | get: | | | | operationId: retrieveConsumptionReportingConfiguration | | | | summary: \'Retrieve the Consump | | tion Reporting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | put: | | | | operationId: updateConsumptionReportingConfiguration | | | | summary: \'Update the Consumpt | | ion Reporting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | description | | : \'A JSON representation of a Consumption Reporting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | responses: | | | | \'204\': | | | | | | description: \'Updated Consumption Reporting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | patch: | | | | operationId: patchConsumptionReportingConfiguration | | | | summary: \'Patch the Consumpt | | ion Reporting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | description | | : \'A JSON representation of a Consumption Reporting Configuration\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | application/json-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | responses: | | | | \'200\': | | | | | | description: \'Patched Consumption Reporting Configuration\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingConfiguration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyConsumptionReportingConfiguration | | | | summary: \'Destroy the current Consump | | tion Reporting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'204\': | | | | | | description: \'Destroyed Consumption Reporting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | ConsumptionReportingConfiguration: | | | | type: object | | | | description: \"A | | representation of a Consumption Reporting Configuration resource.\" | | | | properties: | | | | reportingInterval: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | samplePercentage: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Percentage\' | | | | locationReporting: | | | | type: boolean | +----------------------------------------------------------------------+
## C.3.7 M1_MetricsReportingProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_MetricsReportingProvisioning | | | | version: 1.1.0 | | | | description: \| | | | | 5GMS AF M1 Metrics Reporting Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_MetricsReportingProvisioning | | | | description: \'5G Media | | Streaming: Provisioning (M1) APIs: Metrics Reporting Provisioning\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisionin | | g-sessions/{provisioningSessionId}/metrics-reporting-configurations: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: activateMetricsReporting | | | | summa | | ry: \'Activate the Metrics reporting procedure for the specified Pro | | visioning Session by providing the Metrics Reporting Configuration\' | | | | requestBody: | | | | descrip | | tion: \'A JSON representation of a Metrics Reporting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | responses: | | | | \'201\': | | | | description: \'Metrics Reporting Configuration Created\' | | | | headers: | | | | Location: | | | | description: \'URL of the ne | | wly created Metrics Reporting Configuration (same as request URL).\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | /provisioning-sessions/{provisioningSessionId} | | /metrics-reporting-configurations/{metricsReportingConfigurationId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | - name: metricsReportingConfigurationId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descriptio | | n: \'The resource identifier of a Metrics Reporting Configuration.\' | | | | get: | | | | operationId: retrieveMetricsReportingConfiguration | | | | summary: \'Retrieve the specified Met | | rics Reporting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | put: | | | | operationId: updateMetricsReportingConfiguration | | | | summary: \'Update the specified Metr | | ics Reporting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | descrip | | tion: \'A JSON representation of a Metrics Reporting Configuration\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | responses: | | | | \'204\': | | | | description: \'Updated Metrics Reporting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | patch: | | | | operationId: patchMetricsReportingConfiguration | | | | summary: \'Patch the specified Metr | | ics Reporting Configuration for the specified Provisioning Session\' | | | | requestBody: | | | | descrip | | tion: \'A JSON representation of a Metrics Reporting Configuration\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | application/json-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | responses: | | | | \'200\': | | | | description: \'Patched Metrics Reporting Configuration\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/MetricsReportingConfiguration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyMetricsReportingConfiguration | | | | summary: \'Destroy the specified Met | | rics Reporting Configuration of the specified Provisioning Session\' | | | | responses: | | | | \'204\': | | | | description: \'Destroyed Metrics Reporting Configuration\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | MetricsReportingConfiguration: | | | | type: object | | | | description: | | \"A representation of a Metrics Reporting Configuration resource.\" | | | | required: | | | | - metricsReportingConfigurationId | | | | - samplingPeriod | | | | properties: | | | | metricsReportingConfigurationId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | scheme: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | dataNetworkName: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\' | | | | reportingInterval: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | samplePercentage: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Percentage\' | | | | urlFilters: | | | | type: array | | | | items: | | | | type: string | | | | minItems: 1 | | | | samplingPeriod: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | metrics: | | | | type: array | | | | items: | | | | type: string | | | | minItems: 1 | +----------------------------------------------------------------------+
## C.3.8 M1_PolicyTemplatesProvisioning API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M1_PolicyTemplatesProvisioning | | | | version: 1.3.0 | | | | description: \| | | | | 5GMS AF M1 Policy Templates Provisioning API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M1_PolicyTemplatesProvisioning | | | | description: \'5G Medi | | a Streaming: Provisioning (M1) APIs: Policy Templates Provisioning\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m1/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /provisioning-sessions/{provisioningSessionId}/policy-templates: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | post: | | | | operationId: createPolicyTemplate | | | | | | summary: \'Create (and optionally upload) a new Policy Template\' | | | | requestBody: | | | | description: \'A JSON representation of a Policy Template\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | responses: | | | | \'201\': | | | | description: \'Policy Template Created\' | | | | headers: | | | | Location: | | | | | | description: \'URL of the newly created Policy Template resource.\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | | | | | /provisioning-s | | essions/{provisioningSessionId}/policy-templates/{policyTemplateId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | | | description: \'A unique identifier of the Provisioning Session.\' | | | | - name: policyTemplateId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | description: \'A resource identifier of a Policy Template.\' | | | | get: | | | | operationId: retrievePolicyTemplate | | | | summary: \'Retrieve a representation of | | an existing Policy Template in the specified Provisioning Session\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | \'404\': | | | | description: \'Not Found\' | | | | put: | | | | operationId: updatePolicyTemplate | | | | summary: | | \'Update a Policy Template for the specified Provisioning Session\' | | | | requestBody: | | | | description: \'A JSON representation of a Policy Template\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | responses: | | | | \'204\': | | | | description: \'Updated Policy Template\' | | | | \'404\': | | | | description: \'Not Found\' | | | | patch: | | | | operationId: patchPolicyTemplate | | | | summary: | | \'Patch the Policy Template for the specified Provisioning Session\' | | | | requestBody: | | | | description: \'A JSON representation of a Policy Template\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | application/json-patch+json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | responses: | | | | \'200\': | | | | description: \'Patched Content Hosting Configuration\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/PolicyTemplate\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyPolicyTemplate | | | | responses: | | | | \'204\': | | | | description: \'Destroyed Policy Template\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | PolicyTemplate: | | | | type: object | | | | | | description: \"A representation of a Policy Template resource.\" | | | | required: | | | | - policyTemplateId | | | | - state | | | | - stateReason | | | | - externalReference | | | | - applicationSessionContext | | | | properties: | | | | policyTemplateId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | state: | | | | anyOf: | | | | - type: string | | | | enum: [PENDING, INVALID, READY, SUSPENDED] | | | | - type: string | | | | description: > | | | | This string provides forward-compatibility with future | | | | | | extensions to the enumeration but is not used to encode | | | | content defined in the present version of this API. | | | | stateReason: | | | | \$r | | ef: \'TS29571_CommonData.yaml#/components/schemas/ProblemDetails\' | | | | externalReference: | | | | type: string | | | | qoSSpecification: | | | | \$ref: | | \'TS26512_CommonData.yaml#/components/schemas/M1QoSSpecification\' | | | | applicationSessionContext: | | | | type: object | | | | properties: | | | | sliceInfo: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Snssai\' | | | | dnn: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\' | | | | chargingSpecification: | | | | \$ref: \'T | | S26512_CommonData.yaml#/components/schemas/ChargingSpecification\' | +----------------------------------------------------------------------+
# C.4 OpenAPI representation of the M5 APIs
## C.4.1 M5_ServiceAccessInformation API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M5_ServiceAccessInformation | | | | version: 1.3.0 | | | | description: \| | | | | 5GMS AF M5 Service Access Information API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M5_ServiceAccessInformation | | | | description: \'5G Media Strea | | ming: Media Session Handling (M5) APIs: Service Access Information\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m5/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /service-access-information/{provisioningSessionId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | get: | | | | operationId: retrieveServiceAccessInformation | | | | summary: \'Retrieve the Service Access Information resource\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/ServiceAccessInformationResource\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | ServerAddresses: | | | | description: \"A set of application endpoint addresses.\" | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | minItems: 1 | | | | ServiceAccessInformationResource: | | | | description: \"A representation of a Service Access | | Information resource.\" | | | | type: object | | | | required: | | | | - provisioningSessionId | | | | - provisioningSessionType | | | | properties: | | | | provisioningSessionId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | provisioningSessionType: | | | | \$ref: \'TS2 | | 6512_CommonData.yaml#/components/schemas/ProvisioningSessionType\' | | | | streamingAccess: | | | | type: object | | | | properties: | | | | entryPoint: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | clientConsumptionReportingConfiguration: | | | | type: object | | | | required: | | | | - serverAddresses | | | | - locationReporting | | | | - samplePercentage | | | | properties: | | | | reportingInterval: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | serverAddresses: | | | | \$ref: \'#/components/schemas/ServerAddresses\' | | | | locationReporting: | | | | type: boolean | | | | samplePercentage: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Percentage\' | | | | dynamicPolicyInvocationConfiguration: | | | | type: object | | | | required: | | | | - serverAddresses | | | | - validPolicyTemplateIds | | | | - sdfMethods | | | | properties: | | | | serverAddresses: | | | | \$ref: \'#/components/schemas/ServerAddresses\' | | | | validPolicyTemplateIds: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | minItems: 0 | | | | sdfMethods: | | | | type: array | | | | items: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/SdfMethod\' | | | | minItems: 0 | | | | externalReferences: | | | | type: array | | | | items: | | | | type: string | | | | minItems: 1 | | | | clientMetricsReportingConfiguration: | | | | type: array | | | | items: | | | | type: object | | | | required: | | | | - serverAddresses | | | | - scheme | | | | - samplePercentage | | | | - urlFilters | | | | - samplingPeriod | | | | - metrics | | | | properties: | | | | serverAddresses: | | | | \$ref: \'#/components/schemas/ServerAddresses\' | | | | scheme: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\' | | | | dataNetworkName: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/Dnn\' | | | | reportingInterval: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | samplePercentage: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/Percentage\' | | | | urlFilters: | | | | type: array | | | | items: | | | | type: string | | | | minItems: 0 | | | | samplingPeriod: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | metrics: | | | | type: array | | | | items: | | | | type: string | | | | networkAssistanceConfiguration: | | | | type: object | | | | required: | | | | - serverAddresses | | | | properties: | | | | serverAddresses: | | | | \$ref: \'#/components/schemas/ServerAddresses\' | +----------------------------------------------------------------------+
## C.4.2 M5_ConsumptionReporting API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M5_ConsumptionReporting | | | | version: 1.1.0 | | | | description: \| | | | | 5GMS AF M5 Consumption Reporting API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M5_ConsumptionReporting | | | | description: \'5G Media | | Streaming: Media Session Handling (M5) APIs: Consumption Reporting\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m5/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /consumption-reporting/{provisioningSessionId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | description: \'See 3GPP TS 26.512 clause 11.3.2.\' | | | | post: | | | | operationId: submitConsumptionReport | | | | summary: \'Submit a Consumption Report\' | | | | requestBody: | | | | description: \'A Consumption Report\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/ConsumptionReport\' | | | | responses: | | | | \'204\': | | | | description: \'Consumption Report Accepted\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'415\': | | | | description: \'Unsupported Media Type\' | | | | components: | | | | schemas: | | | | ConsumptionReport: | | | | description: \"A representation of a Consumption Report.\" | | | | type: object | | | | required: | | | | - mediaPlayerEntry | | | | - reportingClientId | | | | - consumptionReportingUnits | | | | properties: | | | | mediaPlayerEntry: | | | | type: string | | | | reportingClientId: | | | | type: string | | | | consumptionReportingUnits: | | | | type: array | | | | items: | | | | | | \$ref: \'#/components/schemas/ConsumptionReportingUnit\' | | | | ConsumptionReportingUnit: | | | | description: \"A Consumption Reporting Unit.\" | | | | type: object | | | | required: | | | | - mediaConsumed | | | | - startTime | | | | - duration | | | | properties: | | | | mediaConsumed: | | | | type: string | | | | startTime: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\' | | | | duration: | | | | | | \$ref: \'TS29571_CommonData.yaml#/components/schemas/DurationSec\' | | | | locations: | | | | type: array | | | | items: | | | | \$ | | ref: \'TS26512_CommonData.yaml#/components/schemas/TypedLocation\' | | | | minItems: 1 | +----------------------------------------------------------------------+
## C.4.3 M5_MetricsReporting API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M5_MetricsReporting | | | | version: 1.0.0 | | | | description: \| | | | | 5GMS AF M5 Metrics Reporting API | | | | © 2021, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M5_ConsumptionReporting | | | | description: \'5G Me | | dia Streaming: Media Session Handling (M5) APIs: Metrics Reporting\' | | | | externalDocs: | | | | desc | | ription: \'TS 26.512 V16.2.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m5/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /metrics- | | reporting/{provisioningSessionId}/{metricsReportingConfigurationId}: | | | | parameters: | | | | - name: provisioningSessionId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | descripti | | on: \'The resource identifier of an existing Provisioning Session.\' | | | | - name: metricsReportingConfigurationId | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | description: \'The resource identifier | | of a Metrics Configuration in the specified Provisioning Session.\' | | | | post: | | | | operationId: submitMetricsReport | | | | summary: \'Submit a Metrics Report\' | | | | requestBody: | | | | description: \'A Metrics Report\' | | | | required: true | | | | content: | | | | application/3gpdash-qoe-report+xml: | | | | schema: | | | | type: string | | | | format: xml | | | | application/*: | | | | schema: | | | | type: string | | | | responses: | | | | \'204\': | | | | description: \'Metrics Report Accepted\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'415\': | | | | description: \'Unsupported Media Type\' | +----------------------------------------------------------------------+
## C.4.4 M5_DynamicPolicies API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M5_DynamicPolicies | | | | version: 1.1.2 | | | | description: \| | | | | 5GMS AF M5 Dynamic Policy API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M5_DynamicPolicies | | | | description: \'5G M | | edia Streaming: Media Session Handling (M5) APIs: Dynamic Policies\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m5/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | description: See 3GPP TS 29.512 clause 6.1. | | | | paths: | | | | /dynamic-policies: | | | | post: | | | | operationId: createDynamicPolicy | | | | summa | | ry: \'Create (and optionally upload) a new Dynamic Policy resource\' | | | | requestBody: | | | | descripti | | on: \'An optional JSON representation of a Dynamic Policy resource\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | responses: | | | | \'201\': | | | | description: \'Created Dynamic Policy Resource\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | headers: | | | | Location: | | | | d | | escription: \'The URL of the newly created Dynamic Policy resource\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | | | | | /dynamic-policies/{dynamicPolicyId}: | | | | parameters: | | | | - name: dynamicPolicyId | | | | d | | escription: \'The resource identifier of a Dynamic Policy resource\' | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | get: | | | | operationId: retrieveDynamicPolicy | | | | summary: \'Retrieve an existing Dynamic Policy resource\' | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | put: | | | | operationId: updateDynamicPolicy | | | | summary: \'Update an existing Dynamic Policy resource\' | | | | requestBody: | | | | description | | : \'A replacement JSON representation of a Dynamic Policy resource\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | responses: | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not found\' | | | | patch: | | | | operationId: patchDynamicPolicy | | | | summary: \'Patch an existing Dynamic Policy resource\' | | | | requestBody: | | | | description: \'A JSON patch to a Dynamic Policy resource\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | application/json-patch+json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | responses: | | | | \'200\': | | | | description: \'Patched Dynamic Policy\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'#/components/schemas/DynamicPolicy\' | | | | \'204\': | | | | description: \'Patched Dynamic Policy\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not found\' | | | | delete: | | | | operationId: destroyDynamicPolicy | | | | summary: \'Destroy an existing Dynamic Policy resource\' | | | | responses: | | | | \'204\': | | | | description: \'Destroyed Dynamic Policy\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | DynamicPolicy: | | | | description: \"A representation of a Dynamic Policy | | resource.\" | | | | type: object | | | | required: | | | | - dynamicPolicyId | | | | - policyTemplateId | | | | - serviceDataFlowDescriptions | | | | - provisioningSessionId | | | | properties: | | | | dynamicPolicyId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | policyTemplateId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | serviceDataFlowDescriptions: | | | | type: array | | | | items: | | | | \$ref: \'TS2651 | | 2_CommonData.yaml#/components/schemas/ServiceDataFlowDescription\' | | | | mediaType: | | | | \$ref: \'TS29 | | 514_Npcf_PolicyAuthorization.yaml#/components/schemas/MediaType\' | | | | provisioningSessionId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | qosSpecification: | | | | \$ref: | | \'TS26512_CommonData.yaml#/components/schemas/M5QoSSpecification\' | | | | enforcementMethod: | | | | type: string | | | | enforcementBitRate: | | | | type: integer | +----------------------------------------------------------------------+
## C.4.5 M5_NetworkAssistance API
+----------------------------------------------------------------------+ | openapi: 3.0.0 | | | | info: | | | | title: M5_NetworkAssistance | | | | version: 1.1.0 | | | | description: \| | | | | 5GMS AF M5 Network Assistance API | | | | © 2023, 3GP | | P Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA, TTC). | | | | All rights reserved. | | | | tags: | | | | - name: M5_NetworkAssistance | | | | description: \'5G Med | | ia Streaming: Media Session Handling (M5) APIs: Network Assistance\' | | | | externalDocs: | | | | descr | | iption: \'TS 26.512 V16.11.0; 5G Media Streaming (5GMS); Protocols\' | | | | url: \'https://www.3gpp.org/ftp/Specs/archive/26_series/26.512/\' | | | | servers: | | | | - url: \'{apiRoot}/3gpp-m5/v1\' | | | | variables: | | | | apiRoot: | | | | default: https://example.com | | | | d | | escription: apiRoot as defined in subclause 4.4.1 of 3GPP TS 29.501. | | | | paths: | | | | /network-assistance/: | | | | post: | | | | operationId: createNetworkAssistanceSession | | | | summary: \'Create a new Network Assistance Session.\' | | | | requestBody: | | | | description: \'The initial parameters for the Network | | Assistance Session resource\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: | | \'#/components/schemas/NetworkAssistanceSession\' | | | | responses: | | | | \'201\': | | | | description: \'Created Network Assistance Session\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | headers: | | | | Location: | | | | description: | | \'The URL of the nely created Network Assistance Session resource\' | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | /network-assistance/{naSessionId}: | | | | parameters: | | | | - name: naSessionId | | | | description: \'The reso | | urce identifier of an existing Network Assistance Session resource\' | | | | in: path | | | | required: true | | | | schema: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | get: | | | | operationId: retrieveNetworkAssistanceSession | | | | s | | ummary: \'Retrieve an existing Network Assistance Session resource\' | | | | responses: | | | | \'200\': | | | | description | | : \'A JSON representation of a Network Assistance Session resource\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | put: | | | | operationId: updateNetworkAssistanceSession | | | | | | summary: \'Update an existing Network Assistance Session resource\' | | | | requestBody: | | | | description: \'A replac | | ement JSON representation of a Network Assistance Session resource\' | | | | required: true | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | responses: | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not found\' | | | | patch: | | | | operationId: patchNetworkAssistanceSession | | | | | | summary: \'Patch an existing Network Assistance Session resource\' | | | | requestBody: | | | | de | | scription: \'A JSON patch to a Network Assistance Session resource\' | | | | required: true | | | | content: | | | | application/merge-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | application/json-patch+json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | responses: | | | | \'200\': | | | | description: \'Patched Network Assistance Session\' | | | | content: | | | | application/json: | | | | schema: | | | | | | \$ref: \'#/components/schemas/NetworkAssistanceSession\' | | | | \'204\': | | | | description: \'Patched Network Assistance Session\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | delete: | | | | operationId: destroyNetworkAssistanceSession | | | | | | summary: \'Destroy an existing Network Assistance Session resource\' | | | | responses: | | | | \'204\': | | | | description: \'Destroyed Network Assistance Session\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | /network-assistance/{naSessionId}/recommendation: | | | | get: | | | | operationId: requestBitRateRecommendation | | | | summary: \'O | | btain a bit rate recommendation for the next recommendation window\' | | | | parameters: | | | | - name: naSessionId | | | | description: \'The reso | | urce identifier of an existing Network Assistance Session resource\' | | | | in: path | | | | required: true | | | | schema: | | | | type: string | | | | responses: | | | | \'200\': | | | | description: \'Success\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: | | \'TS26512_CommonData.yaml#/components/schemas/M5QoSSpecification\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | /network-assistance/{naSessionId}/boost-request: | | | | post: | | | | operationId: requestDeliveryBoost | | | | summary: \'Request a delivery boost\' | | | | parameters: | | | | - name: naSessionId | | | | description: \'The reso | | urce identifier of an existing Network Assistance Session resource\' | | | | in: path | | | | required: true | | | | schema: | | | | type: string | | | | responses: | | | | \'200\': | | | | description: \'Delivery Boost Request Processed\' | | | | content: | | | | application/json: | | | | schema: | | | | \$ref: \'TS26 | | 512_CommonData.yaml#/components/schemas/OperationSuccessResponse\' | | | | \'400\': | | | | description: \'Bad Request\' | | | | \'401\': | | | | description: \'Unauthorized\' | | | | \'404\': | | | | description: \'Not Found\' | | | | components: | | | | schemas: | | | | NetworkAssistanceSession: | | | | description: \"A representation of a Network Assistance | | Session resource.\" | | | | type: object | | | | required: | | | | - naSessionId | | | | - provisioningSessionId | | | | - serviceDataFlowDescriptions | | | | properties: | | | | naSessionId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | provisioningSessionId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | serviceDataFlowDescriptions: | | | | type: array | | | | items: | | | | \$ref: \'TS2651 | | 2_CommonData.yaml#/components/schemas/ServiceDataFlowDescription\' | | | | minItems: 1 | | | | mediaType: | | | | \$ref: \'TS29 | | 514_Npcf_PolicyAuthorization.yaml#/components/schemas/MediaType\' | | | | policyTemplateId: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/ResourceId\' | | | | requestedQoS: | | | | \$ref: | | \'TS26512_CommonData.yaml#/components/schemas/M5QoSSpecification\' | | | | recommendedQoS: | | | | \$ref: | | \'TS26512_CommonData.yaml#/components/schemas/M5QoSSpecification\' | | | | notficationURL: | | | | | | \$ref: \'TS26512_CommonData.yaml#/components/schemas/AbsoluteUrl\' | +----------------------------------------------------------------------+
###### ## Annex D (informative): 5GMS AF API index
Table D-1: Index of Provisioning (M1) APIs
HTTP request path element hierarchy Description Allowed HTTP methods Resource
OpenAPI
* * *
                                                                                       Create                 Retrieve   Update       Destroy   Non-RESTful operation   structure definition clause   definition clause
provisioning-sessions Provisioning Sessions collection POST 7.2.2 C.3.1
_{provisioningSessionId}_ Provisioning Session resource GET DELETE  
certificates Server Certificates collection POST 7.3.2 C.3.2 _{certificateId}_
Server Certificate resource GET PUT DELETE  
content-preparation-templates Content Preparation Templates collection POST
7.4.2 C.3.3 _{contentPreparationTemplateId}_ Content Preparation Template
resource GET PUT, PATCH DELETE  
content-protocols-discovery Content Protocols resource GET 7.5.2 C.3.4
content-hosting-configuration Content Hosting Configuration resource POST GET
PUT, PATCH DELETE 7.6.2 C.3.5 purge Content Hosting cache purge operation POST  
consumption-reporting-configuration Consumption Reporting Configuration
resource POST GET PUT, PATCH DELETE 7.7.2 C.3.6 metrics-reporting-
configuration Metrics Reporting Configuration collection POST 7.8.2 C.3.7
_{metricsReportingConfigurationId}_ Metrics Reporting Configuration resource
GET PUT, PATCH DELETE  
policy-templates Policy Templates collection POST 7.9.2 C.3.8
_{policyTemplateId}_ Policy Template resource GET PUT, PATCH DELETE
> Table D‑2: Index of Media Session Handling (M5) APIs
HTTP request path element hierarchy Description Allowed HTTP methods Resource
OpenAPI
* * *
                                                                                      Create                 Retrieve   Update       Destroy   Non-RESTful operation   structure definition clause   definition clause
service-access-information Service Access Information collection 11.2.2 C.4.1
_{provisioningSessionId}_ Service Access Information resource GET  
consumption-reporting Consumption Reporting collection 11.3.2 C.4.2
_{provisioningSessionId}_ Consumption Reporting operation POST  
metrics-reporting Metrics Reporting collection 11.4.2 C.4.3
_{provisioningSessionId}_ Metrics Reporting Configurations collection  
_{metricsReportingConfgurationId}_ Metrics Reporting operation POST  
dynamic-policies Dynamic Policies collection POST 11.5.2 C.4.4
_{dynamicPolicyId}_ Dynamic Policy resource GET PUT, PATCH DELETE  
network-assistance Network Assistance Sessions collection POST 11.6.2 C.4.5
_{naSessionId}_ Network Assistance Session resource GET PUT, PATCH DELETE  
recommendation Bit rate recommendation request operation GET  
boostRequest Delivery boost request operation POST
#