# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document discusses and describes the CT6 aspects of the 5G System
phase 1. One objective of the document is to describe the impact of decisions
taken in other 3GPP groups on the existing specifications maintained by CT6.
The present document is intended as a placeholder for CT6 material until it
stabilises sufficiently to be moved to appropriate 3GPP technical
specifications.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 31.101: \"UICC-terminal interface; UICC-terminal interface;
Physical and logical characteristics\".
[3] 3GPP TS 31.102: \"Characteristics of the Universal Subscriber Identity
Module (USIM) application\".
[4] 3GPP TS 31.111: \"Universal Subscriber Identity Module (USIM) Application
Toolkit (USAT)\"
[5] ETSI TS 102 221 V13.1.0: \"Smart Cards; UICC-Terminal interface; Physical
and logical characteristics\".
[6] 3GPP TR 33.899: \"Technical Specification Group Services and System
Aspects; Study on the security aspects of the next generation system\".
[7] 3GPP TS 31.801: \"Technical requirements for a secure platform for 3GPP
applications\".
[8] 3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".
[9] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[10] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[11] 3GPP TR 24.890: \"5G System -- Phase 1; CT WG1 Aspects\".
[12] ETSI TS 102 223 V13.1.0: \"Smart Cards; Card Application Toolkit\".
[13] 3GPP TS 22.011: \"Service accessibility\".
[14] 3GPP TS 23.122: \"Non-Access-Stratum functions related to Mobile Station
(MS) in idle mode\".
[15] 3GPP TS 22.153: \"Technical Specification Group Services and System
Aspects; Multimedia priority service\"
[16] 3GPP TS 38.321: \"NR Medium Access Control (MAC) protocol
specification\".
[17] 3GPP TS 38.211: \"NR Physical channels and modulation\"
[18] 3GPP TS 38.122: \"NR; Requirements for support of radio resource
management\"
[19] 3GPP TS 38.213: \"NR; Physical layer procedures for control\"
[20] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\"
[21] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\"
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1], in 3GPP TS 31.102 [3] and the following apply.\ An abbreviation
defined in the present document takes precedence over the definition of the
same abbreviation, if any, in 3GPP TR 21.905 [1].
# 4 Platform
## 4.1 UICC
The UICC platform defined by ETSI SCP in TS 102 221 [5] was adopted by 3GPP in
TS 31.101 [2] and has been used to host the 3GPP applications, including the
USIM and the ISIM, for many years, starting from Rel.99.
It is evident that the platform could be improved in many aspects, as
described in the TR 31.801 [7]. Anyway, it remains a valid and appropriate
solution to host the 3GPP applications also in a UE capable of registering on
a 5G system.
The continued usage of the UICC platform helps avoiding issues for users when
upgrading their device to a 5G capable one.
## 4.2 SSP
In the latest available version of TS 33.899 [6], SA3 has approved a
requirement for the storage and processing of the subscription credentials in
a 5G system, adding more flexibility in addition to the existing UICC
platform, already in use within the 3GPP eco-system. This is reflected in the
interim agreement described in clause E.5.1.1.2, indicating that solutions for
the credential storage and processing in Phase 1 shall be the UICC and the new
SSP (Smart Secure Platform) under discussion in ETSI SCP.
> Editor\'s Note: The agreement depends on the availability of an SSP
> specification published by ETSI in time to be included in the Rel.15. ETSI
> SCP has indicated the intention to do its best to provide a solution in the
> Rel.15 timeframe, as documented in SCP(17)000061r1 (C6-170253).
>
> Editor's Note: The possibility to include the SSP needs to be reviewed in
> light of the progress done by ETSI SCP on the topic.
# 5 Security aspects
## 5.1 Extension of the AUTHENTICATE command
### 5.1.1 Introduction
The following clauses describe the impact of the 5G system on the existing
AUTHENTICATE command, as defined in TS 31.102 [3].
### 5.1.2 Keys in the USIM
TS 33.501 [8] clause 6.1.1.3 describes the binding of the anchor key K~SEAF~
to the serving network, to prevent one serving network from claiming to be a
different serving network, and indicates that the anchor key provided to the
serving network shall be specific to the authentication having taken place
between the UE and a 5G core network.
As per TS 33.501 [8] clause 6.1.1.1, there is also another key K~AUSF~, that
is left on the AUSF based on the home operator's policy on using such key for
authentication and key agreement procedures. As per TS 33.501 [8] clause
6.2.2.2, the ME shall generate the K~AUSF~ from the CK, IK received from the
USIM. The ME shall then generate the K~SEAF~ from K~AUSF.~ The ME shall then
generate the K~AMF~. If the USIM supports 5G parameters storage, the K~AUSF,~
K~SEAF~ and K~AMF~ shall be stored in the USIM.
New EF(s) need to be defined in the USIM for the storage of the keys listed
above. A bit also needs to be reserved in the USIM Service Table to indicate
the support for 5G parameters storage.
The USIM shall store the same long-term key K that is stored in the ARPF.
### 5.1.3 Input parameters
No new input parameters are needed for AUTHENTICATE command as the AKA
procedures leverage authentication procedure as in 3G Security Context
procedure. RES* calculation as part of 5G-AKA procedure is not performed on
the USIM. SA3 has clarified with S3-180796 that RES* is computed in the ME.
### 5.1.4 Output parameters
No new output parameters are needed for AUTHENTICATE as the AKA procedures
leverage authentication procedure as in 3G Security Context procedure. RES*
calculation as part of 5G-AKA procedure is not performed on the USIM. SA3 has
clarified with S3-180796 that RES* is computed in the ME.
## 5.2 5G NAS security context
### 5.2.2 Introduction
As per TS 33.501 [8] clause 6.3.4.1, the ME shall store two different 5G
security contexts on the USIM if the USIM supports the 5G parameters storage.
In order to implement this requirement, a new bit in the USIM Service Table
and an EF for storing 5G NAS security context may be needed in the USIM.
# 6 Storage capability to support 5G system
## 6.1 Existing EFs
### 6.1.1 Introduction
The following clauses describe the impact of 5G system on existing EFs stored
in the USIM application.
### 6.1.2 EFs related to PLMN selection
#### 6.1.2.1 PLMN selection
According to TR 24.890 [11] clause 5.2.2, the same procedures for PLMN
selection applicable for the GSM, UTRAN and E-UTRAN access technologies as
described in 3GPP TS 22.011 [13] and 3GPP TS 23.122 [14] also apply for
5G-RAN, with only few exceptions.
#### 6.1.2.2 EF~HPPLMN~ (Higher Priority PLMN search period)
According to the text in TS 31.102 [3] clause 4.2.6, the EF~HPPLMN~ contains
the interval of time between searches for a higher priority PLMN. The coding
of this EF varies depending on the device that reads it. In particular for
those MEs that only support NB-IoT, GERAN EC-GSM-IoT and Category M1 of
E-UTRAN enhanced-MTC, or a combination of those, the values calculated from
the EF~HPPLMN~ are much longer.
Based on existing text in TR 24.890 [11], no changes are anticipated due to
the introduction of 5G.
#### 6.1.2.3 EF~PLMNwAcT~ (User controlled PLMN selector with Access
Technology)
According to the text in TS 31.102 [3] clause 4.2.5, the EF~PLMNwAcT~ contains
the list of PLMNs and access technologies controlled by the user to be used
during PLMN selection procedure. This access technology of each PLMN is coded
as a bitmask.
5G system needs to be added to the coding of the access technology, using one
of the exising RFU bits. Based on the response from SA1 in S1-173550, the UE
does not need to differentiate between NR connected to 5GC and E-UTRA
connected to 5GC. The UE however does need to differentiate between E-UTRA
connected to 5GC and E-UTRA connected to EPC. Hence, the existing E-UTRAN bits
in TS 31.102 [3] clause 4.2.5 correspond to E-UTRAN over EPC. A new coding is
required for EUTRAN/NR over 5GC.
### 6.1.2.4 EF~OPLMNwACT~ (Operator controlled PLMN selector with Access
Technology)
The file EF~OPLMNwACT~ specified in TS 31.102 [3] clause 4.2.53 is coded in
the same way as the EF~PLMNwAcT~ described in clause 6.1.2.3 of this document.
For this reason, the same conclusions and coding apply to this EF as well.
### 6.1.2.5 EF~HPLMNwACT~ (HPLMN selector with Access Technology)
The file EF~HPLMNwACT~ specified in TS 31.102 [3] clause 4.2.54 is coded in
the same way as the EF~PLMNwAcT~ described in clause 6.1.2.3 of this document.
For this reason, the same conclusions and coding apply to this EF as well.
### 6.1.3 Other EFs
### 6.1.3.1 CSG Lists
TS 31.102 [3] clause 4.4.6 contains the description of several EFs related to
the usage of CSG functionality.
Support of CSG is not included in Rel-15 and might be added in the future
releases.
## 6.2 New EFs
### 6.2.1 Forbidden areas
According to TR 24.890 [11] clause 5.2.2, the UE maintains a list of
\"forbidden areas\" where the UE shall not send any signalling or user data.
Anyway, according to the current text, this list is deleted when the UE is
switched off or the USIM is removed.
In order to properly implement the last requirement, such list cannot be
stored in the USIM, and in general, there would not be any advantage in
storing it inside the USIM application.
### 6.2.2 Network slices
According to TR 24.890 [11] clause 13.2, a network slice is identified by an
S-NSSAI, which is comprised of a slice/service type (SST) and an optional
slice differentiator (SD). A set of S-NSSAI is called NSSAI and there are
multiple types of NSSAI, that may be provided by the HPLMN to the UE per PLMN.
Section 13.2.2 further clarifies the details for the storage of the NSSAI,
indicating that the configured NSSAI(s) and/or allowed NSSAI(s) shall be
stored in a non-volatile memory in the ME together with the SUPI from the USIM
per PLMN, and that the configured NSSAI(s) and/or allowed NSSAI(s) can only be
used if the SUPI from the USIM matches the SUPI stored in the non-volatile
memory of the ME; else the UE shall delete them.
### 6.2.3 Multimedia Priority Services
TS 22.153 [15] specifies the service requirements for Multimedia Priority
Service (MPS). MPS allows certain subscribers priority access to system
resources in situations such as during congestion, creating the ability to
deliver or complete sessions of a high priority nature.
According to TS 24.890 [11] clause 12.1.5.2, an MPS-subscribed UE is
configured with at least one access class in the range 11-15 on the USIM.
Since Access Control Classes 11-15 are already defined in TS 31.102 [3], no
new requirement is present for USIM for Multimedia Priority Services.
### 6.2.4 Subscriber Permanent Identifier
According to TS 23.501 [9] clause 5.9.1, each subscriber in the 5G system
shall be allocated one 5G Subscription Permanent Identifier (SUPI). As per TS
24.501 [yy] clause 5.3.2, the SUPI can be the IMSI or a Network Access
Identifier (NAI). Though non-IMSI based SUPIs are possible by using NAI, the
IMSI can be contained within the NAI for the SUPI.
A new USIM service table bit may be needed to indicate if the USIM supports
SUPI types other than IMSI. If the USIM supports SUPI types other than IMSI,
CT6 needs to create a new EF for that.
According to TR 33.899 [6] clause E.7.2.1.2, SA3 agreed that privacy for the
5G permanent subscription identifier is part of 5G system Phase 1\.
Furthermore, SA3 also agreed that subscription identifier privacy shall be
based upon HN asymmetric key solution, as indicated in TR 33.899 [6] clause
E.7.2.6.2. SA3 has also agreed in TS 33.501 [8] clause 5.1.5 that the home
network public key shall be stored on the tamper resistant secure hardware
component. Anyway, SA3 has not concluded in which entities (e.g. ME, USIM) the
calculation of SUCI is done.
CT6 needs to expand the USIM capabilities depending on the SA3 decision about
the calculation of SUCI:
  * if the calculation is done on the USIMUICC, then a new mechanism to calculate the SUCI is required, either extending one of the existing commands or with the introduction of a new command. Moreover, CT6 may decide to create a new EF that is not accessible by the ME to store the home network public key, in order to allow a standardized way to manage it;
  * if the calculation is performed in the ME, then CT6 needs to add a new EF for the storage of the home network public key.
Editor's Note: This section needs to be revised considering the SA3 decisions
made in TS 33.501 [8].
### 6.2.5 5G Globally Unique Temporary Identity
In all previous access technologies, the temporary identities, in the form of
TMSI, P-TMSI or GUTI, was stored in the USIM. TS 23.501 [9] clause 5.9.4
defines a new 5G-GUTI, that is allocated by the AMF and is common to both 3GPP
and non-3GPP access. As mentioned in TS 24.501 [xx] Annex C, 5G-GUTI shall be
stored in the USIM, if the corresponding file is present on the USIM.
So, a new USIM service table bit needs to be introduced for 5G mobility
management parameters. A new EF also needs to be introduced to store the 5G
mobility management parameters, including 5G-GUTI.
# 7 Other functionalities related to 5G system
## 7.1 Public warning system
According to TS 24.890 [11] clause 12.1.1, 5G PWS will have the same
functionality as E-UTRAN PWS for 4G. It is expected that the same technology
framework is used for the realization of PWS in 5GS and for this reason no
additional impact is expected on the USIM.
## 7.2 eCall over IMS Emergency Services
TS 31.102 [3] clause 5.3.40 describes the usage of EF~FDN~, EF~FDNURI~,
EF~SDN~ and EF~SDNURI~ to store the eCall test number/URI and the eCall
reconfiguration number/URI to be used in case of eCall over IMS Emergency
Services using the PS domain in E-UTRAN.
Based on the text in TS 23.501 [9] clause 5.16.4.10, eCall over IMS Emergency
Services needs to be supported also on 5GS.
# 8 Toolkit aspects
## 8.1 Introduction
The following clauses describe the impact of the 5G system on the existing
USIM Application Toolkit, as defined in TS 31.111 [4].
## 8.2 Existing commands and objects
### 8.2.1 Access Technology
TS 31.111 [4] lists all possible access technologies communicated to the UICC
in clause 8.62, which points to a clause of ETSI TS 102 223 [12]. The
introduction of 5G system requires the addition of a new item in that list.
Such addition needs to be done using one of the bits reserved by ETSI SCP for
3GPP for the definition of new access technologies.
### 8.2.2 Location Information
The TLV containing the Location Information is defined in TS 31.111 [4] clause
8.19. This is used in several USAT messages sent from the ME to the UICC. The
content of this object is populated by the terminal with the identification
(MCC, MNC, LAC/TAC, Cell Identity) of the current serving cell of the UE, when
the UE is on GERAN, UTRAN or E-UTRAN.
The existing text defines the coding of the TAC and the Cell Identity with
reference to E-UTRAN specifications, and a new definition of the coding for 5G
System is required.
The cell identity for NR is specified as 36 bits long in TS 38.413 clause
9.3.1.7. This change would require an extension of the Location Information
data object in TS 31.111, that is currently defined with only 32 bits for the
Cell Identity value.
### 8.2.3 Timing Advance
According to TS 31.111 [4], the UICC can retrieve the Timing Advance (TA)
information from the terminal. This information can be used by the UICC for a
rough estimate of the location of the user. This mechanism is currently
defined for GERAN and E-UTRAN.
As per TS 38.321 [16], the Timing Advance feature is applicable to NR as well.
As per frame structure in TS 38.211 [17] clause 4.3, the definitions of Random
Access Response TA and MAC-CE TA in TS 38.213 [18] clause 4.2 and the TA
offset values defined in TS 38.133 [19], the maximum value of Timing Advance
(N~TA~) may be derived. That derived value will require 21 bits for N~TA~. TS
31.111 [4] clause 8.46 currently reserves 1 byte for Timing Advance. That
needs to be expanded to 3 bytes to accommodate maximum Timing Advance value in
5GS.
### 8.2.4 Network Measurament Results
According to TS 31.111 [4], the UICC can request the Network Measurament
Results (NMR) from the terminal. The UICC can request both intra-RAT and
inter-RAT measuraments, that might be available for the terminal.
The type of measurament requested by the UICC is specified in TS 31.111 [4]
clause 8.73 that lists all possible requests. This list needs to be expanded
to include new possible inter-RAT and intra-RAT measurament requests due to
the new 5G RAT.
The results of the requested measurament is returned by the terminal to the
UICC using the Network Measurement Results object, defined in clause 8.22. The
definition of this object needs to be expanded to include the new network
measurement results related to 5G RAT.
### 8.2.5 Network Rejection event
According to TS 31.111 [4] clause 7.5.2.1, the ME informs the UICC about a
network reject event when it receives an ATTACH REJECT message or TRACKING
AREA UPDATE REJECT message in E-UTRAN and if the UICC has requested this
information using the SET UP EVENT LIST proactive command.
The event contains several items that can potentially be impacted by the 5G
System:
  * the Tracking Area indentification of the rejecting network (see also clause 8.2.2 above)
  * the Access technology (see clause 8.2.1 above)
  * the (Extended) Rejection Cause Code with the EMM Cause
  * Update/Attach Type indicating the specific message that was rejected by the network
> Editor's Note: The impact of the 5G System for each of the items listed
> above needs to be determined, based on the protocol defined by CT1.
### 8.2.6 Bearer Independent Protocol
According to TS 31.111 [4], the UICC can provide a Bearer description object,
as specified in TS 31.111 [4] clause 8.52, when it opens a BIP channel using
OPEN CHANNEL, in order to request a specific QoS. In case of E-UTRAN, this
object includes the \"EPS quality of service\" information element and the
resource type (GBR or non-GBR).
The need for the QoS parameter in OPEN CHANNEL for BIP in 5GS is to be further
evaluated in CT6, taking into consideration the adoption of the feature on the
existing Radio Access Technologies.
### 8.2.7 Call control on PDU connection establishment by USIM
When the UICC supports it, the ME passes the PDN Connectivity Request message
to the UICC for all EPS PDN connection activations (including those resulting
from a OPEN CHANNEL proactive UICC command) using the ENVELOPE (CALL CONTROL)
command. The UICC can modify some of the fields in the message (Access Point
Name and Protocol configuration options) before the terminal sends the request
to the network, as specified in TS 31.111 [4] clause 7.3.1.6.
The payload of the ENVELOPE (CALL CONTROL) needs to be expanded for the 5G
System with a new data object called PDU connection establishment parameters.
This new data object needs to be defined based on the PDU CONNECTION
ESTABLISHMENT REQUEST message, defined in TS 24.890 [11] clause 9.6.
A new sub-clause 7.3.1.x needs to be added in TS 31.111 [4] with the procedure
for call control for PDU connection establishment.
The need for a new bit in the USIM service table in TS 31.102 [3] for \"call
control on PDU connection for 5GS by USIM\" is to be evaluated.
### 8.2.8 Data Connection Status Change Event
When the UICC has registered for the event, the ME notifies the UICC after
each change in the data connection status, using the ENVELOPE (EVENT DOWNLOAD
-- Data Connection Status Change) command.
The description of the Data connection status object in TS 31.111 [4] clause
8.137 and the Data connection type object in TS 31.111 [4] clause 8.138 needs
to be expanded to include the 5GS PDU connection establishment procedure.
The (E)SM cause data object in TS 31.111 [4] clause 8.129 needs to be expanded
to include the 5GSM cause values as mentioned in TS 24.890 [11] clause 9.7.6.
Annex T of TS 31.111 [4] also needs to be updated to include PDU connection
establishment scenarios related to 5GS as detailed in TS 24.890 [11].
### 8.2.9 LAUNCH BROWSER
When the UICC sends the LAUNCH BROWSER proactive command, it can optionally
include a Bearer object. This is specified in TS 31.111 [4] clause 8.49. The
value \'03\' indicates GPRS/UTRAN packet service/E-UTRAN.
It is recommended to add 5G system to the existing value \'03\' without
further expanding the list.
## 8.3 Backward compatibility
It is expected that the UE might be able to access the 5G system with the
existing UICC cards already in the market. For this reason, it is possible
that the UE camps on a 5G system, while the card is not capable of recognizing
it.
In order to handle this scenario, a new bit in the USIM Service Table is
required to indicate support of 5G System, so that terminal can adjust its
behaviour to what the UICC supports. Similarly, a new bit in the TERMINAL
PROFILE is required, so that the ME can inform the card of the 5G support.
In order to provide a smooth transition, CT6 needs to study which fields
defined in TS 31.111 [4] are impacted by the transition and if there is a
possibility of conversion of 5G specific values into corresponding values that
are already defined and that can be interpreted by an existing card. Such
study needs to be performed on each of the fields listed in clause 8.2 and
appropriate text needs to be added in TS 31.111 [4] as needed.
#