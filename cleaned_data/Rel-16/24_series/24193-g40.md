# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the procedures for access traffic steering,
switching and splitting (ATSSS) between the UE and the network across one 3GPP
access network and one non-3GPP access network as specified in 3GPP TS 23.501
[2], 3GPP 23.502 [3], and 3GPP TS 23.316 [4].
The ATSSS can be supported over the access network where an MA PDU session can
be established. The type of access network includes NG-RAN and untrusted
non-3GPP access network as specified in 3GPP TS 23.501 [2], trusted non-3GPP
access network, wireline access network and as specified in 3GPP TS 23.316
[4]. An MA PDU session established by the 5G-RG can also simultaneously use
one 3GPP access network connected to EPC and one wireline access network
connected to 5GCN as specified in 3GPP TS 23.316 [4].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.316: \"Wireless and wireline convergence access support for the
5G System (5GS)\".
[5] 3GPP TS 24.526: \"UE policies for 5G System (5GS); Stage 3\".
[6] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[7] 3GPP TS 24.502: \"Access to the 3GPP 5G System (5GS) via non-3GPP access
networks; Stage 3\".
[8] IETF RFC 8684: \"TCP Extensions for Multipath Operation with Multiple
Addresses\".
[9] IETF RFC 8803: \"0-RTT TCP Convert Protocol\".
[10] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[11] IEEE Std 802-2014: \"IEEE Standard for Local and Metropolitan Area
Networks: Overview and Architecture\".
[12] IEEE 802.3-2018: \"IEEE Standard for Ethernet\".
[13] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[14] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.501 [2] apply:
**MA PDU session**
**Measurement assistance information**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5G-RG 5G Residential Gateway
ATSSS Access Traffic Steering, Switching, Splitting
ATSSS-LL ATSSS Low-Layer
LADN Local Area Data Network
MA PDU Multi-Access PDU
MPTCP Multi-Path TCP Protocol
PDU Protocol Data Unit
PMF Performance Measurement Function
RTT Round Trip Time
SA PDU Single-Access PDU
SDF Service Data Flow
UPF User Plane Function
URSP UE Route Selection Policy
# 4 General description
## 4.1 Introduction
ATSSS is an optional feature that can be supported by the UE and the 5GC
network to route data traffic across 3GPP access and non-3GPP access networks.
An ATSSS capable UE establishes an MA PDU session supporting multi-access
connectivity over 3GPP access and non-3GPP access networks as described in
clause 4.2. The ATSSS capable UE can support ATSSS-LL and/or MPTCP steering
functionality as described in clause 4.3, with associated steering modes, i.e.
active-standby, smallest delay, load balancing, priority based. The ATSSS
capable UE indicates the steering functionality and associated steering modes
to the 5GC network.
When the ATSSS capable UE registers to a registration area, it receives an
indication from the AMF if the network supports the ATSSS. The procedure for
how the AMF indicates the UE about its ATSSS support is specified in 3GPP TS
24.501 [6]. The UE capable ATSSS and the network supporting ATSSS exchange
access performance measurements as described in clause 4.4. Clause 4.5
describes the traffic distribution over 3GPP access and non-3GPP access
networks. Clause 4.6 provides a description for interworking with EPS network.
Clause 4.7 describes ATSSS when 5G-RG is interconnected with EPS.
The architecture reference model for ATSSS support is described in clause
4.2.10 of 3GPP TS 23.501 [2].
## 4.2 Multi-access PDU session
A PDU session supporting a multi-access PDU connectivity service is referred
to as multi-access PDU (MA PDU) session. An MA PDU session is a PDU session
which can use one 3GPP access network or one non-3GPP access network at a
time, or simultaneously one 3GPP access network and one non-3GPP access
network as defined in 3GPP TS 23.501 [2].
An MA PDU session can be established when the UE is registered to the same
PLMN over 3GPP access network and non-3GPP access network or registered to
different PLMNs over 3GPP access network and non-3GPP access network
respectively. A UE can initiate MA PDU session establishment when the UE is
registered to a PLMN over both 3GPP access network and non-3GPP access
network, or only registered to one access network. Therefore, at any given
time, the MA PDU session can have user-plane resources established on both
3GPP access and non-3GPP access, or on one access only (either 3GPP access or
non-3GPP access), or can have no user-plane resources established on any
access.
An ATSSS capable UE can establish an MA PDU session based on the URSP rules as
defined in 3GPP TS 24.526 [5].
The following PDU session types are defined for an MA PDU session: IPv4, IPv6,
IPv4v6 and Ethernet.
NOTE 1: The unstructured PDU session type is not supported in this release of
the specification.
NOTE 2: An MA PDU session using IPv6 multi-homing or uplink classifier is not
specified in this release of the specification.
MA PDU sessions for LADN are not supported.
## 4.3 Steering functionalities
An ATSSS capable UE can use a steering functionality to steer, switch and
split the UL traffic across the 3GPP access network and the non-3GPP access
network as defined in clause 5.32.6 of 3GPP TS 23.501 [2]. An ATSSS capable
network can use the corresponding steering functionality for the DL traffic.
The UE and the network can support one or more of the following steering
functionalities:
a) the MPTCP steering functionality operates above the IP layer. The UE and an
associated MPTCP proxy functionality in the UPF can communicate by using the
MPTCP protocol; and
b) the ATSSS-LL steering functionality operates below the IP layer as a data
switching function.
## 4.4 Support of access performance measurements
The ATSSS capable UE can perform access performance measurements to decide how
to distribute traffic over 3GPP access and non-3GPP access.
An ATSSS capable UE receives measurement assistance information from the
network during the PDU session establishment procedure for an MA PDU session
as described in clause 5.32.5 of 3GPP TS 23.501 [2]. The measurement
assistance information (MAI) can contain the addressing information of the PMF
in the UPF, as well as the indicator on whether access
availability/unavailability reports need to be sent to the network. The
encoding of the measurement assistance information is specified in clause
6.1.5.
An ATSSS capable UE that supports the MPTCP steering functionality can use the
measurements available at the MPTCP layer.
The following PMF protocol messages can be exchanged between the PMF in the UE
and the PMF in the UPF:
a) messages for RTT measurements, only applicable for the ATSSS-LL steering
functionality; or
b) messages for reporting access availability/unavailability by the UE to the
UPF.
An ATSSS capable UE does not apply the ATSSS rules to the PMF protocol
messages.
The performance measurement function protocol procedures are specified in
clause 5. 4.3 and 5.4.4 including the procedures for:
a) UE-initiated RTT measurement; and
b) Network-initiated RTT measurement.
The access availability/unavailability procedures are specified in clause
5.4.5.
## 4.5 Distribution of traffic across 3GPP access and non-3GPP access networks
The UE can receive ATSSS rules during the PDU session establishment procedure
for an MA PDU session or network-requested PDU session modification procedure.
The ATSSS rule ID and ATSSS rule operation for each rule is used to add a new
ATSSS rule, or to delete or update an existing ATSSS rule. The UE can
distribute the UL traffic except for the PMF protocol messages across the 3GPP
access network and the non-3GPP access network according to the ATSSS rules
and other local conditions (such as network interface availability, signal
loss conditions, user preferences, etc.).
NOTE: On the network side, the SMF configures relevant N4 rules according to
the ATSSS control information provided by the PCF for the UPF to distribute DL
traffic across two access networks.
## 4.6 EPS interworking
In this release of specification, with the exception of an MA PDU session
established as specified in clause 4.7, the MA PDU session is established in
5GS.
In the network supporting N26 interface:
a) if the UE established an MA PDU session over non-3GPP access only, no EPS
bearer identity can be assigned to any QoS flow of the MA PDU session as
specified in 3GPP TS 23.502 [3];
b) if the UE established an MA PDU session over 3GPP access and non-3GPP
access and the user plane of the MA PDU session over 3GPP access is released,
the EPS bearer identity assigned for the MA PDU session can be revoked as
specified in 3GPP TS 23.502 [3];
c) for an inter-system change from N1 mode to S1 mode:
1) if the UE established an MA PDU session over 3GPP access only, the UE
follows the procedure as specified in clause 6.1.4.1 of 3GPP TS 24.501 [6]; or
2) if the UE established an MA PDU session over 3GPP access and non-3GPP
access, the UE follows the procedure as specified in clause 6.1.4.1 of 3GPP TS
24.501 [6], and
A) if the MA PDU session is transferred to EPS as a PDN connection, the SMF
can initiate the network-requested PDU session release procedure over non-3GPP
access as specified in clause 6.3.3.2 of 3GPP TS 24.501 [6] or perform a local
release of the MA PDU session. The UE performs a local release of locally
releases the MA PDU session over 3GPP access and non-3GPP access; or
NOTE 1: If the UE receives from the network a PDU SESSION RELEASE COMMAND
message which indicates to release the MA PDU session over non-3GPP access and
the UE has already performed or is performing a local release of the MA PDU
session, the error handling as specified in clause 6.3.3.6 of 3GPP TS 24.501
[6] is applied.
NOTE 2: The QoS flow(s) with EBI assigned over non-3GPP access is also
transferred to the corresponding PDN connection.
B) if the MA PDU session is not transferred to EPS as a PDN connection and the
SMF decides to move the traffic of the MA PDU session from 3GPP access to
non-3GPP access, the SMF can initiate the network-requested PDU session
modification procedure as specified in clause 6.3.2.2 of 3GPP TS 24.501 [6];
and
d) for an inter-system change from S1 mode to N1 mode, if the UE requests an
MA PDU session or the related URSP or UE local configuration does not mandate
that the PDU session is established over a single access when transferring the
PDN connection to 3GPP access, the PDN connection can be converted by the
network to an MA PDU session via the UE-requested PDU session modification
procedure (see clause 5.2.5).
In the network not supporting N26 interface:
a) for an inter-system change from N1 mode to S1 mode, if the UE intends to
transfer the MA PDU session to EPS, the UE follows the procedure as specified
in clause 6.1.4.2 of 3GPP TS 24.501 [6] and performs a local release of the MA
PDU session over 3GPP access and non-3GPP access. The SMF can initiate the
network-requested PDU session release procedure over non-3GPP access as
specified in clause 6.3.3.2 of 3GPP TS 24.501 [6] or perform a local release
of the MA PDU session; and
NOTE 3: If the UE receives from the network a PDU SESSION RELEASE COMMAND
message which indicates to release the MA PDU session over non-3GPP access and
the UE has already performed or is performing a local release of the MA PDU
session, the error handling as specified in clause 6.3.3.6 of 3GPP TS 24.501
[6] is applied.
b) for an inter-system change from S1 mode to N1 mode, if the related URSP or
UE local configuration does not mandate that the PDU session is established
over a single access, the UE can initiate the UE-requested PDU session
establishment procedure to request an MA PDU session (see clause 5.2.1) or to
allow the PDU session to be upgraded to an MA PDU session (see clause 5.2.6)
when transferring the PDN connection to 5GS.
## 4.7 MA PDU session when 5G-RG is connected to EPS
A 5G-RG can connect to both 5GCN and EPC as specified in clause 4.12 of 3GPP
TS 23.316 [4].
When establishing a PDN connection over EPS, the 5G-RG can indicate that the
PDN connection is to be used as a user-plane resource associated with:
a) a new MA PDU session; or
b) an existing MA PDU session established in wireline access connected to
5GCN.
In the network supporting N26 interface, for an inter-system change from N1
mode to S1 mode and from S1 mode to N1 mode, the MA PDU session established by
the 5G-RG is handled as specified in clause 6.1.4.1 of 3GPP TS 24.501 [6].
In the network not supporting N26 interface, for an inter-system change from
N1 mode to S1 mode and from S1 mode to N1 mode, the MA PDU session established
by the 5G-RG is handled as specified in clause 6.1.4.2 of 3GPP TS 24.501 [6].
# 5 ATSSS control procedures
## 5.1 Introduction
The ATSSS control procedures include:
a) handling of multi-access PDU connectivity service procedures (see clause
5.2);
b) handling of hybrid access with multi-access PDU connectivity (see clause
5.3); and
c) access performance measurement procedures (see clause 5.4).
In clause 5.2, handling of multi-access PDU connectivity service procedures
include following management procedures:
a) activation of multi-access PDU connectivity service;
b) re-activation of user-plane resources;
c) release of user-plane resources;
d) updating ATSSS parameters;
e) converting PDU session transferred from EPS to MA PDU session; and
f) PDU session establishment with network modification to MA PDU session.
In clause 5.3, the multi-access PDU connectivity procedures over E-UTRAN and
wireline access network are specified. In this release of the specification,
the procedures are applied for 5G-RG only.
In clause 5.4, access performance measurement procedures are performed by
exchanges of PMF protocol messages between the PMF in a UE and the PMF in the
UPF over the user plane. For MA PDU sessions of IPv4, IPv6, or IPv4v6 PDU
session type, the PMF protocol messages are transported using UDP. For MA PDU
sessions of Ethernet PDU session type, the PMF protocol messages are
transported using Ethernet frames. The protocol stacks of the PMF protocol are
specified in clause 5.32.5.4 of 3GPP TS 23.501 [2].
## 5.2 Multi-access PDU connectivity service
### 5.2.1 Activation of multi-access PDU connectivity service
Activating multi-access PDU connectivity service refers to the establishment
of user-plane resources on both 3GPP access and non-3GPP access:
a) if the UE is registered over both 3GPP access and non-3GPP access in the
same PLMN, the UE shall initiate the UE-requested PDU session establishment
procedure as specified in clause 6.4.1.2 of 3GPP TS 24.501 [6] over a selected
access, either 3GPP access or non-3GPP access. Over which access to initiate
this UE-requested PDU session establishment procedure is UE implementation
specific. When the UE receives the PDU SESSION ESTABLISHMENT ACCEPT message
including the ATSSS container IE as specified in clause 6.4.1.3 of 3GPP TS
24.501 [6], the UE shall consider that the MA PDU session has been established
and the user plane resources are successfully established on the selected
access. When the user plane resources are established on the access other than
the selected access (e.g. received lower layer indication in 3GPP access or
established user plane IPsec SA in untrusted non-3GPP access), the UE shall
consider the user plane resources are established on both;
NOTE: If the UE receives the PDU SESSION ESTABLISHMENT ACCEPT message
including the ATSSS container IE and determines, upon an implementation
specific timer expiry, fails to receive user plane resources established on
the access other than the selected access, the UE re-initiates the UE-
requested PDU session establishment procedure over the access other than the
selected access, in order to establish user plane resources on the access
other than the selected access.
b) if the UE is registered over both 3GPP access and non-3GPP access in
different PLMNs, the UE shall initiate the UE-requested PDU session
establishment procedure as specified in clause 6.4.1.2 of 3GPP TS 24.501 [6]
over 3GPP access and non-3GPP access sequentially. Over which access to first
initiate the UE-requested PDU session establishment procedure is UE
implementation specific. When the UE receives the PDU SESSION ESTABLISHMENT
ACCEPT message including the ATSSS container IE as specified in clause 6.4.1.3
of 3GPP TS 24.501 [6] over the selected access, the UE shall consider that the
MA PDU session has been established and the user plane resources of the MA PDU
session on this access are successfully established. The UE shall then
initiate the UE-requested PDU session establishment procedure with the same
PDU session ID, as specified in clause 6.4.1.2 of 3GPP TS 24.501 [6] over the
other access, in order to establish user plane resources on the other access
for the MA PDU session. If the UE receives the PDU SESSION ESTABLISHMENT
ACCEPT message as specified in clause 6.4.1.3 of 3GPP TS 24.501 [6] over the
other access, the UE shall consider that the user plane resources of the MA
PDU session have been established on both 3GPP access and non-3GPP access; or
c) if the UE is registered to a PLMN over only one access, either 3GPP access
or non-3GPP access, the UE shall initiate the UE-requested PDU session
establishment procedure as specified in clause 6.4.1.2 of 3GPP TS 24.501 [6]
over this access. When the UE receives the PDU SESSION ESTABLISHMENT ACCEPT
message including the ATSSS container IE as specified in clause 6.4.1.3 of
3GPP TS 24.501 [6] over the access, the UE shall consider that the MA PDU
session has been established and the user plane resources of the MA PDU
session on this access are successfully established. When the UE at a later
point in time registers over the other access, either in the same PLMN or in a
different PLMN, the UE shall initiate the UE-requested PDU session
establishment procedure with the same PDU session ID as specified in clause
6.4.1.2 of 3GPP TS 24.501 [6] over the other access in order to establish user
plane resources on the other access for the MA PDU session. If the UE receives
the PDU SESSION ESTABLISHMENT ACCEPT message as specified in clause 6.4.1.3 of
3GPP TS 24.501 [6] over the other access, the UE shall consider that the user
plane resources of the MA PDU session have been established over both 3GPP
access and non-3GPP access.
If the UE is in the non-allowed area, the UE shall not initiate a PDU session
establishment procedure for an MA PDU session over the 3GPP access. It may
still initiate a PDU session establishment procedure for an MA PDU session
over the non-3GPP access other than wireline access network, however the
network shall not establish user plane resources for the 3GPP access if the UE
is in the non-allowed area. The handling of non-allowed area when using
wireline access is described in 3GPP TS 23.316 [4].
### 5.2.2 Re-activation of user-plane resources
In order to re-establish the user-plane resources of an MA PDU session:
a) if the UE requests re-establishment of the user-plane resources of the MA
PDU session over 3GPP access which were released, the UE shall include the
Uplink data status IE indicating the related MA PDU session,
1) in the REGISTRATION REQUEST message when the registration procedure for
mobility and periodic registration update is initiated by the UE over 3GPP
access as specified in clause 5.5.1.3.2 of 3GPP TS 24.501 [6]; or
2) in the SERVICE REQUEST message when the service request procedure initiated
by the UE over 3GPP access as specified in clause 5.6.1.2 of 3GPP TS 24.501
[6];
b) if the UE requests re-establishment of the user-plane resources of the MA
PDU session over non-3GPP access which were released and the UE is in 5GMM-
CONNECTED mode over non-3GPP access, the UE shall include the Uplink data
status IE indicating the related MA PDU session,
1) in the REGISTRATION REQUEST message when the registration procedure for
mobility registration update is initiated by the UE over non-3GPP access as
specified in clause 5.5.1.3.2 of 3GPP TS 24.501 [6]; or
2) in the SERVICE REQUEST message when the service request procedure initiated
by the UE over non-3GPP access as specified in clause 5.6.1.2 of 3GPP TS
24.501 [6];
c) if the UE requests re-establishment of the user-plane resources of the MA
PDU session over non-3GPP access which were released and the UE is in 5GMM-
IDLE mode over non-3GPP access,
1) for untrusted non-3GPP access, the UE shall perform the procedure as
specified in clause 7.3 of 3GPP TS 24.502 [7] and include the Uplink data
status IE indicating the related MA PDU session in the SERVICE REQUEST message
when the service request procedure initiated by the UE over non-3GPP access as
specified in clause 5.6.1.2 of 3GPP TS 24.501 [6]; or
2) for trusted non-3GPP access, the UE shall perform the procedures as
specified in clause 7.3A of 3GPP TS 24.502 [7] and include the Uplink data
status IE indicating the related MA PDU session in the SERVICE REQUEST message
when the service request procedure initiated by the UE over non-3GPP access as
specified in clause 5.6.1.2 of 3GPP TS 24.501 [6]; and
d) if the network requests re-establishment of the user-plane resources of the
MA PDU session, the UE shall initiate the service request procedure by sending
a SERVICE REQUEST message to the AMF upon receipt of the paging request as
specified in clause 5.6.1.2 of 3GPP TS 24.501 [6] or shall follow the
procedure specified in clause 5.6.3 of 3GPP TS 24.501 [6] upon receipt of a
NOTIFICATION message.
If the UE is in the non-allowed area, the UE shall not request re-
establishment of the user plane resources of the MA PDU session for the 3GPP
access. It may still request re-establishment of the user plane resources of
the MA PDU session for the non-3GPP access.
### 5.2.3 Release of user-plane resources
In order to release the MA PDU session:
a) the SMF shall initiate the network-requested PDU session release procedure
as specified in clause 6.3.3.2 of 3GPP TS 24.501 [6] over 3GPP access or
non-3GPP access, by sending the PDU SESSION RELEASE COMMAND message to the UE.
Over which access to initiate this network-requested PDU session release
procedure is SMF implementation specific; or
b) the UE shall initiate the UE-requested PDU session release procedure as
specified in clause 6.4.3.2 of 3GPP TS 24.501 [6] over 3GPP access or non-3GPP
access by sending the PDU SESSION RELEASE REQUEST message to the network. Over
which access to initiate this UE-requested PDU session release procedure is UE
implementation specific.
When the UE receives the PDU SESSION RELEASE COMMAND message, the UE shall
behave as specified in 3GPP TS 24.501 [6] clause 6.3.3.3.
In order to release the MA PDU session\'s user-plane resources on either 3GPP
access or non-3GPP access, the SMF shall initiate the network-requested PDU
session release procedure as specified in clause 6.3.3.2 of 3GPP TS 24.501 [6]
over 3GPP access or non-3GPP access, by sending the PDU SESSION RELEASE
COMMAND message with the Access type IE indicating of which access the user-
plane resources are released to the UE, e.g. when the AMF indicates to the SMF
that the UE is deregistered over an access or when S-NSSAI of the MA PDU
session is not in the Allowed NSSAI over an access. Over which access to
initiate this network-requested PDU session release procedure is SMF
implementation specific. When the UE receives the PDU SESSION RELEASE COMMAND
message, the UE shall behave as specified in 3GPP TS 24.501 [6] clause
6.3.3.3, and consider that the user plane resources of the MA PDU session have
been released on the access indicated in the Access type IE.
### 5.2.4 Updating ATSSS parameters
An SMF can update ATSSS parameters, e.g. the ATSSS rules, according to the
procedure for the network-requested PDU session modification as specified in
clause 6.3.2 of 3GPP TS 24.501 [6] over 3GPP access network or non-3GPP access
network. The ATSSS rules can be individually added, deleted or updated using
the ATSSS rule ID and ATSSS rule operation. The SMF may change the access
network over which the traffic of the GBR QoS flow is transmitted by updating
the UE\'s ATSSS rules.
### 5.2.5 Converting PDU session transferred from EPS to MA PDU session
When an ATSSS capable UE has transferred a PDN connection from S1 mode to N1
mode in the network supporting N26 interface and the related URSP or UE local
configuration does not mandate the PDU session shall be established over a
single access:
a) if the UE is registered over both 3GPP access and non-3GPP access in the
same PLMN, and the S-NSSAI associated with the PDU session over 3GPP access is
included in the allowed NSSAI of non-3GPP access, the UE may initiate the UE-
requested PDU session modification procedure by sending the PDU SESSION
MODIFICATION REQUEST message including 5GSM capability IE over 3GPP access as
specified in clause 6.4.2.2 of 3GPP TS 24.501 [6]. The UE may set the Request
type IE to either:
1) \"modification request\" and include the MA PDU session information IE set
to \"MA PDU session network upgrade allowed\" as specified in clause 9.11.3.63
of 3GPP TS 24.501 [6]; or
2) \"MA PDU request\"
in the UL NAS TRANSPORT message as specified in clause 8.2.10 of 3GPP TS
24.501 [6]. When the UE receives the PDU SESSION MODIFICATION COMMAND message
including the ATSSS container IE as specified in clause 6.4.2.3 of 3GPP TS
24.501 [6], the UE shall consider that the requested PDU session was converted
by the network to an MA PDU session and the user plane resources are
successfully established on 3GPP access. When the user plane resources are
established on the non-3GPP access (e.g., received established user plane
IPsec SA in untrusted non-3GPP access), the UE shall consider the user plane
resources are established on both accesses;
NOTE: If the UE receives the PDU SESSION MODIFICATION COMMAND message
including the ATSSS container IE and determines, upon an implementation
specific timer expiry, fails to receive user plane resources established on
the non-3GPP access, the UE initiates the UE-requested PDU session
establishment procedure over the non-3GPP access, in order to establish user
plane resources on the non-3GPP access.
b) if the UE is registered over both 3GPP access and non-3GPP access in
different PLMNs, the UE may initiate the UE-requested PDU session modification
procedure by sending the PDU SESSION MODIFICATION REQUEST message including
5GSM capability IE over 3GPP access as specified in clause 6.4.2.2 of 3GPP TS
24.501 [6]. The UE may set the Request type IE to either:
1) \"modification request\" and include the MA PDU session information IE set
to \"MA PDU session network upgrade allowed\" as specified in clause 9.11.3.63
of 3GPP TS 24.501 [6]; or
2) \"MA PDU request\"
in the UL NAS TRANSPORT message as specified in clause 8.2.10 of 3GPP TS
24.501 [6]. When the UE receives the PDU SESSION MODIFICATION COMMAND message
including the ATSSS container IE as specified in clause 6.4.2.3 of 3GPP TS
24.501 [6], the UE shall consider that the requested PDU session was converted
by the network to an MA PDU session and the user plane resources are
successfully established on 3GPP access. The UE shall then initiate the UE-
requested PDU session establishment procedure with the same PDU session ID, as
specified in clause 6.4.1.2 of 3GPP TS 24.501 [6] over non-3GPP access, in
order to establish user plane resources on the other access for the MA PDU
session; or
c) if the UE is registered over 3GPP access only, the UE may initiate the UE-
requested PDU session modification procedure by sending the PDU SESSION
MODIFICATION REQUEST message including 5GSM capability IE over 3GPP access as
specified in clause 6.4.2.2 of 3GPP TS 24.501 [6], The UE may set the Request
type IE to either:
1) \"modification request\" and include the MA PDU session information IE set
to \"MA PDU session network upgrade allowed\" as specified in clause 9.11.3.63
of 3GPP TS 24.501 [6]; or
2) \"MA PDU request\"
in the UL NAS TRANSPORT message as specified in clause 8.2.10 of 3GPP TS
24.501 [6]. When the UE receives the PDU SESSION MODIFICATION COMMAND message
including the ATSSS container IE as specified in clause 6.4.2.3 of 3GPP TS
24.501 [6], the UE shall consider that the requested PDU session was converted
by the network to an MA PDU session and the user plane resources are
successfully established on 3GPP access. When the UE at a later point in time
registers over the non-3GPP access, either in the same PLMN or in a different
PLMN, the UE shall initiate the UE-requested PDU session establishment
procedure with the same PDU session ID as specified in clause 6.4.1.2 of 3GPP
TS 24.501 [6] over non-3GPP access in order to establish user plane resources
on non-3GPP access for the MA PDU session.
### 5.2.6 PDU session establishment with network modification to MA PDU
session
When an ATSSS capable UE establishes a new PDU session and the related URSP or
UE local configuration does not mandate the PDU session shall be established
over a single access:
a) if the UE is registered over both 3GPP access and non-3GPP access in the
same PLMN and the UE initiates the UE-requested PDU session establishment
procedure over a selected access, either 3GPP access or non-3GPP acc _ess, the
UE may include_ the MA PDU session information IE in the UL NAS TRANSPORT
message and set the IE to \"MA PDU session network upgrade is allowed\" as
specified in clause 9.11.3.63 of 3GPP TS 24.501 [6]. When the UE receives the
PDU SESSION ESTABLISHMENT ACCEPT message including the ATSSS container IE as
specified in clause 6.4.1.3 of 3GPP TS 24.501 [6], the UE shall consider that
the requested PDU session is established as an MA PDU session and the user
plane resources are successfully established on the selected access. When the
user plane resources are established on the access other than the selected
access (e.g. received lower layer indication in 3GPP access or established
user plane IPsec SA in untrusted non-3GPP access), the UE shall consider the
user plane resources are successfully established on both accesses;
NOTE: If the UE receives the PDU SESSION ESTABLISHMENT ACCEPT message
including the ATSSS container IE and determines, upon an implementation
specific timer expiry, fails to receive user plane resources established on
the access other than the selected access, the UE re-initiates the UE-
requested PDU session establishment procedure over the access other than the
selected access, in order to establish user plane resources on the access
other than the selected access.
b) if the UE is registered over both 3GPP access and non-3GPP access in
different PLMNs and the UE initiates the UE-requested PDU session
establishment procedure over 3GPP access or non-3GPP access, the UE may
include the MA PDU session information IE in the UL NAS TRANSPORT message and
shall set the IE to \"MA PDU session network upgrade is allowed\" as specified
in clause 9.11.3.63 of 3GPP TS 24.501 [6]. When the UE receives the PDU
SESSION ESTABLISHMENT ACCEPT message including the ATSSS container IE as
specified in clause 6.4.1.3 of 3GPP TS 24.501 [6] over the access, the UE
shall consider that the requested PDU session is established as an MA PDU
session and the user plane resources are established on this access. The UE
shall then initiate the UE-requested PDU session establishment procedure with
the same PDU session ID, as specified in clause 6.4.1.2 of 3GPP TS 24.501 [6]
over the other access, in order to establish user plane resources on the other
access for the MA PDU session. If the UE receives the PDU SESSION
ESTABLISHMENT ACCEPT message including the ATSSS container IE as specified in
clause 6.4.1.3 of 3GPP TS 24.501 [6] over the other access, the UE shall
consider that the user plane resources of the MA PDU session have been
established on both 3GPP access and non-3GPP access; or
c) if the UE is registered to a PLMN over only one access, either 3GPP access
or non-3GPP access, and the UE requests to establish a PDU session over this
access, the UE may include the MA PDU session information IE in the UL NAS
TRANSPORT message and shall set the IE to \"MA PDU session network upgrade is
allowed\" as specified in clause 9.11.3.63 of 3GPP TS 24.501 [6]. When the UE
receives the PDU SESSION ESTABLISHMENT ACCEPT message including the ATSSS
container IE as specified in clause 6.4.1.3 of 3GPP TS 24.501 [6] over the
access, the UE shall consider that the requested PDU session is established as
an MA PDU session and the user plane resources are established on this access.
When the UE at a later point in time registers over the other access, either
in the same PLMN or in a different PLMN, the UE shall initiate the UE-
requested PDU session establishment procedure with the same PDU session ID as
specified in clause 6.4.1.2 of 3GPP TS 24.501 [6] over the other access in
order to establish user plane resources on the other access for the MA PDU
session. If the UE receives the PDU SESSION ESTABLISHMENT ACCEPT message
including the ATSSS container IE as specified in clause 6.4.1.3 of 3GPP TS
24.501 [6] over the other access, the UE shall consider that the user plane
resources of the MA PDU session have been established on both 3GPP access and
non-3GPP access.
## 5.3 Hybrid access with multi-access PDU connectivity over E-UTRAN and
wireline access network
### 5.3.1 5G-RG establishing a PDN connection as a user-plane resource of an
MA PDU session to be established
In order to establish a PDN connection as a user-plane resource of an MA PDU
session to be established, the 5G-RG shall initiate the UE requested PDN
connectivity procedure according to 3GPP TS 24.301 [10].
In the PDN CONNECTIVITY REQUEST message or, when applicable, in the ESM
INFORMATION RESPONSE message, of the UE requested PDN connectivity procedure:
a) the 5G-RG shall set the request type to \"initial request\" as specified in
3GPP TS 24.301 [10];
NOTE: According to 3GPP TS 24.301 [10], a newly generated PDU session ID is
included in the protocol configuration options IE or the extended protocol
configuration options IE of the PDN CONNECTIVITY REQUEST message with the
request type \"initial request\".
b) the 5G-RG shall set the PDN Type IE to \"IPv4\", \"IPv6\" or \"IPv4v6\";
and
c) in the protocol configuration options or extended protocol configuration
options IE of the PDN CONNECTIVITY REQUEST message, the 5G-RG shall include
the ATSSS request PCO parameter. In the ATSSS request PCO parameter:
1) if the 5G-RG supports ATSSS Low-Layer functionality with any steering mode
as specified in clause 5.32.6 of 3GPP TS 23.501 [2], the 5G-RG shall set the
ATSSS-ST field to \"ATSSS Low-Layer functionality with any steering mode
supported\";
2) if the 5G-RG supports MPTCP functionality with any steering mode and ATSSS-
LL functionality with only active-standby steering mode as specified in clause
5.32.6 of 3GPP TS 23.501 [2], the 5G-RG shall set the ATSSS-ST field to
\"MPTCP functionality with any steering mode and ATSSS-LL functionality with
only active-standby steering mode supported\"; or
3) if the 5G-RG supports MPTCP functionality with any steering mode and ATSSS-
LL functionality with any steering mode as specified in clause 5.32.6 of 3GPP
TS 23.501 [2], the 5G-RG shall set the ATSSS-ST field to \"MPTCP functionality
with any steering mode and ATSSS-LL functionality with any steering mode
supported\".
Upon receipt of an ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message of a
default EPS bearer context activation procedure as a response to the PDN
CONNECTIVITY REQUEST message as specified in 3GPP TS 24.301 [10], the ACTIVATE
DEFAULT EPS BEARER CONTEXT REQUEST message containing the extended protocol
configuration options IE with the ATSSS response with the length of two octets
PCO parameter:
a) the 5G-RG shall consider that the MA PDU session is established based on
parameters from the default EPS bearer context of the PDN connection, as
follows:
1) the PDN type of the default EPS bearer context shall be mapped to the PDU
session type of the MA PDU session as follows:
i) if the PDN type is \"IPv4\", the PDU session type is set to \"IPv4\";
ii) if the PDN type is \"IPv6\", the PDU session type is set to \"IPv6\"; or
iii) if the PDN type is \"IPv4v6\", the PDU session type is set to \"IPv4v6\";
2) the PDN address of the default EPS bearer context shall be mapped to PDU
address of the MA PDU session;
3) the APN of the default EPS bearer context shall be mapped to the DNN of the
MA PDU session;
4) the PDU session identity of the MA PDU session shall be set to the PDU
session identity included by the UE in the Protocol configuration options IE
or Extended protocol configuration options IE in the PDN CONNECTIVITY REQUEST
message;
5) the S-NSSAI of the MA PDU session shall be set to the S-NSSAI included by
the network in the Protocol configuration options IE or Extended protocol
configuration options IE in the ACTIVATE DEFAULT EPS BEARER REQUEST message,
if the PDN connection is a non-emergency PDN connection;
6) the SSC mode of the MA PDU session shall be set to \"SSC mode 1\"; and
7) state of the PDU session shall be set to PDU SESSION ACTIVE;
and that the PDN connection is established as a user-plane resource of the MA
PDU session;
b) if the network steering functionalities information is included in the
ATSSS response with the length of two octets PCO parameter, the 5G-RG shall
use the network steering functionalities information; and
c) if the measurement assistance information is included in the ATSSS response
with the length of two octets PCO parameter, the 5G-RG shall use the
measurement assistance information.
Upon receipt of:
a) a PDN CONNECTIVITY REJECT message as a response to the PDN CONNECTIVITY
REQUEST message as specified in 3GPP TS 24.301 [10]; or
b) an ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message of a default EPS
bearer context activation procedure as a response to the PDN CONNECTIVITY
REQUEST message as specified in 3GPP TS 24.301 [10] without the extended
protocol configuration options IE containing the ATSSS response with the
length of two octets PCO parameter;
the 5G-RG shall consider that the MA PDU session is not established and the
PDN connection is not established as a user-plane resource of the MA PDU
session.
### 5.3.2 5G-RG establishing a PDN connection as a user-plane resource of an
already established MA PDU session
In order to establish a PDN connection as a user-plane resource of an already
established MA PDU session, the 5G-RG shall initiate the UE requested PDN
connectivity procedure according to 3GPP TS 24.301 [10].
In the PDN CONNECTIVITY REQUEST message or, when applicable, in the ESM
INFORMATION RESPONSE message, of the UE requested PDN connectivity procedure:
a) the 5G-RG shall set the request type to \"handover\" as specified in 3GPP
TS 24.301 [10];
NOTE: According to 3GPP TS 24.301 [10], the PDU session ID of the already
established MA PDU session is included in the protocol configuration options
IE or the extended protocol configuration options IE of the PDN CONNECTIVITY
REQUEST message with the request type \"handover\".
b) the 5G-RG shall set the PDN Type IE to \"IPv4\", \"IPv6\" or \"IPv4v6\";
and
c) in the protocol configuration options or extended protocol configuration
options IE, the 5G-RG shall include the ATSSS request PCO parameter.
Upon receipt of the ACTIVATE DEFAULT EPS BEARER CONTEXT REQUEST message of a
default EPS bearer context activation procedure as a response to the PDN
CONNECTIVITY REQUEST message as specified in 3GPP TS 24.301 [10], the 5G-RG
shall consider that the PDN connection is established as a user-plane resource
of the MA PDU session.
Upon receipt of a PDN CONNECTIVITY REJECT message as specified in 3GPP TS
24.301 [10], the 5G-RG shall consider that the PDN connection is not
established as a user-plane resource of the MA PDU session.
## 5.4 Performance measurement function (PMF) protocol (PMFP) procedures
### 5.4.1 General
Performance measurement function protocol (PMFP) procedures are performed
between a performance measurement function (PMF) in a UE and a PMF in the UPF.
The following UE-initiated PMFP procedures are specified:
a) UE-initiated RTT measurement procedure; and
b) access availability or unavailability report procedure.
The following UPF-initiated PMFP procedures are specified:
a) UPF-initiated RTT measurement procedure.
The UE-initiated PMFP procedures and the UPF-initiated PMFP procedures can be
performed in an MA PDU session only when the measurement assistance
information is provided to the UE during establishment of the MA PDU session.
PMFP messages are transported in an IP packet or an Ethernet frame according
to clause 5.3.2.
PMFP messages transported between the UE and the UPF (and vice versa) are
protected using the security mechanisms protecting the user data packets
transported over NG-RAN or non-3GPP access connected to the 5GCN and over the
N3 and N9 reference points, specified in 3GPP TS 33.501 [r33501]. A PMFP-
specific security mechanism is not specified.
NOTE: Even though transport of PMFP messages between the UE and the UPF is
protected, a compromised UE can send false or incorrect PMFP messages.
PMFP is a standard L3 protocol according to 3GPP TS 24.007 [13], PMFP messages
are standard L3 messages according to 3GPP TS 24.007 [13] and error behaviour
specified for L3 protocol in according to 3GPP TS 24.007 [13] applies for
PMFP.
PMFP messages are transported over the QoS flow of the default QoS rule in
this release of specification.
### 5.4.2 Elementary procedures for PMFP
#### 5.4.2.1 PMFP message transport
##### 5.4.2.1.1 PMFP message transport in IPv4, IPv6 or IPv4v6 PDU session
In order to send a PMFP message over an access of an MA PDU session of IPv4,
IPv6 or IPv4v6 PDU session type:
a) if the UE obtained IPv4 address for the PDU session and the received
measurement assistance information contains an IPv4 address of the PMF in the
UPF, the UE shall create a UDP/IPv4 packet. In the UDP/IPv4 packet, the UE:
1) shall set the data octets field to the PMFP message;
2) shall set the source port field to the UDP port of the PMF in the UE;
3) shall set the destination port field to the UDP port of the PMF in the UPF
associated with the access of the MA PDU session, included in the received
measurement assistance information;
4) shall set the source address field to the IPv4 address of the UE; and
5) shall set the destination address field to the IPv4 address of the PMF in
the UPF, included in the received measurement assistance information; or
b) if the UE obtained IPv6 prefix for the PDU session, generated an IPv6
address for the PMF in the UE and the received measurement assistance
information contains an IPv6 address of the PMF in the UPF, the UE shall
create a UDP/IPv6 packet. In the UDP/IPv6 packet, the UE:
1) shall set the data octets field to the PMFP message;
2) shall set the source port field to the UDP port of the PMF in the UE;
3) shall set the destination port field to the UDP port of the PMF in the UPF
associated with the access of the MA PDU session, included in the received
measurement assistance information;
4) shall set the source address field to the IPv6 address of the PMF in the
UE; and
5) shall set the destination address field to the IPv6 address of the PMF in
the UPF, included in the received measurement assistance information.
The UE shall send the UDP/IPv4 packet or UDP/IPv6 packet over the access of
the MA PDU session.
In order to send a PMFP message over an access of an MA PDU session of IPv4,
IPv6 or IPv4v6 PDU session type:
a) if the UPF is aware of the UDP port of the PMF in the UE used with IPv4,
the UPF shall create a UDP/IPv4 packet. In the UDP/IPv4 packet, the UPF:
1) shall set the data octets field to the PMFP message;
2) shall set the source port field to the UDP port of the PMF in the UPF
associated with the access of the MA PDU session, included in the measurement
assistance information provided to the UE;
3) shall set the destination port field to the UDP port of the PMF in the UE
used with IPv4;
4) shall set the source address field to the IPv4 address of the PMF in the
UPF, included in the measurement assistance information provided to the UE;
and
5) shall set the destination address field to the IPv4 address of the UE; or
a) if the UPF is aware of the UDP port and the IPv6 address of the PMF in the
UE, the UPF shall create a UDP/IPv6 packet. In the UDP/IPv6 packet, the UPF:
1) shall set the data octets field to the PMFP message;
2) shall set the source port field to the UDP port of the PMF in the UPF
associated with the access of the MA PDU session, included in the measurement
assistance information provided to the UE;
3) shall set the destination port field to the UDP port of the PMF in the UE;
4) shall set the source address field to the IPv6 address of the PMF in the
UPF, included in the measurement assistance information provided to the UE;
and
5) shall set the destination address field to the IPv6 address of the PMF in
the UE.
The UPF shall send the UDP/IPv4 packet or UDP/IPv6 packet over the access of
the MA PDU session.
The UE shall select the UDP port of the PMF in the UE upon establishment of an
MA PDU session of IPv4, IPv6 or IPv4v6 PDU session type. The UE shall use the
same UDP port of the PMF in the UE till release of the MA PDU session. The UE
shall select the IPv6 address of the PMF in the UE upon establishment of an MA
PDU session of IPv6 or IPv4v6 PDU session type. The UE shall use the same IPv6
address of the PMF in the UE till release of the MA PDU session.
The UPF shall discover the UDP port of the PMF in the UE used with IPv4 of an
MA PDU session of IPv4 or IPv4v6 PDU session type, in the source port field of
an UDP/IPv4 packet:
a) received via the MA PDU session;
b) with the destination port field set to the UDP port of the PMF in the UPF
associated with an access, included in the measurement assistance information
provided to the UE; and
c) with the destination address field set to the IPv4 address of the PMF in
the UPF, included the measurement assistance information provided to the UE.
The UPF shall discover the UDP port and the IPv6 address of the PMF in the UE
of an MA PDU session of IPv6 or IPv4v6 PDU session type, in the source port
field and the source address field of an UDP/IPv6 packet:
a) received via the MA PDU session;
b) with the destination port field set to the UDP port of the PMF in the UPF
associated with an access, included in the measurement assistance information
provided to the UE; and
c) with the destination address field set to the IPv6 address of the PMF in
the UPF, included the measurement assistance information provided to the UE.
In order to enable the UPF to discover:
a) the UDP port of the PMF in the UE in case of an MA PDU session of IPv4 or
IPv4v6 PDU session type, or
b) the UDP port and the IPv6 address of the PMF in the UE in case of an MA PDU
session of IPv6 or IPv4v6 PDU session type;
the UE shall perform a access availability or unavailability report procedure
over an access immediately after the MA PDU session is established. If the MA
PDU session is established over both 3GPP access and non-3GPP access, the UE
may use either of the accesses for the access availability or unavailability
report procedure. If the access availability or unavailability report
procedure is aborted, the UE shall repeat the access availability or
unavailability report procedure over the same access or, if the MA PDU session
is established over both 3GPP access and non-3GPP access, over the other
access.
##### 5.4.2.1.2 PMFP message transport in Ethernet PDU session
In order to send a PMFP message over an access of an MA PDU session of
Ethernet PDU session type, the UE shall create an Ethernet frame as specified
in IEEE 802.3 [12]. In the Ethernet frame, the UE:
a) shall set the length/type field of the Ethernet frame to the ethertype
value included in the received measurement assistance information;
b) shall set the destination address field of the Ethernet frame to the MAC
address of the PMF in the UPF associated with the access of the MA PDU
session, included in the received measurement assistance information;
c) shall set the source address field of the Ethernet frame to the MAC address
of the PMF in the UE;
d) shall set the MAC client data field of the Ethernet frame to the 3GPP IEEE
MAC based protocol family envelope;
e) shall set the protocol subtype field of the 3GPP IEEE MAC based protocol
family envelope to \"Performance measurement function protocol (PMFP)\"; and
f) shall set the PMFP message field of the protocol data field of the 3GPP
IEEE MAC based protocol family envelope to the PMFP message.
The UE shall send the Ethernet frame over the access of the MA PDU session.
In order to send a PMFP message over an access of an MA PDU session, the UPF
shall create an Ethernet frame as specified in IEEE 802.3 [12]. In the
Ethernet frame, the UPF:
a) shall set the length/type field of the Ethernet frame to the ethertype
value included in the measurement assistance information provided to the UE;
b) shall set the source address field of the Ethernet frame to the MAC address
of the PMF in the UPF associated with the access of the MA PDU session,
included in the measurement assistance information provided to the UE;
c) shall set the destination address field of the Ethernet frame to the MAC
address of the PMF in the UE;
d) shall set the MAC client data field of the Ethernet frame to the 3GPP IEEE
MAC based protocol family envelope;
e) shall set the protocol subtype field of the 3GPP IEEE MAC based protocol
family envelope to \"Performance measurement function protocol (PMFP)\"; and
f) shall set the PMFP message field of the protocol data field of the 3GPP
IEEE MAC based protocol family envelope to the PMFP message.
The UPF shall send the Ethernet frame so that the UE receives it over the
access of the MA PDU session.
The UE shall select the MAC address of the PMF in the UE upon establishment of
an MA PDU session of Ethernet PDU session type. The UE shall use the same MAC
address of the PMF in the UE till release of the MA PDU session.
The UPF shall discover the MAC address of the PMF in the UE of an MA PDU
session of Ethernet PDU session type, in the source address field of an
Ethernet frame:
a) received via the MA PDU session;
b) with the length/type field of the Ethernet frame set to the ethertype value
included in the measurement assistance information provided to the UE; and
c) with the destination address field of the Ethernet frame set to the MAC
address of the PMF in the UPF associated with an access, included in the
measurement assistance information provided to the UE.
In order to enable the UPF to discover the MAC address of the PMF in the UE of
an MA PDU session of Ethernet PDU session type, the UE shall perform an access
availability or unavailability report procedure over an access immediately
after the MA PDU session is established. If the MA PDU session is established
over both 3GPP access and non-3GPP access, the UE may use either of the
accesses for the access availability or unavailability report procedure. If
the access availability or unavailability report procedure is aborted, the UE
shall repeat the access availability or unavailability report procedure over
the same access or, if the MA PDU session is established over both 3GPP access
and non-3GPP access, over the other access.
#### 5.4.2.2 Extended procedure transaction identity (EPTI)
The UE shall maintain the current available UE EPTI value. When the MA PDU
session is established, the UE shall set the current available UE EPTI value
to 0000H. When a UE-initiated PMFP procedure is initiated, the UE shall
allocate the current available UE EPTI value to the UE-initiated PMFP
procedure and:
\- if the current available UE EPTI value is 7FFFH, shall set the current
available UE EPTI value to 0000H; or
\- otherwise, shall increase the current available UE EPTI value by one.
The UE shall release the EPTI value allocated to the UE-initiated PMFP
procedure when the UE-initiated PMFP procedure completes or is aborted.
The UPF shall maintain the current available UPF EPTI value. When the MA PDU
session is established, the UPF shall set the current available UPF EPTI value
to 8000H. When a UPF-initiated PMFP procedure is initiated, the UPF shall
allocate the current available UPF EPTI value to the UPF-initiated PMFP
procedure and:
\- if the current available UPF EPTI value is FFFFH, shall set the current
available UPF EPTI value to 8000H; or
\- otherwise, shall increase the current available UPF EPTI value by one.
The UPF shall release the EPTI value allocated to the UPF-initiated PMFP
procedure when the UPF-initiated PMFP procedure completes or is aborted.
### 5.4.3 UE-initiated RTT measurement procedure
#### 5.4.3.1 General
The purpose of the UE-initiated RTT measurement procedure is to enable the UE
to measure the RTT of an exchange of user data packets between the UE and the
UPF over an access of an MA PDU session.
The UE-initiated RTT measurement procedure can be performed over an access of
an MA PDU session only when the UE has user-plane resources on the access of
the MA PDU session.
#### 5.4.3.2 UE-initiated RTT measurement procedure initiation
In order to initiate a UE-initiated RTT measurement procedure over an access
of an MA PDU session, the UE shall allocate an EPTI value as specified in
clause 5.4.2.2 and shall create one or more PMFP ECHO REQUEST messages. The
number of created PMFP ECHO REQUEST messages is UE implementation specific. In
each PMFP ECHO REQUEST message, the UE:
a) shall set the EPTI IE to the allocated EPTI value;
b) shall set the RI IE to a unique value identifying the particular PMFP ECHO
REQUEST message within the transaction; and.
c) if the upper layers request a particular length of PMFP messages, shall
include the Padding IE such that length of the PMFP message becomes equal to
the requested length.
The UE shall start a timer T101 and shall send the one or more PMFP ECHO
REQUEST messages over the access of the MA PDU session.
An example of the UE-initiated RTT measurement procedure is shown in figure
5.3.3.2-1.
Figure 5.4.3.2-1: UE-initiated RTT measurement procedure
#### 5.4.3.3 UE-initiated RTT measurement procedure completion
Upon reception of the PMFP ECHO REQUEST message, the UPF shall create a PMFP
ECHO RESPONSE message. In the PMFP ECHO RESPONSE message, the UPF shall set
the EPTI IE to the EPTI value in the PMFP ECHO REQUEST message and shall set
the RI IE to the RI value in the PMFP ECHO REQUEST message. If the PMFP ECHO
REQUEST message contains the Padding IE, the UPF shall include the Padding IE
such that length of the PMFP message becomes equal to length of the received
PMFP message. The UPF shall send the PMFP ECHO RESPONSE message over the
access of the MA PDU session via which the PMFP ECHO REQUEST message was
received.
Upon reception of a PMFP ECHO RESPONSE message with the same EPTI as the
allocated EPTI value and with the RI value of a sent PMFP ECHO REQUEST
message, the UE shall determine the RTT value for the request identified by
the RI value by subtracting the current value of the timer T101 from the value
of the timer T101 valid when the PMFP ECHO REQUEST with the RI value was sent.
When a PMFP ECHO RESPONSE message with the same EPTI as the allocated EPTI
value has been received for each sent PMFP ECHO REQUEST message, the UE shall
calculate an average of the RTT values for the requests, shall stop the timer
T101.
#### 5.4.3.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiration of the timer T101
Upon expiration of the timer T101, the UE shall abort the procedure, shall
calculate an average of the RTT values for the requests for which a response
was received and shall count the number of requests for which no response was
received.
### 5.4.4 Network-initiated RTT measurement procedure
#### 5.4.4.1 General
The purpose of the UPF-initiated RTT measurement procedure is to enable the
UPF to measure the RTT of an exchange of user data packets between the UPF and
the UE over an access of an MA PDU session.
The UPF-initiated RTT measurement procedure can be performed over an access of
an MA PDU session only when the UE has user-plane resources on the access of
the MA PDU session.
#### 5.4.4.2 UPF-initiated RTT measurement procedure initiation
In order to initiate a UPF-initiated RTT measurement procedure over an access
of an MA PDU session, the UPF shall allocate a EPTI value as specified in
clause 5.4.2.2 and shall create one or more PMFP ECHO REQUEST messages. The
number of created PMFP ECHO REQUEST messages is UPF implementation specific.
In each PMFP ECHO REQUEST message, the UPF:
a) shall set the EPTI IE to the allocated EPTI value;
b) shall set the RI IE to a unique value identifying the particular PMFP ECHO
REQUEST message within the transaction; and
c) if the upper layers request a particular length of PMFP messages, shall
include the Padding IE such that length of the PMFP message becomes equal to
the requested length.
The UPF shall start a timer T201 and shall send the one or more PMFP ECHO
REQUEST messages over the access of the MA PDU session.
An example of the UPF-initiated RTT measurement procedure is shown in figure
5.4.4.2-1.
Figure 5.4.4.2-1: UPF-initiated RTT measurement procedure
#### 5.4.4.3 UPF-initiated RTT measurement procedure completion
Upon reception of the PMFP ECHO REQUEST message, the UE shall create a PMFP
ECHO RESPONSE message. In the PMFP ECHO RESPONSE message, the UE shall set the
EPTI IE to the EPTI value in the PMFP ECHO REQUEST message and shall set the
RI IE to the RI value in the PMFP ECHO REQUEST message. If the PMFP ECHO
REQUEST message contains the Padding IE, the UE shall include the Padding IE
such that length of the PMFP message becomes equal to length of the received
PMFP message. The UE shall send the PMFP ECHO RESPONSE message over the access
of the MA PDU session via which the PMFP ECHO REQUEST message was received.
Upon reception of a PMFP ECHO RESPONSE message with the same EPTI as the
allocated EPTI value and with the RI value of a sent PMFP ECHO REQUEST
message, the UPF shall determine the RTT value for the request identified by
the RI value by subtracting the current value of the timer T201 from the
starting value of the timer T201 valid when the PMFP ECHO REQUEST with the RI
value was sent.
When a PMFP ECHO RESPONSE message with the same EPTI as the allocated EPTI
value has been received for each sent PMFP ECHO REQUEST message, the UPF shall
calculate an average of the RTT values for the requests, shall stop the timer
T201.
#### 5.4.4.4 Abnormal cases in the network
The following abnormal cases can be identified:
a) Expiration of the timer T201
Upon expiration of the timer T201, the UPF shall abort the procedure, shall
calculate an average of the RTT values for the requests for which a response
was received and shall count the number of requests for which no response was
received.
### 5.4.5 Access availability or unavailability report procedure
#### 5.4.5.1 General
The purpose of the access availability or unavailability report procedure is
to enable the UE to inform the UPF about availability or unavailability of an
access of an MA PDU session.
#### 5.4.5.2 Access availability or unavailability report procedure initiation
In order to initiate an access availability or unavailability report procedure
over an access of an MA PDU session, the UE shall allocate a EPTI value as
specified in clause 5.4.2.2 and shall create a PMFP ACCESS REPORT message. In
the PMFP ACCESS REPORT message, the UE shall set the EPTI IE to the allocated
EPTI value. The UE shall send the PMFP ACCESS REPORT message over the access
of the MA PDU session and shall start a timer T102.
An example of the access availability or unavailability report procedure is
shown in figure 5.4.5.2-1.
Figure 5.4.5.2-1: Access availability or unavailability report procedure
#### 5.4.5.3 Access availability or unavailability report procedure completion
Upon reception of the PMFP ACCESS REPORT message, the UPF shall create a PMFP
ACKNOWLEDGEMENT message. In the PMFP ACKNOWLEDGEMENT message, the UPF shall
set the EPTI IE to the EPTI value in the PMFP ACCESS REPORT message. The UPF
shall send the PMFP ACKNOWLEDGEMENT message over the access of the MA PDU
session via which the PMFP ACCESS REPORT message was received.
Upon reception of a PMFP ACKNOWLEDGEMENT message with the same EPTI as the
allocated EPTI value, the UE shall stop the timer T102.
#### 5.4.5.4 Abnormal cases in the UE
The following abnormal cases can be identified:
a) Expiry of the timer T102
The UE shall, on the first expiry of the timer T102, retransmit the PMFP
ACCESS REPORT message and shall reset and start timer T102. This
retransmission can be repeated up to four times, i.e. on the fifth expiry of
timer T102, the UE shall abort the procedure.
# 6 PDUs and parameters specific to the present document
## 6.1 ATSSS parameters
### 6.1.1 General
The ATSSS parameters are the contents of the ATSSS container as defined in
clause 9.11.4.22 of 3GPP TS 24.501 [6].
The purpose of the ATSSS parameters is to indicate the parameters associated
with ATSSS (e.g. ATSSS rules).
### 6.1.2 Encoding of ATSSS parameters
The ATSSS container contents include one or more ATSSS parameters and they are
coded as shown in figure 6.1.2-1, figure 6.1.2-2 and table 6.1.2-1.
+-------------------+-------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +===================+=============+===+===+===+===+===+===+===+ | ATSSS parameter 1 | octet 1 | | | | | | | | | | | | | | | | | | | | octet a | | | | | | | | +-------------------+-------------+---+---+---+---+---+---+---+ | ATSSS parameter 2 | octet a+1* | | | | | | | | | | | | | | | | | | | | octet b* | | | | | | | | +-------------------+-------------+---+---+---+---+---+---+---+ | ... | octet b+1* | | | | | | | | | | | | | | | | | | | | ... | | | | | | | | | | | | | | | | | | | | octet c* | | | | | | | | +-------------------+-------------+---+---+---+---+---+---+---+ | ATSSS parameter N | octet c+1* | | | | | | | | | | | | | | | | | | | | octet d* | | | | | | | | +-------------------+-------------+---+---+---+---+---+---+---+
Figure 6.1.2-1: ATSSS container contents
+---------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +=================================+===========+===+===+===+===+===+===+===+ | ATSSS parameter identifier | octet f | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+ | ATSSS parameter contents length | octet f+1 | | | | | | | | | | | | | | | | | | | | octet f+2 | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+ | ATSSS parameter contents | octet f+3 | | | | | | | | | | | | | | | | | | | | octet g | | | | | | | | +---------------------------------+-----------+---+---+---+---+---+---+---+
Figure 6.1.2-2: ATSSS parameter
Table 6.1.2-1: ATSSS parameter
The ATSSS parameter identifier is encoded as follows: Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | ATSSS rules  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | Network steering functionalities information  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | Measurement assistance information  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The ATSSS parameter contents for the ATSSS rules are specified according to clause 6.1.3. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The ATSSS parameter contents for the network steering functionalities information are specified according to clause 6.1.4. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The ATSSS parameter contents for the measurement assistance information are specified according to clause 6.1.5. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
### 6.1.3 ATSSS rules
#### 6.1.3.1 Definition of ATSSS rules
The ATSSS rules are defined in 3GPP TS 23.501 [2] and is set of one or more
ATSSS rules, where a rule is composed of:
a) an ATSSS rule ID identifying the individual ATSSS rule;
b) an ATSSS rule operation identifying whether the ATSSS rule is added to or
deleted from the set of ATSSS rules;
c) a precedence value of the ATSSS rule identifying the precedence of the
ATSSS rule;
d) a traffic descriptor matching a service data flow (SDF); and
e) an access selection descriptor including:
1) a steering functionality:
A) MPTCP, the UE steers the SDF by using the MPTCP functionality; or
B) ATSSS-LL functionality, the UE steers the SDF by using the ATSSS-LL
functionality; and
NOTE: If the included steering functionality is not supported by the UE, the
UE ignores this ATSSS rule, and proceeds with the evaluation of the ATSSS rule
with the next smallest precedence, if available.
2) a steering mode:
A) active-standby, the UE steers the SDF by using the active access if the
active access is available. If the active access is not available and the
standby access is available, the UE steers the SDF by using the standby
access;
B) smallest delay, the UE steers the SDF by using the access network with the
smallest RTT. If there is only one access available, the UE steers the SDF by
using the available access. This steering mode is only applicable to non-GBR
SDF;
C) load balancing, the UE steers the SDF across both the 3GPP access and the
non-3GPP access with a given precentage if both accesses are available. If
there is only one access available, the UE steers the SDF by using the
available access. This steering mode is only applicable to non-GBR SDF; or
D) priority based, the UE steers the SDF over the access with high priority
unless the access with high priority is congested or unavailable, when the UE
steers the SDF over both the access with high priority and the access with low
priority. This steering mode is only applicable to non-GBR SDF.
#### 6.1.3.2 Encoding of ATSSS rules
The ATSSS rules are encoded as shown in figure 6.1.3.2-1, figure 6.1.3.2-2 and
figure 6.1.3.2-3 and table 6.1.3.2-1.
+--------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------+-----------+---+---+---+---+---+---+---+ | ATSSS rule 1 | octet a+1 | | | | | | | | | | | | | | | | | | | | octet s | | | | | | | | +--------------+-----------+---+---+---+---+---+---+---+ | ATSSS rule 2 | octet s+1 | | | | | | | | | | | | | | | | | | | | octet t | | | | | | | | +--------------+-----------+---+---+---+---+---+---+---+ | ... | octet t+1 | | | | | | | | | | | | | | | | | | | | octet u | | | | | | | | +--------------+-----------+---+---+---+---+---+---+---+ | ATSSS rule n | octet u+1 | | | | | | | | | | | | | | | | | | | | octet b | | | | | | | | +--------------+-----------+---+---+---+---+---+---+---+
Figure 6.1.3.2-1: ATSSS parameter contents including one or more ATSSS rules
+--------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | Length of ATSSS rule | octet a+1 | | | | | | | | | | | | | | | | | | | | octet a+2 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | ATSSS rule ID | octet a+3 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | ATSSS rule operation | octet a+4 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | Precedence value of ATSSS rule | octet a+5 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | Length of traffic descriptor | octet a+6 | | | | | | | | | | | | | | | | | | | | octet a+7 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | Traffic descriptor | octet a+8 | | | | | | | | | | | | | | | | | | | | octet s-4 | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+ | Access selection descriptor | octet s-3 | | | | | | | | | | | | | | | | | | | | octet s* | | | | | | | | +--------------------------------+-----------+---+---+---+---+---+---+---+
Figure 6.1.3.2-2: ATSSS rule
* * *
8 7 6 5 4 3 2 1  
Length of access selection descriptor octet s-3  
Steering functionality octet s-2  
Steering mode octet s-1  
Steering mode information octet s*
* * *
Figure 6.1.3.2-3: Access selection descriptor
Table 6.1.3.2-1: ATSSS parameter contents including an ATSSS rule
ATSSS rule ID (octet a+3) |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
The ATSSS rule ID specifies the identity of the individual ATSSS rule on which the ATSSS rule operation in octet a+4 is applied. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
ATSSS rule operation (octet a+4) |  |  |  |  |  |  |  |  |   
The ATSSS rule operation is encoded as follows: |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Add or replace ATSSS rule  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | Delete ATSSS rule  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If "Add or replace ATSSS rule" is indicated, the ATSSS rule with identity as indicated in ATSSS rule ID and contents as indicated in the following octets of the ATSSS rule parameter is added to the set of ATSSS rules. If an ATSSS rule with the same ATSSS rule ID does not exist in the set of ATSSS rules, a new rule is created and added. If an ATSSS rule with the same ATSSS rule ID exists in the set of ATSSS rules, the old rule is replaced with the new ATSSS rule. If "Delete ATSSS rule" is indicated, the ATSSS rule with identity as indicated in the ATSSS rule ID parameter is deleted from the set of ATSSS set of rules and octets a+5 and onwards of the ATSSS rule parameter are ignored. If no ATSSS rule with identity as indicated in the ATSSS rule ID parameter exists in the set of ATSSS rules, the Delete ATSSS rule operation is successful without changes to the set of ATSSS rules. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Precedence value of an ATSSS rule (octet a+5) |  |  |  |  |  |  |  |  |   
The precedence value of an ATSSS rule field shall be used to specify the precedence of the ATSSS rule among all ATSSS rules. This field shall include the binary encoded value of the precedence value in the range from 0 to 255 (decimal). The higher the value of the precedence value field, the lower the precedence of the ATSSS rule is. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
The traffic descriptor length field (octets a+6 to a+7) indicates length of the traffic descriptor field. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Traffic descriptor (octets a+8 to s-4) |  |  |  |  |  |  |  |  |   
The traffic descriptor field is, as defined in table 5.2.1 in 3GPP TS 24.526 [5], of variable size and contains a variable number (at least one) of traffic descriptor components (NOTE 3). Each traffic descriptor component shall be encoded as a sequence of one octet traffic descriptor component type identifier and a traffic descriptor component value field. The traffic descriptor component type identifier shall be transmitted first. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Traffic descriptor component type identifier Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Match-all type  
0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |  | OS Id + OS App Id type (NOTE 1)  
0 | 0 | 0 | 1 | 0 | 0 | 0 | 0 |  | IPv4 remote address type  
0 | 0 | 1 | 0 | 0 | 0 | 0 | 1 |  | IPv6 remote address/prefix length type  
0 | 0 | 1 | 1 | 0 | 0 | 0 | 0 |  | Protocol identifier/next header type  
0 | 1 | 0 | 1 | 0 | 0 | 0 | 0 |  | Single remote port type  
0 | 1 | 0 | 1 | 0 | 0 | 0 | 1 |  | Remote port range type  
0 | 1 | 0 | 1 | 0 | 0 | 1 | 0 |  | IP 3 tuple type  
0 | 1 | 1 | 0 | 0 | 0 | 0 | 0 |  | Security parameter index type  
0 | 1 | 1 | 1 | 0 | 0 | 0 | 0 |  | Type of service/traffic class type  
1 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |  | Flow label type  
1 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Destination MAC address type  
1 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | 802.1Q C-TAG VID type  
1 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | 802.1Q S-TAG VID type  
1 | 0 | 0 | 0 | 0 | 1 | 0 | 1 |  | 802.1Q C-TAG PCP/DEI type  
1 | 0 | 0 | 0 | 0 | 1 | 1 | 0 |  | 802.1Q S-TAG PCP/DEI type  
1 | 0 | 0 | 0 | 0 | 1 | 1 | 1 |  | Ethertype type  
1 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |  | DNN type  
1 | 0 | 0 | 1 | 0 | 0 | 0 | 1 |  | Destination FQDN  
1 | 0 | 0 | 1 | 0 | 0 | 1 | 0 |  | Regular expression  
1 | 0 | 1 | 0 | 0 | 0 | 0 | 0 |  | OS App Id type  
All other values are spare. If received they shall be interpreted as unknown. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Length of access selection descriptor (octet s-3) |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | If the steering mode is smallest delay  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | If the steering mode is not smallest delay  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Steering functionality (octet s-2) |  |  |  |  |  |  |  |  |   
The steering functionality field shall be encoded by one octet (octet s-2) as follows |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | UE's supported steering functionality (NOTE 2)  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | MPTCP functionality  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | ATSSS-LL functionality  
All other values are spare. If the UE does not support the received encoded steering functionality in the ATSSS rule, the UE shall ignore the ATSSS rule. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Steering mode (octet s-1) |  |  |  |  |  |  |  |  |   
The steering mode descriptor field shall be encoded by one octet (octet s-1) as follows: |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Active-standby  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | Smallest delay  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | Load balancing  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | Priority based  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Steering mode information (octet s) |  |  |  |  |  |  |  |  |   
If the steering mode is defined as active-standby, octet s shall be defined as follows: |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Active 3GPP and no standby  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | Active 3GPP and non-3GPP standby  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | Active non-3GPP and no standby  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | Active non-3GPP and 3GPP standby  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the steering mode is defined as smallest delay, octet s shall not be encoded. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the steering mode is defined as load balancing, octet s shall be encoded to show the percentage of the SDF traffic transmitted over 3GPP access and non-3GPP access as follows: |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | 100% over 3GPP and 0% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | 90% over 3GPP and 10% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | 80% over 3GPP and 20% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | 70% over 3GPP and 30% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 1 |  | 60% over 3GPP and 40% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 1 | 1 | 0 |  | 50% over 3GPP and 50% over non-3GPP  
0 | 0 | 0 | 0 | 0 | 1 | 1 | 1 |  | 40% over 3GPP and 60% over non-3GPP  
0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |  | 30% over 3GPP and 70% over non-3GPP  
0 | 0 | 0 | 0 | 1 | 0 | 0 | 1 |  | 20% over 3GPP and 80% over non-3GPP  
0 | 0 | 0 | 0 | 1 | 0 | 1 | 0 |  | 10% over 3GPP and 90% over non-3GPP  
0 | 0 | 0 | 0 | 1 | 0 | 1 | 1 |  | 0% over 3GPP and 100% over non-3GPP  
All other values are spare |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the steering mode is defined as priority-based, octet s shall be encoded as: |  |  |  |  |  |  |  |  |   
Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | 3GPP is high priority access  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | non-3GPP is high priority access  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
NOTE 1: For "OS Id + OS App Id type", the traffic descriptor component value field does not specify the OS version number or the version number of the application. |  |  |  |  |  |  |  |  |   
NOTE 2: This value shall be set by the SMF if the UE supports only one steering functionality. The SMF knows the UE's supported steering functionality during the MA PDU session establishment. |  |  |  |  |  |  |  |  |   
NOTE 3: Traffic descriptor components of an ATSSS rule are not required to be the same as the traffic descriptor components, defined in table 5.2.1 in 3GPP TS 24.526 [5]. |  |  |  |  |  |  |  |  |   
### 6.1.4 Network steering functionalities information
#### 6.1.4.1 Definition of network steering functionalities information
##### 6.1.4.1.1 MPTCP Functionality with any steering mode and the ATSSS-LL
functionality with only the active-standby steering mode
In order for the UE to support the MPTCP functionality, the UE shall support
the TCP extensions for multipath operation specified in IETF RFC 8684 [8].
When the UE indicates support for MPTCP functionality with any steering mode
and the ATSSS-LL functionality with only the active-standby steering mode and
the network accepts to enable these functionalities for an MA PDU session of
IP type in the UPF as specified in the clause 5.32.2 of 3GPP TS 23.501 [2],
then the network shall provide the following information to the UE:
a) two \"link-specific multipath\" IP addresses/prefixes used only by the
MPTCP functionality in the UE, one associated with the 3GPP access and another
associated with the non-3GPP access;
NOTE: It is possible that the network provides the \"link-specific multipath\"
IP addresses/prefix that is not routable via N6 (e.g. IPv6 link local
address).
b) the IP address, port number and the type of one or more MPTCP proxies in
the UPF; and
c) one or more ATSSS rules including an ATSSS rule for non-MPTCP traffic. The
ATSSS rule for non-MPTCP traffic shall be composed of a precedence with value
\"255\", a \"match-all type\" traffic descriptor, an \"ATSSS-LL
functionality\" steering functionality and an \"active-standby\" steering
mode.
In this release of the specification, the UPF shall support the Transport
Converter as specified in IETF RFC 8803 [9].
In this release of the specification, the UE shall support the client
extensions specified in IETF RFC 8803 [9], and only client-initiated multipath
connections via [a Transport Converter]{.underline} are supported.
The UE shall use the \"link-specific multipath\" addresses/prefixes to
establish subflows over non-3GPP access and over 3GPP access.
When the MA PDU session is Ethernet type, the network shall not enable the
MPTCP functionality with any steering mode and the ATSSS-LL functionality with
only the active-standby steering mode.
##### 6.1.4.1.2 ATSSS-LL Functionality with any steering mode
When the UE indicates ATSSS-LL capability with any steering mode and the
network accepts to enable this functionality for an MA PDU session of any
supported type, then the network shall enable ATSSS-LL functionality with any
steering mode in the UPF as specified in the clause 5.32.2 of 3GPP TS 23.501
[2] and provide one or more ATSSS rules to the UE.
In an ATSSS capable UE, the following ATSSS-LL requirements apply:
a) for an MA PDU session of Ethernet PDU session type, the ATSSS-LL
functionality with any steering mode is mandatory; and
b) for an MA PDU session of IPv4, IPv6, or IPv4v6 PDU session type, if the UE
does not support:
1) the MPTCP functionality with any steering mode and the ATSSS-LL
functionality with only the active-standby steering mode; and
2) the MPTCP functionality with any steering mode and the ATSSS-LL
functionality with any steering mode,
then ATSSS-LL functionality with any steering mode is mandatory.
##### 6.1.4.1.3 MPTCP functionality with any steering mode and the ATSSS-LL
functionality with any steering mode
In order for the UE to support the MPTCP functionality, the UE shall support
the TCP extensions for multipath operation specified in IETF RFC 8684[8].
When the UE indicates support for MPTCP functionality with any steering mode
and the ATSSS-LL functionality with any steering mode and the network accepts
to enable these functionalities for an MA PDU session of IP type in the UPF as
specified in the clause 5.32.2 of 3GPP TS 23.501 [2], then the network shall
provide the following information to the UE:
a) two \"link-specific multipath\" IP addresses/prefixes used only by the
MPTCP functionality in the UE, one associated with the 3GPP access and another
associated with the non-3GPP access;
b) the IP address, port number and the type of one or more MPTCP proxies in
the UPF; and
c) one or more ATSSS rules.
In this release of the specification, the UPF shall support the Transport
Converter as specified in IETF RFC 8803 [9].
In this release of the specification, the UE shall support the client
extensions specified in IETF RFC 8803 [9], and only client-initiated multipath
connections via [a Transport Converter]{.underline} are supported..
The UE shall use the \"link-specific multipath\" addresses/prefixes to
establish subflows over non-3GPP access and over 3GPP access.
When the MA PDU session is Ethernet type, the network shall not enable the
MPTCP functionality with any steering mode and the ATSSS-LL functionality with
any steering mode.
#### 6.1.4.2 Encoding of network steering functionalities information
The network steering functionalities information contains:
a) addressing information for the ATSSS capable UE supporting MPTCP
fiunctionality; and
b) addressing information and type for the MPTCP proxy;
and is encoded as shown in figure 6.1.4.2-1, figure 6.1.4.2-2 and table
6.1.4.2-1:
+-----------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | UE 3GPP IP address type | octet a+1 | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | UE 3GPP IP address | octet a+2 | | | | | | | | | | | | | | | | | | | | octet k-1 | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | UE non-3GPP IP address type | octet k | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | UE non-3GPP IP address | octet k+1 | | | | | | | | | | | | | | | | | | | | octet l-1 | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | Length of MPTCP proxy information | octet l | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | MPTCP proxy information value 1 | octet l+1 | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | octet m+2 | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | MPTCP proxy information value 2 | octet n | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | octet o | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | MPTCP proxy information value n | octet p | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+ | | octet s | | | | | | | | +-----------------------------------+-----------+---+---+---+---+---+---+---+
Figure 6.1.4.2-1: Network steering functionalities information including UE IP
addresses and MPTCP proxy information
+-----------------------------+-----------+ | MPTCP proxy IP address type | octet l+1 | +-----------------------------+-----------+ | MPTCP proxy IP address | octet l+2 | | | | | | octet m-1 | +-----------------------------+-----------+ | MPTCP proxy port | octet m | | | | | | octet m+1 | +-----------------------------+-----------+ | MPTCP proxy type | octet m+2 | +-----------------------------+-----------+
Figure 6.1.4.2-2: MPTCP proxy information
Table 6.1.4.2-1: UE IP addresses and MPTCP proxy information
UE 3GPP IP address type (octet a+1) is set as follows: Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IPv4  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | IPv6  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | IPv4v6  
|  |  |  |  |  |  |  |  |   
If the UE 3GPP IP address type indicates IPv4, then the UE 3GPP IP address field contains an IPv4 address in 4 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the UE 3GPP IP address type indicates IPv6, then the UE 3GPP IP address field contains an IPv6 address in 16 octets field and 1 octet prefix length field. The IPv6 address field shall be transmitted first. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the UE 3GPP IP address type indicates IPv4v6, then the UE 3GPP IP address field contains two IP addresses. The first UE 3GPP IP address is an IPv4 address in 4 octets and the second UE 3GPP IP address is an IPv6 address field in 16 octets followed by 1 octet prefix length field. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
UE non-3GPP IP address type (octet k) is set as follows: Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IPv4  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | IPv6  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | IPv4v6  
|  |  |  |  |  |  |  |  |   
If the UE non-3GPP IP address type indicates IPv4, then the UE non-3GPP IP address field contains an IPv4 address in 4 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the UE non-3GPP IP address type indicates IPv6, then the UE non-3GPP IP address field contains an IPv6 address in 16 octets field and 1 octet prefix length field. The IPv6 address field shall be transmitted first. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the UE non-3GPP IP address type indicates IPv4v6, then the UE non-3GPP IP address field contains two IP addresses. The first UE non-3GPP IP address is an IPv4 address in 4 octets and the second UE non-3GPP IP address is an IPv6 address field in 16 octets followed by 1 octet prefix length field. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
MPTCP proxy IP address type (octet l+1) is set as follows: Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IPv4  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | IPv6  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | IPv4v6  
|  |  |  |  |  |  |  |  |   
If the MPTCP proxy IP address type indicates IPv4, then the MPTCP proxy IP address field contains an IPv4 address in 4 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the MPTCP proxy IP address type indicates IPv6, then the MPTCP proxy IP address field contains an IPv6 address in 16 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the MPTCP proxy IP address type indicates IPv4v6, then the MPTCP proxy IP address field contains two IP addresses. The first MPTCP proxy IP address is an IPv4 address in 4 octets and the second MPTCP proxy IP address is an IPv6 address in 16 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
MPTCP proxy type (octet m+2) is set as follows: Bits |  |  |  |  |  |  |  |  |   
**8** | **7** | **6** | **5** | **4** | **3** | **2** | **1** |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Transport converter  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
### 6.1.5 Measurement assistance information
#### 6.1.5.1 Definition of measurement assistance information
The measurement assistance information is transmitted by the network to the
UE.
If the UE is only capable of supporting MPTCP functionality with any steering
mode and the ATSSS-LL functionality with only the active-standby steering
mode, the network may send measurement assistance information for the UE to
send access availability/unavailability to the UPF. In this case, the UE and
UPF shall not perform RTT measurements using PMF, the UE and UPF shall use the
RTT measurements available at the MPTCP layer.
The measurement assistance information is defined in 3GPP TS 23.501 [2] and it
contains:
a) addressing for the PMF in the UPF according to:
1) if the PDU session is IP type, the measurement assistance information
contains IP address for the PMF with an allocated port number associated with
the 3GPP access network and another allocated port number associated with
non-3GPP access network; and
2) if the PDU session is Ethernet type, the measurement assistance information
contains a MAC address associated with the 3GPP access network and another MAC
address associated with the non-3GPP address network for the PMF; and
b) an indicator to report the availability and unavailability of an access
network.
#### 6.1.5.2 Encoding of measurement assistance information
The measurement assistance information contains addressing information for the
PMF in the UPF and is encoded as shown in figure 6.1.5.2-1 and figure
6.1.5.2-2 and table 6.1.5.2-1 and table 6.1.5.2-2.
+---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | PMF IP address type | octet a+1 | | | | | | | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | PMF IP address | octet a+2 | | | | | | | | | | | | | | | | | | | | octet b-5 | | | | | | | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | PMF 3GPP port | octet b-4 | | | | | | | | | | | | | | | | | | | | octet b-3 | | | | | | | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | PMF non-3GPP port | octet b-2 | | | | | | | | | | | | | | | | | | | | octet b-1 | | | | | | | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | AARI | octet b | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | | +---------------------+-----------+-------+-------+-------+-------+-------+------+---------+
Figure 6.1.5.2-1: ATSSS parameter contents including one PMF IP address
information
Table 6.1.5.2-1: PMF IP address type
PMF IP address type (octet a+1) is set as follows: Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IPv4  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | IPv6  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | IPv4IPv6  
All other values are spare. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the PMF IP address type indicates IPv4, then the PMF IP address field contains an IPv4 address in 4 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the PMF IP address type indicates IPv6, then the PMF IP address field contains an IPv6 address in 16 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
If the PMF IP address type indicates IPv4IPv6, then the PMF IP address field contains two IP addresses. The first PMF IP address is an IPv4 address in 4 octets and the second PMF IP address is an IPv6 address in 16 octets. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
PMF 3GPP port (octets b-4 â€“ b-3) is allocated port number associated with the 3GPP access network. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
PMF non-3GPP port (octets b-2 â€“ b-1) is allocated port number associated with the non-3GPP access network. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
AARI (access availability reporting indicator) (octet b, bit 1) is set as follows: Bit |  |  |  |  |  |  |  |  |   
**1** |  |  |  |  |  |  |  |  |   
0 | Do not report the access availability |  |  |  |  |  |  |  |   
1 | Report the access availability |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
+-------+-------+-------+-------+-------+-------+-------+------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | PMF | octet | | | | | | | | | 3GPP | a+1 | | | | | | | | | MAC | | | | | | | | | | ad | octet | | | | | | | | | dress | a+6 | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | PMF | octet | | | | | | | | | non | a+7 | | | | | | | | | -3GPP | | | | | | | | | | MAC | octet | | | | | | | | | ad | a+12 | | | | | | | | | dress | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | AARI | octet | | | | | | | | | | a+13 | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | | +-------+-------+-------+-------+-------+-------+-------+------+-------+
Figure 6.1.5.2-2: ATSSS parameter contents including one PMF MAC address
information
Table 6.1.5.2-2: PMF MAC address type
+----------------------------------+----------------------------------+ | PMF 3GPP MAC address contains a | | | 6 octets MAC address associated | | | with the 3GPP access network. | | +==================================+==================================+ | | | +----------------------------------+----------------------------------+ | PMF non-3GPP MAC address | | | contains a 6 octets MAC address | | | associated with the non-3GPP | | | access network. | | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+ | AARI (access availability | | | reporting indicator) (octet | | | a+13, bit 1) is set as follows: | | | | | | Bit | | +----------------------------------+----------------------------------+ | **1** | | +----------------------------------+----------------------------------+ | 0 | Do not report the access | | | availability | +----------------------------------+----------------------------------+ | 1 | Report the access availability | +----------------------------------+----------------------------------+ | | | +----------------------------------+----------------------------------+
### 6.1.6 ATSSS PCO parameters
#### 6.1.6.1 General
Clause 6.1.6 specifies PCO parameters used for ATSSS.
#### 6.1.6.2 ATSSS request PCO parameter
The purpose of the ATSSS request PCO parameter is to provide UE parameters for
MA PDU session management.
The ATSSS request PCO parameter container contents are coded as shown in
figure 6.1.6.2-1 and table 6.1.6.2-1.
The ATSSS request PCO parameter container contents may be one or more octets
long. If the ATSSS request PCO parameter container contents is longer than one
octet, octets other than the first octet shall be ignored.
+-------+-------+-------+-------+----------+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+----------+---------+---+---+---+ | 0 | 0 | 0 | 0 | ATSSS-ST | octet 1 | | | | | | | | | | | | | | | Spare | Spare | Spare | Spare | | | | | | +-------+-------+-------+-------+----------+---------+---+---+---+
Figure 6.1.6.2-1: ATSSS request PCO parameter container contents
Table 6.1.6.2-1: ATSSS request PCO parameter container contents
* * *
Supported ATSSS steering functionalities and steering modes (ATSSS-ST) (octet
1, bits 1, 2, 3 and 4) (see NOTE)  
This field indicates the 5GSM capability of ATSSS steering functionalities and
steering modes.  
Bits  
**4** **3** **2** **1**  
0 0 0 1 ATSSS Low-Layer functionality with any steering mode supported 0 0 1 0
MPTCP functionality with any steering mode and ATSSS-LL functionality with
only active-standby steering mode supported 0 0 1 1 MPTCP functionality with
any steering mode and ATSSS-LL functionality with any steering mode supported
All other values are reserved.
All other bits in octet 1 are spare and shall be coded as zero.
NOTE: If the ATSSS request PCO parameter is included in the PDN CONNECTIVITY
REQUEST message with the request type information element set to \"handover\",
the ATSSS-ST field is ignored.
* * *
#### 6.1.6.3 ATSSS response with the length of two octets PCO parameter
The purpose of the ATSSS response with the length of two octets PCO parameter
is to provide network parameters for MA PDU session management.
The ATSSS response with the length of two octets PCO parameter container
contents are coded as shown in figure 6.1.6.3-1 and table 6.1.6.3-1.
The ATSSS response with the length of two octets PCO parameter container
contents may be one or more octets long. If the ATSSS response with the length
of two octets PCO parameter container contents is longer than as indicated in
the figure 6.1.6.3-1, the octets after the last field of the figure 6.1.6.3-1
shall be ignored.
+-------+-------+-------+-------+-------+-------+------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | MAII | NSFII | octet | | | | | | | | | | 1 | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+------+-------+-------+ | Ne | octet | | | | | | | | | twork | 2* | | | | | | | | | ste | | | | | | | | | | ering | octet | | | | | | | | | funct | 3* | | | | | | | | | ional | | | | | | | | | | ities | | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | l | | | | | | | | | | ength | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+-------+-------+ | Ne | octet | | | | | | | | | twork | 4* | | | | | | | | | ste | | | | | | | | | | ering | octet | | | | | | | | | funct | n* | | | | | | | | | ional | | | | | | | | | | ities | | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+-------+-------+ | M | octet | | | | | | | | | easur | n+1* | | | | | | | | | ement | | | | | | | | | | assis | octet | | | | | | | | | tance | n+2* | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | | l | | | | | | | | | | ength | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+-------+-------+ | M | octet | | | | | | | | | easur | n+3* | | | | | | | | | ement | | | | | | | | | | assis | octet | | | | | | | | | tance | m* | | | | | | | | | i | | | | | | | | | | nform | | | | | | | | | | ation | | | | | | | | | +-------+-------+-------+-------+-------+-------+------+-------+-------+
Figure 6.1.6.3-1: ATSSS response with the length of two octets PCO parameter
container contents
Table 6.1.6.3-1: ATSSS response with the length of two octets PCO parameter
container contents
* * *
Network steering functionalities information indicator (NSFII) (octet 1, bit
1)  
This bit indicates whether the network steering functionalities information
length field and the network steering functionalities information are
included.  
Bit  
**1**  
0 Network steering functionalities information length field and network
steering functionalities information field not included. 1 Network steering
functionalities information length field and network steering functionalities
information field included.
Measurement assistance information indicator (MAII) (octet 1, bit 2)  
This bit indicates whether the measurement assistance information length field
and the measurement assistance information field are included.  
Bit  
**2**  
0 Measurement assistance information length field and the measurement
assistance information field not included. 1 Measurement assistance
information length field and the measurement assistance information field
included.
All other bits in octet 1 are spare and shall be coded as zero.
The network steering functionalities information length field indicates length
of the network steering functionalities information field.
The network steering functionalities information field is coded as specified
in figure 6.1.4.2-1, figure 6.1.4.2-2 and table 6.1.4.2-1.
The measurement assistance information length field indicates length of the
measurement assistance information field.
The measurement assistance information field is coded as specified in figure
6.1.5.2-1 and table 6.1.5.2-1.
* * *
## 6.2 Encoding of performance measurement function (PMF) protocol (PMFP)
### 6.2.1 Message functional definitions and format
#### 6.2.1.1 General
The following PMFP messages are specified:
\- PMFP echo request;
\- PMFP echo response;
\- PMFP access report; and
\- PMFP acknowledgement.
#### 6.2.1.2 PMFP echo request
##### 6.2.1.2.1 Message definition
The PMFP ECHO REQUEST message is sent by the UE to the UPF or by the UPF to
the UE to initiate detection of RTT.
See table 6.2.1.2.1-1.
Message type: PMFP ECHO REQUEST
Significance: dual
Direction: UE to UPF or UPF to UE
Table 6.2.1.2.1-1: PMFP ECHO REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | PMFP echo | Message | M | V | 1 | | | request | type | | | | | | message | | | | | | | identity | 6.2.2.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EPTI | Extended | M | V | 2 | | | | procedure | | | | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 6.2.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | RI | Request | M | V | 1 | | | | identity | | | | | | | | | | | | | | 6.2.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 70 | Padding | Padding | O | TLV-E | 3-1000 | | | | | | | | | | | 6.2.2.6 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 6.2.1.3 PMFP echo response
##### 6.2.1.3.1 Message definition
The PMFP ECHO RESPONSE message is sent by the UPF to the UE or by the UE to
the UPF as response to an PMFP ECHO RESPONSE message to enable detection of
RTT.
See table 6.2.1.3.1-1.
Message type: PMFP ECHO RESPONSE
Significance: dual
Direction: UE to UPF or UPF to UE
Table 6.2.1.3.1-1: PMFP ECHO RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | PMFP echo | Message | M | V | 1 | | | response | type | | | | | | message | | | | | | | identity | 6.2.2.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EPTI | Extended | M | V | 2 | | | | procedure | | | | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 6.2.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | RI | Request | M | V | 1 | | | | identity | | | | | | | | | | | | | | 6.2.2.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | 70 | Padding | Padding | O | TLV-E | 3-1000 | | | | | | | | | | | 6.2.2.6 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 6.2.1.4 PMFP access report
##### 6.2.1.4.1 Message definition
The PMFP ACCESS REPORT message is sent by the UE to the UPF to inform the UPF
about access availability or unavailability.
See table 6.2.1.4.1-1.
Message type: PMFP ACCESS REPORT
Significance: dual
Direction: UE to UPF
Table 6.2.1.4.1-1: PMFP ACCESS REPORT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | PMFP access | Message | M | V | 1 | | | report | type | | | | | | message | | | | | | | identity | 6.2.2.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | EPTI | Extended | M | V | 2 | | | | procedure | | | | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 6.2.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Access | Access | M | V | 1/2 | | | a | a | | | | | | vailability | vailability | | | | | | state | state | | | | | | | | | | | | | | 6.2.2.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Spare half | Spare half | M | V | 1/2 | | | octet | octet | | | | | | | | | | | | | | 6.2.2.4 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 6.2.1.5 PMFP acknowledgement
##### 6.2.1.5.1 Message definition
The PMFP ACKNOWLEDGEMENT message is sent by the UPF to the UE to acknowledge
reception of a PMFP ACCESS REPORT message.
See table 6.2.1.5.1-1.
Message type: PMFP ACKNOWLEDGEMENT
Significance: dual
Direction: UPF to UE
Table 6.2.1.5.1-1: PMFP ACKNOWLEDGEMENT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +=====+=============+=============+==========+========+========+ | | PMFP | Message | M | V | 1 | | | ackn | type | | | | | | owledgement | | | | | | | message | 6.2.2.1 | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | EPTI | Extended | M | V | 2 | | | | procedure | | | | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | 6.2.2.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 6.2.2 Encoding of information element
#### 6.2.2.1 Message type
Message type is a type 3 information element with length of 1 octet.
Table 6.2.2.1-1 defines the value part of the message type IE used in the
PMFP.
Table 6.2.2.1-1: Message type
* * *
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 1 PMFP ECHO REQUEST message 0 0 0 0 0 0 1 0 PMFP ECHO RESPONSE
message 0 0 0 0 0 0 1 1 PMFP ACCESS REPORT message 0 0 0 0 0 1 0 0 PMFP
ACKNOWLEDGEMENT message
All other values are reserved
* * *
#### 6.2.2.2 Extended procedure transaction identity
The purpose of the extended procedure transaction identity information element
is to enable distinguishing up to 10000H different bi-directional message
flows. Such a message flow is called a transaction.
Extended procedure transaction identity is a type 3 information element with
length of 2 octet.
The extended procedure transaction identity information element is coded as
shown in figure 6.2.2.2-1.
+------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------+---------+---+---+---+---+---+---+---+ | EPTI | octet 1 | | | | | | | | | | | | | | | | | | | | octet 2 | | | | | | | | +------+---------+---+---+---+---+---+---+---+
Figure 6.2.2.2-1: Extended procedure transaction identity information element
Table 6.2.2.2-1: Extended procedure transaction identity information element
+----------------------------------------------------------------------+ | EPTI (octet 1 to octet 4) | | | | Binary encoded EPTI value. | | | | EPTI values between 0000H and 7FFFH indicate a UE-initiated | | transaction. EPTI values between 8000H and FFFFH indicate a | | UPF-initiated transaction. | +----------------------------------------------------------------------+
#### 6.2.2.3 Access availability state
The purpose of the access availability state information element is to provide
information about availability of access.
The access availability state is a type 1 information element.
The access availability state information element is coded as shown in figure
6.2.2.3-1 and table 6.2.2.3-1.
+-------------------------------+-------+-------+------+-----+---------+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------+-------+-------+------+-----+---------+---+---+---+ | Access availability state IEI | 0 | 0 | AN3A | A3A | octet 1 | | | | | | | | | | | | | | | | spare | spare | | | | | | | +-------------------------------+-------+-------+------+-----+---------+---+---+---+
Figure 6.2.2.3-1: Access availability state information element
Table 6.2.2.3-1: Access availability state information element
* * *
Availability over 3GPP access (A3A) (octet 1, bit 1)  
Bit  
1  
0 3GPP access not available 1 3GPP access available
Availability over non-3GPP access (AN3A) (octet 1, bit 2)  
Bit  
2  
0 non-3GPP access not available 1 non-3GPP access available
* * *
#### 6.2.2.4 Spare half octet
This information element is used in the description of messages when an odd
number of half octet type 1 information elements are used. This element is
filled with spare bits set to zero and is placed in bits 5 to 8 of the octet
unless otherwise specified.
#### 6.2.2.5 Request identity
The purpose of the Request identity information element is to enable
association of a PMF ECHO RESPONSE message with one of PMF ECHO REQUEST
messages sent within one RTT measurement procedure.
The Request identity is a type 3 information element with length of 1 octet.
The Request identity information element is coded as shown in figure 6.2.2.5-1
and table 6.2.2.5-1.
* * *
8 7 6 5 4 3 2 1  
Request identity value octet 1
* * *
Figure 6.2.2.5-1: Request identity information element
Table 6.2.2.5-1: Request identity information element
* * *
Request identity value (octet 1)  
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 0 \ to } Request identity value  
1 1 1 1 1 1 1 1 /
* * *
#### 6.2.2.6 Padding
The purpose of the Padding information element is to extend the PMFP message
to length requested by upper layers.
The Padding information information element is coded as shown in figure
6.2.2.6-1.
The Padding information is a type 6 information element with a minimum length
of 3 octets.
+----------------+---------+-------+-------+-------+-------+-------+-------+----------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------+---------+-------+-------+-------+-------+-------+-------+----------+ | Padding IEI | octet 1 | | | | | | | | +----------------+---------+-------+-------+-------+-------+-------+-------+----------+ | Padding length | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------+---------+-------+-------+-------+-------+-------+-------+----------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octets 3 | | | | | | | | | | | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | Spare | octet n | +----------------+---------+-------+-------+-------+-------+-------+-------+----------+
Figure 6.2.2.6-1: Padding information element
## 6.3 Encoding of 3GPP IEEE MAC based protocol family
Ethertype of the 3GPP IEEE MAC based protocol family is XYZ.
Editor\'s note: ethertype of the 3GPP IEEE MAC based protocol family will be
assigned by IEEE.
The MAC client data field of a MAC frame as specified in IEEE 802.3 [12] with
the length/type field set to the ethertype of the 3GPP IEEE MAC based protocol
family contains a 3GPP IEEE MAC based protocol family envelope. The 3GPP IEEE
MAC based protocol family envelope is encoded as shown in figure 6.3-1 and
table 6.3-1.
+------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------+---------+---+---+---+---+---+---+---+ | Protocol subtype | octet 1 | | | | | | | | +------------------+---------+---+---+---+---+---+---+---+ | Protocol data | octet 2 | | | | | | | | | | | | | | | | | | | | octet x | | | | | | | | +------------------+---------+---+---+---+---+---+---+---+
Figure 6.3-1: 3GPP IEEE MAC based protocol family envelope
Table 6.3-1: 3GPP IEEE MAC based protocol family envelope
Protocol subtype (octet 1) The protocol subtype field identifies protocol of the protocol data field. |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
Bits |  |  |  |  |  |  |  |  |   
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | Performance measurement function protocol (PMFP).  
All other values are reserved. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
Protocol data (octets 2 to x) If the protocol subtype field is set to "Performance measurement function protocol (PMFP)", the protocol data field shall be encoded as a sequence of a two octets PMFP message length field and a PMFP message field. The PMFP message length field shall indicate the length in octets of the PMFP message field. The PMFP message field shall contain a PMFP message as specified in clause 6.2.1. |  |  |  |  |  |  |  |  |   
|  |  |  |  |  |  |  |  |   
NOTE: A sending entity shall not set the protocol subtype field to a reserved value. A receiving entity shall ignore a 3GPP IEEE MAC based protocol family envelope if the protocol subtype field is set to a reserved value. |  |  |  |  |  |  |  |  |   
# 7 List of system parameters
## 7.1 General
The description of timers in the tables of clause 7 should be considered a
brief summary. The precise details are found in clause 5, which should be
considered the definitive descriptions.
## 7.2 Timers of performance measurement function (PMF) protocol (PMFP)
Timers of PMFP are shown in table 7.2-1 and table 7.2-2.
Table 7.2-1: Timers of PMFP -- UE side
+-------------+-------------+-------------+-------------+-------------+ | TIMER NUM. | TIMER VALUE | CAUSE OF | NORMAL STOP | ON | | | | START | | | | | | | | THE | | | | | | | | | | | | 1^st^, | | | | | | 2^nd^, | | | | | | 3^rd^, | | | | | | 4^th^ | | | | | | EXPIRY | | | | | | (NOTE 1) | +-------------+-------------+-------------+-------------+-------------+ | T101 | 1s | T | A PMFP ECHO | Abort of | | | | ransmission | RESPONSE | the | | | | of the | message | procedure. | | | | first PMFP | received | | | | | ECHO | for each | | | | | REQUEST | sent PMFP | | | | | message | ECHO | | | | | | REQUEST | | | | | | message | | +-------------+-------------+-------------+-------------+-------------+ | T102 | NOTE 2 | T | PMFP | Ret | | | | ransmission | ACKN | ransmission | | | | of PMFP | OWLEDGEMENT | of PMFP | | | | ACCESS | message | ACCESS | | | | REPORT | with the | REPORT | | | | message | same EPTI | message | | | | | is received | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Typically, | | | | | | the | | | | | | procedures | | | | | | are aborted | | | | | | on the | | | | | | fifth | | | | | | expiry of | | | | | | the | | | | | | relevant | | | | | | timer. | | | | | | Exceptions | | | | | | are | | | | | | described | | | | | | in the | | | | | | co | | | | | | rresponding | | | | | | procedure | | | | | | d | | | | | | escription. | | | | | | | | | | | | NOTE 2: | | | | | | Initial | | | | | | timer value | | | | | | is 500 | | | | | | mi | | | | | | lliseconds. | | | | | | The timer | | | | | | value | | | | | | doubles | | | | | | after each | | | | | | timer | | | | | | expiry, | | | | | | until set | | | | | | to 4 | | | | | | seconds. | | | | | +-------------+-------------+-------------+-------------+-------------+
Table 7.2-2: Timers of PMFP -- UPF side
+-------------+-------------+-------------+-------------+-------------+ | TIMER NUM. | TIMER VALUE | CAUSE OF | NORMAL STOP | ON | | | | START | | | | | | | | THE | | | | | | | | | | | | 1^st^, | | | | | | 2^nd^, | | | | | | 3^rd^, | | | | | | 4^th^ | | | | | | EXPIRY | | | | | | (NOTE 1) | +-------------+-------------+-------------+-------------+-------------+ | T201 | NOTE 2 | T | A PMFP ECHO | Abort of | | | | ransmission | RESPONSE | the | | | | of the | message | procedure. | | | | first PMFP | received | | | | | ECHO | for each | | | | | REQUEST | sent PMFP | | | | | message | ECHO | | | | | | REQUEST | | | | | | message | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Typically, | | | | | | the | | | | | | procedures | | | | | | are aborted | | | | | | on the | | | | | | fifth | | | | | | expiry of | | | | | | the | | | | | | relevant | | | | | | timer. | | | | | | Exceptions | | | | | | are | | | | | | described | | | | | | in the | | | | | | co | | | | | | rresponding | | | | | | procedure | | | | | | d | | | | | | escription. | | | | | | | | | | | | NOTE 2: The | | | | | | value of | | | | | | this timer | | | | | | is network | | | | | | dependent. | | | | | +-------------+-------------+-------------+-------------+-------------+
# 8 Handling of unknown, unforeseen, and erroneous PMFP data
## 8.1 General
The procedures specified in the clause apply to those messages which pass the
checks described in this clause.
This clause also specifies procedures for the handling of unknown, unforeseen,
and erroneous PMFP data by the receiving entity. These procedures are called
\"error handling procedures\", but in addition to providing recovery
mechanisms for error situations they define a compatibility mechanism for
future extensions of the PMFP.
Clauses 8.1 to 8.8 shall be applied in order of precedence.
Detailed error handling procedures in the network are implementation dependent
and may vary from PLMN to PLMN. However, when extensions of PMFP are
developed, networks are assumed to have the error handling which is indicated
in this clause as mandatory (\"shall\") and that is indicated as strongly
recommended (\"should\").
Also, the error handling of the network is only considered as mandatory or
strongly recommended when certain thresholds for errors are not reached during
a dedicated connection.
For definition of semantical and syntactical errors see 3GPP TS 24.007 [13],
clause 11.4.2.
## 8.2 Message too short or too long
### 8.2.1 Message too short
When a message is received that is too short to contain a complete message
type information element, that message shall be ignored, c.f. 3GPP TS 24.007
[13].
### 8.2.2 Message too long
The maximum size of a PMFP message is 65535 octets.
## 8.3 Unknown or unforeseen extended procedure transaction identity (EPTI)
### 8.3.1 Extended procedure transaction identity (EPTI)
The following network procedures shall apply for handling an unknown,
erroneous, or unforeseen EPTI received in a PMFP message:
a) In case the network receives a PMFP ECHO RESPONSE message in which the EPTI
value does not match any EPTI in use, the network shall ignore the PMFP
message.
The following UE procedures shall apply for handling an unknown, erroneous, or
unforeseen EPTI received in a PMFP message:
a) In case the UE receives a PMFP ECHO RESPONSE message or a PMFP
ACKNOWLEDGEMENT message in which the EPTI value does not match any EPTI in
use, the UE shall ignore the PMFP message.
## 8.4 Unknown or unforeseen message type
If the UE or the network receives a PMFP message with message type not defined
for the PMFP or not implemented by the receiver, it shall ignore the PMFP
message.
NOTE: A message type not defined for the PMFP in the given direction is
regarded by the receiver as a message type not defined for the PMFP, see 3GPP
TS 24.007 [13].
If the UE receives a message not compatible with the PMFP state, the UE shall
ignore the PMFP message.
If the network receives a message not compatible with the PMFP state, the
network actions are implementation dependent.
## 8.5 Non-semantical mandatory information element errors
### 8.5.1 Common procedures
When on receipt of a message,
a) an \"imperative message part\" error; or
b) a \"missing mandatory IE\" error;
is diagnosed or when a message containing:
a) a syntactically incorrect mandatory IE;
b) an IE unknown in the message, but encoded as \"comprehension required\"
(see 3GPP TS 24.007 [13]); or
c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS
24.007 [13]) is received;
the UE shall ignore the PMFP message and the network shall:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message.
## 8.6 Unknown and unforeseen IEs in the non-imperative message part
### 8.6.1 IEIs unknown in the message
The UE shall ignore all IEs unknown in a message which are not encoded as
\"comprehension required\" (see 3GPP TS 24.007 [13]).
The network shall take the same approach.
### 8.6.2 Out of sequence IEs
The UE shall ignore all out of sequence IEs in a message which are not encoded
as \"comprehension required\" (see 3GPP TS 24.007 [13]).
The network should take the same approach.
### 8.6.3 Repeated IEs
If an information element with format T, TV, TLV, or TLV-E is repeated in a
message in which repetition of the information element is not specified in
clause 6.2.1, the UE shall handle only the contents of the information element
appearing first and shall ignore all subsequent repetitions of the information
element. When repetition of information elements is specified, the UE shall
handle only the contents of specified repeated information elements. If the
limit on repetition of information elements is exceeded, the UE shall handle
the contents of information elements appearing first up to the limit of
repetitions and shall ignore all subsequent repetitions of the information
element.
The network should follow the same procedures.
## 8.7 Non-imperative message part errors
### 8.7.1 General
This category includes:
a) syntactically incorrect optional IEs; and
b) conditional IE errors.
### 8.7.2 Syntactically incorrect optional IEs
The UE shall treat all optional IEs that are syntactically incorrect in a
message as not present in the message.
The network shall take the same approach.
### 8.7.3 Conditional IE errors
NOTE: In this release of specification, there are no conditional IEs.
When upon receipt of a PMFP message the UE diagnoses a \"missing conditional
IE\" error or an \"unexpected conditional IE\" error, or when it receives a
PMFP message containing at least one syntactically incorrect conditional IE,
the UE shall ignore the message.
When the network receives a message and diagnoses a \"missing conditional IE\"
error or an \"unexpected conditional IE\" error or when it receives a message
containing at least one syntactically incorrect conditional IE, the network
shall either:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message.
## 8.8 Messages with semantically incorrect contents
When a message with semantically incorrect contents is received, the UE shall
perform the foreseen reactions of the procedural part of clause 5.4. If,
however no such reactions are specified, the UE shall ignore the message.
The network should follow the same procedure.
###### ## Annex A (informative): Registration templates
# A.1 IEEE registration templates
## A.1.1 IEEE registration templates for ethertype values
### A.1.1.1 IEEE registration templates for ethertype value for 3GPP IEEE MAC
based protocol family
Editor\'s note: MCC is requested to apply in IEEE-RA for allocation of an
ethertype value according to this template.
Registration URL:
http://standards.ieee.org/develop/regauth/ethertype/index.html
Registry:
ethertype
Detailed description:
This application requests allocation of an ethertype value for 3GPP IEEE MAC
based protocol family, as specified in IEEE 802 [11].
Protocol description:
The MAC client data field of a MAC frame as specified in IEEE 802.3 [12] of
the 3GPP IEEE MAC based protocol family is formatted as follows:
\- octet 1 of the MAC client data field is the protocol subtype field.
\- remaining octets of the MAC client data field are the protocol data field.
The protocol subtype field set to one identifies the performance measurement
function protocol specified in 3GPP TS 24.193.
3GPP TS 24.193 enables assignment of further protocols to values of the
protocol subtype field.
Assignment quantity:
1
Additional comments:
1) Does the company requesting the assignment have any existing Ethertype
assignments?
Yes.
1a) Does the existing use of the original assignment support sub-typing?
No.
1b) Does the current applicant know who is currently responsible for
maintenance of the previously assigned Ethertype?
Yes.
1c) Has the company considered using sub-typing of the older Ethertype for the
new use under application?
Yes. Sub-typing of the older Ethertype for the new use under application is
not possible.
1d) Given the above, why is a new Ethertype needed?
See detailed description for the new use under application.
2) Has the new protocol been developed and tested in accordance with clause 9
and especially clause 9.2.3 and Figure 12 of IEEE Std 802-2014 [11], IEEE
Standard for Local and Metropolitan Area Networks: Overview and Architecture?
The 3GPP IEEE MAC based protocol family has been developed as follows:
\- the first octet of the MAC client data field of a MAC frame as specified in
IEEE 802.3 [12] of the 3GPP IEEE MAC based protocol family contains the
protocol subtype field.
\- the MAC client data field of the MAC frame of the 3GPP IEEE MAC based
protocol family does not contain a protocol version field. If a protocol
identified by an existing protocol subtype field value is modified in a
backward-compatible way, there is no need to indicate a protocol version. If a
protocol identified by an existing protocol subtype field value needs to be
modified in a backward-incompatible way, a new protocol subtype field value
will be assigned to the modified protocol.
The 3GPP IEEE MAC based protocol family has not been tested.
3) Have the full provisions of Figure 12 for the \"Protocol identification
field\" in the prototype protocol been preserved in the final version of the
protocol for which the new EtherType is being requested?
The first octet of the MAC client data field of a MAC frame as specified in
IEEE 802.3 [12] of the 3GPP IEEE MAC based protocol family contains the
protocol subtype field.
The MAC client data field of the MAC frame of the 3GPP IEEE MAC based protocol
family does not contain a protocol version field. If a protocol identified by
an existing protocol subtype field value is modified in a backward-compatible
way, there is no need to indicate a protocol version. If a protocol identified
by an existing protocol subtype field value needs to be modified in a
backward-incompatible way, a new protocol subtype field value will be assigned
to the modified protocol.
This is preserved in the final version.
4) What provisions have been made for maintaining and assigning sub-types
going forward within your company? Please provide an example of the first 10
bytes/octets as an example.
3GPP TS 24.193 enables assignment of protocols to values of the protocol
subtype field. A sending entity shall not set the protocol subtype field to a
reserved value. A receiving entity shall ignore the MAC client data field, if
the protocol subtype field is set to a reserved value. 3GPP TS 24.193 so far
contains an assignment for the performance measurement function to value one
of the protocol subtype field.
For the performance measurement function protocol:
\- value of octet 1 of the MAC client data field is set to one.
\- values of octet 2 and octet 3 of the MAC client data field contain the
length of the performance measurement function protocol message.
\- value of octet 4 of the MAC client data field is set to the message type of
the performance measurement function protocol.
\- value of octet 5 and octet 6 of the MAC client data field is set to the
extended procedure transaction identity of the performance measurement
function protocol, enabling distinguishing of procedures running in parallel.
\- values of octet 7 and later octets of the MAC client data field depend on
the message type of the performance measurement function protocol.
#