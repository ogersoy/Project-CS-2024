# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the operations and information coding for the
Non-Access Stratum (NAS) layer protocol for supporting the Location Services
(LCS) in the NG-RAN.
The present document is applicable to the User Equipment (UE) and to the
Access and Mobility Management Function (AMF) or Location Management Function
(LMF) in the 5G System (5GS).
The present document is developed in accordance to the general principles
stated in 3GPP TS 23.273 [2].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".
[3] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[4] 3GPP TS 36.355: \"Evolved Universal Terrestrial Radio Access (E-UTRA); LTE
Positioning Protocol (LPP)\".
[5] 3GPP TS 24.080: \"Mobile radio interface layer 3 supplementary services
specification; Formats and coding\".
[6] 3GPP TS 29.572: \"5G System; Location Management Services; Stage 3\".
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
## 3.2 Symbols
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
5GCN 5G Core Network
5GS 5G System
AMF Access and Mobility Management Function
DL Downlink
IE Information Element
GMLC Gateway Mobile Location Centre
LCS Location Services
LDR Location Deferred Request
LMF Location Management Function
LPP LTE Positioning Protocol
MO-LR Mobile Originated Location Request
MT-LR Mobile Terminated Location Request
NAS Non-access Stratum
UE User Equipment
UL Uplink
# 4 General
## 4.1 Overview
### 4.1.1 NAS aspect
To enable transfer of Location Services (LCS) signaling messages between the
5G core network (5GCN) and the UE, two Payload container types are defined in
the downlink (DL NAS TRANSPORT message) and the uplink (UL NAS TRANSPORT
message). The message protocol and procedures are described in 3GPP TS 24.501
[3].
### 4.1.2 LCS aspect
LCS uses the defined payload container to transfer LCS signalling messages
between the UE and the network.
The corresponding LCS signaling messages include:
a) LTE Positioning Protocol (LPP) messages (see 3GPP TS 36.355 [4])
\- Both downlink and uplink LPP messages are supported
\- Routing information is transported as the Additional information IE in
UL/DL NAS TRANSPORT message for LPP messages (see 3GPP TS 24.501 [3])
b) Location services messages
\- Messages for MO-LR operations (see 3GPP TS 24.080 [5])
\- Messages for LocationNotification operations (see 3GPP TS 24.080 [5])
\- Messages for EventReport operations (see 3GPP TS 24.080 [5])
\- Messages for PeriodicTriggeredInvoke operations (see 3GPP TS 24.080 [5])
\- Messages for CancelDeferredLocation operations (see 3GPP TS 24.080 [5])
\- Messages for MSCancelDeferredLocation operations (see 3GPP TS 24.080 [5])
\- Messages for LocationPrivacySetting operations (see 3GPP TS 24.080 [5])
Routing information associated with the LMF is transported as the Additional
information IE in UL/DL NAS TRANSPORT message for Location services messages
that are transported from/to the LMF (see 3GPP TS 24.501 [3])
## 4.2 LCS Support capabilities
### 4.2.1 UE support of LCS
The UE announces to the network its ability to support LCS notification
mechanism or LPP messages or both, using the 5GMM capability IE defined in
3GPP TS 24.501 [3].
### 4.2.2 Network support of LCS
The network announces to the UE its ability to support LCS in 5GC using the
5GS network feature support IE defined in 3GPP TS 24.501 [3]. The information
is taken into account by the UE, in addition to UE\'s LCS capabilities, for
the UE to determine whether to initiate MO-LR procedure in NG-RAN as specified
in 3GPP TS 23.273 [3], subclause 6.2.
# 5 Support of LCS signalling
## 5.1 General
This clause defines the NG-RAN LCS operations (subclause 5.2) and the format
and coding of the messages (subclause 5.3).
The messages defined in this subclause can be transported in the UL/DL NAS
Transport message defined in 3GPP TS 24.501 [3].
## 5.2 LCS operations
### 5.2.1 Network initiated location services operations
#### 5.2.1.1 Supplementary Services Location Notification
##### 5.2.1.1.1 General
The supplementary services Location Notification operation enables the AMF to
trigger the end-user notification verification process on the UE using NAS
signalling. The supplementary services messages are transported using the DL
NAS Transport message and the UL NAS Transport message defined in 3GPP TS
24.501 [3]. UE Location Privacy Indication information may be included in
Location Notification Return Result to indicate whether subsequent LCS
requests will be allowed or disallowed by the UE. Figure 5.2.1.1.1.1
illustrates an example of the NAS signalling transport applicable to a 5GC-MT-
LR procedure for immediate or deferred location.
Figure 5.2.1.1.1.1: NAS signalling transport for Supplementary Services
Location Notification
NOTE: The optional Additional Information IE of the DL/UL NAS Transport
message is not used when the LCS Location Notification signalling is
transported in the Payload container.
##### 5.2.1.1.2 Normal operation
The network invokes a location notification procedure by sending a REGISTER
message containing an LCS-LocationNotification invoke component to the UE as
defined in 3GPP TS 24.080 [5]. This may be sent either to request verification
for a 5GC-MT-LR or to notify the UE about an already authorized 5GC-MT-LR.
In case of privacy verification, the UE shall respond to the request by
sending a RELEASE COMPLETE message containing the user\'s response and
optionally UE Location Privacy Indication information in a return result
component (see figure 5.2.1.1.2.1).
If the timer T(LCSN) defined in 3GPP TS 24.080 [5] expires in the network
before any response from the UE (e.g. due to no response from the user), the
network shall interpret this by applying the default treatment defined in 3GPP
TS 23.273 [2] (i.e. disallow location if barred by subscription or allow
location if allowed by subscription).
In the case of location notification, the UE shall terminate the dialogue
immediately by sending a RELEASE COMPLETE message containing a
LocationNotification return result.
If the UE is unable to process the request received from the network, it shall
return an error indication by sending a RELEASE COMPLETE message containing a
return error component. Error values are specified in 3GPP TS 24.080 [5].
**UE Network**
REGISTER
\
Facility (Return result = LCS-LocationNotification (verificationResponse,
locationPrivacyIndication, validTimePeriod))
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Return error (Error))
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Reject (Invoke_problem))
RELEASE COMPLETE
\
Facility (Return result = LCS-PeriodicTriggered)
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Return error (Error))
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Reject (Invoke_problem))
RELEASE COMPLETE
\
Facility (Return result = LCS-CancelDeferredLocation)
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Return error (Error))
RELEASE COMPLETE
\- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \- -
- - - - - - - - - ->
Facility (Reject (Invoke_problem))
RELEASE COMPLETE
\
Facility (Invoke = LCS-MOLR (molr-Type, lcs-QoS, lcsClientExternalID, mlc-
Number, supportedGADShapes, lcsServiceTypeID, ageOfLocationInfo, locationType,
pseudonymIndicator, multiplePositioningProtocolPDUs))
FACILITY
\
Figure 5.2.2.1.1-1: Single mobile originated location request
**\ **
**UE Network**
REGISTER
\------------------------------------------------------------------------------------------------------------------------>
Facility (Invoke = LCS-MOLR (molr-Type, lcs-QoS, lcsClientExternalID, mlc-
Number, supportedGADShapes, lcsServiceTypeID, ageOfLocationInfo, locationType,
pseudonymIndicator, multiplePositioningProtocolPDUs))
FACILITY
\
Facility (Invoke = LCS-MOLR (molr-Type, lcs-QoS, lcsClientExternalID, mlc-
Number, supportedGADShapes, lcsServiceTypeID, ageOfLocationInfo, locationType,
pseudonymIndicator, multiplePositioningProtocolPDUs))
FACILITY
\
Figure 5.2.2.1.1-2: Multiple mobile originated location requests
NOTE: Only the following IEs defined in MO-LR operations in 3GPP TS 24.080 [5]
are used for NG-RAN LCS:
\- molr-Type
\- lcs-QoS
\- lcsServiceTypeID
\- ageOfLocationInformation
\- locationType
\- mlc-Number
\- lcsClientExternalID
\- pseudonymIndicator
\- supportedGADShapes
\- multiplePositioningProtocolPDUs
\- locationEstimate
\- decipheringKeys
NOTE: multiplePositioningProtocolPDUs IE is added to the MO-LR Request to
allow for passing multiple UE positioning information LPP messages (e.g. UE
location measurements or UE capabilities) to the LMF for NG-RAN LCS. Its ASN.1
description is given in 3GPP TS 24.080 [5].
#### 5.2.2.2 UE initiated Cancel Deferred Location
##### 5.2.2.2.1 General
The supplementary services MSCancelDeferredLocation operation enables the UE
to cancel ongoing periodic or triggered location in a target LMF using NAS
signalling as described in 3GPP TS 23.273 subclause 6.3.3 [2]. The
supplementary services MCancelDeferredLocation messages are transported using
the UL NAS TRANSPORT message and the DL NAS TRANSPORT message defined in 3GPP
TS 24.501 [3]. Figure 5.2.2.2.1-1 illustrates an example of the NAS signalling
transport.
Figure 5.2.2.2.1-1: NAS signaling transport for UE initiated Cancel Deferred
Location
##### 5.2.2.2.2 Normal operation
The UE invokes a cancel deferred location procedure by sending a REGISTER
message containing a LCS-MSCancelDeferredLocation invoke component to the LMF
as defined in 3GPP TS 24.080 [5].
The LMF shall terminate the ongoing periodic or triggered location if this can
be identified from the information in the LCS-MSCancelDeferredLocation invoke
component.
The LMF shall then return a RELEASE COMPLETE message containing an LCS-
MSCancelDeferredLocation return result component (see Figure 5.2.2.2.2-1).
If the LMF is unable to process the request received from the UE or can not
identify the ongoing periodic or triggered location to be terminated, it shall
return an error indication by sending a RELEASE COMPLETE message containing a
return error component. Error values are specified in 3GPP TS 24.080 [5].
**UE Network**
REGISTER
\------------------------------------------------------------------------------------------------------------------------>
Facility (Invoke = LCS-MSCancelDeferredLocation (referenceNumberExt, h-gmlc-
callBackUri))
RELEASE COMPLETE
\
Figure 5.2.2.2.2-1: Cancel Deferred Location
NOTE: Only the following IEs defined in MSCancelDeferredLocation operations in
3GPP TS 24.080 [5] are used for NG-RAN LCS:
\- referenceNumberExt
\- h-gmlc-callBackUri
#### 5.2.2.3 UE initiated Positioning Information Transport
The UE sends LPP message and the associated Routing Identifier in the UL NAS
Transport message (refer to 3GPP TS 24.501 [3] and 3GPP TS 23.273 [2] clause
6.11.1). Figure 5.2.2.3-1 illustrates an example of the NAS signalling
transport for uplink LPP messages.
Figure 5.2.2.3-1: NAS signalling transport for uplink LPP messages
#### 5.2.2.4 UE initiated Event Reporting Procedure
##### 5.2.2.4.1 General
The supplmentary services EventReport operation enables the UE to report the
periodic or triggered location event invoked by the LMF via LCS
PeriodicTriggered Invoke operation as described in clause 6.3.1 of 3GPP TS
23.273 [2] when some certain events are detected in the UE. The supplmentary
services EventReport message is transferred to the LMF via the serving AMF in
a UL NAS TRANSPORT message defined in 3GPP TS 24.501 [3]. A response from the
LMF may be returned to the UE via the serving AMF and be transferred to the UE
in a DL NAS TRANSPORT message.
Figure 5.2.2.4.1-1 illustrates an example of the NAS signalling transport for
EventReport messages,
Figure 5.2.2.4.1-1: NAS signalling transport for EventReport messages
##### 5.2.2.4.2 Normal operation
The UE invokes an EventReport procedure by sending a REGISTER message
containing an EventReport component to the LMF as defined in 3GPP TS 24.080
[5].
The LMF shall return a supplementary services acknowledgement of event report
if it can handle this event report.
The LMF shall then return a RELEASE COMPLETE message containing an EventReport
Acknowledge component (see Figure 5.2.2.4.2-1).
If the LMF is unable to process the request received from the UE or can not
identify the ongoing periodic or triggered location to be terminated, it shall
return an error indication by sending a RELEASE COMPLETE message containing a
return error component. Error values are specified in 3GPP TS 24.080 [5].
**UE Network**
REGISTER
\------------------------------------------------------------------------------------------------------------------------>
Facility (Invoke = LCS-EventReport (eventType, referenceNumberExt, h-gmlc-
callBackUri, lcs-QoS, locationInfo, supportedGADShapes,
multiplePositioningProtocolPDUs, terminationCause))
RELEASE COMPLETE
\
Figure 5.2.2.4.2-1: EventReport
NOTE: Only the following IEs defined in EventReport operations in 3GPP TS
24.080 [5] are used for NG-RAN LCS:
\- eventType
\- referenceNumberExt
\- h-gmlc-callBackUri
\- lcs-QoS
\- locationInfo
\- supportedGADShapes
\- multiplePositioningProtocolPDUs
\- terminationCause
#### 5.2.2.5 UE Location Privacy Setting Procedure
##### 5.2.2.5.1 General
The supplmentary services LocationPrivacySetting operation enables the UE to
update the UE Location Privacy Indication information via UE Location Privacy
Setting procedure as described in clause 6.12.1 of 3GPP TS 23.273 [2] when the
UE has generated or updated the UE Location Privacy Indication. The
supplementary services LocationPrivacySetting message is transferred to the
serving AMF in a UL NAS TRANSPORT message and an acknowledgement from the
serving AMF may be returned to the UE in DL NAS TRANSPORT message defined in
3GPP TS 24.501 [3].
Figure 5.2.2.5.1-1 illustrates an example of the NAS signalling transport for
UE Location Privacy Setting procedure,
Figure 5.2.2.5.1-1: NAS signalling transport for LocationPrivacySetting
messages
##### 5.2.2.5.2 Normal operation
The UE invokes a Location Privacy Setting procedure by sending a REGISTER
message containing an LocationPrivacySetting message as defined in 3GPP TS
24.080 [5]. UE\'s Location Privacy Indication information is included in
LocationPrivacySetting message.
The AMF shall transfers the UE Location Privacy Indication information in
LocationPrivacySetting message to UDM and response a supplementary services
acknowledgement of LocationPrivacyIndication message
The AMF shall then return a RELEASE COMPLETE message containing a
LocationPrivacySetting Acknowledgement component (see figure 5.2.2.5.2-1) if
it can handle this LocationPrivacySetting message correctly.
If the AMF is unable to process the request received from the UE or can not
identify that provisioning the parameters of UE Location Privacy Setting
information to UDM is executed successfully, it shall return an error
indication by sending a RELEASE COMPLETE message containing a return error
component. Error values are specified in 3GPP TS 24.080 [5].
**UE Network**
REGISTER
\------------------------------------------------------------------------------------------------------------------------>
Facility (Invoke = LCS-LocationPrivacySetting (locationPrivacyIndication,
validTimePeriod)
RELEASE COMPLETE
\
Figure 5.2.2.5.2-1: LocationPrivacySetting
NOTE: Only the following IEs defined in LocationPrivacySetting operations in
3GPP TS 24.080 [5] are used for NG-RAN LCS:
\- locationPrivacyIndication
\- validTimePeriod
#### 5.2.2.6 UE initiated Event Reporting Procedure for Low Power Event
Reporting and Triggered 5GC-MT-LR
##### 5.2.2.6.1 General
The supplementary services EventReport operation enables the UE to report the
periodic or triggered location event invoked by the LMF via LCS
PeriodicTriggered Invoke operation as described in clause 6.7.1 of 3GPP TS
23.273 [2] when certain events are detected in the UE and when the UE supports
and the LMF allows the use of Control Plane CIoT 5GS Optimisation. The
supplementary services EventReport message is transferred to the LMF via the
serving AMF in a CONTROL PLANE SERVICE REQUEST message defined in 3GPP TS
24.501 [3]. A response from the LMF may be returned to the UE via the serving
AMF and be transferred to the UE in a DL NAS TRANSPORT message defined in 3GPP
TS 24.501 [3].
Figure 5.2.2.x.1-1 illustrates an example of the NAS signalling transport for
EventReport messages,
Figure 5.2.2.6.1-1: NAS signalling transport for EventReport messages using
Low Power Event Reporting and Triggered 5GC-MT-LR
##### 5.2.2.6.2 Normal operation
Normal operation is as described for the UE initiated Event Reporting
Procedure in clause 5.2.2.4.2.
## 5.3 LCS message and coding
### 5.3.1 Messages for Location services operations
The LCS message format and information elements coding for the MO-LR,
LocationNotification, EventReport, PeriodicTriggeredInvoke,
CancelDeferredLocation and LocationPrivacySetting operations (subclause 5.2)
are defined in 3GPP TS 24.080 [5] for the following messages:
\- Register message
\- Facility message
\- Release Complete message
### 5.3.2 Messages for LTE Positioning Protocol (LPP)
#### 5.3.2.1 Downlink Positioning Information Transport using LPP messages
The AMF shall set the Payload container type to \"LPP message container\" in
the DL NAS TRANSPORT message.
The AMF includes a Routing Identifier in the Additional information IE of the
DL NAS TRANSPORT message which identifies the LMF and the positioning session
between the AMF and LMF when a positioning session is being used.
The Routing identifier is the Correlation ID, which is defined in 3GPP TS
29.572 [6], so that the AMF can map the Routing identifier to the LMF and the
Correlation identifier when the AMF receives a UL NAS TRANSPORT message
including the responding LPP message.
#### 5.3.2.2 Uplink Positioning Information Transport using LPP messages
The UE shall set the Payload container type to \"LPP message container\" in
the UL NAS TRANSPORT message.
The UE includes a Routing Identifier received in the Additional Information IE
of the DL NAS TRANSPORT message in the Additional Information IE of the UL NAS
TRANSPORT message. This association of the Routing Identifier is provided at
the LPP level: the UL NAS TRANSPORT message carries an LPP message that is a
response to or instigated by the LPP message in the DL NAS TRANSPORT message.
The Routing identifier is the Correlation ID, which is defined in 3GPP TS
29.572 [6], so that the AMF can map the Routing identifier to the Correlation
identifier when the AMF receives the UL NAS TRANSPORT message.
#