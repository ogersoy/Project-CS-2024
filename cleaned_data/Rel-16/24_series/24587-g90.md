# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
Y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In the present document, certain modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
NOTE 1: The constructions \"shall\" and \"shall not\" are confined to the
context of normative provisions, and do not appear in Technical Reports.
NOTE 2: The constructions \"must\" and \"must not\" are not used as
substitutes for \"shall\" and \"shall not\". Their use is avoided insofar as
possible, and they are not used in a normative context except in a direct
citation from an external, referenced, non-3GPP document, or so as to maintain
continuity of style when extending or modifying the provisions of such a
referenced document.
**Should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
NOTE 3: The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**Can** indicates that something is possible
**cannot** indicates that something is impossible
NOTE 4: The constructions \"can\" and \"cannot\" shall not to be used as
substitutes for \"may\" and \"need not\".
**Will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
NOTE 5: The constructions \"is\" and \"is not\" do not indicate requirements.
# 1 Scope
The present document specifies the protocols for vehicle-to-everything (V2X)
services network as specified in 3GPP TS 23.287 [3] for:
a) V2X communication among the UEs over the PC5 interface; and
b) V2X communication between the UE and the V2X application server over the Uu
interface.
This specification also covers interworking with EPS for V2X services in 5GS.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document in the same
Release as the present document.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile
Station (MS) in idle mode\".
[3] 3GPP TS 23.287: \"Architecture enhancements for 5G System (5GS) to support
Vehicle-to-Everything (V2X) services\".
[4] 3GPP TS 23.502: \"Procedures for the 5G System (5GS); Stage 2\".
[5] 3GPP TS 24.386 \"User Equipment (UE) to V2X control function; protocol
aspects; Stage 3\".
[6] 3GPP TS 24.501: \"Access-Stratum (NAS) protocol for 5G System (5GS); Stage
3\".
[7] 3GPP TS 24.588: \"Vehicle-to-Everything (V2X) services in 5G System (5GS);
User Equipment (UE) policies; Stage 3\".
[8] 3GPP TS 38.300: \"NR; NR and NG-RAN Overall Description; Stage 2\".
[9] 3GPP TS 38.304: \"User Equipment (UE) procedures in Idle mode and RRC
Inactive state\".
[10] 3GPP TS 38.323: \"NR; Packet Data Convergence Protocol (PDCP)
specification\".
[11] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol
specification\".
[12] ETSI EN 302 636-3 v1.2.1: \"Intelligent Transport Systems (ITS);
Vehicular Communications; GeoNetworking; Part 3: Network Architecture\".
[13] IEEE 1609.3 2016: \"IEEE Standard for Wireless Access in Vehicular
Environments (WAVE) -- Networking Services\".
[14] IETF RFC 768: \"User Datagram Protocol\".
[15] IETF RFC 4291: \"IP Version 6 Addressing Architecture\".
[16] IETF RFC 4862: \"Neighbor Discovery for IP version 6 (IPv6)\".
[17] ISO 29281-1 2013: \"Intelligent transport systems -- Communication access
for land mobiles (CALM) -- Non-IP networking -- Part 1: Fast networking &
transport layer protocol (FNTP)\".
[18] ISO TS 17419 ITS-AID AssignedNumbers:
http://standards.iso.org/iso/ts/17419/TS17419%20Assigned%20Numbers/TS17419_ITS-
AID_AssignedNumbers.pdf
[19] IETF RFC 1035: \"DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION\".
[20] 3GPP TS 33.536: \"Security aspects of 3GPP support for advanced Vehicle-
to-Everything (V2X) services\".
[21] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[22] 3GPP TS 24.526: \"User Equipment (UE) policies for 5G System (5GS); Stage
3\".
[23] ISO/IEC 10118-3:2018: \"IT Security techniques -- Hash-functions \-- Part
3: Dedicated hash-functions\".
[24] CCSA YD/T 3707-2020: \"Technical requirements of network layer of LTE-
based vehicular communication\".
[25] IETF RFC 793: \"Transmission Control Protocol.\"
[26] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
# 3 Definitions of terms and abbreviations
## 3.1 Terms
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
**E-UTRA-PC5:** PC5 reference point over E-UTRA. The term E-UTRA-PC5 used in
the present document corresponds to the term LTE PC5 defined in 3GPP TS 23.287
[3].
**NR-PC5:** PC5 reference point over NR. The term NR-PC5 used in the present
document corresponds to the term NR PC5 defined in 3GPP TS 23.287 [3].
**PC5 QoS flow context:** A context which includes a set of V2X service
identifiers, a PQFI value and a set of PC5 QoS parameters.
**PC5 QoS rule:** A rule which includes a PC5 QoS rule identifier, a PQFI
value, a precedence value and optionally a set of packet filters. The PC5 QoS
rule is associated with a PC5 QoS flow context.
**V2X service identifier** : an identifier of a V2X service, e.g. PSID, ITS-
AID, or AID of the V2X application. The term V2X service identifier used in
the present document corresponds to the term V2X service type defined in 3GPP
TS 23.287 [3].
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 23.287 [3] apply:
**Application Identifier (AID)**
**Intelligent Transport Systems (ITS)**
**ITS Application Identifier (ITS-AID)**
**Provider Service Identifier (PSID)**
**V2X communication**
**V2X message**
**V2X service**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.501 [6] apply:
**5G-EA**
**5G-IA**
For the purposes of the present document, the following terms and definitions
given in 3GPP TS 24.501 [6] apply:
**UE local configuration**
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] , 3GPP TS 24.501 [6] and the following apply. An abbreviation
defined in the present document takes precedence over the definition of the
same abbreviation, if any, in 3GPP TR 21.905 [1] and 3GPP TS 24.501 [6].
E-UTRA Evolved Universal Terrestrial Radio Access
FQDN Fully Qualified Domain Name
LSB Least Significant 8 Bits
MSB Most Significant 8 Bits
NR New Radio
NRPEK NR PC5 Encryption Key
NRPIK NR PC5 Integrity Key
V2X Vehicle-to-Everything
V2XP V2X Policy
PQFI PC5 QoS Flow ID
PQI PC5 5QI
# 4 General description
The present specification defines means for transport of V2X messages in 5GS
and interworking to EPS. V2X messages are generated and consumed by upper
layers of the UE and the V2X application server. V2X messages can contain IP
data or non-IP data.
The V2X messages can be transported using:
a) V2X communication over PC5; and
b) V2X communication over Uu.
For case a above:
1) V2X communication over PC5 enables transfer of V2X messages among UEs;
2) both IP based and non-IP based V2X messages are supported over PC5; and
3) for V2X messages containing IP data, only IPv6 is used. IPv4 is not
supported in this release of the specification.
For case b above:
1) V2X communication over Uu enables transfer of V2X messages between a UE and
a V2X application server;
2) both IP based and non-IP based V2X messages are supported over Uu;
3) V2X messages are carried over Uu in payload of either a UDP/IP packet or
TCP/IP packet towards a V2X application server address;
NOTE: Further details about the use of UDP or TCP as a transport layer
protocol are described in 3GPP TS 23.287 [3] clause 5.2.3.1.
4) V2X messages carried over Uu are sent or received over unicast only in this
release of the specification; and
5) V2X messages are carried over Uu using user data via user plane.
# 5 Provisioning of parameters for V2X configuration
## 5.1 General
V2X communication is configured by the use of V2X configuration parameters and
their related procedures which allow configuration of necessary V2X
configuration parameters.
## 5.2 Configuration and precedence of V2X configuration parameters
### 5.2.1 General
UE\'s usage of V2X communication is controlled by V2X communication
parameters.
The V2X communication parameters consist of the configuration parameters for
V2X communication over PC5 and the configuration parameters for V2X
communication over Uu.
### 5.2.2 Precedence of V2X configuration parameters
The V2X configuration parameters can be:
a) pre-configured in the ME;
b) configured in the USIM;
c) provided as a V2XP using the UE policy delivery service as specified in
3GPP TS 24.501 [6] annex D;
d) provided by a V2X application server via V1 reference point; or
e) a combination of case a), b), c) or d) above.
The UE shall use the V2X configuration parameters in the following order of
decreasing precedence:
a) the V2X configuration parameters provided as a V2XP using the UE policy
delivery service as specified in annex D of 3GPP TS 24.501 [6];
b) the V2X configuration parameters provided by a V2X application server via
V1 reference point;
c) the V2X configuration parameters configured in the USIM; and
d) the V2X configuration parameters pre-configured in the ME.
### 5.2.3 Configuration parameters for V2X communication over PC5
The configuration parameters for V2X communication over PC5 consist of:
a) a validity timer for the validity of the configuration parameters for V2X
communication over PC5;
b) a list of PLMNs and RATs in which the UE is authorized to use V2X
communication over PC5 when the UE is served by E-UTRA or served by NR. Each
entry of the list contains a PLMN ID and RATs in which the UE is authorized to
use V2X communication over PC5;
c) an indication of whether the UE is authorized to use V2X communication over
PC5 when the UE is not served by E-UTRA and not served by NR;
d) list of RATs in which the UE is authorized to use V2X communication over
PC5 and the radio parameters of the RAT for V2X communication over PC5
applicable per geographical area with an indication of whether these radio
parameters of the RAT are \"operator managed\" or \"non-operator managed\"
when the UE is not served by E-UTRA and not served by NR;
e) void
f) optionally, a list of V2X service identifier to PC5 RAT(s) and Tx profiles
mapping rules. Each mapping rule contains one or more V2X service identifiers,
PC5 RAT(s) and, if the PC5 RAT(s) include E-UTRA-PC5, Tx profiles
corresponding to the E-UTRA-PC5;
g) configuration parameters for privacy support, consisting of:
1) a list of V2X services requiring privacy. Each entry of the list contains
one or more V2X service identifiers and one or more geographical areas where
the privacy is required; and
2) a privacy timer value as specified in 3GPP TS 24.588 [7] clause 5.3;
h) configuration parameters for a V2X communication over PC5 in E-UTRA-PC5,
consisting of:
1) a list of V2X service identifier to destination layer-2 ID mapping rules.
Each mapping rule contains one or more V2X service identifiers and the
destination layer-2 ID;
2) optionally, a default destination layer-2 ID;
3) a list of PPPP to PDB mapping rules. Each mapping rule contains a ProSe
Per-Packet Priority (PPPP) and a Packet Delay Budget (PDB);
4) optionally, list of V2X service identifier to V2X E-UTRA frequency mapping
rules. Each mapping rule contains one or more V2X service identifiers and the
V2X E-UTRA frequencies with associated geographical areas; and
5) optionally, a list of the V2X services authorized for ProSe Per-Packet
Reliability (PPPR). Each entry of the list contains one or more V2X service
identifiers and a ProSe Per-Packet Reliability (PPPR) value; and
i) configuration parameters for a V2X communication over PC5 in NR-PC5,
consisting of:
1) optionally, a list of V2X service identifier to V2X NR frequency mapping
rules. Each mapping rule contains one or more V2X service identifiers and the
V2X NR frequencies with associated geographical areas;
2) a list of V2X service identifier to destination layer-2 ID for broadcast
mapping rules. Each mapping rule contains one or more V2X service identifiers
and the destination layer-2 ID for broadcast;
3) optionally, a default destination layer-2 ID for broadcast;
4) a list of V2X service identifier to destination layer-2 ID for groupcast
mapping rules. Each mapping rule contains one or more V2X service identifiers
and the destination layer-2 ID for groupcast;
5) a list of V2X service identifier to default destination layer-2 ID for
unicast initial signaling mapping rules. Each mapping rule contains one or
more V2X service identifiers and the default destination layer-2 ID for
initial signalling to establish unicast connection;
6) a list of V2X service identifier to PC5 QoS parameters mapping rules. The
PC5 QoS parameters are specified in clause 5.4.2 of 3GPP TS 23.287 [3];
7) an AS configuration, including a list of SLRB mapping rules applicable when
the UE is not served by E-UTRA and is not served by NR. Each SLRB mapping rule
contains a PC5 QoS profile and an SLRB. The PC5 QoS profile contains the
following parameters:
i) the PC5 QoS profile contains a PQI;
ii) if the PQI of the PC5 QoS profile identifies a GBR QoS, the PC5 QoS
profile contains a PC5 flow bit rates consisting of a guaranteed flow bit rate
(GFBR) and a maximum flow bit rate (MFBR);
iii) if the PQI of the PC5 QoS profile identifies a non-GBR QoS, the PC5 QoS
profile contains the PC5 link aggregated bit rate consisting of a per link
aggregate maximum bit rate (PC5 LINK-AMBR);
NOTE: PC5 link aggregated bit rate is only used for unicast mode
communications over PC5.
iv) the PC5 QoS profile contains a range, which is only used for groupcast
mode communications over PC5; and
v) the PC5 QoS profile can contain the priority level, the averaging window,
and the maximum data burst volume. If one or more of the priority level, the
averaging window or the maximum data burst volume are not contained in the PC5
QoS profile, their default values apply;
8) a list of NR-PC5 unicast security policies. Each entry in the list contains
an NR-PC5 unicast security policy composed of:
i) one or more V2X service identifiers;
ii) the signalling integrity protection policy for the V2X service
identifier(s);
iii) the signalling ciphering policy for the V2X service identifier(s);
iv) the user plane integrity protection policy for the V2X service
identifier(s);
v) the user plane ciphering policy for the V2X service identifier(s); and
vi) one or more geographical areas where the NR-PC5 unicast security policy
applies; and
9) a list of V2X service identifier to default mode of communication mapping
rules. Each mapping rule contains one or more V2X service identifiers and the
default mode of communication (one of unicast, groupcast or broadcast).
### 5.2.4 Configuration parameters for V2X communication over Uu
The configuration parameters for V2X communication over Uu consist of:
a) a validity timer for the validity of the configuration parameters for V2X
communication over Uu to 5GCN;
b) optionally, a list of V2X service identifier to PDU session parameters
mapping rules. Each mapping rule contains one or more V2X service identifiers
of a the V2X service and one or more parameters for establishment of a PDU
session for V2X communication over Uu for the V2X services:
1) one of the \"IPv4\", \"IPv6\", \"IPv4v6\" or \"Unstructured\" PDU session
types;
2) an SSC mode;
3) a list of zero or more S-NSSAIs;
4) a list of zero or more DNNs; and
5) one of the UDP or TCP transport layer protocol if the PDU session type is
\"IPv4\", \"IPv6\" or \"IPv4v6\"; and
c) a list of PLMNs in which the UE is configured to use V2X communication over
Uu. For each PLMN, the list contains:
1) for transfer of a V2X message of a V2X service identified by a V2X service
identifier:
i) a list of V2X service identifier to V2X application server address mapping
rules, applicable when the UE is registered to the PLMN. Each mapping rule
contains:
A) one or more V2X service identifiers;
B) a V2X application server address for unicast consisting of:
\- an FQDN, or an IP address; and
\- a UDP port for uplink transport, a UDP port for downlink transport, a TCP
port for bidirectional transport or any combination of them; and
C) optionally a geographical area; and
ii) optionally, per type of data (IP and non-IP) and V2X message family (in
case of non-IP) and optionally a geographical area, one or more default V2X
application server addresses for the unicast V2X communication over Uu
applicable when the UE is registered to the PLMN. Each V2X application server
address consists of:
i) an FQDN, or an IP address; and
ii) a UDP port for uplink transport, a UDP port for downlink transport, a TCP
port for bidirectional transport or any combination of them; and
2) for transfer of a V2X message of a V2X service not identified by a V2X
service identifier:
i) a list of the V2X application servers per optional geographical area where
usage of those V2X application servers applies, applicable when the UE is
registered to the PLMN. Each entry of the list contains:
A) a V2X application server address consisting of an FQDN, or an IP address;
and
B) optionally, a geographical area.
## 5.3 Procedures
### 5.3.1 General
The procedure for provisioning of parameters for V2X configuration allows the
UE to obtain information necessary for V2X communication.
### 5.3.2 UE-requested V2X policy provisioning procedure
#### 5.3.2.1 General
The UE-requested V2X policy provisioning procedure enables the UE to request
V2X policy from the PCF in the following cases:
a) if the validity timer for a V2X policy expires; or
b) if there are no valid configuration parameters, e.g., for the current area,
or due to abnormal situation.
The UE shall follow the principles of PTI handling for UE policy delivery
service procedures defined in 3GPP TS 24.501 [6] clause D.1.2.
#### 5.3.2.2 UE-requested V2X policy provisioning procedure initiation
In order to initiate the UE-requested V2X policy provisioning procedure, the
UE shall create a UE POLICY PROVISIONING REQUEST message (see example in
figure 5.3.2.2.1). The UE:
a) shall allocate a PTI value currently not used and set the PTI IE to the
allocated PTI value;
b) shall include the Requested UE policies IE indicating whether the UE
policies for V2X communication over PC5, the UE policies for V2X communication
over Uu or both are requested;
c) shall transport the UE POLICY PROVISIONING REQUEST message using the NAS
transport procedure as specified in 3GPP TS 24.501 [6] clause 5.4.5; and
d) shall start timer T5040.
Figure 5.3.2.2.1: UE-requested V2X policy provisioning procedure
#### 5.3.2.3 UE-requested V2X policy provisioning procedure accepted by the
network
Upon receipt of and accepting the UE POLICY PROVISIONING REQUEST message, the
PCF shall create a MANAGE UE POLICY COMMAND message and shall behave as
described in clause D.2.1 of 3GPP TS 24.501 [6].
Upon receipt of the MANAGE UE POLICY COMMAND message with the same PTI as
included in the UE POLICY PROVISIONING REQUEST message, the UE shall stop
timer T5040 and handles the MANAGE UE POLICY COMMAND message as specified in
clause D.2.1 of 3GPP TS 24.501 [6].
#### 5.3.2.4 UE-requested V2X policy provisioning procedure not accepted by
the network
Upon receipt and rejecting of the UE POLICY PROVISIONING REQUEST message, the
PCF shall create a UE POLICY PROVISIONING REJECT message.
The PCF shall set the UPDS cause IE of the UE POLICY PROVISIONING REJECT
message to indicate reason for rejecting the UE-requested V2X policy
provisioning procedure.
The UPDS cause IE typically indicates one of the following UPDS cause values:
#31 request rejected, unspecified;
#32 service option not supported;
#34 service option temporarily out of order;
#35 PTI already in use; or
#95 -- 111 protocol errors.
The PCF shall transport the UE POLICY PROVISIONING REJECT message to the UE
via the AMF using the procedure specified in 3GPP TS 23.502 [4].
Upon receipt of the UE POLICY PROVISIONING REJECT message, the UE shall stop
timer T5040.
#### 5.3.2.5 Abnormal cases on the network side
The following abnormal cases can be identified:
a) Indication from the lower layer of transmission failure of the UE POLICY
PROVISIONING REJECT message.
After receiving an indication from lower layer that the UE POLICY PROVISIONING
REJECT message has not been successfully acknowledged (e.g. TCP ACK is not
received), the PCF shall abort the procedure.
#### 5.3.2.6 Abnormal cases on the UE
The following abnormal cases can be identified:
a) T5040 expired.
The UE shall, on the first expiry of the timer T5040, retransmit the UE POLICY
PROVISIONING REQUEST message and shall reset and start timer T5040. This
retransmission is repeated four times, i.e. on the fifth expiry of timer
T5040, the UE shall abort the procedure and release the allocated PTI.
# 6 V2X communication
## 6.1 V2X communication over PC5
### 6.1.1 General
This clause describes the procedures at the UE, and between UEs, for V2X
communication over PC5.
The UE shall support requirements for securing V2X communication over PC5.
Both IP based and non-IP based V2X communication over PC5 are supported. For
IP based V2X communication, only IPv6 is used. IPv4 is not supported in this
release of the present document.
V2X communication over NR-PC5 supports broadcast mode, groupcast mode, and
unicast mode. If upper layer of the UE indicates the mode of communication,
the UE shall set the mode of communication based on the request of the upper
layer. Otherwise, the UE shall set the mode of communication based on the
mapping rules between the V2X service identifier and the default mode of
communication defined in clause 5.2.3.
NOTE: Further details about whether broadcast, unicast or groupcast can be
used over PC5 are described in 3GPP TS 23.287 [3] clause 5.2.1.
### 6.1.2 Unicast mode communication over NR based PC5
#### 6.1.2.1 Overview
This clause describes the PC5 signalling protocol procedures between two UEs
for unicast mode of V2X communication. The following PC5 signalling protocol
procedures are defined:
a) PC5 unicast link establishment;
b) PC5 unicast link modification;
c) PC5 unicast link release;
d) PC5 unicast link identifier update;
e) PC5 unicast link authentication;
f) PC5 unicast link security mode control;
g) PC5 unicast link keep-alive; and
h) PC5 unicast link re-keying procedure.
#### 6.1.2.2 PC5 unicast link establishment procedure
##### 6.1.2.2.1 General
Depending on the type of the PC5 unicast link establishment procedure (i.e. UE
oriented Layer-2 link establishment or V2X Service oriented Layer-2 link
establishment in 3GPP TS 23.287[3]), the PC5 unicast link establishment
procedure is used to establish a PC5 unicast link between two UEs or to
establish multiple PC5 unicast links. The UE sending the request message is
called the \"initiating UE\" and the other UE is called the \"target UE\". If
the request message does not indicate the specific target UE (i.e. target user
info is not included in the request message), and multiple target UEs are
interested in the V2X service(s) indicated in the request message, then the
initiating UE shall handle corresponding response messages received from those
target UEs. The maximum number of NR PC5 unicast links established in a UE at
a time shall not exceed an implementation-specific maximum number of
established NR PC5 unicast links.
NOTE: The recommended maximum number of established NR PC5 unicasts link is 8.
##### 6.1.2.2.2 PC5 unicast link establishment procedure initiation by
initiating UE
The initiating UE shall meet the following pre-conditions before initiating
this procedure:
a) a request from upper layers to transmit the packet for V2X service over
PC5;
b) the communication mode is unicast mode (e.g. pre-configured as specified in
clause 5.2.3 or indicated by upper layers);
c) the link layer identifier for the initiating UE (i.e. layer-2 ID used for
unicast communication) is available (e.g. pre-configured or self-assigned) and
is not being used by other existing PC5 unicast links within the initiating
UE;
d) the link layer identifier for the destination UE (i.e. the unicast layer-2
ID of the target UE or the broadcast layer-2 ID) is available to the
initiating UE (e.g. pre-configured, obtained as specified in clause 5.2.3 or
known via prior V2X communication);
NOTE 1: In the case where different V2X services are mapped to distinct
default destination layer-2 IDs, when the initiating UE intends to establish a
single unicast link that can be used for more than one V2X service
identifiers, the UE can select any of the default destination layer-2 ID for
unicast initial signalling.
e) the initiating UE is either authorised for V2X communication over PC5 in
NR-PC5 in the serving PLMN, or has a valid authorization for V2X communication
over PC5 in NR-PC5 when not served by E-UTRA and not served by NR. The UE
considers that it is not served by E-UTRA and not served by NR if the
following conditions are met:
1) not served by NR and not served by E-UTRA for V2X communication over PC5;
2) in limited service state as specified in 3GPP TS 23.122 [2], if the reason
for the UE being in limited service state is one of the following;
i) the UE is unable to find a suitable cell in the selected PLMN as specified
in 3GPP TS 38.304 [9];
ii) the UE received a REGISTRATION REJECT message or a SERVICE REJECT message
with the 5GMM cause #11 \"PLMN not allowed\" as specified in 3GPP TS 24.501
[6]; or
iii) the UE received a REGISTRATION REJECT message or a SERVICE REJECT message
with the 5GMM cause #7 \"5GS services not allowed\" as specified in 3GPP TS
24.501 [6]; or
3) in limited service state as specified in 3GPP TS 23.122 [2] for reasons
other than i), ii) or iii) above, and located in a geographical area for which
the UE is provisioned with \"non-operator managed\" radio parameters as
specified in clause 5.2.3;
f) there is no existing PC5 unicast link for the pair of peer application
layer IDs, or there is an existing PC5 unicast link for the pair of peer
application layer IDs and:
1) the network layer protocol of the existing PC5 unicast link is not
identical to the network layer protocol required by the upper layer in the
initiating UE for this V2X service; or
2) the security policy (either signalling security policy or user plane
security policy) corresponding to the V2X service identifier is not compatible
with the security policy of the existing PC5 unicast link; and
g) the number of established PC5 unicast links is less than the
implementation-specific maximum number of established NR PC5 unicast links
allowed in the UE at a time.
After receiving the service data or request from the upper layers, the
initiating UE shall derive the PC5 QoS parameters and assign the PQFI(s) for
the PC5 QoS flows(s) to be established as specified in clause 6.1.2.12.
In order to initiate the PC5 unicast link establishment procedure, the
initiating UE shall create a DIRECT LINK ESTABLISHMENT REQUEST message. The
initiating UE:
a) shall include the source user info set to the initiating UE\'s application
layer ID received from upper layers;
b) shall include the V2X service identifier(s) received from upper layer;
c) shall include the target user info set to the target UE\'s application
layer ID if received from upper layers or if the destination layer-2 ID is the
unicast layer-2 ID of target UE;
d) shall include the Key establishment information container if the UE PC5
unicast signalling integrity protection policy is set to \"signalling
integrity protection required\" or \"signalling integrity protection
preferred\", and may include the Key establishment information container if
the UE PC5 unicast signalling integrity protection policy is set to
\"signalling integrity protection not needed\";
NOTE 2: The Key establishment information container is provided by upper
layers.
e) shall include a Nonce_1 set to the 128-bit nonce value generated by the
initiating UE for the purpose of session key establishment over this PC5
unicast link if the UE PC5 unicast signalling integrity protection policy is
set to \"signalling integrity protection required\" or \"signalling integrity
protection preferred\";
f) shall include its UE security capabilities indicating the list of
algorithms that the initiating UE supports for the security establishment of
this PC5 unicast link;
g) shall include the 8 MSBs of K~NRP-sess~ ID chosen by the initiating UE as
specified in 3GPP TS 33.536 [20] if the UE PC5 unicast signalling integrity
protection policy is set to \"signalling integrity protection required\" or
\"signalling integrity protection preferred\";
h) may include a K~NRP~ ID if the initiating UE has an existing K~NRP~ for the
target UE; and
i) shall include its UE PC5 unicast signalling security policy. In the case
where the different V2X services are mapped to the different PC5 unicast
signalling security policies, when the initiating UE intends to establish a
single unicast link that can be used for more than one V2X service, each of
the signalling security polices of those V2X services shall be compatible,
e.g. \"signalling integrity protection not needed\" and \"signalling integrity
protection required\" are not compatible.
After the DIRECT LINK ESTABLISHMENT REQUEST message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s layer-2 ID for unicast communication and the
destination layer-2 ID, and start timer T5000. The UE shall not send a new
DIRECT LINK ESTABLISHMENT REQUEST message to the same target UE identified by
the same application layer ID while timer T5000 is running. If the target user
info IE is not included in the DIRECT LINK ESTABLISHMENT REQUEST message (i.e.
V2X service oriented PC5 unicast link establishment procedure), the initiating
UE shall handle multiple DIRECT LINK ESTABLISHMENT ACCEPT messages, if any,
received from different target UEs for the establishment of multiple PC5
unicast links before the expiry of timer T5000.
NOTE 3: In order to ensure successful PC5 unicast link establishment, T5000
should be set to a value larger than the sum of T5006 and T5007.
Figure 6.1.2.2.2: UE oriented PC5 unicast link establishment procedure
Figure 6.1.2.2.3: V2X service oriented PC5 unicast link establishment
procedure
##### 6.1.2.2.3 PC5 unicast link establishment procedure accepted by the
target UE
Upon receipt of a DIRECT LINK ESTABLISHMENT REQUEST message, if the target UE
accepts this request, the target UE shall uniquely assign a PC5 link
identifier, create a PC5 unicast link context and assign a layer-2 ID for this
PC5 unicast link. The newly assigned layer-2 ID replaces the target layer-2 ID
as received on the DIRECT LINK ESTABLISHMENT REQUEST message. Then the target
UE shall store this assigned layer-2 ID and the source layer-2 ID used in the
transport of this message provided by the lower layers in the PC5 unicast link
context. The target UE may initiate PC5 unicast link authentication procedure
as specified in clause 6.1.2.6 and shall initiate PC5 unicast link security
mode control procedure as specified in clause 6.1.2.7.
NOTE: The target UE may reuse the target UE\'s layer-2 ID used in the
transport of the DIRECT LINK ESTABLISHMENT REQUEST message provided by the
lower layers in case that the target UE\'s layer-2 ID has been used in
previous PC5 unicast link with the same peer.
If:
a) the target user info IE is included in the DIRECT LINK ESTABLISHMENT
REQUEST message and this IE includes the target UE\'s application layer ID; or
b) the target user info IE is not included in the DIRECT LINK ESTABLISHMENT
REQUEST message and the target UE is interested in the V2X service(s)
identified by the V2X service identifier IE in the DIRECT LINK ESTABLISHMENT
REQUEST message;
then the target UE shall either:
a) identify an existing K~NRP~ based on the K~NRP~ ID included in the DIRECT
LINK ESTABLISHMENT REQUEST message; or
b) if K~NRP~ ID is not included in the DIRECT LINK ESTABLISHMENT REQUEST
message, the target UE does not have an existing K~NRP~ for the K~NRP~ ID
included in DIRECT LINK ESTABLISHMENT REQUEST message or the target UE wishes
to derive a new K~NRP~, derive a new K~NRP~. This may require performing one
or more PC5 unicast link authentication procedures as specified in clause
6.1.2.6.
NOTE: How many times the PC5 unicast link authentication procedure needs to be
performed to derive a new K~NRP~ depends on the authentication method used.
After an existing K~NRP~ was identified or a new K~NRP~ was derived, the
target UE shall initiate a PC5 unicast link security mode control procedure as
specified in clause 6.1.2.7.
Upon successful completion of the PC5 unicast link security mode control
procedure, in order to determine whether the DIRECT LINK ESTABLISHMENT REQUEST
message can be accepted or not, in case of IP communication, the target UE
checks whether there is at least one common IP address configuration option
supported by both the initiating UE and the target UE.
If the target UE accepts the PC5 unicast link establishment procedure, the
target UE shall create a DIRECT LINK ESTABLISHMENT ACCEPT message. The target
UE:
a) shall include the source user info set to the target UE\'s application
layer ID received from upper layers;
b) shall include PQFI(s), the corresponding PC5 QoS parameters and the V2X
service identifier(s) that the target UE accepts;
c) shall include an IP address configuration IE set to one of the following
values if IP communication is used:
1) \"IPv6 router\" if IPv6 address allocation mechanism is supported by the
target UE, i.e. acting as an IPv6 router; or
2) \"IPv6 address allocation not supported\" if IPv6 address allocation
mechanism is not supported by the target UE;
d) shall include a link local IPv6 address IE formed locally based on IETF RFC
4862 [16] if IP address configuration IE is set to \"IPv6 address allocation
not supported\" and the received DIRECT LINK ESTABLISHMENT REQUEST message
included a link local IPv6 address IE; and
e) shall include the configuration of UE PC5 unicast user plane security
protection based on the agreed user plane security policy, as specified in
3GPP TS 33.536 [20].
After the DIRECT LINK ESTABLISHMENT ACCEPT message is generated, the target UE
shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication, and shall start timer T5011 if at least
one of V2X service identifiers for the PC5 unicast links satisfies the privacy
requirements as specified in clause 5.2.3.
After sending the DIRECT LINK ESTABLISHMENT ACCEPT message, the target UE
shall provide the following information along with the layer-2 IDs to the
lower layer, which enables the lower layer to handle the coming PC5 signalling
or traffic data:
a) the PC5 link identifier self-assigned for this PC5 unicast link;
b) PQFI(s) and its corresponding PC5 QoS parameters; and
c) an indication of activation of the PC5 unicast user plane security
protection for the PC5 unicast link, if applicable.
If the target UE accepts the PC5 unicast link establishment request, then the
target UE may perform the PC5 QoS flow establishment over PC5 unicast link as
specified in clause 6.1.2.12.
##### 6.1.2.2.4 PC5 unicast link establishment procedure completion by the
initiating UE
If the Target user info IE is included in the DIRECT LINK ESTABLISHMENT
REQUEST message, upon receipt of the DIRECT LINK ESTABLISHMENT ACCEPT message,
the initiating UE shall stop timer T5000. If the Target user info IE is not
included in the DIRECT LINK ESTABLISHMENT REQUEST message the initiating UE
may keep the timer T5000 running and continue to handle multiple response
messages (i.e. the DIRECT LINK ESTABLISHMENT ACCEPT message) from multiple
target UEs.
For each of the DIRECT LINK ESTABLISHMENT ACCEPT message received, the
initiating UE shall uniquely assign a PC5 link identifier and create a PC5
unicast link context for each of the PC5 unicast link(s). Then the initiating
UE shall store the source layer-2 ID and the destination layer-2 ID used in
the transport of this message provided by the lower layers in the PC5 unicast
link context(s) to complete the establishment of the PC5 unicast link with the
target UE(s). From this time onward the initiating UE shall use the
established link(s) for V2X communication over PC5 and additional PC5
signalling messages to the target UE(s).
After receiving the DIRECT LINK ESTABLISHMENT ACCEPT message, the initiating
UE shall delete the old security context it has for the target UE and shall
provide the following information along with the layer-2 IDs to the lower
layer, which enables the lower layer to handle the coming PC5 signalling or
traffic data:
a) the PC5 link identifier self-assigned for this PC5 unicast link;
b) PQFI(s) and its corresponding PC5 QoS parameters; and
c) an indication of activation of the PC5 unicast user plane security
protection for the PC5 unicast link, if applicable.
The initiating UE shall start timer T5011 if at least one of V2X service
identifiers for the PC5 unicast links satisfies the privacy requirements as
specified in clause 5.2.3.
In addition, the initiating UE may perform the PC5 QoS flow establishment over
PC5 unicast link as specified in clause 6.1.2.12.
Upon expiry of the timer T5000, if the DIRECT_LINK_ESTABLISHMENT REQUEST
message did not include the Target User Info IE, and the initiating UE
received at least one DIRECT LINK ESTABLISHMENT ACCEPT message, it is up to
the UE implementation to consider the PC5 unicast link establishment procedure
as complete or to restart the timer T5000.
##### 6.1.2.2.5 PC5 unicast link establishment procedure not accepted by the
target UE
If the DIRECT LINK ESTABLISHMENT REQUEST message cannot be accepted, the
target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message. The DIRECT
LINK ESTABLISHMENT REJECT message contains a PC5 signalling protocol cause IE
set to one of the following cause values:
#1 direct communication to the target UE not allowed;
#3 conflict of layer-2 ID for unicast communication is detected;
#5 lack of resources for PC5 unicast link; or
#111 protocol error, unspecified.
If the target UE is not allowed to accept the DIRECT LINK ESTABLISHMENT
REQUEST message .e.g. based on operator policy or configuration parameters for
V2X communication over PC5 as specified in clause 5.2.3, the target UE shall
send a DIRECT LINK ESTABLISHMENT REJECT message containing PC5 signalling
protocol cause value #1 \"direct communication to the target UE not allowed\".
For a received DIRECT LINK ESTABLISHMENT REQUEST message from a layer-2 ID
(for unicast communication), if the target UE already has an existing link
established to a UE using this layer-2 ID or is currently processing a DIRECT
LINK ESTABLISHMENT REQUEST message from the same layer-2 ID, and with one of
following parameters different from the existing link or the link for which
the link establishment is in progress:
a) the source user info;
b) type of data (e.g. IP or non-IP); or
c) security policy,
the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT message containing
PC5 signalling protocol cause value #3 \"conflict of layer-2 ID for unicast
communication is detected\".
NOTE: The type of data (e.g. IP or non-IP) is indicated by the optional IP
address configuration IE included in the corresponding DIRECT LINK SECURITY
MODE COMPLETE message, i.e the type of data for the requested link is IP type
if this IE is included, and the type of data for the requested link is non-IP
if this IE is not included.
If the PC5 unicast link establishment fails due to the congestion problems,
the implementation-specific maximum number of established NR PC5 unicast links
has been reached, or other temporary lower layer problems causing resource
constraints, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT
message containing PC5 signalling protocol cause value #5 \"lack of resources
for PC5 unicast link\". If the PC5 unicast link establishment fails due to
other reasons, the target UE shall send a DIRECT LINK ESTABLISHMENT REJECT
message containing PC5 signalling protocol cause value #111 \"protocol error,
unspecified\".
After sending the DIRECT LINK ESTABLISHMENT REJECT message, the target UE
shall provide the following information along with the initiating UE\'s
layer-2 ID for unicast communication and the target UE\'s layer-2 ID for
unicast communication to the lower layer:
a) an indication of deactivation of the PC5 unicast security protection and
deletion of security context for the PC5 unicast link, if applicable.
Upon receipt of the DIRECT LINK ESTABLISHMENT REJECT message, the initiating
UE shall stop timer T5000 and abort the PC5 unicast link establishment
procedure, if the Target user info is included in the DIRECT LINK
ESTABLISHMENT REQUEST message. If the PC5 signalling protocol cause value in
the DIRECT LINK ESTABLISHMENT REJECT message is #1 \"direct communication to
the target UE not allowed\" or #5 \"lack of resources for PC5 unicast link\",
then the UE shall not attempt to start the PC5 unicast link establishment
procedure with the same target UE at least for a time period T.
NOTE: The length of time period T is UE implementation specific and can be
different for the case when the UE receives PC5 signalling protocol cause
value #1 \"direct communication to the target UE not allowed\" or when the UE
receives PC5 signalling protocol cause value #5 \"lack of resources for PC5
unicast link\".
After receiving the DIRECT LINK ESTABLISHMENT REJECT message, the initiating
UE shall provide the following information along with the initiating UE\'s
layer-2 ID for unicast communication and the target UE\'s layer-2 ID for
unicast communication to the lower layer:
a) an indication of deactivation of the PC5 unicast security protection and
deletion of security context for the PC5 unicast link, if applicable.
##### 6.1.2.2.6 Abnormal cases
##### 6.1.2.2.6.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue .H6}
If timer T5000 expires and the Target user info IE is included in the DIRECT
LINK ESTABLISHMENT REQUEST message, the initiating UE shall retransmit the
DIRECT LINK ESTABLISHMENT REQUEST message and restart timer T5000. After
reaching the maximum number of allowed retransmissions, the initiating UE
shall abort the PC5 unicast link establishment procedure and may notify the
upper layer that the target UE is unreachable.
Upon expiry of the timer T5000, if the DIRECT_LINK_ESTABLISHMENT REQUEST
message did not include the Target User Info IE and the initiating UE did not
receive any DIRECT LINK ESTABLISHMENT ACCEPT message, the initiating UE may
retransmit the DIRECT LINK ESTABLISHMENT REQUEST message and restart timer
T5000. If the DIRECT_LINK_ESTABLISHMENT REQUEST message did not include the
Target User Info IE and the initiating UE did not receive any DIRECT LINK
ESTABLISHMENT ACCEPT message, then after reaching the maximum number of
allowed retransmissions, the initiating UE shall abort the PC5 unicast link
establishment procedure and may notify the upper layer that no target UE is
available.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
If the need to establish a link no longer exists before the procedure is
completed, the initiating UE shall abort the procedure.
When the initiating UE aborts the PC5 unicast link establishment procedure,
the initiating UE shall provide the following information along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication to the lower layer:
a) an indication of deactivation of the PC5 unicast signalling security
protection for the PC5 unicast link, if applicable.
##### 6.1.2.2.6.2 Abnormal cases at the target UE {#abnormal-cases-at-the-
target-ue .H6}
For a received DIRECT LINK ESTABLISHMENT REQUEST message from a source layer-2
ID (for unicast communication), if the target UE already has an existing link
established to the UE known to use the same source layer-2 ID, the same source
user info, the same type of data (IP or non-IP) and the same security policy,
the UE shall process the new request. However, the target UE shall only delete
the existing link context after the new link establishment procedure succeeds.
NOTE: The type of data (e.g. IP or non-IP) is indicated by the optional IP
address configuration IE included in the corresponding DIRECT LINK SECURITY
MODE COMPLETE message, i.e the type of data for the requested link is IP type
if this IE is included, and the type of data for the requested link is non-IP
if this IE is not included.
#### 6.1.2.3 PC5 unicast link modification procedure
##### 6.1.2.3.1 General
The purpose of the PC5 unicast link modification procedure is to modify the
existing PC5 unicast link to:
a) add new PC5 QoS flow(s) to the existing PC5 unicast link;
b) modify existing PC5 QoS flow(s) for updating PC5 QoS parameters of the
existing PC5 QoS flow(s);
c) modify existing PC5 QoS flow(s) for associating new V2X service(s) with the
existing PC5 QoS flow(s);
d) modify existing PC5 QoS flow(s) for removing the associated V2X service(s)
from the existing PC5 QoS flow(s); or
e) remove existing PC5 QoS flow(s) from the existing PC5 unicast link.
In this procedure, the UE sending the DIRECT LINK MODIFICATION REQUEST message
is called the \"initiating UE\" and the other UE is called the \"target UE\".
##### 6.1.2.3.2 PC5 unicast link modification procedure initiated by
initiating UE
The initiating UE shall meet the following pre-conditions before initiating
this procedure for adding a new V2X service to the existing PC5 unicast link:
a) there is a PC5 unicast link between the initiating UE and the target UE;
and
b) the pair of application layer IDs and the network layer protocol of this
PC5 unicast link are identical to those required by the application layer in
the initiating UE for this V2X service.
c) the security policy corresponding to the V2X service identifier (e.g. ITS-
AID of the new V2X service) is aligned with the security policy of the
existing PC5 unicast link.
After receiving the service data or request from the upper layers, the
initiating UE shall perform the PC5 QoS flow match as apecified in clause
6.1.2.13. If there is no matched PC5 QoS flow, the initiating UE shall derive
the PC5 QoS parameters and assign the PQFI(s) for the PC5 QoS flows(s) to be
established as specified in clause 6.1.2.12.
If the PC5 unicast link modification procedure is to add new PC5 QoS flow(s)
to the existing PC5 unicast link, the initiating UE shall create a DIRECT LINK
MODIFICATION REQUEST message. In this message, initiating UE:
a) shall include the PQFI(s) and the corresponding PC5 QoS parameters,
including the V2X service identifier(s); and
b) shall include the link modification operation code set to \"add new PC5 QoS
flow(s) to the existing PC5 unicast link \".
If the PC5 unicast link modification procedure is to modify the PC5 QoS
parameters for existing PC5 QoS flow(s) in the existing PC5 unicast link, the
initiating UE shall create a DIRECT LINK MODIFICATION REQUEST message. In this
message, the initiating UE:
a) shall include the PQFI(s) and the corresponding PC5 QoS parameters,
including the V2X service identifier(s); and
b) shall include the link modification operation code set to \"modify PC5 QoS
parameters of the existing PC5 QoS flow(s)\".
If the PC5 unicast link modification procedure is to associate new V2X
service(s) with existing PC5 QoS flow(s), the initiating UE shall create a
DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:
a) shall include the PQFI(s) and the corresponding PC5 QoS parameters,
including the V2X service identifier(s); and
b) shall include the link modification operation code set to \"associate new
V2X service(s) with existing PC5 QoS flow(s)\".
If the PC5 unicast link modification procedure is to remove the associated V2X
service(s) from existing PC5 QoS flow(s), the initiating UE shall create a
DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:
a) shall include the PQFI(s) and the corresponding PC5 QoS parameters
including the V2X service identifier(s); and
b) shall include the link modification operation code set to \"remove V2X
service(s) from existing PC5 QoS flow(s)\".
If the PC5 unicast link modification procedure is to remove any PC5 QoS
flow(s) from the existing PC5 unicast link, the initiating UE shall create a
DIRECT LINK MODIFICATION REQUEST message. In this message, the initiating UE:
a) shall include the PQFI(s); and
b) shall include the link modification operation code set to \"remove existing
PC5 QoS flow(s) from the existing PC5 unicast link\".
After the DIRECT LINK MODIFICATION REQUEST message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s layer-2 ID for unicast communication and the
target UE\'s layer-2 ID for unicast communication, and start timer T5001. The
UE shall not send a new DIRECT LINK MODIFICATION REQUEST message to the same
target UE while timer T5001 is running.
Figure 6.1.2.3.2: PC5 unicast link modification procedure
##### 6.1.2.3.3 PC5 unicast link modification procedure accepted by the target
UE
If the DIRECT LINK MODIFICATION REQUEST message is accepted, the target UE
shall respond with the DIRECT LINK MODIFICATION ACCEPT message.
If the DIRECT LINK MODIFICATION REQUEST message is to add a new V2X service,
add new PC5 QoS flow(s) or modify any existing PC5 QoS flow(s) in the PC5
unicast link, the target UE shall include in the DIRECT LINK MODIFICATION
ACCEPT message:
a) the PQFI(s), the corresponding PC5 QoS parameters and the V2X service
identifier(s) that the target UE accepts.
If the DIRECT LINK MODIFICATION REQUEST message is to remove an existing V2X
service from the PC5 unicast link, the target UE shall delete the V2X service
identifier received in the DIRECT LINK MODIFICATION REQUEST message and the
corresponding PQFI(s) and PC5 QoS parameters from the profile associated with
the PC5 unicast link.
If the DIRECT LINK MODIFICATION REQUEST message is to remove existing PC5 QoS
flow(s) from the PC5 unicast link, the target UE shall delete the PQFI(s) and
the corresponding PC5 QoS parameters from the profile associated with the PC5
unicast link.
If the DIRECT LINK MODIFICATION REQUEST message is to add a new V2X service,
add new PC5 QoS flow(s) or modify any existing PC5 QoS flow(s) in the PC5
unicast link, after sending the DIRECT LINK MODIFICATION ACCEPT message, the
target UE shall provide the added or modified PQFI(s) and corresponding PC5
QoS parameters along with PC5 link identifier to the lower layer.
If the DIRECT LINK MODIFICATION REQUEST message is to remove an existing V2X
service or to remove the existing PC5 QoS flow(s) from the PC5 unicast link,
after sending the DIRECT LINK MODIFICATION ACCEPT message, the target UE shall
provide the removed PQFI(s) along with the PC5 link identifier to the lower
layer.
If the target UE accepts the PC5 unicast link modification request, then the
target UE may perform the PC5 QoS flow establishment over PC5 unicast link as
specified in clause 6.1.2.12 and perform the PC5 QoS flow match over PC5
unicast link as specified in clause 6.1.2.13.
##### 6.1.2.3.4 PC5 unicast link modification procedure completion by the
initiating UE
Upon receipt of the DIRECT LINK MODIFICATION ACCEPT message, the initiating UE
shall stop timer T5001.
Upon receipt of the DIRECT LINK MODIFICATION ACCEPT message, if the DIRECT
LINK MODIFICATION REQUEST message is to add a new V2X service, add new PC5 QoS
flow(s) or modify any existing PC5 QoS flow(s) in the PC5 unicast link, the
initiating UE shall provide the added or modified PQFI(s) and corresponding
PC5 QoS parameters along with PC5 link identifier to the lower layer.
Upon receipt of the DIRECT LINK MODIFICATION ACCEPT message, if the DIRECT
LINK MODIFICATION REQUEST message is to remove an existing V2X service or to
remove the existing PC5 QoS flow(s) from the PC5 unicast link, the initiating
UE shall provide the removed PQFI(s) along with the PC5 link identifier to the
lower layer.
In addition, the initiating UE may perform the PC5 QoS flow establishment over
PC5 unicast link as specified in clause 6.1.2.12.
##### 6.1.2.3.5 PC5 unicast link modification procedure not accepted by the
target UE
If the PC5 unicast link modification request cannot be accepted, the target UE
shall send a DIRECT LINK MODIFICATION REJECT message. The DIRECT LINK
MODIFICATION REJECT message contains a PC5 signalling protocol cause IE set to
one of the following cause values:
#5 lack of resources for PC5 unicast link;
#11 required service not allowed;
#12 security policy not aligned; or
#111 protocol error, unspecified.
If the target UE is not allowed to accept this request, .e.g. because the V2X
service to be added is not allowed per the operator policy or configuration
parameters for V2X communication over PC5 as specified in clause 5.2.3, the
target UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5
signalling protocol cause value #11 \"required service not allowed\".
If the PC5 unicast link modification fails due to the congestion problems or
other temporary lower layer problems causing resource constraints, the target
UE shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling
protocol cause value #5 \"lack of resources for PC5 unicast link\".
If the link modification operation code is set to \"associate new V2X
service(s) with existing PC5 QoS flow(s)\", and the security policy
corresponding to the V2X service identifier(s) (e.g. ITS-AID of the new V2X
service) is not aligned with the security policy applied to the existing PC5
unicast link, then the target UE shall send a DIRECT LINK MODIFICATION REJECT
message with PC5 signalling protocol cause value #12 \"security policy not
aligned\".
For other reasons causing the failure of link modification, the target UE
shall send a DIRECT LINK MODIFICATION REJECT message with PC5 signalling
protocol cause value #111 \"protocol error, unspecified\".
Upon receipt of the DIRECT LINK MODIFICATION REJECT message, the initiating UE
shall stop timer T5001 and abort the PC5 unicast link modification procedure.
If the PC5 signalling protocol cause value in the DIRECT LINK MODIFICATION
REJECT message is #11 \"required service not allowed\" or #5 \"lack of
resources for PC5 unicast link\" or #12 \"security policy not aligned\", then
the initiating UE shall not attempt to start PC5 unicast link modification
with the same target UE to add the same V2X service, or to add or modify the
same PC5 QoS flow(s) at least for a time period T.
NOTE: The length of time period T is UE implementation specific and can be
different for the case when the UE receives PC5 signalling protocol cause
value #11 \"required service not allowed\" or when the UE receives PC5
signalling protocol cause value #5 \"lack of resources for PC5 unicast link\"
or when the UE receives PC5 signalling protocol cause value #12 \"security
policy not aligned\",. The length of time period T is not less than 30
minutes.
##### 6.1.2.3.6 Abnormal cases at the initiating UE
The following abnormal cases can be identified:
a) If timer T5001 expires, the initiating UE shall retransmit the DIRECT LINK
MODIFICATION REQUEST message and restart timer T5001. After reaching the
maximum number of allowed retransmissions, the initiating UE shall abort the
PC5 unicast link modification procedure and may notify the upper layer that
the target UE is unreachable.
NOTE 1: The maximum number of allowed retransmissions is UE implementation
specific.
NOTE 2: After reaching the maximum number of allowed retransmissions, whether
the initiating UE releases this PC5 unicast link depends on its
implementation.
b) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
RELEASE message after the initiation of UE-requested PC5 unicast link
modification procedure, the initiating UE shall stop the timer T5001 and abort
the PC5 unicast link modification procedure and proceed with the PC5 unicast
link release procedure.
c) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
MODIFICATION REQUEST message during the PC5 unicast link modification
procedure, the initiating UE shall stop the timer T5001 and abort the PC5
unicast link modification procedure. Following handling is implementation
dependent, e.g., the initiating UE waits for an implementation dependent time
for initiating a new PC5 unicast link modification procedure, if still needed.
NOTE 3: The implementation dependent timer value needs to be set to avoid
further collisions (e.g. random timer value).
#### 6.1.2.4 PC5 unicast link release procedure
##### 6.1.2.4.1 General
The PC5 unicast link release procedure is used to release a PC5 unicast link
between two UEs. The link can be released from either end point. The UE
sending the DIRECT LINK RELEASE REQUEST message is called the \"initiating
UE\" and the other UE is called the \"target UE\".
If the UE receives an indication of radio link failure from the lower layer,
the UE shall release the PC5 unicast link locally and may delete the K~NRP~ ID
associated with this link after an implementation specific time.
##### 6.1.2.4.2 PC5 unicast link release procedure initiation by initiating UE
The initiating UE shall initiate the procedure if a request from upper layers
to release a PC5 unicast link with the target UE which uses a known layer-2 ID
(for unicast communication) is received and there is an existing PC5 unicast
link between these two UEs.
The initiating UE may initiate the procedure if the target UE has been non-
responsive, e.g. no response in the PC5 unicast link modification procedure,
PC5 unicast link identifier update procedure, PC5 unicast link re-keying
procedure or PC5 unicast link keep-alive procedure.
The initiating UE may initiate the procedure to release an established PC5
unicast link if the UE has reached the maximum number of established PC5
unicast links and there is a need to establish a new PC5 unicast link. In this
case, which PC5 unicast link is to be released is up to UE implementation.
The initiating UE may initiate the procedure to release an established PC5
unicast link upon expiry of the timer T5005.
In order to initiate the PC5 unicast link release procedure, the initiating UE
shall create a DIRECT LINK RELEASE REQUEST message with a PC5 signalling
protocol cause IE indicating one of the following cause values:
#1 direct communication with the target UE not allowed;
#2 direct communication to the target UE no longer needed;
#4 direct connection is not available anymore;
#5 lack of resources for PC5 unicast link; or
#111 protocol error, unspecified.
The initiating UE shall include the new MSB of K~NRP~ ID in the DIRECT LINK
RELEASE REQUEST message.
After the DIRECT LINK RELEASE REQUEST message is generated, the initiating UE
shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication, and shall stop T5011 if running. The
initiating UE shall start timer T5002.
Figure 6.1.2.4.2.1: PC5 unicast link release procedure
##### 6.1.2.4.3 PC5 unicast link release procedure accepted by the target UE
Upon receiving a DIRECT LINK RELEASE REQUEST message, the target UE shall stop
all running timers for this PC5 unicast link and abort any other ongoing PC5
signalling protocol procedures on this PC5 unicast link. The target UE shall
respond with a DIRECT LINK RELEASE ACCEPT message. The target UE shall include
the new LSB of K~NRP~ ID in the DIRECT LINK RELEASE ACCEPT message. After the
message is sent, the target UE shall release the PC5 unicast link by
performing the following behaviors:
a) inform the lower layer along with the PC5 link identifier that the PC5
unicast link has been released; and
b) delete the PC5 unicast link context of the PC5 unicast link after an
implementation specific time.
The target UE shall form the new K~NRP~ ID from the new MSB of K~NRP~ ID
received in the DIRECT LINK RELEASE REQUEST message and the new LSB of K~NRP~
ID included in the DIRECT LINK RELEASE ACCEPT message. The target UE shall
replace the existing K~NRP~ ID with the new K~NRP~ ID. The target UE may
include the new K~NRP~ ID in DIRECT LINK ESTABLISHMENT REQUEST message with
the initiating UE as specified in clause 6.1.2.2.2.
##### 6.1.2.4.4 PC5 unicast link release procedure completion by the
initiating UE
Upon receipt of the DIRECT LINK RELEASE ACCEPT message, the initiating UE
shall stop timer T5002 and shall release the PC5 unicast link by performing
the following behaviors:
a) inform the lower layer along with the PC5 link identifier that the PC5
unicast link has been released; and
b) delete the PC5 unicast link context of the PC5 unicast link after an
implementation specific time.
The initiating UE shall form the new K~NRP~ ID from the MSB of K~NRP~ ID
included in the DIRECT LINK RELEASE REQUEST message and the LSB of K~NRP~ ID
received in the DIRECT LINK RELEASE ACCEPT message. The initiating UE shall
replace the existing K~NRP~ ID with the new K~NRP~ ID. The initiating UE may
include the new K~NRP~ ID in DIRECT LINK ESTABLISHMENT REQUEST message with
the target UE as specified in clause 6.1.2.2.2.
##### 6.1.2.4.5 Abnormal cases
##### 6.1.2.4.5.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue-2 .H6}
If retransmission timer T5002 expires and the PC5 signalling protocol cause
included in the PC5 signalling protocol cause IE in the DIRECT LINK RELEASE
REQUEST message was #4 \"direct connection is not available anymore\", the
initiating UE shall release the PC5 unicast link locally and delete the K~NRP~
ID associated with this link. From this time onward the initiating UE shall no
longer send or receive any messages via this link.
If retransmission timer T5002 expires and the PC5 signalling protocol cause
included in the PC5 signalling protocol cause IE in the DIRECT LINK RELEASE
REQUEST message was not #4 \"direct connection is not available anymore\", the
initiating UE shall initiate the transmission of the DIRECT LINK RELEASE
REQUEST message again and restart timer T5002.
If no response is received from the target UE after reaching the maximum
number of allowed retransmissions, the initiating UE shall release the PC5
unicast link locally and delete the K~NRP~ ID associated with this link. From
this time onward the initiating UE shall no longer send or receive any
messages via this link.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
#### 6.1.2.5 PC5 unicast link identifier update procedure
##### 6.1.2.5.1 General
The PC5 unicast link identifier update procedure is used to update and
exchange the new identifiers (e.g. application layer ID, layer-2 ID, security
information and IP address/prefix) between two UEs for a PC5 unicast link
before using the new identifiers. The UE sending the DIRECT LINK IDENTIFIER
UPDATE REQUEST message is called the \"initiating UE\" and the other UE is
called the \"target UE\".
##### 6.1.2.5.2 PC5 unicast link identifier update procedure initiation by
initiating UE
The initiating UE shall initiate the procedure if:
a) the initiating UE receives a request from upper layers to change the
application layer ID and there is an existing PC5 unicast link associated with
this application layer ID; or
b) the privacy timer (see clause 5.2.3) of the initiating UE\'s layer-2 ID
expires for an existing PC5 unicast link.
If the PC5 unicast link identifier update procedure is triggered by a change
of the initiating UE\'s application layer ID, the initiating UE shall create a
DIRECT LINK IDENTIFIER UPDATE REQUEST message. In this message, the initiating
UE
a) shall include the initiating UE\'s new application layer ID received from
upper layer;
b) shall include the initiating UE\'s new layer-2 ID assigned by itself;
c) shall include the new MSB of K~NRP-sess~ ID, or set to all zeros if the
selected integrity protection algorithm is the null integrity protection
algorithm; and
d) shall include the new IP address/prefix if IP communication is used.
If the PC5 unicast link identifier update procedure is triggered by the expiry
of the initiating UE\'s privacy timer T5011 as specified in clause 5.2.3, the
initiating UE shall create a DIRECT LINK IDENTIFIER UPDATE REQUEST message. In
this message, the initiating UE
a) shall include the initiating UE\'s new layer-2 ID assigned by itself;
b) shall include the new MSB of K~NRP-sess~ ID;
c) may include the initiating UE\'s new application layer ID if received from
upper layer; and
d) shall include the new IP address/prefix if IP communication is used and
changed.
After the DIRECT LINK IDENTIFIER UPDATE REQUEST message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s old layer-2 ID for unicast communication and
the target UE\'s layer-2 ID for unicast communication, and start timer T5009.
The UE shall not send a new DIRECT LINK IDENTIFIER UPDATE REQUEST message to
the same target UE while timer T5009 is running.
Figure 6.1.2.5.2.1: PC5 unicast link identifier update procedure
##### 6.1.2.5.3 PC5 unicast link identifier update procedure accepted by the
target UE
Upon receipt of a DIRECT LINK IDENTIFIER UPDATE REQUEST message, if the target
UE determines:
a) the PC5 unicast link associated with this request message is still valid;
and
b) the timer T5010 for the PC5 unicast link identified by this request message
is not running,
then the target UE accepts this request, and responds with a DIRECT LINK
IDENTIFIER UPDATE ACCEPT message.
The target UE shall create the DIRECT LINK IDENTIFIER UPDATE ACCEPT message.
In this message, the target UE:
a) shall include the target UE\'s new layer-2 ID assigned by itself;
b) shall include the new LSB of K~NRP-sess~ ID;
c) shall include the initiating UE\'s new MSB of K~NRP-sess~ ID;
d) shall include the initiating UE\'s new layer-2 ID;
e) shall include the target UE\'s new application layer ID if received from
upper layer;
f) shall include the initiating UE\'s new IP address/prefix if received from
the initiating UE and IP communication is used;
g) shall include the initiating UE\'s new application layer ID if received
from the initiating UE; and
h) shall include the target UE\'s new IP address/prefix if IP communication is
used and changed.
After the DIRECT LINK IDENTIFIER UPDATE ACCEPT message is generated, the
target UE shall pass this message to the lower layers for transmission along
with the initiating UE\'s old layer-2 ID for unicast communication and the
target UE\'s old layer-2 ID for unicast communication, and start timer T5010.
The UE shall not send a new DIRECT LINK IDENTIFIER UPDATE ACCEPT message to
the same initiating UE while timer T5010 is running.
Before target UE receives the traffic using the new layer-2 IDs, the target UE
shall continue to receive the traffic with the old layer-2 IDs (i.e.
initiating UE\'s old layer-2 ID and target UE\'s old layer-2 ID) from
initiating UE.
Before target UE receives the DIRECT LINK IDENTIFIER UPDATE ACK message from
initiating UE, the target UE shall keep sending traffic to the initiating UE
using the old layer-2 IDs (i.e. initiating UE\'s old layer-2 ID for unicast
communication and target UE\'s old layer-2 ID for unicast communication).
##### 6.1.2.5.4 PC5 unicast link identifier update procedure acknowledged by
the initiating UE
Upon receipt of the DIRECT LINK IDENTIFIER UPDATE ACCEPT message, the
initiating UE shall stop timer T5009 and respond with a DIRECT LINK IDENTIFIER
UPDATE ACK message. In this message, the initiating UE:
a) shall include the target UE\'s new layer-2 ID;
b) shall include the target UE\'s new LSB of K~NRP-sess~ ID;
c) shall include the target UE\'s new application layer ID, if received; and
d) shall include the target UE\'s new IP address/prefix, if received.
After the DIRECT LINK IDENTIFIER UPDATE ACK message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s old layer-2 ID for unicast communication and
the target UE\'s old layer-2 ID for unicast communication and shall stop timer
T5011 if running and start a timer T5011 as configured if at least one of V2X
service identifiers for the PC5 unicast link satisfying the privacy
requirements as specified in clause 5.2.3.
Upon sending the DIRECT LINK IDENTIFIER UPDATE ACK message, the initiating UE
shall update the associated PC5 unicast link context with the new identifiers
and pass the new layer-2 IDs (i.e. initiating UE\'s new layer-2 ID for unicast
communication and target UE\'s new layer-2 ID for unicast communication if
changed) along with the PC5 link identifier down to the lower layer. Then the
initiating UE shall use the new layer-2 IDs (i.e. initiating UE\'s new layer-2
ID for unicast communication and target UE\'s new layer-2 ID for unicast
communication if changed) to transmit the PC5 signalling message and PC5 user
plane data.
The initiating UE shall continue to receive traffic with the old layer-2 IDs
(i.e. initiating UE\'s old layer-2 ID for unicast communication and target
UE\'s old layer-2 ID for unicast communication) from the target UE until it
receives traffic with the new layer-2 IDs (i.e. initiating UE\'s new layer-2
ID and target UE\'s new layer-2 ID if changed) from the target UE.
##### 6.1.2.5.5 PC5 unicast link identifier update procedure completion by the
target UE
Upon receipt of the DIRECT LINK IDENTIFIER UPDATE ACK message, the target UE
shall update the associated PC5 unicast link context with the new identifiers,
pass the new layer-2 IDs (i.e. initiating UE\'s new layer-2 ID and target
UE\'s new layer-2 ID if changed) down to the lower layer, stop timer T5010 and
timer T5011 if running and start a timer T5011 as configured if at least one
of V2X service identifiers for the PC5 unicast link satisfying the privacy
requirements as specified in clause 5.2.3. Then the target UE shall use the
new layer-2 IDs (i.e. initiating UE\'s new layer-2 ID for unicast
communication and target UE\'s new layer-2 ID for unicast communication if
changed) to transmit the PC5 signalling message and PC5 user plane data.
##### 6.1.2.5.6 PC5 unicast link identifier update procedure not accepted by
the target UE
If the DIRECT LINK IDENTIFIER UPDATE REQUEST message cannot be accepted, the
target UE shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message. The
DIRECT LINK IDENTIFIER UPDATE REJECT message contains a PC5 signalling
protocol cause IE set to one of the following cause values:
#3 conflict of layer-2 ID for unicast communication is detected; or
#111 protocol error, unspecified.
For a received DIRECT LINK IDENTIFIER UPDATE REQUEST message from a layer-2 ID
(for unicast communication), if the target UE already has an existing link
using this layer-2 ID or is currently processing a DIRECT LINK IDENTIFIER
UPDATE REQUEST message from the same layer-2 ID, but with user info different
from the user info IE included in this new incoming message, the target UE
shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message with PC5 signalling
protocol cause value #3 \"conflict of layer-2 ID for unicast communication is
detected\".
NOTE: After receiving the DIRECT LINK IDENTIFIER UPDATE REJECT message,
whether the initiating UE initiates the PC5 unicast link release procedure or
initiates another PC5 unicast link identifier update procedure with a new
layer-2 ID depends on UE implementation.
For other reasons causing the failure of link identifier update, the target UE
shall send a DIRECT LINK IDENTIFIER UPDATE REJECT message with PC5 signalling
protocol cause value #111 \"protocol error, unspecified\".
Upon receipt of the DIRECT LINK IDENTIFIER UPDATE REJECT message, the
initiating UE shall stop timer T5009 and abort this PC5 unicast link
identifier update procedure.
##### 6.1.2.5.7 Abnormal cases
##### 6.1.2.5.7.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue-3 .H6}
The following abnormal cases can be identified:
a) If timer T5009 expires, the initiating UE shall retransmit the DIRECT LINK
IDENTIFIER UPDATE REQUEST message and restart timer T5009. After reaching the
maximum number of allowed retransmissions, the initiating UE shall abort the
PC5 unicast link identifier update procedure and may notify the upper layer
that the target UE is unreachable.
NOTE 1: The maximum number of allowed retransmissions is UE implementation
specific.
NOTE 2: After reaching the maximum number of allowed retransmissions, whether
the initiating UE releases this PC5 unicast link depends on its
implementation.
b) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
IDENTIFIER UPDATE REQUEST message during the PC5 unicast link identifier
update procedure, the initiating UE shall stop the timer T5009 and abort the
PC5 unicast link identifier update procedure. Following handling is
implementation dependent, e.g., the initiating UE waits for an implementation
dependent time for initiating a new PC5 unicast link identifier update
procedure, if still needed.
NOTE 3: The implementation dependent timer value needs to be set to avoid
further collisions (e.g. random timer value).
c) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
REKEYING REQUEST message after initiating the PC5 unicast link identifier
update procedure, the initiating UE shall ignore the DIRECT LINK REKEYING
REQUEST message and proceed with the PC5 unicast link identifier update
procedure.
d) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
RELEASE REQUEST message after the initiation of PC5 unicast link identifier
update procedure, the initiating UE shall stop the timer T5009 and abort the
PC5 unicast link identifier update procedure and proceed with the PC5 unicast
link release procedure.
##### 6.1.2.5.7.2 Abnormal cases at the target UE {#abnormal-cases-at-the-
target-ue-1 .H6}
The following abnormal cases can be identified:
a) If timer T5010 expires, the target UE shall retransmit the DIRECT LINK
IDENTIFIER UPDATE ACCEPT message and restart timer T5010. After reaching the
maximum number of allowed retransmissions, the target UE shall abort the PC5
unicast link identifier update procedure and may notify the upper layer that
the initiating UE is unreachable.
NOTE 1: The maximum number of allowed retransmissions is UE implementation
specific.
NOTE 2: After reaching the maximum number of allowed retransmissions, whether
the target UE releases this PC5 unicast link depends on its implementation.
b) If DIRECT LINK IDENTIFIER UPDATE REQUEST is received when the timer T5010
is running, the target UE shall stop the timer T5010 and abort the ongoing PC5
unicast link identifier update procedure. The target UE shall handle the new
DIRECT LINK IDENTIFIER UPDATE REQUEST as specified in clause 6.1.2.5.3.
#### 6.1.2.6 PC5 unicast link authentication procedure
##### 6.1.2.6.1 General
The PC5 unicast link authentication procedure is used to perform mutual
authentication of UEs establishing a PC5 unicast link and to derive a new
K~NRP~ shared between two UEs during a PC5 unicast link establishment
procedure or a PC5 unicast link re-keying procedure. After successful
completion of the PC5 unicast link authentication procedure, the new K~NRP~ is
used for security establishment during the PC5 unicast link security mode
control procedure as specified in clause 6.1.2.7. The UE sending the DIRECT
LINK AUTHENTICATION REQUEST message is called the \"initiating UE\" and the
other UE is called the \"target UE\".
##### 6.1.2.6.2 PC5 unicast link authentication procedure initiation by the
initiating UE
The initiating UE shall meet one of the following pre-conditions if signalling
integrity protection is activated based on the decision of the initiating UE,
before initiating the PC5 unicast link authentication procedure:
a) the target UE has initiated a PC5 unicast link establishment procedure
toward the initiating UE by sending a DIRECT LINK ESTABLISHMENT REQUEST
message and:
1) the DIRECT LINK ESTABLISHMENT REQUEST message:
i) includes a target user info IE which includes the application layer ID of
the initiating UE; or
ii) does not include a target user info IE and the initiating UE is interested
in the V2X service identified by the V2X service identifier in the DIRECT LINK
ESTABLISHMENT REQUEST message; and
2) the K~NRP~ ID is not included in the DIRECT LINK ESTABLISHMENT REQUEST
message or the initiating UE does not have an existing K~NRP~ for the K~NRP~
ID included in DIRECT LINK ESTABLISHMENT REQUEST message or the initiating UE
derives a new K~NRP~; or
b) the target UE has initiated a PC5 unicast link re-keying procedure toward
the initiating UE by sending a DIRECT LINK REKEYING REQUEST message and the
DIRECT LINK REKEYING REQUEST message includes a Re-authentication indication.
In order to initiate the PC5 unicast link authentication procedure, the
initiating UE shall create a DIRECT LINK AUTHENTICATION REQUEST message. In
this message, the initiating UE:
a) shall include the key establishment information container IE.
NOTE: The Key establishment information container is provided by upper layers.
After the DIRECT LINK AUTHENTICATION REQUEST message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s layer-2 ID for unicast communication and the
target UE\'s layer-2 ID for unicast communication.
The initiating UE shall start timer T5006. The UE shall not send a new DIRECT
LINK AUTHENTICATION REQUEST message to the same target UE while timer T5006 is
running.
Figure 6.1.2.6.2: PC5 unicast link authentication procedure
##### 6.1.2.6.3 PC5 unicast link authentication procedure accepted by the
target UE
Upon receipt of a DIRECT LINK AUTHENTICATION REQUEST message, if a new
assigned initiating UE\'s layer-2 ID is included, the target UE shall replace
the original initiating UE\'s layer-2 ID with the new assigned initiating
UE\'s layer-2 ID for unicast communication. If the target UE determines that
the DIRECT LINK AUTHENTICATION REQUEST message can be accepted, the target UE
shall create a DIRECT LINK AUTHENTICATION RESPONSE message. The target UE
shall check if the number of established PC5 unicast links is less than the
implementation-specific maximum number of established NR PC5 unicast links
allowed in the UE at a time. In this message, the target UE:
a) shall include the Key establishment information container IE.
NOTE: The key establishment information container is provided by upper layers.
After the DIRECT LINK AUTHENTICATION RESPONSE message is generated, the target
UE shall pass this message to the lower layers for transmission along with the
target UE\'s layer-2 ID for unicast communication and the initiating UE\'s
layer-2 ID for unicast communication.
##### 6.1.2.6.4 PC5 unicast link authentication procedure completion by the
initiating UE
Upon receiving a DIRECT LINK AUTHENTICATION RESPONSE message, if the
initiating UE determines that the DIRECT LINK AUTHENTICATION RESPONSE message
can be accepted, the initiating UE shall stop timer T5006.
NOTE: When the initiating UE derives the new K~NRP~ during the PC5 unicast
link authentication procedure depends on the authentication method in use.
##### 6.1.2.6.5 PC5 unicast link authentication procedure not accepted by the
target UE
If the DIRECT LINK AUTHENTICATION REQUEST message cannot be accepted, the
target UE shall create a DIRECT LINK AUTHENTICATION REJECT message. In this
message, the target UE shall include a PC5 signaling protocol cause IE
indicating one of the following cause values:
#6: authentication failure;
#5: lack of resources for PC5 unicast link.
If this PC5 unicast link authentication procedure is triggered during the PC5
unicast link establishment procedure and the implementation-specific maximum
number of established NR PC5 unicast links has been reached, then the target
UE shall send a DIRECT LINK AUTHENTICATION REJECT message containing PC5
signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".
After the DIRECT LINK AUTHENTICATION REJECT message is generated, the target
UE shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication.
The target UE shall abort the ongoing procedure that triggered the initiation
of the PC5 unicast link authentication procedure if the ongoing procedure is
the PC5 unicast link establishment procedure and the Target user info is
included in the DIRECT LINK ESTABLISHMENT REQUEST message.
Upon receipt of the DIRECT LINK AUTHENTICATION REJECT message, the initiating
UE shall stop timer T5006 and abort the ongoing procedure that triggered the
initiation of the PC5 unicast link authentication procedure.
##### 6.1.2.6.5A PC5 unicast link authentication procedure not accepted by the
initiating UE
If the DIRECT LINK AUTHENTICATION RESPONSE message cannot be accepted, the
initiating UE shall stop timer T5006 and create a DIRECT LINK AUTHENTICATION
FAILURE message. In this message, the initiating UE may include the Key
establishment information container IE if provided by upper layers.
After the DIRECT LINK AUTHENTICATION FAILURE message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s layer-2 ID for unicast communication and the
target UE\'s layer-2 ID for unicast communication.
The initiating UE shall abort the ongoing procedure that triggered the
initiation of the PC5 unicast link authentication procedure.
Upon receipt of the DIRECT LINK AUTHENTICATION FAILURE message and if the PC5
unicast link authentication procedure was initiated due to a PC5 unicast link
establishment procedure that includes a Target user info in the DIRECT LINK
ESTABLISHMENT REQUEST message, the target UE shall abort the ongoing procedure
that triggered the initiation of the PC5 unicast link authentication procedure
and shall indicate to upper layers that authentication has failed.
##### 6.1.2.6.6 Abnormal cases
##### 6.1.2.6.6.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue-4 .H6}
a) Timer T5006 expires.
The initiating UE shall retransmit the DIRECT LINK AUTHENTICATION REQUEST
message and restart timer T5006. After reaching the maximum number of allowed
retransmissions, the initiating UE shall abort the PC5 unicast link
authentication procedure and shall abort the ongoing procedure that triggered
the initiation of the PC5 unicast link authentication procedure.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
b) The need to use this PC5 unicast link no longer exists before the PC5
unicast link authentication procedure is completed.
The initiating UE shall abort the procedure and shall abort the ongoing
procedure that triggered the initiation of the PC5 unicast link authentication
procedure.
#### 6.1.2.7 PC5 unicast link security mode control procedure
##### 6.1.2.7.1 General
The PC5 unicast link security mode control procedure is used to establish
security between two UEs during a PC5 unicast link establishment procedure or
a PC5 unicast link re-keying procedure.. After successful completion of the
PC5 unicast link security mode control procedure, the selected security
algorithms and keys are used to integrity protect and cipher all PC5
signalling messages exchanged over this PC5 unicast link between the UEs and
the security context can be used to protect all PC5 user plane data exchanged
over this PC5 unicast link between the UEs. The UE sending the DIRECT LINK
SECURITY MODE COMMAND message is called the \"initiating UE\" and the other UE
is called the \"target UE\".
##### 6.1.2.7.2 PC5 unicast link security mode control procedure initiation by
the initiating UE
The initiating UE shall meet the following pre-conditions before initiating
the PC5 unicast link security mode control procedure:
a) the target UE has initiated a PC5 unicast link establishment procedure
toward the initiating UE by sending a DIRECT LINK ESTABLISHMENT REQUEST
message and:
1) the DIRECT LINK ESTABLISHMENT REQUEST message:
i) includes a target user info IE which includes the application layer ID of
the initiating UE; or
ii) does not include a target user info IE and the initiating UE is interested
in the V2X service identified by the V2X service identifier in the DIRECT LINK
ESTABLISHMENT REQUEST message; and
2) the initiating UE:
i) has either identified an existing K~NRP~ based on the K~NRP~ ID included in
the DIRECT LINK ESTABLISHMENT REQUEST message or derived a new K~NRP~; or
ii) has decided not to activate security protection based on its UE PC5
unicast signalling security policy and the target UE\'s PC5 unicast signalling
security policy; or
b) the target UE has initiated a PC5 unicast link re-keying procedure toward
the initiating UE by sending a DIRECT LINK REKEYING REQUEST message and:
1) if the target UE has included a Re-authentication indication in the DIRECT
LINK REKEYING REQUEST message, the initiating UE has derived a new K~NRP~.
If a new K~NRP~ has been derived by the initiating UE, the initiating UE shall
generate the 16 MSBs of K~NRP~ ID to ensure that the resultant K~NRP~ ID will
be unique in the initiating UE.
The initiating UE shall select security algorithms in accordance with its UE
PC5 unicast signalling security policy and the target UE\'s PC5 unicast
signalling security policy. If the PC5 unicast link security mode control
procedure was triggered during a PC5 unicast link establishment procedure, the
initiating UE shall not select the null integrity protection algorithm if the
initiating UE or the target UE\'s PC5 unicast signalling integrity protection
policy is set to \"signalling integrity protection required\". If the PC5
unicast link security mode control procedure was triggered during a PC5
unicast link re-keying procedure, the initiating UE:
a) shall not select the null integrity protection algorithm if the integrity
protection algorithm currently in use for the PC5 unicast link is different
from the null integrity protection algorithm;
b) shall not select the null ciphering protection algorithm if the ciphering
protection algorithm currently in use for the PC5 unicast link is different
from the null ciphering protection algorithm;
c) shall select the null integrity protection algorithm if the integrity
protection algorithm currently in use is the null integrity protection
algorithm; and
d) shall select the null ciphering protection algorithm if the ciphering
protection algorithm currently in use is the null ciphering protection
algorithm.
Then the initiating UE shall:
a) generate a 128-bit Nonce_2 value;
b) derive K~NRP-sess~ from K~NRP~, Nonce_2 and Nonce_1 received in the DIRECT
LINK ESTABLISHMENT REQUEST message as specified in 3GPP TS 33.536 [20];
c) derive the NR PC5 encryption key NRPEK and the NR PC5 integrity key NRPIK
from K~NRP-sess~ and the selected security algorithms as specified in 3GPP TS
33.536 [20], and
d) create a DIRECT LINK SECURITY MODE COMMAND message. In this message, the
initiating UE:
1) shall include the key establishment information container IE if a new
K~NRP~ has been derived at the initiating UE and the authentication method
used to generate K~NRP~ requires sending information to complete the
authentication procedure;
NOTE: The key establishment information container is provided by upper layers.
2) shall include the MSBs of K~NRP~ ID IE if a new K~NRP~ has been derived at
the initiating UE;
3) shall include a Nonce_2 IE set to the 128-bit nonce value generated by the
initiating UE for the purpose of session key establishment over this PC5
unicast link if the selected integrity protection algorithms is not the null
integrity protection algorithm;
4) shall include the selected security algorithms;
5) shall include the UE security capabilities received from the target UE in
the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST
message;
6) shall include the UE PC5 unicast signalling security policy received from
the target UE in the DIRECT LINK ESTABLISHMENT REQUEST message; and
7) shall include the 8 LSBs of K~NRP-sess~ ID chosen by the initiating UE as
specified in 3GPP TS 33.536 [20] if the selected integrity protection
algorithms is not the null integrity protection algorithm.
If the security protection of this PC5 unicast link is activated, the
initiating UE shall form the K~NRP-sess~ ID from the 8 MSBs of K~NRP-sess~ ID
received in the DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK
REKEYING REQUEST message and the 8 LSBs of K~NRP-sess~ ID included in the
DIRECT LINK SECURITY MODE COMMAND message.
After the DIRECT LINK SECURITY MODE COMMAND message is generated, the
initiating UE shall pass this message to the lower layers for transmission
along with the initiating UE\'s layer-2 ID for unicast communication and the
target UE\'s layer-2 ID for unicast communication, NRPIK, NRPEK if applicable,
K~NRP-sess~ ID, the selected security algorithm as specified in TS 33.536
[20]; an indication of activation of the PC5 unicast signalling security
protection for the PC5 unicast link with the new security context, if
applicable, and start timer T5007. The initiating UE shall not send a new
DIRECT LINK SECURITY MODE COMMAND message to the same target UE while timer
T5007 is running.
NOTE: The DIRECT LINK SECURITY MODE COMMAND message is integrity protected
(and not ciphered) at the lower layer using the new security context.
If the PC5 unicast link security mode control procedure was triggered during a
PC5 unicast link re-keying procedure, the initiating UE shall provide to the
lower layers an indication of activation of the PC5 unicast user plane
security protection for the PC5 unicast link with the new security context, if
applicable, along with the initiating UE\'s layer-2 ID for unicast
communication and the target UE\'s layer-2 ID for unicast communication.
Figure 6.1.2.7.2: PC5 unicast link security mode control procedure
##### 6.1.2.7.3 PC5 unicast link security mode control procedure accepted by
the target UE
Upon receipt of a DIRECT LINK SECURITY MODE COMMAND message, if a new assigned
initiating UE\'s layer-2 ID is included and if the authentication procedure
has not been executed, the target UE shall replace the original initiating
UE\'s layer-2 ID with the new assigned initiating UE\'s layer-2 ID for unicast
communication. The target UE shall check the selected security algorithms IE
included in the DIRECT LINK SECURITY MODE COMMAND message. If \"null integrity
algorithm\" is included in the selected security algorithms IE, the PC5
unicast link is unsecured. If \"null ciphering algorithm\" and an integrity
algorithm other than \"null integrity algorithm\" are included in the selected
algorithms IE, the signalling ciphering protection is not activated. If the
target UE\'s PC5 unicast signalling integrity protection policy is set to
\"signalling integrity protection required\", the target UE shall check the
selected security algorithms IE in the DIRECT LINK SECURITY MODE COMMAND
message does not include the null integrity protection algorithm. If the
selected integrity protection algorithm is not the null integrity protection
algorithm, the target UE shall:
a) derive K~NRP-sess~ from K~NRP~, Nonce_1 and Nonce_2 received in the DIRECT
LINK SECURITY MODE COMMAND message as specified in 3GPP TS 33.536 [20]; and
b) derive NRPIK from K~NRP-sess~ and the selected integrity algorithm as
specified in 3GPP TS 33.536 [20].
If the K~NRP-sess~ is derived and the selected ciphering protection algorithm
is not the null ciphering protection algorithm, then the target UE shall
derive NRPEK from K~NRP-sess~ and the selected ciphering algorithm as
specified in 3GPP TS 33.536 [20].
The target UE shall determine whether or not the DIRECT LINK SECURITY MODE
COMMAND message can be accepted by:
a) checking that the selected security algorithms in the DIRECT LINK SECURITY
MODE COMMAND message does not include the null integrity protection algorithm
if the target UE\'s PC5 unicast signalling integrity protection policy is set
to \"signalling integrity protection required\";
b) asking the lower layers to check the integrity of the DIRECT LINK SECURITY
MODE COMMAND message using NRPIK and the selected integrity protection
algorithm, if the selected integrity protection algorithm is not the null
integrity protection algorithm;
c) checking that the received UE security capabilities have not been altered
compared to the values that the target UE sent to the initiating UE in the
DIRECT LINK ESTABLISHMENT REQUEST message or DIRECT LINK REKEYING REQUEST
message;
d) if the PC5 unicast link security mode control procedure was triggered
during a PC5 unicast link establishment procedure,
1) checking that the received UE PC5 unicast signalling security policy has
not been altered compared to the values that the target UE sent to the
initiating UE in the DIRECT LINK ESTABLISHMENT REQUEST message; and
2) checking that the 8 LSBs of K~NRP-sess~ ID included in the DIRECT LINK
SECURITY MODE COMMAND message are not set to the same value as those received
from another UE in response to the target UE\'s DIRECT LINK ESTABLISHMENT
REQUEST message; and
e) if the PC5 unicast link security mode control procedure was triggered
during a PC5 unicast link re-keying procedure and the integrity protection
algorithm currently in use for the PC5 unicast link is different from the null
integrity protection algorithm, checking that the selected security algorithms
in the DIRECT LINK SECURITY MODE COMMAND message do not include the null
integrity protection algorithm.
If the target UE did not include a K~NRP~ ID in the DIRECT LINK ESTABLISHMENT
REQUEST message, the target UE included a Re-authentication indication in the
DIRECT LINK REKEYING REQUEST message or the initiating UE has chosen to derive
a new K~NRP~, the target UE shall derive K~NRP~ as specified in 3GPP TS 33.536
[20]. The target UE shall choose the 16 LSBs of K~NRP~ ID to ensure that the
resultant K~NRP~ ID will be unique in the target UE. The target UE shall form
K~NRP~ ID from the received MSBs of K~NRP~ ID and its chosen LSBs of K~NRP~ ID
and shall store the complete K~NRP~ ID with K~NRP~.
If the target UE accepts the DIRECT LINK SECURITY MODE COMMAND message, the
target UE shall create a DIRECT LINK SECURITY MODE COMPLETE message. In this
message, the target UE:
a) shall include the PQFI and the corresponding PC5 QoS parameters;
b) if IP communication is used and the PC5 unicast link security mode control
procedure was triggered during a PC5 unicast link establishment procedure,
shall include an IP address configuration IE set to one of the following
values:
1) \"IPv6 router\" if IPv6 address allocation mechanism is supported by the
target UE, i.e. acting as an IPv6 router; or
2) \"IPv6 address allocation not supported\" if IPv6 address allocation
mechanism is not supported by the target UE;
c) if IP communication is used, the IP address configuration IE is set to
\"IPv6 address allocation not supported\" and the PC5 unicast link security
mode control procedure was triggered during a PC5 unicast link establishment
procedure, shall include a link local IPv6 address IE formed locally based on
IETF RFC 4862 [6];
d) if a new K~NRP~ was derived, shall include the 16 LSBs of K~NRP~ ID; and
e) if the PC5 unicast link security mode control procedure was triggered
during a PC5 unicast link establishment procedure, shall include its UE PC5
unicast user plane security policy for this PC5 unicast link. In the case
where the different V2X services are mapped to the different PC5 unicast user
plane security policies, when more than one V2X service identifier is included
in the DIRECT LINK ESTABLISHMENT REQUEST message, each of the user plane
security polices of those V2X services shall be compatible, e.g. \"user plane
integrity protection not needed\" and \" user plane integrity protection
required\" are not compatible.
If the selected integrity protection algorithm is not the null integrity
protection algorithm, the target UE shall form the K~NRP-sess~ ID from the 8
MSBs of K~NRP-sess~ ID it had sent in the DIRECT LINK ESTABLISHMENT REQUEST
message or DIRECT LINK REKEYING REQUEST message and the 8 LSBs of K~NRP-sess~
ID received in the DIRECT LINK SECURITY MODE COMMAND message.
After the DIRECT LINK SECURITY MODE COMPLETE message is generated, the target
UE shall pass this message to the lower layers for transmission along with the
target UE\'s layer-2 ID for unicast communication and the initiating UE\'s
layer-2 ID for unicast communication, NRPIK, NRPEK if applicable, K~NRP-sess~
ID, the selected security algorithm as specified in TS 33.536 [20] , and an
indication of activation of the PC5 unicast signalling security protection for
the PC5 unicast link with the new security context, if applicable.
NOTE: The DIRECT LINK SECURITY MODE COMPLETE message and further PC5 unicast
signalling messages are integrity protected and ciphered (if applicable) at
the lower layer using the new security context.
If the PC5 unicast link security mode control procedure was triggered during a
PC5 unicast link re-keying procedure, the target UE shall provide to the lower
layers an indication of activation of the PC5 unicast user plane security
protection for the PC5 unicast link with the new security context, if
applicable, along with the initiating UE\'s layer-2 ID for unicast
communication and the target UE\'s layer-2 ID for unicast communication.
##### 6.1.2.7.4 PC5 unicast link security mode control procedure completion by
the initiating UE
Upon receiving a DIRECT LINK SECURITY MODE COMPLETE message, the initiating UE
shall stop timer T5007. If the selected integrity protection algorithm is not
the null integrity protection algorithm, the UE checks the integrity of the
DIRECT LINK SECURITY MODE COMPLETE message. If the integrity check passes, the
initiating UE shall then continue the procedure which triggered the PC5
unicast link security mode control procedure. If the selected integrity
protection algorithm is the null integrity protection algorithm, the UE
continues the procedure without checking the integrity protection.
After receiving the DIRECT LINK SECURITY MODE COMPLETE message, the initiating
UE shall delete the old security context it has for the target UE.
##### 6.1.2.7.5 PC5 unicast link security mode control procedure not accepted
by the target UE
If the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted, the
target UE shall send a DIRECT LINK SECURITY MODE REJECT message, and the
target UE shall abort the ongoing procedure that triggered the initiation of
the PC5 unicast link security mode control procedure unless the ongoing
procedure is a PC5 unicast link establishment procedure and the Target user
info is not included in the DIRECT LINK ESTABLISHMENT REQUEST message. The
DIRECT LINK SECURITY MODE REJECT message contains a PC5 signalling protocol
cause IE indicating one of the following cause values:
#6: authentication failure;
#7: integrity failure;
#8: UE security capabilities mismatch;
#9: LSBs of K~NRP-sess~ ID conflict;
#10: UE PC5 unicast signalling security policy mismatch;
#5 lack of resources for PC5 unicast link; or
#111: protocol error, unspecified.
If this PC5 unicast link security mode control procedure is triggered during
the PC5 unicast link establishment procedure and the implementation-specific
maximum number of established NR PC5 unicast links has been reached, then the
target UE shall send a DIRECT LINK SECURITY MODE REJECT message containing PC5
signalling protocol cause value #5 \"lack of resources for PC5 unicast link\".
If the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted because
the PC5 unicast link security mode control procedure was triggered during a
PC5 unicast link establishment procedure, that the selected security
algorithms in the DIRECT LINK SECURITY MODE COMMAND message included the null
integrity protection algorithm and the target UE\'s PC5 unicast signalling
integrity protection policy is set to \"signalling integrity protection
required\", the target UE shall include PC5 signalling protocol cause #10 \"UE
PC5 unicast signalling security policy mismatch\" in the SECURITY MODE REJECT
message.
If the DIRECT LINK SECURITY MODE COMMAND message cannot be accepted because
the PC5 unicast link security mode control procedure was triggered during a
PC5 unicast link re-keying procedure, the integrity protection algorithm
currently in use for the PC5 unicast link is different from the null integrity
protection algorithm and the selected security algorithms in the DIRECT LINK
SECURITY MODE COMMAND message include the null integrity protection algorithm,
the target UE, the target UE shall include PC5 signalling protocol cause #10
\"UE PC5 unicast signalling security policy mismatch\" in the SECURITY MODE
REJECT message.
After the DIRECT LINK SECURITY MODE REJECT message is generated, the target UE
shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication.
Upon receipt of the DIRECT LINK SECURITY MODE REJECT message, the initiating
UE shall stop timer T5007, provide an indication to the lower layer of
deactivation of the PC5 unicast security protection and deletion of security
context for the PC5 unicast link, if applicable and:
a) if the PC5 signalling protocol cause IE in the DIRECT LINK SECURITY MODE
REJECT message is set to #9 \"LSBs of K~NRP-sess~ ID conflict\", retransmit
the DIRECT LINK SECURITY MODE COMMAND message with a different value for the 8
LSBs of K~NRP-sess~ ID; or
b) if the PC5 signalling protocol cause IE is set to the value other than #9
\"LSBs of KNRP-sess ID conflict\", abort the ongoing procedure that triggered
the initiation of the PC5 unicast link security mode control procedure.
##### 6.1.2.7.6 Abnormal cases
##### 6.1.2.7.6.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue-5 .H6}
a) Timer T5007 expires.
The initiating UE shall retransmit the DIRECT LINK SECURITY MODE COMMAND
message and restart timer T5007. After reaching the maximum number of allowed
retransmissions, the initiating UE shall abort the PC5 unicast link security
mode control procedure, shall provide an indication to the lower layer of
deactivation of the PC5 unicast security protection and deletion of security
context for the PC5 unicast link, if applicable, and shall abort the ongoing
procedure that triggered the initiation of the PC5 unicast link security mode
control procedure.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
b) The need to use this PC5 unicast link no longer exists before the PC5
unicast link security mode control procedure is completed.
The initiating UE shall abort the procedure, shall provide an indication to
the lower layer of deactivation of the PC5 unicast security protection and
deletion of security context for the PC5 unicast link, if applicable, and
shall abort the ongoing procedure that triggered the initiation of the PC5
unicast link security mode control procedure.
#### 6.1.2.8 PC5 unicast link keep-alive procedure
##### 6.1.2.8.1 General
The PC5 unicast link keep-alive procedure is used to maintain a PC5 unicast
link between two UEs, i.e., check that the link between the two UEs is still
viable. The UE sending the DIRECT LINK KEEPALIVE REQUEST message is called the
\"initiating UE\" and the other UE is called the \"target UE\".
The PC5 unicast link keep-alive procedure can be initiated by only one UE or
both UEs in the established PC5 unicast link.
NOTE: Whether the PC5 unicast link keep-alive procedure is initiated by only
one UE or both UEs in the established PC5 unicast link is UE implementation
specific.
##### 6.1.2.8.2 PC5 unicast link keep-alive procedure initiation by the
initiating UE
The initiating UE shall meet the following pre-condition before initiating the
PC5 unicast link keep-alive procedure:
a) there is a PC5 unicast link between the initiating UE and the target UE.
The initiating UE shall manage a keep-alive timer T5003 and a keep-alive
counter for the PC5 unicast link keep-alive procedure. Timer T5003 is used to
trigger the periodic initiation of the PC5 unicast link keep-alive procedure.
The UE shall start or restart timer T5003 whenever the UE receives a PC5
signalling message or PC5 user plane data from the target UE over this PC5
unicast link. The UE shall set the keep-alive counter to an initial value of
zero after PC5 unicast link establishment.
The initiating UE shall initiate the PC5 unicast link keep-alive procedure
when:
a) timer T5003 for this link expires;
b) optionally, a request from the lower layers to check the viability of the
PC5 unicast link is received; or
NOTE 1: Whether the lower layers can request the initiation of the PC5 unicast
link keep-alive procedure, and what the triggers for the lower layers are to
request the initiation of the PC5 unicast link keep-alive procedure, are UE
implementation specific.
c) optionally, a request from the upper layers to check the viability of the
PC5 unicast link is received.
NOTE 2: Whether the upper layers can request the initiation of the PC5 unicast
link keep-alive procedure, and what the triggers for the upper layers are to
request the initiation of the PC5 unicast link keep-alive procedure, are UE
implementation specific.
In order to initiate the PC5 unicast link keep-alive procedure, the initiating
UE shall stop timer T5003, if running, and shall create a DIRECT LINK
KEEPALIVE REQUEST message. In this message, the initiating UE:
a) shall include the keep-alive counter for the PC5 unicast link; and
b) may include a maximum inactivity period to indicate the maximum inactivity
period of the initiating UE over this PC5 unicast link.
NOTE 3: The value chosen for the maximum inactivity period of the initiating
UE is UE implementation specific with the objective to minimize the number of
keep-alive procedures as much as possible. It is desirable to have the maximum
inactivity period value to be slightly higher than the value of keep-alive
timer T5003.
After the DIRECT LINK KEEPALIVE REQUEST message is generated, the initiating
UE shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication, and start timer T5004. The UE shall not
send a new DIRECT LINK KEEPALIVE REQUEST message to the same target UE while
timer T5004 is running.
Figure 6.1.2.8.2: PC5 unicast link keep-alive procedure
##### 6.1.2.8.3 PC5 unicast link keep-alive procedure accepted by the target
UE
Upon receipt of a DIRECT LINK KEEPALIVE REQUEST message, the target UE shall
create a DIRECT LINK KEEPALIVE RESPONSE message. In this message, the target
UE:
a) shall include the keep-alive counter set to the same value as that received
in the DIRECT LINK KEEPALIVE REQUEST message.
After the DIRECT LINK KEEPALIVE RESPONSE message is generated, the target UE
shall pass this message to the lower layers for transmission along with the
target UE\'s layer-2 ID for unicast communication and the initiating UE\'s
layer-2 ID for unicast communication.
If a maximum inactivity period is included in the DIRECT LINK KEEPALIVE
REQUEST message, the target UE shall stop T5005, if running, and start T5005
with its value set to the maximum inactivity period. The target UE shall
restart T5005 whenever the target UE receives a PC5 signalling message or PC5
user plane data from the initiating UE over this PC5 unicast link.
##### 6.1.2.8.4 PC5 unicast link keep-alive procedure completion by the
initiating UE
Upon receipt of a DIRECT LINK KEEPALIVE RESPONSE message, the initiating UE
shall stop timer T5004, start timer T5003 and increment the keep-alive counter
for the PC5 unicast link.
##### 6.1.2.8.5 Abnormal cases
##### 6.1.2.8.5.1 Abnormal cases at the initiating UE {#abnormal-cases-at-the-
initiating-ue-6 .H6}
a) Timer T5004 expires.
The initiating UE shall retransmit the DIRECT LINK KEEPALIVE REQUEST message
with the last used value of the keep-alive counter and restart timer T5004.
After reaching the maximum number of allowed retransmissions, the initiating
UE shall abort the PC5 unicast link keep-alive procedure and locally release
the PC5 unicast link.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
b) The need to use this PC5 unicast link no longer exists before the PC5
unicast link keep-alive procedure is completed.
The initiating UE shall abort the PC5 unicast link keep-alive procedure and
initiate a PC5 unicast link release procedure.
c) The initiating UE receives a DIRECT LINK KEEPALIVE RESPONSE message with a
keep-alive counter value different from the value which the initiating UE had
included in the last sent DIRECT LINK KEEPALIVE REQUEST message.
The initiating UE shall discard the DIRECT LINK KEEPALIVE RESPONSE message.
d) The initiating UE receives a PC5 signalling message other than a DIRECT
LINK KEEPALIVE RESPONSE message or PC5 user plane data from the target UE over
this PC5 unicast link while timer T5004 is running.
The initiating UE shall stop timer T5004, abort the PC5 unicast link keep-
alive procedure, start timer T5003 and increment the keep-alive counter for
the PC5 unicast link.
e) The initiating UE receives a DIRECT LINK KEEPALIVE RESPONSE message when
T5004 is not running.
The initiating UE shall discard the DIRECT LINK KEEPALIVE RESPONSE message.
###### 6.1.2.8.5.2 Abnormal cases at the target UE {#abnormal-cases-at-the-
target-ue-2 .list-paragraph}
a) Timer T5005 expires.
The target UE shall:
1) initiate a PC5 unicast link keep-alive procedure to check the link; or
2) initiate the PC5 unicast link release procedure.
Whether the UE chooses 1) or 2) is left to UE implementation.
b) The target UE receives a DIRECT LINK KEEPALIVE REQUEST message with a keep-
alive counter value lower than the value which the target UE had included in
the last sent DIRECT LINK KEEPALIVE RESPONSE message.
The target UE shall discard the DIRECT LINK KEEPALIVE REQUEST message.
c) The target UE receives a DIRECT LINK KEEPALIVE REQUEST message if there is
a pending PC5 signaling message or PC5 user plane data to be sent to the
initiating UE over this PC5 unicast link.
The target UE:
1) shall pass this PC5 signalling message to the lower layers for transmission
along with the target UE\'s layer-2 ID for unicast communication and the
initiating UE\'s layer-2 ID for unicast communication, or perform the data
transmission over PC5 unicast link as specified in clause 6.1.2.9; and
2) shall consider transmission of this PC5 signalling message or PC5 user
plane data to be an implicit DIRECT LINK KEEPALIVE RESPONSE message and skip
generating a DIRECT LINK KEEPALIVE RESPONSE message. If a maximum inactivity
period is included in the DIRECT LINK KEEPALIVE REQUEST message, the target UE
shall stop T5005, if running, and start T5005 with its value set to the
maximum inactivity period.
#### 6.1.2.9 Data transmission over PC5 unicast link
##### 6.1.2.9.1 Transmission
When receiving user data from upper layers to be sent over PC5 unicast link to
a specific UE, the transmitting UE shall determine the PC5 unicast link
context corresponding to the application layer ID, and then shall tag each
outgoing protocol data unit with the following information before passing it
to the lower layers for transmission:
a) a layer-3 protocol data unit type (see 3GPP TS 38.323 [10]) set to:
1) IP packet, if the V2X message contains IP data; or
2) non-IP packet, if the V2X message contains non-IP data;
b) the PC5 link identifier associated with the PC5 unicast link context;
c) optionally, the source layer-2 ID set to the source layer-2 ID associated
with the PC5 unicast link context;
d) optionally, the destination layer-2 ID set to the destination layer-2 ID
associated with the PC5 unicast link context; and
e) the PQFI set to the value corresponding to the V2X service identifier and
the optional V2X application requirements according to the mapping rules
specified in clause 5.2.3.
##### 6.1.2.9.2 Procedure for UE to use provisioned radio resources for V2X
communication over PC5
The procedures described for using NR-PC5 in clause 6.1.3.2.3 apply.
#### 6.1.2.10 PC5 unicast link re-keying procedure
##### 6.1.2.10.1 General
The purpose of the PC5 unicast link re-keying procedure is to derive a new
K~NRP-sess~ and, optionally, a new K~NRP~ for an existing PC5 unicast link.
The UE sending the DIRECT LINK REKEYING REQUEST message is called the
\"initiating UE\" and the other UE is called the \"target UE\".
NOTE: There is no benefit in performing the PC5 unicast link re-keying
procedure when using the null integrity protection algorithm, hence it is
recommended not to trigger it when using the null integrity protection
algorithm.
##### 6.1.2.10.2 PC5 unicast link re-keying procedure initiation by the
initiating UE
The initiating UE shall meet the following pre-condition before initiating the
PC5 unicast link re-keying procedure:
a) there is a PC5 unicast link between the initiating UE and the target UE;
and
1) if the session key K~NRP-sess~ used to protect PC5 unicast link needs to be
refreshed and neither timer T5007 nor T5008 are running;
2) if the UE wants to refresh K~NRP~ and neither timer T5007 nor T5008 are
running; or
3) if the lower layers indicate that a PC5 unicast link re-keying procedure
needs to be performed.
In order to initiate the PC5 unicast link re-keying procedure, the initiating
UE shall create a DIRECT LINK REKEYING REQUEST message. In this message, the
initiating UE:
a) shall include the Key establishment information container IE if the null
integrity protection algorithm is not in use;
NOTE 1: The key establishment information container is provided by upper
layers.
b) shall include a Nonce_1 IE set to the 128-bit nonce value generated by the
initiating UE for the purpose of session key refresh over this PC5 unicast
link if the null integrity protection algorithm is not in use;
c) shall include its UE security capabilities indicating the list of
algorithms that the initiating UE supports for the re-keying of this PC5
unicast link;
d) shall include the 8 MSBs of K~NRP-sess~ ID chosen by the initiating UE as
specified in 3GPP TS 33.536 [20] if the null integrity protection algorithm is
not in use; and
e) may include a Re-authentication indication if the initiating UE wants to
derive a new K~NRP~.
After the DIRECT LINK REKEYING REQUEST message is generated, the initiating UE
shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication, and start timer T5008. The UE shall not
send a new DIRECT LINK REKEYING REQUEST message to the same target UE while
timer T5008 is running.
NOTE 2: In order to ensure successful PC5 unicast link re-keying, T5008 should
be set to a value larger than the sum of T5006 and T5007.
Figure 6.1.2.10.2: PC5 unicast link re-keying procedure
##### 6.1.2.10.3 PC5 unicast link re-keying procedure accepted by the target
UE
Upon receipt of a DIRECT LINK REKEYING REQUEST message, if the DIRECT LINK
REKEYING REQUEST message includes a Re-authentication indication, the target
UE shall derive a new K~NRP~. This may require performing one or more PC5
unicast link authentication procedures as specified in clause 6.1.2.6.
NOTE: How many times the PC5 unicast link authentication procedure needs to be
performed to derive a new K~NRP~ depends on the authentication method used.
Then the target UE shall initiate a PC5 unicast link security mode control
procedure as specified in in clause 6.1.2.7.
Upon successful completion of the PC5 unicast link security mode control
procedure, the target UE shall create a DIRECT LINK REKEYING RESPONSE message.
After the DIRECT LINK REKEYING RESPONSE message is generated, the target UE
shall pass this message to the lower layers for transmission along with the
initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication.
##### 6.1.2.10.4 PC5 unicast link re-keying procedure completion by the
initiating UE
Upon receipt of the DIRECT LINK REKEYING RESPONSE message, the initiating UE
shall stop timer T5008 and check the integrity of the DIRECT LINK REKEYING
RESPONSE message using the new NRPIK.
After receiving the DIRECT LINK REKEYING RESPONSE message, the initiating UE
shall delete the old security context it has for the target UE.
##### 6.1.2.10.5 Abnormal cases at the initiating UE
The following abnormal cases can be identified:
a) Timer T5008 expires.
The initiating UE shall retransmit the DIRECT LINK REKEYING REQUEST message
and restart timer T5008. After reaching the maximum number of allowed
retransmissions, the initiating UE shall abort the PC5 unicast link re-keying
procedure, shall provide an indication of deactivation of the PC5 unicast
security protection and deletion of security context for the PC5 unicast link
to the lower layer, if applicable, along with the initiating UE\'s layer-2 ID
for unicast communication and the target UE\'s layer-2 ID for unicast
communication and may initiate the PC5 unicast link release procedure.
NOTE: The maximum number of allowed retransmissions is UE implementation
specific.
b) The need to use this PC5 unicast link no longer exists before the PC5
unicast link re-keying procedure is completed.
The initiating UE shall abort the procedure and shall provide an indication of
deactivation of the PC5 unicast security protection and deletion of security
context for the PC5 unicast link to the lower layer, if applicable, along with
the initiating UE\'s layer-2 ID for unicast communication and the target UE\'s
layer-2 ID for unicast communication.
c) For the same PC5 unicast link, if the initiating UE receives a DIRECT LINK
IDENTIFIER UPDATE REQUEST message after initiating the PC5 unicast link re-
keying procedure, the initiating UE shall stop the timer T5008, abort the PC5
unicast link re-keying procedure and proceed with the PC5 unicast link
identifier update procedure.
#### 6.1.2.11 PC5 unicast security
##### 6.1.2.11.1 Overview
This clause describes the principles for the handling of PC5 unicast security
contexts in the UE and the procedures used for the security protection of PC5
signalling messages exchanged between UEs over a PC5 unicast link. Based on
the security policies of UEs, security protection for a PC5 unicast link
involves integrity protection and ciphering of the PC5 signalling messages,
and integrity protection and ciphering of PC5 user plane data. The use of
integrity protection and ciphering over a PC5 unicast link is optional (see
3GPP TS 33.536 [20]).
The signalling procedures for the control of PC5 unicast security are part of
the PC5 signalling protocol and are described in detail in clause 6.1.2.
NOTE: It is recommended to set the UE PC5 unicast signalling integrity
protection policy to \"signalling integrity protection required\" in order to
guarantee security protection over PC5. In this clause, for the ease of
description, it is assumed that integrity protection and ciphering are used,
unless explicitly indicated otherwise. Operation of a PC5 unicast link without
integrity protection or ciphering is achieved by configuring the UE so that it
always selects the \"null integrity protection algorithm\", 5G-IA0, or the
\"null ciphering algorithm\", 5G-EA0.
##### 6.1.2.11.2 Handling of PC5 unicast security contexts
##### 6.1.2.11.2.1 General {#general-13 .H6}
The security parameters for authentication, integrity protection and ciphering
are tied together in a PC5 unicast security context and identified by a K~NRP-
sess~ identifier (K~NRP-sess~ ID). The relationship between the security
parameters is defined in 3GPP TS 33.536 [20]. The K~NRP-sess~ ID is self-
assigned by the UEs.
Before security can be activated, the UEs establishing a PC5 unicast link need
to establish a PC5 unicast security context. The PC5 unicast security context
is created as the result of a PC5 unicast link authentication procedure and
PC5 unicast link security mode control procedure between the UEs.
The PC5 unicast security context is taken into use by the UEs when one of the
UEs initiates a PC5 unicast link security mode control procedure.
The creation of a security context also results in the establishment of a key
K~NRP~ and its identifier K~NRP~ ID at the UEs.
The PC5 unicast security context can be created using K~NRP~ when a new PC5
unicast link is established without executing a new PC5 unicast link
authentication procedure (see clause 6.1.2.11.2.2). For this purpose, the
DIRECT LINK ESTABLISHMENT REQUEST message contains a K~NRP~ ID indicating the
PC5 unicast security context.
##### 6.1.2.11.2.2 Establishment of secure exchange of PC5 signalling messages
{#establishment-of-secure-exchange-of-pc5-signalling-messages .H6}
Secure exchange of PC5 signalling messages over a PC5 unicast link is
established during the PC5 unicast link establishment procedure by initiating
a PC5 unicast link security mode control procedure. After successful
completion of the PC5 unicast link security mode control procedure, all PC5
signalling messages exchanged between the UEs are sent integrity protected
using the PC5 unicast security algorithms, and except for the DIRECT LINK
SECURITY MODE COMMAND message, all PC5 signalling messages exchanged between
the UEs are sent ciphered using the PC5 unicast security algorithms. The
security exchange of PC5 signalling messages is maintained for the lifetime of
the PC5 unicast link.
##### 6.1.2.11.2.3 Change of security keys {#change-of-security-keys .H6}
When one of the UEs using the PC5 unicast link initiates a PC5 unicast link
re-keying procedure to create a new PC5 unicast security context, the PC5
signalling messages exchanged during the PC5 unicast link authentication
procedure, if any, are integrity protected and ciphered using the old PC5
unicast security context, i.e. the PC5 unicast security context that was in
use before the start of the PC5 unicast link re-keying procedure.
Both UEs shall continue to use the old PC5 unicast security context until the
UE which has received the DIRECT LINK REKEYING REQUEST message initiates a PC5
unicast link security mode control procedure. The UE shall send the DIRECT
LINK SECURITY MODE COMMAND message integrity protected with the new PC5
unicast security context, but unciphered. When the peer UE responds with a
DIRECT LINK SECURITY MODE COMPLETE message, it shall send the message
integrity protected and ciphered with the new PC5 unicast security context.
##### 6.1.2.11.3 Checking of PC5 signalling messages in the UE
If the signalling integrity protection is not activated for PC5 unicast link,
all PC5 signalling messages are processed by the UE without integrity
protection.
If the signalling integrity protection is activated for PC5 unicast link,
except the messages listed below, no PC5 signalling messages that is not
integrity protected shall be processed by the UE:
a) DIRECT LINK ESTABLISHMENT REQUEST message;
b) DIRECT LINK ESTABLISHMENT REJECT message;
c) DIRECT LINK AUTHENTICATION REQUEST message;
d) DIRECT LINK AUTHENTICATION RESPONSE message;
e) DIRECT LINK AUTHENTICATION REJECT message;
f) DIRECT LINK SECURITY MODE REJECT message; and
g) DIRECT LINK AUTHENTICATION FAILURE message.
NOTE: These messages are accepted by the receiving UE without integrity
protection, as in certain situations they are sent by the peer UE before
security can be activated.
Once the secure exchange of PC5 signalling messages has been established, the
receiving UE shall not process any PC5 signalling message that does not
successfully pass the integrity check. The DIRECT LINK SECURITY MODE COMMAND
message shall be processed as specified in clause 6.1.2.7.3. If any PC5
signalling message is received as not integrity protected and not ciphered
even though the secure exchange of PC5 signalling messages has been
established, then the receiving UE shall discard this message.
#### 6.1.2.12 PC5 QoS flow establishment over PC5 unicast link
In order to establish a PC5 QoS flow establishment over PC5 unicast link, the
UE shall derive the PC5 QoS parameters based on the V2X application
requirements provided by the upper layers (if available) and the V2X service
identifier (e.g. PSID or ITS-AID) according to the PC5 QoS mapping rules
defined in clause 5.2.3. The UE shall create the PC5 QoS flow(s) based on the
derived PC5 QoS parameters. For each PC5 QoS flow to be created, the UE shall
perform the following operations:
a) self-assign a PQFI;
b) create a PC5 QoS flow context, which contains:
1) the PQFI;
2) the V2X service identifier(s); and
3) the derived PC5 QoS parameters;
c) create a new PC5 QoS rule which contains:
1) a PC5 QoS rule identifier;
2) the PQFI;
3) a set of packet filters; and
4) a precedence value; and
d) pass the following parameters to the lower layers:
1) the PQFI;
2) the PC5 QoS parameters;
3) the PC5 link identifier; and
4) optionally, the source and destination layer-2 IDs.
Two types of packet filters are supported for V2X communication over PC5, i.e.
the IP packet filter set and the V2X packet filter set. A PC5 QoS Rule
contains either the IP packet filter set or the V2X packet filter set.
The IP packet filter set is defined as content of the packet filter contents
field specified in 3GPP TS 24.501 [6] figure 9.11.4.13.4 and table
9.11.4.13.1.
The V2X packet filter set shall support packet filters based on at least any
combination of:
a) V2X Service identifie (e.g. PSID or ITS-AID);
b) the source layer-2 ID and the destination layer-2 ID; and
c) application layer ID (e.g. Station ID).
The UE shall also pass the one or more V2X frequencies associated with the V2X
service identifier and the communication mode which is set to unicast mode for
the V2X service identifier to the lower layers, if:
a) the UE is configured with V2X service identifier to V2X frequency mapping
rules for V2X communication over PC5 as specified in clause 5.2.3; and
b) there is one or more V2X frequencies associated with the V2X service
identifier in the current geographical area.
#### 6.1.2.13 PC5 QoS flow match over PC5 unicast link
When service data or request from the upper layers is received, the UE
determines if there is any existing PC5 QoS flow(s) matching the service data
or request, i.e. based on the PC5 QoS rules for the existing PC5 QoS flow(s).
If there is no PC5 QoS rules for the existing PC5 QoS flow(s) matching the
service data or request, the UE shall derive the PC5 QoS parameters based on
the V2X application requirements provided by the upper layers (if available)
and the V2X service identifier (e.g. PSID or ITS-AID) according to the PC5 QoS
mapping rules defined in clause 5.2.3 and shall perform the following:
a) if there is no existing PC5 QoS flow that fulfils the derived PC5 QoS
parameters, then the UE shall create a new PC5 QoS flow as specified in clause
6.1.2.12;
b) if there is an existing PC5 QoS flow that fulfils the derived PC5 QoS
parameters, then the UE shall update the PC5 packet filter set in the PC5 QoS
rule of this PC5 QoS flow, e.g. add the new packet filter in the PC5 QoS rule
of this existing PC5 QoS flow; and
c) the UE shall use the new PC5 QoS flow created as described in bullet a) or
the existing PC5 QoS flow with the updated PC5 QoS rules as described in
bullet b) to perform the transmission of V2X communication over PC5 as
specified in clause 6.1.2.9.
If there is a PC5 QoS rule for the existing PC5 QoS flow matching the service
data or request, the UE shall use this existing PC5 QoS flow to perform
transmission of V2X communication over PC5 as specified in clause 6.1.2.9.
### 6.1.3 Broadcast mode communication over PC5
#### 6.1.3.1 Overview
This clause describes the V2X communication over PC5 reference point in
broadcast mode operation. The UE is configured with the related information as
described in clause 5.2.3.
#### 6.1.3.2 Transmission of broadcast mode V2X communication over PC5
##### 6.1.3.2.1 Initiation
##### 6.1.3.2.1.1 Requirements for V2X communication over PC5 {#requirements-
for-v2x-communication-over-pc5 .H6}
When the upper layers request the UE to send a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over PC5, the
request from the upper layers includes:
a) the V2X message;
b) the V2X service identifier of the V2X service for the V2X message;
c) the type of data in the V2X message (i.e. IP or non-IP);
d) if the V2X message contains non-IP data, the V2X message family (see clause
9.2) of data in the V2X message;
e) optionally the communication mode which is set to broadcast mode; and
f) optionally the V2X application requirements (e.g. priority requirement,
reliability requirement, delay requirement).
Upon a request from upper layers to send a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over PC5, if:
a) the UE is configured with V2X service identifier to V2X frequency mapping
rules for V2X communication over PC5 as specified in clause 5.2.3; and
b) there is one or more V2X frequencies associated with the V2X service
identifier of the V2X service for the V2X message in the current geographical
area,
then the UE passes the one or more V2X frequencies associated with the V2X
service identifier of the V2X service and the communication mode which is set
to broadcast mode for the V2X message to the lower layers.
Then, if any of the following conditions are met:
a) the following conditions are met:
1) the UE is served by NR or served by E-UTRA for NR-PC5 V2X communication;
2) the UE intends to use the radio resources (i.e. carrier frequency) provided
by a serving cell;
3) the registered PLMN is in the list of PLMNs in which the UE is authorized
to use V2X communication over PC5 when the UE is served by NR or served by
E-UTRA for V2X communication over PC5 as specified in clause 5.2.3; and
4) the V2X service identifier of the V2X service is included in the list of
V2X services authorized for V2X communication over PC5 as specified in clause
5.2.3 or the UE is configured with a default destination layer-2 ID for V2X
communication over PC5 as specified in clause 5.2.3;
b) the following conditions are met:
1) the UE is:
i) not served by NR and not served by E-UTRA for V2X communication over PC5;
ii) in limited service state as specified in 3GPP TS 23.122 [2], if the reason
for the UE being in limited service state is one of the following:
A) the UE is unable to find a suitable cell in the selected PLMN as specified
in 3GPP TS 38.304 [9];
B) the UE received a REGISTRATION REJECT message or a SERVICE REJECT message
with the 5GMM cause #11 \"PLMN not allowed\" as specified in 3GPP TS 24.501
[6]; or
C) the UE received a REGISTRATION REJECT message or a SERVICE REJECT message
with the 5GMM cause #7 \"5GS services not allowed\" as specified in 3GPP TS
24.501 [6]; or
iii) in limited service state as specified in 3GPP TS 23.122 [2] for reasons
other than A), B) or C) above, and located in a geographical area for which
the UE is provisioned with \"non-operator managed\" radio parameters as
specified in clause 5.2.3;
2) the UE is authorized to use V2X communication over PC5 when the UE is not
served by NR and not served by E-UTRA for V2X communication as specified in
clause 5.2.3; and
3) the V2X service identifier of the V2X service is included in the list of
V2X services authorized for V2X communication over PC5 as specified in clause
5.2.3 or the UE is configured with a default destination layer-2 ID for V2X
communication over PC5 as specified in clause 5.2.3;
then the UE shall proceed as specified in clause 6.1.3.2.1.2, else the UE
shall not perform transmission of V2X communication over PC5.
##### 6.1.3.2.1.2 PC5 QoS flow match and establishment {#pc5-qos-flow-match-
and-establishment .H6}
When determining if any existing PC5 QoS flow match the request from upper
layers, UE shall proceeds as follows:
a) according to the PC5 QoS mapping rules specified in clause 5.2.3, the UE
shall use the PC5 QoS parameters corresponding to the V2X service identifier
and optionally V2X application requirements;
b) according to the V2X service identifier to destination layer-2 ID for
broadcast mapping rules specified in clause 5.2.3, the UE shall use the
destination layer-2 ID corresponding to the V2X service identifier;
c) if there is no existing context for the destination layer-2 ID, then:
1) build a new context for the destination layer-2 ID;
2) self-assign a new source layer-2 ID; and
3) pass the source layer-2 ID and the destination layer-2 ID to lower layers.
d) if in the context for the destination layer-2 ID, there is no PC5 QoS rule
for the existing PC5 QoS flow(s) matching the service data or request, the UE
shall derive the PC5 QoS parameters based on the V2X application requirements
provided by the upper layers (if available) and the V2X service identifier
(e.g. PSID or ITS-AID) according to the PC5 QoS mapping rules defined in
clause 5.2.3 and shall perform the following::
1) if there is no existing PC5 QoS flow that fulfils the derived PC5 QoS
parameters, then the UE shall create a new PC5 QoS flow by performing the
following operations:
i) self-assign a new PQFI;
ii) create a new PC5 QoS flow context which contains:
\- the PQFI;
\- the V2X service identifier(s); and;
\- the derived PC5 QoS parameters;
iii) create a new PC5 QoS rule which contains:
\- a PC5 QoS rule identifier;
\- the PQFI;
\- a set of packet filters; and
\- a precedence value; and
iv) pass the following parameters to the lower layers:
\- the PQFI;
\- the PC5 QoS parameters; and
\- the source layer-2 ID and the destination layer-2 ID;
2) if there is an existing PC5 QoS flow that fulfils the derived PC5 QoS
parameters, then the UE shall update the PC5 packet filter set in the PC5 QoS
rule of this PC5 QoS flow, e.g. add the new packet filter in the PC5 QoS rule
of this existing PC5 QoS flow; and
3) the UE shall use the new PC5 QoS flow created as described in bullet 1) or
the existing PC5 QoS flow with the updated PC5 QoS rules as described in
bullet 2) to perform the transmission of V2X communication over PC5 as
specified in clause 6.1.3.2.2; and
e) if in the context for the destination layer-2 ID, there is a PC5 QoS rule
for the existing PC5 QoS flow matching the service data or request, the UE
shall use this existing PC5 QoS flow to perform transmission of V2X
communication over PC5 as specified in clause 6.1.3.2.2.
Two types of packet filters are supported for V2X communication over PC5, i.e.
the IP packet filter set and the V2X packet filter set. A PC5 QoS Rule
contains either the IP packet filter set or the V2X packet filter set.
The IP packet filter set is defined as content of the packet filter contents
field specified in 3GPP TS 24.501 [6] figure 9.11.4.13.4 and table
9.11.4.13.1.
The V2X packet filter set shall support packet filters based on at least any
combination of:
\- V2X service identifier (e.g. PSID or ITS-AID);
\- the source layer-2 ID and the destination layer-2 ID; and
\- Application Layer ID (e.g. Station ID);
##### 6.1.3.2.2 Transmission
The UE shall include the V2X message in a protocol data unit with the
following parameters:
a) a layer-3 protocol data unit type (see 3GPP TS 38.323 [10]) set to:
1) IP packet, if the V2X message contains IP data; or
2) non-IP packet, if the V2X message contains non-IP data;
b) the source layer-2 ID set to the layer-2 ID self-assigned by the UE for V2X
communication over PC5;
c) the destination layer-2 ID set to:
1) the destination layer-2 ID associated with the V2X service identifier of
the V2X service in this list of V2X services authorized for V2X communication
over PC5 as specified in clause 5.2.3, if the V2X service identifier of the
V2X service is included in the list of V2X services authorized for V2X
communication over PC5 as specified in clause 5.2.3; or
2) the default destination layer-2 ID configured to the UE for V2X
communication over PC5 as specified in clause 5.2.3, if the V2X service
identifier of the V2X service is not included in the list of V2X services
authorized for V2X communication over PC5 and the UE is configured with a
default destination layer-2 ID for V2X communication over PC5;
d) if the V2X message contains non-IP data, an indication to set the non-IP
type field of the non-IP type PDU to the value corresponding to the V2X
message family (see clause 9.2 and clause 9.3) used by the V2X service as
indicated by upper layers;
e) if the V2X message contains IP data, the source IP address set to the
source IP address self-assigned by the UE for V2X communication over PC5;
f) the PQFI set to the value corresponding to the PC5 QoS Rules as specified
in clause 6.1.3.2.1;
g) if E-UTRA-PC5 is used for V2X communication over PC5, the UE is configured
with V2X service identifier to Tx Profile mapping rules for V2X communication
over PC5 as specified in clause 5.2.3, the Tx Profile associated with the V2X
service identifier as specified in clause 5.2.3.
then UE shall request radio resources for V2X communication over PC5 as
specified in 3GPP TS 38.300 [8], and pass the V2X message on the PC5 QoS Flow
identified by the PQFI to lower layers for transmission. The PC5 QoS Rules
corresponding to the PQFIs map V2X messages with the same V2X service
identifier and with the same PC5 QoS parameters to the same PC5 QoS Flow, and
apply PQFI to V2X messages;
If the UE is camped on a serving cell indicating that V2X communication over
PC5 is supported by the network, but not broadcasting any carrier frequencies
and radio resources for V2X communication over PC5 as specified in 3GPP TS
38.331 [11], the UE shall request radio resources for V2X communication over
PC5 as specified in 3GPP TS 24.501 [6].
If the UE has an emergency PDN connection, the UE shall send an indication to
the lower layers to prioritize transmission over the emergency PDN connection
as compared to transmission of V2X communication over PC5.
##### 6.1.3.2.3 Procedure for UE to use provisioned radio resources for V2X
communication over PC5
When the UE is not served by NR and not served by E-UTRA for V2X communication
and is authorized to use V2X communication over PC5, the UE shall identify the
RAT to be used for V2X communication over PC5 according to the list of RATs in
which the UE is authorized to use V2X communication over PC5. If both E-UTRA-
PC5 and NR-PC5 for V2X are authorized to the UE for V2X communication over
PC5, the UE selects a RAT used for V2X communication over PC5 according to
local policy. After identifying E-UTRA-PC5 to be used for V2X communication
over PC5, the UE performs the procedure defined in clause 6.1.2.3 of 3GPP TS
24. 386 [5]. After identifying NR-PC5 to be used for V2X communication over
PC5, the UE shall select the corresponding radio parameters to be used for V2X
communication over PC5 as follows:
a) if the UE can determine itself located in a geographical area, and the UE
is provisioned with radio parameters for the geographical area, the UE shall
select the radio parameters associated with that geographical area; or
b) in all other cases, the UE shall not initiate V2X communication over PC5.
It is out of scope of the present specification to define how the UE can
locate itself in a specific geographical area. When the UE is in coverage of a
3GPP RAT it can for example use information derived from the serving PLMN.
When the UE is not in coverage of a 3GPP RAT it can use other techniques, e.g.
global navigation satellite system (GNSS). The UE shall not consider user
provided location as a valid input to locate itself in a specific geographical
area.
If the UE intends to use \"non-operator managed\" radio parameters as
specified in clause 5.2.3, the UE shall initiate V2X communication over PC5
with the selected radio parameters.
If the UE intends to use \"operator managed\" radio parameters as specified in
clause 5.2.3, before initiating V2X communication over PC5, the UE shall check
with lower layers whether the selected radio parameters can be used in the
current location without causing interference to other cells as specified in
3GPP TS 38.331 [11], and:
a) if the lower layers indicate that the usage would not cause any
interference, the UE shall initiate V2X communication over PC5; or
NOTE: If the lower layers find that there exists a cell operating the
provisioned radio resources (i.e., carrier frequency), and the cell belongs to
the registered PLMN or a PLMN equivalent to the registered PLMN, and the UE is
authorized for V2X communication over PC5 in this PLMN, the UE can use the
radio parameters indicated by the cell as specified in 3GPP TS 38.331 [11].
b) else if the lower layers report that one or more PLMNs operate in the
provisioned radio resources (i.e. carrier frequency) then:
1) if the following conditions are met:
i) none of the PLMNs reported by the lower layers is the registered PLMN or
equivalent to the registered PLMN;
ii) at least one of the PLMNs reported by the lower layers is in the list of
authorized PLMNs for V2X communication over PC5 and provides radio resources
for V2X communication over PC5 as specified in 3GPP TS 38.331 [11]; and
iii) the UE does not have an emergency PDU session;
then the UE shall:
i) if in 5GMM-IDLE mode, perform PLMN selection triggered by V2X communication
over PC5 as specified in 3GPP TS 23.122 [2]; or
ii) else if in 5GMM-CONNECTED mode, either:
A) perform a Deregistration procedure as specified in 3GPP TS 24.501 [6] and
then perform PLMN selection triggered by V2X communication over PC5 as
specified in 3GPP TS 23.122 [2]; or
B) not initiate V2X communication over PC5.
Whether the UE performs i) or ii) above is left up to UE implementation; or
2) else the UE shall not initiate V2X communication over PC5.
If the registration to the selected PLMN is successful, the UE shall proceed
with the procedure to initiate V2X communication over PC5 as specified in
clause 6.1.3.2.1.
If the UE is performing V2X communication over PC5 using radio parameters
associated with a geographical area and moves out of that geographical area,
the UE shall stop performing V2X communication over PC5 and then:
a) if the UE is not served by NR and not served by E-UTRA for V2X
communication over PC5 or the UE intends to use radio resources for V2X
communication over PC5 other than those operated by the serving cell, the UE
shall select appropriate radio parameters for the new geographical area as
specified above; or
b) if the UE is served by NR or served by E-UTRA for V2X communication over
PC5 and intends to use radio resources for V2X communication over PC5 operated
by the serving cell, the UE shall proceed with the procedure to initiate V2X
communication over PC5 when served by NR or served by E-UTRA for V2X
communication over PC5.
##### 6.1.3.2.4 Privacy of V2X transmission over PC5
Upon initiating transmission of V2X communication over PC5, if:
a) the V2X service identifier of a V2X service requesting transmission of V2X
communication over PC5 is in the list of of V2X services which require privacy
for V2X communication over PC5 as specified in clause 5.2.3; and
b) the UE is located in a geographical area in which this V2X service requires
privacy for V2X communication over PC5 as specified in clause 5.2.3, or the UE
is not provisioned any geographical areas in which this V2X services requires
privacy for V2X communication over PC5,
then the UE shall proceed as follows:
a) if timer T5020 is not running, start timer T5020 and set its timer value as
the privacy timer value as specified in clause 5.2.3;
b) upon:
1) getting an indication from upper layers that the application layer
identifier has been changed; or
2) timer T5020 expiry,
then:
1) change the value of the source layer-2 ID self-assigned by the UE for the
V2X communication over PC5;
2) if the V2X message contains IP data, change the value of the source IP
address self-assigned by the UE for V2X communication over PC5;
3) provide an indication to upper layers that the source layer-2 ID and/or the
source IP address are changed;
4) pass the changed source layer-2 ID and destination layer-2 ID, along with
the corresponding PQFI down to the lower layer;
5) restart timer T5020; and
6) upon stopping transmission of the V2X communication over PC5, stop timer
T5020.
#### 6.1.3.3 Reception of broadcast mode V2X communication over PC5
The UE may be configured by upper layers with one or more destination layer-2
ID(s) for reception of V2X messages over PC5. For each received protocol data
unit over PC5, the receiving UE shall check if the destination layer-2 ID of
the received protocol data unit matches one of the configured destination
Layer-2 IDs. If yes, the UE shall then check whether the protocol data unit
type as defined 3GPP TS 38.323 [10] provided by the lower layers for the
received packet is set to IP packet or non-IP packet, and pass the protocol
data unit to the corresponding upper layer entity.
### 6.1.4 Groupcast mode communication over PC5
#### 6.1.4.1 Overview
This clause describes the V2X communication over PC5 reference point in
groupcast mode operation. The UE is configured with the related information as
described in clause 5.2.3.
#### 6.1.4.2 Transmission of groupcast mode V2X communication over PC5
##### 6.1.4.2.1 Initiation
##### 6.1.4.2.1.1 Requirements for V2X communication over PC5 {#requirements-
for-v2x-communication-over-pc5-1 .H6}
The requirements for groupcast mode V2X communication over PC5 is the same as
described in clause 6.1.3.2.1.1, with the following additions:
a) When the upper layers request the UE to send a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over PC5, then
the request from the upper layers may include:
1) the group identifier information (i.e. an application-layer V2X group
identifier);
2) the group size and the member IDs;
3) the range requirement; or
4) the communication mode which is set to groupcast mode.
##### 6.1.4.2.1.2 PC5 QoS flow match and establishment {#pc5-qos-flow-match-
and-establishment-1 .H6}
The PC5 QoS flow match and establishment for groupcast mode V2X communication
over PC5 is the same as described in clause 6.1.3.2.1.2, with the following
modifications:
a) The UE shall determine the destination layer-2 ID as:
1) if no group identifier information is provided, then according to the
mapping rules specified in clause 5.2.3, the UE shall use the destination
layer-2 ID corresponding to the V2X service identifier;
2) if group identifier information is provided and there is a context for the
group identifier information, then UE shall use the destination layer-2 ID in
the context for the group identifier information; and
3) if group identifier information is provided and there is no context for the
group identifier information, then the UE shall:
i) use the group identifier as the input to the SHA-256 hashing algorithm as
specified in ISO/IEC 10118-3:2018 [23]; and
ii) use the 24 least significant bits of the 256 bits of the output as
destination layer-2 ID; and
NOTE: SHA-256 hashing algorithm is pre-configured in the ME.
b) If there is no existing context for the destination layer-2 ID and optional
group identifier, the UE shall proceed as:
1) to establish a new context for the destination layer-2 ID and optional
group identifier;
2) self-assign a new source layer-2 ID; and
3) to pass the source/destination layer-2 IDs, optional group size and
optional member IDs to lower layers.
##### 6.1.4.2.2 Transmission
The transmission of groupcast mode V2X communication over PC5 is same as
described in clause 6.1.3.2.2, with the following additions:
a) If group identifier is provided, then the destination layer-2 ID shall be
set to the destination layer-2 ID in the context for the group identifier as
specified in clause 6.1.4.2.1.2.
##### 6.1.4.2.3 Procedure for UE to use provisioned radio resources for V2X
communication over PC5
The procedures described for using NR-PC5 in clause 6.1.3.2.3 apply.
##### 6.1.4.2.4 Privacy of V2X transmission over PC5
The procedures described in clause 6.1.3.2.4 apply with using the privacy
timer T5030 for groupcast.
#### 6.1.4.3 Reception of groupcast mode V2X communication over PC5
The reception of groupcast mode V2X communication over PC5 is the same as
described in clause 6.1.3.3, with the following additions:
a) Besides the configured destination layer-2 ID(s) for reception of V2X
messages over PC5, the UE shall also derive the destination layer-2 ID(s)
based on group identifier(s) if provided by upper layers as specified in
clause 6.1.4.2.1.
## 6.2 V2X communication over Uu
### 6.2.1 General
This clause describes the procedures at the UE and the V2X application server,
for V2X communication over Uu.
There are no additional security or privacy procedures of V2X communication
over Uu beyond those specified in 3GPP TS 33.501 [21] for Uu connectivity with
5GCN.
Both IP based and non-IP based V2X communication over Uu are supported.
V2X messages carried over Uu are sent or received over unicast only in this
release of the specification. Furthermore, V2X messages are carried over Uu
using user data over user plane. For this, the UE first performs the UE-
requested PDU session establishment procedure to establish user-plane resouces
as specified in 3GPP TS 24.501 [6].
Procedures for V2X communication over Uu for V2X services not identified by a
V2X service identifier are out of scope of the present version of the present
specification.
NOTE: The upper layers are responsible for re-assembly of V2X messages and
that is out of scope of 3GPP.
### 6.2.2 Transmission of V2X communication over Uu from UE to V2X application
server
The upper layers can request the UE to send a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over Uu. The
request from the upper layers includes:
a) the V2X message;
b) the V2X service identifier of the V2X service for the V2X message;
c) the type of data in the V2X message (IP or non-IP); and
d) if the V2X message contains non-IP data, the V2X message family (see clause
9.2) of data in the V2X message.
Upon a request from upper layers to send a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over Uu:
a) if the registered PLMN of the UE is not in the list of PLMNs in which the
UE is configured to use V2X communication over Uu as specified in clause
5.2.4, the UE shall determine that the transmission of V2X communication over
Uu from UE to V2X application server is not configured and shall not continue
with the rest of the steps; and
b) if the V2X service identifier is included in the list of V2X service
identifier to PDU session parameters mapping rules specified in clause 5.2.4;
then:
1) the UE shall determine the mapping rule in the list of V2X service
identifier to PDU session parameters mapping rules specified in clause 5.2.4,
such that the mapping rule contains the V2X service identifier provided by
upper layers;
2) the UE shall consider the PDU session type, the SSC mode (if indicated in
determined mapping rule), an S-NSSAI (if indicated in determined mapping rule)
and a DNN (if indicated in determined mapping rule) indicated in the
determined mapping rule as the UE local configuration and request information
of the PDU session via which to send a PDU according to 3GPP TS 24.526 [22].
The UE shall use the transport layer protocol, if indicated in the determined
mapping rule, to transport the V2X message;
3) if the PDU session is of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type:
i) if the V2X service identifier is included in the list of V2X service
identifier to V2X application server address mapping rules as specified in
clause 5.2.4, then:
A) the UE shall discover the V2X application server address for uplink
transport as described in clause 6.2.6. If the V2X application server address
cannot be discovered, the UE shall determine that the transmission of V2X
communication over Uu from UE to V2X application server is not possible and
shall not continue with the rest of the steps;
B) if UDP is to be used for the determined V2X application server address, the
UE shall generate a UDP message as described in IETF RFC 768 [14]. In the UDP
message, the UE shall include the V2X message provided by upper layers in the
data octets field. The UE shall send the UDP message to the determined V2X
application server address; and
C) if TCP is to be used for the determined V2X application server address:
1) if a TCP connection with the determined V2X application server address is
not established yet, the UE shall establish a TCP connection with the
determined V2X application server address; and
2) the UE shall generate one or more TCP message(s) as described in IETF RFC
793 [25]. In the one or more TCP message(s), the UE shall include the V2X
message provided by upper layers in the data octets filed. The UE shall send
the one or more TCP message(s) to the determined V2X application server
address via the TCP connection; and
4) if the PDU session is of \"Unstructured\" PDU session type and the type of
data in the V2X message is non-IP, the UE shall generate a UDP message as
described in IETF RFC 768 [14]. In the UDP message, the UE shall encapsulate
the V2X message provided by upper layers in the data octets field. The UE
shall send the UDP message to the determined V2X application server address.
### 6.2.3 Reception of V2X communication over Uu from UE to V2X application
server
If the V2X application server is configured with one or more UDP ports for
uplink transport or one or more TCP ports for bidirectional transport, of V2X
message(s) of V2X service(s) identified by V2X service identifier(s) using the
V2X communication over Uu as specified in clause 6.2.7:
1) if the V2X application server is configured with a UDP port for uplink
transport, the V2X application server shall extract a V2X message of the V2X
service from a UDP message received on a local IP address and a UDP port; and
2) if the V2X application server is configured with a TCP port for
bidirectional transport, the V2X application server shall listen for incoming
TCP connection(s) on a local IP address and the TCP port, shall accept the
incoming TCP connection(s), shall receive one or more TCP message(s)via the
accepted TCP connection(s) and shall extract a V2X message of the V2X service
from the received one or more TCP message(s).
If the V2X application server is configured to handle data of \"Unstructured\"
PDU Session type for transport of V2X message(s) of V2X service(s) identified
by V2X service identifier(s) using V2X communication over Uu as specified in
clause 6.2.7, the V2X application server shall receive one or more UDP
message(s) as data of a point-to-point tunnel established over N6 and shall
extract a V2X message and a V2X message family (if the V2X message is non-IP
based) from the received UDP message.
### 6.2.4 Transmission of V2X communication over Uu from V2X application
server to UE
The V2X application server shall be configured with UDP port(s), TCP port(s)
or any combination of them for transport of the V2X communication over Uu to
the UE.
If the V2X application server supports V2X messages of IP type of data and of
non-IP type of data, then the V2X application server shall be configured with
different UDP ports or TCP ports for V2X messages of different types of data.
If the V2X application server supports V2X messages of several V2X message
families, then the V2X application server shall be configured with different
UDP ports or TCP ports for V2X messages of different V2X message families.
If the V2X application server determines to use UDP for transmission of the
V2X message identified by a V2X service identifier, the V2X application server
shall generate a UDP message. If the V2X message is of \"Unstructured\" PDU
Session type, then the V2X application server shall encapsulate the V2X
message into IP type data. In the UDP message, the V2X application server:
a) shall set data octets field to the V2X message if the V2X message is of IP
type;
a) shall set data octets field to the encapsulated IP type data if the V2X
message is of \"Unstructured\" PDU Session type; and
c) shall set the destination IP address and the destination UDP port to the
UE\'s IP address and the configured UDP port associated the type of data of
the V2X message and the V2X message family of the data of the V2X message (in
case of non-IP).
The V2X application server sends the UDP message as the user plane data to the
UE.
If the V2X application server determines to use TCP for transmission of the
V2X message identified by a V2X service identifier, the V2X application server
establishes a TCP connection with the UE if no TCP connection exists, then the
V2X application server shall generate one or more TCP message(s). In the one
or more TCP message(s), the V2X application server:
a) shall set data octets field to the V2X message; and
b) shall set the destination IP address and the destination TCP port to the
UE\'s IP address and the configured TCP port associated the type of data of
the V2X message and the V2X message family of the data of the V2X message (in
case of non-IP).
The V2X application server sends the one or more TCP message(s) as the user
plane data to the UE.
### 6.2.5 Reception of V2X communication over Uu from V2X application server
to UE
The upper layers can request the UE to receive a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over Uu. The
request from the upper layers includes:
a) the V2X service identifier of the V2X service for the V2X message to be
received;
b) the type of data in the V2X message to be received (IP or non-IP); and
c) if the V2X message to be received contains non-IP data, the V2X message
family (see clause 9.2) of data in the V2X message to be received.
Upon a request from upper layers to receive a V2X message of a V2X service
identified by a V2X service identifier using V2X communication over Uu:
a) if the registered PLMN of the UE is not in the list of PLMNs in which the
UE is configured to use V2X communication over Uu as specified in clause
5.2.4, the UE shall determine that the transmission of V2X communication over
Uu from V2X application server to UE is not configured and shall not continue
with the rest of the steps; and
b) if the V2X service identifier is included in the list of V2X service
identifier to PDU session parameters mapping rules specified in clause 5.2.4;
then:
1) the UE shall determine the mapping rule in the list of V2X service
identifier to PDU session parameters mapping rules specified in clause 5.2.4,
such that the mapping rule contains the V2X service identifier provided by
upper layers;
2) the UE shall establish a PDU session with the PDU session type, the SSC
mode (if indicated in determined mapping rule), an S-NSSAI (if indicated in
determined mapping rule) and a DNN (if indicated in determined mapping rule)
indicated in the determined mapping rule, if such PDU session does not exist
yet. The UE shall use the transport layer protocol, if indicated in the
determined mapping rule, to receive the V2X message;
3) if the PDU session is of \"IPv4\", \"IPv6\" or \"IPv4v6\" PDU session type:
i) if the V2X service identifier is included in the list of V2X service
identifier to V2X application server address mapping rules as specified in
clause 5.2.4, then:
A) the UE shall discover the V2X application server address for downlink
transport as described in clause 6.2.6. If the V2X application server address
cannot be discovered, the UE shall determine that the transmission of V2X
communication over Uu from V2X application server to UE is not possible and
shall not continue with the rest of the steps. If the V2X service identifier
is not included in the list of V2X service identifier to V2X application
server address mapping rules as specified in clause 5.2.4, the UE shall
continue with the rest of the steps; and
B) if UDP is to be used for the determined V2X application server address:
1) the UE shall select the UDP port for downlink transport based on
configuration parameters for V2X communication as defined in clause 5.2.4; and
2) the UE shall listen for UDP packets over the determined UDP port, and
provide the UDP packets to the upper layers if received; and
C) if TCP is to be used for the determined V2X application server address:
1) if a TCP connection with the determined V2X application server address is
not established yet, the UE shall establish a TCP connection with the
determined V2X application server address; and
2) the UE shall listen for TCP packets over the established TCP connection,
and provide the TCP packets to the upper layers if received; and
4) if the PDU session is of \"Unstructured\" PDU session type and the type of
data in the V2X message is non-IP, the UE shall proceed as UDP is to be used
for the determined V2X application server address with the exeption that the
V2X message is encapsulated as IP type data packets.
### 6.2.6 V2X application server discovery
Before initiating V2X communication over Uu, the UE needs to discover the V2X
application server to which the V2X messages shall be sent or received.
To discover the V2X application server address for uplink transport, the UE
shall proceed as follows, in priority order:
a) if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server IP address and a UDP port for uplink transport or a TCP
port for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN and the
geographical area in which the UE is located as specified in clause 5.2.4, the
UE shall use this IP address and the UDP or TCP port for V2X communication
over Uu;
b) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server FQDN and a UDP port for uplink transport or a TCP port for
bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN and the
geographical area in which the UE is located as specified in clause 5.2.4, the
UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the
resulting IP address and the UDP or TCP port for V2X communication over Uu;
c) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server IP address and a UDP port for uplink transport or a TCP
port for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN as specified in
clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X
communication over Uu;
d) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server FQDN and a UDP port for uplink transport or a TCP port for
bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN as specified
inclause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035
[19], then use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
e) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN, the geographical area in which
the UE is located and the IP type of data as specified in clause 5.2.4 is
configured and contains an IP address and a UDP port for uplink transport or a
TCP port for bidirectional transport, then the UE shall use the IP address and
the UDP or TCP port for V2X communication over Uu;
f) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN, the geographical area in which
the UE is located and the IP type of data as specified in clause 5.2.4 is
configured and contains an FQDN and a UDP port for uplink transport or a TCP
port for bidirectional transport, then the UE shall perform DNS lookup of the
FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP
address and the UDP or TCP port for V2X communication over Uu;
g) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN and the IP type of data as
specified in clause 5.2.4 is configured and contains an IP address and a UDP
port for uplink transport or a TCP port for bidirectional transport, then the
UE shall use the IP address and the UDP or TCP port for V2X communication over
Uu;
h) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN and the IP type of data as
specified in clause 5.2.4 is configured and contains an FQDN and a UDP port
for uplink transport or a TCP port for bidirectional transport, then the UE
shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and
shall use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
i) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN, the geographical
area in which the UE is located and the V2X message family of the non-IP data
as specified in clause 5.2.4 is configured and contains an IP address and a
UDP port for uplink transport or a TCP port for bidirectional transport, then
the UE shall use the IP address and the UDP or TCP port for V2X communication
over Uu;
j) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN, the geographical
area in which the UE is located and the V2X message family of the non-IP data
as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port
for uplink transport or a TCP port for bidirectional transport, then the UE
shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and
shall use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
k) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN and the V2X message
family of the non-IP data as specified in clause 5.2.4 is configured and
contains an IP address and a UDP port for uplink transport or a TCP port for
bidirectional transport, then the UE shall use the IP address and the UDP or
TCP port for V2X communication over Uu;
l) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN and the V2X message
family of the non-IP data as specified in clause 5.2.4 is configured and
contains an FQDN and a UDP port for uplink transport or a TCP port for
bidirectional transport, then the UE shall perform DNS lookup of the FQDN as
specified in IETF RFC 1035 [19], and shall use the resulting IP address and
the UDP or TCP port for V2X communication over Uu;
m) else if the V2X service of the V2X message is not identified by a V2X
service identifier and the UE is configured with a V2X application server IP
address for the serving PLMN and the geographical area in which the UE is
located as specified in clause 5.2.4, the UE shall use this IP address for V2X
communication over Uu;
n) else if the V2X service of the V2X message is not identified by a V2X
service identifier and the UE is configured with a V2X application server FQDN
for the serving PLMN and the geographical area in which the UE is located as
specified in clause 5.2.4, the UE shall perform DNS lookup as specified in
IETF RFC 1035 [19], then use the resulting IP address for V2X communication
over Uu;
o) else if the V2X service of the V2X message is not identified by a V2X
service identifier and the UE is configured with a V2X application server IP
address for the serving PLMN as specified in clause 5.2.4, the UE shall use
this IP address for V2X communication over Uu; and
p) else if the V2X service of the V2X message is not identified by a V2X
service identifier and the UE is configured with a V2X application server FQDN
for the serving PLMN as specified in clause 5.2.4, the UE shall perform DNS
lookup as specified in IETF RFC 1035 [19], then use the resulting IP address
for V2X communication over Uu.
NOTE: It is out of scope of the present specification to define how the UE can
locate itself in a specific geographical area. When the UE is in coverage of a
3GPP RAT it can for example use information derived from the serving PLMN.
When the UE is not in coverage of a 3GPP RAT it can use other techniques.
To discover the V2X application server address for downlink transport, the UE
shall proceed as follows, in priority order:
a) if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server IP address and a UDP port for downlink transport or a TCP
port for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN and the
geographical area in which the UE is located as specified in clause 5.2.4, the
UE shall use this IP address and the UDP or TCP port for V2X communication
over Uu;
b) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server FQDN and a UDP port for downlink transport or a TCP port
for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN and the
geographical area in which the UE is located as specified in clause 5.2.4, the
UE shall perform DNS lookup as specified in IETF RFC 1035 [19], then use the
resulting IP address and the UDP or TCP port for V2X communication over Uu;
c) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server IP address and a UDP port for downlink transport or a TCP
port for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN as specified in
clause 5.2.4, the UE shall use this IP address and the UDP or TCP port for V2X
communication over Uu;
d) else if the V2X service of the V2X message is identified by a V2X service
identifier and this V2X service identifier is associated with a V2X
application server FQDN and a UDP port for downlink transport or a TCP port
for bidirectional transport in the list of V2X service identifier to V2X
application server address mapping rules for the serving PLMN as specified in
clause 5.2.4, the UE shall perform DNS lookup as specified in IETF RFC 1035
[19], then use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
e) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN, the geographical area in which
the UE is located and the IP type of data as specified in clause 5.2.4 is
configured and contains an IP address and a UDP port for downlink transport or
a TCP port for bidirectional transport, then the UE shall use the IP address
and the UDP or TCP port for V2X communication over Uu;
f) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN, the geographical area in which
the UE is located and the IP type of data as specified in clause 5.2.4 is
configured and contains an FQDN and a UDP port for downlink transport or a TCP
port for bidirectional transport, then the UE shall perform DNS lookup of the
FQDN as specified in IETF RFC 1035 [19], and shall use the resulting IP
address and the UDP or TCP port for V2X communication over Uu;
g) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the the serving PLMN and the IP type of data as
specified in clause 5.2.4 is configured and contains an IP address and a UDP
port for downlink transport or a TCP port for bidirectional transport, then
the UE shall use the IP address and the UDP or TCP port for V2X communication
over Uu;
h) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains IP data, and the default V2X application
server address applicable for the serving PLMN and the IP type of data as
specified in clause 5.2.4 is configured and contains an FQDN and a UDP port
for downlink transport or a TCP port for bidirectional transport, then the UE
shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and
shall use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
i) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN, the geographical
area in which the UE is located and the V2X message family of the non-IP data
as specified in clause 5.2.4 is configured and contains an IP address and a
UDP port for downlink transport or a TCP port for bidirectional transport,
then the UE shall use the IP address and the UDP or TCP port for V2X
communication over Uu;
j) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN, the geographical
area in which the UE is located and the V2X message family of the non-IP data
as specified in clause 5.2.4 is configured and contains an FQDN and a UDP port
for downlink transport or a TCP port for bidirectional transport, then the UE
shall perform DNS lookup of the FQDN as specified in IETF RFC 1035 [19], and
shall use the resulting IP address and the UDP or TCP port for V2X
communication over Uu;
k) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN and the V2X message
family of the non-IP data as specified in clause 5.2.4 is configured and
contains an IP address and a UDP port for downlink transport or a TCP port for
bidirectional transport, then the UE shall use the IP address and the UDP or
TCP port for V2X communication over Uu; and
l) else if the V2X service of the V2X message is identified by a V2X service
identifier, the V2X message contains non-IP data, and the default V2X
application server address applicable for the serving PLMN and the V2X message
family of the non-IP data as specified in clause 5.2.4 is configured and
contains an FQDN and a UDP port for downlink transport or a TCP port for
bidirectional transport, then the UE shall perform DNS lookup of the FQDN as
specified in IETF RFC 1035 [19], and shall use the resulting IP address and
the UDP or TCP port for V2X communication over Uu.
If multiple V2X application servers are discovered, the V2X application server
to be used is selected by the V2X application layer.
The UE shall perform V2X application server discovery again when the UE
changes its registered PLMN.
If the V2X application server used by the UE is associated with a particular
geographical area, the UE shall perform V2X application server discovery again
when the UE moves out of that geographical area.
### 6.2.7 V2X application server configuration
For transport of V2X message(s) of V2X service(s) identified by V2X service
identifier(s) using V2X communication over Uu, the V2X application server
shall be configured:
a) with one or more UDP ports for uplink transport;
b) with one or more UDP ports for downlink transport;
c) with one or more TCP ports for bidirectional transport;
d) to handle data of \"Unstructured\" PDU Session type; or
e) any combination of the above.
If the V2X application server is configured with one or more UDP ports for
uplink transport of V2X message(s) of a V2X service(s) identified by V2X
service identifier(s) using V2X communication over Uu:
1) if the V2X application server supports V2X messages of IP type of data and
of non-IP type of data, then the V2X application server shall be configured
with different UDP ports for V2X messages of different types of data; and
2) if the V2X application server supports V2X messages of several V2X message
families, then the V2X application server shall be configured with different
UDP ports for V2X messages of different V2X message families.
# 6A Handling of unknown, unforeseen, and erroneous PC5 signalling protocol
data
## 6A.1 General
The procedures specified in clause 6.1 apply to those messages which pass the
checks described in clause 6A.
Clause 6A also specifies procedures for the handling of unknown, unforeseen,
and erroneous PC5 signalling protocol data by the receiving entity. These
procedures are called \"error handling procedures\", but in addition to
providing recovery mechanisms for error situations they define a compatibility
mechanism for future extensions of the PC5 signalling protocol.
Clauses 6A.1 to 6A.7 shall be applied in order of precedence.
Detailed error handling procedures in the peer UE are implementation dependent
and may vary. However, when extensions of PC5 signalling protocol are
developed, the peer UE are assumed to have the error handling which is
indicated in this clause as mandatory (\"shall\") and that is indicated as
strongly recommended (\"should\").
Also, the error handling of the peer UE is only considered as mandatory or
strongly recommended when certain thresholds for errors are not reached during
a dedicated connection.
For definition of semantical and syntactical errors see 3GPP TS 24.007 [26],
clause 11.4.2.
## 6A.2 Message too short or too long
### 6A.2.1 Message too short
When a message is received that is too short to contain a complete message
type information element, that message shall be ignored, cf. 3GPP TS 24.007
[26].
### 6A.2.2 Message too long
The maximum size of a PC5 signalling message is 65535 octets.
## 6A.3 Unknown or unforeseen message type
If the UE or the peer UE receives a PC5 signalling message with message type
not defined for the PC5 signalling protocol or not implemented by the
receiver, it shall ignore the PC5 signalling message.
NOTE: A message type not defined for the PC5 signalling protocol in the given
direction is regarded by the receiver as a message type not defined for the
PC5 signalling protocol, see 3GPP TS 24.007 [26].
If the UE receives a message not compatible with the PC5 signalling protocol
state, the UE shall ignore the PC5 signalling message.
If the peer UE receives a message not compatible with the Pc5 signalling
protocol state, the peer UE actions are implementation dependent.
## 6A.4 Non-semantical mandatory information element errors
When on receipt of a message,
a) an \"imperative message part\" error; or
b) a \"missing mandatory IE\" error
is diagnosed or when a message containing:
a) a syntactically incorrect mandatory IE;
b) an IE unknown in the message, but encoded as \"comprehension required\"
(see 3GPP TS 24.007 [26]); or
c) an out of sequence IE encoded as \"comprehension required\" (see 3GPP TS
24.007 [26]) is received,
the UE shall ignore the PC5 signalling message and the peer UE shall:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message.
## 6A.5 Unknown and unforeseen IEs in the non-imperative message part
### 6A.5.1 IEIs unknown in the message
The UE shall ignore all IEs unknown in a message which are not encoded as
\"comprehension required\" (see 3GPP TS 24.007 [26]).
The peer UE shall take the same approach.
### 6A.5.2 Out of sequence IEs
The UE shall ignore all out of sequence IEs in a message which are not encoded
as \"comprehension required\" (see 3GPP TS 24.007 [26]).
The peer UE should take the same approach.
### 6A.5.3 Repeated IEs
If an information element with format T, TV, TLV, or TLV-E is repeated in a
message in which repetition of the information element is not specified in
clause 8.4, the UE shall handle only the contents of the information element
appearing first and shall ignore all subsequent repetitions of the information
element. When repetition of information elements is specified, the UE shall
handle only the contents of specified repeated information elements. If the
limit on repetition of information elements is exceeded, the UE shall handle
the contents of information elements appearing first up to the limit of
repetitions and shall ignore all subsequent repetitions of the information
element.
The peer UE should follow the same procedures.
## 6A.6 Non-imperative message part errors
### 6A.6.1 General
This category includes:
a) syntactically incorrect optional IEs; and
b) conditional IE errors.
### 6A.6.2 Syntactically incorrect optional IEs
The UE shall treat all optional IEs that are syntactically incorrect in a
message as not present in the message.
The peer UE shall take the same approach.
### 6A.6.3 Conditional IE errors
When upon receipt of a PC5 signalling message the UE diagnoses a \"missing
conditional IE\" error or an \"unexpected conditional IE\" error, or when it
receives a PC5 signalling message containing at least one syntactically
incorrect conditional IE, the UE shall ignore the message.
When the peer UE receives a message and diagnoses a \"missing conditional IE\"
error or an \"unexpected conditional IE\" error or when it receives a message
containing at least one syntactically incorrect conditional IE, the peer UE
shall either:
a) try to treat the message (the exact further actions are implementation
dependent); or
b) ignore the message.
## 6A.7 Messages with semantically incorrect contents
When a message with semantically incorrect contents is received, the UE shall
perform the foreseen reactions of the procedural part of clause 6.1. If,
however no such reactions are specified, the UE shall ignore the message.
The peer UE should follow the same procedure.
# 7 Message functional definition and contents
## 7.1 Overview
This clause contains the definition and contents of the messages used in the
procedures described in the present document.
## 7.2 Provisioning of parameters for V2X configuration signalling messages
### 7.2.1 UE policy provisioning request
#### 7.2.1.1 Message definition
The UE POLICY PROVISIONING REQUEST message is sent by the UE to the PCF to
request the PCF to manage V2XP, see table 7.2.1.1.1
Message type: UE POLICY PROVISIONING REQUEST
Significance: dual
Direction: UE to network
Table 7.2.1.1.1: UE POLICY PROVISIONING REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | TS 2 | | | | | | | 4 501 [4] | | | | | | | clause 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE POLICY | UE policy | M | V | 1 | | | P | delivery | | | | | | ROVISIONING | service | | | | | | REQUEST | message | | | | | | message | type | | | | | | identity | | | | | | | | TS 2 | | | | | | | 4 501 [4] | | | | | | | c | | | | | | | lause D.6.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Requested | Requested | M | LV | 2-3 | | | UE policies | UE policies | | | | | | | | | | | | | | 8.3.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.2.2 UE policy provisioning reject
#### 7.2.2.1 Message definition
The UE POLICY PROVISIONING REJECT message is sent by the PCF to the UE to
report that the PCF rejects request to manage V2XP, see table 7.2.2.1.1
Message type: UE POLICY PROVISIONING REJECT
Significance: dual
Direction: network to UE
Table 7.2.2.1.1: UE POLICY PROVISIONING REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | PTI | Procedure | M | V | 1 | | | | transaction | | | | | | | identity | | | | | | | | | | | | | | TS 2 | | | | | | | 4 501 [4] | | | | | | | clause 9.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE POLICY | UE policy | M | V | 1 | | | P | delivery | | | | | | ROVISIONING | service | | | | | | REJECT | message | | | | | | message | type | | | | | | identity | | | | | | | | TS 2 | | | | | | | 4 501 [4] | | | | | | | c | | | | | | | lause D.6.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UPDS cause | UPDS cause | M | V | 1 | | | | | | | | | | | 8.3.1 | | | | +-----+-------------+-------------+----------+--------+--------+
## 7.3 V2X communication over PC5 signalling messages
### 7.3.1 Direct link establishment request
#### 7.3.1.1 Message definition
This message is sent by a UE to another peer UE to establish a direct link.
See table 7.3.1.1.1.
Message type: DIRECT LINK ESTABLISHMENT REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.1.1.1: DIRECT LINK ESTABLISHMENT REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | ES | signalling | | | | | | TABLISHMENT | message | | | | | | REQUEST | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | V2X service | V2X service | M | LV | 5-253 | | | identifiers | identifier | | | | | | | | | | | | | | 8.4.3 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Source user | Application | M | LV | 3-253 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE security | UE security | M | LV | 3-9 | | | c | c | | | | | | apabilities | apabilities | | | | | | | | | | | | | | 8.4.14 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE PC5 | UE PC5 | M | V | 1 | | | unicast | unicast | | | | | | signalling | signalling | | | | | | security | security | | | | | | policy | policy | | | | | | | | | | | | | | 8.4.15 | | | | +-----+-------------+-------------+----------+--------+--------+ | 74 | Key | Key | O | TLV-E | 4-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+ | 53 | Nonce_1 | Nonce | O | TV | 17 | | | | | | | | | | | 8.4.13 | | | | +-----+-------------+-------------+----------+--------+--------+ | 54 | MSBs of | MSBs of | O | TV | 2 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.16 | | | | +-----+-------------+-------------+----------+--------+--------+ | 28 | Target user | Application | O | TLV | 4-254 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 52 | K~NRP~ ID | K~NRP~ ID | O | TV | 5 | | | | | | | | | | | 8.4.17 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.1.2 Target user info
The UE shall include this IE if it has received the target UE\'s application
layer ID from upper layers or if the destination layer-2 ID is the unicast
layer-2 ID of target UE.
#### 7.3.1.3 Key establishment information container
The UE shall include this IE if the UE PC5 unicast signalling security policy
is set to \"signalling integrity protection required\" or \"signalling
integrity protection preferred\".
#### 7.3.1.4 Nonce_1
The UE shall include this IE if the UE PC5 unicast signalling security policy
is set to \"signalling integrity protection required\" or \"signalling
integrity protection preferred\".
#### 7.3.1.5 MSBs of K~NRP-sess~ ID
The UE shall include this IE if the UE PC5 unicast signalling security policy
is set to \"signalling integrity protection required\" or \"signalling
integrity protection preferred\".
#### 7.3.1.6 K~NRP~ ID
The UE may include this IE if it has an existing K~NRP~ for the target UE.
### 7.3.2 Direct link establishment accept
#### 7.3.2.1 Message definition
This message is sent by a UE to another peer UE to accept the received DIRECT
LINK ESTABLISHMENT REQUEST message. See table 7.3.2.1.1.
Message type: DIRECT LINK ESTABLISHMENT ACCEPT
Significance: dual
Direction: UE to peer UE
Table 7.3.2.1.1: DIRECT LINK ESTABLISHMENT ACCEPT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +-----+------------+------------+----------+--------+---------+ | | DIRECT | PC5 | M | V | 1 | | | LINK | signalling | | | | | | EST | message | | | | | | ABLISHMENT | type | | | | | | ACCEPT | | | | | | | message | 8.4.1. | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Source | A | M | LV | 3-253 | | | user info | pplication | | | | | | | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+------------+------------+----------+--------+---------+ | | QoS flow | PC5 QoS | M | LV-E | 5-65537 | | | de | flow | | | | | | scriptions | de | | | | | | | scriptions | | | | | | | | | | | | | | 8.4.5 | | | | +-----+------------+------------+----------+--------+---------+ | | Con | Con | M | V | 1 | | | figuration | figuration | | | | | | of UE PC5 | of UE PC5 | | | | | | unicast | unicast | | | | | | user plane | user plane | | | | | | security | security | | | | | | protection | protection | | | | | | | | | | | | | | 8.4.23 | | | | +-----+------------+------------+----------+--------+---------+ | 57 | IP address | IP address | O | TV | 2 | | | con | con | | | | | | figuration | figuration | | | | | | | | | | | | | | 8.4.6 | | | | +-----+------------+------------+----------+--------+---------+ | 58 | Link local | Link local | O | TV | 17 | | | IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+------------+------------+----------+--------+---------+
#### 7.3.2.2 IP address configuration
The UE shall include this IE if IP communication is used.
#### 7.3.2.3 Link local IPv6 address
The UE shall include this IE if IP communication is used and the IP address
configuration is set to \"IPv6 address allocation not supported\".
### 7.3.3 Void
### 7.3.4 Direct link modification request
#### 7.3.4.1 Message definition
This message is sent by the UE to another peer UE to initiate the direct link
modification procedure. See table 7.3.4.1.1.
Message type: DIRECT LINK MODIFICATION REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.4.1.1: DIRECT LINK MODIFICATION REQUEST message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +-----+------------+------------+----------+--------+---------+ | | DIRECT | PC5 | M | V | 1 | | | LINK | signalling | | | | | | MO | message | | | | | | DIFICATION | type | | | | | | REQUEST | | | | | | | message | 8.4.1 | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | | Link | Link | M | V | 1 | | | mo | mo | | | | | | dification | dification | | | | | | operation | operation | | | | | | code | code | | | | | | | | | | | | | | 8.4.8 | | | | +-----+------------+------------+----------+--------+---------+ | | QoS flow | PC5 QoS | M | LV-E | 5-65537 | | | de | flow | | | | | | scriptions | de | | | | | | | scriptions | | | | | | | | | | | | | | 8.4.5 | | | | +-----+------------+------------+----------+--------+---------+
### 7.3.5 Direct link modification accept
#### 7.3.5.1 Message definition
This message is sent by the UE to another peer UE to indicate that the link
modification request is accepted. See table 7.3.5.1.
Message type: DIRECT LINK MODIFICATION ACCEPT
Significance: dual
Direction: UE to peer UE
Table 7.3.5.1.1: DIRECT LINK MODIFICATION ACCEPT message content
+-----+------------+------------+----------+--------+---------+ | IEI | I | Type | Presence | Format | Length | | | nformation | /Reference | | | | | | Element | | | | | +-----+------------+------------+----------+--------+---------+ | | DIRECT | PC5 | M | V | 1 | | | LINK | signalling | | | | | | MO | message | | | | | | DIFICATION | type | | | | | | ACCEPT | | | | | | | message | 8.4.1 | | | | | | identity | | | | | +-----+------------+------------+----------+--------+---------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+------------+------------+----------+--------+---------+ | 79 | QoS flow | PC5 QoS | O | TLV-E | 6-65538 | | | de | flow | | | | | | scriptions | de | | | | | | | scriptions | | | | | | | | | | | | | | 8.4.5 | | | | +-----+------------+------------+----------+--------+---------+
#### 7.3.5.2 QoS flow descriptions
The UE shall include this IE if the PC5 unicast link modification procedure is
to:
a) add new PC5 QoS flow(s) to the existing PC5 unicast link;
b) modify PC5 QoS parameters of the existing PC5 QoS flow(s);
c) associate new V2X service(s) with existing PC5 QoS flow(s); or
d) remove V2X service(s) from existing PC5 QoS flow(s).
### 7.3.6 Direct link release request
#### 7.3.6.1 Message definition
This message is sent by the UE to another peer UE to initiate the direct link
release procedure. See table 7.3.6.1.1.
Message type: DIRECT LINK RELEASE REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.6.1.1: DIRECT LINK RELEASE REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | RELEASE | signalling | | | | | | REQUEST | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause | cause | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+ | | MSB of KNRP | MSB of KNRP | M | V | 2 | | | ID | ID | | | | | | | | | | | | | | 8.4.20 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.7 Direct link release request accept
#### 7.3.7.1 Message definition
This message is sent by the UE to another peer UE to indicate that the link
release request is accepted. See table 7.3.7.1.
Message type: DIRECT LINK RELEASE ACCEPT
Significance: dual
Direction: UE to peer UE
Table 7.3.7.1: DIRECT LINK RELEASE ACCEPT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT_LI | PC5 | M | V | 1 | | | NK_RELEASE | signalling | | | | | | ACCEPT | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | LSB of KNRP | LSB of KNRP | M | V | 2 | | | ID | ID | | | | | | | | | | | | | | 8.4.21 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.8 Direct link keepalive request
#### 7.3.8.1 Message definition
This message is sent by a UE to another peer UE when a PC5 unicast link keep-
alive procedure is initiated. See table 7.3.8.1.1.
Message type: DIRECT LINK KEEPALIVE REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.8.1.1: DIRECT LINK KEEPALIVE REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | KEEPALIVE | signalling | | | | | | REQUEST | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Keep-alive | Keep-alive | M | V | 4 | | | counter | counter | | | | | | | | | | | | | | 8.4.10 | | | | +-----+-------------+-------------+----------+--------+--------+ | 55 | Maximum | Maximum | O | TV | 5 | | | inactivity | inactivity | | | | | | period | period | | | | | | | | | | | | | | 8.4.11 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.8.2 Maximum inactivity period
The UE may include this IE to indicate its maximum inactivity period to the
peer UE.
### 7.3.9 Direct link keepalive response
#### 7.3.9.1 Message definition
This message is sent by a UE to another peer UE to respond to a DIRECT LINK
KEEPALIVE REQUEST message. See table 7.3.9.1.1.
Message type: DIRECT LINK KEEPALIVE RESPONSE
Significance: dual
Direction: UE to peer UE
Table 7.3.9.1.1: DIRECT LINK KEEPALIVE RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | KEEPALIVE | signalling | | | | | | RESPONSE | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Keep-alive | Keep-alive | M | V | 4 | | | counter | counter | | | | | | | | | | | | | | 8.4.10 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.10 Direct link authentication request
#### 7.3.10.1 Message definition
This message is sent by a UE to another peer UE when a PC5 unicast link
authentication procedure is initiated. See table 7.3.10.1.1.
Message type: DIRECT LINK AUTHENTICATION REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.10.1.1: DIRECT LINK AUTHENTICATION REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | AUT | signalling | | | | | | HENTICATION | message | | | | | | REQUEST | type | | | | | | message | | | | | | | identity | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Key | Key | M | LV-E | 3-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.11 Direct link authentication response
#### 7.3.11.1 Message definition
This message is sent by a UE to another peer UE to respond to a DIRECT LINK
AUTHENTICATION REQUEST message. See table 7.3.11.1.1.
Message type: DIRECT LINK AUTHENTICATION RESPONSE
Significance: dual
Direction: UE to peer UE
Table 7.3.11.1.1: DIRECT LINK AUTHENTICATION RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | AUT | signalling | | | | | | HENTICATION | message | | | | | | RESPONSE | type | | | | | | message | | | | | | | identity | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Key | Key | M | LV-E | 3-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.12 Direct link authentication reject
#### 7.3.12.1 Message definition
This message is sent by a UE to another peer UE to reject a DIRECT LINK
AUTHENTICATION REQUEST message. See table 7.3.12.1.1.
Message type: DIRECT LINK AUTHENTICATION REJECT
Significance: dual
Direction: UE to peer UE
Table 7.3.12.1.1: DIRECT LINK AUTHENTICATION REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | AUT | signalling | | | | | | HENTICATION | message | | | | | | REJECT | type | | | | | | message | | | | | | | identity | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause value | cause value | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.13 Direct link security mode command
#### 7.3.13.1 Message definition
This message is sent by a UE to another peer UE when a PC5 unicast link
security mode control procedure is initiated. See table 7.3.13.1.1.
Message type: DIRECT LINK SECURITY MODE COMMAND
Significance: dual
Direction: UE to peer UE
Table 7.3.13.1.1: DIRECT LINK SECURITY MODE COMMAND message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | SECURITY | signalling | | | | | | MODE | message | | | | | | COMMAND | type | | | | | | message | | | | | | | identity | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Selected | Selected | M | V | 1 | | | security | security | | | | | | algorithms | algorithms | | | | | | | | | | | | | | 8.4.18 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE security | UE security | M | LV | 3-9 | | | c | c | | | | | | apabilities | apabilities | | | | | | | | | | | | | | 8.4.14 | | | | +-----+-------------+-------------+----------+--------+--------+ | 59 | UE PC5 | UE PC5 | O | TV | 2 | | | unicast | unicast | | | | | | signalling | signalling | | | | | | security | security | | | | | | policy | policy | | | | | | | | | | | | | | 8.4.15 | | | | +-----+-------------+-------------+----------+--------+--------+ | 55 | Nonce_2 | Nonce | O | TV | 17 | | | | | | | | | | | 8.4.13 | | | | +-----+-------------+-------------+----------+--------+--------+ | 52 | LSBs of | LSBs of | O | TV | 2 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.19 | | | | +-----+-------------+-------------+----------+--------+--------+ | 74 | Key | Key | O | TLV-E | 4-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+ | 62 | MSBs of | MSBs of | O | TV | 3 | | | K~NRP~ ID | K~NRP~ ID | | | | | | | | | | | | | | 8.4.20 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.13.2 Nonce_2
The UE shall include this IE if the selected integrity protection algorithms
is not the null integrity protection algorithm.
#### 7.3.13.3 LSBs of KNRP-sess ID
The UE shall include this IE if the selected integrity protection algorithms
is not the null integrity protection algorithm.
#### 7.3.13.4 Key establishment information container
The UE shall include this IE if the UE has derived a new K~NRP~ and the
authentication method used to generate K~NRP~ requires sending information to
complete the authentication procedure.
#### 7.3.13.5 MSBs of K~NRP~ ID
The UE shall include this IE if the UE has derived a new K~NRP~.
#### 7.3.13.6 UE PC5 unicast signalling security policy
The UE shall include this IE if the DIRECT LINK SECURITY MODE COMMAND message
is triggered by the DIRECT LINK ESTABLISHMENT REQUEST message. The content of
the IE is the same as the content of UE PC5 unicast signalling security policy
IE in the received DIRECT LINK ESTABLISHMENT REQUEST message in order to
provide protection against bidding down attacks.
### 7.3.14 Direct link security mode complete
#### 7.3.14.1 Message definition
This message is sent by a UE to another peer UE to respond to a DIRECT LINK
SECURITY MODE COMMAND message. See table 7.3.14.1.1.
Message type: DIRECT LINK SECURITY MODE COMPLETE
Significance: dual
Direction: UE to peer UE
Table 7.3.14.1.1: DIRECT LINK SECURITY MODE COMPLETE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | SECURITY | signalling | | | | | | MODE | message | | | | | | COMPLETE | type | | | | | | message | | | | | | | identity | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | QoS flow | PC5 QoS | M | LV-E | 6-n | | | d | flow | | | | | | escriptions | d | | | | | | | escriptions | | | | | | | | | | | | | | 8.4.5 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE PC5 | UE PC5 | M | V | 1 | | | unicast | unicast | | | | | | user plane | user plane | | | | | | security | security | | | | | | policy | policy | | | | | | | | | | | | | | 8.4.22 | | | | +-----+-------------+-------------+----------+--------+--------+ | 57 | IP address | IP address | O | TV | 2 | | | co | co | | | | | | nfiguration | nfiguration | | | | | | | | | | | | | | 8.4.6 | | | | +-----+-------------+-------------+----------+--------+--------+ | 58 | Link local | Link local | O | TV | 17 | | | IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | 52 | LSBs of | LSBs of | O | TV | 3 | | | K~NRP~ ID | K~NRP~ ID | | | | | | | | | | | | | | 8.4.21 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.14.2 IP address configuration
The UE shall include this IE if IP communication is used and the PC5 unicast
link security mode control procedure was triggered during a PC5 unicast link
establishment procedure.
#### 7.3.14.3 Link local IPv6 address
The UE shall include this IE if IP communication is used, the IP address
configuration is set to \"IPv6 address allocation not supported\" and the PC5
unicast link security mode control procedure was triggered during a PC5
unicast link establishment procedure.
#### 7.3.14.4 LSBs of K~NRP~ ID
The UE shall include this IE if a new K~NRP~ was derived.
### 7.3.15 Direct link security mode reject
#### 7.3.15.1 Message definition
This message is sent by a UE to another peer UE to reject a DIRECT LINK
SECURITY MODE COMMAND message. See table 7.3.15.1.1.
Message type: DIRECT LINK SECURITY MODE REJECT
Significance: dual
Direction: UE to peer UE
Table 7.3.15.1.1: DIRECT LINK SECURITY MODE REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | SECURITY | signalling | | | | | | MODE REJECT | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause | cause | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.16 Direct link rekeying request
#### 7.3.16.1 Message definition
This message is sent by a UE to another peer UE when a PC5 unicast link re-
keying procedure is initiated. See table 7.3.16.1.1.
Message type: DIRECT LINK REKEYING REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.16.1.1: DIRECT LINK REKEYING REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | REKEYING | signalling | | | | | | REQUEST | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | UE security | UE security | M | LV | 3-9 | | | c | c | | | | | | apabilities | apabilities | | | | | | | | | | | | | | 8.4.14 | | | | +-----+-------------+-------------+----------+--------+--------+ | 74 | Key | Key | O | TLV-E | 4-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+ | 53 | Nonce_1 | Nonce | O | TV | 17 | | | | | | | | | | | 8.4.13 | | | | +-----+-------------+-------------+----------+--------+--------+ | 54 | MSBs of | MSBs of | O | TV | 2 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.16 | | | | +-----+-------------+-------------+----------+--------+--------+ | 56 | Re-aut | Re-aut | O | TV | 2 | | | hentication | hentication | | | | | | indication | indication | | | | | | | | | | | | | | 8.4.24 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.16.2 Key establishment information container
The UE shall include this IE if the null integrity protection algorithm is not
in use.
#### 7.3.16.3 Nonce_1
The UE shall include this IE if the null integrity protection algorithm is not
in use.
#### 7.3.16.4 MSBs of KNRP-sess ID
The UE shall include this IE if the null integrity protection algorithm is not
in use.
#### 7.3.16.5 Re-authentication indication
The UE shall include this IE if the UE wants to derive a new K~NRP~.
### 7.3.17 Direct link rekeying response
#### 7.3.17.1 Message definition
This message is sent by a UE to another peer UE to respond to a DIRECT LINK
REKEYING REQUEST message. See table 7.3.17.1.1.
Message type: DIRECT LINK REKEYING RESPONSE
Significance: dual
Direction: UE to peer UE
Table 7.3.17.1.1: DIRECT LINK REKEYING RESPONSE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | REKEYING | signalling | | | | | | RESPONSE | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1. | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.18 Direct link identifier update request
#### 7.3.18.1 Message definition
This message is sent by a UE to another peer UE to initiate the direct link
identifier procedure. See table 7.3.18.1.1.
Message type: DIRECT LINK IDENTIFIER UPDATE REQUEST
Significance: dual
Direction: UE to peer UE
Table 7.3.18.1.1: DIRECT LINK IDENTIFIER UPDATE REQUEST message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | IDENTIFIER | signalling | | | | | | UPDATE | message | | | | | | REQUEST | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | MSB of | MSB of | M | V | 1 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.16 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Source | Layer-2 ID | M | V | 3 | | | layer-2 ID | | | | | | | | 8.4.25 | | | | +-----+-------------+-------------+----------+--------+--------+ | 57 | Source user | Application | O | TLV | 4-254 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 58 | Source link | Link local | O | TV | 17 | | | local IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.18.2 Source user info
This IE is included when the initiating UE receives a new application layer
ID.
#### 7.3.18.3 Source link local IPv6 address
This IE is included when the link local IPv6 address changes at the initiating
UE.
### 7.3.19 Direct link identifier update accept
#### 7.3.19.1 Message definition
This message is sent by the UE to another peer UE to indicate that the link
identifier update request is accepted. See table 7.3.19.1.1.
Message type: DIRECT LINK IDENTIFIER UPDATE ACCEPT
Significance: dual
Direction: UE to peer UE
Table 7.3.19.1.1: DIRECT LINK IDENTIFIER UPDATE ACCEPT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | IDENTIFIER | signalling | | | | | | UPDATE | message | | | | | | ACCEPT | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | LSB of | LSB of | M | V | 1 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.19 | | | | +-----+-------------+-------------+----------+--------+--------+ | | MSB of | MSB of | M | V | 1 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.16 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Source | Layer-2 ID | M | V | 3 | | | layer-2 ID | | | | | | | | 8.4.25 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Target | Layer-2 ID | M | V | 3 | | | layer-2 ID | | | | | | | | 8.4.25 | | | | +-----+-------------+-------------+----------+--------+--------+ | 28 | Target user | Application | O | TLV | 4-254 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 59 | Target link | Link local | O | TV | 17 | | | local IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+-------------+-------------+----------+--------+--------+ | 57 | Source user | Application | O | TLV | 4-254 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 58 | Source link | Link local | O | TV | 17 | | | local IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.19.2 Target user info
This IE is included if the target UE receives the Source user info IE in the
DIRECT LINK IDENTIFIER UPDATE REQUEST message.
#### 7.3.19.3 Target link local IPv6 address
This IE is included if the target UE receives the Source link local IPv6
address IE in the DIRECT LINK IDENTIFIER UPDATE REQUEST message.
#### 7.3.19.4 Source user info
This IE is included when the application layer ID changes at the target UE and
the target UE receives a new application layer ID from the upper layers.
#### 7.3.19.5 Source link local IPv6 address
This IE is included when the link local IPv6 address changes at the target UE
[ and the target UE receives a new link local IPv6 address from the upper
layers]{.underline}.
### 7.3.20 Direct link identifier update ack
#### 7.3.20.1 Message definition
This message is sent by the initiating UE to target UE to indicate that the
initiating UE has received target UE\'s accept message. See table 7.3.20.1.1.
Message type: DIRECT LINK IDENTIFIER UPDATE ACK
Significance: dual
Direction: UE to peer UE
Table 7.3.20.1.1: DIRECT LINK IDENTIFIER UPDATE ACK message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | IDENTIFIER | signalling | | | | | | UPDATE ACK | message | | | | | | message | type | | | | | | identity | | | | | | | | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | LSB of | LSB of | M | V | 1 | | | K~NRP-sess~ | K~NRP-sess~ | | | | | | ID | ID | | | | | | | | | | | | | | 8.4.19 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Target | Layer-2 ID | M | V | 3 | | | layer-2 ID | | | | | | | | 8.4.25 | | | | +-----+-------------+-------------+----------+--------+--------+ | 28 | Target user | Application | O | TLV | 4-254 | | | info | layer ID | | | | | | | | | | | | | | 8.4.4 | | | | +-----+-------------+-------------+----------+--------+--------+ | 59 | Target link | Link local | O | TV | 17 | | | local IPv6 | IPv6 | | | | | | address | address | | | | | | | | | | | | | | 8.4.7 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.20.2 Target user info
This IE is included when the initiating UE receives the Source user info IE in
the DIRECT LINK IDENTIFIER UPDATE ACCEPT message.
#### 7.3.20.3 Target link local IPv6 address
This IE is included when the initiating UE receives the Source link local IPv6
address IE in the DIRECT LINK IDENTIFIER UPDATE ACCEPT message.
### 7.3.21 Direct link identifier update reject
#### 7.3.21.1 Message definition
This message is sent by the target UE to initiating UE to indicate that the
link identifier update request is not accepted. See table 7.3.21.1.1.
Message type: DIRECT LINK IDENTIFIER UPDATE REJECT
Significance: dual
Direction: UE to peer UE
Table 7.3.21.1.1: DIRECT LINK IDENTIFIER UPDATE REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | IDENTIFIER | signalling | | | | | | UPDATE | message | | | | | | REJECT | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause | cause | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.22 Direct link modification reject
#### 7.3.22.1 Message definition
This message is sent by the UE to another peer UE to indicate that the link
modification request is not accepted. See table 7.3.22.1.1.
Message type: DIRECT LINK MODIFICATION REJECT
Significance: dual
Direction: UE to peer UE
Table 7.3.22.1.1: DIRECT LINK MODIFICATION REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | M | signalling | | | | | | ODIFICATION | message | | | | | | REJECT | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause | cause | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.23 Direct link establishment reject
#### 7.3.23.1 Message definition
This message is sent by the UE to another peer UE to indicate that the link
establishment request is not accepted. See table 7.3.23.1.1.
Message type: DIRECT LINK ESTABLISHMENT REJECT
Significance: dual
Direction: UE to peer UE
Table 7.3.23.1.1: DIRECT LINK ESTABLISHMENT REJECT message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | ES | signalling | | | | | | TABLISHMENT | message | | | | | | REJECT | type | | | | | | message | | | | | | | identity | 8.4.1 | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | | PC5 | PC5 | M | V | 1 | | | signalling | signalling | | | | | | protocol | protocol | | | | | | cause | cause | | | | | | | | | | | | | | 8.4.9 | | | | +-----+-------------+-------------+----------+--------+--------+
### 7.3.24 Direct link authentication failure
#### 7.3.24.1 Message definition
This message is sent by a UE to another peer UE to reject a DIRECT LINK
AUTHENTICATION RESPONSE message. See table 7.3.24.1.1.
Message type: DIRECT LINK AUTHENTICATION FAILURE
Significance: dual
Direction: UE to peer UE
Table 7.3.24.1.1: DIRECT LINK AUTHENTICATION FAILURE message content
+-----+-------------+-------------+----------+--------+--------+ | IEI | Information | Typ | Presence | Format | Length | | | Element | e/Reference | | | | +-----+-------------+-------------+----------+--------+--------+ | | DIRECT LINK | PC5 | M | V | 1 | | | AUT | signalling | | | | | | HENTICATION | message | | | | | | FAILURE | type | | | | | | message | | | | | | | identity | | | | | +-----+-------------+-------------+----------+--------+--------+ | | Sequence | Sequence | M | V | 1 | | | number | number | | | | | | | | | | | | | | 8.4.2 | | | | +-----+-------------+-------------+----------+--------+--------+ | 74 | Key | Key | O | TLV-E | 4-n | | | es | es | | | | | | tablishment | tablishment | | | | | | information | information | | | | | | container | container | | | | | | | | | | | | | | 8.4.12 | | | | +-----+-------------+-------------+----------+--------+--------+
#### 7.3.24.2 Key establishment information container
The UE shall include this IE if it is provided by upper layers.
# 8 Information elements coding
## 8.1 Overview
This clause contains the information elements coding for the messages used in
the procedures described in the present document.
## 8.2 General
The sending entity shall set the value of a spare bit to zero. The receiving
entity shall ignore the value of a spare bit.
The sending entity shall not set the value of a field to a reserved value. The
receiving entity shall discard a message carrying a field with the value set
to a reserved value.
## 8.3 Provisioning of parameters for V2X configuration signalling information
elements
### 8.3.1 UPDS cause
The purpose of the UPDS cause information element is to indicate the reason
why a UPDS request is rejected.
The UPDS cause information element is coded as shown in figure 8.3.2.1 and
table 8.3.2.1.
The UPDS cause is a type 3 information element with 2 octets length.
* * *
8 7 6 5 4 3 2 1  
UPDS cause IEI octet 1  
Cause value octet 2
* * *
Figure 8.3.2.1: UPDS cause information element
Table 8.3.2.1: UPDS cause information element
* * *
Cause value (octet 2)
Bits  
8 7 6 5 4 3 2 1  
0 0 0 1 1 1 1 1 Request rejected, unspecified 0 0 1 0 0 0 0 0 Service option
not supported 0 0 1 0 0 0 1 0 Service option temporarily out of order 0 0 1 0
0 0 1 1 PTI already in use 0 1 0 1 1 1 1 1 Semantically incorrect message 0 1
1 0 0 0 0 0 Invalid mandatory information 0 1 1 0 0 0 0 1 Message type non-
existent or not implemented 0 1 1 0 0 0 1 0 Message type not compatible with
the protocol state 0 1 1 0 0 0 1 1 Information element non-existent or not
implemented 0 1 1 0 0 1 0 0 Conditional IE error 0 1 1 0 1 1 1 1 Protocol
error, unspecified
Any other value received by the UE shall be treated as 0010 0010, \"service
option temporarily out of order\". Any other value received by the network
shall be treated as 0110 1111, \"protocol error, unspecified\".
* * *
### 8.3.2 Requested UE policies
The purpose of the Requested UE policies information element is to enable the
UE to request the PCF to provide certain UE policies or certain UE policy
subsets.
The Requested UE policies information element is coded as shown in figure
8.3.2.1 and table 8.3.2.1.
The Requested UE policies is a type 4 information element with a minimum
length of 3 octets and a maximum length of 4 octets.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Requ | octet | | | | | | | | | ested | 1 | | | | | | | | | UE | | | | | | | | | | pol | | | | | | | | | | icies | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of | | | | | | | | | | Requ | | | | | | | | | | ested | | | | | | | | | | UE | | | | | | | | | | pol | | | | | | | | | | icies | | | | | | | | | | con | | | | | | | | | | tents | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | V | V2 | octet | | | | | | | | 2XUUI | XPC5I | 3 | | Spare | Spare | Spare | Spare | Spare | Spare | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | octet | | | | | | | | | | 4* | | Spare | Spare | Spare | Spare | Spare | Spare | Spare | Spare | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 8.3.2.1: Requested UE policies information element
Table 8.3.2.1: Requested UE policies information element
* * *
UE policies for V2X communication over PC5 indicator (V2XPC5I) (octet 3, bit
1)  
Bit  
**1**  
0 UE policies for V2X communication over PC5 not requested 1 UE policies for
V2X communication over PC5 requested
UE policies for V2X communication over Uu indicator (V2XUUI) (octet 3, bit 2)  
Bit  
**2**  
0 UE policies for V2X communication over Uu not requested 1 UE policies for
V2X communication over Uu requested
Bit 3 to 8 of octet 3 and bits of octet 4 are spare and shall be coded as
zero.
* * *
## 8.4 V2X communication over PC5 signalling information elements
### 8.4.1 PC5 signalling message type
The purpose of the PC5 signalling message type information element is to
indicate the type of messages used in PC5 signalling protocol.
The value part of the PC5 signalling message type information element used in
the PC5 signalling messages is coded as shown in table 8.4.1.1.
The PC5 signalling message type is a type 3 information element, with the
length of 1 octet.
Table 8.4.1.1: PC5 signalling message type
* * *
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 1 DIRECT LINK ESTABLISHMENT REQUEST 0 0 0 0 0 0 1 0 DIRECT LINK
ESTABLISHMENT ACCEPT 0 0 0 0 0 0 1 1 DIRECT LINK ESTABLISHMENT REJECT 0 0 0 0
0 1 0 0 DIRECT LINK MODIFICATION REQUEST 0 0 0 0 0 1 0 1 DIRECT LINK
MODIFICATION ACCEPT 0 0 0 0 0 1 1 0 DIRECT LINK MODIFICATION REJECT 0 0 0 0 0
1 1 1 DIRECT LINK RELEASE REQUEST 0 0 0 0 1 0 0 0 DIRECT LINK RELEASE ACCEPT 0
0 0 0 1 0 0 1 DIRECT LINK KEEPALIVE REQUEST 0 0 0 0 1 0 1 0 DIRECT LINK
KEEPALIVE RESPONSE 0 0 0 0 1 0 1 1 DIRECT LINK AUTHENTICATION REQUEST 0 0 0 0
1 1 0 0 DIRECT LINK AUTHENTICATION RESPONSE 0 0 0 0 1 1 0 1 DIRECT LINK
AUTHENTICATION REJECT 0 0 0 0 1 1 1 0 DIRECT LINK SECURITY MODE COMMAND 0 0 0
0 1 1 1 1 DIRECT LINK SECURITY MODE COMPLETE 0 0 0 1 0 0 0 0 DIRECT LINK
SECURITY MODE REJECT 0 0 0 1 0 0 0 1 DIRECT LINK REKEYING REQUEST 0 0 0 1 0 0
1 0 DIRECT LINK REKEYING RESPONSE 0 0 0 1 0 0 1 1 DIRECT LINK IDENTIFIER
UPDATE REQUEST 0 0 0 1 0 1 0 0 DIRECT LINK IDENTIFIER UPDATE ACCEPT 0 0 0 1 0
1 0 1 DIRECT LINK IDENTIFIER UPDATE ACK 0 0 0 1 0 1 1 0 DIRECT LINK IDENTIFIER
UPDATE REJECT 0 0 0 1 0 1 1 1 DIRECT LINK AUTHENTICATION FAILURE
* * *
### 8.4.2 Sequence number
The purpose of the Sequence number information element is to uniquely identify
a PC5 signalling message being sent or received. The sending UE will increment
the sequence number for each outgoing new PC5 signalling message.
The Sequence number information element is an integer in the 0-255 range.
The Sequence number is a type 3 information element, with a length of 1 octet.
### 8.4.3 V2X service identifier
The purpose of the V2X service identifier parameter is to carry the identifier
of a V2X service.
The V2X service identifier information element is coded as shown in figure
8.4.3.1 and table 8.4.3.1.
The V2X service identifier is a type 4 information element with a minimum
length of 6 octets.
+-------------------------------------------+--------------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | V2X service identifier IEI | octet 1 | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | Length of V2X service identifier contents | octet 2 | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | V2X service identifier 1 | octet 3 | | | | | | | | | | | | | | | | | | | | octet 6 | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | V2X service identifier 2 | octet 7* | | | | | | | | | | | | | | | | | | | | octet 10* | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | ... | octet 11* | | | | | | | | | | | | | | | | | | | | octet 4n-2* | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | V2X service identifier n | octet 4n-1* | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+ | | octet 4n+2* | | | | | | | | +-------------------------------------------+--------------+---+---+---+---+---+---+---+
Figure 8.4.3.1: V2X service identifier information element
Table 8.4.3.1: V2X service identifier information element
+----------------------------------------------------------------------+ | V2X service identifier: | | | | The V2X service identifier field contains a binary coded V2X service | | identifier as specified in | | ISO TS 17419 ITS-AID AssignedNumbers [18]. | +----------------------------------------------------------------------+
### 8.4.4 Application layer ID
The purpose of the Application layer ID parameter information element carries
an application layer ID as specified in 3GPP TS 23.287 [3].
The Application layer ID information element is coded as shown in figure
8.4.4.1 and table 8.4.4.1.
The Application layer ID is a type 4 information element.
* * *
8 7 6 5 4 3 2 1  
Application layer ID IEI octet 1  
Length of Application layer ID contents octet 2  
Application layer ID contents octet 3  
octet m
* * *
Figure 8.4.4.1: Application layer ID information element
Table 8.4.4.1: Application layer ID information element
+----------------------------------------------------------------------+ | The length of Application layer ID contents field contains the | | binary coded representation of the length of the Application layer | | ID contents field. | | | | The Application layer ID contents field contains the octets | | indicating the Application layer ID. The format of the Application | | layer ID parameter is out of scope of this specification. | +----------------------------------------------------------------------+
### 8.4.5 PC5 QoS flow descriptions
The purpose of the PC5 QoS flow descriptions information element is to
indicate a set of PC5 QoS flow descriptions to be used by the UE over the
direct link, where each PC5 QoS flow description is a set of parameters as
described in clause 5.4.2 of 3GPP TS 23.287 [3].
The PC5 QoS flow descriptions is a type 6 information element with a minimum
length of 6 octets. The maximum length for the information element is 65538
octets.
The PC5 QoS flow descriptions information element is coded as shown in figure
8.4.5.1, figure 8.4.5.2, figure 8.4.5.3, figure 8.4.5.4, and table 8.4.5.1.
+----------------------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | PC5 QoS flow descriptions IEI | octet 1 | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | Length of PC5 QoS flow descriptions contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | PC5 QoS flow description 1 | octet 4 | | | | | | | | | | | | | | | | | | | | octet u | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | PC5 QoS flow description 2 | octet u+1 | | | | | | | | | | | | | | | | | | | | octet v | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | ... | octet v+1 | | | | | | | | | | | | | | | | | | | | octet w | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+ | PC5 QoS flow description n | octet w+1 | | | | | | | | | | | | | | | | | | | | octet x | | | | | | | | +----------------------------------------------+-----------+---+---+---+---+---+---+---+
Figure 8.4.5.1: PC5 QoS flow descriptions information element
+--------+--------+--------+--------+-------+-------+--------+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +--------+--------+--------+--------+-------+-------+--------+---+---+ | 0 | 0 | PQFI | octet | | | | | | | | | | 4 | | | | | | | Spare | Spare | | | | | | | | +--------+--------+--------+--------+-------+-------+--------+---+---+ | Ope | 0 | 0 | 0 | 0 | 0 | octet | | | | ration | | | | | | 5 | | | | code | Spare | Spare | Spare | Spare | Spare | | | | +--------+--------+--------+--------+-------+-------+--------+---+---+ | 0 | E | Number | octet | | | | | | | | | of | 6 | | | | | | | Spare | | para | | | | | | | | | | meters | | | | | | | +--------+--------+--------+--------+-------+-------+--------+---+---+ | Asso | octet | | | | | | | | | ciated | 7* | | | | | | | | | V2X | | | | | | | | | | s | octet | | | | | | | | | ervice | k* | | | | | | | | | ident | | | | | | | | | | ifiers | | | | | | | | | +--------+--------+--------+--------+-------+-------+--------+---+---+ | Para | octet | | | | | | | | | meters | k+1* | | | | | | | | | list | | | | | | | | | | | octet | | | | | | | | | | u* | | | | | | | | +--------+--------+--------+--------+-------+-------+--------+---+---+
Figure 8.4.5.2: PC5 QoS flow description
+-------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter 1 | octet k+1 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter 2 | octet m+1 | | | | | | | | | | | | | | | | | | | | octet n | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | ... | octet n+1 | | | | | | | | | | | | | | | | | | | | octet o | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+ | Parameter n | octet o+1 | | | | | | | | | | | | | | | | | | | | octet u | | | | | | | | +-------------+-----------+---+---+---+---+---+---+---+
Figure 8.4.5.3: Parameters list
+------------------------------+-----------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------+-----------+---+---+---+---+---+---+---+ | Parameter identifier | octet k+1 | | | | | | | | +------------------------------+-----------+---+---+---+---+---+---+---+ | Length of parameter contents | octet k+2 | | | | | | | | +------------------------------+-----------+---+---+---+---+---+---+---+ | Parameter contents | octet k+3 | | | | | | | | | | | | | | | | | | | | octet m | | | | | | | | +------------------------------+-----------+---+---+---+---+---+---+---+
Figure 8.4.5.4: Parameter
Table 8.4.4.1: PC5 QoS flow descriptions information element
+----------------------------------------------------------------------+ | PC5 QoS flow identifier (PQFI) (bits 6 to 1 of octet 4) | | | | PQFI field contains the PC5 QoS flow identifier. | | | | Bits | | | | 6 5 4 3 2 1 | | | | 0 0 0 0 0 1 PQFI 1 | | | | to | | | | 1 1 1 1 1 1 PQFI 63 | | | | The UE shall not set the PQFI value to 0. | +----------------------------------------------------------------------+ | Operation code (bits 8 to 6 of octet 5) | | | | Bits | | | | 8 7 6 | | | | 0 0 1 Create new PC5 QoS flow description | | | | 0 1 0 Delete existing PC5 QoS flow description | | | | 0 1 1 Modify existing PC5 QoS flow description | | | | All other values are reserved. | +----------------------------------------------------------------------+ | E bit (bit 7 of octet 6) | | | | For the \"create new PC5 QoS flow description\" operation, the E bit | | is encoded as follows: | | | | Bit\ | | 7 | | | | 0 reserved | | | | 1 parameters list is included | | | | For the \"Delete existing PC5 QoS flow description\" operation, the | | E bit is encoded as follows: | | | | Bit\ | | 7 | | | | 0 parameters list is not included | | | | 1 reserved | | | | For the \"modify existing PC5 QoS flow description\" operation, the | | E bit is encoded as follows: | | | | Bit\ | | 7 | | | | 0 extension of previously provided parameters | | | | 1 replacement of all previously provided parameters | | | | If the E bit is set to \"parameters list is not included\", the | | number of parameters field has zero value. If the E bit is set to | | \"parameters list is included\", the number of parameters field has | | non-zero value. If the E bit is set to \"extension of previously | | provided parameters\" or \"replacement of all previously provided | | parameters\", the number of parameters field has non-zero value. If | | the E bit is set to \"extension of previously provided parameters\" | | and one of the parameters in the new parameters list already exists | | in the previously provided parameters, the parameter shall be set to | | the new value. | | | | Number of parameters (bits 6 to 1 of octet 6) | | | | The number of parameters field contains the binary coding for the | | number of parameters in the parameters list field. The number of | | parameters field is encoded in bits 6 through 1 of octet 6 where bit | | 6 is the most significant and bit 1 is the least significant bit. | | | | Associated V2X service identifiers (octet 7 to k) | | | | The associated V2X service identifiers field contains a variable | | number of V2X service identifiers associated with the PC5 QoS flow. | | Associated V2X service identifiers field is coded as the length and | | value part of V2X service identifier information element as | | specified in clause 8.4.3 starting with the second octet. | | | | Parameters list (octets k+1 to u) | | | | The parameters list contains a variable number of parameters. | | | | Each parameter included in the parameters list is of variable length | | and consists of: | | | | - a parameter identifier (1 octet);\ | | - the length of the parameter contents (1 octet); and\ | | - the parameter contents itself (variable amount of octets). | | | | The parameter identifier field is used to identify each parameter | | included in the parameters list and it contains the hexadecimal | | coding of the parameter identifier. Bit 8 of the parameter | | identifier field contains the most significant bit and bit 1 | | contains the least significant bit. In this version of the protocol, | | the following parameter identifiers are specified: | | | | - 01H (PQI);\ | | - 02H (GFBR); (see NOTE) | | | | - 03H (MFBR); (see NOTE) | | | | - 04H (Averaging window) ; | | | | - 05H (Resource type); | | | | - 06H (Default priority level); | | | | - 07H (Packet delay budget); | | | | - 08H (Packet error rate); | | | | - 09H (Default maximum data burst volume). | | | | If the parameters list contains a parameter identifier that is not | | supported by the receiving entity the corresponding parameter shall | | be discarded. | | | | The length of parameter contents field contains the binary coded | | representation of the length of the parameter contents field. The | | first bit in transmission order is the most significant bit. | | | | When the parameter identifier indicates PQI, the parameter contents | | field contains the binary representation of PQI that is one octet in | | length. | | | | PQI: | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Reserved | | | | 0 0 0 0 0 0 0 1 | | | | to Spare | | | | 0 0 0 1 0 1 0 0 | | | | 0 0 0 1 0 1 0 1 PQI 21 | | | | 0 0 0 1 0 1 1 0 PQI 22 | | | | 0 0 0 1 0 1 1 1 PQI 23 | | | | 0 0 0 1 1 0 0 0 | | | | to Spare | | | | 0 0 1 1 0 1 1 0 | | | | 0 0 1 1 0 1 1 1 PQI 55 | | | | 0 0 1 1 1 0 0 0 PQI 56 | | | | 0 0 1 1 1 0 0 1 PQI 57 | | | | 0 0 1 1 1 0 1 0 PQI 58 | | | | 0 0 1 1 1 0 1 1 PQI 59 | | | | 0 0 1 1 1 1 0 0 | | | | to Spare | | | | 0 1 0 1 1 0 0 1 | | | | 0 1 0 1 1 0 1 0 PQI 90 | | | | 0 1 0 1 1 0 1 1 PQI 91 | | | | 0 1 0 1 1 1 0 0 | | | | to Spare | | | | 0 1 1 1 1 1 1 1 | | | | 1 0 0 0 0 0 0 0 | | | | to Operator-specific PQIs | | | | 1 1 1 1 1 1 1 0 | | | | 1 1 1 1 1 1 1 1 Reserved | | | | The UE shall consider all other values not explicitly defined in | | this version of the protocol as unsupported. | | | | When the parameter identifier indicates \"GFBR\", the parameter | | contents field contains one octet indicating the unit of the | | guaranteed flow bit rate followed by two octets containing the value | | of the guaranteed flow bit rate. | | | | Unit of the guaranteed flow bit rate (octet 1) | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 value is not used | | | | 0 0 0 0 0 0 0 1 value is incremented in multiples of 1 Kbps | | | | 0 0 0 0 0 0 1 0 value is incremented in multiples of 4 Kbps | | | | 0 0 0 0 0 0 1 1 value is incremented in multiples of 16 Kbps | | | | 0 0 0 0 0 1 0 0 value is incremented in multiples of 64 Kbps | | | | 0 0 0 0 0 1 0 1 value is incremented in multiples of 256 Kbps | | | | 0 0 0 0 0 1 1 0 value is incremented in multiples of 1 Mbps | | | | 0 0 0 0 0 1 1 1 value is incremented in multiples of 4 Mbps | | | | 0 0 0 0 1 0 0 0 value is incremented in multiples of 16 Mbps | | | | 0 0 0 0 1 0 0 1 value is incremented in multiples of 64 Mbps | | | | 0 0 0 0 1 0 1 0 value is incremented in multiples of 256 Mbps | | | | 0 0 0 0 1 0 1 1 value is incremented in multiples of 1 Gbps | | | | 0 0 0 0 1 1 0 0 value is incremented in multiples of 4 Gbps | | | | 0 0 0 0 1 1 0 1 value is incremented in multiples of 16 Gbps | | | | 0 0 0 0 1 1 1 0 value is incremented in multiples of 64 Gbps | | | | 0 0 0 0 1 1 1 1 value is incremented in multiples of 256 Gbps | | | | 0 0 0 1 0 0 0 0 value is incremented in multiples of 1 Tbps | | | | 0 0 0 1 0 0 0 1 value is incremented in multiples of 4 Tbps | | | | 0 0 0 1 0 0 1 0 value is incremented in multiples of 16 Tbps | | | | 0 0 0 1 0 0 1 1 value is incremented in multiples of 64 Tbps | | | | 0 0 0 1 0 1 0 0 value is incremented in multiples of 256 Tbps | | | | 0 0 0 1 0 1 0 1 value is incremented in multiples of 1 Pbps | | | | 0 0 0 1 0 1 1 0 value is incremented in multiples of 4 Pbps | | | | 0 0 0 1 0 1 1 1 value is incremented in multiples of 16 Pbps | | | | 0 0 0 1 1 0 0 0 value is incremented in multiples of 64 Pbps | | | | 0 0 0 1 1 0 0 1 value is incremented in multiples of 256 Pbps | | | | Other values shall be interpreted as multiples of 256 Pbps in this | | version of the protocol. | | | | Value of the guaranteed flow bit rate (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the guaranteed | | flow bit rate in units defined by the unit of the guaranteed flow | | bit rate. | | | | When the parameter identifier indicates \"GFBR downlink\", the | | parameter contents field contains one octet indicating the unit of | | the guaranteed flow bit rate for downlink followed by two octets | | containing the value of the guaranteed flow bit rate for downlink. | | | | When the parameter identifier indicates \"MFBR \", the parameter | | contents field contains the one octet indicating the unit of the | | maximum flow bit rate followed by two octets containing the value of | | maximum flow bit rate. | | | | Unit of the maximum flow bit rate (octet 1) | | | | The coding is identical to that of the unit of the guaranteed flow | | bit rate. | | | | Value of the maximum flow bit rate (octets 2 and 3) | | | | Octets 2 and 3 represent the binary coded value of the maximum flow | | bit rate in units defined by the unit of the maximum flow bit rate. | | | | When the parameter identifier indicates \"averaging window\", the | | parameter contents field contains the binary representation of the | | averaging window for both uplink and downlink in milliseconds and | | the parameter contents field is two octets in length. | +----------------------------------------------------------------------+ | When the parameter identifier indicates \"resource type\", the | | parameter contents field contains the binary representation of the | | resource type that is one octet in length. | | | | Resource type: | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Reserved | | | | 0 0 0 0 0 0 0 1 Non-GBR | | | | 0 0 0 0 0 0 1 0 GBR | | | | 0 0 0 0 0 0 1 1 Delay critical GBR | | | | 0 0 0 0 0 1 0 0 | | | | to Spare | | | | 1 1 1 1 1 1 1 1 | | | | When the parameter identifier indicates \"default priority level\", | | the parameter contents field contains the binary representation of | | the default priority level that is one octet in length. | | | | Default priority level: | | | | Bits | | | | 8 7 6 5 4 3 2 1 | | | | 0 0 0 0 0 0 0 0 Reserved | | | | 0 0 0 0 0 0 0 1 1 | | | | 0 0 0 0 0 0 1 0 2 | | | | 0 0 0 0 0 0 1 1 3 | | | | 0 0 0 0 0 1 0 0 4 | | | | 0 0 0 0 0 1 0 1 5 | | | | 0 0 0 0 0 1 1 0 6 | | | | 0 0 0 0 0 1 1 1 7 | | | | 0 0 0 0 1 0 0 0 8 | | | | 0 0 0 0 1 0 0 1 | | | | to Spare | | | | 1 1 1 1 1 1 1 1 | | | | When the parameter identifier indicates \"packet delay budget\", the | | parameter contents field contains the binary representation of the | | packet delay budget for both uplink and downlink in milliseconds and | | the parameter contents field is two octets in length. | | | | When the parameter identifier indicates \"packet error rate\", the | | parameter contents field contains the binary representation of the | | power of 10^-1^ for both uplink and downlink and the parameter | | contents field is one octet in length. | | | | When the parameter identifier indicates \"default maximum data burst | | volume\", the parameter contents field contains the binary | | representation of the default maximum data burst volume for both | | uplink and downlink in bytes and the parameter contents field is two | | octets in length. | +----------------------------------------------------------------------+ | NOTE: The GFBR and MFBR apply to both directions of the PC5 unicast | | link. | +----------------------------------------------------------------------+
### 8.4.6 IP address configuration
The purpose of the IP address configuration information element is to indicate
the configuration options for IP address used by the UE over this direct link.
The IP address configuration is a type 3 information element with the length
of 2 octets.
The IP address configuration information element is coded as shown in figure
z.3.1.6.1 and table z.3.1.6.1.
* * *
8 7 6 5 4 3 2 1  
IP address configuration IEI octet 1  
IP address configuration content octet 2
* * *
Figure 8.4.6.1: IP address configuration information element
Table 8.4.6.1: IP address configuration information element
* * *
IP address configuration value (octet 2)  
Bits  
4 3 2 1  
0 0 0 1 IPv6 Router 0 0 1 0 address allocation not supported
All other values are reserved.
Bit 5 to 8 of octet 2 are spare and shall be coded as zero.
* * *
### 8.4.7 Link local IPv6 address
The purpose of the Link local IPv6 address information element is to indicate
the link local IPv6 address.
The Link local IPv6 address is a type 3 information element with the length of
17 octets.
The Link local IPv6 address information element is coded as shown in figure
8.4.7.1 and table 8.4.7.1.
* * *
8 7 6 5 4 3 2 1  
Link local IPv6 address IEI octet 1  
Link local IPv6 address content octet 2  
octet 17
* * *
Figure 8.4.7.1: Link local IPv6 address information element
Table 8.4.7.1: Link local IPv6 address information element
+----------------------------------------------------------------------+ | Link local IPv6 address value (octet 2 to 17) | | | | This contains the 128-bit IPv6 address. This IPv6 address is encoded | | as a 128-bit address according to IETF RFC 4291 [15]. | +----------------------------------------------------------------------+
### 8.4.8 Link modification operation code
The purpose of the Link modification operation code information element is to
indicate what the operation of the PC5 unicast link modification procedure
triggered by initiating UE is.
The Link modification operation code is a type 3 information element, with a
length of 2 octets.
The Link modification operation code information element is coded as shown in
figure 8.4.8.1 and table 8.4.8.1.
* * *
8 7 6 5 4 3 2 1  
Link modification operation code IEI octet 1  
Link modification operation code octet 2
* * *
Figure 8.4.8.1: Link modification operation code information element
Table 8.4.8.1: Link modification operation code information element
* * *
Link modification operation code (octet 2)  
Bits  
4 3 2 1  
0 0 0 1 void 0 0 1 0 void 0 0 1 1 Add new PC5 QoS flow(s) to the existing PC5
unicast link 0 1 0 0 Modify PC5 QoS parameters of the existing PC5 QoS flow(s)
0 1 0 1 Remove existing PC5 QoS flow(s) from the existing PC5 unicast link 0 1
1 0 Associate new V2X service(s) with existing PC5 QoS flow(s) 0 1 1 1 Remove
V2X service(s) from existing PC5 QoS flow(s) 1 0 0 0  
to Spare  
1 1 1 0  
1 1 1 1 Reserved
Bit 5 to 8 of octet 2 are spare and shall be coded as zero.
* * *
### 8.4.9 PC5 signalling protocol cause
The purpose of the PC5 signalling protocol cause information element is to
indicate the cause used in the PC5 signalling protocol procedures.
The PC5 signalling protocol cause is a type 3 information element with a
length of 2 octets.
The PC5 signalling protocol cause information element is coded as shown in
figure 8.4.9.1 and table 8.4.9.1.
* * *
8 7 6 5 4 3 2 1  
PC5 signalling protocol cause IEI octet 1  
PC5 signalling cause value octet 2
* * *
Figure 8.4.9.1: PC5 signalling protocol cause information element
Table 8.4.9.1: PC5 signalling protocol cause information element
* * *
PC5 signalling cause value (octet 2)
Bits  
8 7 6 5 4 3 2 1  
0 0 0 0 0 0 0 1 Direct communication to the target UE not allowed 0 0 0 0 0 0
1 0 Direct communication to the target UE no longer needed 0 0 0 0 0 0 1 1
Conflict of layer-2 ID for unicast communication is detected 0 0 0 0 0 1 0 0
Direct connection is not available anymore 0 0 0 0 0 1 0 1 Lack of resources
for PC5 unicast link 0 0 0 0 0 1 1 0 Authentication failure 0 0 0 0 0 1 1 1
Integrity failure 0 0 0 0 1 0 0 0 UE security capabilities mismatch 0 0 0 0 1
0 0 1 LBSs of K~NRP-sess~ ID conflict 0 0 0 0 1 0 1 0 UE PC5 unicast
signalling security policy mismatch 0 0 0 0 1 0 1 1 Required service not
allowed 0 0 0 0 1 1 0 0 Security policy not aligned
0 1 1 0 1 1 1 1 Protocol error, unspecified
Any other value received by the UE shall be treated as 0110 1111, \"protocol
error, unspecified\".
* * *
### 8.4.10 Keep-alive counter
The purpose of the Keep-alive counter information element is to indicate the
keep-alive counter which is a 32-bit counter used for the PC5 unicast link
keep-alive procedure.
The Keep-alive counter is a type 3 information element with a length of 5
octets.
The Keep-alive counter information element is coded as shown in figure
8.4.10.1 and table 8.4.10.1.
* * *
8 7 6 5 4 3 2 1  
Keep-alive counter IEI octet 1  
Keep-alive counter contents octet 2  
octet 5
* * *
Figure 8.4.10.1: Keep-alive counter information element
Table 8.4.10.1: Keep-alive counter information element
+----------------------------------------------------+ | Keep-alive counter contents (octet 2 to 5) | | | | This field contains the 32-bit keep-alive counter. | +----------------------------------------------------+
### 8.4.11 Maximum inactivity period
The purpose of the Maximum inactivity period information element is to
indicate the maximum inactivity period of the initiating UE during a PC5
unicast link keep-alive procedure.
The Maximum inactivity period is a type 3 information element, with a length
of 5 octets.
The Maximum inactivity period information element is coded as shown in figure
8.4.11.1 and table 8.4.11.1.
* * *
8 7 6 5 4 3 2 1  
Maximum inactivity period IEI octet 1  
Maximum inactivity period contents octet 2  
octet 5
* * *
Figure 8.4.11.1: Maximum inactivity period information element
Table 8.4.11.1: Maximum inactivity period information element
+----------------------------------------------------------------------+ | Maximum inactivity period contents (octet 2 to 5) | | | | This field contains the binary encoding of the maximum inactivity | | period expressed in units of seconds. | +----------------------------------------------------------------------+
### 8.4.12 Key establishment information container
The Key establishment information container information element contains
information for PC5 unicast link key establishment.
The Key establishment information container is a type 6 information element
with a minimum length of 4 octets.
The Key establishment information container information element is coded as
shown in figure 8.4.12.1 and table 8.4.12.1.
+------------------------------------------------------------+---------+---+---+---+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +------------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Key establishment information container IEI | octet 1 | | | | | | | | +------------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Length of key establishment information container contents | octet 2 | | | | | | | | | | | | | | | | | | | | octet 3 | | | | | | | | +------------------------------------------------------------+---------+---+---+---+---+---+---+---+ | Key establishment information container contents | octet 4 | | | | | | | | +------------------------------------------------------------+---------+---+---+---+---+---+---+---+ | | octet n | | | | | | | | +------------------------------------------------------------+---------+---+---+---+---+---+---+---+
Figure 8.4.a.1: Key establishment information container information element
Table 8.4.a.1: Key establishment information container information element
+------------------------------------------------------------------+ | Key establishment information container contents (octet 4 to n) | | | | This field contains the key establishment information container. | +------------------------------------------------------------------+
### 8.4.13 Nonce
The Nonce information element contains a 128-bit nonce used during PC5 unicast
link security establishment.
The Nonce information element is a type 3 information element, with a length
of 17 octets.
The Nonce information element is coded as shown in figure 8.4.13.1 and table
8.4.13.1.
* * *
8 7 6 5 4 3 2 1  
Nonce IEI octet 1  
Nonce contents octet 2  
octet 17
* * *
Figure 8.4.13.1: Nonce information element
Table 8.4.13.1: Nonce information element
+----------------------------------------------+ | Nonce contents (octet 2 to 17) | | | | This field contains the 128-bit nonce value. | +----------------------------------------------+
### 8.4.14 UE security capabilities
The UE security capabilities information element is used to indicate which
security algorithms are supported by the UE.
The UE _security capabilities_ is a type 4 information element with a minimum
length of 4 octets and a maximum length of 10 octets.
The UE security capabilities information element is coded as shown in figure
8.4.14.1 and table 8.4.14.1.
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | UE | octet | | | | | | | | | _sec | 1 | | | | | | | | | urity | | | | | | | | | | cap | | | | | | | | | | abili | | | | | | | | | | ties_ | | | | | | | | | | IEI | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | L | octet | | | | | | | | | ength | 2 | | | | | | | | | of UE | | | | | | | | | | _sec | | | | | | | | | | urity | | | | | | | | | | ca | | | | | | | | | | pabil | | | | | | | | | | ities | | | | | | | | | | cont | | | | | | | | | | ents_ | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 128- | 128- | 128- | 5 | 5 | 5 | 5 | octet | | G-EA0 | | | | G-EA4 | G-EA5 | G-EA6 | G-EA7 | 3 | | | 5 | 5 | 5 | | | | | | | | G-EA1 | G-EA2 | G-EA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | 128- | 128- | 128- | 5 | 5 | 5 | 5 | octet | | G-IA0 | | | | G-IA4 | G-IA5 | G-IA6 | G-IA7 | 4 | | | 5 | 5 | 5 | | | | | | | | G-IA1 | G-IA2 | G-IA3 | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Spare | octet | | | | | | | | | | 5* | | | | | | | | | | -10* | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Figure 8.4.14.1: UE security capabilities information element
Table 8.4.14.1: UE _security capabilities_ information element
* * *
5GS encryption algorithms supported (octet 3)
5GS encryption algorithm 5G-EA0 supported (octet 3, bit 8)  
0 5GS encryption algorithm 5G-EA0 not supported 1 5GS encryption algorithm
5G-EA0 supported
5GS encryption algorithm 128-5G-EA1 supported (octet 3, bit 7)  
0 5GS encryption algorithm 128-5G-EA1 not supported 1 5GS encryption algorithm
128-5G-EA1 supported
5GS encryption algorithm 128-5G-EA2 supported (octet 3, bit 6)  
0 5GS encryption algorithm 128-5G-EA2 not supported 1 5GS encryption algorithm
128-5G-EA2 supported
5GS encryption algorithm 128-5G-EA3 supported (octet 3, bit 5)  
0 5GS encryption algorithm 128-5G-EA3 not supported 1 5GS encryption algorithm
128-5G-EA3 supported
5GS encryption algorithm 5G-EA4 supported (octet 3, bit 4)  
0 5GS encryption algorithm 5G-EA4 not supported 1 5GS encryption algorithm
5G-EA4 supported
5GS encryption algorithm 5G-EA5 supported (octet 3, bit 3)  
0 5GS encryption algorithm 5G-EA5 not supported 1 5GS encryption algorithm
5G-EA5 supported
5GS encryption algorithm 5G-EA6 supported (octet 3, bit 2)  
0 5GS encryption algorithm 5G-EA6 not supported 1 5GS encryption algorithm
5G-EA6 supported
5GS encryption algorithm 5G-EA7 supported (octet 3, bit 1)  
0 5GS encryption algorithm 5G-EA7 not supported 1 5GS encryption algorithm
5G-EA7 supported
5GS integrity algorithms supported (octet 4)
5GS integrity algorithm 5G-IA0 supported (octet 4, bit 8)  
0 5GS integrity algorithm 5G-IA0 not supported 1 5GS integrity algorithm
5G-IA0 supported
5GS integrity algorithm 128-5G-IA1 supported (octet 4, bit 7)  
0 5GS integrity algorithm 128-5G-IA1 not supported 1 5GS integrity algorithm
128-5G-IA1 supported
5GS integrity algorithm 128-5G-IA2 supported (octet 4, bit 6)  
0 5GS integrity algorithm 128-5G-IA2 not supported 1 5GS integrity algorithm
128-5G-IA2 supported
5GS integrity algorithm 128-5G-IA3 supported (octet 4, bit 5)  
0 5GS integrity algorithm 128-5G-IA3 not supported 1 5GS integrity algorithm
128-5G-IA3 supported
5GS integrity algorithm 5G-IA4 supported (octet 4, bit 4)  
0 5GS integrity algorithm 5G-IA4 not supported 1 5GS integrity algorithm
5G-IA4 supported
5GS integrity algorithm 5G-IA5 supported (octet 4, bit 3)  
0 5GS integrity algorithm 5G-IA5 not supported 1 5GS integrity algorithm
5G-IA5 supported
5GS integrity algorithm 5G-IA6supported (octet 4, bit 2)  
0 5GS integrity algorithm 5G-IA6 not supported 1 5GS integrity algorithm
5G-IA6 supported
5GS integrity algorithm 5G-IA7 supported (octet 4, bit 1)  
0 5GS integrity algorithm 5G-IA7 not supported 1 5GS integrity algorithm
5G-IA7 supported
* * *
### 8.4.15 UE PC5 unicast signalling security policy
The purpose of the UE PC5 unicast signalling security policy information
element is to indicate the UE\'s configuration for integrity protection and
ciphering of PC5 signalling messages.
The UE PC5 unicast signalling security policy is a type 3 information element
with a length of 2 octets.
The UE PC5 unicast signalling security policy information element is coded as
shown in figure 8.4.15.1.1 and table 8.4.15.1.
+----------+----------+-------+----------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+----------+-------+----------+---------+---+---+---+---+ | UE PC5 | octet 1 | | | | | | | | | unicast | | | | | | | | | | si | | | | | | | | | | gnalling | | | | | | | | | | security | | | | | | | | | | policy | | | | | | | | | | IEI | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | 0 | Si | 0 | Si | octet 2 | | | | | | | gnalling | | gnalling | | | | | | | spare | c | spare | i | | | | | | | | iphering | | ntegrity | | | | | | | | policy | | pr | | | | | | | | | | otection | | | | | | | | | | policy | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+
Figure 8.4.15.1: UE PC5 unicast signalling security policy information element
Table 8.4.15.1: UE PC5 unicast signalling security policy information element
+------------------------+-------+-------+---+------------------------+ | Signalling integrity | | | | | | protection policy | | | | | | (octet 2, bit 1 to 3) | | | | | +------------------------+-------+-------+---+------------------------+ | Bits | | | | | +------------------------+-------+-------+---+------------------------+ | **3** | **2** | **1** | | | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 0 | | Signalling integrity | | | | | | protection not needed | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 1 | | Signalling integrity | | | | | | protection preferred | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 0 | | Signalling integrity | | | | | | protection required | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 1 | | | +------------------------+-------+-------+---+------------------------+ | to Spare | | | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 0 | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 1 | | Reserved | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+ | If the UE receives a | | | | | | signalling integrity | | | | | | protection policy | | | | | | value that the UE does | | | | | | not understand, the UE | | | | | | shall interpret the | | | | | | value as 010 | | | | | | \"Signalling integrity | | | | | | protection required\". | | | | | | | | | | | | Signaling ciphering | | | | | | policy (octet 2, bit 5 | | | | | | to 7) | | | | | +------------------------+-------+-------+---+------------------------+ | Bits | | | | | +------------------------+-------+-------+---+------------------------+ | **7** | **6** | **5** | | | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 0 | | Signalling ciphering | | | | | | not needed | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 1 | | Signalling ciphering | | | | | | preferred | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 0 | | Signalling ciphering | | | | | | required | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 1 | | | +------------------------+-------+-------+---+------------------------+ | to Spare | | | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 0 | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 1 | | Reserved | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+ | If the UE receives a | | | | | | signalling ciphering | | | | | | policy value that the | | | | | | UE does not | | | | | | understand, the UE | | | | | | shall interpret the | | | | | | value as 010 | | | | | | \"Signalling ciphering | | | | | | required\". | | | | | | | | | | | | Bit 4 and 8 of octet 2 | | | | | | are spare and shall be | | | | | | coded as zero. | | | | | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+
### 8.4.16 MSBs of K~NRP-sess~ ID
The purpose of the MSBs of K~NRP-sess~ ID information element is to carry the
8 most significant bits of the K~NRP-sess~ ID.
The MSBs of K~NRP-sess~ ID information element is a type 3 information element
with a length of 2 octets.
The MSBs of K~NRP-sess~ ID information element is coded as shown in figure
8.4.16.1 and table 8.4.16.1.
* * *
8 7 6 5 4 3 2 1  
MSBs of K~NRP-sess~ ID IEI octet 1  
MSBs of K~NRP-sess~ ID contents octet 2
* * *
Figure 8.4.16.1: MSBs of K~NRP-sess~ ID information element
Table 8.4.16.1: MSBs of K~NRP-sess~ ID information element
+----------------------------------------------------------------------+ | MSBs of K~NRP-sess~ ID contents (octet 2) | | | | This field contains the 8 most significant bits of K~NRP-sess~ ID. | +----------------------------------------------------------------------+ | NOTE: This field is set to all zeros if the K~NRP-sess~ ID is not | | generated, i.e., the null integrity algorithm is used. | +----------------------------------------------------------------------+
### 8.4.17 K~NRP~ ID
The purpose of the K~NRP~ ID information element is to carry the identity of
the K~NRP~ held by a UE.
The K~NRP~ ID is a type 3 information element with a length of 5 octets.
The K~NRP~ ID information element is coded as shown in figure 8.4.17.1 and
table 8.4.17.1
* * *
8 7 6 5 4 3 2 1  
K~NRP~ ID IEI octet 1  
K~NRP~ ID contents octet 2  
octet 5
* * *
Figure 8.4.17.1: K~NRP~ ID information element
Table 8.4.17.1: K~NRP~ ID information element
+--------------------------------------------------------+ | K~NRP~ ID contents (octet 2 to 5) | | | | This field contains the 32-bit identifier of a K~NRP~. | +--------------------------------------------------------+
### 8.4.18 Selected security algorithms
The purpose of the Selected security algorithms information element is to
indicate the algorithms to be used for ciphering and integrity protection.
The Selected security algorithms is a type 3 information element with a length
of 2 octets.
The Selected security algorithms information element is coded as shown in
figure 8.4.18.1.1 and table 8.4.18.1.
+----------+----------+-------+----------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+----------+-------+----------+---------+---+---+---+---+ | Selected | octet 1 | | | | | | | | | security | | | | | | | | | | al | | | | | | | | | | gorithms | | | | | | | | | | IEI | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | 0 | Type of | 0 | Type of | octet 2 | | | | | | | c | | i | | | | | | | spare | iphering | spare | ntegrity | | | | | | | | a | | pr | | | | | | | | lgorithm | | otection | | | | | | | | | | a | | | | | | | | | | lgorithm | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+
Figure 8.4.18.1: Selected security algorithms information element
Table 8.4.18.1: Selected security algorithms information element
* * *
Type of integrity protection algorithm (octet 2, bit 1 to 3)  
Bits  
**3** **2** **1**  
0 0 0 5GS integrity algorithm 5G-IA0 (null integrity protection algorithm) 0 0
1 5GS integrity algorithm 128-5G-IA1 0 1 0 5GS integrity algorithm 128-5G-IA2
0 1 1 5GS integrity algorithm 128-5G-IA3 1 0 0 5GS integrity algorithm 5G-IA4
1 0 1 5GS integrity algorithm 5G-IA5 1 1 0 5GS integrity algorithm 5G-IA6 1 1
1 5GS integrity algorithm 5G-IA7
Type of ciphering algorithm (octet 2, bit 5 to 7)  
Bits  
**7** **6** **5**  
0 0 0 5GS encryption algorithm 5G-EA0 (null ciphering algorithm) 0 0 1 5GS
encryption algorithm 128-5G-EA1 0 1 0 5GS encryption algorithm 128-5G-EA2 0 1
1 5GS encryption algorithm 128-5G-EA3 1 0 0 5GS encryption algorithm 5G-EA4 1
0 1 5GS encryption algorithm 5G-EA5 1 1 0 5GS encryption algorithm 5G-EA6 1 1
1 5GS encryption algorithm 5G-EA7
Bit 4 and 8 of octet 2 are spare and shall be coded as zero.
* * *
### 8.4.19 LSBs of K~NRP-sess~ ID
The purpose of the LSBs of K~NRP-sess~ ID information element is to carry the
8 least significant bits of the K~NRP-sess~ ID.
The LSBs of K~NRP-sess~ ID is a type 3 information element with a length of 2
octets.
The LSBs of K~NRP-sess~ ID information element is coded as shown in figure
8.4.19.1 and table 8.4.19.1.
* * *
8 7 6 5 4 3 2 1  
LSBs of K~NRP-sess~ ID octet 1  
LSBs of K~NRP-sess~ ID contents octet 2
* * *
Figure 8.4.19.1: LSBs of K~NRP-sess~ ID information element
Table 8.4.19.1: LSBs of K~NRP-sess~ ID information element
+---------------------------------------------------------------------+ | LSBs of K~NRP-sess~ ID contents (octet 2) | | | | This field contains the 8 least significant bits of K~NRP-sess~ ID. | +---------------------------------------------------------------------+
### 8.4.20 MSBs of K~NRP~ ID
The purpose of the MSBs of K~NRP~ ID information element is to carry the 16
most significant bits of the K~NRP~ ID.
The MSBs of K~NRP~ ID is a type 3 information element with a length of 3
octets.
The MSBs of K~NRP~ ID information element is coded as shown in figure 8.4.20.1
and table 8.4.20.1.
* * *
8 7 6 5 4 3 2 1  
MSBs of K~NRP~ ID IEI octet 1  
MSBs of K~NRP~ ID contents octet 2  
octet 3
* * *
Figure 8.4.20.1: MSBs of K~NRP~ ID information element
Table 8.4.20.1: MSBs of K~NRP~ ID information element
+----------------------------------------------------------------+ | MSBs of K~NRP~ ID contents (octet 2 to 3) | | | | This field contains the 16 most significant bits of K~NRP~ ID. | +----------------------------------------------------------------+
### 8.4.21 LSBs of K~NRP~ ID
The purpose of the LSBs of K~NRP~ ID information element is to carry the 16
least significant bits of the K~NRP~ ID.
The LSBs of K~NRP~ ID is a type 3 information element with a length of 3
octets.
The LSBs of K~NRP~ ID information element is coded as shown in figure 8.4.21.1
and table 8.4.21.1.
* * *
8 7 6 5 4 3 2 1  
LSBs of K~NRP~ ID IEI octet 1  
LSBs of K~NRP~ ID contents octet 2  
octet 3
* * *
Figure 8.4.21.1: LSBs of K~NRP~ ID information element
Table 8.4.21.1: LSBs of K~NRP~ ID information element
+-----------------------------------------------------------------+ | LSBs of K~NRP~ ID contents (octet 2 to 3) | | | | This field contains the 16 least significant bits of K~NRP~ ID. | +-----------------------------------------------------------------+
### 8.4.22 UE PC5 unicast user plane security policy
The purpose of the UE PC5 unicast user plane security policy information
element is to indicate the UE\'s configuration for integrity protection and
ciphering of PC5 user plane data.
The UE PC5 unicast user plane security policy is a type 3 information element
with a length of 2 octets.
The UE PC5 unicast user plane security policy information element is coded as
shown in figure 8.4.22.1.1 and table 8.4.22.1.
+----------+----------+-------+----------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+----------+-------+----------+---------+---+---+---+---+ | UE PC5 | octet 1 | | | | | | | | | unicast | | | | | | | | | | user | | | | | | | | | | plane | | | | | | | | | | security | | | | | | | | | | policy | | | | | | | | | | IEI | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | 0 | User | 0 | User | octet 2 | | | | | | | plane | | plane | | | | | | | spare | c | spare | i | | | | | | | | iphering | | ntegrity | | | | | | | | policy | | pr | | | | | | | | | | otection | | | | | | | | | | policy | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+
Figure 8.4.22.1: UE PC5 unicast user plane security policy information element
Table 8.4.22.1: UE PC5 unicast user plane security policy information element
+------------------------+-------+-------+---+------------------------+ | User plane integrity | | | | | | protection policy | | | | | | (octet 2, bit 1 to 3) | | | | | +------------------------+-------+-------+---+------------------------+ | Bits | | | | | +------------------------+-------+-------+---+------------------------+ | **3** | **2** | **1** | | | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 0 | | User plane integrity | | | | | | protection not needed | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 1 | | User plane integrity | | | | | | protection preferred | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 0 | | User plane integrity | | | | | | protection required | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 1 | | | +------------------------+-------+-------+---+------------------------+ | to Spare | | | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 0 | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 1 | | Reserved | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+ | If the UE receives a | | | | | | user plane integrity | | | | | | protection policy | | | | | | value that the UE does | | | | | | not understand, the UE | | | | | | shall interpret the | | | | | | value as 010 \"user | | | | | | plane integrity | | | | | | protection required\". | | | | | | | | | | | | User plane ciphering | | | | | | policy (octet 2, bit 5 | | | | | | to 7) | | | | | +------------------------+-------+-------+---+------------------------+ | Bits | | | | | +------------------------+-------+-------+---+------------------------+ | **7** | **6** | **5** | | | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 0 | | User plane ciphering | | | | | | not needed | +------------------------+-------+-------+---+------------------------+ | 0 | 0 | 1 | | User plane ciphering | | | | | | preferred | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 0 | | User plane ciphering | | | | | | required | +------------------------+-------+-------+---+------------------------+ | 0 | 1 | 1 | | | +------------------------+-------+-------+---+------------------------+ | to Spare | | | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 0 | | | +------------------------+-------+-------+---+------------------------+ | 1 | 1 | 1 | | Reserved | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+ | If the UE receives a | | | | | | user plane ciphering | | | | | | protection policy | | | | | | value that the UE does | | | | | | not understand, the UE | | | | | | shall interpret the | | | | | | value as 010 \"user | | | | | | plane ciphering | | | | | | protection required\". | | | | | | | | | | | | Bit 4 and 8 of octet 2 | | | | | | are spare and shall be | | | | | | coded as zero. | | | | | +------------------------+-------+-------+---+------------------------+ | | | | | | +------------------------+-------+-------+---+------------------------+
### 8.4.23 Configuration of UE PC5 unicast user plane security protection
The purpose of the configuration of UE PC5 unicast user plane security
protection information element is to indicate the agreed configuration for
security protection of PC5 user plane data between UEs over the PC5 unicast
link.
The configuration of UE PC5 unicast user plane security protection is a type 3
information element with a length of 2 octets.
The configuration of UE PC5 unicast user plane security protection information
element is coded as shown in figure 8.4.23.1.1 and table 8.4.23.1.
+----------+----------+-------+----------+---------+---+---+---+---+ | 8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 | | +----------+----------+-------+----------+---------+---+---+---+---+ | confi | octet 1 | | | | | | | | | guration | | | | | | | | | | of UE | | | | | | | | | | PC5 | | | | | | | | | | unicast | | | | | | | | | | user | | | | | | | | | | plane | | | | | | | | | | security | | | | | | | | | | pr | | | | | | | | | | otection | | | | | | | | | | IEI | | | | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+ | 0 | User | 0 | User | octet 2 | | | | | | | plane | | plane | | | | | | | spare | c | spare | i | | | | | | | | iphering | | ntegrity | | | | | | | | confi | | pr | | | | | | | | guration | | otection | | | | | | | | | | confi | | | | | | | | | | guration | | | | | | +----------+----------+-------+----------+---------+---+---+---+---+
Figure 8.4.23.1: Configuration of UE PC5 unicast user plane security
protection information element
Table 8.4.23.1: Configuration of UE PC5 unicast user plane security protection
information element
* * *
User plane integrity protection configuration (octet 2, bit 1 to 3)  
Bits  
**3** **2** **1**  
0 0 0 Off 0 0 1 Off or On 0 1 0 On 0 1 1  
to Spare  
1 1 0  
1 1 1 Reserved
User plane ciphering configuration (octet 2, bit 5 to 7)  
Bits  
**7** **6** **5**  
0 0 0 Off 0 0 1 Off or On 0 1 0 On 0 1 1  
to Spare  
1 1 0  
1 1 1 Reserved
Bit 4 and 8 of octet 2 are spare and shall be coded as zero.
* * *
### 8.4.24 Re-authentication indication
The purpose of the Re-authentication indication information element is to
indication that K~NRP~ needs to be refreshed.
The Re-authentication indication information element is a type 3 information
element, with a length of 2 octets.
The Re-authentication indication information element is coded as shown in
figure 8.4.24.1 and table 8.4.24.1.
* * *
8 7 6 5 4 3 2 1  
Re-authentication indication IEI octet 1  
Re-authentication indication contents octet 2
* * *
Figure 8.4.24.1: Re-authentication indication information element
Table 8.4.24.1: Re-authentication indication information element
+--------------------------------------------------------------+ | Re-authentication indication contents (octet 2) | | | | Bits | | | | **1** | | | | 0 Reserved | | | | 1 K~NRP~ is requested to be refreshed | | | | Bits 2 to 8 of octet 2 are spare and shall be coded as zero. | +--------------------------------------------------------------+ | | +--------------------------------------------------------------+
### 8.4.25 Layer-2 ID
The purpose of the layer-2 ID information element is to indicate the layer-2
ID that is used by UE.
The layer-2 ID is a type 3 information element with a length of 4 octets.
The layer-2 ID information element is coded as shown in figure 8.4.25.1 and
table 8.4.25.1.
* * *
8 7 6 5 4 3 2 1  
Layer-2 ID IEI octet 1  
Layer-2 ID octet 2  
octet 4
* * *
Figure 8.4.25.1: Layer-2 ID information element
Table 8.4.25.1: Layer-2 ID information element
+--------------------------------------------+ | Layer-2 ID (octet 2 to 4) | | | | This field contains the 24-bit layer-2 ID. | +--------------------------------------------+
# 9 Coding other than information element coding
## 9.1 Overview
This clause contains the coding of information other than the one provided by
the information elements described in clause 8.
## 9.2 V2X message family encoding
The values are specified to identify the V2X message family according to table
9.2.1.
Table 9.2.1: V2X message family
V2X message family (octet 14) Bits |  |  |  |  |  |  |  |  |   
---|---|---|---|---|---|---|---|---|---  
8 | 7 | 6 | 5 | 4 | 3 | 2 | 1 |  |   
0 | 0 | 0 | 0 | 0 | 0 | 0 | 1 |  | IEEE 1609, see IEEE 1609.3 [13]  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 0 |  | ISO, see ISO 29281-1 [17]  
0 | 0 | 0 | 0 | 0 | 0 | 1 | 1 |  | ETSI-ITS, see ETSI EN 302 636-3 [12]  
0 | 0 | 0 | 0 | 0 | 1 | 0 | 0 |  | CCSA, see CCSA YD/T 3707-2020 [24]  
All other values are reserved. |  |  |  |  |  |  |  |  |   
## 9.3 Non-IP PDU format
The non-IP PDU is coded according to figure 9.3.1 and table 9.3.1.
+------------------+-----+---+-----+-----+-----+-----+-----+----------+ | > Bits | | | | | | | | | +==================+=====+===+=====+=====+=====+=====+=====+==========+ | 8 | 7 | 6 | > 5 | > 4 | > 3 | > 2 | > 1 | > Octets | +------------------+-----+---+-----+-----+-----+-----+-----+----------+ | > Non-IP type | > 1 | | | | | | | | +------------------+-----+---+-----+-----+-----+-----+-----+----------+ | > Non-IP payload | > 2 | | | | | | | | +------------------+-----+---+-----+-----+-----+-----+-----+----------+ | | | | | | | | | | +------------------+-----+---+-----+-----+-----+-----+-----+----------+ | | | | | | | | | | +------------------+-----+---+-----+-----+-----+-----+-----+----------+ | | > n | | | | | | | | +------------------+-----+---+-----+-----+-----+-----+-----+----------+
Figure 9.3.1: Non-IP PDU format
Table 9.3.1: Non-IP PDU values
Octet 1 contains the non-IP type field which indicates the V2X message family
(see table 9.2.1) included in the non-IP payload.
* * *
Octets 2 to n contain the non-IP payload field containing the non-IP data.
# 10 List of system parameters
## 10.1 General
The description of timers in the following tables should be considered a brief
summary. The complete descriptions of the timers are in the procedures defined
in clauses 5 and 6.
## 10.2 Timers of provisioning of parameters for V2X configuration procedures
Timers of provisioning of parameters for V2X configuration are shown in table
10.2.1.
Table 10.2.1: Timers of provisioning of parameters for V2X configuration \--
UE side
* * *
TIMER NUM. TIMER VALUE CAUSE OF START NORMAL STOP ON\ THE\ 1^st^, 2^nd^,
3^rd^, 4^th^ EXPIRY
T5040 16s Transmission of UE POLICY PROVISIONING REQUEST message MANAGE UE
POLICY COMMAND or UE POLICY PROVISIONING REJECT message received
Retransmission of UE POLICY PROVISIONING REQUEST message
* * *
## 10.3 Timers of PC5 unicast link management procedures
Table 10.3.1: PC5 unicast link management timers
+-------------+-------------+-------------+-------------+-------------+ | TIMER NUM. | TIMER VALUE | CAUSE OF | NORMAL STOP | ON\ | | | | START | | EXPIRY | +-------------+-------------+-------------+-------------+-------------+ | T5000 | 8s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | NOTE 1 | DIRECT LINK | DIRECT LINK | of DIRECT | | | | ES | ES | LINK | | | | TABLISHMENT | TABLISHMENT | ES | | | | REQUEST | ACCEPT or | TABLISHMENT | | | | message | DIRECT LINK | REQUEST | | | | | ES | message if | | | | | TABLISHMENT | the Target | | | | | REJECT | user info | | | | | message | is included | | | | | from the | in the | | | | | target UE | DIRECT LINK | | | | | if the | ES | | | | | Target user | TABLISHMENT | | | | | info is | REQUEST | | | | | included in | message; or | | | | | the DIRECT | | | | | | LINK | may abort | | | | | ES | the ongoing | | | | | TABLISHMENT | procedure | | | | | REQUEST | if the | | | | | message | Target user | | | | | | info is not | | | | | | included in | | | | | | the DIRECT | | | | | | LINK | | | | | | ES | | | | | | TABLISHMENT | | | | | | REQUEST | | | | | | message | +-------------+-------------+-------------+-------------+-------------+ | T5001 | 5s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of DIRECT | | | | M | M | LINK | | | | ODIFICATION | ODIFICATION | M | | | | REQUEST | ACCEPT or | ODIFICATION | | | | message | DIRECT LINK | REQUEST | | | | | M | message | | | | | ODIFICATION | | | | | | REJECT or | | | | | | DIRECT LINK | | | | | | RELEASE | | | | | | REQUEST | | | | | | message | | | | | | from the | | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5002 | 5s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of DIRECT | | | | RELEASE | RELEASE | LINK | | | | REQUEST | ACCEPT | RELEASE | | | | message | message | REQUEST | | | | | from the | message | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5003 | 5s | Upon | Upon PC5 | Initiate | | | | receiving a | unicast | the PC5 | | | | PC5 | link | unicast | | | | signalling | release or | link | | | | message or | upon | keep-alive | | | | PC5 user | initiating | procedure | | | | plane data | the PC5 | | | | | | unicast | | | | | | link | | | | | | keep-alive | | | | | | procedure | | +-------------+-------------+-------------+-------------+-------------+ | T5004 | 5s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | PC5 | of the | | | | KEEPALIVE | signalling | DIRECT LINK | | | | REQUEST | message or | KEEPALIVE | | | | message | PC5 user | REQUEST | | | | | plane data | message | +-------------+-------------+-------------+-------------+-------------+ | T5005 | Default 10m | Upon | Upon | Either | | | | receiving a | receiving a | initiate | | | NOTE 2 | Maximum | PC5 | the PC5 | | | | inactivity | signalling | unicast | | | | period in a | message or | link | | | | DIRECT LINK | PC5 user | keep-alive | | | | KEEPALIVE | plane data | procedure | | | | REQUEST | | or the PC5 | | | | message, | | unicast | | | | receiving a | | link | | | | PC5 | | release | | | | signalling | | procedure | | | | message or | | | | | | receiving | | | | | | PC5 user | | | | | | plane data | | | +-------------+-------------+-------------+-------------+-------------+ | T5006 | 2s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of DIRECT | | | | AUT | AUT | LINK | | | | HENTICATION | HENTICATION | AUT | | | | REQUEST | RESPONSE or | HENTICATION | | | | message | DIRECT LINK | REQUEST | | | | | AUT | message | | | | | HENTICATION | | | | | | REJECT | | | | | | message | | | | | | from the | | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5007 | 2s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of DIRECT | | | | SECURITY | SECURITY | LINK | | | | MODE | MODE | SECURITY | | | | COMMAND | COMPLETE or | MODE | | | | message | DIRECT LINK | COMMAND | | | | | SECURITY | message | | | | | MODE REJECT | | | | | | message | | | | | | from the | | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5008 | 8s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of DIRECT | | | | REKEYING | REKEYING | LINK | | | | REQUEST | RESPONSE | REKEYING | | | | message | message or | REQUEST | | | | | DIRECT LINK | message | | | | | RELEASE | | | | | | REQUEST | | | | | | message | | | | | | from the | | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5009 | 2s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of the | | | | IDENTIFIER | IDENTIFIER | DIRECT LINK | | | | UPDATE | UPDATE | IDENTIFIER | | | | REQUEST | ACCEPT or | UPDATE | | | | message | DIRECT LINK | REQUEST | | | | | IDENTIFIER | message | | | | | UPDATE | | | | | | REJECT or | | | | | | DIRECT LINK | | | | | | RELEASE | | | | | | REQUEST | | | | | | message | | | | | | from the | | | | | | target UE | | +-------------+-------------+-------------+-------------+-------------+ | T5010 | 2s | Upon | Upon | Ret | | | | sending a | receiving a | ransmission | | | | DIRECT LINK | DIRECT LINK | of the | | | | IDENTIFIER | IDENTIFIER | DIRECT LINK | | | | UPDATE | UPDATE ACK | IDENTIFIER | | | | ACCEPT | message or | UPDATE | | | | message | DIRECT LINK | ACCEPT | | | | | RELEASE | message | | | | | REQUEST | | | | | | message | | | | | | from the | | | | | | initiating | | | | | | UE | | +-------------+-------------+-------------+-------------+-------------+ | T5011 | NOTE 2 | Upon | Upon | T | | | | e | completing | ransmission | | | | stablishing | a PC5 | of LINK | | | | a PC5 | unicast | IDENTIFIER | | | | unicast | link | UPDATE | | | | link and at | identifier | REQUEST | | | | least one | update and | message | | | | of V2X | if | | | | | service | available | | | | | identifier | or | | | | | for the PC5 | accepting a | | | | | unicast | DIRECT LINK | | | | | link | IDENTIFIER | | | | | satisfying | UPDATE | | | | | the privacy | REQUEST | | | | | r | message or | | | | | equirements | upon a PC5 | | | | | or | unicast | | | | | | link | | | | | upon | release and | | | | | completing | if | | | | | a PC5 | available | | | | | unicast | | | | | | link update | | | | | | and at | | | | | | least one | | | | | | of V2X | | | | | | service | | | | | | identifiers | | | | | | for the PC5 | | | | | | unicast | | | | | | link | | | | | | satisfying | | | | | | the privacy | | | | | | r | | | | | | equirements | | | | | | or Upon | | | | | | completing | | | | | | the PC5 | | | | | | unicast | | | | | | link | | | | | | identifier | | | | | | update | | | | | | procedure. | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1 If | | | | | | the Target | | | | | | user info | | | | | | is not | | | | | | included in | | | | | | the DIRECT | | | | | | LINK | | | | | | ES | | | | | | TABLISHMENT | | | | | | REQUEST | | | | | | message, | | | | | | then the | | | | | | initiating | | | | | | UE may keep | | | | | | the timer | | | | | | T5000 | | | | | | running | | | | | | upon | | | | | | receiving | | | | | | DIRECT LINK | | | | | | ES | | | | | | TABLISHMENT | | | | | | ACCEPT | | | | | | message. | | | | | | | | | | | | NOTE 2 The | | | | | | value of | | | | | | this timer | | | | | | is the | | | | | | privacy | | | | | | timer value | | | | | | which is | | | | | | one of the | | | | | | co | | | | | | nfiguration | | | | | | parameters | | | | | | for V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5 | | | | | | (see | | | | | | clause 5.2) | | | | | | and it is | | | | | | specified | | | | | | in | | | | | | 3GPP TS 2 | | | | | | 4.588 [7] | | | | | | clause 5.3. | | | | | +-------------+-------------+-------------+-------------+-------------+
## 10.4 Timers of PC5 broadcast mode communication
Table 10.4.1: PC5 mode communication timers
+-------------+-------------+-------------+-------------+-------------+ | TIMER NUM. | TIMER VALUE | CAUSE OF | NORMAL STOP | ON\ | | | | START | | EXPIRY | +-------------+-------------+-------------+-------------+-------------+ | T5020 | NOTE 1 | Upon | Upon | Change the | | | | initiating | stopping | value of | | | | t | t | the source | | | | ransmission | ransmission | layer-2 ID | | | | of | of | se | | | | broadcast | broadcast | lf-assigned | | | | mode V2X | mode V2X | by the UE | | | | co | co | for | | | | mmunication | mmunication | broadcast | | | | over PC5, | over PC5, | mode V2X | | | | as | as | co | | | | described | described | mmunication | | | | in | in | over PC5. | | | | clause | clause | | | | | 6.1.3.2.4. | 6.1.3.2.4. | If the V2X | | | | | | message | | | | Upon | | contains IP | | | | receiving | | data, | | | | an | | change the | | | | indication | | value of | | | | from upper | | the source | | | | layers that | | IP address | | | | the | | se | | | | application | | lf-assigned | | | | layer | | by the UE | | | | identifier | | for | | | | has been | | broadcast | | | | changed | | mode V2X | | | | while | | co | | | | performing | | mmunication | | | | t | | over PC5. | | | | ransmission | | | | | | of | | | | | | broadcast | | | | | | mode V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5, | | | | | | as | | | | | | described | | | | | | in | | | | | | clause | | | | | | 6.1.3.2.4. | | | | | | | | | | | | Upon T5020 | | | | | | expiration | | | | | | while | | | | | | performing | | | | | | t | | | | | | ransmission | | | | | | of | | | | | | broadcast | | | | | | mode V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5, | | | | | | as | | | | | | described | | | | | | in | | | | | | clause | | | | | | 6.1.3.2.4. | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1 The | | | | | | value of | | | | | | this timer | | | | | | is the | | | | | | privacy | | | | | | timer value | | | | | | which is | | | | | | one of the | | | | | | co | | | | | | nfiguration | | | | | | parameters | | | | | | for V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5 | | | | | | (see | | | | | | c | | | | | | lause 5.2), | | | | | +-------------+-------------+-------------+-------------+-------------+
## 10.5 Timers of PC5 groupcast mode communication
Table 10.5.1: PC5 groupcast mode communication timers
+-------------+-------------+-------------+-------------+-------------+ | TIMER NUM. | TIMER VALUE | CAUSE OF | NORMAL STOP | ON\ | | | | START | | EXPIRY | +-------------+-------------+-------------+-------------+-------------+ | T5030 | NOTE 1 | Upon | Upon | Change the | | | | initiating | stopping | value of | | | | t | t | the source | | | | ransmission | ransmission | layer-2 ID | | | | of | of | se | | | | groupcast | groupcast | lf-assigned | | | | mode V2X | mode V2X | by the UE | | | | co | co | for | | | | mmunication | mmunication | groupcast | | | | over PC5, | over PC5, | mode V2X | | | | as | as | co | | | | described | described | mmunication | | | | in | in | over PC5. | | | | clause | clause | | | | | 6.1.3.2.4. | 6.1.3.2.4. | If the V2X | | | | | | message | | | | Upon | | contains IP | | | | receiving | | data, | | | | an | | change the | | | | indication | | value of | | | | from upper | | the source | | | | layers that | | IP address | | | | the | | se | | | | application | | lf-assigned | | | | layer | | by the UE | | | | identifier | | for | | | | has been | | groupcast | | | | changed | | mode V2X | | | | while | | co | | | | performing | | mmunication | | | | t | | over PC5. | | | | ransmission | | | | | | of | | | | | | groupcast | | | | | | mode V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5, | | | | | | as | | | | | | described | | | | | | in | | | | | | clause | | | | | | 6.1.4.2.4. | | | | | | | | | | | | Upon T5030 | | | | | | expiration | | | | | | while | | | | | | performing | | | | | | t | | | | | | ransmission | | | | | | of | | | | | | groupcast | | | | | | mode V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5, | | | | | | as | | | | | | described | | | | | | in | | | | | | clause | | | | | | 6.1.3.2.4. | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1 The | | | | | | value of | | | | | | this timer | | | | | | is the | | | | | | privacy | | | | | | timer value | | | | | | which is | | | | | | one of the | | | | | | co | | | | | | nfiguration | | | | | | parameters | | | | | | for V2X | | | | | | co | | | | | | mmunication | | | | | | over PC5 | | | | | | (see | | | | | | c | | | | | | lause 5.2), | | | | | +-------------+-------------+-------------+-------------+-------------+
#