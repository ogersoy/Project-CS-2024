# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The present document provides the stage 3 specification of the PFD Management
Service of the 5G system.
The stage 2 definition and related procedures of the PFD Management Service
are contained in 3GPP TS 23.502 [3] and 3GPP TS 23.503 [4]. The 5G System
Architecture is defined in 3GPP TS 23.501 [2].
The Technical Realization of the Service Based Architecture and the Principles
and Guidelines for Services Definition of the 5G System are specified in 3GPP
TS 29.500 [5] and 3GPP TS 29.501 [6].
The Packet Flow Description Function (PFDF) provides the PFD Management
Service to NF consumers (e.g. Session Management Function). The PFDF is
functionality within the NEF.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[4] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G System;
Stage 2\".
[5] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture; Stage 3\".
[6] 3GPP TS 29.501: \"5G System; Principles and Guidelines for Services
Definition; Stage 3\".
[7] IETF RFC 7540: \"Hypertext Transfer Protocol Version 2 (HTTP/2)\".
[8] IETF RFC 8259: \"The JavaScript Object Notation (JSON) Data Interchange
Format\".
[9] OpenAPI: \"OpenAPI 3.0.0 Specification\", https://github.com/OAI/OpenAPI-
Specification/blob/master/versions/3.0.0.md.
[10] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces Stage 3\".
[11] 3GPP TS 29.122: \"T8 reference point for Northbound APIs\".
[12] 3GPP TS 29.251: \"Gw and Gwn reference points for sponsored data
connectivity\".
[13] 3GPP TS 29.510: \"5G System; Network Function Repository Services; Stage
3\".
[14] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[15] IETF RFC 6749: \"The OAuth 2.0 Authorization Framework\".
[16] IETF RFC 7807: \"Problem Details for HTTP APIs\".
[17] 3GPP TR 21.900: \"Technical Specification Group working methods\".
[18] IETF RFC 6733: \"Diameter Base Protocol\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
JSON JavaScript Object Notation
NEF Network Exposure Function
NRF Network Repository Function
PFD Packet Flow Description
PFDF Packet Flow Description Function
SBI Service Based Interface
SMF Session Management Function
# 4 Packet Flow Description Management Service
## 4.1 Service Description
### 4.1.1 Overview
The PFD Management Service, as defined as defined in 3GPP TS 23.501 [2], 3GPP
TS 23.502 [3] and 3GPP TS 23.503 [4], is provided by the Packet Flow
Description Function (PFDF).
The only known NF Service Consumer is the SMF.
This service:
\- allows an SMF to subscribe to and unsubscribe from PFD changes;
\- notifies an SMF about changes of PFDs; and
\- allows an SMF to retrieve PFDs.
### 4.1.2 Service Architecture
The 5G System Architecture is defined in 3GPP TS 23.501 [2]. The Policy and
Charging related 5G architecture is also described in 3GPP TS 23.503 [4].
The PFD Management Service is provided by the PFDF to NF service consumers
(e.g. SMF) and shown in the SBI representation model in Figure 4.1.2-1. The
PFDF is a functionality within the NEF.
Figure 4.1.2-1: Reference Architecture for the Nnef_PFDmanagement Service; SBI
representation
Figure 4.1.2-2: Reference Architecture for the Nnef_PFDmanagement Service;
reference point representation
### 4.1.3 Network Functions
#### 4.1.3.1 Packet Flow Description Function (PFDF)
The Packet Flow Description Function (PFDF):
\- provides PFDs associated with one or more Application Identifiers; and
\- allows NF consumers to subscribe to and unsubscribe from notifications on
changes of PFDs for Application Identifier.
#### 4.1.3.2 NF Service Consumers
The SMF shall support:
\- requesting and receiving the PFD(s) for one or more Application
Identifiers.
## 4.2 Service Operations
### 4.2.1 Introduction
Service operations defined for the Nnef_PFDmanagement Service are shown in
table 4.2.1-1.
_Table 4.2.1-1: Nnef_PFDmanagement Service Operations_
* * *
Service Operation Name Description Initiated by Nnef_PFDmanagement_Fetch
Provides the PFDs for application identifier(s) to the NF service consumer.
SMF Nnef_PFDmanagement_Subscribe Allows NF service consumers to subscribe to
notifications on events when the PFDs for application identifier(s) change.
SMF Nnef_PFDmanagement_Notify Notifies NF service consumers to update and/or
delete the PFDs for application identifier(s). PFDF
Nnef_PFDmanagement_Unsubscribe Allows NF service consumers to unsubscribe from
notifications on PFDs change events. SMF
* * *
### 4.2.2 Nnef_PFDmanagement_Fetch Service Operation
#### 4.2.2.1 General
The Nnef_PFDmanagement_Fetch service operation provides means for the NF
service consumer to retrieve the PFDs for one or more application
identifier(s).
The following procedures using the Nnef_PFDmanagement_Fetch service operation
are supported:
\- Retrieval of PFDs.
#### 4.2.2.2 Retrieval of PFDs
This procedure, as shown in Figure 4.2.2.2-1, is used to retrieve PFDs for an
application identifier from the PFDF. This procedure enables the NF service
consumer to retrieve PFDs for an Application Identifier(s) from the PFDF when:
\- a PCC rule with this application identifier is provided/activated by the
PCF and the PFDs provided by the PFDF are not available at the NF service
consumer; or
\- the caching timer for an application identifier elapses and a PCC rule for
this application identifier is still active.
When the SMF removes the last PCC rule that refers to the corresponding
application identifier, or when the caching timer expires and no PCC rule
refers to the application identifier, the SMF may remove the PFD(s) related
with the application identifier.
The PFDs retrieved from PFDF take precedence over any PFDs pre-configured in
the SMF. If all PFDs retrieved from the PFDF are removed for an application
identifier, the pre-configured PFDs shall be applied again for the application
identifier.
The PFDF may provide caching time value together with the PFDs for an
application identifier. The caching time value retrieved from the PFDF takes
precedence over the default caching time value configured in the NF service
consumer. If no caching time value is received from the PFDF, the configured
default caching time value shall be applied.
NOTE 1: The NF service consumer(s) and the PFDF(s) within an operator network
are configured with the same default caching time value to be applied for all
application identifiers.
NOTE 2: The configuration of a caching time value per application identifier
in the PFDF is based on the SLA between the operator and the ASP.
Figure 4.2.2.2-1: Retrieval of PFDs
1\. The NF service consumer (e.g. SMF) shall send a GET request to the
resource representing the PFDs for the requested application identifier(s):
\- for PFDs of an individual application identifier, the request URI shall be
set to \"{apiRoot}/nnef‑pfdmanagement/v1/applications/{appId}\" (as shown in
figure 4.2.2.2-1, step 1a); and
\- for PFD of a collection of application identifiers, the request URI shall
be set to \"{apiRoot}/nnef‑pfdmanagement/v1/applications\" (as shown in figure
4.2.2.2-1, step 1b) with query parameters indicating the requested application
identifier(s).
2\. On success, an HTTP \"200 OK\" response shall be returned, with the
payload body containing a representation of an \"Individual application PFD\"
resource or a \"PFD of applications\" resource for the requested application
identifier(s). The NF service consumer shall replace the stored PFD(s)
retrieved from the PFDF with the new received PFD(s) for the requested
application identifier(s). If the PFD(s) of one or more requested application
identifier(s) are not provided in the response, the NF service consumer shall
remove the PFD(s) of these requested application identifier(s) and re-apply
the pre-configured PFDs.\ \ If errors occur when processing the HTTP GET
request, the PFDF shall send an HTTP error response as specified in subclause
5.7. For \"404 Not Found\", the NF service consumer shall remove the PFD(s) of
the requested application identifier(s) in the NF service consumer and re-
apply the pre-configured PFDs.
> If the feature \"ES3XX\" is supported, and the PFDF determines the received
> HTTP GET request needs to be redirected, the PFDF shall send an HTTP
> redirect response as specified in subclause 6.10.9 of 3GPP TS 29.500 [5].
### 4.2.3 Nnef_PFDmanagement_Subscribe Service Operation
#### 4.2.3.1 General
The Nnef_PFDmanagement_Subscribe service operation enables the NF service
consumer to subscribe to notifications on events when the PFDs for application
identifier(s) change.
The following procedures using the Nnef_PFDmanagement_Subscribe service
operation are supported:
\- Subscription for event notifications on PFDs change;
\- Subscription update for event notifications on PFD change.
#### 4.2.3.2 Subscription for event notifications on PFDs change
This procedure, as shown in Figure 4.2.3.2-1, is used to subscribe to
notifications on events when the PFDs for application identifier(s) change.
Figure 4.2.3.2-1: Creation of a subscription for event notifications on PFDs
change
1\. The NF service consumer (e.g. SMF) shall send a POST request to the
request URI representing the collection of PFD subscriptions resource
\"{apiRoot}/nnef‑pfdmanagement/v1/subscriptions\". The NF service consumer
shall include the PfdSubscription data type in the request. Within the
PfdSubscription data type, the NF service consumer payload body shall include:
\- an URI where to receive the requested notifications as \"notifyUri\"
attribute;
and may include:
\- subscribed application identifier(s) within the \"applicationIds\"
attribute.
2\. If the request is accepted, the PFDF shall:
\- create a new subscription;
\- assign a subscriptionId;
\- store the subscription; and
\- send an HTTP \"201 Created\" response, with the payload body containing a
representation of the created subscription, and the Location header containing
the resource URI of the created subscription \"{apiRoot}/nnef-
pfdmanagement/v1/subscriptions/{subscriptionId}\".
Otherwise, one of the HTTP status codes listed in table 5.3.4.3.1-3 shall be
returned.
NOTE: The PFDs that have been provisioned to the PFDF before the NF service
consumer performs the subscription are not notified to the NF service consumer
as a result of this subscription, but the NF service consumer can retrieve
them before performing the subscription by invoking Nnef_PFDmanagement_Fetch
Service Operation.
#### 4.2.3.3 Subscription update for event notifications on PFDs change
This procedure, as shown in Figure 4.2.3.3-1, is used to update an existing
subscription to notifications on events when the PFDs for application
identifier(s) change.
Figure 4.2.3.3-1: Update of a subscription for event notifications on PFDs
change
1\. If the feature PfdChgSubsUpdate is supported, the NF service consumer
(e.g. SMF) shall send a PUT request to the resource URI representing the
targeted PFD subscription resource
\"{apiRoot}/nnef‑pfdmanagement/v1/subscriptions/{subscriptionId}\". The NF
service consumer shall include the PfdSubscription data type in the request.
Within the PfdSubscription data type, the NF service consumer payload body
shall include:
\- an URI where to receive the requested notifications as \"notifyUri\"
attribute;
and may include:
\- subscribed application identifier(s) within the \"applicationIds\"
attribute.
NOTE 1: The \"notifUri\" attribute within the PfdSubscription data structure
can be modified to request that subsequent notifications are sent to a new NF
service consumer.
2\. If the feature PfdChgSubsUpdate is supported and the request is accepted,
the PFDF shall:
\- update the subscription; and
\- send an HTTP \"200 OK\" response, with the payload body containing a
representation of the updated subscription.
Otherwise, if errors occur when processing the HTTP PUT request, the PFDF
shall send an HTTP error response as specified in subclause 5.7. If the
feature \"ES3XX\" is supported, and the PFDF determines the received HTTP PUT
request needs to be redirected, the PFDF shall send an HTTP redirect response
as specified in subclause 6.10.9 of 3GPP TS 29.500 [5].
NOTE 2: The PFDs that have been provisioned to the PFDF before the NF service
consumer performs the subscription are not notified to the NF service consumer
as a result of this subscription, but the NF service consumer can retrieve
them before performing the subscription by invoking Nnef_PFDmanagement_Fetch
Service Operation.
### 4.2.4 Nnef_PFDmanagement_Notify Service Operation
#### 4.2.4.1 General
The Nnef_PFDmanagement_Notify service operation notifies the NF service
consumer to update and/or delete the PFDs for application identifier(s).
The following procedures using the Nnef_PFDmanagement_Notify service operation
are supported:
\- Management of PFDs.
#### 4.2.4.2 Notification of PFD change
Figure 4.2.4.2-1: Notification of PFD change
1\. The PFDF shall send a POST request to the NF service consumer (e.g. SMF)
targeting the URI \"{notifyUri}\", where {notifyUri} is the notification URI
provided during the creation or modification of the subscription resource, as
specified in subclause 4.2.3.2. The payload body of the POST request shall
contain one or more PfdChangeNotification data structure(s).
2 If the notification is accepted, the NF service consumer shall reply with:
\- \"204 No Content\" indicating the successful provisioning of all PFDs; or
\- \"200 OK\" and the payload body of the response shall contain
\"PfdChangeReport\" data structure with detailed information of failed
application(s).
Otherwise, if errors occur when processing the HTTP POST request, the NF
service consumer shall send an HTTP error response as specified in subclause
5.7. If the feature \"ES3XX\" is supported, and the NF service consumer
determines the received HTTP POST request needs to be redirected, the NF
service consumer shall send an HTTP redirect response as specified in
subclause 6.10.9 of 3GPP TS 29.500 [5].
### 4.2.5 Nnef_PFDmanagement_Unsubscribe Service Operation
#### 4.2.5.1 General
The Nnef_PFDmanagement_Unsubscribe service operation is used by the NF service
consumer to unsubscribe from notifications on PFD change events.
The following procedures using the Nnef_PFDmanagement_Unsubscribe service
operation are supported:
\- Unsubscribe from event notifications on PFDs change.
#### 4.2.5.2 Unsubscribe from event notifications on PFDs change
Figure 4.2.5.2-1: Unsubscribe from event notifications on PFDs change
1\. The NF Service Consumer (e.g. SMF) shall send a DELETE request to the
resource URI representing the individual PFD subscription. The request body
shall be empty.
2\. If the request is accepted, an HTTP \"204 No Content\" response shall be
returned. The response body shall be empty.\ \ Otherwise, if errors occur when
processing the HTTP DELETE request, the PFDF shall send an HTTP error response
as specified in subclause 5.7. If the feature \"ES3XX\" is supported, and the
PFDF determines the received HTTP DELETE request needs to be redirected, the
PFDF shall send an HTTP redirect response as specified in subclause 6.10.9 of
3GPP TS 29.500 [5].
# 5 Nnef_PFDmanagement API
## 5.1 Introduction
The Packet Flow Description Management Service shall use the
Nnef_PFDmanagement API.
The API URI of the Nnef_PFDmanagement API shall be:
{apiRoot}/\/\/
The request URIs used in HTTP requests from the NF service consumer towards
the PFDF shall have the Resource URI structure defined in subclause 4.4.1 of
3GPP TS 29.501 [6], i.e.:
**{apiRoot}/\ /\/\**
with the following components:
\- The {apiRoot} shall be set as described in 3GPP TS 29.501 [6].
\- The **\ ** shall be \"nnef-pfdmanagement\".
\- The **\ ** shall be \"v1\".
\- The **\ ** shall be set as described in
subclause 5.3.
## 5.2 Usage of HTTP
### 5.2.1 General
HTTP/2, IETF RFC 7540 [7], shall be used as specified in subclause 5.2 of 3GPP
TS 29.500 [5].
HTTP/2 shall be transported as specified in subclause 5.3 of 3GPP TS 29.500
[5].
The OpenAPI [9] specification of HTTP messages and content bodies for the
Nnef_PFDmanagement service is contained in Annex A.
### 5.2.2 HTTP standard headers
#### 5.2.2.1 General
See subclause 5.2.2 of 3GPP TS 29.500 [5] for the usage of HTTP standard
headers.
#### 5.2.2.2 Content type
JSON, IETF RFC 8259 [8], shall be used as content type of the HTTP bodies
specified in the present specification, as specified in subclause 5.4 of 3GPP
TS 29.500 [5]. The use of the JSON format shall be signalled by the content
type \"application/json\".
\"Problem Details\" JSON object shall be used to indicate additional details
of the error in a HTTP response body and shall be signalled by the content
type \"application/problem+json\", as defined in IETF RFC 7807 [16].
### 5.2.3 HTTP custom headers
None
## 5.3 Resources
### 5.3.1 Resource Structure
Figure 5.3.1-1: Resource URI structure of the Nnef_PFDmanagement API
Table 5.3.1-1 provides an overview of the resources and applicable HTTP
methods.
Table 5.3.1-1: Resources and methods overview
+----------------+----------------+----------------+----------------+ | Resource name | Resource URI | HTTP method or | Description | | | | custom | | | | | operation | | +----------------+----------------+----------------+----------------+ | PFD of | /applications | GET | Nnef_PFDmana | | applications | | | gement_Fetch. | | | | | | | | | | Retrieve PFDs | | | | | for one or | | | | | multiple | | | | | applications | | | | | using query | | | | | parameters. | +----------------+----------------+----------------+----------------+ | Individual | /applic | GET | Nnef_PFDmana | | application | ations/{appId} | | gement_Fetch. | | PFD | | | | | | | | Retrieve the | | | | | PFD for an | | | | | application. | +----------------+----------------+----------------+----------------+ | PFD | /subscriptions | POST | Nne | | subscriptions | | | f_PFDmanageme | | | | | nt_Subscribe. | | | | | | | | | | Subscribe the | | | | | notification | | | | | of PFD | | | | | changes. | +----------------+----------------+----------------+----------------+ | Individual PFD | /su | PUT | Update a | | subscription | bscriptions/{s | | subscription | | | ubscriptionId} | | to PFD change | | | | | notifications. | +----------------+----------------+----------------+----------------+ | Individual PFD | /su | DELETE | Nnef\ | | subscription | bscriptions/{s | | _PFDmanagement | | | ubscriptionId} | | _Unsubscribe. | | | | | | | | | | Delete a | | | | | subscription | | | | | to PFD change | | | | | notifications. | +----------------+----------------+----------------+----------------+
### 5.3.2 Resource: PFD of applications
#### 5.3.2.1 Description
This resource represents PFDs for all applications.
#### 5.3.2.2 Resource definition
Resource URI: **{apiRoot}/nnef-pfdmanagement/v1/applications**
This resource shall support the resource URI variables defined in table
5.3.2.2-1.
Table 5.3.2.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See subclause 5.1
* * *
#### 5.3.2.3 Resource Standard Methods
##### 5.3.2.3.1 GET
This method shall support the URI query parameters specified in table
5.3.2.3.1-1.
Table 5.3.2.3.1-1: URI query parameters supported by the GET method on this
resource
* * *
Name Data type P Cardinality Description application-ids array(ApplicationId)
M 1..N The requested application identifier(s) for which PFDs shall be
returned. supported-features SupportedFeatures O 0..1 To filter irrelevant
responses related to unsupported features.
* * *
This method shall support the request data structures specified in table
5.3.2.3.1-2 and the response data structures and response codes specified in
table 5.3.2.3.1-3.
Table 5.3.2.3.1-2: Data structures supported by the GET Request Body on this
resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.2.3.1-3: Data structures supported by the GET Response Body on this
resource
+-----------------+---+-------------+----------+-----------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +-----------------+---+-------------+----------+-----------------+ | array | M | 0..N | 200 OK | The PFDs for | | (PfdDataForApp) | | | | one or more | | | | | | application | | | | | | identifier(s) | | | | | | provided in the | | | | | | request URI are | | | | | | returned. | +-----------------+---+-------------+----------+-----------------+ | NOTE: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which are | | | | | | specified as | | | | | | mandatory in | | | | | | table 5.2.7.1-1 | | | | | | of | | | | | | 3GPP | | | | | | TS 29.500 [5] | | | | | | for the GET | | | | | | method shall | | | | | | also apply. | | | | | +-----------------+---+-------------+----------+-----------------+
#### 5.3.2.4 Resource Custom Operations
None.
### 5.3.3 Resource: Individual application PFD
#### 5.3.3.1 Description
This resource represents the PFD identified by an application identifier.
#### 5.3.3.2 Resource definition
Resource URI: **{apiRoot}/nnef-pfdmanagement/v1/applications/{appId}**
This resource shall support the resource URI variables defined in table
5.3.3.2-1.
Table 5.3.3.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See subclause 5.1. appId string
Identifies a set of PFD for an application identifier.
* * *
#### 5.3.3.3 Resource Standard Methods
##### 5.3.3.3.1 GET
This method shall support the URI query parameters specified in table
5.3.3.3.1-1.
Table 5.3.3.3.1-1: URI query parameters supported by the GET method on this
resource
* * *
Name Data type P Cardinality Description supported-features SupportedFeatures
O 0..1 To filter irrelevant responses related to unsupported features.
* * *
This method shall support the request data structures specified in table
5.3.3.3.1-2 and the response data structures and response codes specified in
table 5.3.3.3.1-3.
Table 5.3.3.3.1-2: Data structures supported by the GET Request Body on this
resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.3.3.1-3: Data structures supported by the GET Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | PfdDataForApp | M | 1 | 200 OK | A | | | | | | r | | | | | | epresentation | | | | | | of PFDs for | | | | | | an | | | | | | application | | | | | | in the | | | | | | request URI | | | | | | is returned. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | retrieval. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | retrieval. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | NOTE: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which | | | | | | are specified | | | | | | as mandatory | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | for the GET | | | | | | method shall | | | | | | also apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.3.3.1-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.3.3.1-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
#### 5.3.3.4 Resource Custom Operations
None.
### 5.3.4 Resource: PFD subscriptions
#### 5.3.4.1 Description
This resource represents a collection of subscriptions created by NF service
consumers of Nnef_PFDmanagement service.
#### 5.3.4.2 Resource definition
Resource URI: **{apiRoot}/nnef-pfdmanagement/v1/subscriptions**
This resource shall support the resource URI variables defined in table
5.3.4.2-1.
Table 5.3.4.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See subclause 5.1
* * *
#### 5.3.4.3 Resource Standard Methods
##### 5.3.4.3.1 POST
This method shall support the URI query parameters specified in table
5.3.4.3.1-1.
Table 5.3.4.3.1-1: URI query parameters supported by the POST method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.4.3.1-2 and the response data structures and response codes specified in
table 5.3.4.3.1-3.
Table 5.3.4.3.1-2: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description PfdSubscription M 1 Create a
PfdSubscription resource.
* * *
Table 5.3.4.3.1-3: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+-------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+-------------+---------------+ | Pf | M | 1 | 201 Created | The creation | | dSubscription | | | | of a | | | | | | Pf | | | | | | dSubscription | | | | | | resource is | | | | | | confirmed and | | | | | | a | | | | | | r | | | | | | epresentation | | | | | | of that | | | | | | resource is | | | | | | returned. | +---------------+---+-------------+-------------+---------------+ | NOTE: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which | | | | | | are specified | | | | | | as mandatory | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | for the POST | | | | | | method shall | | | | | | also apply. | | | | | +---------------+---+-------------+-------------+---------------+
Table 5.3.4.3.1-4: Headers supported by the 201 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 Contains the URI
of the newly created resource, according to the structure: {apiRoot}/nnef-
pfdmanagement/v1/subscriptions/{subscriptionId}
* * *
#### 5.3.4.4 Resource Custom Operations
None.
### 5.3.5 Resource: Individual PFD subscription
#### 5.3.5.1 Description
This resource represents an individual PFD subscription created by an NF
service consumer of the Nnef_PFDmanagement service.
#### 5.3.5.2 Resource definition
Resource URI: **{apiRoot}/nnef-
pfdmanagement/v1/subscriptions/{subscriptionId}**
This resource shall support the resource URI variables defined in table
5.3.5.2-1.
Table 5.3.5.2-1: Resource URI variables for this resource
* * *
Name Data type Definition apiRoot string See subclause 5.1 subscriptionId
string Identifies an individual subscription to the PFD management service
* * *
#### 5.3.5.3 Resource Standard Methods
##### 5.3.5.3.1 DELETE
This method shall support the URI query parameters specified in table
5.3.5.3.1-1.
Table 5.3.5.3.1-1: URI query parameters supported by the DELETE method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.5.3.1-2 and the response data structures and response codes specified in
table 5.3.5.3.1-3.
Table 5.3.5.3.1-2: Data structures supported by the DELETE Request Body on
this resource
* * *
Data type P Cardinality Description n/a
* * *
Table 5.3.5.3.1-3: Data structures supported by the DELETE Response Body on
this resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The | | | | | Content | Pf | | | | | | dSubscription | | | | | | resource | | | | | | matching the | | | | | | s | | | | | | ubscriptionId | | | | | | was deleted | | | | | | successfully. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | deletion. The | | | | | | response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | deletion. The | | | | | | response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | NOTE: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which | | | | | | are specified | | | | | | as mandatory | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | for the | | | | | | DELETE method | | | | | | shall also | | | | | | apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.5.3.1-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.5.3.1-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
##### 5.3.5.3.2 PUT
This method shall support the URI query parameters specified in table
5.3.5.3.2-1.
Table 5.3.5.3.2-1: URI query parameters supported by the PUT method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.3.5.3.2-2 and the response data structures and response codes specified in
table 5.3.5.3.2-3.
Table 5.3.5.3.2-2: Data structures supported by the PUT Request Body on this
resource
* * *
Data type P Cardinality Description PfdSubscription M 1 Update a
PfdSubscription resource.
* * *
Table 5.3.5.3.2-3: Data structures supported by the PUT Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | | | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | Pf | M | 1 | 200 OK | The update of | | dSubscription | | | | a | | | | | | Pf | | | | | | dSubscription | | | | | | resource is | | | | | | confirmed and | | | | | | a | | | | | | r | | | | | | epresentation | | | | | | of that | | | | | | resource is | | | | | | returned. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | modification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during | | | | | | Individual | | | | | | PFD | | | | | | subscription | | | | | | modification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI of the | | | | | | resource | | | | | | located in an | | | | | | alternative | | | | | | PFDF | | | | | | (service) | | | | | | instance. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | NOTE: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which | | | | | | are specified | | | | | | as mandatory | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | for the PUT | | | | | | method shall | | | | | | also apply. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.3.5.3.2-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
Table 5.3.5.3.2-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI of the resource located in an alternative PFDF (service) instance. 3gpp-
Sbi-Target-Nf-Id string O 0..1 Identifier of the target NF (service) instance
towards which the request is redirected
* * *
#### 5.3.5.4 Resource Custom Operations
None.
## 5.4 Custom Operations without associated resources
None
## 5.5 Notifications
### 5.5.1 General
Notifications shall comply to subclause 6.2 of 3GPP TS 29.500 [5] and
subclause 4.6.2.3 of 3GPP TS 29.501 [6].
Table 5.5.1-1: Notifications overview
* * *
Notification Callback URI HTTP method or custom operation Description (service
operation) PFD Change Notification {notifyUri} POST Notification of PFD
change.
* * *
### 5.5.2 PFD Change Notification
#### 5.5.2.1 Description
The PFD Change Notification is used by the PFDF to inform the NF service
consumer, which has subscribed to this Notification via the PFD subscriptions
resource.
#### 5.5.2.2 Target URI
The Callback URI **\"{notifyUri}\"** shall be used with the callback URI
variables defined in table 5.5.2.2-1.
Table 5.5.2.2-1: Callback URI variables
* * *
Name Data type Definition notifyUri Uri The Notification Uri as assigned
within the PFD subscriptions resource and described within the PfdSubscription
data type (see table 5.6.2.3-1).
* * *
#### 5.5.2.3 Standard Methods
##### 5.5.2.3.1 POST
This method shall support the URI query parameters specified in table
5.5.2.3.1-1.
Table 5.5.2.3.1-1: URI query parameters supported by the POST method on this
resource
* * *
Name Data type P Cardinality Description n/a
* * *
This method shall support the request data structures specified in table
5.5.2.3.1-2 and the response data structures and response codes specified in
table 5.5.2.3.1-3.
Table 5.5.2.3.1-2: Data structures supported by the POST Request Body on this
resource
* * *
Data type P Cardinality Description array(PfdChangeNotification) M 1..N
Provides PFD change information.
* * *
Table 5.5.2.3.1-3: Data structures supported by the POST Response Body on this
resource
+---------------+---+-------------+---------------+---------------+ | Data type | P | Cardinality | Response | Description | | | | | codes | | +---------------+---+-------------+---------------+---------------+ | n/a | | | 204 No | The PFD | | | | | Content | operation in | | | | | | the | | | | | | notification | | | | | | is performed | | | | | | successfully, | | | | | | i.e. all PFD | | | | | | changes are | | | | | | accepted by | | | | | | the SMF. | +---------------+---+-------------+---------------+---------------+ | array(Pfd | M | 1..N | 200 OK | The PFD | | ChangeReport) | | | | operation in | | | | | | the | | | | | | notification | | | | | | is performed | | | | | | and the | | | | | | Pf | | | | | | dChangeReport | | | | | | indicates | | | | | | failure | | | | | | reason for | | | | | | each failed | | | | | | application | | | | | | in the | | | | | | partial | | | | | | success. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 307 Temporary | Temporary | | irectResponse | | | Redirect | redirection, | | | | | | during PFD | | | | | | Change | | | | | | Notification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI | | | | | | representing | | | | | | the end point | | | | | | of an | | | | | | alternative | | | | | | NF consumer | | | | | | (service) | | | | | | instance | | | | | | where the | | | | | | notification | | | | | | should be | | | | | | sent. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | Red | O | 0..1 | 308 Permanent | Permanent | | irectResponse | | | Redirect | redirection, | | | | | | during PFD | | | | | | Change | | | | | | Notification. | | | | | | The response | | | | | | shall include | | | | | | a Location | | | | | | header field | | | | | | containing an | | | | | | alternative | | | | | | URI | | | | | | representing | | | | | | the end point | | | | | | of an | | | | | | alternative | | | | | | NF consumer | | | | | | (service) | | | | | | instance | | | | | | where the | | | | | | notification | | | | | | should be | | | | | | sent. | | | | | | | | | | | | Applicable if | | | | | | the feature | | | | | | \"ES3XX\" is | | | | | | supported. | +---------------+---+-------------+---------------+---------------+ | P | O | 0..1 | 500 Internal | The server | | roblemDetails | | | Server Error | encountered | | | | | | an unexpected | | | | | | condition | | | | | | that | | | | | | prevented it | | | | | | from | | | | | | fulfilling | | | | | | the request. | | | | | | PFDs for all | | | | | | applications | | | | | | are not | | | | | | accepted by | | | | | | the SMF. | | | | | | (NOTE 2) | +---------------+---+-------------+---------------+---------------+ | NOTE 1: In | | | | | | addition, the | | | | | | HTTP status | | | | | | codes which | | | | | | are specified | | | | | | as mandatory | | | | | | in | | | | | | ta | | | | | | ble 5.2.7.1-1 | | | | | | of | | | | | | 3GPP TS | | | | | | 29.500 [5] | | | | | | for the POST | | | | | | method shall | | | | | | also apply. | | | | | | | | | | | | NOTE 2: | | | | | | Failure cases | | | | | | are described | | | | | | in | | | | | | s | | | | | | ubclause 5.7. | | | | | +---------------+---+-------------+---------------+---------------+
Table 5.5.2.3.1-4: Headers supported by the 307 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI representing the end point of an alternative NF consumer (service)
instance towards which the notification should be redirected. 3gpp-Sbi-Target-
Nf-Id string O 0..1 Identifier of the target NF (service) instance towards
which the notification request is redirected
* * *
Table 5.5.2.3.1-5: Headers supported by the 308 Response Code on this resource
* * *
Name Data type P Cardinality Description Location string M 1 An alternative
URI representing the end point of an alternative NF consumer (service)
instance towards which the notification should be redirected. 3gpp-Sbi-Target-
Nf-Id string O 0..1 Identifier of the target NF (service) instance towards
which the notification request is redirected
* * *
## 5.6 Data Model
### 5.6.1 General
This subclause specifies the application data model supported by the API.
Table 5.6.1-1 specifies the data types defined for the Nnef_PFDmanagement
service based interface protocol.
Table 5.6.1-1: Nnef_PFDmanagement specific Data Types
* * *
Data type Section defined Description Applicability PfdDataForApp 5.6.2.2
Represents the PFDs for an application identifier.  
PfdSubscription 5.6.2.3 Represents a PFD subscription.  
PfdChangeNotification 5.6.2.4 Represents PFD change information.  
PfdContent 5.6.2.5 Represents the content of a PFD for an application
identifier.  
PfdChangeReport 5.6.2.6 Represents error of PFD change.
* * *
Table 5.6.1-2 specifies data types re-used by the Nnef_PFDmanagement service
based interface protocol from other specifications, including a reference to
their respective specifications and when needed, a short description of their
use within the Nnef_PFDmanagement service based interface.
Table 5.6.1-2: Nnef_PFDmanagement re-used Data Types
* * *
Data type Reference Comments Applicability ApplicationId 3GPP TS 29.571 [10]  
DomainNameProtocol 3GPP TS 29.122 [11]  
DateTime 3GPP TS 29.571 [10]  
RedirectResponse 3GPP TS 29.571 [10] Contains redirection related information.
ES3XX SupportedFeatures 3GPP TS 29.571 [10]  
Uri 3GPP TS 29.571 [10]
* * *
### 5.6.2 Structured data types
#### 5.6.2.1 Introduction
This subclause defines the structures to be used in resource representations.
Allowed structures are: array, object.
#### 5.6.2.2 Type: PfdDataForApp
Table 5.6.2.2-1: Definition of type PfdDataForApp
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | appl | Appl | M | 1 | I | | | icationId | icationId | | | dentifier | | | | | | | of an | | | | | | | app | | | | | | | lication. | | +-----------+-----------+---+-----------+-----------+-----------+ | pfds | array(Pf | M | 1..N | PFDs for | | | | dContent) | | | the | | | | | | | ap | | | | | | | plication | | | | | | | id | | | | | | | entifier. | | +-----------+-----------+---+-----------+-----------+-----------+ | ca | DateTime | O | 0..1 | Caching | | | chingTime | | | | time for | | | | | | | an | | | | | | | ap | | | | | | | plication | | | | | | | id | | | | | | | entifier. | | +-----------+-----------+---+-----------+-----------+-----------+ | supporte | Supporte | C | 0..1 | Used to | | | dFeatures | dFeatures | | | negotiate | | | | | | | the | | | | | | | appl | | | | | | | icability | | | | | | | of the | | | | | | | optional | | | | | | | features. | | | | | | | | | | | | | | This | | | | | | | attribute | | | | | | | shall be | | | | | | | present | | | | | | | in in the | | | | | | | HTTP GET | | | | | | | response | | | | | | | if the | | | | | | | \"su | | | | | | | pported-f | | | | | | | eatures\" | | | | | | | attribute | | | | | | | query | | | | | | | parameter | | | | | | | is | | | | | | | included | | | | | | | in the | | | | | | | HTTP GET | | | | | | | request. | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.3 Type: PfdSubscription
Table 5.6.2.3-1: Definition of type PfdSubscription
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | appli | ar | O | 1..N | Id | | | cationIds | ray(Appli | | | entifiers | | | | cationId) | | | of | | | | | | | app | | | | | | | lications | | | | | | | with PFDs | | | | | | | change. | | +-----------+-----------+---+-----------+-----------+-----------+ | notifyUri | Uri | M | 1 | I | | | | | | | dentifies | | | | | | | the | | | | | | | recipient | | | | | | | of | | | | | | | noti | | | | | | | fications | | | | | | | sent by | | | | | | | PFDF for | | | | | | | this | | | | | | | subs | | | | | | | cription. | | +-----------+-----------+---+-----------+-----------+-----------+ | supporte | Supporte | M | 1 | List of | | | dFeatures | dFeatures | | | supported | | | | | | | features | | | | | | | used as | | | | | | | described | | | | | | | in | | | | | | | subcl | | | | | | | ause 5.8. | | | | | | | | | | | | | | This | | | | | | | parameter | | | | | | | shall be | | | | | | | provided | | | | | | | by the NF | | | | | | | service | | | | | | | consumer | | | | | | | in the | | | | | | | POST | | | | | | | request | | | | | | | that | | | | | | | request | | | | | | | the | | | | | | | creation | | | | | | | of a | | | | | | | subs | | | | | | | cription, | | | | | | | and shall | | | | | | | be | | | | | | | provided | | | | | | | by the | | | | | | | PFDF in | | | | | | | the | | | | | | | response | | | | | | | of | | | | | | | corr | | | | | | | esponding | | | | | | | request. | | +-----------+-----------+---+-----------+-----------+-----------+
#### 5.6.2.4 Type: PfdChangeNotification
Table 5.6.2.4-1: Definition of type PfdChangeNotification
* * *
Attribute name Data type P Cardinality Description Applicability applicationId
ApplicationId M 1 Identifier of an application.  
removalFlag boolean O 0..1 Indication of removal of PFDs for an existing
application identifier.  
partialFlag boolean O 0..1 Indication of partial update of PFDs for an
existing application identifier if this operation is supported according to
feature negotiation. PartialUpdate pfds array(PfdContent) O 1..N PFD
creation/update for the application identifier as specified in subclause
6.3.3.5 of 3GPP TS 29.251 [12].
* * *
#### 5.6.2.5 Type: PfdContent
Table 5.6.2.5-1: Definition of type PfdContent
* * *
Attribute name Data type P Cardinality Description Applicability pfdId string
C 0..1 Identifies a PDF of an application identifier. If PartialUpdate feature
is supported, this attribute shall be provided by the PFDF.  
flowDescriptions array(string) O 1..N Represents a 3-tuple with protocol,
server ip and server port for UL/DL application traffic. The content of the
string has the same encoding as the IPFilterRule AVP value as defined in IETF
RFC 6733 [18]. (NOTE)  
urls array(string) O 1..N Indicates a URL or a regular expression which is
used to match the significant parts of the URL. (NOTE)  
domainNames array(string) O 1..N Indicates an FQDN or a regular expression as
a domain name matching criteria. (NOTE)  
dnProtocol DomainNameProtocol C 0..1 Indicates the additional protocol and
protocol field for domain names to be matched, it may only be provided when
domainNames attribute is present. DomainNameProtocol NOTE: If a PFD contains
multiple filter types, the PFD is only matched when every filter type
contained in the PFD has a matching value.
* * *
#### 5.6.2.6 Type: PfdChangeReport
Table 5.6.2.6-1: PfdChangeReport
+-----------+-----------+---+-----------+-----------+-----------+ | Attribute | Data type | P | Ca | De | Appl | | name | | | rdinality | scription | icability | +-----------+-----------+---+-----------+-----------+-----------+ | pfdError | Probl | M | 1 | More | | | | emDetails | | | in | | | | | | | formation | | | | | | | on the | | | | | | | error | | | | | | | shall be | | | | | | | provided | | | | | | | in the | | | | | | | \"cause\" | | | | | | | attribute | | | | | | | of the | | | | | | | \"Problem | | | | | | | Details\" | | | | | | | s | | | | | | | tructure. | | | | | | | | | | | | | | The | | | | | | | \"cause\" | | | | | | | attribute | | | | | | | in the | | | | | | | Probl | | | | | | | emDetails | | | | | | | shall be | | | | | | | set to | | | | | | | one of | | | | | | | following | | | | | | | ap | | | | | | | plication | | | | | | | errors | | | | | | | (see | | | | | | | table | | | | | | | 5.2.7.1-1 | | | | | | | of | | | | | | | 3GPP | | | | | | | TS 29.50 | | | | | | | 0 [5]): | | | | | | | | | | | | | | - | | | | | | | SYSTEM | | | | | | | _FAILURE | | | | | | | | | | | | | | - | | | | | | | INSUF | | | | | | | FICIENT_ | | | | | | | RESOURCES | | | | | | | | | | | | | | - | | | | | | | UNSPEC | | | | | | | IFIED_NF | | | | | | | _FAILURE | | +-----------+-----------+---+-----------+-----------+-----------+ | appl | ar | M | 1..N | Indicates | | | icationId | ray(Appli | | | the | | | | cationId) | | | ap | | | | | | | plication | | | | | | | iden | | | | | | | tifier(s) | | | | | | | which | | | | | | | PFD(s) | | | | | | | are | | | | | | | failed to | | | | | | | be added | | | | | | | or | | | | | | | modified. | | +-----------+-----------+---+-----------+-----------+-----------+
### 5.6.3 Simple data types and enumerations
#### 5.6.3.1 Introduction
This subclause defines simple data types and enumerations that can be
referenced from data structures defined in the previous subclauses.
#### 5.6.3.2 Simple data types
The simple data types defined in table 5.6.3.2-1 shall be supported.
Table 5.6.3.2-1: Simple data types
* * *
Type Name Type Definition Description Applicability
* * *
## 5.7 Error handling
### 5.7.1 General
HTTP error handling shall be supported as specified in subclause 5.2.4 of 3GPP
TS 29.500 [5].
For the Nnef_PFDmanagement API, HTTP error responses shall be supported as
specified in subclause 4.8 of 3GPP TS 29.501 [6]. Protocol errors and
application errors specified in table 5.2.7.2-1 of 3GPP TS 29.500 [5] shall be
supported for an HTTP method if the corresponding HTTP status codes are
specified as mandatory for that HTTP method in table 5.2.7.1-1 of 3GPP TS
29.500 [5].
In addition, the requirements in the following subclauses shall apply.
### 5.7.2 Protocol Errors
In this Release of the specification, there are no additional protocol errors
applicable for the Nnef_PFDmanagement API.
### 5.7.3 Application Errors
The application errors defined for the Nnef_PFDmanagement service are listed
in table 5.7.3-1.
Table 5.7.3-1: Application errors
* * *
Application Error HTTP status code Description SYSTEM_FAILURE 500 Internal
Server Error Something functions wrongly in PFD provisioning or the PFD
provisioning does not function at all. (NOTE) INSUFFICIENT_RESOURCE 500
Internal Server Error There is limitation for resource storage. (NOTE)
UNSPECIFIED_NF_FAILURE 500 Internal Server Error Unspecified reason. (NOTE)
NOTE: This application error is included in the responses to the POST request
of PFD change notification.
* * *
## 5.8 Feature negotiation
The optional features in table 5.8-1 are defined for the Nnef_PFDmanagement
API. They shall be negotiated using the extensibility mechanism defined in
subclause 6.6 of 3GPP TS 29.500 [5].
Table 5.8-1: Supported Features
* * *
Feature number Feature Name Description 1 PartialUpdate The PFDF can use this
feature for partial update of PFDs. 2 DomainNameProtocol This feature supports
the additional protocol matching condition for the domain name in PFD data. 3
PfdChgSubsUpdate The SMF can use this feature for updating the PFD change
subscription. 4 ES3XX Extended Support for 3xx redirections. This feature
indicates the support of redirection for any service operation, according to
Stateless NF procedures as specified in subclauses 6.5.3.2 and 6.5.3.3 of 3GPP
TS 29.500 [5] and according to HTTP redirection principles for indirect
communication, as specified in subclause 6.10.9 of 3GPP TS 29.500 [5].
* * *
## 5.9 Security
As indicated in 3GPP TS 33.501 [14] and 3GPP TS 29.500 [5], the access to the
Nnef_PFDmanagement API may be authorized by means of the OAuth2 protocol (see
IETF RFC 6749 [15]), based on local configuration, using the \"Client
Credentials\" authorization grant, where the NRF (see 3GPP TS 29.510 [13])
plays the role of the authorization server.
If OAuth2 is used, an NF Service Consumer, prior to consuming services offered
by the Nnef_PFDmanagement API, shall obtain a \"token\" from the authorization
server, by invoking the Access Token Request service, as described in 3GPP TS
29.510 [13], subclause 5.4.2.2.
NOTE: When multiple NRFs are deployed in a network, the NRF used as
authorization server is the same NRF that the NF Service Consumer used for
discovering the Nnef_PFDmanagement service.
The Nnef_PFDmanagement API defines a single scope \"nnef-pfdmanagement\" for
OAuth2 authorization (as specified in 3GPP TS 33.501 [14]) for the entire
service, and it does not define any additional scopes at resource or operation
level.
###### ## Annex A (normative): OpenAPI specification
# A.1 General
The present Annex contains an OpenAPI [9] specification of HTTP messages and
content bodies used by the Nnef_PFDmanagement API.
This Annex shall take precedence when being discrepant to other parts of the
specification with respect to the encoding of information elements and methods
within the API.
NOTE: The semantics and procedures, as well as conditions, e.g. for the
applicability and allowed combinations of attributes or values, not expressed
in the OpenAPI definitions but defined in other parts of the specification
also apply.
Informative copies of the OpenAPI specification file contained in this 3GPP
Technical Specification are available on a Git-based repository that uses the
GitLab software version control system (see clause 5B of the 3GPP TR 21.900
[17] and subclause 5.3.1 of the 3GPP TS 29.501 [6] for further information).:
# A.2 Nnef_PFDmanagement API
openapi: 3.0.0
info:
title: Nnef_PFDmanagement Service API
version: 1.1.3
description: \|
Packet Flow Description Management Service.
© 2021, 3GPP Organizational Partners (ARIB, ATIS, CCSA, ETSI, TSDSI, TTA,
TTC).
All rights reserved.
#
externalDocs:
description: 3GPP TS 29.551 v16.10.0, 5G System; Packet Flow Description
Management Service
url: \'http://www.3gpp.org/ftp/Specs/archive/29_series/29.551/\'
#
servers:
\- url: \'{apiRoot}/nnef-pfdmanagement/v1\'
variables:
apiRoot:
default: https://example.com
description: apiRoot as defined in subclause 4.4 of 3GPP TS 29.501
security:
\- {}
\- oAuth2ClientCredentials:
\- nnef-pfdmanagement
paths:
/applications:
get:
summary: Retrieve PFDs for all applications or for one or multiple
applications with query parameter.
tags:
\- PFD of applications
operationId: Nnef_PFDmanagement_AllFetch
parameters:
\- name: application-ids
description: The required application identifier(s) for the returned PFDs.
in: query
required: true
schema:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationId\'
minItems: 1
\- name: supported-features
in: query
description: To filter irrelevant responses related to unsupported features
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
responses:
\'200\':
description: The PFDs for one or more application identifier(s) in the request
URI are returned.
content:
application/json:
schema:
type: array
items:
\$ref: \'#/components/schemas/PfdDataForApp\'
minItems: 0
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'414\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/414\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
/applications/{appId}:
get:
summary: Retrieve the PFD for an application.
tags:
\- Individual application PFD
operationId: Nnef_PFDmanagement_IndAppFetch
parameters:
\- name: appId
description: The required application identifier(s) for the returned PFDs.
in: path
required: true
schema:
type: string
\- name: supported-features
in: query
description: To filter irrelevant responses related to unsupported features
schema:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
responses:
\'200\':
description: A representation of PFDs for an application in the request URI is
returned.
content:
application/json:
schema:
\$ref: \'#/components/schemas/PfdDataForApp\'
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'406\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/406\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'414\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/414\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
/subscriptions:
post:
summary: Subscribe the notification of PFD changes.
tags:
\- PFD subscriptions
operationId: Nnef_PFDmanagement_CreateSubscr
requestBody:
description: a PfdSubscription resource to be created.
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PfdSubscription\'
callbacks:
PfdChangeNotification:
\'{request.body#/notifyUri}\':
post:
summary: Notification of PFD change.
tags:
\- PfdChangeNotification data
operationId: Nnef_PFDmanagement_Notify
requestBody:
required: true
content:
application/json:
schema:
type: array
items:
\$ref: \'#/components/schemas/PfdChangeNotification\'
minItems: 1
responses:
\'200\':
description: The PFD operation in the notification is performed and the
PfdChangeReport indicates failure reason.
content:
application/json:
schema:
type: array
items:
\$ref: \'#/components/schemas/PfdChangeReport\'
minItems: 1
\'204\':
description: The PFD operation in the notification is performed successfully.
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
responses:
\'201\':
description: The creation of a PfdSubscription resource is confirmed and a
representation of that resource is returned.
content:
application/json:
schema:
\$ref: \'#/components/schemas/PfdSubscription\'
headers:
Location:
description: \'Contains the URI of the newly created resource, according to
the structure: {apiRoot}/nnef-
pfdmanagement/v1/subscriptions/{subscriptionId}\'
required: true
schema:
type: string
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
/subscriptions/{subscriptionId}:
put:
summary: Updates/replaces an existing subscription resource
tags:
\- Individual PFD subscription
operationId: Nnef_PFDmanagement_ModifySubscr
parameters:
\- name: subscriptionId
description: Identify the subscription.
in: path
required: true
schema:
type: string
requestBody:
description: Parameters to update/replace the existing subscription
required: true
content:
application/json:
schema:
\$ref: \'#/components/schemas/PfdSubscription\'
responses:
\'200\':
description: OK (Successful update of the subscription)
content:
application/json:
schema:
\$ref: \'#/components/schemas/PfdSubscription\'
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'411\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/411\'
\'413\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/413\'
\'415\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/415\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
default:
\$ref: \'TS29571_CommonData.yaml#/components/responses/default\'
delete:
summary: Delete a subscription of PFD change notification.
tags:
\- Individual PFD subscription
operationId: Nnef_PFDmanagement_Unsubscribe
parameters:
\- name: subscriptionId
description: Identify the subscription.
in: path
required: true
schema:
type: string
responses:
\'204\':
description: The PfdSubscription resource matching the subscriptionId was
deleted successfully.
\'307\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/307\'
\'308\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/308\'
\'400\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/400\'
\'401\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/401\'
\'403\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/403\'
\'404\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/404\'
\'429\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/429\'
\'500\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/500\'
\'503\':
\$ref: \'TS29571_CommonData.yaml#/components/responses/503\'
components:
securitySchemes:
oAuth2ClientCredentials:
type: oauth2
flows:
clientCredentials:
tokenUrl: \'{nrfApiRoot}/oauth2/token\'
scopes:
nnef-pfdmanagement: Access to the Nnef_PFDmanagement API
schemas:
#
# STRUCTURED DATA TYPES
#
PfdContent:
type: object
properties:
pfdId:
type: string
description: Identifies a PDF of an application identifier.
flowDescriptions:
type: array
items:
type: string
minItems: 1
description: Represents a 3-tuple with protocol, server ip and server port for
UL/DL application traffic.
urls:
type: array
items:
type: string
minItems: 1
description: Indicates a URL or a regular expression which is used to match
the significant parts of the URL.
domainNames:
type: array
items:
type: string
minItems: 1
description: Indicates an FQDN or a regular expression as a domain name
matching criteria.
dnProtocol:
\$ref: \'TS29122_PfdManagement.yaml#/components/schemas/DomainNameProtocol\'
PfdDataForApp:
type: object
properties:
applicationId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationId\'
pfds:
type: array
items:
\$ref: \'#/components/schemas/PfdContent\'
minItems: 1
cachingTime:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/DateTime\'
supportedFeatures:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
required:
\- applicationId
\- pfds
PfdSubscription:
type: object
properties:
applicationIds:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationId\'
minItems: 1
notifyUri:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/Uri\'
supportedFeatures:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/SupportedFeatures\'
required:
\- notifyUri
\- supportedFeatures
PfdChangeNotification:
type: object
properties:
applicationId:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationId\'
removalFlag:
type: boolean
default: false
partialFlag:
type: boolean
default: false
pfds:
type: array
items:
\$ref: \'#/components/schemas/PfdContent\'
minItems: 1
required:
\- applicationId
PfdChangeReport:
type: object
properties:
pfdError:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ProblemDetails\'
applicationId:
type: array
items:
\$ref: \'TS29571_CommonData.yaml#/components/schemas/ApplicationId\'
minItems: 1
required:
\- pfdError
\- applicationId
#