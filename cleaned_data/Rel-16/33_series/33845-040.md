# Foreword
This clause is mandatory; do not alter the text in any way other than to
choose between \"Specification\" and \"Report\".
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
In drafting the TS/TR, pay particular attention to the use of modal auxiliary
verbs! TRs shall not contain any normative provisions.
In the present document, modal verbs have the following meanings:
**shall** indicates a mandatory requirement to do something
**shall not** indicates an interdiction (prohibition) to do something
The constructions \"shall\" and \"shall not\" are confined to the context of
normative provisions, and do not appear in Technical Reports.
The constructions \"must\" and \"must not\" are not used as substitutes for
\"shall\" and \"shall not\". Their use is avoided insofar as possible, and
they are not used in a normative context except in a direct citation from an
external, referenced, non-3GPP document, or so as to maintain continuity of
style when extending or modifying the provisions of such a referenced
document.
**should** indicates a recommendation to do something
**should not** indicates a recommendation not to do something
**may** indicates permission to do something
**need not** indicates permission not to do something
The construction \"may not\" is ambiguous and is not used in normative
elements. The unambiguous constructions \"might not\" or \"shall not\" are
used instead, depending upon the meaning intended.
**can** indicates that something is possible
**cannot** indicates that something is impossible
The constructions \"can\" and \"cannot\" are not substitutes for \"may\" and
\"need not\".
**will** indicates that something is certain or expected to happen as a result
of action taken by an agency the behaviour of which is outside the scope of
the present document
**will not** indicates that something is certain or expected not to happen as
a result of action taken by an agency the behaviour of which is outside the
scope of the present document
**might** indicates a likelihood that something will happen as a result of
action taken by some agency the behaviour of which is outside the scope of the
present document
**might not** indicates a likelihood that something will not happen as a
result of action taken by some agency the behaviour of which is outside the
scope of the present document
In addition:
**is** (or any other verb in the indicative mood) indicates a statement of
fact
**is not** (or any other negative verb in the indicative mood) indicates a
statement of fact
The constructions \"is\" and \"is not\" do not indicate requirements.
# Introduction
In Release 15, the ability to store various security parameters are
standardised for the ARPF and the UDR. However, the security of this storage
and the security related to transporting security parameters from the UDR to
the UDM/ARPF are not defined.
This document provides the background and lists potential solutions for
identified key issues.
# 1 Scope
The present document details the following:
\- The security assumptions relating to security communication in 5G.
\- The security assumptions related to protecting subscriber privacy.
\- The home network parameters that are relevant to securing the communication
in 5G and protecting subscriber privacy.
\- Key Issues, threats and requirements relevant to securing the communication
in 5G and protecting subscriber privacy.
\- Solutions that potentially resolve the key issues described.
The present document does not describe the storage of security parameters in
the UE or the serving network or the transportation of secure information
between the home network and the serving network.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 33.501: \"Security Architecture and Procedures for 5G System\".
[3] 3GPP TS 35.205: \"Specification of the MILENAGE algorithm set: An example
algorithm set for the 3GPP authentication and key generation functions f1,
f1*, f2, f3, f4, f5 and f5*; Document 1: General\".
[4] 3GPP TS 35.231: \"Specification of the Tuak algorithm set: A second
example algorithm set for the 3GPP authentication and key generation functions
f1, f1*, f2, f3, f4, f5 and f5*; Document 1: Algorithm specification \".
[5] 3GPP TS 23.632: \"User Data Interworking, Coexistence and Migration\".
[6] 3GPP TS 33.401: \"3GPP System Architecture Evolution (SAE); Security
architecture\".
[7] 3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security
aspects of non-3GPP accesses\".
[8] 3GPP TS 33.203: \"3G security; Access security for IP-based services\".
[9] 3GPP TS 33.220: \"3G security; Generic Authentication Architecture (GAA);
Generic Bootstrapping Architecture (GBA)\".
[10] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\"
[11] 3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository
services for Subscription Data\".
[12] 3GPP TS 29.500: \"5G System; Technical Realization of Service Based
Architecture\".
[13] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2
# 3 Definitions of terms, symbols and abbreviations
## 3.1 Terms
Editor\'s Note: \'authentication subscription data\' and \'subscription data\'
need to be defined.
For the purposes of the present document, the terms given in 3GPP TR 21.905
[1] and the following apply. A term defined in the present document takes
precedence over the definition of the same term, if any, in 3GPP TR 21.905
[1].
Definition format (Normal)
**\ :** \.
**example:** text used to clarify abstract rules by applying them literally.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
Abbreviation format (EW)
\ \
# 4 Security assumptions relating to communication security in 5G
## 4.1 Overview
As defined in TS 33.501 [2], the UDM plays a key role in primary
authentication and the privacy feature by supporting the ARPF and SIDF
functionality.
The ARPF and SIDF functionality requires the use of certain security
parameters. The security parameters used for the ARPF functionality
(authentication subscription data) are specified in clause 5.1. When UDM makes
use of the UDR to manage subscription data, part of the security parameters
required by the ARPF and SIDF may be stored in UDR as described in clause 4.2.
## 4.2 Models for ARPF and UDR setup
### 4.2.1 Model #A: Security parameters stored only in the ARPF
The model where security parameters for the execution of primary
authentication are stored only at the ARPF corresponds to a stateful UDM/ARPF
deployment model where UDR is not used.
### 4.2.2 Model #B: Security parameters stored only in the UDR
The model where all security parameters for the execution of primary
authentication are only stored at the UDR.
Editor\'s Note: It is FFS on how to formulate this clause.
### 4.2.3 Model #C: Security parameters stored both in the ARPF and the UDR
This is a stateless UDM/ARPF deployment model.
The model where the security parameters for the execution of primary
authentication common across subscribers within PLMN are stored in the ARPF
and the security requirements specific to individual subscribers are stored in
the UDR corresponds to a stateless UDM/ARPF deployment model.
TS 29.505 [11] specifies the usage of the Unified Data Repository, Nudr,
services for subscription data. This specification provides the resource
definition and data model for subscription data used over the Nudr Service
Based Interface.
Editor\'s Note: The text below needs to be put into a suitable section
When it comes to the definition of resources related to subscription
authentication material, TS 29.505 [11] defines the
_AuthenticationSubscription_ data type supporting primary authentication as
follows:
Table 4.2.3-1: TS 29.505 [11], Table 5.4.2.2-1: Definition of type
AuthenticationSubscription
+---------------+---------------+-----+---------------+---------------+ | _Attribute |_ Data type _|_ P _|_ Cardinality _|_ Description _| | name_ | | | | | +===============+===============+=====+===============+===============+ | _authenti |_ AuthMethod _|_ M _|_ 1 _|_ String | | cationMethod _| | | | containing | | | | | | the | | | | | | A | | | | | | uthentication | | | | | | Method (\ | | | | | | \"5G_AKA\" , | | | | | | \"EAP | | | | | | _AKA_PRIME, | | | | | | \"EAP_T | | | | | | LS\"...).\"_ | +---------------+---------------+-----+---------------+---------------+ | _enc |_ string _|_ C _|_ 0..1 _|_ The | | PermanentKey _| | | | encrypted | | | | | | value | | | | | | (hexstring) | | | | | | of the | | | | | | permanent | | | | | | a | | | | | | uthentication | | | | | | key (K) (see | | | | | | 3GPP TS 33 | | | | | | .501 [9])._ | | | | | | | | | | | | _It shall be | | | | | | present if | | | | | | the | | | | | | a | | | | | | uthentication | | | | | | method is | | | | | | \"5G_AKA\" | | | | | | or | | | | | | \"EAP_A | | | | | | KA_PRIME\"._ | +---------------+---------------+-----+---------------+---------------+ | _protectio |_ string _|_ C _|_ 0..1 _|_ Identifies a | | nParameterId _| | | | parameter set | | | | | | securely | | | | | | stored in the | | | | | | UDM(ARPF) | | | | | | that can be | | | | | | used to | | | | | | decrypt the | | | | | | en | | | | | | cPermanentKey | | | | | | (and | | | | | | encOpcKey or | | | | | | encTopcKey if | | | | | | present). | | | | | | Values and | | | | | | their meaning | | | | | | are | | | | | | H | | | | | | PLMN-operator | | | | | | specific._ | | | | | | | | | | | | _It shall be | | | | | | present if | | | | | | the | | | | | | a | | | | | | uthentication | | | | | | method is | | | | | | \"5G_AKA\" | | | | | | or | | | | | | \"EAP_A | | | | | | KA_PRIME\"._ | +---------------+---------------+-----+---------------+---------------+ | _se |_ Se | _C_ | _0..1_ | _String | | quenceNumber_ | quenceNumber _| | | containing | | | | | | the SQN as | | | | | | defined in | | | | | | 3GPP TS 33 | | | | | | .102 [10]._ | | | | | | | | | | | | _It shall be | | | | | | present if | | | | | | the | | | | | | a | | | | | | uthentication | | | | | | method is | | | | | | \"5G_AKA\" | | | | | | or | | | | | | \"EAP_A | | | | | | KA_PRIME\"._ | +---------------+---------------+-----+---------------+---------------+ | _auth |_ string _|_ C _|_ 0..1 _|_ Hexstring | | enticationMan | | | | containing | | agementField _| | | | the | | | | | | A | | | | | | uthentication | | | | | | management | | | | | | field as | | | | | | defined in | | | | | | 3GPP TS 3 | | | | | | 3.501 [9]._ | | | | | | | | | | | | _It shall be | | | | | | present if | | | | | | the | | | | | | a | | | | | | uthentication | | | | | | method is | | | | | | \"5G_AKA\" | | | | | | or | | | | | | \"EAP_A | | | | | | KA_PRIME\"._ | | | | | | | | | | | | _Pattern: | | | | | | \'\^[A-Fa-f | | | | | | 0-9]{4}\$\'_ | +---------------+---------------+-----+---------------+---------------+ | _algorithmId_ | _string_ | _C_ | _0..1_ | _Identifies a | | | | | | parameter set | | | | | | securely | | | | | | stored in the | | | | | | UDM(ARPF) | | | | | | that provides | | | | | | details on | | | | | | the algorithm | | | | | | and | | | | | | parameters | | | | | | used to | | | | | | generate | | | | | | a | | | | | | uthentication | | | | | | vectors. | | | | | | Values and | | | | | | their meaning | | | | | | are | | | | | | H | | | | | | PLMN-operator | | | | | | specific._ | | | | | | | | | | | | _It shall be | | | | | | present if | | | | | | the | | | | | | a | | | | | | uthentication | | | | | | method is | | | | | | \"5G_AKA\" | | | | | | or | | | | | | \"EAP_A | | | | | | KA_PRIME\"._ | +---------------+---------------+-----+---------------+---------------+ | _encOpcKey_ | _string_ | _O_ | _0..1_ | _Hexstring of | | | | | | the encrypted | | | | | | OPC Key._ | | | | | | | | | | | | _Presence | | | | | | indicates | | | | | | that the | | | | | | provided | | | | | | value | | | | | | (decrypted) | | | | | | shall be used | | | | | | instead of | | | | | | the value | | | | | | derived from | | | | | | OP and K._ | +---------------+---------------+-----+---------------+---------------+ | _encTopcKey_ | _string_ | _O_ | _0..1_ | _Hexstring of | | | | | | the encrypted | | | | | | TOPC Key._ | | | | | | | | | | | | _Presence | | | | | | indicates | | | | | | that the | | | | | | provided | | | | | | value | | | | | | (decrypted) | | | | | | shall be used | | | | | | instead of | | | | | | the value | | | | | | derived from | | | | | | TOP and K._ | +---------------+---------------+-----+---------------+---------------+
As shown, the _AuthenticationSubscription_ data type includes only the
security parameters defined at individual subscriber's basis required for the
execution of AKA such as:
\- Long term Key(s), including _encPermanentKey_ and optionally
_encOpcKey/encTopcKey_.
\- Sequence Number, SQN (_sequenceNumber_).
\- Authentication Management Field, AMF (_authenticationManagementField_).
\- The identifier of the authentication algorithm (_algorithmId_).
The _algorithmId_ attribute does not contain all the related information but
it rather contains a string which refers to a parameter set securely stored in
the UDM/ARPF. The _algorithmId_ attribute identifies the authentication
algorithm as well as other related parameters associated to the authentication
algorithm which do not need to be specific for individual subscriber's (e.g.
settings for the constants _c_ and/or _r_ for MILENAGE) are referred to in the
_AuthenticationSubscription_ data resource by the _algorithmId_ attribute.
The definition of the _AuthenticationSubscription_ data type allows for the
use of proprietary authentication algorithms and SQN schemes by the choice of
ENUMERATED and/or string values for relevant information elements within the
_AuthenticationSubscription_ data type and making use if required of the API
extensibility mechanisms defined in TS 29.500 [12] for any JSON object of any
API.
Finally, based on implementation-specific means, it is possible that the
storage of the _AuthenticationSubscription_ resources within a UDR NF instance
is managed in specific storage resources within the UDR NF instance. This can
allow that the security parameters defined within the
_AuthenticationSubscription_ data type could be isolated from the rest of
storage resources used for storing other subscription profile information
within the UDR NF instance as described in TS 29.500 [12] and TS 29.505 [11].
## 4.3 Primary Authentication
3GPP TS 33.501 [2] defines primary authentication to enable mutual
authentication between the UE and the network. It uses the pre-shared long-
term Key which is bind to a unique SUPI to authenticate each other. The long-
term Key is stored in the USIM and the ARPF of home network separately. The
ARPF shall process the K only in its secure environment, the ARPF is a service
offered by UDM.
Two methods including EAP-AKA\' and 5G-AKA are defined for primary
authentication, which method is used for mutual authentication is determined
by the ARPF/UDM. The authentication methods are stored in the ARPF. The other
security parameters (e.g. SQN, AMF) in addition to the K required for the
primary authentication are also held by the ARPF.
During the registration procedure, the AMF determines to trigger the primary
authentication on--demand for the UE. If the primary authentication is
required, the AMF requests it from the AUSF. Upon request from the AMF, the
AUSF shall execute authentication of the UE. In the primary authentication
procedure, the ARPF is required for key storage, authentication methods
storage, and key derivation.
## 4.4 Secondary Authentication
3GPP TS 33.501 [2] defines secondary authentication for a DN to authenticate
and/or authorize a UE to access the DN. The EAP framework based authentication
is introduced for secondary authentication between the UE and the DN-AAA
server in the DN.
During the PDU session establishment procedure, the SMF (in non-roaming and
Home Routed roaming cases, the H-SMF; in LBO case, the V-SMF) determines
whether the secondary authentication is required via exchanging with UDM. If
secondary authentication is required, the SMF shall trigger EAP authentication
procedure. The UE and the DN AAA server exchange EAP message for secondary
authentication. On the network side, the credential of the UE for secondary
authentication is stored in DN-AAA.
## In the secondary authentication procedure, the ARPF is not involved.4.5
Privacy
3GPP TS 33.501 [2] defines a mechanism for subscription identifier privacy
over-the-air. It uses the SUCI which is a privacy preserving identifier
generated at the UE and containing the concealed SUPI, using a Home Network
Public Key securely provisioned in the USIM and in control of the home
network.
The Home Network Private Key used for subscriber privacy is protected from
physical attacks in the UDM: TS 33.501 section 6.2.2.1, specifies that \"_the
ARPF holds the home network private key that is used by the SIDF to deconceal
the SUCI and reconstruct the SUPI_ \".
In the network side, the SIDF (Subscription Identifier De-concealing Function)
is responsible for de-concealment of the SUCI using a Home Network Private
Key. The SIDF is a service offered by UDM and holds the Home Network Public
Key Identifier(s) for the private/public key pair(s) used for subscriber
privacy.
# 5 Parameters relevant to securing 5G communication
## 5.1 Overview
Authentication subscription data is data that:
\- is needed for the generation of authentication vectors in the UDM/ARPF (as
described in 3GPP TS 33.501 [2]); and
\- is stored in the 5G core network.
NOTE 1: Other data related to authentication, but that does not need to be
stored in the 5G core network is not authentication subscription data.
For AKA-based authentication, the authentication subscription data consists
of:
\- the long term key K;
\- the sequence number SQN;
\- (optionally) the authentication management field AMF;
NOTE 2: it is an operator policy whether the authentication management field
AMF is stored or generated; therefore it is optionally included in the set of
authentication subscription data.
\- additional parameters depending on the authentication algorithm used (e.g.
OP or OPc if MILENAGE (cf. 3GPP TS 35.205 [3]) is used, TOP or TOPc if TUAK
(cf. 3GPP TS 35.231 [4]) is used, other parameters for proprietary
algorithms);
\- the authentication method used;
\- the authentication algorithm used (e.g. MILENAGE, TUAK, proprietary
algorithm).
Authentication subscription data may be specific per SUPI (e.g. long term key
K, sequence number SQN, MILENAGE parameter OPc, TUAK parameter TOPc), or it
may be generic (e.g. MILENAGE parameter OP, TUAK parameter TOP).
Editor's note: it is FFS which part of the authentication subscription data
needs to be secured during storage and transfer (if transferred).
Editor's note: it is FFS whether or not to distinguish multiple levels of
security (extremely high, high, medium) for the securing of stored and/or
transferred data.
## 5.2 Milenage AKA authentication
To enable Milenage authentication algorithm, the following parameters are
needed:
> \- OP (the operator variant algorithm configuration field);
>
> \- OPc (value derived from OP and K);
>
> \- c1,c2,c3,c4,c5 (value XORed onto intermediate variables);
>
> \- r1,r2,r3,r4,r5 (value used to define amounts by which intermediate
> variables are cyclically rotated);
## 5.3 TUAK AKA authentication
To enable TUKA authentication algorithm, the following parameters are needed:
> \- TOP (the operator variant algorithm configuration field);
>
> \- TOPc (value derived from TOP and K);
>
> \- ALGONAME (value specified as the ASCII representation of the string
> \"TUAK1.0\");
>
> -
>
> \- the length of K (K is a 128-bit or 256-bit subscriber key that is an
> input to the functions _f1_ , _f1*_ , _f2_ , _f3_ , _f4_ , _f5_ and _f5*_);
>
> \- the length of MAC-A (MAC-A is a 64-bit, 128-bit or 256-bit network
> authentication code that is the output of the function _f1_);
>
> \- the length of MAC-S (MAC-S is a 64-bit, 128-bit or 256-bit
> resynchronization authentication code that is the output of the function
> _f1*_);
>
> \- the length of RES (RES is a 32-bit, 64-bit, 128-bit or 256-bit signed
> response that is the output of the function _f2_);
>
> \- the length of CK (CK is a 128-bit or 256-bit confidentiality key that is
> the output of the function _f3_);
>
> \- the length of IK (IK is a 128-bit or 256-bit integrity key that is the
> output of the function _f4_);
## 5.4 EAP methods for authentication
Editor\'s Note: Content to be added to this section
## 5.5 Proprietary authentication algorithms
Editor\'s Note: Content to be added to this section
## 5.6 AMF related parameters
To enable AKA-based authentication, the following AMF related parameters are
needed: SUCI or SUPI;
The serving network name;
## 5.7 Counter related parameters
To enable AKA-based authentication, the following counter related parameters
are needed:
> \- sqnScheme (scheme for generation of Sequence Numbers);
>
> \- sqn (value containing the SEQ part of SQN, and the IND part which is
> filled with 0\'s. When the sqnScheme is \"TIME_BASED\", the SEQ part is the
> DIF value.);
>
> \- lastIndexes (a map of integer values map(integer), where the integer is
> the last used value of IND);
\- indLength (number of bits of the IND part of SQN);
# 6\. Key Issues
6.1 Key Issue #1: Separation of authentication subscription data from
subscription data
6.1.1 Key issue details
The Unified Data Repository (UDR) is located in the same PLMN as the NF
service consumers are storing or retrieving data from UDR using Nudr services.
Data stored in the UDR are subscription data, authentication subscription
data, policy data, structured data for exposure, and application data (see
3GPP TS 29.505).
Nudr is an intra-PLMN interface and allows NF consumers to use its service to
retrieve, create, update, subscribe for change notifications, unsubscribe for
change notifications and delete data stored in the UDR, based on the set of
data applicable to the consumer.
6.1.2 Security threats
UDR can be accessed by several NFs. If authentication subscription data is
accessible in the same branche of the data model as subscription data, also
other NFs than UDM may be able to access those data.
6.1.3 Potential security requirements
Sensitive data such as authentication subscription data should be
compartmentalized from subscription data.
For authentication subscription data, which are sensitive data, the access
shall be limited to UDM only.
## 6.2 Key Issue #2: protection of long-term key during storage in UDR
### 6.2.1 Key issue details
In case the long-term key, which is part of the authentication subscription
data needed to generate authentication vectors in the UDM/ARPF, is stored in
the UDR separate from the UDM/ARPF, then this key needs to be protected. This
key issue addresses this need.
### 6.2.2 Security threats
If the stored long-term key can be modified in the UDR, this can cause a DOS
attack by invalidating regular authentication subscription data.
If the stored long-term key is obtained, then it can be used to access
previously recorded communications.
If the stored long-term key retrieved from a subscriber\'s authentication
subscription data can be copied to another subscriber\'s authentication
subscription data, then this can result in stealing network access from the
first subscriber.
### 6.2.3 Potential security requirements
The long-term key in the UDR shall be protected against retrieval by
unauthorized network elements and by unauthorized persons.
The long-term key shall be protected against unauthorized modification after
storage in the UDR.
It shall be prevented that the long-term key is copied from one subscriber\'s
authentication subscription data to another subscriber\'s authentication
subscription data.
## 6.3 Key Issue #3: protection of long-term key during transfer out of UDR
### 6.3.1 Key issue details
In case the long-term key, which is part of the authentication subscription
data needed to generate authentication vectors in the UDM/ARPF, is transferred
out of the UDR to the UDM/ARPF, then this key needs to be protected during its
transfer. This key issue addresses this need.
### 6.3.2 Security threats
If the long-term key can be modified during transfer out of the UDR to the
UDM/ARPF, this can cause a DOS attack by generating invalid authentication
vectors in the UDM/ARPF.
If the long-term key is obtained during transfer out of the UDR, then it can
be used to access previously recorded communications.
### 6.3.3 Potential security requirements
The long-term key shall be protected during transfer out of the UDR against
eavesdropping by unauthorized network elements and by unauthorized persons.
The long-term key shall be protected against modification during transfer out
of the UDR.
## 6.4 Key Issue #4: protection of Milenage OPc value during storage in UDR
### 6.4.1 Key issue details
In case the Milenage OPc value, which is part of the authentication
subscription data needed to generate authentication vectors in the UDM/ARPF --
in case Milenage [3] is used -- is stored in the UDR separate from the
UDM/ARPF, then this value needs to be protected. This key issue addresses this
need.
### 6.4.2 Security threats
OPc values are one of the sensitive data items needed to populate USIMs. If
OPc values are obtained by unauthorized network elements or by unauthorized
persons, this increases the risk of unauthorized USIM creation.
If the stored OPc value can be modified in the UDR, this can cause a DOS
attack by invalidating regular authentication subscription data.
### 6.4.3 Potential security requirements
The OPc value shall be protected against retrieval by unauthorized network
elements and by unauthorized persons.
The OPc value shall be protected against unauthorized modification during
storage in the UDR.
## 6.5 Key Issue #5: protection of Milenage OPc value during transfer out of
UDR
### 6.5.1 Key issue details
In case the Milenage OPc value, which is part of the authentication
subscription data needed to generate authentication vectors in the UDM/ARPF --
in case Milenage [3] is used -- is transferred out of the UDR to the UDM/ARPF,
then this value needs to be protected. This key issue addresses this need.
### 6.5.2 Security threats
OPc values are one of the sensitive data items needed to populate USIMs. If
OPc values are obtained by unauthorized network elements or by unauthorized
persons, this increases the risk of unauthorized USIM creation.
If the stored OPc value can be modified during transfer out of the UDR, this
can cause a DOS attack by invalidating regular authentication subscription
data.
### 6.5.3 Potential security requirements
The OPc value shall be protected during transfer out of the UDR against
eavesdropping by unauthorized network elements and by unauthorized persons.
The OPc value shall be protected against modification during transfer out of
the UDR.
## 6.6 Key Issue #6: protection of Milenage OP value during storage in UDR
### 6.6.1 Key issue details
In case the Milenage OP value, which can be used to generate the OPc value
that is part of the authentication subscription data needed to generate
authentication vectors in the UDM/ARPF -- in case Milenage [3] is used -- is
stored in the UDR separate from the UDM/ARPF, then this value needs to be
protected. This key issue addresses this need.
### 6.6.2 Security threats
If the OP value can be obtained by an unauthorized network element or an
unauthorized person, it can be used -- in combination with long-term keys --
to create subscriber specific Milenage OPc values. These OPc values are one of
the data items needed to populate USIMs.
If the stored OP value can be modified in the UDR, this can cause a DOS attack
by invalidating regular authentication subscription data.
### 6.6.3 Potential security requirements
If the OP value is stored in the UDR, then the OP value shall be protected
against retrieval by unauthorized network elements and by unauthorized
persons.
If the OP value is stored in the UDR, then the OP value shall be protected
against unauthorized modification after storage in the UDR.
## 6.7 Key Issue #7: protection of Milenage OP value during transfer out of
UDR
### 6.7.1 Key issue details
In case the Milenage OP value, which can be used to generate the OPc value
that is part of the authentication subscription data needed to generate
authentication vectors in the UDM/ARPF -- in case Milenage [3] is used -- is
transferred out of the UDR to the UDM/ARPF, then this value needs to be
protected. This key issue addresses this need.
### 6.7.2 Security threats
If the OP value can be obtained by an unauthorized network element or an
unauthorized person, it can be used -- in combination with long-term keys --
to create subscriber specific Milenage OPc values. These OPc values are one of
the data items needed to populate USIMs.
If the stored OP value can be modified in the UDR, this can cause a DOS attack
by invalidating regular authentication subscription data.
### 6.7.3 Potential security requirements
If the OP value is stored in the UDR, then the OP value shall be protected
during transfer out of the UDR against eavesdropping by unauthorized network
elements and by unauthorized persons.
If the OP value is stored in the UDR, then the OP value shall be protected
against modification during transfer out of the UDR.
## 6.8 Key Issue #8: protection of sequence number SQN~HE~ during storage in
UDR
### 6.8.1 Key issue details
In case the sequence number SQN~HE~, which is part of the authentication
subscription data needed to generate authentication vectors in the UDM/ARPF is
stored in the UDR separate from the UDM/ARPF, then this sequence number needs
to be protected. This key issue addresses this need.
### 6.8.2 Security threats
If the SQN~HE~ can be obtained by an unauthorized network element or an
unauthorized person, it can be used to identify and track a subscriber.
### 6.8.3 Potential security requirements
The SQN~HE~ shall be protected against retrieval by unauthorized network
elements and by unauthorized persons.
## 6.9 Key Issue #9: protection of sequence number SQN~HE~ during transfer out
of UDR
### 6.9.1 Key issue details
In case the sequence number SQN~HE~, which is part of the authentication
subscription data needed to generate authentication vectors in the UDM/ARPF is
transferred out the UDR to the UDM/ARPF, then this sequence number needs to be
protected. This key issue addresses this need.
### 6.9.2 Security threats
If the SQN~HE~ can be obtained by an unauthorized network element or an
unauthorized person, it can be used to identify and track a subscriber.
### 6.9.3 Potential security requirements
The SQN~HE~ shall be protected during transfer out of the UDR against
eavesdropping by unauthorized network elements and by unauthorized persons.
## 6.x Key Issue #\: \
### 6.x.1 Key issue details
### 6.x.2 Security threats
### 6.x.3 Potential security requirements
# 7 Solutions
## 7.1 Solution 1: Authorization and Isolation of Authentication Data using
existing techniques.
### 7.1.1 Introduction
This solution addresses key issue 1 on \"Separation of authentication
subscription data from subscription data\".
The solution proposes the use of a UDR dedicated for subscription data and
further isolation of the authentication data within this UDR based on internal
implementation techniques.
This solution is based on capabilities defined or planned to already to be
defined in 3GPP TSs and does not require any additional specification work.
### 7.1.2 Solution details
As defined in 3GPP TS 23.501 [10] the UDR is located in the same PLMN as the
NF service consumers storing in and retrieving data from it using Nudr. This
is, Nudr is an intra-PLMN interface.
The only NF service consumers that are defined to use UDR as per 3GPP TS
23.502 [13] are UDM (for subscription data), PCF (for policy subscription
data), NEF (for exposure and application data) and NRF/SCP (for NF Group ID
mapping data). It is possible however that multiple UDRs are deployed in the
network, each of which can accommodate different data sets or subsets, (e.g.
subscription data, subscription policy data, data for exposure, application
data) and/or serve different sets of NFs. This is, it is possible to deploy a
UDR dedicated to store subscription data used and accessed only by UDM. In
this case, the UDR profile stored in the NRF can indicate that ONLY UDM NFs
are authorized to discover UDR instances storing subscription data (i.e. NF
consumers other than UDM will not be able to discover UDR instances handling
subscription data nor authentication subscription data).
Even in the case where the same UDR is deployed to support storage of data for
multiple NF consumers (e.g. UDM, PCF and NEF), UDR can authorize the access of
specific data resources for specific operations (e.g. read, modify) on a per
NF type basis using the OAuth 2.0 based Authorization Framework defined in
3GPP 33.501 [2] for Release 16.
The OAuth 2.0 based authorization framework defined in 3GPP 33.501 [2] is
being enhanced in Release 16 to support the generation and validation of
authorization tokens including authorization not only at service level but
also to service operation and resource level. This allows the possibility to
generate OAuth 2.0 tokens to retrieve _AuthenticationSubscription_ data ONLY
to UDM NF type of service consumers.
Finally, based on implementation-specific means, it is possible that the
storage of the _AuthenticationSubscription_ data resources within a UDR NF
instance are managed in specific storage resources within the UDR NF instance
as described in 3GPP TS 29.500 [12] and 3GPP TS 29.505 [11]. This can allow
that the security parameters defined within the _AuthenticationSubscription_
data type could be isolated from the rest of storage resources used for
storing other subscription profile information within the UDR NF instance not
only from a traffic reference point (i.e. via Nudr) but also from Provisioning
and OAM interfaces.
### 7.1.3 Evaluation
## 7.2 Solution 2: Protection of LTK access over Nudr.
### 7.2.1 Introduction
This solution addresses key issue 2 on \"protection of long-term key during
storage in UDR \".
The solution describes how the long-term key in the UDR can be protected
against modification by any network function and retrieval by unauthorized
network elements over Nudr using the OAuth 2.0 based authorization framework
defined in 3GPP TS 33.501 [2] in Release 16.
This solution is based on capabilities defined or planned to already to be
defined in 3GPP TSs and does not require any additional specification work.
### 7.2.2 Solution details
The OAuth 2.0 based authorization framework defined in 3GPP 33.501 [2] is
being enhanced in Release 16 to support the generation and validation of
authorization tokens including authorization not only at service level but
also to service operation and resource level. This allows the possibility to
generate OAuth 2.0 tokens to retrieve _AuthenticationSubscription_ data ONLY
to UDM/ARPF NF type of service consumers.
UDR will in any case prevent the modification of LTK within the
_AuthenticationSubscription_ data resource by the UDM/ARPF over Nudr as
defined in 3GPP TS 29.505 [11]:
> _Table 5.2.1-1 provides an overview of the resources and applicable HTTP
> methods._
>
> _Table 5.2.1-1: Resources and methods overview_
+----------------+----------------+---------------+----------------+ | _Resource |_ Resource URI _|_ HTTP method _|_ Description _| | name_ | | | | +================+================+===============+================+ | _Authenticatio |_ /sub | _GET_ | _Retrieve a | | nSubscription_ | scription-data | | UE\'s | | | /{ueId}/authen | | authentication | | | tication-data/ | | subscription | | | authentication | | data _| | | -subscription_ | | | +----------------+----------------+---------------+----------------+ | | | _PATCH_ | _Update a | | | | | UE\'s | | | | | authentication | | | | | subscription | | | | | data_ | | | | | | | | | | _Updates shall | | | | | be limited to | | | | | the | | | | |__se | | | | | quenceNumber_ _| | | | | attribute. | | | | | Attempts to | | | | | patch any | | | | | other | | | | | attribute | | | | | shall be | | | | | rejected by | | | | | the UDR._ | +----------------+----------------+---------------+----------------+
The long-term key should be additionally provisioned and stored encrypted in
UDR. This solution does not cover security requirements (e.g. encryption
algorithms) for this.
Editor's note: evaluation of this solution shall also consider the
completeness of this solution against all threats to accessing the long term
key.
### 7.2.3 Evaluation
## 7.3 Solution 3: Protection of LTK over Nudr
### 7.3.1 Introduction
This solution addresses key issue 3 on \"protection of long-term key during
transfer out of UDR\".
The solution is based on storing the long-term key encrypted in UDR and
transferring it also encrypted over Nudr. As any other SBA reference point,
Nudr is additionally protected using TLS as defined in 3GPP TS 33.501 [2].
This solution is based on capabilities defined or planned to already to be
defined in 3GPP TSs and does not require any additional specification work.
### 7.3.2 Solution details
The OAuth 2.0 based authorization framework defined in 3GPP 33.501 [2] is
being enhanced in Release 16 to allows the possibility to generate OAuth 2.0
tokens to retrieve _AuthenticationSubscription_ data ONLY to UDM/ARPF NF type
of service consumers.
This solution proposes that the protection of the long-term key while provided
to the UDM/ARPF over Nudr is two-fold:
  * In the first place, the long-term key is provisioned and stored in UDR in encrypted form. This solution does not cover actual mechanisms to perform such encryption (e.g. encryption algorithms, key length, etc ...).
  * Secondly, as any other SBA reference point, the Nudr is protected using TLS as defined in 3GPP TS 33.501 [2].
These two protection levels make impossible for any intermediate actor to
eavesdrop or modify the long-term key while in transit over Nudr.
### 7.3.3 Evaluation
## 7.4 Solution #4: Encrypted storage of the long-term key in the UDR
### 7.4.1 Introduction
This solution addresses key issue #2 on \"protection of long-term key during
storage in UDR\".
In order to protect the long-term key during storage in the UDR, the long-term
key is provisioned and stored in encrypted form in the UDR. During primary
authentication, the UDM/ARPF retrieves the authentication subscription data
for the UE which includes the encrypted long-term key as provisioned and
stored in UDR. That is, the long-term key is never provided by the UDR in
clear text and there is no need for the UDR to decrypt the long-term key.
At generation of a long-term key an encryption key is used that is shared with
the UDM/ARPF where it is decrypted during primary authentication. The
generation of a long-term key can be performed in the network of an operator
or it can be performed at the facility where USIMs are being provisioned.
### 7.4.2 Solution details
The long-term key is provisioned and stored in encrypted form if stored in the
UDR. The encryption algorithm used and the method for the handling of the
encryption/decryption key(s) needs to conform to the security policy
requirements of the operator. This solution recommends the use of NIST
approved algorithms.
Editor's note: the encryption algorithm used and the method for the handling
of the encryption/decryption key(s) is FFS.
Editor\'s note: whether or not provisioning to ARPF or UDR is in 3GPP scope is
FFS.
### 7.4.3 Evaluation
Editor\'s note: to be provided.
## 7.5 Solution #5: Encrypted transfer of the long-term key between UDR and
UDM/ARPF
### 7.5.1 Introduction
This solution addresses key issue #3 on \"protection of long-term key during
transfer out of UDR\".
As described in 3GPP TS 33.501 [2], clause 5.8.1, the long-term key used for
authentication and security association setup purposes shall be protected from
physical attacks and shall never leave the secure environment of the UDM/ARPF
unprotected. If stored in the UDR, the long-term key is always transported in
encrypted form during its transfer from UDR to UDM/ARPF.
### 7.5.2 Solution details
The long-term key is transferred in encrypted form between UDR and UDM/ARPF.
The encryption algorithm used and the method for the handling of the
encryption/decryption key(s) needs to conform to the security policy
requirements of the operator. This solution recommends the use of NIST
approved algorithms.
Editor's note: the encryption algorithm used and the method for the handling
of the encryption/decryption key(s) is FFS.
The transfer of the encrypted long-term key over the Nudr interface is
protected at transport level using the security mechanisms defined in 3GPP TS
33.501 [2], clause 13.1, as any other SBA interface.
During transfer, a key identifier is associated to the encrypted long-term key
to enable identification of the decryption key in the UDM/ARPF.
NOTE: The implementation of how to identify the decryption key is out of scope
of 3GPP.
### 7.5.3 Evaluation
Editor\'s note: to be provided.
## 7.x Solution #\: \
### 7.x.1 Introduction
### 7.x.2 Solution details
### 7.x.3 Evaluation
# 8 Conclusions
Editor\'s Note: Content to be added to this section
# Annex A
## Models for ARPF deployment
### A.1 General
This clause describes the different deployment models for ARPF considering the
following aspects:
\- Existing architectural decision in TS 33.501 [2] that defines the ARPF as a
function provided by the UDM.
\- Deployment of the UDM as a fully stateless NF, where subscription data
(including the subscription credentials) is stored in the UDR. Stateful
deployment options where subscription credentials are stored within the
UDM/ARPF are depicted but these do not require any further analysis within the
scope of this TR.
\- Coexistence with Authentication vector generation functions in other
domains (i.e. HSS/AuC).
### A.2 ARPF deployment options in 3GPP TS 33.501 and TS 23.501
In TS 33.501 [2], the ARPF is defined as a function to be provided within the
UDM.
For interworking with EPC (and IMS), in TS 23.501 [10], the HSS and the UDM
are also defined as a combined NF, i.e. HSS+UDM where interactions between the
HSS and the UDM are not specified. The HSS also includes the function to
generate authentication vectors in EPS, IMS, GBA and 2G/3G domains; i.e. the
AuC.
The HSS+UDM may be deployed as a stateful or stateless NF.
Figure A.2-1 shows the ARPF deployment option when the HSS+UDM is deployed as
a stateful NF and subscription credentials are stored within the HSS+UDM (i.e.
within the AuC+ARPF).
Figure A.2-1: Stateful ARPF deployment
Figure A.2-2 shows the ARPF deployment option when the HSS+UDM is deployed as
a stateless NF and subscription credentials are stored in the UDR (i.e. EPS +
5GS UDR).
Figure A.2-2: Stateless ARPF deployment
### A.3 ARPF deployment options in UDICOM
TS 23.632 [5], defines the Stage 2 architecture, procedures, flows and Network
Function Services for User Data Interworking, Coexistence and Migration
(UDICOM) between the 5G System and EPS (and IMS).
In the context of UDICOM, HSS and UDM are defined as separate NFs interacting
with each other using SBA based interactions over a new NU1 reference point.
However, since the subscription credentials shall only be stored centralized
in one single place within the system, the UDICOM TS 23.632 [5] defines
various options for the generation of authentication vectors.
Figure A.3-1 shows the ARPF deployment option in the context of UDICOM when
the HSS and the UDM are deployed as stateful NFs and subscription credentials
are stored within the UDM/ARPF.
Figure A.3-1: Stateful ARPF+AuC deployment in UDM according to UDICOM (TS
23.632 [5])
Figure A.3-2 shows the ARPF deployment option in the context of UDICOM when
the HSS and the UDM are deployed as stateless NFs and subscription credentials
are stored within the 5GS-UDR.
Figure A.3-2: Stateless ARPF+AuC deployment in UDM according to UDICOM (TS
23.632 [5])
In these cases (stateful and stateless ARPF+AuC deployment in UDM), the HSS
requests authentication vectors for EPS/IMS/GBA-AKA to the UDM via the new
UDICOM NU1 reference point using Nudm services. The UDM does not only support
the ARPF functionality but also acts as AuC to generate authentication vectors
as defined in 3GPP TS 33.401 [6], 3GPP TS 33.402 [7], 3GPP TS 33.203 [8] and
3GPP TS 33.220 [9].
Figure A.3-3 shows the ARPF deployment option in the context of UDICOM when
the HSS and the UDM are deployed as stateful NFs and subscription credentials
are stored within the HSS/AuC instead.
Figure A.3-3: Stateful AuC+ARPF deployment in HSS according to UDICOM (TS
23.632 [5])
Figure A.3-4 shows the ARPF deployment option in the context of UDICOM when
the HSS and the UDM are deployed as stateless NFs and subscription credentials
are kept within the EPS-UDR.
Figure A.3-4: Stateless AuC+ARPF deployment in HSS according to UDICOM (TS
23.632 [5])
In these cases (stateful and stateless AuC+ARPF deployment in HSS), the UDM
requests authentication vectors for 5G-AKA or EAP-AKA' to the HSS via the new
UDICOM NU1 reference point using Nhss services. The HSS does not only support
the AuC functionality but also acts as ARPF to generate authentication vectors
as defined in 3GPP TS 33.501 [2]. In these cases, the ARPF functionality
related to the storage of the Home Network Public Key Identifier(s) is always
a function provided by the UDM.
Editor\'s Note: The collocation of ARPF within HSS/AuC conflicts with TS
33.501 which states that the ARPF is a function located within the UDM. SA3
needs to confirm if this ARPF deployment option can be allowed in Release 16
onwards. Dependencies with SIDF functionality in UDM when ARPF is not provided
by the UDM need to be checked as well.
Finally, Figure A.3-5 shows the ARPF deployment option in the context of
UDICOM when the HSS and the UDM are deployed as stateless NFs and subscription
credentials are stored within a common EPS+5GS-UDR.
Figure A.3-5: Stateless ARPF deployment in UDM according to UDICOM (TS 23.632
[5]
In this case, the ARPF is function provided by the UDM while the AuC remains
as a function provided by the HSS. HSS/AuC and UDM/ARPF generates
authentication vectors for their respective domains accessing to the
subscription credentials stored in the common EPS+5GS UDR. The UDICOM NU1
reference point is not used for authentication vector retrieval but it is
still required to fulfil HSS and UDM interworking related to other use cases
(e.g. intersystem mobility).
# Annex \ (informative): Change history
* * *
**Change history**  
**Date** **Meeting** **TDoc** **CR** **Rev** **Cat** **Subject/Comment** **New
version** 2019-10 SA3#96Ad-Hoc S3-193744 - - - Initial template 0.0.0 2019-10
SA3#96Ad-Hoc S3-193745 - - - Version after SA3#96Ad-Hoc incorporating changes
from S3-193747 and S3-193748 0.1.0