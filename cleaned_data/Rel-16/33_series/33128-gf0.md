# Foreword
This Technical Specification has been produced by the 3rd Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
The present document has been produced by the 3GPP TSG SA to standardise
Lawful Interception of telecommunications. The present document describes
protocols and procedures for Lawful Interception based on 3GPP specifications.
These protocols and procedures cover both internal 3GPP interfaces (those
required to intercept communications and manage interception within a 3GPP
network) and external handover interfaces (those used for delivery of
intercepted communications to Law Enforcement, or handling of warrants).
Lawful Interception needs to be done in accordance with the applicable
national or regional laws and technical regulations. Such national laws and
regulations define the extent to which capabilities in the present document
are applicable in specific jurisdictions.
# 1 Scope
The present document specifies the protocols and procedures required to
perform Lawful Interception within a 3GPP network. The present document
addresses both internal interfaces used internally with a 3GPP network and
external handover interfaces used to handover intercepted communications to
law enforcement.
The present document describes the detailed targeting of communications in
each point of interception within a 3GPP network and the information that a
point of interception needs to be able to capture. Furthermore, the detailed
data formats for both the internal and external interfaces are also defined.
National regulations determine the applicable set of information that needs to
be handed over or excluded from handover to law enforcement for a given 3GPP
operator service.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System\".
[3] 3GPP TS 33.126: \"Lawful Interception Requirements\".
[4] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[5] 3GPP TS 33.127: \"Lawful Interception (LI) Architecture and Functions\".
[6] ETSI TS 103 120: \" Lawful Interception (LI); Interface for warrant
information\".
[7] ETSI TS 103 221-1: \"Lawful Interception (LI); Internal Network
Interfaces; Part 1: X1\".
[8] ETSI TS 103 221-2: \"Lawful Interception (LI); Internal Network
Interfaces; Part 2: X2/X3\".
[9] ETSI TS 102 232-1: \"Lawful Interception (LI); Handover Interface and
Service-Specific Details (SSD) for IP delivery; Part 1: Handover specification
for IP delivery\".
[10] ETSI TS 102 232-7: \"Lawful Interception (LI); Handover Interface and
Service-Specific Details (SSD) for IP delivery; Part 7: Service-specific
details for Mobile Services\".
[11] 3GPP TS 33.501: \"Security Architecture and Procedures for the 5G
System\".
[12] 3GPP TS 33.108: \"3G security; Handover interface for Lawful Interception
(LI)\".
[13] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System
(5GS)\".
[14] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
Aspects\".
[15] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
nodes\".
[16] 3GPP TS 29.502: \"5G System; Session Management Services; Stage 3\".
[17] 3GPP TS 29.571: \"5G System; Common Data Types for Service Based
Interfaces; Stage 3\".
[18] 3GPP TS 23.040: \"Technical realization of the Short Message Service
(SMS)\".
[19] 3GPP TS 23.003: \"Numbering, addressing and identification \".
[20] OMA-TS-MLP-V3_5-20181211-C: \"Open Mobile Alliance; Mobile Location
Protocol, Candidate Version 3.5\",
https://www.openmobilealliance.org/release/MLS/V1_4-20181211-C/OMA-TS-
MLP-V3_5-20181211-C.pdf.
[21] 3GPP TS 29.540: \"5G System; SMS Services; Stage 3\".
[22] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[23] 3GPP TS 38.413: \"NG Application Protocol (NGAP)\".
[24] 3GPP TS 29.572: \"Location Management Services; Stage 3\".
[25] 3GPP TS 29.503: \"5G System; Unified Data Management Services\".
[26] IETF RFC 815: \"IP datagram reassembly algorithms\".
[27] IETF RFC 2460: \"Internet Protocol, Version 6 (IPv6) Specification\".
[28] IETF RFC 793: \"Transmission Control Protocol\".
[29] IETF RFC 768: \"User Datagram Protocol\".
[30] IETF RFC 4340: \"Datagram Congestion Control Protocol (DCCP)\".
[31] IETF RFC 4960: \"Stream Control Transmission Protocol\".
[32] IANA (www.iana.org): Assigned Internet Protocol Numbers, \"Protocol
Numbers\".
[33] IETF RFC 6437: \"IPv6 Flow Label Specification\".
[34] IETF RFC 791: \"Internet Protocol\".
[35] Open Geospatial Consortium OGC 05-010: \"URNs of definitions in ogc
namespace\".
[36] 3GPP TS 33.107: \"3G security; Lawful interception architecture and
functions\".
[37] 3GPP TS 37.340: \"Evolved Universal Radio Access (E-UTRA) and NR-Multi-
connectivity; Stage 2\".
[38] 3GPP TS 36.413: \"S1 Application Protocol (S1AP)\".
[39] OMA-TS-MMS_ENC-V1_3-20110913-A: \"Multimedia Messaging Service
Encapsulation Protocol\".
[40] 3GPP TS 23.140: \"Multimedia Messaging Protocol. Functional Description.
Stage 2\".
[41] 3GPP TS 38.415: \"NG-RAN; PDU Session User Plane Protocol\".
[42] 3GPP TS 23.273: \"5G System (5GS) Location Services (LCS); Stage 2\".
[43] IETF RFC 4566: \"SDP: Session Description Protocol\".
[44] 3GPP TS 24.193: \"Stage 3: Access Traffic Steering, Switching and
Splitting (ATSSS)\".
[45] 3GPP TS 29.509: \"5G System; Authentication Server Services; Stage 3\".
[46] 3GPP TS 24.011: \"Point-to-Point (PP) Short Message Service (SMS) support
on mobile radio interface\".
[47] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[48] 3GPP TS 29.504: \"5G System; Unified Data Repository Services; Stage 3\".
[49] 3GPP TS 29.505: \"5G System; Usage of the Unified Data Repository
services for Subscription Data; Stage 3\".
[50] 3GPP TS 29.598: \"5G System; Unstructured Data Storage Services;
Stage3\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] and the following apply. A term defined in the present
document takes precedence over the definition of the same term, if any, in
3GPP TR 21.905 [1].
## 3.2 Symbols
For the purposes of the present document, the following symbols apply:
\ \
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply. An abbreviation defined in the present
document takes precedence over the definition of the same abbreviation, if
any, in 3GPP TR 21.905 [1].
ADMF LI Administration Function
CC Content of Communication
CSP Communication Service Provider
CUPS Control and User Plane Separation
ICF Identity Caching Function
IEF Identity Event Function
IQF Identity Query Function
IRI Intercept Related Information
LALS Lawful Access Location Services
LEA Law Enforcement Agency
LEMF Law Enforcement Monitoring Facility
LI Lawful Interception
LICF Lawful Interception Control Function
LI_HI1 LI_Handover Interface 1
LI_HI2 LI_Handover Interface 2
LI_HI3 LI_Handover Interface 3
LI_HI4 LI_Handover Interface 4
LI_HIQR Lawful Interception Handover Interface Query Response
LIPF Lawful Interception Provisioning Function
LIR Location Immediate Request
LI_SI Lawful Interception System Information Interface
LISSF Lawful Interception State Storage Function
LI_ST Lawful Interception State Transfer Interface
LI_X1 Lawful Interception Internal Interface 1
LI_X2 Lawful Interception Internal Interface 2
LI_X3 Lawful Interception Internal Interface 3
LI_XEM1 Lawful Interception Internal Interface Event Management Interface 1
LI_XER Lawful Interception Internal Interface Event Record
LI_XQR Lawful Interception Internal Interface Query Response
LTF Location Triggering Function
MDF Mediation and Delivery Function
MDF2 Mediation and Delivery Function 2
MDF3 Mediation and Delivery Function 3
MM Multimedia Message
MMS Multimedia Message Service
NPLI Network Provided Location Information
O&M Operations and Management
POI Point Of Interception
SDP Session Description Protocol
SIRF System Information Retrieval Function
SOI Start Of Interception
TF Triggering Function
TNGF Trusted Non-3GPP Gateway Function
TWIF Trusted WLAN Interworking Function
xCC LI_X3 Communications Content.
xIRI LI_X2 Intercept Related Information
# 4 General
## 4.1 Introduction
The present document provides details of the internal and external interfaces
required for a network operator, access provider and/or service provider to
provide the necessary information to a Law Enforcement Agency (LEA) required
to meet LI requirements. LI requirements for 3GPP networks and services are
given in TS 33.126 [3].
The high-level architecture that defines the necessary interfaces is specified
in TS 33.127 [5]. The generic high-level architecture is as follows:
Figure 4.1-1: High-level architecture diagram with key point-to-point LI
interfaces
The specification of the interfaces is split into two parts:
\- Internal interfaces used between an operator's network functions are
described in clause 4.2.
\- External interfaces used in communicating with a LEA are described in
clause 4.3.
## 4.2 Basic principles for internal interfaces
This clause lists the internal interfaces shown in clause 4.1, indicates the
protocol used to realise each interface, and gives a reference to the relevant
clauses of the present document that specify how the protocol is to be used
for the given interface.
Table 4.2-1: Internal interfaces and related protocols
* * *
Interface Description Protocol used to realise interface Usage LI_SI Used to
provide system information to the LIPF from the SIRF. Out of scope of the
present document.  
LI_X1 Used to configure and audit Directly-provisioned POIs, TFs and MDFs.
ETSI TS 103 221-1 [7]. See clause 5.2.2 LI_X1 (Management) Used to audit
Triggered POIs. ETSI TS 103 221-1 [7]. See clause 5.2.3 LI_X2 Used to pass
xIRI from IRI-POIs to the MDF2. ETSI TS 103 221-2 [8]. See clause 5.3.2 LI_X3
Used to pass xCC from CC-POIs to the MDF3. ETSI TS 103 221-2 [8]. See clause
5.3.3 LI_T2 Used to pass triggering information from the IRI-TF to a Triggered
IRI-POI. ETSI TS 103 221-1 [7]. See clause 5.2.4 LI_T3 Used to pass triggering
information from a CC-TF to a Triggered CC-POI. ETSI TS 103 221-1 [7]. See
clause 5.2.4 LI_XQR Used to pass queries from IQF to ICF and responses from
ICF to IQF. ETSI TS 103 221-1 [7]. See clause 5.8 LI_XER Used to pass
identifier association event records from IEFs to ICF. See Clause 5.9. See
clause 5.9 LI_XEM1 Used by the LICF/LIPF to manage IEFs and ICF. ETSI TS 103
221-1 [7]. See clause 5.2.7 LI_ADMF Used to pass intercept provisioning
information form the LICF to the LIPF. Out of scope of the present document.  
LI_MDF Used by MDF2 and MDF3 in interactions necessary to correctly generate
CC and IRI from xCC and xIRI. Out of scope of the present document.  
LI_IQF Used to pass information related to IEFs and ICF to IQF. Out of scope
of the present document.  
LI_ST Used to transfer LI state information to and from the LISSF. 3GPP TS
29.598 [50]. See clauses 5.10 and 6.2.3.10
* * *
## 4.3 Basic principles for external handover interfaces
This clause lists the external handover interfaces shown in clause 4.1,
indicates the protocol used to realise each interface, and gives a reference
to the relevant clauses of the present document that specify how the protocol
is to be used for the given interface.
Table 4.3-1: External handover interfaces and related protocols
+-----------+-----------------+-----------------+----------------+ | Interface | Description | Protocol used | Usage | | | | to realise | | | | | interface | | +-----------+-----------------+-----------------+----------------+ | LI_HI1 | Used to send | ETSI TS 103 120 | See clause 5.4 | | | warrant and | [6] shall be | | | | other | supported. | | | | interception | | | | | request | Other methods | | | | information | (e.g. manual | | | | from LEA to | exchange) may | | | | operator. | be used | | | | | depending on | | | | | national | | | | | regulatory | | | | | requirements. | | +-----------+-----------------+-----------------+----------------+ | LI_HI2 | Used to send | ETSI TS 102 | See clause 5.5 | | | IRI from the | 232-1 [9] and | | | | MDF2 to the | ETSI TS 102 | | | | LEMF. | 232-7 [10] | | | | | shall be | | | | | supported. | | +-----------+-----------------+-----------------+----------------+ | LI_HI3 | Used to send CC | ETSI TS 102 | See clause 5.5 | | | from the MDF3 | 232-1 [9] and | | | | to the LEMF. | ETSI TS 102 | | | | | 232-7 [10] | | | | | shall be | | | | | supported. | | +-----------+-----------------+-----------------+----------------+ | LI_HI4 | Used to send LI | ETSI TS 102 | See clause 5.6 | | | notification | 232-1 [9] and | | | | information | ETSI TS 102 | | | | from MDF2/3 to | 232-7 [10] | | | | LEMF. | shall be | | | | | supported. | | +-----------+-----------------+-----------------+----------------+ | LI_HIQR | Used to send | ETSI TS 103 120 | See clause 5.7 | | | warrant and | [6] shall be | | | | other | supported. | | | | identifier | | | | | association | | | | | query | | | | | information | | | | | from LEA to CSP | | | | | and used by the | | | | | CSP to send | | | | | query responses | | | | | to the LEA. | | | +-----------+-----------------+-----------------+----------------+
## 4.4 Service scoping
### 4.4.1 General
The interception product shall be delivered to the LEMF over LI_HI2 and
LI_HI3, observing the service scoping described in the following clauses.
### 4.4.2 CSP service type
The LIPF shall be able to provision the POIs, TFs and MDF2/MDF3 according to
the requirements of the warrant with the following CSP service type(s):
\- Voice.
\- Data.
\- Messaging (e.g. SMS/MMS).
\- Push-to-Talk (including MCPTT).
\- LALS (the Target Positioning service, per TS 33.127 [5], clause 7.3.3.2).
When multiple service types are applicable to a target due to multiple
warrants, the MDF2/MDF3 shall be able to deliver interception product to each
LEMF based on the CSP service type(s) of the respective warrant.
When no service type is provisioned, the MDF2/MDF3 shall deliver all
interception product it receives from the POIs.
### 4.4.3 Delivery type
\- IRI.
\- CC.
\- IRI and CC.
The LIPF shall be able to provision the POI, TF and the MDF2/MDF3 according
the delivery type(s) applicable to a warrant.
When different delivery types are applicable to a target due to multiple
warrants, the MDF2/MDF3 shall be able to deliver IRI/CC to each LEMF based on
the delivery type(s) of the respective warrant.
### 4.4.4 Location Reporting
The LIPF shall be able to provision the POIs and MDF2 according to the
requirements of the warrant with the following location reporting types:
\- Report location only at the beginning and end of a session.
\- Do not report location.
When no location reporting type is provisioned, the POIs and MDF2/MDF3 shall
report location every time the target location information is received from
the POI (including location update with no physical change of location).
When different location reporting types are applicable to a target due to
multiple warrants, then POI may be provisioned as if the reporting of all
location information occurrences at the POI is required, with MDF2 restricting
the delivery of location to the LEMF as per the provisioned information for a
warrant.
### 4.4.5 LALS Triggering
\- This option is used to activate the LALS triggered location service (TS
33.127 [5], clause 7.3.3.3) for the target.
The LIPF shall be able to provision the LTF associated with a POI or MDF2 with
the LALS triggered location service parameters provided in the warrant or use
a default set of parameters.
### 4.4.6 Roaming Interception
\- Stop interception when the target is roaming outbound internationally.
NOTE 1: The definition of international roaming for LI purposes could vary per
jurisdiction.
NOTE 2: The method used to achieve the roaming related service scoping is not
described in the present document.
# 5 Transport and Communications Protocol
## 5.1 General
This clause describes the protocols used for each of the interfaces at a level
which is agnostic of the subject service or network. Additional specific
fields or behaviours are given in the relevant parts of clauses 6 and 7.
## 5.2 Protocols for LI_X1 and LI_T interfaces
### 5.2.1 General usage of ETSI TS 103 221-1
Functions having an LI_X1, LI_T2 or LI_T3 interface shall support the use of
ETSI TS 103 221-1 [7] to realise the interface.
In the event of a conflict between ETSI TS 103 221-1 [7] and the present
document, the terms of the present document shall apply.
The LIPF and MDF2/3 shall maintain a mapping between internal interception
identifiers (XIDs) and external interception identifiers (LIIDs), as defined
by TS 103 221-1 [7] clause 5.1.2. In case of multiple interceptions for a
single target identifier, it is an implementation decision for the LIPF/TF
whether multiple XIDs are used (i.e. a one-to-one mapping between XID and LIID
is maintained) or whether the single XID is used and mapped to multiple LIIDs
at the MDF2/3. Clauses 6 and 7 give further details for specific networks or
services (e.g. minimum supported target identifier formats).
In the event of a request issued over the interface fails, or an error is
reported, the LIPF should raise an alert in the appropriate LI Operations and
Management (O&M) system. Further procedures (e.g. retrying a failed request)
are left to CSP policy to define.
A failure of LI shall not impact the target\'s or other users\' services.
In general, and unless otherwise specified, the function playing the role of
the NE (i.e IRI-POI, IRI-TF, CC-TF, CC-POI, MDF2 or MDF3) shall:
\- Accept CreateDestination and ModifyDestination messages regardless of the
DeliveryType.
\- Reject ActivateTask/ModifyTask messages that contain DIDs that reference
Destinations that have not been created via a CreateDestination message;
Destinations shall be created before they are used.
\- Reject ActivateTask/ModifyTask messages that do not result in at least one
valid DID for their DeliveryType (e.g. at least one valid DID for an X2
delivery destination for an \"X2Only\" Task). Additional DIDs for Destinations
of other DeliveryTypes (e.g. a DID for an X3 Destination for an \"X2Only\"
Task) shall be accepted, but a ReportTaskIssue message may be sent to indicate
the mismatch.
### 5.2.2 Usage for realising LI_X1
For the purposes of realising LI_X1 between the LIPF and a POI, MDF or TF, the
LIPF plays the role of the ADMF as defined in ETSI TS 103 221-1 [7] reference
model (clause 4.2), and the POI, MDF or TF plays the role of the NE.
In general, and unless otherwise specified, the ADMF shall:
\- When the provisioning of an IRI-POI/IRI-TF/MDF2 is needed to meet the
requirements of the warrant, send an ActivateTask (and subsequent ModifyTask
if/as needed) with the DeliveryType set to \"X2Only\" and the ListOfDIDs
containing at least one DID for an X2 or LI_HI2 delivery destination over
LI_X1 to each of the relevant functions.
\- When the provisioning of a CC-POI/CC-TF/MDF3 is needed to meet the
requirements of the warrant, send an ActivateTask (and subsequent ModifyTask
if/as needed) with the DeliveryType set to \"X3Only\" and the ListOfDIDs
containing at least one DID for X3 or LI_HI3 delivery destination over LI_X1
to each of the relevant functions.
When both the above are required to meet the requirements of the warrant, the
ADMF shall send each independently to each relevant function.
When it is required to cease interception, the ADMF shall send a
DeactivateTask message to each relevant function, unless the Task has already
been removed by other means (e.g. by the use of the
ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.12).
Other deployments compliant with ETSI TS 103 221-1 [7] may be used subject to
local agreement.
### 5.2.3 Usage for realising LI_X1 (management)
For the purposes of realising LI_X1 between the LIPF and a triggered POI, the
LIPF plays the role of the "ADMF" as defined in ETSI TS 103 221-1 [7]
reference model (clause 4.2), and the triggered POI plays the role of the
"NE".
### 5.2.4 Service scoping
The LIPF shall be able to provision the POI, TFs and the MDF2/MDF3 according
to the service scoping (see clause 4.4) applicable to a warrant as described
in Clause 6.2.1.2 and Annex C of ETSI TS 103 221-1 [7].
### 5.2.5 Usage for realising LI_T2
For the purposes of realising LI_T2 between an IRI-TF and a triggered IRI-POI,
the IRI-TF plays the role of the \"ADMF\" as defined in the ETSI TS 103 221-1
[7] reference model (clause 4.2), and the triggered IRI-POI plays the role of
the \"NE\".
In case the IRI-TF receives from the triggered IRI-POI an error in the answer
to a triggering message, the IRI-TF shall send a ReportTaskIssue message to
the LIPF. In such case, the failure of LI shall not impact the target\'s or
other users\' services.
Unless otherwise specified, an IRI-TF shall set the Product ID field in any
ActivateTask or ModifyTask message issued to a triggered IRI-POI (see ETSI TS
103 221-1 [7] clause 6.2.1.2). The IRI-TF shall set the Product ID to the XID
of the Task object associated with the interception at the IRI-TF in order to
allow correlation of LI product at the MDF2.
Unless otherwise specified, the TF shall include the MDF2 as the X2 delivery
destination in the trigger sent using the ActivateTask/ModifyTask with
\"X2Only\".
When the IRI-TF determines that it is required to remove a Task at a
particular IRI-POI (e.g. having detected the end of a session) it shall send a
DeactivateTask message for the relevant Task to that IRI-POI, unless the Task
has already been removed by other means (e.g. by the use of the
ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.12).
the IRI-TF receives a DeactivateTask message or ModifyTask message from the
LIPF, the IRI-TF shall send DeactivateTask or ModifyTask messages to all
applicable triggered IRI-POIs for all tasks associated to the Task object in
the message from the LIPF.
### 5.2.6 Usage for realising LI_T3
For the purposes of realising LI_T3 between a CC-TF and a triggered CC-POI,
the CC-TF plays the role of the \"ADMF\" as defined in the ETSI TS 103 221-1
[7] reference model (clause 4.2), and the triggered CC-POI plays the role of
the \"NE\".
In case the CC-TF receives from the triggered CC-POI an error in the answer to
a triggering message, the CC-TF shall send a ReportTaskIssue message to the
LIPF. In such case, the failure of LI shall not impact the target\'s or other
users\' services.
Unless otherwise specified, a CC-TF shall set the Product ID field in any
ActivateTask or ModifyTask message issued to a triggered CC-POI (see ETSI TS
103 221-1 [7] clause 6.2.1.2). The CC-TF shall set the Product ID to the XID
of the Task object associated with the interception at the CC-TF in order to
allow correlation of LI product at the MDF3.
Unless otherwise specified, the TF shall include MDF3 as the X3 delivery
destination in the trigger sent using the ActivateTask/ModifyTask with
\"X3Only\".
When the CC-TF determines that it is required to remove a Task at a particular
CC-POI (e.g. having detected the end of a session) it shall send a
DeactivateTask message for the relevant Task to that CC-POI, unless the Task
has already been removed by other means (e.g. by the use of the
ImplicitDeactivationAllowed flag, see ETSI TS 103 221-1 [7] clause 6.2.12).
When the CC-TF receives a DeactivateTask message or ModifyTask message from
the LIPF, the CC-TF shall send DeactivateTask or ModifyTask messages to all
applicable triggered CC-POIs for all tasks associated to the Task object in
the message from the LIPF.
### 5.2.7 Usage for realising LI_XEM1
For the purposes of realising LI_XEM1 between the LIPF and an IEF, the LIPF
plays the role of the ADMF as defined in ETSI TS 103 221-1 [7] reference model
(clause 4.2), and the IEF plays the role of the NE.
The IEF shall be enabled by sending the following ActivateTask message from
the LIPF.
NOTE: The terms identifier and identity are used interchangeably in clause
5.2.7.
Table 5.2.7-1: ActivateTask message for activating an IEF
* * *
ETSI TS 103 221-1 field name Description M/C/O XID Shall be set to a value
assigned by the LIPF. M TargetIdentifiers Shall contain a single Target
Identifier of type \"IdentityAssociation\" (see table 5.2.7-2) M DeliveryType
Set to \"X2Only\". M ListOfDIDs Shall give the DID of the delivery endpoint of
the ICF(s) to which identity association events should be delivered. These
delivery endpoints are configured using the CreateDestination message as
described in ETSI TS 103 221-1 [7] clause 6.3.1 prior to the task activation.
M
* * *
The following Target Identifier Type is defined for the use of LI_XEM1. Unless
otherwise specified, use of any other Target Identifier Type (including adding
a target identifier more than once) shall result in the ActivateTask message
being rejected with the appropriate error.
Table 5.2.7-2: Target Identifier Type for LI_XEM1
* * *
Identifier type Owner ETSI TS 103 221-1 [7] TargetIdentifier type Definition
IdentityAssociationTargetIdentifier 3GPP TargetIdentifierExtension /
IdentityAssociationTargetIdentifier Empty tag (see XSD schema)
* * *
The IEF may be reconfigured to send identity associations to a different ICF
using a ModifyTask message to modify the delivery destinations.
The IEF shall be disabled by sending the following DeactivateTask message from
the LIPF.
Table 5.2.7-3: DeactivateTask message for de-activating an IEF
* * *
ETSI TS 103 221-1 field name Description M/C/O XID Shall be set to the value
assigned by the LIPF M
* * *
The LIPF should send one ActivateTask command to each IEF.
NOTE: The IEF may receive multiple ActivateTask messages conforming to Table
5.2.7-1, each of which can be independently deactivated. The IEF shall remain
active as long as at least one valid Task remains active.
## 5.3 Protocols for LI_X2 and LI_X3
### 5.3.1 General usage of ETSI TS 103 221-2
Functions having an LI_X2 or LI_X3 interface shall support the use of ETSI TS
103 221-2 [8] to realise the interface.
In the event of a conflict between ETSI TS 103 221-2 [8] and the present
document, the terms of the present document shall apply.
The xIRI and the xCC sent using ETSI TS 103 221-2 [8] shall contain the
appropriate XID as received in the relevant LI_X1 provisioning message (or
LI_T2/3 triggering message, as appropriate).
### 5.3.2 Usage for realising LI_X2
The POI sending xIRI over the LI_X2 interface shall set the PDU type field
within the xIRI to \"X2 PDU\". (see ETSI TS 103 221-2 [8] clause 5.1).
Where a single xIRI is sent as a result of a network procedure (i.e. as result
of several signaling messages exchanged between the target UE and the
network), the POI sending the xIRI shall set the Payload Direction field (see
ETSI TS 103 221-2 [8] clause 5.2.6) based on the initiator of the network
procedure.
Unless otherwise specified by the relevant clause, the payload shall consist
of a BER-encoded TS33128Payloads.XIRIPayload structure. The payload format
(see ETSI TS 103 221-2 [8] clause 5.4) shall be set according to the relevant
clause of the present document (the value 2 is used for TS
33128Payloads.XIRIPayload).The TLS transport profile (see ETSI TS 103 221-2
[8] clause 6) shall be supported and used by default.
Unless otherwise specified, xIRI shall include the timestamp and sequence
number conditional attribute fields, with the timestamp value set to the time
at which the event occurred.
Unless otherwise specified, the \"Matched Target Identifier\" conditional
attribute shall be set to indicate what target identity was matched to
generate the xIRI (see ETSI TS 103 221-2 [8] clause 5.3.18).
Unless otherwise specified, the \"Other Target Identifier\" conditional
attribute shall be set with all other target identities present at the NF that
contains the POI (see ETSI TS 103 221-2 [8] clause 5.3.19).
Unless otherwise specified, the NFID conditional attribute (see ETSI TS 103
221-2 [8] clause 5.3.7) should be set to indicate the NF that contains the
POI. The NFID is defined as a unique identifier assigned to the NF by the
network (e.g. FQDN) per carrier implementation and referred to in the
following clauses.
Unless otherwise specified, the IPID (see ETSI TS 103 221-2 [8] clause 5.3.8)
should be set to indicate the POI (within the NF) that generated the xIRI for
the conditional attribute field.
### 5.3.3 Usage for realising LI_X3
The POI sending xCC over the LI_X3 interface shall set the PDU type field in
the xCC to \"X3 PDU\" (see ETSI TS 103 221-2 [8] clause 5.1).
The payload format shall be specified according to the relevant clause of the
present document.
Unless otherwise specified, the NFID conditional attribute (see ETSI TS 103
221-2 [8] clause 5.3.7) should be set to indicate the NF that contains the
POI. The NFID is defined as a unique identifier assigned to the NF by the
network (e.g. FQDN) per carrier implementation and referred to in the
following clauses.
Unless otherwise specified, the IPID (see ETSI TS 103 221-2 [8] clause 5.3.8)
should be set to indicate the POI (within the NF) that generated the xIRI for
the conditional attribute field.
NOTE: ETSI TS 103 221-2 [8] specifies in clause 6 a default profile which is
mandatory to support, but allows further profiles to be defined. In scenarios
where it may not be possible to achieve the necessary LI data rates based on
the default profile, alternative profiles may be considered (e.g. based on
UDP, multi path TCP or other protocols). Any alternative profile needs to
ensure that LI reliability, security and completeness requirements as
specified in TS 33.126 [3] are met.
### 5.3.4 Service scoping
When applicable, the POIs shall deliver the xIRIs/xCC to MDF2/MDF3 over
LI_X2/LI_X3 according to the service scoping as provisioned by the LIPF to
them (see clause 4.4).
## 5.4 Protocols for LI_HI1
### 5.4.1 General
Functions having an LI_HI1 interface shall support the use of ETSI TS 103 120
[6] to realise the interface.
In the event of a conflict between ETSI TS 103 120 [6] and the present
document, the terms of the present document shall apply.
### 5.4.2 Service scoping
LEAs shall be able to provide the service scoping as applicable to the warrant
to the CSP over the LI_HI1 interface (see clause 4.4).
## 5.5 Protocols for LI_HI2 and LI_HI3
### 5.5.1 General
Functions having an LI_HI2 or LI_HI3 interface shall support the use of ETSI
TS 102 232-1 [9] and ETSI TS 102 232-7 [10] to realise the interface.
In the event of a conflict between either specification and the present
document, the terms of the present document shall apply.
### 5.5.2 Usage for realising LI_HI2
The IRI messages sent over LI_HI2 are structured as a header and a payload.
The header contains general information like LIID, timestamp, correlation
information (as for example defined in ETSI TS 102 232-1 [9]). The payload
contains intercept related information based on information that the MDF2 has
received from sources in the network, such as the IRI-POI as described in
clauses 6 and 7 of the present document. Details of the IRI messages can be
found in Annex A of the present document. Messages defined as passing over the
LI_HI2 interface shall be passed as the payload of the threeGPP33128DefinedIRI
field (see TS ETSI 102 232 -7 [10] clause 15).
If the LI_X2 contains the NFID conditional attribute (see ETSI TS 103 221-2
[8] clause 5.3.7), this shall be mapped into the PSHeader
networkFunctionIdentifier (see ETSI TS 102 232-1 [9] clause 5.2.14 and ETSI TS
102 232-7 [10] clause 15.3).
If the LI_X2 contains the IPID conditional attribute (see ETSI TS 103 221-2
[8]), the EIPID parameter (see ETSI TS 102 232-1 [9] clause 5.2.13) shall be
populated by the MDF2 with the IPID value.
### 5.5.3 Usage for realising LI_HI3
The CC sent over LI_HI3 is structured as a header and a payload. The header
contains general information like LIID, timestamp, correlation information (as
for example defined in ETSI TS 102 232-1 [9]). The payload contains content of
communication based on information that the MDF3 has received from sources in
the network, such as the CC-POI as described in clauses 6 and 7 of the present
document. Details of the CC can be found in Annex A of the present document.
CC defined as passing over the LI_HI3 interface shall be passed as the payload
of the threeGPP33128DefinedCC field (see ETSI TS 102 232-7 [10] clause 15).
If the LI_X3 contains the NFID conditional attribute (see ETSI TS 103 221-2
[8] clause 5.3.7), this shall be mapped into the PSHeader
networkFunctionIdentifier (see ETSI Ts 102 232-1 [9] clause 5.2.14 and ETSI TS
102 232-7 [10] clause 15.3).
If the LI_X3 contains the IPID conditional attribute (see ETSI TS 103 221-2
[8]), the EIPID parameter (see ETSI TS 102 232-1 [9] clause 5.2.13) shall be
populated by the MDF3 with the IPID value.
NOTE: ETSI TS 102 232-1 [9] specifies in clause 6.4 a transport layer based on
TCP. However, based on agreement between network operator and LEA, in
scenarios where it may not be possible to achieve the necessary LI data rates
based on the transport layer based on single TCP connection, alternative
profiles may be considered (e.g. based on UDP, multi path TCP or other
protocols). Any alternative profile needs to ensure that LI reliability,
security and completeness requirements as specified in TS 33.126 [3] are met.
### 5.5.4 Service scoping
The MDF2 and MDF3 shall be able to deliver the IRI messages and the CC to the
LEMF over LI_HI2 and LI_HI3 respectively, according to the service scoping
(see clause 4.4).
### 5.5.5 IRI Target Identifiers
The MDF shall populate the TargetIdentifiers field of the IRIPayload defined
in Annex A with all Target Identifiers available at the MDF. For all
Identifiers received in the LI_X2 \"Matched Target Identifier\" conditional
attribute (see clause 5.3.2), the MDF shall include the relevant Identifier
with the provenance set to \"matchedOn\". For all Identifiers received in the
the LI_X2 \"Other Target Identifier\" conditional attribute (see clause
5.3.2), the MDF shall include the relevant Identifier with the provenance set
to \"other\". For all Identifiers present in the xIRI payload, the MDF shall
include the relevant Identifier with the provenance set to \"observed\". For
all Identifiers present in the provisioning message received over X1, the MDF
shall include the relevant Identifier with the provenance set to
\"lEAProvided\". For all Identifiers present in the MDF that are not reported
as other TargetIdentifiers, the MDF shall include the relevant Identifier with
the provenance set to \"other\".
## 5.6 Protocols for LI_HI4
### 5.6.1 General
Functions having an LI_HI4 shall support the use of ETSI TS 102 232-1 [9] to
realise the interface.
In the event of a conflict between ETSI TS 102 232-1 [9] and the present
document, the terms of the present document shall apply.
### 5.6.2 Usage for realising LI_HI4
The LI Notification messages sent over LI_HI4 are structured as a header and a
payload. The header contains general information like LIID, timestamp (as for
example defined in ETSI TS 102 232-1 [9]). The payload contains the
administrative information such as notification. Details of the LI
Notification messages can be found in Annex B of the present document.
Where the LI_HI4 interface is present alongside an LI_HI2 interface or LI_HI3
interface, the LI Notification messages shall be transmitted along the same
connection as the IRI messages or CC. Where ETSI TS 102 232-1 [9] is used for
LI_HI2 or LI_HI3, messages defined as passing over the LI_HI4 interface shall
be passed in the hI4Payload sequence.
The MDF2/MDF3 shall support generation LI Notification messages for at least
the following events:
\- Activation of an interception at the MDF2/MDF3 via LI_X1.
\- Modification of an interception at the MDF2/MDF3 via LI_X1.
\- Deactivation of an interception at the MDF2/MDF3 via LI_X1.
## 5.7 Protocols for LI_HIQR
### 5.7.1 General
Functions having an LI_HIQR interface shall support the use of ETSI TS 103 120
[6] to realise the interface.
In the event of a conflict between ETSI TS 103 120 [6] and the present
document, the terms of the present document shall apply.
NOTE: The terms identifier and identity are used interchangeably in clause
5.7.
### 5.7.2 Usage for realising LI_HIQR
#### 5.7.2.1 Request structure
LI_HIQR requests are represented by issuing a CREATE request for an
LDTaskObject (see ETSI TS 103 120 [6] clause 8.3), populated as follows:
Table 5.7.2-1: LDTaskObject representation of LI_HIQR request
Field Value M/C/O
* * *
Reference Reference to the authorization under which the request is made. The
format of this field, and any procedures for allocating or validating it, are
for national agreement. M DesiredStatus Shall be set to
\"AwaitingDisclosure\". M RequestDetails Set according to table 5.7.2-2 below.
M DeliveryDetails Shall be set to indicate the delivery destination for the
LI_HIQR records (see clause 5.7.2.3 and ETSI TS 103 120 [6] clause 8.3.6.2)
unless the delivery destination is known via other means. C
The use of any other LDTaskObject parameter is outside the scope of the
present document.
Table 5.7.2-2: RequestDetails structure
+---------------+--------------------------------------------+-------+ | Field | Value | M/C/O | +===============+============================================+=======+ | Type | Shall be set to one of the RequestType | M | | | values as defined in Table 5.7.2-3. | | +---------------+--------------------------------------------+-------+ | ObservedTime | When the RequestValues provides a | C | | | temporary identity, this field shall be | | | | set to the observation time of that | | | | temporary identity. | | | | | | | | When the RequestValues provides a | | | | permanent identity, this is the time at | | | | which the LEA requires that the permanent | | | | to temporary association is applicable. | | | | | | | | Shall not be present for requests of type | | | | \"OngoingIdentityAssociation\". | | +---------------+--------------------------------------------+-------+ | RequestValues | Set to the target identifier plus | M | | | additional information required (see | | | | clause 5.7.2.2). | | +---------------+--------------------------------------------+-------+
NOTE: If the observed time is in the past, providing a successful query
response is subject to associations still being available in the cache when
the query is made to the ICF.
Table 5.7.2-3: RequestType Dictionary for LI_HIQR
Dictionary Owner Dictionary Name
* * *
3GPP RequestType
Defined DictionaryEntries  
Value Meaning IdentityAssociation A request for a single
IdentityResponseDetails response to the query provided
OngoingIdentityAssociation A request for an ongoing series of
IdentityResponseDetails responses matching the query provided. May only be
used when the RequestValues contains a permanent identifier. The request shall
be terminated by updating the LDTaskObject DesiredStatus to \"Disclosed\".
Table 5.7.2-3 is formatted in accordance with ETSI TS 103 120 [6] Annex F.
#### 5.7.2.2 Request parameters
The RequestValues field shall contain one of the following:
\- SUPI, given in either SUPIIMSI or SUPINAI formats as defined in ETSI TS 103
120 [6] clause C.2.
\- SUCI, given as defined in Table 5.7.2-4 below.
\- 5G-S-TMSI, given as defined in Table 5.7.2-4 below.
\- 5G-GUTI, given as defined in Table 5.7.2-4 below.
If the RequestType is \"OngoingIdentityAssociation\" (see Table 5.7.2-3), SUPI
is the only valid identity type in the RequestValues field. If the RequestType
is "OngoingIdentityAssociation" and any other identity type is provided, the
IQF shall signal the error by setting the LDTaskObject Status to \"Invalid\"
(see TS 103 120 [6] clause 8.3.3).
If a temporary identity is provided, the following shall also be present as
RequestValues:
\- NRCellIdentity, given as defined in Table 5.7.2-4 below.
\- TrackingAreaCode, given as defined in Table 5.7.2-4 below.
The following RequestValue FormatTypes (see ETSI TS 103 120 [6] clause
8.3.5.4) are defined (which are not otherwise defined elsewhere).
Table 5.7.2-4: RequestValue FormatType extensions for LI_HIQR Requests
+--------------+----------------+----------------+----------------+ | Format Owner | Format Name | Description | Format | +==============+================+================+================+ | 3GPP | SUCI | Subscription | TS 29.509 | | | | Concealed | [45] clause | | | | Identifier as | 6.1.6.3.2 | | | | per TS 23.003 | | | | | [19] clause | | | | | 2.2B. | | +--------------+----------------+----------------+----------------+ | 3GPP | 5GSTMSI | Shortened form | Matches | | | | of the 5G-GUTI | regular | | | | as defined in | expression: | | | | TS 23.003 | | | | | [19] clause | \^(5gstmsi- | | | | 2.11. Given as | ([0-3][0-9A | | | | a | -Fa-f]{2})-(\ | | | | hy | [0-3][0-9A-F | | | | phen-separated | a-f])-([0-9A | | | | concatenation | -Fa-f]{8}))\$ | | | | of: | | | | | | | | | | - The string | | | | | \"5gstmsi\". | | | | | | | | | | - The AMF Set | | | | | ID given as | | | | | three | | | | | hexadecimal | | | | | digits (10 | | | | | bits). | | | | | | | | | | - The AMF | | | | | Pointer given | | | | | as two | | | | | hexadecimal | | | | | digits (6 | | | | | bits). | | | | | | | | | | - The 5G-TMSI | | | | | given as eight | | | | | hexadecimal | | | | | digits (32 | | | | | bits) | | +--------------+----------------+----------------+----------------+ | 3GPP | 5GGUTI | As defined in | Matches | | | | TS 23.003 | regular | | | | [19] clause | expression: | | | | 2.10. Given as | | | | | a hyphen | \ | | | | separated | ^(5gguti-([0- | | | | concatenation | 9]{3})-([0-9 | | | | of: | ]{2,3})-([0- | | | | | 9A-Fa-f]{2})- | | | | - The string | ([0-3][0-9A | | | | \"5gguti\". | -Fa-f]{2})-(\ | | | | | [0-3][0-9A-F | | | | - MCC given | a-f])-([0-9A | | | | as a three | -Fa-f]{8}))\$ | | | | decimal | | | | | digits. | | | | | | | | | | - MNC given | | | | | as a two or | | | | | three digit | | | | | decimal digits | | | | | | | | | | - AMF Region | | | | | ID given as | | | | | two | | | | | hexadecimal | | | | | digits (8 | | | | | bits). | | | | | | | | | | - The AMF Set | | | | | ID, AMF | | | | | Pointer and | | | | | 5G-TMSI as | | | | | defined above | | | | | in 5GSTMSI | | +--------------+----------------+----------------+----------------+ | 3GPP | NRCellIdentity | NR Cell ID | TS 29.571 | | | | (NCI), as | [17] clause | | | | defined in TS | 5.4.2 | | | | 23.003 [19] | | | | | clause 19.6A | | +--------------+----------------+----------------+----------------+ | 3GPP | Tr | Tracking area | TS 29.571 | | | ackingAreaCode | code as | [17] clause | | | | defined in TS | 5.4.2 | | | | 23.003 [19] | | | | | clause | | | | | 19.4.2.3 | | +--------------+----------------+----------------+----------------+
#### 5.7.2.3 Response structure
The LI_HIQR request is used to generate a request to the ICF over LI_XQR (see
clause 5.8). The response received over LI_XQR is then transformed into an
LI_HIQR response.
LI_HIQR responses and updates are represented as XML following the
IdentityResponseDetails type definition (see Annex E).
Responses and updates are delivered within a DELIVER request (see ETSI TS 103
120 [6] clause 6.4.10) containing a DELIVERY object (see ETSI TS 103 120 [6]
clause 10).
IdentityResponseDetails contain IdentityAssociation records. The fields of
each IdentityAssociationRecord shall be set as follows.
Table 5.7.2-5: IdentityAssociationRecord
Field Value M/C/O
* * *
SUPI SUPI associated with the provided identity. M SUCI SUCI associated with
the provided identity, if available. C 5G-GUTI 5G GUTI associated with the
provided identity, provided in the form given in the request (see Table
5.7.2-4). M PEI PEI associated with the provided identity during the
association period, if known C AssociationStartTime The time that the
association between the SUPI and the temporary identity became valid. (See
NOTE). M AssociationEndTime The time that the association between the SUPI and
the temporary identity ceased to be valid. Shall be omitted if the association
is still valid (see NOTE). C FiveGSTAIList List of tracking areas associated
with the registration area within which the UE was or is registered in the
lifetime of the reported association, if available. See clause 7.6.2.4 for
details. C NOTE: The AssociationStartTime and AssociationEndTime represent the
lifespan of the SUPI to 5G-GUTI association. When a SUCI is present, the
AssociationStartTime also represents the time of the SUCI\'s validity.
If no association is found which matches the criteria provided in the LI_XQR
request, then the LI_XQR response contains zero IdentityAssocationRecords.
Similarly, the LI_HIQR response contains zero IdentityAssociationRecords.
For responses or updates providing a currently valid SUPI to 5G-GUTI identity
association, the AssociationEndTime shall be absent. The AssociationStartTime
shall indicate when the 5G-GUTI became associated with the SUPI. The SUCI
field shall be populated if it was present in the IEF record for the
association (see clause 6.2.2A.2.1). The PEI and TAI List fields may be
populated as well, see clause 7.6.2.4 for details.
In the case of ongoing updates, the presence of the AssociationEndTime
indicates the SUPI to 5G-GUTI identity disassociation. Such updates shall only
happen when no new association is replacing the outgoing one.
The DeliveryObject Reference field (see ETSI TS 103 120 [6] clause 10.2.1)
shall be set to the Reference of the LDTaskObject used in the request, to
provide correlation between request and response. The DeliveryID,
SequenceNumber and LastSequence fields shall be set according to ETSI TS 103
120 [6] clause 10.2.1.
The content manifest (see ETSI TS 103 120 [6] clause 10.2.2) shall be set to
indicate the present document, using the following Specification Dictionary
extension.
Table 5.7.2-6: Specification Dictionary
Dictionary Owner Dictionary Name
* * *
3GPP ManifestSpecification.
Defined DictionaryEntries  
Value Meaning LIHIQRResponse The delivery contains IdentityResponseDetails
(see Annex E)
## 5.8 Protocols for LI_XQR
### 5.8.1 General
LI_XQR requests are realised using TS 103 221-1 [7] to transport the
IdentityAssociationRequest and IdentityAssociationResponse messages (which are
derived from the X1RequestMessage and X1ResponseMessage definitions in TS 103
221-1 [7]) as described in Annex E.
NOTE: The terms identifier and identity are used interchangeably in clause
5.8.
### 5.8.2 Identity association requests
For requests with RequestType \"IdentityAssociation\" (see Table 5.7.2-3), the
IQF issues an IdentityAssociationRequest message populated with a
RequestDetails structure as follows.
Table 5.8-1: RequestDetails structure for LI_XQR
* * *
ETSI TS 103 221-1 [7] field name Description M/C/O Type Shall be set to the
RequestType value \"IdentityAssociation\" as defined in Table 5.7.2-3. M
ObservedTime Observation time as provided over LI_HIQR (see clause 5.7.2) M
RequestValues Set to the target identifier plus additional information
specified in the LI_HIQR request (see clause 5.7.2) M
* * *
Successful LI_XQR responses are returned using the IdentityAssociationResponse
message. Error conditions are reported using the normal error reporting
mechanisms described in TS 103 221-1 [7].
LI_XQR query responses are represented in XML following the
IdentityAssociationResponse schema (see Annex E). The fields of the
IdentityAssociationResponse record shall be populated as described in Table
5.7.2-5.
### 5.8.3 Ongoing identity association requests
For requests with RequestType \"OngoingIdentityAssociation\", the IQF shall
activate a request for ongoing updates at the ICF by sending it an
ActivateAssociationUpdates message populated as follows:
Table 5.8-2: ActivateAssociationUpdates message for LI_XQR
* * *
Field name Description M/C/O OngoingAssociationTaskID Unique identifier for
this request allocated by the IQF M SUPI Permanent identifier for which
ongoing identity association updates shall be issued. M
* * *
The ICF shall acknowledge the receipt of the ActivateAssociationUpdates
message by responding with an ActivateAssociationUpdatesAcknowledgement
response (see Annex E) containing an IdentityAssociationRecord representing
the association active at the time the ICF receives the
ActivateAssociationUpdates message. If no such active association exists, the
ActivateAssociationUpdatesAcknowledgement response shall not contain an
IdentityAssociationRecord. Error conditions are reported using the normal
error reporting mechanisms described in ETSI TS 103 221-1 [7].
When a request with RequestType \"OngoingIdentityAssociation\" is terminated
over LI_HIQR (see Table 5.7.2-3), the IQF shall issue a
DeactivateAssociationUpdates message (see Annex E) with the appropriate
OngoingAssociationTaskID populated. On termination of the request, the ICF
shall respond with a DeactivateAssociationUpdatesAcknowledgement message.
While a request with RequestType \"OngoingIdentityAssociation\" is active, the
ICF shall generate an IdentityAssociationUpdate message every time the ICF
receives an IEFAssociationRecord or IEFDeassociationRecord over LI_IEF for the
relevant identifier. The message shall contain an IdentityAssociationRecord as
described in Table 5.7.2-5, and the relevant OngoingAssociationTaskID. The
IdentityAssociationUpdate message is sent to the IQF over LI_XQR with the ICF
becoming the \"requester\" as defined in ETSI TS 103 221-1 [7] clause 4.2. The
IQF shall respond with an IdentityAssociationUpdateAcknowledgement message.
## 5.9 Protocols for LI_XER
LI_XER records are realised using a TLS connection as defined in clause
6.2.2A.2.3, with records BER-encoded as defined in Annex F.
## 5.10 Protocols for LI_ST interface
### 5.10.1 Overview
LI_ST shall be realised using a dedicated separate instance of the
Nudsf_DataRepository service as defined in TS 29.598 [50] subject to the
following terms.
The LISSF shall adopt the role of the NF Service Provider as described in TS
29.598 [50] clause 5.2.1. The LISSF may be realised as a standalone function
or within the ADMF. In either case it shall meet the requirements set out in
TS 33.127 [5] clause 6.2.3.8.
An LI function may only store state over LI_ST using an LISSF identified by
the LIPF via LI_X0. The LIPF shall provide the necessary details for
connection, including the relevant apiRoot, apiVersion, realmId and storageId
values (see TS 29.598 [50] clause 6.1.3.1) and any necessary keys for
authentication.
### 5.10.2 Storage
When an LI function wishes to store LI state in the LISSF, it shall perform
the Record Create service operation as described in TS 29.598 [50] clause
5.2.2.3.1. Unless otherwise specified, the recordId shall be a randomly-
assigned UUID. The record metadata shall include at least the following
information as tag value pairs (see TS 29.598 [50] clause 6.1.6.2.3)
Table 5.10.2-1: Minimum information elements for RecordMeta structure
* * *
Field Name Description M/C/O NFInstanceID The NF instance ID associated with
the NF in which the LI function is located, if applicable (see TS 29.571 [17]
clause 5.3.2). C NEID The LI_X1 identifier associated with the LI function. M
XID XID for the task that the state is associated with, if applicable. C DID
DID for the destination that the state is associated with, if applicable. C
* * *
Further details on the contents of the Record Blocks is given in the relevant
clauses.
The LIPF shall always be able to store records in the LISSF.
### 5.10.3 Retrieval
When an LI function wishes to retrieve records from the LISSF and knows the
RecordID of the relevant state information, it shall perform a Record
Retrieval operation as described in TS 29.598 [50] clause 5.2.2.2.2. If the LI
function does not know the RecordID, it shall perform a search as described in
TS 29.598 [50] clause 5.2.2.2.6 using appropriate search criteria. The details
for choosing search criteria are specific to each LI function and are
therefore given in later clauses specific to that LI function.
The LIPF shall always be able to retrieve records from the LISSF.
### 5.10.4 Removal
When an LI function wishes to remove records from the LISSF, it shall perform
a Record Delete service operation as described in TS 29.598 [50] clause
5.2.2.5.
The LIPF shall always be able to remove records from the LISSF.
# 6 Network Layer Based Interception
## 6.1 Introduction
This clause describes any remaining fields, behaviours or details necessary to
implement the required LI interfaces for specific 3GPP-defined network
deployments which are not described in clauses 4 and 5.
## 6.2 5G
### 6.2.1 General
This clause describes the LI interfaces specific to LI for 5G networks.
### 6.2.2 LI at AMF
#### 6.2.2.1 Provisioning over LI_X1
The IRI-POI present in the AMF is provisioned over LI_X1 by the LIPF using the
X1 protocol as described in clause 5.2.2.
The POI in the AMF shall support the following target identifier formats in
the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is
not used):
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
Table 6.2.2-0A shows the minimum details of the LI_X1 ActivateTask message
used for provisioning the IRI-POI in the AMF.
Table 6.2.2-0A: ActivateTask message for the IRI-POI in the AMF
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One of the target | M | | | identifiers listed in the | | | | paragraph above. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to \"X2Only\". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI_X2 for the IRI-POI in | | | | the AMF. These delivery | | | | endpoints are configured | | | | using the CreateDestination | | | | message as described in | | | | ETSI TS 103 221-1 [7] | | | | clause 6.3.1 prior to the | | | | task activation. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | This field shall be | C | | | included if the IRI POI is | | | Iden | required to generate | | | tifierAssociationExtensions | AMFIdentifierAssociation | | | | records (see clause | | | | 6.2.2.2.1). If the field is | | | | absent, | | | | AMFIdentifierAssociation | | | | records shall not be | | | | generated. | | +-----------------------------+-----------------------------+-------+
Table 6.2.2-0B: IdentifierAssociationExtensions Parameters
+-----------------+------------------------------------------+-------+ | Field Name | Description | M/C/O | +-----------------+------------------------------------------+-------+ | EventsGenerated | One of the following values: | M | | | | | | | - IdentifierAssociation | | | | | | | | - All | | | | | | | | See clause 6.2.2.2.1 for the | | | | interpretation of this field. | | +-----------------+------------------------------------------+-------+
#### 6.2.2.2 Generation of xIRI over LI_X2
##### 6.2.2.2.1 General
The IRI-POI present in the AMF shall send the xIRIs over LI_X2 for each of the
events listed in TS 33.127 [5] clause 6.2.2.4, the details of which are
described in the following sub-clauses.
If the AMF receives one or more cell IDs in an N2 message (as specified in TS
38.413 [23]), the POI associated with the AMF shall report all of them.
The IRI-POI in the AMF shall only generate xIRI containing
AMFIdentifierAssociation records when the IdentifierAssocationExtensions
parameter has been received over LI_X1 (see clause 6.2.2.1). If the
IdentifierAssocationExtensions parameter is not received for a specific target
the IRI-POI shall not generate AMFIdentifierAssociation records for that
target. The AMF shall generate records according to the value of the
EventsGenerated sub-parameter (see Table 6.2.2-0B) as follows:
\- IdentifierAssociation: AMFIdentifierAssociation and AMFLocationUpdate
records shall be generated. No other record types shall be generated for that
target.
\- All: All AMF record types shall be generated.
##### 6.2.2.2.2 Registration
The IRI-POI in the AMF shall generate an xIRI containing an AMFRegistration
record when the IRI-POI present in the AMF detects that a UE matching one of
the target identifiers provided via LI_X1 has successfully registered to the
5GS via 3GPP NG-RAN or non-3GPP access. Accordingly, the IRI-POI in the AMF
generates the xIRI when the following event is detected:
\- AMF sends a N1: REGISTRATION ACCEPT message to the target UE and the UE 5G
Mobility Management (5GMM) state for the access type (3GPP NG-RAN or non-3GPP
access) within the AMF is changed to 5GMM-REGISTERED.
Table 6.2.2-1: Payload for AMFRegistration record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | registrationType | Specifies the type of | M | | | registration, see TS 24.501 | | | | [13] clause 9.11.3.7. | | | | This is derived from the | | | | information received from | | | | the UE in the REGISTRATION | | | | REQUEST message. | | +-----------------------------+-----------------------------+-------+ | registrationResult | Specifies the result of | M | | | registration, see TS 24.501 | | | | [13] clause 9.11.3.6. | | +-----------------------------+-----------------------------+-------+ | slice | Provide, if available, one | C | | | or more of the following: | | | | | | | | - allowed NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.37). | | | | | | | | - configured NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.37), | | | | | | | | - rejected NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.46). | | | | | | | | This is derived from the | | | | information sent to the UE | | | | in the REGISTRATION ACCEPT | | | | message. | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | M | | | registration (see clause | | | | 6.2.2.4). | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI used in the | C | | | registration, if available. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI provided by the UE | C | | | during the registration, if | | | | available. | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI obtained in the | C | | | registration, if available | | | | as part of the subscription | | | | profile. | | +-----------------------------+-----------------------------+-------+ | gUTI | 5G-GUTI provided as outcome | M | | | of initial registration or | | | | used in other cases, see TS | | | | 24.501 [13] clause | | | | 5.5.1.2.2. | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | determined by the network | | | | during the registration, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >l | | | | ocationInfo>userLocation_) | | | | and, when Dual Connectivity | | | | is activated, as an | | | | _additionalCellIDs_ | | | | parameter | | | | (_location >locatio | | | | nInfo>additionalCellIDs_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +-----------------------------+-----------------------------+-------+ | fiveGSTAIList | List of tracking areas | C | | | associated with the | | | | registration area within | | | | which the UE is current | | | | registered, see TS 24.501 | | | | [13], clause 9.11.3.9 | | | | (see NOTE) | | +-----------------------------+-----------------------------+-------+ | NOTE: List shall be | | | | included each time there is | | | | a change to the | | | | registration area. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.2.2.3 Deregistration
The IRI-POI in the AMF shall generate an xIRI containing an AMFDeregistration
record when the IRI-POI present in the AMF detects that a UE matching one of
the target identifiers provided via LI_X1 has deregistered from the 5GS.
Accordingly, the IRI-POI in AMF generates the xIRI when any of the following
events is detected:
> \- For network initiated de-registration, when the AMF receives the N1:
> DEREGISTRATION ACCEPT message from the target UE or when implicit
> deregistration timer expires; and in both cases the UE 5GMN state for the
> access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to
> 5GMM-DEREGISTERED.
>
> \- For UE initiated de-registration, when the AMF sends the N1:
> DEREGISTRATION ACCEPT message to the target UE or when the AMF receives the
> N1: DEREGISTRATION REQUEST message from the target UE with deregistration
> type value of "switch off"; and in both cases the UE 5GMN state for the
> access type (3GPP NG-RAN or non-3GPP access) within the AMF is changed to
> 5GMM-DEREGISTERED.
Table 6.2.2-2: Payload for AMFDeregistration record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | deregistrationDirection | Indicates whether the | M | | | deregistration was | | | | initiated by the network or | | | | by the UE. | | +-----------------------------+-----------------------------+-------+ | accessType | Indicates the access for | M | | | which the deregistration is | | | | handled, see TS 24.501 | | | | [13], clause 9.11.3.20. | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | deregistration (see clause | | | | 6.2.2.4), if available. | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI used in the | C | | | deregistration, if | | | | available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pEI | PEI used in the | C | | | deregistration, if | | | | available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI associated to the | C | | | deregistration, if | | | | available as part of the | | | | subscription profile. | | +-----------------------------+-----------------------------+-------+ | gUTI | 5G-GUTI used in the | C | | | deregistration, if | | | | available, see TS 24.501 | | | | [13], clause 5.5.2.2.1 | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | cause | Indicates the 5GMM cause | C | | | value for network-initiated | | | | deregistration, see TS | | | | 24.501 [13], clause | | | | 9.11.3.2. | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | determined by the network | | | | during the deregistration, | | | | if available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one among | | | | SUCI, PEI and GUTI shall be | | | | provided. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.2.2.4 Location update
The IRI-POI in the AMF shall generate an xIRI containing an AMFLocationUpdate
record each time the IRI-POI present in an AMF detects that the target's UE
location is updated due to target's UE mobility or as a part of an AMF service
procedure and the reporting of location information is not restricted by
service scoping. The generation of such separate xIRI is not required if the
updated UE location information is obtained as a part of a procedure producing
some other xIRIs (e.g. mobility registration). In that case the location
information is included into the respective xIRI.
The UE mobility events resulting in generation of an AMFLocationUpdate xIRI
include the _N2 Path Switch Request_ (_Xn based inter NG-RAN handover_
procedure described in 3GPP TS 23.502 [4], clause 4.9.1.2) and the _N2
Handover Notify_ (_Inter NG-RAN node N2 based handover_ procedure described in
3GPP TS 23.502 [4], clause 4.9.1.3).
The AMFLocationUpdate xIRI is also generated when the AMF receives an NG-RAN
NGAP _PDU Session Resource Modify Indication_ message as a result of Dual
Connectivity activation/release for the target\'s UE, as described in 3GPP TS
37.340 [37], clause 10.
Optionally, based on operator policy, other NG-RAN NGAP messages that do not
generate separate xIRI but carry location information (e.g. RRC INACTIVE
TRANSITION REPORT) may trigger the generation of an xIRI AMFLocationUpdate
record.
Additionally, based on regulatory requirements and operator policy, the
location information obtained by AMF from NG-RAN or LMF in the course of some
service operation (e.g. emergency services, LCS) may generate xIRI
AMFLocationUpdate record. The AMF services providing the location information
in these cases include the AMF Location Service (ProvideLocInfo,
ProvidePosInfo, NotifiedPosInfo and EventNotify service operations) and the
AMF Exposure Service (AmfEventReport with LOCATION_REPORT) (see TS 29.518
[22]). Additionally, the AMF Communication Service
(Namf_Communication_N1MessageNotify service operation) may be monitored to
capture the location information in the scenarios described in TS 23.273 [42],
clause 6.3.1. Also, in the case of Mobile Originated LCS service invoked by
the target, the location information may be derived from a
Nlmf_Location_DetermineLocation Response to AMF (see TS 23.273 [42], clause
6.2).
Table 6.2.2-3: Payload for AMFLocationUpdate record
+------------+-----------------------------------------------+-------+ | Field name | Description | M/C/O | +------------+-----------------------------------------------+-------+ | sUPI | SUPI associated with the location update (see | M | | | clause 6.2.2.4). | | +------------+-----------------------------------------------+-------+ | sUCI | SUCI associated with the location update, if | C | | | available, see TS 24.501 [13]. | | +------------+-----------------------------------------------+-------+ | pEI | PEI associated with the location update, if | C | | | available. | | +------------+-----------------------------------------------+-------+ | gPSI | GPSI associated with the location update, if | C | | | available as part of the subscription | | | | profile. | | +------------+-----------------------------------------------+-------+ | gUTI | 5G-GUTI associated with the location update, | C | | | if available, see TS 24.501 [13]. | | +------------+-----------------------------------------------+-------+ | location | Updated location information determined by | M | | | the network. | | | | | | | | Depending on the service or message type from | | | | which the location information is extracted, | | | | it may be encoded in several forms (Annex A): | | | | | | | | 1) as a _userLocation_ parameter | | | | (_location >locationInfo>userLocation_) in | | | | the case the information is obtained from an | | | | NGAP message, except the LOCATION REPORT | | | | message (see TS 38.413 [23]); | | | | | | | | 2) as a _locationInfo_ parameter | | | | (_location >locationInfo_) in the case the | | | | information is obtained from a | | | | **ProvideLocInfo** (TS 29.518 [22], clause | | | | 6.4.6.2.6); | | | | | | | | 3) as a _locationPresenceReport_ parameter | | | | (_location >locationPresenceReport_) in the | | | | case the information is obtained from an | | | | **AmfEventReport** (TS 29.518 [22], clause | | | | 6.2.6.2.5) with event type | | | | **Location-Report** or | | | | **Presence-In-AOI-Report;** | | | | | | | | 4) as a _positionInfo_ parameter | | | | (_location >positioningInfo>positionInfo_) | | | | in the case the information is obtained from | | | | a **ProvidePosInfo** (TS 29.518 [22], | | | | clause 6.4.6.2.3) or a **NotifiedPosInfo** | | | | (TS 29.518 [22], clause 6.4.6.2.4). | | +------------+-----------------------------------------------+-------+
##### 6.2.2.2.5 Start of interception with registered UE
The IRI-POI in the AMF shall generate an xIRI containing an
AMFStartOfInterceptionWithRegisteredUE record when the IRI-POI present in the
AMF detects that interception is activated on a UE that has already been
registered in the 5GS (see clause 6.2.2.4 on identity privacy). A UE is
considered already registered to the 5GS when the 5GMM state for the access
type (3GPP NG-RAN or non-3GPP access) for that UE is 5GMM-REGISTERED.
Therefore, the IRI-POI present in the AMF shall generate the xIRI
AMFStartOfInterceptionWithRegisteredUE record when it detects that a new
interception for a UE is activated (i.e. provisioned by the LIPF) and the 5G
mobility management state for the access type (3GPP NG-RAN or non-3GPP access)
within the AMF for that UE is 5GMM-REGISTERED. If the UE is registered over
both 3GPP NG-RAN and non-3GPP access, the IRI-POI present in the AMF shall
generate an xIRI containing an AMFStartOfInterceptionWithRegisteredUE record
for each access type.
Table 6.2.2-4: Payload for AMFStartOfInterceptionWithRegisteredUE record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | registrationResult | Specifies the result of | M | | | registration, see TS 24.501 | | | | [13], clause 9.11.3.6. | | +-----------------------------+-----------------------------+-------+ | registrationType | Specifies the type of | C | | | registration, see TS 24.501 | | | | [13] clause 9.11.3.7, if | | | | available. | | +-----------------------------+-----------------------------+-------+ | slice | Provide, if available, one | C | | | or more of the following: | | | | | | | | - allowed NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.37). | | | | | | | | - configured NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.37). | | | | | | | | - rejected NSSAI (see TS | | | | 24.501 [13] clause | | | | 9.11.3.46). | | | | | | | | This is derived from the | | | | information that was sent | | | | to the UE in the | | | | REGISTRATION ACCEPT | | | | message. IRI-POI in AMF can | | | | include this information if | | | | and only if it retained the | | | | information that it had | | | | previously sent in the | | | | REGISTRATION ACCEPT message | | | | to the UE. | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | M | | | registration (see clause | | | | 6.2.2.4). | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI used in the | C | | | registration, if available. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI provided by the UE | C | | | during the registration, if | | | | available. | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI obtained in the | C | | | registration, if available | | | | as part of the subscription | | | | profile. | | +-----------------------------+-----------------------------+-------+ | gUTI | 5G-GUTI provided as outcome | M | | | of initial registration or | | | | used in other cases, see TS | | | | 24.501 [13], clause | | | | 5.5.1.2.2. | | +-----------------------------+-----------------------------+-------+ | location | Location information, if | C | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >l | | | | ocationInfo>userLocation_) | | | | and, when Dual Connectivity | | | | is activated, as an | | | | _additionalCellIDs_ | | | | parameter | | | | (_location >locatio | | | | nInfo>additionalCellIDs)_, | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +-----------------------------+-----------------------------+-------+ | timeOfRegistration | Time at which the last | C | | | registration occurred, if | | | | available. This is the time | | | | stamp when the REGISTRATION | | | | ACCEPT message is sent to | | | | the UE or (when applicable) | | | | when the REGISTRATION | | | | COMPLETE is received from | | | | the UE. | | | | | | | | Shall be given qualified | | | | with time zone information | | | | (i.e. as UTC or offset from | | | | UTC, not as local time). | | +-----------------------------+-----------------------------+-------+ | fiveGSTAIList | List of tracking areas | C | | | associated with the | | | | registration area within | | | | which the UE is current | | | | registered, see TS 24.501 | | | | [13], clause 9.11.3.9 | | | | (see NOTE) | | +-----------------------------+-----------------------------+-------+ | NOTE: List shall be | | | | included each time there is | | | | a change to the | | | | registration area. | | | +-----------------------------+-----------------------------+-------+
The IRI-POI present in the AMF generating an xIRI containing an
AMFStartOfInterceptionWithRegisteredUE record shall set the Payload Direction
field in the PDU header to _not applicable_ (see ETSI TS 103 221-2 [8] clause
5.2.6).
##### 6.2.2.2.6 AMF unsuccessful procedure
The IRI-POI in the AMF shall generate an xIRI containing an
AMFUnsuccessfulProcedure record when the IRI-POI present in the AMF detects an
unsuccessful procedure for a UE matching one of the target identifiers
provided via LI_X1.
Accordingly, the IRI-POI in the AMF generates the xIRI when any of the
following events is detected:
\- AMF sends a N1: REGISTRATION REJECT message to the target UE and the UE 5G
Mobility Management (5GMM) state for the access type (3GPP NG-RAN or non-3GPP
access) within the AMF is changed to 5GMM-DEREGISTERED.
\- AMF aborts a registration procedure before the UE 5G Mobility Management
(5GMM) state for the access type (3GPP NG-RAN or non-3GPP access) within the
AMF is changed to 5GMM-REGISTERED.
\- AMF sends a SERVICE REJECT message to the target UE including a PDU session
establishment reject message type.
\- AMF aborts a UE-initiated NAS transport procedure with payload container
type IE set to \"SMS\".
Unsuccessful registration shall be reported only if the target UE has been
successfully authenticated.
Table 6.2.2-5: Payload for AMFUnsuccessfulProcedure record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | failedprocedureType | Specifies the procedure | M | | | which failed at the AMF. | | +-----------------------------+-----------------------------+-------+ | failureCause | Provides the value of the | M | | | 5GSM or 5GMM cause, see TS | | | | 24.501 [13], clauses | | | | 9.11.3.2 and 9.11.4.2. | | +-----------------------------+-----------------------------+-------+ | requestedSlice | Slice requested for the | C | | | procedure, if available, | | | | given as a NSSAI (a list of | | | | S-NSSAI values as described | | | | in TS 24.501 [13] clause | | | | 9.11.3.37). | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | procedure, if available | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI used in the procedure, | C | | | if applicable and if | | | | available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pEI | PEI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gUTI | 5G-GUTI used in the | C | | | procedure, if available, | | | | see TS 24.501 [13], | | | | clause 9.11.3.4 (see NOTE). | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | determined during the | | | | procedure, if available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one identity | | | | shall be provided, the | | | | others shall be provided if | | | | available. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.2.2.7 AMF identifier association
The IRI-POI present in the AMF shall generate an xIRI containing an
AMFIdentifierAssociation record when the IRI-POI present in the AMF detects a
new identifier association for a UE matching one of the target identifiers
provided via LI_X1. Generation of this record is subject to this record type
being enabled for a specific target (see clause 6.2.2.2.1).
Table 6.2.2-6: Payload for AMFIdentifierAssociation record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | sUPI | SUPI associated with the | M | | | procedure (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI used in the procedure, | C | | | if applicable and if | | | | available. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI used in the procedure, | C | | | if available (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI used in the procedure, | C | | | if available (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | gUTI | 5G-GUTI used in the | M | | | procedure, see TS 24.501 | | | | [13], clause 9.11.3.4. | | +-----------------------------+-----------------------------+-------+ | location | Location information | M | | | available when identifier | | | | association occurs. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >l | | | | ocationInfo>userLocation_) | | | | and, when Dual Connectivity | | | | is activated, as an | | | | _additionalCellIDs_ | | | | parameter | | | | (_location >locatio | | | | nInfo>additionalCellIDs_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | fiveGSTAIList | List of tracking areas | C | | | associated with the | | | | registration area within | | | | which the UE is current | | | | registered, see TS 24.501 | | | | [13], clause 9.11.3.9. | | | | (See NOTE 2) | | +-----------------------------+-----------------------------+-------+ | NOTE 1: SUPI shall always | | | | be provided, in addition to | | | | the warrant target | | | | identifier if different to | | | | SUPI. Other identifiers | | | | shall be provided if | | | | available. | | | | | | | | NOTE 2: List shall be | | | | included each time there is | | | | a change to the | | | | registration area. | | | +-----------------------------+-----------------------------+-------+
#### 6.2.2.3 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in AMF, the MDF2 shall
generate the corresponding IRI message and deliver over LI_HI2 without undue
delay. The IRI message shall contain a copy of the relevant record received in
the xIRI over LI_X2. This record may be enriched with any additional
information available at the MDF (e.g. additional location information).
The timestamp field of the psHeader structure shall be set to the time at
which the AMF event was observed (i.e. the timestamp field of the X2 PDU).
Table 6.2.2-7 shows the IRI type (see ETSI TS 102 232-1 [9] clause 5.2.10) to
be used for each IRI message.
Table 6.2.2-7: IRI type for IRI messages
IRI message IRI type
* * *
AMFRegistration REPORT AMFDeregistration REPORT AMFLocationUpdate REPORT
AMFStartOfInterceptionWithRegisteredUE REPORT AMFUnsuccessfulProcedure REPORT
AMFIdentifierAssociation REPORT
These IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause
5.2.4).
The threeGPP33128DefinedIRI field in ETSI TS 102 232-7 [10] clause 15 shall be
populated with the BER-encoded IRIPayload.
When an additional warrant is activated on a target UE and the LIPF uses the
same XID for the additional warrant, the MDF2 shall be able to generate and
deliver the IRI message containing the AMFStartOfInterceptionWithRegisteredUE
record to the LEMF associated with the additional warrant without receiving a
corresponding xIRI. The payload of the AMFStartOfInterceptionWithRegisteredUE
record is specified in table 6.2.2-4.
If the MDF2 did not receive from the IRI-POI the value of timeOfRegistration
parameter in a previous corresponding AMFStartOfInterceptionWithRegisteredUE
for the same registration, the MDF2 shall include in that parameter the time
provided in the timestamp previously received in the header of the related
AMFRegistration xIRI.
#### 6.2.2.4 Identity privacy
The AMF shall ensure for every registration (including re-registration) that
SUPI has been provided by the UDM to the AMF and that the SUCI to SUPI mapping
has been verified as defined in TS 33.501 [11]. This shall be performed
regardless of whether the SUPI is a target of interception, and whether the
null encryption algorithm is used for the SUCI. The AMF shall maintain the
SUPI to SUCI mapping for at least the lifetime of the registration in order to
allow interception based on SUPI after the initial registration.
### 6.2.2A Identifier Reporting for AMF
#### 6.2.2A.1 Activation of reporting over LI_XEM1
The IEF in the AMF is activated and deactivated over LI_XEM1 by the LIPF using
the LI_XEM1 protocol described in clause 5.2.7.
NOTE: Since the IEF reports association events for all UEs registered in the
IEF's parent AMF, unlike POIs there is no concept of provisioning an IEF with
target identifiers.
Upon receiving a valid activate task message over LI_XEM1, the IEF shall start
generating records as defined in clause 6.2.2A.2.
Upon receiving a valid deactivate task message over LI_XEM1, the IEF shall
stop generating records as defined in clause 6.2.2A.2.
#### 6.2.2A.2 Generation of records over LI_XER
6.2.2A.2.1 Events
The IEF in the AMF shall generate an IEFIdentifierAssociation record whenever
the IEF present in the AMF detects a change in association between a SUPI and
a 5G-GUTI for any UE registered with the AMF. The IEF shall send the
IEFIdentifierAssociation records to the ICF over LI_XER as defined in clause
5.9.
Accordingly, the IEF in the AMF generates IEFIdentifierAssociation records
when any of the following events are detected:
\- IEFAssociationRecord: Association of a 5G-GUTI to a SUPI, (this may also
include SUCI to SUPI association).
\- IEFDeassociationRecord: De-association of a 5G-GUTI from a SUPI.
NOTE1: The de-association of 5G-GUTI from a SUPI event record is only
generated if a new 5G-GUTI is not allocated to a SUPI to update a previous
association (e.g. at inter-AMF handover).
NOTE 2: As SUCIs are single use and only valid for a single authentication,
they are only be valid at the single point in time when the association event
is detected and reported to the ICF by the IEF.
In addition, when an IEF is activated as per clause 6.2.2A.1, the IEF shall
generate associations event for all SUPIs which are registered in the AMF,
where those identifier associations allocated prior to IEF activation remain
current and are still available in the AMF (See NOTE 2).
NOTE 3: Only identifier associations which have been maintained by the AMF as
part of normal network operations will be available.
In the case where the IEF in the AMF detects that a REGISTRATION ACCEPT
message or a CONFIGURATION UPDATE (5G-GUTI) message as defined in TS 24.501
[13] has been sent by the AMF towards a UE, the IEF shall immediately generate
an IEFIdentifierAssociation record. This record shall be generated regardless
of whether the CONFIGURATION UPDATE (5G-GUTI) or REGISTRATION ACCEPT procedure
is subsequently successfully completed or not.
##### 6.2.2A.2.2 Association Events
For each association event, the IEF shall create an IEFAssociationRecord, as
defined below.
Table 6.2.2A-1: Payload for IEFAssociationRecord
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | sUPI | SUPI associated with | M | | | detected association event. | | +-----------------------------+-----------------------------+-------+ | fiveGGUTI | 5G-GUTI shall be provided. | M | | | Encoded as per TS 24.501 | | | | [13] figure 9.11.3.4.1, | | | | omitting the first four | | | | octets. | | +-----------------------------+-----------------------------+-------+ | timeStamp | Time at which the | M | | | identifier association | | | | event occurred. | | | | | | | | Shall be given qualified | | | | with time zone information | | | | (i.e. as UTC or offset from | | | | UTC, not as local time). | | +-----------------------------+-----------------------------+-------+ | tAI | Last known TAI associated | M | | | with the SUPI. Encoded as | | | | per TS 24.501 [13] clause | | | | 9.11.3.8, omitting the | | | | first octet. | | +-----------------------------+-----------------------------+-------+ | nCGI | Last known nCGI(s) | M | | | available when identifier | | | | association event detected. | | | | Given as a sequence of | | | | PLMNID (encoded as per TS | | | | 38.413 [23] clause | | | | 9.3.3.5) and NCI (encoded | | | | as per TS 38.413 [23] | | | | clause 9.3.1.7). | | +-----------------------------+-----------------------------+-------+ | nCGITime | ueLocationTimestamp(s) of | M | | | nCGIs if available in AMF | | | | as per TS 29.571 [17] | | | | clause 5.4.4.9. | | | | | | | | If ueLocationTimestamp(s) | | | | is not available, shall be | | | | populated with timeStamp(s) | | | | of when last known nCGI(s), | | | | were obtained and stored by | | | | the AMF. | | +-----------------------------+-----------------------------+-------+ | sUCI | SUCI shall be provided when | C | | | event is triggered by | | | | association of a SUCI to a | | | | SUPI. Encoded as per TS | | | | 24.501 [13] clause | | | | 9.11.3.4, omitting the | | | | first 3 octets. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI, (See NOTE 1). | C | +-----------------------------+-----------------------------+-------+ | fiveGSTAIList | List of tracking areas | C | | | associated with the | | | | registration area within | | | | which the UE is current | | | | registered, see TS 24.501 | | | | [13], clause 9.11.3.9. | | | | (See NOTE 2) | | +-----------------------------+-----------------------------+-------+ | NOTE 1: Shall be provided | | | | in first association record | | | | to ICF after PEI is | | | | available and following any | | | | change of PEI. | | | | | | | | NOTE 2: As a minimum, list | | | | of tracking areas shall be | | | | included in the first | | | | association event for each | | | | SUPI registered (per UE | | | | session) with the AMF and | | | | additionally whenever the | | | | TAI list changes due to a | | | | change in registration | | | | area. | | | +-----------------------------+-----------------------------+-------+
For each de-association event, the IEF shall create an IEFDeassociationRecord,
as defined below.
**Table 6.2.2A-2: Payload for IEFDeassociationRecord**
+----------------+---------------------------------------+-----------+ | **Field name** | **Description** | **M/C/O** | +================+=======================================+===========+ | sUPI | SUPI associated with detected | M | | | de-association event. | | +----------------+---------------------------------------+-----------+ | fiveGGUTI | 5G-GUTI shall be provided. Encoded as | M | | | per TS 24.501 [13] figure | | | | 9.11.3.4.1, omitting the first four | | | | octets. | | +----------------+---------------------------------------+-----------+ | timeStamp | Time at which the identifier | M | | | de-association event occurred. | | | | | | | | Shall be given qualified with time | | | | zone information (i.e. as UTC or | | | | offset from UTC, not as local time). | | +----------------+---------------------------------------+-----------+ | nCGI | Last known nCGI(s) available when | M | | | identifier de-association event | | | | detected. Given as a sequence of | | | | PLMNID (encoded as per TS 38.413 | | | | [23] clause 9.3.3.5) and NCI | | | | (encoded as per TS 38.413 [23] | | | | clause 9.3.1.7) | | +----------------+---------------------------------------+-----------+ | nCGITime | ueLocationTimestamp(s) of nCGIs if | M | | | available in AMF as per TS 29 .571 | | | | [17] clause 5.4.4.9. | | | | | | | | If ueLocationTimestamp(s) is not | | | | available, shall be populated with | | | | timeStamp(s) of when last known | | | | nCGI(s), were obtained and stored by | | | | the AMF. | | +----------------+---------------------------------------+-----------+
##### 6.2.2A.2.3 Transmission to the ICF
When activated (see clause 5.2.7), the IEF shall establish a TLS connection to
the ICF as given over LI_XEM1. If the IEF fails to establish a TLS connection,
it shall report an error over LI_XEM1 using the error reporting mechanisms
described in TS 103 221-1 [7], and attempt to reconnect after a configurable
period of time.
When a record has been generated as described in clause 6.2.2A.2.2, the IEF
shall encode the IEFAssociationRecord or IEFDeassociationRecord as a BER-
encoded IEFMessage structure, following the ASN.1 schema given in Annex F, and
transmit it to the ICF over the established TLS connection.
The IEF may transmit a keepalive request using the keepalive record defined in
Annex F. Upon receiving a keepalive request, the ICF shall respond with a
keepaliveResponse record containing the same sequence number used in the
request. The circumstances under which the IEF transmits keepalive requests is
out of scope of the present document.
### 6.2.3 LI for SMF/UPF
#### 6.2.3.1 Provisioning over LI_X1
##### 6.2.3.1.1 General
If the warrant is for IRI and CC, then the IRI-POI and the CC-TF in the SMF
shall be provisioned in accordance with clause 6.2.3.1.2, the MDF2 shall be
provisioned in accordance with clause 6.2.3.1.3, and the MDF3 shall be
provisioned in accordance with clause 6.2.3.1.4.
If the warrant is for IRI only, the IRI-POI in the SMF shall be provisioned in
accordance with clause 6.2.3.1.2 and the MDF2 shall be provisioned in
accordance with clause 6.2.3.1.3.
If approach 1 described in clause 6.2.3.9 is used for packet header reporting,
the IRI-TF in the SMF shall be provisioned in accordance with clause 6.2.3.1.2
and the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3. If
approach 2 described in clause 6.2.3.9 is used for packet header reporting,
the CC-TF in the SMF shall be provisioned in accordance with clause 6.2.3.1.2,
the MDF2 shall be provisioned in accordance with clause 6.2.3.1.3, and the
MDF3 shall be provisioned in accordance with clause 6.2.3.1.4.
##### 6.2.3.1.2 Provisioning of the IRI-POI, IRI-TF and CC-TF in the SMF
The IRI-POI, IRI-TF and CC-TF present in the SMF are provisioned over LI_X1 by
the LIPF using the X1 protocol as described in clause 5.2.2.
The POI/TF in the SMF shall support the following target identifier formats in
the ETSI TS 103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is
not used):
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
Table 6.2.3-0A shows the minimum details of the LI_X1 ActivateTask message
used for provisioning the IRI-POI, in the SMF.
Table 6.2.3-0A: ActivateTask message for SMF IRI-POI, CC-TF and IRI-TF
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. If | M | | | the CC-TF or IRI-TF is also | | | | being tasked for the same | | | | interception, the same XID | | | | shall be used. | | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One or more of the target | M | | | identifiers listed in the | | | | paragraph above. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only", "X3Only" | M | | | or "X2andX3" as needed to | | | | meet the requirements of | | | | the warrant. (NOTE: | | | | \"X2Only\" for IRI-POI, | | | | IRI-TF and \"X3Only\" for | | | | CC-TF can also be also be | | | | used). | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Header reporting-specific | C | | | tag to be carried in the | | | HeaderReporting | _TaskDetailsExtensions_ | | | | field of ETSI TS 103 221-1 | | | | [7]. See Table 6.2.3-10. | | | | This field shall be present | | | | if the packet header | | | | reporting is required. Only | | | | permitted to be sent to the | | | | IRI-TF. | | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints of | M | | | LI_X2 or LI_X3. These | | | | delivery endpoints shall be | | | | configured using the | | | | _CreateDestination_ message | | | | as described in ETSI TS 103 | | | | 221-1 [7] clause 6.3.1 | | | | prior to first use. | | +-----------------------------+-----------------------------+-------+
If packet header reporting is required, parameters specified in table
6.2.3-10: ActivatePDHReporting parameters shall be provided as the
TaskDetailsExtensions/HeaderReporting field of the LI_X1 provisioning message.
##### 6.2.3.1.3 Provisioning of the MDF2
The MDF2 listed as the delivery endpoint for xIRI generated by the IRI-POI in
the SMF or the IRI-POI in the UPF shall be provisioned over LI_X1 by the LIPF
using the X1 protocol as described in clause 5.2.2. Table 6.2.3-0B shows the
minimum details of the LI_X1 ActivateTask message used for provisioning the
MDF2.
The MDF2 shall support the following target identifier formats in the ETSI TS
103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
Table 6.2.3-0B: ActivateTask message for MDF2
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One or more of the target | M | | | identifiers listed in the | | | | paragraph above. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only", "X3Only" | M | | | or "X2andX3" as needed to | | | | meet the requirements of | | | | the warrant. (Ignored by | | | | the MDF2). | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Header reporting-specific | C | | | tag to be carried in the | | | HeaderReporting | _TaskDetailsExtensions_ | | | | field of ETSI TS 103 221-1 | | | | [7]. See Table 6.2.3-10. | | | | This field shall be present | | | | if packet header reporting | | | | is required. | | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints of | M | | | LI_HI2. These delivery | | | | endpoints shall be | | | | configured using the | | | | _CreateDestination_ message | | | | as described in ETSI TS 103 | | | | 221-1 [7] clause 6.3.1 | | | | prior to first use. | | +-----------------------------+-----------------------------+-------+ | ListOfMediationDetails | Sequence of Mediation | M | | | Details, See Table | | | | 6.2.3-0C. | | +-----------------------------+-----------------------------+-------+
Table 6.2.3-0C: Mediation Details for MDF2
* * *
ETSI TS 103 221-1 [7] field name Description M/C/O LIID Lawful Intercept ID
associated with the task. M DeliveryType Set to \"HI2Only\". M ListOfDIDs
Details of where to send the IRI for this LIID. Shall be included if deviation
from the ListofDIDs in the ActivateTask message is necessary. If included, the
ListOfDIDs in the Mediation Details shall be used instead of any delivery
destinations authorised by the ListOfDIDs field in the ActivateTask Message. C
ServiceScoping Shall be included to Identify the service(s) and associated
service-related delivery settings for this LIID. May include more than one
instance of this parameter to allow for different combinations of
subparameters associated with a single LIID. This parameter is defined in ETSI
TS 103 221-1 [7], Annex C, Table C.2. C
* * *
##### 6.2.3.1.4 Provisioning of the MDF3
The MDF3 listed as the delivery endpoint for the xCC generated by the CC-POI
in the UPF shall be provisioned over LI_X1 by the LIPF using the X1 protocol
as described in clause 5.2.2. Table 6.2.3-0D shows the minimum details of the
LI_X1 ActivateTask message used for provisioning the MDF3. If packet header
reporting is authorised and approach 2 described in clause 6.2.3.5 is used,
the endpoint for the MDF3 shall be the MDF2 over LI_MDF.
The MDF3 shall support the following target identifier formats in the ETSI TS
103 221-1 [7] messages (or equivalent if ETSI TS 103 221-1 [7] is not used):
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
Table 6.2.3-0D: ActivateTask message for MDF3
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One or more of the target | M | | | identifiers listed in the | | | | paragraph above. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only", "X3Only" | M | | | or "X2andX3" as needed to | | | | meet the requirements of | | | | the warrant. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Header reporting-specific | C | | | tag to be carried in the | | | HeaderReporting | _TaskDetailsExtensions_ | | | | field of ETSI TS 103 221-1 | | | | [7]. See Table 6.2.3-10. | | | | This field shall be present | | | | if packet header reporting | | | | is required. | | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints of | M | | | LI_HI3 or LI_MDF. These | | | | delivery endpoints shall be | | | | configured using the | | | | _CreateDestination_ message | | | | as described in ETSI TS 103 | | | | 221-1 [7] clause 6.3.1 | | | | prior to first use. | | +-----------------------------+-----------------------------+-------+ | ListOfMediationDetails | Sequence of Mediation | M | | | Details, See Table | | | | 6.2.3-0E. | | +-----------------------------+-----------------------------+-------+
Table 6.2.3-0E: Mediation Details for MDF3
* * *
ETSI TS 103 221-1 [7] field name Description M/C/O LIID Lawful Intercept ID
associated with the task. M DeliveryType Set to \"HI3Only\". M ListOfDIDs
Details of where to send the CC for this LIID. Shall be included if deviation
from the ListofDIDs in the ActivateTask message is necessary. If included, the
ListOfDIDs in the Mediation Details shall be used instead of any delivery
destinations authorised by the ListOfDIDs field in the ActivateTask Message. C
ServiceScoping Shall be included to Identify the service(s) and associated
service-related delivery settings for this LIID. May include more than one
instance of this parameter to allow for different combinations of
subparameters associated with a single LIID. This parameter is defined in ETSI
TS 103 221-1 [7], Annex C, Table C.2. C
* * *
#### 6.2.3.2 Generation of xIRI at IRI-POI in SMF over LI_X2
##### 6.2.3.2.1 General
The IRI-POI present in the SMF shall send the xIRIs over LI_X2 for each of the
events listed in TS 33.127 [5] clause 6.2.3.3, the details of which are
described in the following sub-clauses.
##### 6.2.3.2.2 PDU session establishment
The IRI-POI in the SMF shall generate an xIRI containing an
SMFPDUSessionEstablishment record when the IRI-POI present in the SMF detects
that a PDU session has been established for the target UE. The IRI-POI present
in the SMF shall generate the xIRI for the following events:
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT
ACCEPT to the UE and the 5G Session Management (5GSM) state within the SMF is
changed to PDU SESSION ACTIVE (see TS 24.501 [13]).
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Create response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]).
Table 6.2.3-1: Payload for SMFPDUSessionEstablishment record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See TS | M | | | 24.501 [13] clause 9.4. | | +-----------------------------+-----------------------------+-------+ | gTPTunnelID | Contains the F-TEID | M | | | identifying the GTP tunnel | | | | used to encapsulate the | | | | traffic, as defined in TS | | | | 29.244 [15] clause 8.2.3. | | | | Non-GTP encapsulation is | | | | for further study. | | +-----------------------------+-----------------------------+-------+ | pDUSessionType | Identifies selected PDU | M | | | session type, see TS 24.501 | | | | [13] clause 9.11.4.11. | | +-----------------------------+-----------------------------+-------+ | sNSSAI | Slice identifiers | C | | | associated with the PDU | | | | session, if available. See | | | | TS 23.003 [19] clause | | | | 28.4.2 and TS 23.501 [2] | | | | clause 5.12.2.2. | | +-----------------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. | | +-----------------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | dNN | Data Network Name | M | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003[19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2. Shall | | | | be given in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +-----------------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1 when | | | | available. | | +-----------------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +-----------------------------+-----------------------------+-------+ | requestType | Type of request as | M | | | described in TS 24.501 | | | | [13] clause 9.11.3.47 | | | | provided within the | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | Request (TS 29.502 [16]) | | | | message shall be reported. | | | | | | | | In the case where the | | | | network does not support | | | | Multi Access (MA) PDU | | | | sessions, but receives a MA | | | | PDU session request, a | | | | request type of "Initial | | | | request" shall be reported. | | | | | | | | In the case where the | | | | network does not provide a | | | | request type value for a | | | | non-MA PDU session, a | | | | request type of "initial | | | | request", according to TS | | | | 24.501 [13] clause | | | | 6.4.1.2 shall be reported. | | +-----------------------------+-----------------------------+-------+ | accessType | Access type associated with | C | | | the session (i.e. 3GPP or | | | | non-3GPP access) if | | | | provided by the AMF (see TS | | | | 24.501 [13] clause | | | | 9.11.2.1A). | | +-----------------------------+-----------------------------+-------+ | rATType | RAT Type associated with | C | | | the access if provided by | | | | the AMF as part of session | | | | establishment (see TS | | | | 23.502 [4] clause 4.3.2). | | | | Values given as per TS | | | | 29.571 [17] clause | | | | 5.4.3.2. | | +-----------------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | Request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +-----------------------------+-----------------------------+-------+ | uEEPSPDNConnection | This IE shall be present, | C | | | if available, during an EPS | | | | to 5GS Idle mode mobility | | | | or handover using the N26 | | | | interface. When present, it | | | | shall contain the EPS | | | | bearer context(s) | | | | information present in the | | | | uEEPSPDNConnection | | | | parameter of the | | | | intercepted | | | | SmContextCreateData | | | | message. (see TS 29.502 | | | | [16] clause 6.1.6.2.2). | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one of the | | | | SUPI, PEI or GPSI fields | | | | shall be present. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.3.2.3 PDU session modification
The IRI-POI in the SMF shall generate an xIRI containing an
SMFPDUSessionModification record when the IRI-POI present in the SMF detects
that a PDU session has been modified for the target UE. The IRI-POI present in
the SMF shall generate the xIRI for the following events:
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION
COMPLETE from the UE and the 5GSM state within the SMF is returned to PDU
SESSION ACTIVE (see TS 24.501 [13]). This applies to the following two cases:
\- UE initiated PDU session modification.
\- Network initiated PDU session modification.
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT
ACCEPT to the UE and the 5GSM state within the SMF remains in the PDU SESSION
ACTIVE (see TS 24.501 [13]). This applies to the following case:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP).
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe
IE containing the PDU SESSION MODIFICATION COMPLETE (see TS 29.502 [16]). This
applies to the following three cases:
\- UE initiated PDU session modification.
\- Network (VPLMN) initiated PDU session modification.
\- Network (HPLMN) initiated PDU session modification.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it
had received a N16 Nsmf_PDU_Session_Create Request message with an existing
PDU Session Id with access type being changed. This applies to the following
case:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP) where the V-SMF is used for the PDU session on the new access type
only.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it
had received a N16 Nsmf_PDU_Session_Update Request message with an existing
PDU Session Id with access type being changed. This applies to the following
case:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP) where the same V-SMF is for the PDU session on both access types.
Table 6.2.3-2: Payload for SMFPDUSessionModification record
+-----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions. | | +-----------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI was not authenticated, | | | | or "false" if it has been | | | | authenticated. | | +-----------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available. | | +-----------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available. | | +-----------------------+-----------------------------+-------+ | sNSSAI | Slice identifier associated | C | | | with the PDU session, if | | | | available. See TS 23.003 | | | | [19] clause 28.4.2 and TS | | | | 23.501 [2] clause | | | | 5.12.2.2. | | +-----------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +-----------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------+-----------------------------+-------+ | requestType | For both a UE- as well as a | M | | | network-requested PDU | | | | session the POI (SMF) shall | | | | set the request type | | | | parameter to \"modification | | | | request\". | | +-----------------------+-----------------------------+-------+ | accessType | Access type associated with | C | | | the session (i.e. 3GPP or | | | | non-3GPP access) if | | | | provided by the AMF (see TS | | | | 24.501 [13] clause | | | | 9.11.2.1A). | | +-----------------------+-----------------------------+-------+ | rATType | RAT type associated with | C | | | the access, if available. | | | | Values given as per TS | | | | 29.571 [17] clause | | | | 5.4.3.2. | | +-----------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See TS | C | | | 24.501 [13] clause 9.4. | | | | This parameter is | | | | conditional only for | | | | backwards compatibility. | | +-----------------------+-----------------------------+-------+
##### 6.2.3.2.4 PDU session release
The IRI-POI in the SMF shall generate an xIRI containing an
SMFPDUSessionRelease record when the IRI-POI present in the SMF detects that a
PDU session been released. The IRI-POI present in the SMF shall generate the
xIRI for the following events:
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE
from the UE and the 5GSM state within the SMF is changed to PDU SESSION
INACTIVE (see TS 24.501 [13]). This applies to the following two cases:
\- UE initiated PDU session release.
\- Network initiated PDU session release.
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION
COMMAND REJECT from the UE with the cause value #43 indicating an invalid PDU
Session ID and the 5GSM state within the SMF is changed to PDU SESSION
INACTIVE (see TS 24.501 [13]). This applies to the case where the UE rejects a
PDU SESSION MODIFICATION COMMAND as it finds that the indicated PDU session ID
is invalid. The 5GSM state is changed to PDU SESSION INACTIVE within the SMF.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update response message with n1SmInfoFromUe
IE containing the PDU SESSION RELEASE COMPLETE (see TS 29.502 [16]) from the
V-SMF. This applies to the following three cases:
\- UE initiated PDU session release.
\- Network (VPLMN) initiated PDU session release.
\- Network (HPLMN) initiated PDU session release.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update response message with n1SmInfoFromUe
IE containing the PDU SESSION MODIFICATION COMMAND REJECT (see TS 29.502 [16])
from the V-SMF with the cause value #43 indicating an Invalid PDU Session ID.
Table 6.2.3-3: Payload for SMFPDUSessionRelease record
+-------------------+----------------------------------------+-------+ | Field name | Description | M/C/O | +-------------------+----------------------------------------+-------+ | sUPI | SUPI associated with the PDU session. | M | +-------------------+----------------------------------------+-------+ | pEI | PEI associated with the PDU session if | C | | | available. | | +-------------------+----------------------------------------+-------+ | gPSI | GPSI associated with the PDU session | C | | | if available. | | +-------------------+----------------------------------------+-------+ | pDUSessionID | PDU Session ID as assigned by the AMF. | M | +-------------------+----------------------------------------+-------+ | timeOfFirstPacket | Time of first packet for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | timeOfLastPacket | Time of last packet for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | uplinkVolume | Number of uplink octets for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | downlinkVolume | Number of downlink octets for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | location | Location information, if available. | C | | | | | | | Encoded as a _userLocation_ parameter | | | | (_l | | | | ocation >locationInfo>userLocation_), | | | | see Annex A. | | +-------------------+----------------------------------------+-------+ | cause | Indicates the NF Service Consumer | C | | | cause for the requested PDU session | | | | release (see TS 29.502 [16] clause | | | | 6.1.6.3.8 for enumerated cause | | | | information). Include if known. | | +-------------------+----------------------------------------+-------+
##### 6.2.3.2.5 Start of interception with an established PDU session
The IRI-POI in the SMF shall generate an xIRI containing an
SMFStartOfInterceptionWithEstablishedPDUSession record when the IRI-POI
present in the SMF detects that a PDU session has already been established for
the target UE when interception starts.
In a non-roaming scenario, the IRI-POI in the SMF (or in a roaming scenario,
the IRI-POI in the V-SMF in the VPLMN) shall generate the xIRI containing the
SMFStartOfInterceptionWithEstablishedPDUSession record when it detects that a
new interception for a UE is activated (i.e. provisioned by the LIPF) for the
following case:
\- The 5GSM state within the SMF for that UE is 5GSM: PDU SESSION ACTIVE or
PDU SESSION MODIFICATION PENDING.
NOTE: The above trigger happens when the SMF (V-SMF in VPLMN) had not sent an
N1 NAS message PDU SESSION RELEASE COMMAND to the UE for a PDU session and the
SMF (V-SMF in the VPLMN) had previously sent an N1 NAS message PDU SESSION
ESTABLISHMENT ACCEPT to that UE for the same PDU session.
In a home-routed roaming scenario, the IRI-POI in the H-SMF shall generate the
xIRI containing the SMFStartOfInterceptionWithEstablishedPDUSession record
when it detects that a new interception for a UE is activated (i.e.
provisioned by the LIPF) for the following case:
\- The H-SMF had not sent a Nsmf_PDU_Session_Update Request (n1SmInfoToUe: PDU
SESSION RELEASE COMMAND) to the V-SMF for a PDU session and H-SMF had
previously sent a Nsmf_PDU_Session_Create response (n1SmInfoToUE: PDU SESSION
ESTABLISHMENT ACCEPT) to the V-SMF for that PDU session.
The IRI-POI in the SMF shall generate the xIRI containing the
SMFStartOfInterceptionWithEstablishedPDUSession record for each of the PDU
sessions (that meets the above criteria) associated with the newly identified
target UEs.
Table 6.2.3-4: Payload for SMFStartOfInterceptionWithEstablishedPDUSession
record
+----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions. | | +----------------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +----------------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available. | | +----------------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available. | | +----------------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID as assigned | M | | | by the AMF, as defined in | | | | TS 24.007 [14] clause | | | | 11.2.3.1b. | | +----------------------------+-----------------------------+-------+ | gTPTunnelID | Contains the F-TEID | M | | | identifying the tunnel used | | | | to encapsulate the traffic, | | | | as defined in TS 29.244 | | | | [15] clause 8.2.3. | | | | Non-GTP encapsulation is | | | | for further study. | | +----------------------------+-----------------------------+-------+ | pDUSessionType | Identifies selected PDU | M | | | session type, see TS 24.501 | | | | [13] clause 9.11.4.11. | | +----------------------------+-----------------------------+-------+ | sNSSAI | Slice identifier associated | C | | | with the PDU session, if | | | | available. See TS 23.003 | | | | [19] clause 28.4.2 and TS | | | | 23.501 [2] clause | | | | 5.12.2.2. | | +----------------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. IP addresses are | | | | given as 4 octets (for | | | | IPv4) or 16 octets (for | | | | IPv6) with the most | | | | significant octet first | | | | (network byte order). MAC | | | | addresses are given as 6 | | | | octets with the most | | | | significant octet first. | | +----------------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +----------------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF at | | | | session establishment, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +----------------------------+-----------------------------+-------+ | dNN | Data Network Name | M | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003 [19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2. Shall | | | | be given in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +----------------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1, if | | | | available. | | +----------------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +----------------------------+-----------------------------+-------+ | requestType | Type of request as | M | | | initially set within the | | | | PDU SESSION ESTABLISHMENT | | | | as described in TS 24.501 | | | | [13] clause 9.11.3.47.\ | | | | If the initial value is no | | | | longer available the | | | | request type shall be set | | | | to "existing PDU session". | | +----------------------------+-----------------------------+-------+ | accessType | Access type associated with | C | | | the session (i.e. 3GPP or | | | | non-3GPP access) if | | | | provided by the AMF (see TS | | | | 24.501 [13] clause | | | | 9.11.2.1A). | | +----------------------------+-----------------------------+-------+ | rATType | RAT type associated with | C | | | the access if provided by | | | | the AMF as part of session | | | | establishment (see TS | | | | 23.502 [4] clause 4.3.2). | | | | Values given as per TS | | | | 29.571 [17] clause | | | | 5.4.3.2. | | +----------------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +----------------------------+-----------------------------+-------+ | timeOfSessionEstablishment | Time at which the session | C | | | establishment occurred, if | | | | available. Shall be given | | | | qualified with time zone | | | | information (i.e. as UTC or | | | | offset from UTC, not as | | | | local time). | | +----------------------------+-----------------------------+-------+
The IRI-POI present in the SMF generating an xIRI containing a
SMFStartOfInterceptionWithEstablishedPDUSession record shall set the Payload
Direction field in the PDU header to _not applicable_ (see ETSI TS 103 221-2
[8] clause 5.2.6).
##### 6.2.3.2.6 SMF unsuccessful procedure
The IRI-POI in the SMF shall generate an xIRI containing an
SMFUnsuccessfulProcedure record when the IRI-POI present in the SMF detects an
unsuccessful procedure or error condition for a UE matching one of the target
identifiers provided via LI_X1.
Accordingly, the IRI-POI in the SMF generates the xIRI when one of the
following events are detected:
\- SMF sends a PDU SESSION ESTABLISHMENT REJECT message to the target UE.
\- SMF sends a PDU SESSION MODIFICATION REJECT message to the target UE.
\- SMF sends a PDU SESSION RELEASE REJECT message to the target UE.
\- SMF receives a PDU SESSION MODIFICATION COMMAND REJECT message from the
target UE.
\- An ongoing SM procedure is aborted at the SMF, due to e.g. a 5GSM STATUS
message sent from or received by the SMF.
Table 6.2.3-5: Payload for SMFUnsuccessfulProcedure record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | failedProcedureType | Specifies the procedure | M | | | which failed or is aborted | | | | at the SMF. | | +-----------------------------+-----------------------------+-------+ | failureCause | Provides the value of the | M | | | 5GSM cause, see TS 24.501 | | | | [13], clause 9.11.4.2. In | | | | case the procedure is | | | | aborted due to a 5GSM | | | | STATUS message, the 5GSM | | | | cause is the one included | | | | in the 5GSM status message. | | +-----------------------------+-----------------------------+-------+ | requestedSlice | Slice requested for the | C | | | procedure, if available, | | | | given as a NSSAI (a list of | | | | S-NSSAI values as described | | | | in TS 24.501 [13] clause | | | | 9.11.3.37). | | +-----------------------------+-----------------------------+-------+ | initiator | Specifies whether the | M | | | network (SMF) or the UE is | | | | initiating the rejection or | | | | indicating the failure. | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | procedure, if available | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See clause | C | | | 9.4 of TS 24.501 [13], if | | | | available. | | +-----------------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. | | +-----------------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | dNN | Data Network Name | C | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003 [19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2, if | | | | available. Shall be given | | | | in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +-----------------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1 when | | | | available. | | +-----------------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +-----------------------------+-----------------------------+-------+ | requestType | Type of request as | C | | | described in TS 24.501 | | | | [13] clause 9.11.3.47 if | | | | available. | | | | | | | | Otherwise depending on the | | | | REJECT event the following | | | | request type shall be | | | | reported:\ | | | | PDU SESSION ESTABLISHMENT | | | | REJECT: The request type | | | | shall be set to the one | | | | reported within the PDU | | | | SESSION ESTABLISHMENT or if | | | | there hasn\'t been one | | | | reported or is no longer | | | | available it should be set | | | | to \"initial request\".\ | | | | PDU SESSION MODIFICATION | | | | REJECT: \"modification | | | | request".\ | | | | PDU SESSION RELEASE REJECT: | | | | no request type shall be | | | | set.\ | | | | PDU SESSION MODIFICATION | | | | COMMAND REJECT: | | | | \"modification request". | | +-----------------------------+-----------------------------+-------+ | accessType | Access type associated with | C | | | the session (i.e. 3GPP or | | | | non-3GPP access) if | | | | provided by the AMF (see TS | | | | 24.501 [13] clause | | | | 9.11.2.1A). | | +-----------------------------+-----------------------------+-------+ | rATType | RAT Type associated with | C | | | the access if provided by | | | | the AMF as part of session | | | | establishment (see TS | | | | 23.502 [4] clause 4.3.2). | | | | Values given as per TS | | | | 29.571 [17] clause | | | | 5.4.3.2. | | +-----------------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | Request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one identity | | | | shall be provided, the | | | | others shall be provided if | | | | available. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.3.2.7 MA PDU sessions
##### 6.2.3.2.7.1 General {#general-12 .H6}
In the present document, an MA PDU session will include two general types of
PDU sessions as defined below:
\- MA-Confirmed: This is an MA PDU session where the UE signals Upgrade
Allowed to MA and the network immediately upgrades the session to an MA PDU
session or the UE explicitly requests an MA PDU session (using a Request Type
of MA PDU).
\- MA-Upgrade-Allowed: This is a PDU session where the UE indicated that
upgrade to an MA PDU session is allowed, but the network does not immediately
confirm the upgrade. The network may at some later point upgrade the session
to an MA PDU session
NOTE: The above terms are not defined or used in other 3GPP Stage 2 or Stage 3
specifications, but have been introduced here to clarify and distinguish LI
event reporting for the respective situations.
An MA-Confirmed MA PDU session may be established over a single access or over
multiple accesses. The establishment over multiple accesses may occur
concurrently or may occur at different points in time.
An MA-Upgrade-Allowed MA PDU session is established over a single access and
nearly all aspects appears to be an ordinary non-MA PDU session with the key
difference that the network may upgrade the session to an MA-confirmed MA PDU
session.
##### 6.2.3.2.7.2 MA PDU session establishment {#ma-pdu-session-establishment
.H6}
The IRI-POI in the SMF shall generate an xIRI containing an
SMFMAPDUSessionEstablishment record when the IRI-POI present in the SMF
detects that a PDU session has been established for the target UE that is an
MA PDU session (Request Type set to MA PDU session or upgraded at
establishment), or where the upgrade allowed parameter is set to upgrade
allowed and session is established as an ordinary PDU session (not upgraded at
establishment, but may occur later on). The IRI-POI present in the SMF shall
generate the xIRI for the following events:
\- For a non-roaming scenario , the SMF sends the N1 NAS message (via AMF) PDU
Session Establishment Accept to the UE for a new PDU session and the 5G
Session Management (5GSM) state within the SMF is changed to PDU SESSION
ACTIVE (see TS 24.501 [13]) in response to a PDU Session Establishment request
received along with:
\- PDU Session ID which does not identify an existing PDU session, and
\- Request Type = MA PDU request, or
\- Request Type = initial request and MA PDU session information set to \"MA
PDU session network upgrade is allowed\", with either upgrade occuring at
establishment or upgrade does not occur at establishment but may occur later.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Create response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) for a new
PDU session in response to a PDU Session Establishment request received along
with:
\- PDU Session ID which does not identify an existing PDU session, and
\- Request Type = MA PDU request, or
\- Request Type = initial request and MA PDU session information set to \"MA
PDU session network upgrade is allowed\", with either upgrade occuring at
establishment or upgrade does not occur at establishment but may occur later.
Table 6.2.3-5A: Payload for SMFMAPDUSessionEstablishment record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See clause | M | | | 9.4 of TS 24.501 [13]. | | | | Identifies a new PDU | | | | session. | | +-----------------------------+-----------------------------+-------+ | pDUSessionType | Identifies selected PDU | M | | | session type, see TS 24.501 | | | | [13] clause 9.11.4.11. | | +-----------------------------+-----------------------------+-------+ | accessInfo | Identifies the access(es) | M | | | associated with the PDU | | | | session including the | | | | information for each | | | | specific access (see Table | | | | 6.2.3-5B) | | +-----------------------------+-----------------------------+-------+ | sNSSAI | Slice identifiers | C | | | associated with the PDU | | | | session, if available. See | | | | TS 23.003 [19] clause | | | | 28.4.2 and TS 23.501 [2] | | | | clause 5.12.2.2. | | +-----------------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | dNN | Data Network Name | M | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003[19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2. Shall | | | | be given in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +-----------------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1 when | | | | available. | | +-----------------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +-----------------------------+-----------------------------+-------+ | requestType | Type of request as | M | | | described in TS 24.501 | | | | [13] clause 9.11.3.47 | | | | provided within the | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | Request (TS 29.502 [16]) | | | | message shall be reported. | | | | | | | | In the case where the | | | | network does not provide a | | | | request type value for a MA | | | | PDU session and the network | | | | does support MA PDU | | | | sessions, the request type | | | | shall be set to "MA PDU | | | | request" according to TS | | | | 24.501 [13] clause | | | | 6.4.1.2. | | +-----------------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | Request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +-----------------------------+-----------------------------+-------+ | servingNetwork | PLMN ID of the serving core | M | | | network operator, and, for | | | | a Non-Public Network (NPN), | | | | the NID that together with | | | | the PLMN ID identifies the | | | | NPN. | | +-----------------------------+-----------------------------+-------+ | oldPDUSessionID | The old PDU Session ID | C | | | received from the UE. See | | | | clauses 4.3.2.2.1 and | | | | 4.3.5.2 of TS 23.502 [4] | | | | and clause 6.4.1.2 of TS | | | | 24.501 [13]. Include if | | | | known. | | +-----------------------------+-----------------------------+-------+ | mAUpgradeIndication | Indicates whether the PDU | C | | | session is allowed to be | | | | upgraded to MA-Confirmed MA | | | | PDU session (see clause | | | | 4.22.3 of TS 23.502 [4]). | | | | Include if known. | | +-----------------------------+-----------------------------+-------+ | ePSPDNCnxInfo | Indicates if the PDU | C | | | session may be moved to EPS | | | | during its lifetime (see TS | | | | 29.502 [16] clause | | | | 6.1.6.2.31). Include if | | | | known. | | +-----------------------------+-----------------------------+-------+ | mAAcceptedIndication | Indicates that a request to | M | | | establish an MA PDU session | | | | was accepted or if a single | | | | access PDU session request | | | | was upgraded into a MA PDU | | | | session (see clauses 4.22.2 | | | | and 4.22.3 of | | | | TS 23.502 [4]). | | | | | | | | It shall be set as follows: | | | | | | | | - true: MA-Confirmed MA | | | | PDU session was established | | | | | | | | - false: single access | | | | MA-Upgrade-Allowed MA PDU | | | | session was established | | | | that may be upgraded to an | | | | MA-Confirmed MA PDU | | | | session. | | +-----------------------------+-----------------------------+-------+ | aTSSSContainer | Identifies the steering, | C | | | switching, and splitting | | | | features for the | | | | MA-Confirmed MA PDU | | | | session. Also indicates | | | | whether MPTCP or ATSSS-LL | | | | is to be used for ATSSS. | | | | See 9.11.4.22 of | | | | 24.501[13]. | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one of the | | | | SUPI, PEI or GPSI fields | | | | shall be present. | | | +-----------------------------+-----------------------------+-------+
Table 6.2.3-5B: Contents of Access Info parameter
* * *
Field name Description M/C/O accessType Access type associated with the
session (i.e. 3GPP or non-3GPP access) as provided by the AMF (see TS 24.501
[13] clause 9.11.2.1A). M rATType RAT Type associated with the access as
provided by the AMF as part of session establishment (see TS 23.502 [4] clause
4.3.2). Values given as per TS 29.571 [17] clause 5.4.3.2. C gTPTunnelID
Contains the F-TEID identifying the GTP tunnel used to encapsulate the
traffic, as defined in TS 29.244 [15] clause 8.2.3. Non-GTP encapsulation is
for further study. M non3GPPAccessEndpoint UE\'s local IP address used to
reach the N3IWF, TNGF or TWIF, if available. IP addresses are given as 4
octets (for IPv4) or 16 octets (for IPv6) with the most significant octet
first (network byte order). C establishmentStatus Indicates whether the access
type is established or released. M aNTypeToReactivate Indicates the Access
Network Type for which the UP connection is requested to be re-activated, for
an MA PDU session. Applicable to session modification reporting. C
* * *
##### 6.2.3.2.7.3 MA PDU session modification {#ma-pdu-session-modification
.H6}
The IRI-POI in the SMF shall generate an xIRI containing an
SMFMAPDUSessionModification record when the IRI-POI present in the SMF detects
that an MA PDU session has been modified for the target UE. The IRI-POI
present in the SMF shall generate the xIRI for the following events:
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION
COMPLETE from the UE and the 5GSM state within the SMF is returned to PDU
SESSION ACTIVE (see TS 24.501 [13]). This applies to the following cases for
an MA-Upgrade-Allowed PDU session:
\- UE initiated PDU session modification.
\- Network initiated PDU session modification.
\- Upgrade to an MA PDU session.
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE
from the UE in response to a PDU SESSION RELEASE COMMAND message containing an
Access type IE identifying a single access to be released of an MA PDU session
which was established over both accesses and the 5GSM state within the SMF
remains in the PDU SESSION ACTIVE (see TS 24.501 [13]). This applies to the
following case:
\- A single access type is released from an MA PDU session, but the MA PDU
session continues.
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), sends the N1 NAS message (via AMF) PDU SESSION ESTABLISHMENT
ACCEPT to the UE and the 5GSM state within the SMF remains in the PDU SESSION
ACTIVE (see TS 24.501 [13]). This applies to the following cases:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP) for an MA-Upgrade-Allowed MA PDU session.
\- MA PDU Session establishment over second access type.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe
IE containing the PDU SESSION MODIFICATION COMPLETE (see TS 29.502 [16]). This
applies to the following cases for an MA-Upgrade-Allowed PDU session:
\- UE initiated PDU session modification.
\- Network (VPLMN) initiated PDU session modification.
\- Network (HPLMN) initiated PDU session modification.
\- Upgrade to an MA PDU session.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoFromUe
IE containing the PDU SESSION RELEASE COMPLETE message, a response to a PDU
SESSION RELEASE COMMAND message containing an Access type IE identifying a
single access to be released of an MA PDU session which was established over
both accesses and the 5GSM state within the SMF remains in the PDU SESSION
ACTIVE (see TS 29.502 [16]). This applies to the following cases:
\- A single access type is released from an MA PDU session, but the MA PDU
session continues.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Create Response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it
had received an N16 Nsmf_PDU_Session_Create Request message with an existing
PDU Session Id with access type being changed. This applies to the following
cases:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP) for an MA-Upgrade-Allowed PDU session. In this case, the V-SMF is
used for the PDU session on the new access type only.
\- MA PDU Session establishment over second access type.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF) sends
the N16: Nsmf_PDU_Session_Update Response message with n1SmInfoToUe IE
containing the PDU SESSION ESTABLISHMENT ACCEPT (see TS 29.502 [16]) while it
had received a N16 Nsmf_PDU_Session_Update Request message with an existing
PDU Session Id with access type being changed. This applies to the following
cases:
\- Handover from one access type to another access type happens (e.g. 3GPP to
non-3GPP) where the same V-SMF is for the PDU session on both access types.
\- MA PDU Session establishment over second access type.
Table 6.2.3-5C: Payload for SMFMAPDUSessionModification record
+----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +----------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions. | | +----------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message, | | | | and set to "true" if the | | | | SUPI was not authenticated, | | | | or "false" if it has been | | | | authenticated. | | +----------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available. | | +----------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available. | | +----------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See clause | M | | | 9.4 of TS 24.501 [13]. | | +----------------------+-----------------------------+-------+ | accessInfo | Identifies the access(es) | C | | | associated with the PDU | | | | session including the | | | | information for each | | | | specific access (see Table | | | | 6.2.3-5B) being modified. | | +----------------------+-----------------------------+-------+ | sNSSAI | Slice identifier associated | C | | | with the PDU session, if | | | | available. See TS 23.003 | | | | [19] clause 28.4.2 and TS | | | | 23.501 [2] clause | | | | 5.12.2.2. | | +----------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +----------------------+-----------------------------+-------+ | requestType | For both a UE- as well as a | C | | | network-requested PDU | | | | session, the POI (SMF) | | | | shall set the request type | | | | parameter to \"modification | | | | request\". | | +----------------------+-----------------------------+-------+ | servingNetwork | PLMN ID of the serving core | M | | | network operator, and, for | | | | a Non-Public Network (NPN), | | | | the NID that together with | | | | the PLMN ID identifies the | | | | NPN. | | +----------------------+-----------------------------+-------+ | oldPDUSessionID | The old PDU Session ID | C | | | received from the UE. See | | | | clauses 4.3.2.2.1 and | | | | 4.3.5.2 of TS 23.502 [4] | | | | and clause 6.4.1.2 of TS | | | | 24.501 [13]. Include if | | | | known. | | +----------------------+-----------------------------+-------+ | mAUpgradeIndication | Indicates whether the PDU | C | | | session is allowed to be | | | | upgraded to MA PDU session | | | | (see clause 4.22.3 of | | | | 3GPP TS 23.502 [4]). | | | | Include if known. | | +----------------------+-----------------------------+-------+ | ePSPDNCnxInfo | Indicates if the PDU | C | | | session may be moved to EPS | | | | during its lifetime (see TS | | | | 29.502 [16] clause | | | | 6.1.6.2.31). Include if | | | | known. | | +----------------------+-----------------------------+-------+ | mAAcceptedIndication | Indicates that a request to | M | | | establish an MA PDU session | | | | was accepted or if a single | | | | access PDU session request | | | | was upgraded into a MA PDU | | | | session (see clauses 4.22.2 | | | | and 4.22.3 of | | | | TS 23.502 [4]). | | | | | | | | It shall be set as follows: | | | | | | | | - true: MA-Confirmed MA | | | | PDU session was established | | | | | | | | - false: single access | | | | MA-Upgrade-Allowed MA PDU | | | | session was established | | | | that may be upgraded to an | | | | MA-Confirmed MA PDU | | | | session. | | +----------------------+-----------------------------+-------+ | aTSSSContainer | Identifies the steering, | C | | | switching, and splitting | | | | features for the | | | | MA-Confirmed MA PDU | | | | session. Also indicates | | | | whether MPTCP or ATSSS-LL | | | | is to be used for ATSSS. | | | | See clause 9.11.4.22 of TS | | | | 24.501 [13]. | | +----------------------+-----------------------------+-------+
##### 6.2.3.2.7.4 MA PDU session release {#ma-pdu-session-release .H6}
The IRI-POI in the SMF shall generate an xIRI containing an
SMFMAPDUSessionRelease record when the IRI-POI present in the SMF detects that
an MA PDU session has been released. The IRI-POI present in the SMF shall
generate the xIRI for the following events:
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION RELEASE COMPLETE
from the UE and the 5GSM state within the SMF is changed to PDU SESSION
INACTIVE (see TS 24.501 [13]). This applies to the following two cases for an
MA PDU session that is either MA-Confirmed or MA-Upgrade-Allowed:
\- UE initiated PDU session release.
\- Network initiated PDU session release.
\- For a roaming scenario, V-SMF in the VPLMN, the V-SMF receives the N1 NAS
message (via AMF) PDU SESSION RELEASE COMPLETE from the UE and the 5GSM state
within the V-SMF is changed to PDU SESSION INACTIVE (see TS 24.501 [13]). This
applies to the following two cases for an MA PDU session that is either MA-
confirmed or MA-Upgrade-Allowed:
\- UE initiated PDU session release of a single access for an MA PDU session;
(VPLMN considers MA PDU session fully released while HPLMN considers MA PDU
session active).
\- Network initiated PDU session release of a single access for an MA PDU
session; (VPLMN considers MA PDU session fully released while HPLMN considers
MA PDU session active).
\- For a non-roaming scenario, the SMF (or for a roaming scenario, V-SMF in
the VPLMN), receives the N1 NAS message (via AMF) PDU SESSION MODIFICATION
COMMAND REJECT from the UE with the cause value #43 indicating an invalid PDU
Session ID and the 5GSM state within the SMF is changed to PDU SESSION
INACTIVE (see TS 24.501 [13]). This applies to the case for a PDU session that
is either MA-Confirmed or MA-Upgrade-Allowed and where the UE rejects a PDU
SESSION MODIFICATION COMMAND as it finds that the indicated PDU session ID is
invalid. The 5GSM state is changed to PDU SESSION INACTIVE within the SMF.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update response message with n1SmInfoFromUe
IE containing the PDU SESSION RELEASE COMPLETE (see TS 29.502 [16]) from the
V-SMF. This applies to the following three cases for an MA PDU session that is
either MA-Confirmed or MA-Upgrade-Allowed:
\- UE initiated PDU session release.
\- Network (VPLMN) initiated PDU session release.
\- Network (HPLMN) initiated PDU session release.
\- For a home-routed roaming scenario, the SMF in the HPLMN (i.e. H-SMF)
receives the N16: Nsmf_PDU_Session_Update response message with n1SmInfoFromUe
IE containing the PDU SESSION MODIFICATION COMMAND REJECT (see TS 29.502 [16])
from the V-SMF with the cause value #43 indicating an Invalid PDU Session ID
for an MA PDU session that is either MA-Confirmed or MA-Upgrade-Allowed.
Table 6.2.3-5D: Payload for SMFMAPDUSessionRelease record
+-------------------+----------------------------------------+-------+ | Field name | Description | M/C/O | +-------------------+----------------------------------------+-------+ | sUPI | SUPI associated with the PDU session. | M | +-------------------+----------------------------------------+-------+ | pEI | PEI associated with the PDU session if | C | | | available. | | +-------------------+----------------------------------------+-------+ | gPSI | GPSI associated with the PDU session | C | | | if available. | | +-------------------+----------------------------------------+-------+ | pDUSessionID | PDU Session ID as assigned by the AMF. | M | +-------------------+----------------------------------------+-------+ | timeOfFirstPacket | Time of first packet for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | timeOfLastPacket | Time of last packet for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | uplinkVolume | Number of uplink octets for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | downlinkVolume | Number of downlink octets for the PDU | C | | | session. | | +-------------------+----------------------------------------+-------+ | location | Location information, if available. | C | | | | | | | Encoded as a _userLocation_ parameter | | | | (_l | | | | ocation >locationInfo>userLocation_), | | | | see Annex A. | | +-------------------+----------------------------------------+-------+ | cause | Indicates the NF Service Consumer | C | | | cause for the requested PDU session | | | | release (see TS 29.502 [16] clause | | | | 6.1.6.3.8 for enumerated cause | | | | information). Include if known. | | +-------------------+----------------------------------------+-------+
##### 6.2.3.2.7.5 Start of interception with an established MA PDU session
{#start-of-interception-with-an-established-ma-pdu-session .H6}
The IRI-POI in the SMF shall generate an xIRI containing an
SMFStartOfInterceptionWithEstablishedMAPDUSession record when the IRI-POI
present in the SMF detects that a MA PDU session has already been established
for the target UE when interception starts.
In a non-roaming scenario, the IRI-POI in the SMF (or in a roaming scenario,
the IRI-POI in the V-SMF in the VPLMN) shall generate the xIRI containing the
SMFStartOfInterceptionWithEstablishedMAPDUSession record when it detects that
a new interception for a UE is activated (i.e. provisioned by the LIPF) for
the following case for an MA PDU session that is either MA-Confirmed or MA-
Upgrade-Allowed:
\- The 5GSM state within the SMF for that UE is 5GSM: PDU SESSION ACTIVE or
PDU SESSION MODIFICATION PENDING.
NOTE: The above trigger happens when the SMF (V-SMF in VPLMN) had not sent an
N1 NAS message PDU SESSION RELEASE COMMAND to the UE to release the entire MA
PDU session and the SMF (V-SMF in the VPLMN) had previously sent an N1 NAS
message PDU SESSION ESTABLISHMENT ACCEPT to that UE for the same MA PDU
session.
In a home-routed roaming scenario, the IRI-POI in the H-SMF shall generate the
xIRI containing the SMFStartOfInterceptionWithEstablishedMAPDUSession record
when it detects that a new interception for a UE is activated (i.e.
provisioned by the LIPF) for the following case for an MA PDU session that is
either MA-Confirmed or MA-Upgrade-Allowed:
\- The H-SMF had not sent an Nsmf_PDU_Session_Update Request (n1SmInfoToUe:
PDU SESSION RELEASE COMMAND to release the entire MA PDU session) to the V-SMF
for a PDU session and H-SMF had previously sent an Nsmf_PDU_Session_Create
response (n1SmInfoToUE: PDU SESSION ESTABLISHMENT ACCEPT) to the V-SMF for
that PDU session.
The IRI-POI in the SMF shall generate the xIRI containing the
SMFStartOfInterceptionWithEstablishedMAPDUSession record for each of the MA
PDU sessions (that meets the above criteria) associated with the newly
identified target UEs.
Table 6.2.3-5E: Payload for SMFStartOfInterceptionWithEstablishedMAPDUSession
record
+----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +----------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions. | | +----------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +----------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available. | | +----------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available. | | +----------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID as assigned | M | | | by the AMF, as defined in | | | | TS 24.007 [14] clause | | | | 11.2.3.1b. | | +----------------------+-----------------------------+-------+ | pDUSessionType | Identifies selected PDU | M | | | session type, see TS 24.501 | | | | [13] clause 9.11.4.11. | | +----------------------+-----------------------------+-------+ | accessInfo | Identifies the access(es) | M | | | associated with the PDU | | | | session including the | | | | information for each | | | | specific access (see Table | | | | 6.2.3-5B). | | +----------------------+-----------------------------+-------+ | sNSSAI | Slice identifier associated | C | | | with the PDU session, if | | | | available. See TS 23.003 | | | | [19] clause 28.4.2 and TS | | | | 23.501 [2] clause | | | | 5.12.2.2. | | +----------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. IP addresses are | | | | given as 4 octets (for | | | | IPv4) or 16 octets (for | | | | IPv6) with the most | | | | significant octet first | | | | (network byte order). MAC | | | | addresses are given as 6 | | | | octets with the most | | | | significant octet first. | | +----------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF at | | | | session establishment, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +----------------------+-----------------------------+-------+ | dNN | Data Network Name | M | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003 [19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2. Shall | | | | be given in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +----------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1, if | | | | available. | | +----------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +----------------------+-----------------------------+-------+ | requestType | Type of request as | C | | | initially set within PDU | | | | SESSION ESTABLISHMENT as | | | | described in TS 24.501 | | | | [13] clause 9.11.3.47. | | | | | | | | If the initial value is no | | | | longer available the | | | | request type shall be set | | | | to "existing PDU session". | | +----------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +----------------------+-----------------------------+-------+ | servingNetwork | PLMN ID of the serving core | M | | | network operator, and, for | | | | a Non-Public Network (NPN), | | | | the NID that together with | | | | the PLMN ID identifies the | | | | NPN. | | +----------------------+-----------------------------+-------+ | oldPDUSessionID | The old PDU Session ID | C | | | received from the UE. See | | | | clauses 4.3.2.2.1 and | | | | 4.3.5.2 of TS 23.502 [4] | | | | and clause 6.4.1.2 of TS | | | | 24.501 [13]. Include if | | | | known. | | +----------------------+-----------------------------+-------+ | mAUpgradeIndication | Indicates whether the PDU | C | | | session is allowed to be | | | | upgraded to MA PDU session | | | | (see clause 4.22.3 of | | | | TS 23.502 [4]). Include | | | | if known. | | +----------------------+-----------------------------+-------+ | ePSPDNCnxInfo | Indicates if the PDU | C | | | session may be moved to EPS | | | | during its lifetime (see TS | | | | 29.502 [16] clause | | | | 6.1.6.2.31). Include if | | | | known. | | +----------------------+-----------------------------+-------+ | mAAcceptedIndication | Indicates that a request to | M | | | establish an MA PDU session | | | | was accepted or if a single | | | | access PDU session request | | | | was upgraded into an MA PDU | | | | session (see clauses 4.22.2 | | | | and 4.22.3 of | | | | TS 23.502 [4]). | | | | | | | | It shall be set as follows: | | | | | | | | - true: MA-Confirmed MA | | | | PDU session was | | | | established. | | | | | | | | - false: single access | | | | MA-Upgrade-Allowed MA PDU | | | | session was established | | | | that may be upgraded to an | | | | MA-Confirmed MA PDU | | | | session. | | +----------------------+-----------------------------+-------+ | aTSSSContainer | Identifies the steering, | C | | | switching, and splitting | | | | features for the | | | | MA-Confirmed MA PDU | | | | session. Also indicates | | | | whether MPTCP or ATSSS-LL | | | | is to be used for ATSSS. | | | | See clause 9.11.4.22 of TS | | | | 24.501 [13]. | | +----------------------+-----------------------------+-------+
The IRI-POI present in the SMF generating an xIRI containing a
SMFStartOfInterceptionWithEstablishedMAPDUSession record shall set the Payload
Direction field in the PDU header to not applicable (see ETSI TS 103 221-2 [8]
clause 5.2.6).
##### 6.2.3.2.7.6 SMF MA unsuccessful procedure {#smf-ma-unsuccessful-
procedure .H6}
The IRI-POI in the SMF shall generate an xIRI containing an
SMFMAUnsuccessfulProcedure record when the IRI-POI present in the SMF detects
an unsuccessful procedure or error condition for a UE matching one of the
target identifiers provided via LI_X1.
Accordingly, the IRI-POI in the SMF generates the xIRI when one of the
following events are detected:
\- SMF sends a PDU SESSION ESTABLISHMENT REJECT message to the target UE for
MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.
\- SMF sends a PDU SESSION MODIFICATION REJECT message to the target UE for
MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.
\- SMF sends a PDU SESSION RELEASE REJECT message to the target UE for MA-
Confirmed and MA-Upgrade-Allowed MA PDU sessions.
\- SMF receives a PDU SESSION MODIFICATION COMMAND REJECT message from the
target UE for MA-Confirmed and MA-Upgrade-Allowed MA PDU sessions.
\- An ongoing SM procedure is aborted at the SMF, due to e.g. a 5GSM STATUS
message sent from or received by the SMF for MA-Confirmed and MA-Upgrade-
Allowed MA PDU sessions.
Table 6.2.3-5F: Payload for SMFMAUnsuccessfulProcedure record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | failedProcedureType | Specifies the procedure | M | | | which failed or is aborted | | | | at the SMF. | | +-----------------------------+-----------------------------+-------+ | failureCause | Provides the value of the | M | | | 5GSM cause, see TS 24.501 | | | | [13], clause 9.11.4.2. In | | | | case the procedure is | | | | aborted due to a 5GSM | | | | STATUS message, the 5GSM | | | | cause is the one included | | | | in the 5GSM status message. | | +-----------------------------+-----------------------------+-------+ | requestedSlice | Slice requested for the | C | | | procedure, if available, | | | | given as a NSSAI (a list of | | | | S-NSSAI values as described | | | | in TS 24.501 [13] clause | | | | 9.11.3.37). | | +-----------------------------+-----------------------------+-------+ | initiator | Specifies whether the | M | | | network (SMF) or the UE is | | | | initiating the rejection or | | | | indicating the failure. | | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | procedure, if available | | | | (see NOTE). | | +-----------------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message | | | | and set to "true" if the | | | | SUPI has not been | | | | authenticated, or "false" | | | | if it has been | | | | authenticated. | | +-----------------------------+-----------------------------+-------+ | pEI | PEI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI used in the procedure, | C | | | if available (see NOTE). | | +-----------------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See clause | C | | | 9.4 of TS 24.501 [13], if | | | | available. | | +-----------------------------+-----------------------------+-------+ | accessInfo | Identifies the access(es) | M | | | associated with the PDU | | | | session including the | | | | information for each | | | | specific access (see Table | | | | 6.2.3-5B). | | +-----------------------------+-----------------------------+-------+ | uEEndpoint | UE endpoint address(es) if | C | | | available. | | +-----------------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | dNN | Data Network Name | C | | | associated with the target | | | | traffic, as defined in TS | | | | 23.003 [19] clause 9A and | | | | described in TS 23.501 | | | | [2] clause 4.3.2.2, if | | | | available. Shall be given | | | | in dotted-label | | | | presentation format as | | | | described in TS 23.003 | | | | [19] clause 9.1. | | +-----------------------------+-----------------------------+-------+ | aMFID | Identifier of the AMF | C | | | associated with the target | | | | UE, as defined in TS 23.003 | | | | [19] clause 2.10.1 when | | | | available. | | +-----------------------------+-----------------------------+-------+ | hSMFURI | URI of the Nsmf_PDUSession | C | | | service of the selected | | | | H-SMF, if available. See TS | | | | 29.502 [16] clause | | | | 6.1.6.2.2. | | +-----------------------------+-----------------------------+-------+ | requestType | Type of request as | C | | | described in TS 24.501 | | | | [13] clause 9.11.3.47, if | | | | available. | | | | | | | | Otherwise depending on the | | | | REJECT event the following | | | | request type shall be | | | | reported: | | | | | | | | PDU SESSION ESTABLISHMENT | | | | REJECT: The request type | | | | shall be set to the one | | | | reported within the PDU | | | | SESSION ESTABLISHMENT or if | | | | there hasn\'t been one | | | | reported it should be set | | | | to \"MA PDU request\". | | | | | | | | PDU SESSION MODIFICATION | | | | REJECT: \"modification | | | | request". | | | | | | | | PDU SESSION RELEASE REJECT: | | | | no request type shall be | | | | set. | | | | | | | | PDU SESSION MODIFICATION | | | | COMMAND REJECT: | | | | \"modification request". | | +-----------------------------+-----------------------------+-------+ | sMPDUDNRequest | Contents of the SM PDU DN | C | | | Request container, if | | | | available, as described in | | | | TS 24.501 [13] clause | | | | 9.11.4.15. | | +-----------------------------+-----------------------------+-------+ | NOTE: At least one identity | | | | shall be provided, the | | | | others shall be provided if | | | | available. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.3.2.8 PDU to MA PDU session modification
The IRI-POI in the SMF shall generate an xIRI containing an
SMFPDUtoMAPDUSessionModification record when the IRI-POI present in the SMF
detects that an existing PDU session for the target UE has been successfully
modified to an MA PDU session using the PDU session modification procedures as
described in TS 24.501 [13]. A PDU session is considered to be successfully
modified to a MA PDU session, when all of the following are true:
1\. The UE is registered to both 3GPP access and non-3GPP access:
\- In the same PLMN (non-roaming UE).
\- In the different PLMNs (roaming UE).
2\. SMF receives the PDU SESSION MODIFICATION REQUEST from the UE (clause
8.2.10 in TS 24.501 [13]) that includes one of the following:
\- _modification request_ and includes MA PDU session information IE set to
_MA PDU session network upgrade allowed_.
\- _MA PDU request_.
3\. SMF sends a PDU SESSION MODIFICATION COMMAND to the UE that includes the
ATSSS IE (clause 6.4.2.3 in TS 24.501 [13]).
4\. SMF receives the PDU SESSION MODIFICATION COMPLETE from the UE (clause
8.3.10.1 in TS 24.501 [13]).
5\. The 5GSM state within the SMF is PDU Session Active.
Once the SMFPDUtoMAPDUSessionModification record has been generated by the
IRI-POI in the SMF, the IRI-POI shall follow clause 6.2.3.2.7 of the present
document for further reporting for this MA PDU session.
Table 6.2.3-5G: Payload for SMFPDUtoMAPDUSessionModification record
+-----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------+-----------------------------+-------+ | sUPI | SUPI associated with the | C | | | PDU session (e.g. as | | | | provided by the AMF in the | | | | associated | | | | Nsmf_PD | | | | U_Session_CreateSMContext | | | | service operation). Shall | | | | be present except for | | | | PEI-only unauthenticated | | | | emergency sessions. | | +-----------------------+-----------------------------+-------+ | sUPIUnauthenticated | Shall be present if a SUPI | C | | | is present in the message, | | | | and set to _true_ if the | | | | SUPI was not authenticated, | | | | or _false_ if it has been | | | | authenticated. | | +-----------------------+-----------------------------+-------+ | pEI | PEI associated with the PDU | C | | | session if available. | | +-----------------------+-----------------------------+-------+ | gPSI | GPSI associated with the | C | | | PDU session if available. | | +-----------------------+-----------------------------+-------+ | sNSSAI | Slice identifier associated | C | | | with the PDU session, if | | | | available. See TS 23.003 | | | | [19] clause 28.4.2 and TS | | | | 23.501 [2] clause | | | | 5.12.2.2. | | +-----------------------+-----------------------------+-------+ | non3GPPAccessEndpoint | UE\'s local IP address used | C | | | to reach the N3IWF, TNGF or | | | | TWIF, if available. IP | | | | addresses are given as 4 | | | | octets (for IPv4) or 16 | | | | octets (for IPv6) with the | | | | most significant octet | | | | first (network byte order). | | +-----------------------+-----------------------------+-------+ | location | Location information | C | | | provided by the AMF, if | | | | available. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >lo | | | | cationInfo>userLocation_), | | | | see Annex A. | | +-----------------------+-----------------------------+-------+ | requestType | In accordance with the | M | | | request type as described | | | | in TS 24.501 [13] clause | | | | 6.4.2.2 and clause | | | | 9.11.3.47 a request type of | | | | "modification request" | | | | shall be reported. | | +-----------------------+-----------------------------+-------+ | accessType | Access type associated with | C | | | the session (i.e. 3GPP or | | | | non-3GPP access) if | | | | provided by the AMF (see TS | | | | 24.501 [13] clause | | | | 9.11.2.1A). | | +-----------------------+-----------------------------+-------+ | rATType | RAT type associated with | C | | | the access, if available. | | | | Values given as per TS | | | | 29.571 [17] clause | | | | 5.4.3.2. | | +-----------------------+-----------------------------+-------+ | pDUSessionID | PDU Session ID See TS | M | | | 24.501 [13] clause 9.4. | | +-----------------------+-----------------------------+-------+ | requestIndication | Indicates the request type | M | | | for PDU session | | | | modification as indicated | | | | by the requestIndication | | | | sent in the PDU SESSION | | | | MODIFICATION REQUEST (see | | | | TS 29.502 [16] clause | | | | 6.1.6.3.6). | | +-----------------------+-----------------------------+-------+ | aTSSSContainer | Identifies the steering, | M | | | switching, and splitting | | | | features for the | | | | MA-Confirmed MA PDU | | | | session. Also indicates | | | | whether MPTCP or ATSSS-LL | | | | is to be used for ATSSS. | | | | See TS 24.501 [13] clause | | | | 9.11.4.22. | | +-----------------------+-----------------------------+-------+
#### 6.2.3.3 Triggering of the CC-POI from CC-TF over LI_T3
##### 6.2.3.3.1 LI_T3 interface specifics
When interception of communication contents is required or the delivery of
packet header information is required and approach 2 described in clause
6.2.3.5 is used, the CC-TF present in the SMF sends a trigger to the CC-POI
present in the UPF over the LI_T3 interface.
When the CC-TF in the SMF detects that a PDU session is being established i.e.
when the SMF sends the N4: PFCP Session Establishment Request to the UPF, see
TS 29.244 [15], clause 6.3.2) for a target UE, it shall send an activation
message to the CC-POI in the UPF over the LI_T3 interface. The activation
message shall contain the correlation identifiers that the CC-POI in the UPF
shall use with the xCC. This can be achieved by sending an ActivateTask
message as defined in ETSI TS 103 221-1 [7] clause 6.2.1 with the following
details.
Table 6.2.3-6: ActivateTask message for triggering the CC-POI in the UPF
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | Allocated by the CC-TF as | M | | | per ETSI TS 103 221-1 | | | | [7]. | | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | Packet detection criteria | M | | | as determined by the CC-TF | | | | in the SMF, which enables | | | | the UPF to isolate target | | | | traffic. The CC-POI in the | | | | UPF shall support at least | | | | the identifier types given | | | | in Table 6.2.3-7. | | | | | | | | NOTE: This value is the | | | | target identifier for the | | | | CC-POI in the UPF and may | | | | be different from the | | | | target identifier specified | | | | in the warrant. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X3Only". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI_X3. These delivery | | | | endpoints shall be | | | | configured by the CC-TF in | | | | the SMF using the | | | | CreateDestination message | | | | as described in ETSI TS 103 | | | | 221-1 [7] clause 6.3.1 | | | | prior to first use. | | +-----------------------------+-----------------------------+-------+ | CorrelationID | Correlation ID to assign to | M | | | X3 PDUs generated by the | | | | CC-POI in the UPF. This | | | | field is populated with the | | | | same CorrelationID the | | | | IRI-POI in the SMF uses for | | | | the associated xIRI. | | +-----------------------------+-----------------------------+-------+ | ProductID | Shall be set to the XID of | M | | | the Task Object associated | | | | with the interception at | | | | the CC-TF. This value shall | | | | be used by the CC-POI in | | | | the UPF to fill the XID of | | | | X3 PDUs. | | +-----------------------------+-----------------------------+-------+
Table 6.2.3-7: Target Identifier Types for LI_T3
* * *
Identifier type Owner ETSI TS 103 221-1 [7] TargetIdentifier type Definition
GTP Tunnel ID 3GPP gtpuTunnelId F-TEID (see XSD schema) UE IP Address ETSI
ipAddress See ETSI TS 103 221-1 [7] UE IP Address and port ETSI ipAddressPort
See ETSI TS 103 221-1 [7] PFCP Session ID 3GPP TargetIdentifierExtension /
FSEID F-SEID (see XSD schema) PDR ID 3GPP TargetIdentifierExtension / PDRID 32
bit unsigned integer (see XSD schema) QER ID 3GPP TargetIdentifierExtension /
QERID 32 bit unsigned integer (see XSD schema) Network Instance 3GPP
TargetIdentifierExtension / NetworkInstance Octet string (see XSD schema) GTP
Tunnel Direction 3GPP TargetIdentifierExtension / GTPTunnelDirection
Enumeration (see XSD schema)
* * *
When the CC-TF in the SMF detects that a targeted PDU session is changing
(i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF,
see TS 29.244 [15], clause 6.3.3) in a way that requires changes to the
interception already activated by the CC-POI in the UPF, the CC-TF shall
modify the interception at the CC-POI in the UPF over the LI_T3 interface.
This is achieved by sending a ModifyTask message as defined in ETSI TS 103
221-1 [7] clause 6.2.2. The ModifyTask message contains the same details as
the ActivateTask message with the following fields updated as appropriate.
Table 6.2.3-8: Parameters that may be changed in a ModifyTask message when
updating interception at the CC-POI in the UPF
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | Updated packet detection | M | | | criteria as determined by | | | | the CC-TF in the SMF. | | | | | | | | NOTE: See notes on | | | | TargetIdentifiers in Table | | | | 6.2.3-6. | | +-----------------------------+-----------------------------+-------+
When the CC-TF in the SMF detects that a targeted PDU session is changing
(i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF,
see TS 29.244 [15], clause 6.3.3) for which the interception had not been
previously activated in the CC-POI in the UPF (e.g. in case of previous
unsuccessful LI activation at the CC-POI in the UPF by the CC-TF in the SMF),
the CC-TF shall send an activation message to the CC-POI in the UPF over the
LI_T3 interface. The activation message shall contain the correlation
identifiers that the CC-POI in the UPF shall use with the xCC. This can be
achieved by sending an ActivateTask message as defined in ETSI TS 103 221-1
[7] clause 6.2.1 with the details provided by Table 6.2.3-6.
When the CC-TF in the SMF detects that the PDU session has been released (i.e.
when the SMF sends the N4: PFCP Session Deletion Request to the UPF, see TS
29.244 [15], clause 6.3.4) for a target UE, it shall send a deactivation
message to the CC-POI in the UPF over the LI_T3 interface. When using ETSI TS
103 221-1 [7] this is achieved by sending a DeactivateTask message with the
XID field set to the XID associated with the interception, as described in
ETSI TS 103 221-1 [7] clause 6.2.3.
By default, interception shall occur at the anchor UPF as described in
6.2.3.3.3.
When a warrant that includes the service scoping of CC is activated for a
target UE with an established PDU session and when the IRI-POI present in the
SMF generates the xIRI containing an
SMFStartOfInterceptionWithEstablishedPDUSession record (see clause 6.2.3.2.5),
the CC-TF present in the SMF shall send an activation message to the CC-POI
present in the UPF to generate the xCC.
##### 6.2.3.3.2 CC interception with multi-homed PDU session
When a target UE accesses multiple Data Networks (DNs) via a multi-homed PDU
session (see TS 23.501 [2] clause 5.6.4.3), multiple UPFs are involved in
providing the PDU Session Anchors, with one UPF providing the Branching Point
functionality. The Branching Point UPF may, or may not, be a PDU Session
Anchor UPF (see TS 33.127 [5] Annex A3.2). The CC-TF present in the SMF shall
send the CC intercept trigger to the CC-POI present in an UPF if and only if
that UPF is selected to provide the CC-POI functions.
When the target UE is involved in multi-homed PDU session, the CC-TF present
in the SMF (i.e. in the SMF that establishes the PDU session) shall determine
which UPF(s) is(are) more suitable to provide the CC-POI functions adhering to
the following requirements specified in TS 33.127 [5]:
\- All applicable user plane packets are captured and delivered.
\- Duplicate delivery of CC is suppressed to the extent possible.
This clause assumes that a PDU session contains only one Branching Point UPF
(with N3 reference point toward the target UE) and one PDU Session Anchor UPF
for each DN connection.
Since the present document requires the interception of all DN connections,
the SMF may choose either all the PDU Session Anchor UPFs or the Branching
Point UPF to provide the CC-POI functions.
The Branching Point UPF may be chosen when all user plane packets pass through
the Branching Point UPF, and the CC-TF present in the SMF may choose the
Branching Point UPF to provide the CC-POI function and accordingly, send the
CC interception trigger to the CC-POI present in the Branching Point UPF. The
CC intercept trigger shall include the packet detection rules. An example of
these rules is:
\- Generate the xCC from all the incoming and outgoing user plane packets to
the target UE.
In this case, the CC-TF present in the SMF shall not select any of the PDU
Session Anchor UPFs to provide the CC-POI functions.
When a Branching Point UPF is chosen to provide the CC-POI functions, and if
the Branching Point UPF is removed from the user plane path during a PDU
session, then the CC POI functions will have to be moved to the PDU Session
Anchor UPFs.
The xCC delivered to the MDF3 shall be correlated to the PDU session related
xIRI. The use of Correlation Id shall be on a user-plane path basis, which
means that the xCC generated at different UPFs that belong to different PDU
sessions may need to have separate Correlation IDs, each correlating to their
own PDU session related xIRI.
##### 6.2.3.3.3 CC Interception only at PDU Session Anchor UPFs
An option is to intercept a copy of the packets sent and received on the N6
interface [2] side of the PDU Anchor UPF (for each UL classifier in case of
selective routing or _Service and Session Continuity_ mode 3) for all DNs the
subject is connected to. In the in-bound roaming case for home-routed roaming,
the CSP shall deliver a copy of the packets sent and received on the N9 side
of the PDU Anchor UPF towards the serving network.
#### 6.2.3.4 IRI-POI in UPF triggering over LI_T2
When interception of packet data headers is required, if approach 1 as
described in clause 6.2.3.9 is used for packet data header reporting is used,
the IRI-TF in the SMF shall send a trigger to the IRI-POI in the UPF over the
LI_T2 interface, when the IRI-TF in the SMF detects that a PDU session has
been established (i.e. when the SMF sends the N4: PFCP Session Establishment
Request to the UPF, see TS 29.244 [15], clause 6.3.2) for a target UE. The
activation message shall contain the correlation ID that the IRI-POI in the
UPF shall use when generating xIRI. This shall be achieved by sending an
ActivateTask message as defined in TS 103 221-1 [7] clause 6.2.1 with the
following details.
Table 6.2.3-9: ActivateTask message for triggering the UPF IRI-POI
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | Allocated by the IRI-TF as | M | | | per ETSI TS 103 221-1 | | | | [7]. | | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | Packet detection criteria | M | | | as determined by the IRI-TF | | | | in the SMF, which enable | | | | the UPF IRI-POI to isolate | | | | target traffic. The IRI-POI | | | | in the UPF shall support at | | | | least the identifier types | | | | given in Table 6.2.3-7. | | | | | | | | NOTE: This value is the | | | | target identifier for the | | | | IRI-POI in the UPF and may | | | | be different from the | | | | target identifier specified | | | | in the warrant. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". | M | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Header reporting-specific | M | | | tag to be carried in the | | | HeaderReporting | _TaskDetailsExtensions_ | | | | field of ETSI TS 103 221-1 | | | | [7]. See Table 6.2.3-10. | | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints of | M | | | LI_X2. These delivery | | | | endpoints shall be | | | | configured by the IRI-TF in | | | | the SMF using the | | | | _CreateDestination_ message | | | | as described in ETSI TS 103 | | | | 221-1 [7] clause 6.3.1 | | | | prior to first use. | | +-----------------------------+-----------------------------+-------+ | CorrelationID | Correlation ID to assign | M | | | for xIRI generated by the | | | | IRI-POI in the UPF. This | | | | field is populated with the | | | | same CorrelationID the | | | | IRI-POI in the SMF uses for | | | | the associated xIRI. | | +-----------------------------+-----------------------------+-------+ | ProductID | Shall be set to the XID of | M | | | the Task Object associated | | | | with the interception at | | | | the IRI-TF. This value | | | | shall be used by the | | | | IRI-POI in the UPF to fill | | | | the XID of X2 PDUs. | | +-----------------------------+-----------------------------+-------+
Table 6.2.3-10: ActivatePDHReporting Parameters
+------------+-----------------------------------------------+-------+ | Field name | Description | M/C/O | +------------+-----------------------------------------------+-------+ | pDHType | This field shall be set to either: | M | | | | | | | - \"PDHR,\" for packet-by-packet reporting. | | | | | | | | - \"PDSR,\" for summarized reporting. | | +------------+-----------------------------------------------+-------+ | pDSRType | If pDHType is PDSR, this field shall be set | C | | | to at least one of the following triggers: | | | | | | | | a) timer expiry (along with a timer value | | | | and unit). | | | | | | | | b) packet count (along with a value for the | | | | number of packets detected before a summary | | | | is to be triggered). | | | | | | | | c) byte count (along with a value for the | | | | cumulative byte size reached across all | | | | packets belonging to the summary before said | | | | summary is to be triggered). | | | | | | | | Summary reports shall not be cumulative, i.e. | | | | each summary report shall describe only the | | | | packets contained in its respective range, | | | | and each new summary shall start its count | | | | (of whichever attribute from the numbered | | | | list above applies) from zero, i.e. the | | | | information in the (n+1)'th summary report | | | | starts immediately after the end of the n'th | | | | summary report. | | +------------+-----------------------------------------------+-------+
When the IRI-TF in the SMF detects that a targeted PDU session has changed
(i.e. when the SMF sends the N4: PFCP Session Modification Request to the UPF,
see TS 29.244 [15], clause 6.3.3) in a way which requires changes to the
interception by the IRI-POI in the UPF, the IRI-TF in the SMF shall modify the
interception at the IRI-POI in the UPF over the LI_T2 interface. This is
achieved by sending a ModifyTask message as defined in ETSI TS 103 221-1 [7]
clause 6.2.2. The ModifyTask message contains the same details as the
ActivateTask message with the following fields updated as appropriate.
Table 6.2.3-11: Parameters that may be changed in a ModifyTask message when
updating interception at the IRI-POI in the UPF
+-------------------+----------------------------------------+-------+ | Field name | Description | M/C/O | +-------------------+----------------------------------------+-------+ | TargetIdentifiers | Updated packet detection criteria as | M | | | determined by the IRI-TF in the SMF. | | | | | | | | NOTE: See notes on TargetIdentifiers | | | | in Table 6.2.3-6. | | +-------------------+----------------------------------------+-------+
When the IRI-TF in the SMF detects that the PDU session has been released
(i.e. when the SMF sends the N4: PFCP Session Deletion Request to the UPF, see
TS 29.244 [15], clause 6.3.4) for a target UE, it shall send a deactivation
message to the IRI-POI in the UPF over the LI_T2 interface. When using ETSI TS
103 221-1 [7] this is achieved by sending a DeactivateTask message with the
XID field set to the XID associated with the interception, as described in
ETSI TS 103 221-1 [7] clause 6.2.3.
When a PDU session involves multiple UPFs, the selection of UPF to provide the
IRI-POI functions shall be done in the same way an UPF is selected to provide
the CC-POI functions as described in clauses 6.2.3.3.2 and 6.2.3.3.3.
When interception of packet data headers is required for a target UE and when
the IRI-POI present in the SMF generates the xIRI containing an
SMFStartOfInterceptionWithEstablishedPDUSession record, if approach 1
described in clause 6.2.3.9 is used for packet data header information
reporting, then the IRI-TF present in the SMF shall send an activation message
to the IRI-POI present in the UPF to generate the Packet Data Header report
related xIRIs from the user plane packets of that PDU session.
#### 6.2.3.5 Generation of xIRI at UPF over LI_X2
##### 6.2.3.5.1 Packet data header reporting
The IRI-POI in the UPF generates packet data header information either in per-
packet form, as Packet Data Header Reports (PDHRs), or in summary form, as
Packet Data Header Summary Reports (PDSRs).
##### 6.2.3.5.2 Fragmentation
If the IRI-POI in the UPF is placed on a link which fragmented the original IP
packet (see IETF RFC 791[34] for basic fragmentation rules, and IETF RFC 815
[26] for more complex re-assembly rules), a situation may occur in which only
the first fragment can be sensibly reported in a PDHR, while the subsequent
fragments may be missing essential fields that are mandatory, which may cause
simplistic implementations to mis-report them, or omit them altogether.
In this case, the IRI-POI in the UPF shall report the first fragment of a
fragmented IP packet, including the port numbers when they are included within
this first fragment, using the length of the fragment to determine if the port
numbers are indeed encoded within this first fragment. The subsequent
fragments are reported without port information. This technique relieves the
IRI-POI in the UPF from having to reassemble the original IP packet (at line
speed) at the cost of accuracy of the reported fields.
##### 6.2.3.5.3 Packet Data Header Reporting (PDHR)
If the per-packet form of packet data header reporting, i.e. PDHR, is used,
the IRI-POI in the UPF extracts the following information from each packet.
Table 6.2.3-12: PDHeaderReport record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pDUSessionID | The PDU Session ID value | M | | | 255 shall be used by the | | | | sender; the receiver shall | | | | ignore the parameter (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | sourceIPAddress | Shall contain the source | M | | | address of the packet from | | | | the 32-bit _"Source | | | | Address"_ field in IPv4, as | | | | defined in IETF RFC 791 | | | | [34], or from the 128-bit | | | | _"Source Address"_ field in | | | | IPv6, as defined in IETF | | | | RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | sourcePort | Shall contain the _"Source | C | | | Port_ " number that | | | | indicates an application or | | | | service running on top of | | | | the transport, if the | | | | _"Protocol"_ IP field (see | | | | the _nextLayerProtocol_ | | | | field below in this table) | | | | is one of: | | | | | | | | a) Transmission Control | | | | Protocol (**TCP**), IP | | | | "Protocol" field decimal | | | | "6"; see IETF RFC 793 | | | | [28]. | | | | | | | | b) User Datagram Protocol | | | | (**UDP**), IP "Protocol" | | | | field decimal "17"; see | | | | IETF RFC 768 [29]. | | | | | | | | c) Datagram Congestion | | | | Control Protocol | | | | (**DCCP**), IP "Protocol" | | | | field decimal "33"; see | | | | IETF RFC 4340 [30]. | | | | | | | | d) Stream Control | | | | Transmission Protocol | | | | (**SCTP**), IP "Protocol" | | | | field decimal "132"; see | | | | IETF RFC 4960 [31]. | | | | | | | | For further details on | | | | Layer four protocols, see | | | | IANA [32]. | | +-----------------------------+-----------------------------+-------+ | destinationIPAddress | Shall contain the | M | | | destination address of the | | | | packet from the 32-bit | | | | _"Destination Address"_ | | | | field in IPv4, as defined | | | | in IETF RFC 791 [34], or | | | | from the 128-bit | | | | _"Destination Address"_ | | | | field, as defined in IETF | | | | RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | destinationPort | Shall contain the | C | | | _"Destination Port_ " number | | | | that indicates an | | | | application or service | | | | running on top of the | | | | transport, if the | | | | _"Protocol"_ IP field (see | | | | the _nextLayerProtocol_ | | | | field below in this table) | | | | is one of: | | | | | | | | e) Transmission Control | | | | Protocol (**TCP**), IP | | | | "Protocol" field decimal | | | | "6"; see IETF RFC 793 | | | | [28]. | | | | | | | | f) User Datagram Protocol | | | | (**UDP**), IP "Protocol" | | | | field decimal "17"; see | | | | IETF RFC 768 [29]. | | | | | | | | g) Datagram Congestion | | | | Control Protocol | | | | (**DCCP**), IP "Protocol" | | | | field decimal "33"; see | | | | IETF RFC 4340 [30]. | | | | | | | | h) Stream Control | | | | Transmission Protocol | | | | (**SCTP**), IP "Protocol" | | | | field decimal "132"; see | | | | IETF RFC 4960 [31]. | | | | | | | | For further details on | | | | Layer four protocols, see | | | | IANA [32]. | | +-----------------------------+-----------------------------+-------+ | nextLayerProtocol | Shall contain the contents | M | | | of the IP _"Protocol"_ | | | | field as defined in IETF | | | | RFC 791 [34] (bits | | | | 72...79 in the IP header), | | | | and is one of the assigned | | | | Internet protocol numbers | | | | defined in _IANA_ [32]. | | +-----------------------------+-----------------------------+-------+ | iPv6flowLabel | If the IP addresses in the | C | | | report are IPv6, this field | | | | shall contain the 20-bit | | | | IPv6 "Flow Label" as | | | | defined in: | | | | | | | | - IPv6 IETF RFC 2460 | | | | [27], and | | | | | | | | - IPV6 Flow Label | | | | Specification IETF RFC 6437 | | | | [33]. | | +-----------------------------+-----------------------------+-------+ | direction | Shall contain the direction | M | | | of the intercepted packet, | | | | and it indicates either | | | | "from target" or "to | | | | target." | | +-----------------------------+-----------------------------+-------+ | packetSize | Shall contain the value of | M | | | the _"Total Length_ " IP | | | | header field if IPv4 is | | | | used, as defined in IETF | | | | RFC 791 [34], or the | | | | value of the "_Payload | | | | Length_ " field if IPv6 is | | | | used, as defined in IETF | | | | RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | NOTE: This is a placeholder | | | | value used to fill the | | | | pDUSessionID field, given | | | | that the UPF does not | | | | receive the PDU Session ID | | | | used for the session by the | | | | SMF, so this information is | | | | not available at the UPF. | | | | The PDU Session ID can be | | | | retrieved by the LEMF from | | | | the IRIs generated by the | | | | IRI-POI at the SMF and | | | | delivered by the MDF2. | | | +-----------------------------+-----------------------------+-------+
##### 6.2.3.5.4 Packet Data Summary Reporting (PDSR)
If the summary form of the packet data header reporting, i.e. PDSR, is used,
the IRI-POI in the UPF extracts from each packet the following information and
aggregates it in summaries which are delivered over LI_X2 according to the
pDSRType field defined in the ActivatePDHReporting Parameters of the
ActivateTask message received from the IRI-TF (see clause 6.2.3.4 and Table
6.2.3-10). In addition, the current summary is sent over LI_X2 when the
IRI_POI in the UPF receives a DeactivateTask message for the Task that
generated the PDSR regardless of whether the trigger in the pDSRType field of
the ActivateTask message was met. In this case, the pDSRSummaryTrigger field
of the PDSR record shall be set to endOfFlow.
Table 6.2.3-13: PDSummaryReport record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pDUSessionID | The PDU Session ID value | M | | | 255 shall be used; the | | | | receiver shall ignore the | | | | parameter (see NOTE). | | +-----------------------------+-----------------------------+-------+ | sourceIPAddress | Shall contain the source | M | | | address of the packet from | | | | the 32-bit _"Source | | | | Address"_ field in IPv4, as | | | | defined in IETF RFC 791 | | | | [34], or from the 128-bit | | | | _"Source Address"_ field in | | | | IPv6, as defined in IETF | | | | RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | sourcePort | Shall contain the _"Source | C | | | Port_ " number that | | | | indicates an application or | | | | service running on top of | | | | the transport, if the | | | | _"Protocol"_ IP field (see | | | | the _nextLayerProtocol_ | | | | field below in this table) | | | | is one of: | | | | | | | | a) Transmission Control | | | | Protocol (**TCP**), IP | | | | "Protocol" field decimal | | | | "6"; see IETF RFC 793 | | | | [28]. | | | | | | | | b) User Datagram Protocol | | | | (**UDP**), IP "Protocol" | | | | field decimal "17"; see | | | | IETF RFC 768 [29]. | | | | | | | | c) Datagram Congestion | | | | Control Protocol | | | | (**DCCP**), IP "Protocol" | | | | field decimal "33"; see | | | | IETF RFC 4340 [30]. | | | | | | | | d) Stream Control | | | | Transmission Protocol | | | | (**SCTP**), IP "Protocol" | | | | field decimal "132"; Stream | | | | Control Transmission | | | | Protocol [31]. | | | | | | | | For further details on | | | | Layer four protocols, see | | | | IANA [32]. | | +-----------------------------+-----------------------------+-------+ | destinationIPAddress | Shall contain the | M | | | destination address of the | | | | packet from the 32-bit | | | | _"Destination Address"_ | | | | field in IPv4, as defined | | | | in IETF RFC 791 [34], or | | | | from the 128-bit | | | | _"Destination Address"_ | | | | field, as defined in IETF | | | | RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | destinationPort | Shall contain the | C | | | _"Destination Port_ " number | | | | that indicates an | | | | application or service | | | | running on top of the | | | | transport, if the | | | | _"Protocol"_ IP field (see | | | | the _nextLayerProtocol_ | | | | field below in this table) | | | | is one of: | | | | | | | | a) Transmission Control | | | | Protocol (**TCP**), IP | | | | "Protocol" field decimal | | | | "6"; see IETF RFC 793 | | | | [28]. | | | | | | | | b) User Datagram Protocol | | | | (**UDP**), IP "Protocol" | | | | field decimal "17"; see | | | | IETF RFC 768 [29]. | | | | | | | | c) Datagram Congestion | | | | Control Protocol | | | | (**DCCP**), IP "Protocol" | | | | field decimal "33"; see | | | | IETF RFC 4340 [30]. | | | | | | | | d) Stream Control | | | | Transmission Protocol | | | | (**SCTP**), IP "Protocol" | | | | field decimal "132"; Stream | | | | Control Transmission | | | | Protocol [31]. | | | | | | | | For further details on | | | | Layer four protocols, see | | | | IANA [32]. | | +-----------------------------+-----------------------------+-------+ | nextLayerProtocol | Shall contain the contents | M | | | of the IP _"Protocol"_ | | | | field as defined in IETF | | | | RFC 791 [34] (bits 72..79 | | | | in the IP header), and is | | | | one of the assigned | | | | Internet protocol numbers | | | | defined in _IANA_ [32]. | | +-----------------------------+-----------------------------+-------+ | iPv6flowLabel | If the IP addresses in the | C | | | report are IPv6, this field | | | | shall contain the 20-bit | | | | IPv6 "Flow Label" as | | | | defined in IPv6 IETF RFC | | | | 2460 [27] and the _IPV6 | | | | Flow Label Specification_ | | | | IETF RFC 6437 [33]. | | +-----------------------------+-----------------------------+-------+ | direction | Shall contain the direction | M | | | of the intercepted packet, | | | | and it indicates either | | | | "from target" or "to | | | | target." | | +-----------------------------+-----------------------------+-------+ | pDSRSummaryTrigger | Shall contain the trigger | M | | | that caused the summary | | | | report to be generated, | | | | which is one of the | | | | following: | | | | | | | | a) timer expiry. | | | | | | | | b) packet count. | | | | | | | | c) byte count. | | | | | | | | d) start of a flow. | | | | | | | | e) end of a flow. | | +-----------------------------+-----------------------------+-------+ | firstPacketTimestamp | Shall contain the timestamp | M | | | that represents the time | | | | that the IRI-POI in the UPF | | | | detected the first packet | | | | in the set represented by | | | | this summary. | | +-----------------------------+-----------------------------+-------+ | lastPacketTimestamp | Shall contain the timestamp | M | | | that represents the time | | | | that the IRI-POI in the UPF | | | | detected the last packet in | | | | the set represented by this | | | | summary. | | +-----------------------------+-----------------------------+-------+ | packetCount | Shall contain the number of | M | | | packets detected during the | | | | creation of this summary. | | +-----------------------------+-----------------------------+-------+ | byteCount | Shall contain the number of | M | | | bytes summed across all | | | | packets that belong to this | | | | summary. For IPv4 it is the | | | | sum of the _"Total Length"_ | | | | fields across all packets | | | | in the summary as defined | | | | in _Internet Protocol_ IETF | | | | RFC 791 [34], while for | | | | IPv6 it is the sum of the | | | | _"Payload Length_ " fields | | | | across all packets in the | | | | summary as defined in | | | | _Internet Protocol, Version | | | | 6 (IPv6) Specification_ , | | | | IETF RFC 2460 [27]. | | +-----------------------------+-----------------------------+-------+ | NOTE: This is a placeholder | | | | value used to fill the | | | | pDUSessionID field, given | | | | that the UPF does not | | | | receive the PDU Session ID | | | | used for the session by the | | | | SMF, so this information is | | | | not available at the UPF. | | | | The PDU Session ID can be | | | | retrieved by the LEMF from | | | | the IRIs generated by the | | | | IRI-POI at the SMF and | | | | delivered by the MDF2. | | | +-----------------------------+-----------------------------+-------+
#### 6.2.3.6 Generation of xCC at CC-POI in the UPF over LI_X3
The CC-POI present in the UPF shall send xCC over LI_X3 for each IP packet
matching the criteria specified in the Triggering message (i.e. ActivateTask
message) received over LI_T3 from the CC-TF in the SMF.
NOTE: Implementers are reminded of the completeness and non-duplication
requirements (see TS 33.127 [5]).
Each X3 PDU shall contain the contents of the user plane packet given using
the GTP-U, IP or Ethernet payload format.
The CC-POI present in the UPF shall set the payload format to indicate the
appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 7 for Ethernet
frame or 12 for GTP-U Packet as described in ETSI TS 103 221-2 [8] clauses 5.4
and 5.4.13.
If handover of the entire GTP-U packet is required over LI_HI3 (see clause
6.2.3.8), then consideration shall be made of the correct choice of LI_X3
payload type to ensure that the MDF3 has the necessary CC information. Support
for delivery of LI_X3 as payload type 12 (GTP-U packet) is mandatory.
The CC-POI present in the UPF may use the Additional XID Related Information
attributes to facilitate efficient delivery of xCC, as specified in ETSI TS
103 221-2 [8] clause 5.3.22.
#### 6.2.3.7 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in the SMF or the IRI-POI
in the UPF, the MDF2 shall send the IRI message over LI_HI2 without undue
delay. The IRI message shall contain a copy of the relevant record received
from LI_X2. The record may be enriched by other information available at the
MDF (e.g. additional location information).
The timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be
set to the time at which the SMF event was observed (i.e. the timestamp field
of the xIRI).
Tables 6.2.3-14 shows the IRI type (see ETSI TS 102 232-1 [9] clause 5.2.10)
to be used for each record type.
Table 6.2.3-14: IRI type for messages
Record type **IRI Type**
* * *
SMFPDUSessionEstablishment BEGIN SMFPDUSessionRelease END
SMFPDUSessionModification CONTINUE
SMFStartOfInterceptionWithEstablishedPDUSession BEGIN SMFUnsuccessfulProcedure
REPORT SMFMAPDUSessionEstablishment BEGIN SMFMAPDUSessionRelease END
SMFMAPDUSessionModification CONTINUE
SMFStartOfInterceptionWithEstablishedMAPDUSession BEGIN
SMFMAUnsuccessfulProcedure REPORT SMFPDUtoMAPDUSessionModification CONTINUE
PDHeaderReport REPORT PDSummaryReport REPORT
IRI messages associated with the same PDU Session shall be assigned the same
CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).
The threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall
be populated with the BER-encoded IRIPayload.
When an additional warrant is activated on a target UE and the LIPF uses the
same XID for the additional warrant, the MDF2 shall be able to generate and
deliver the IRI message containing the
SMFStartOfInterceptionWithEstablishedPDUSession record and the
SMFStartOfInterceptionWithEstablishedMAPDUSession record to the LEMF
associated with the additional warrant without receiving a corresponding xIRI.
The payload of the SMFStartOfInterceptionWithEstablishedPDUSession record is
specified in table 6.2.3-4, while the payload of the
SMFStartOfInterceptionWithEstablishedMAPDUSession record is specified in table
6.2.3-9. The MDF2 shall generate and deliver the IRI message containing the
SMFStartOfInterceptionWithEstablishedPDUSession record for each of the
established PDU sessions to the LEMF associated with the new warrant. The MDF2
shall generate and deliver the IRI message containing the
SMFStartOfInterceptionWithEstablishedMAPDUSession record for each of the
established MA PDU sessions to the LEMF associated with the new warrant.
If the MDF2 did not receive from the IRI-POI the value of
timeOfSessionEstablishment parameter in a previous corresponding
SMFStartOfInterceptionWithEstablishedPDUSession or
SMFStartOfInterceptionWithEstablishedMAPDUSession xIRI for the same session,
the MDF2, when generating the SMFStartOfInterceptionWithEstablishedPDUSession
or the SMFStartOfInterceptionWithEstablishedMAPDUSession IRI shall include in
that parameter the time provided in the timestamp previously received in the
header of the related SMFPDUSessionEstablishment or
SMFMAPDUSessionEstablishment xIRI.
When the delivery of packet header information is required and approach 2
described in clause 6.2.3.9 is used, the MDF2 shall generate the IRI message
and send it over LI_HI2 without undue delay when xCC is received over LI_MDF
from the MDF3. The MDF2 shall generate packet data header information as
described in clause 6.2.3.5.
#### 6.2.3.8 Generation of CC over LI_HI3
When the xCC is received over LI_X3, the MDF3 shall emit the CC over LI_HI3
without undue delay.
The timestamp field of the ETSI TS 102 232-1 [9] PSHeader structure shall be
set to the time that the UPF observed the data (i.e. the timestamp field of
the xCC). The LIID and CID fields shall correctly reflect the target identity
and communication session to which the CC belongs.
The MDF3 shall populate the threeGPP33128DefinedCC field (see clause 5.5.3 of
the present document) with a BER-encoded CCPayload structure containing
either:
1\. The uPFCCPDU field containing the GTP-U packet received over LI_X3. It
shall only be used if the content of the GTP-U packet is an IPv4 or IPv6
packet.
2\. The extendedUPFCCPDU field as described in Table 6.2.3-15.
The MDF3 shall support delivery using either option.
Table 6.2.3-15: ExtendedUPFCCPDU structure
* * *
Field name Description M/C/O payload Payload of the GTP-U packet without GTP-U
encapsulation. Content shall be supplied according to Table 6.2.3-16. M qFI
Shall be populated with the QoS Flow Identifier value from the GTP-U header
extension (see TS 38.415 [41] clause 5.5.3.3) if present over LI_X3. C
* * *
Table 6.2.3-16: UPFCCPDUPayload structure
* * *
Field name Description uPFIPCC Contains an IPv4 or IPv6 packet uPFEthernetCC
Contains an Ethernet frame uPFUnstructuredCC Contains an unstructured packet
* * *
#### 6.2.3.9 Packet Data Information Reporting
As described in TS 33.127 [5] clause 6.2.3.1, the warrants that do not require
the interception of communication contents may require IRI messages that
require access to the user plane packets. One such service that requires such
a capability is the packet data header information reporting which includes
the following two IRI messages:
\- Packet Data Header Reporting (PDHR).
\- Packet Data Summary Reporting (PDSR).
NOTE: Packet Data Header Reporting is done using the IRI messages containing
the PDHeaderReport record and the Packet Data Summary Reporting is done using
the IRI messages containing the PDSummaryReport record.
TS 33.127 [5] clause 6.2.3.1 provides two approaches for the generation of
such IRI messages.
In approach 1, the IRI-TF present in the SMF triggers the IRI-POI present in
the UPF to construct and deliver xIRIs to the MDF2 as described in clause
6.2.3.4. The details of these xIRIs are described in clause 6.2.3.5.
In approach 2, the CC-TF present in the SMF triggers the CC-POI present in the
UPF to deliver the xCC to the MDF3 as described in clause 6.2.3.6. The MDF3
forwards the xCC to the MDF2 over the LI-MDF interface and MDF2 generates the
IRI messages containing the PDHeaderReport and PDSummaryReport records from
the xCC. The payload of PDHeaderReport and PDSummaryReport records are as
described in clauses 6.2.3.5.3 and 6.2.3.5.4, tables 6.2.3-12 and 6.2.3-13.
Note that in approach 2, the MDF2 generates these IRI messages containing
PDHeaderReport and PDSummaryReport records without receiving the equivalent
xIRI from an IRI-POI. The actions of MDF2, MDF3 and CC-TF in SMF are managed
as part of the intercept data provisioned to them over the LI_X1 interface.
#### 6.2.3.10 Sharing LI state information over LI_ST
##### 6.2.3.10.1 Overview
TFs in SMFs in SMF sets need to share LI state information to avoid losing
track of the XIDs and CorrelationIDs used in the tasks activated in the POI in
the UPF when the triggered task control is transferred from one TF to another.
POIs in SMFs in SMF sets need to share LI state information to avoid losing
track of the CorrelationIDs and sequence numbers used in the generation of
xIRI when the interception is moved to another POI in the same SMF set.
The LIPF may request, store or remove any LI state records at any moment. The
LIPF may revoke the credentials of any LI function to use the LI_ST function
via LI_X0.
##### 6.2.3.10.2 Storing LI state
The TF in the SMF shall store the LI state (related to a task active in the
UPF POI) in the LISSF whenever the parent SMF stores session state for the
relevant PDU session in the UDSF and whenever the parent SMF sends session
state for the relevant PDU session to another SMF.
The POI in the SMF shall store the LI state (related to a task active in the
SMF POI) in the LISSF whenever the parent SMF stores session state for the
relevant PDU session in the UDSF and whenever the parent SMF sends session
state for the relevant PDU session to another SMF.
When storing state, the LI function in the SMF shall use the state storage
procedure specified in clause 5.10.2. During this procedure, the LI function
shall add the following metadata to the RecordMeta for the record.
Table 6.2.3.10.2-1: Additional metadata for the RecordMeta
* * *
Field Name Description M/C/O PDUSessionID Identifier for the PDU session
related to task. M UDSFRecordID The recordID used by the parent SMF to store
the associated SMF session information in the UDSF. M LIStateRecordType
Identifier for the record type which can be \"TFLIState\" or \"POILIState\". M
* * *
The TF shall store the following information as the first record block (see TS
29.598 [50] clause 6.1.3.3.3.2), encoded as XML following the XSD schema given
in Annex G.
Table 6.2.3.10.2-2: TFLIState structure for storing TF state information in
the LISSF
* * *
Field Name Description M/C/O PDUSessionID Identifier for the PDU session
related to task. M XID XID of the task object associated with the interception
at the TF in SMF. M CorrelationID Correlation ID to assign to interception
product generated by the POI in the UPF. M TriggeredTasks Collection of
information about tasks that the TF in SMF has activated in triggered POIs in
UPF due to interception for this PDU session. As a list of TriggeredTask, see
Table 6.2.3.10.2-3 below. M
* * *
Table 6.2.3.10.2-3: TriggeredTask
* * *
Field Name Description M/C/O XID XID of the task object associated with the
interception at the triggered POI in UPF. M NEID NEID used in LI_T2/LI_T3
communication by the triggered POI in UPF. M
* * *
The TF needs to specify the XID in order to avoid removing the LI state
related to the same ProductID but a different task in the UPF POI, for example
if there is more than one PDU session.
The SMF POI shall store the following information as the first record block
(see TS 29.598 [50] clause 6.1.3.3.3.2), encoded as XML following the XSD
schema given in Annex G.
Table 6.2.3.10.2-4: POILIState structure for storing POI state information in
the LISSF
* * *
Field Name Description M/C/O PDUSessionID Identifier for the PDU session
related to task. M XID XID of the task object associated with the interception
at the POI in SMF. M SequenceNumber Last sequence number used in the
generation of xIRI. M CorrelationID Correlation ID to assign to interception
product generated by the POI in the SMF. M
* * *
##### 6.2.3.10.3 Retrieving LI state
When the TF in an SMF in an SMF set is provisioned by the LIPF with a specific
XID and access to an LISSF function, the TF shall use the LISSF to retrieve LI
state information.
If the implementation of the SMF set does not ensure that active SM contexts
are always present in some SMF of the SMF set, when a task previously
provisioned by the LIPF in the TF is deactivated, the TF shall request the
records associated to the XID (received from the LIPF) from the LISSF, by
performing a search as described in clause 5.10.3, using the XID as a search
criteria. If no records are found, the TF may assume that no previous
interception has occurred and proceed accordingly.
When a TF detects that its parent SMF is retrieving state for a targetted PDU
session from the UDSF, the TF shall request records associated with that PDU
session from the LISSF by performing a search as described in clause 5.10.3
and using the UDSFRecordID used by the SMF as a search criteria. When a TF
detects that its parent SMF is receiving state for a targetted PDU session
from another SMF, the TF shall request records associated with that PDU
session from the LISSF by performing a search as described in clause 5.10.3
and using the XID of the task related to the target of that PDU session. If no
records are found, the TF may assume that no previous interception has
occurred and proceed accordingly. Implementers should be aware that multiple
records may be returned.
When an SMF POI detects that its parent SMF is retrieving state for a
targetted PDU session from the UDSF, the POI shall request records associated
with that PDU session from the LISSF by performing a search as described in
clause 5.10.3 and using the UDSFRecordID used by the SMF as a search criteria.
When an SMF POI detects that its parent SMF is receiving state for a targetted
PDU session from another SMF, the SMF POI shall request records associated
with that target PDU session from the LISSF by performing a search as
described in clause 5.10.3 and using the XID of the task related to the target
of that PDU session. If no records are found, the SMF POI may assume that no
previous interception has occurred and proceed accordingly.
##### 6.2.3.10.4 Removing LI state
When a task is deactivated successfully in the UPF POI, the TF shall remove
the LI state record from the LISSF as described in clause 5.10.4.
When a task is deactivated in the SMF POI, the POI shall remove the LI state
record from the LISSF as described in clause 5.10.4.
### 6.2.4 LI at UDM for 5G
#### 6.2.4.1 General description
In 5G packet core network, the UDM provides the unified data management for
UE. The UDM shall have LI capabilities to generate the target UE's service
area registration related xIRI. See clause 7.2.2 for the details.
### 6.2.5 LI at SMSF
#### 6.2.5.1 Provisioning over LI_X1
The IRI-POI present in the SMSF is provisioned over LI_X1 by the LIPF using
the X1 protocol as described in clause 5.2.2.
The IRI-POI in the SMSF shall support the following target identifier formats
in the ETSI TS 103 221-1 [7] messages:
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
Table 6.2.5-1 shows the minimum details of the LI_X1 ActivateTask message used
for provisioning the IRI-POI in the SMSF.
Table 6.2.5-1: ActivateTask message for the IRI-POI in the SMSF
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One of the target | M | | | identifiers listed in the | | | | paragraph above. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI_X2 for the IRI-POI in | | | | the SMSF. These delivery | | | | endpoints are configured | | | | using the CreateDestination | | | | message as described in | | | | ETSI TS 103 221-1 [7] | | | | clause 6.3.1 prior to the | | | | task activation. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | This field shall be | C | | | included if the delivery of | | | SMSFExtensions | the full TPDU is not | | | | authorised. See Table | | | | 6.2.5-2. | | +-----------------------------+-----------------------------+-------+
Table 6.2.5-2: TruncateTPUserData Parameters
* * *
Field Name Description M/C/O TruncateTPUserData If included, the
truncatedSMSTPDU field of the sMSTPDUData (as described in Table 6.2.5-7)
structure shall be used when applicable (see text below table). If absent, the
sMSTPDU field of the sMSTPDUData structure shall be used. C
* * *
If the TruncateTPUserData field of the LI_X1 ActivateTask message is included,
the IRI-POI in the SMSF shall use the truncatedSMSTPDU field in xIRI generated
at the IRI-POI in the SMSF for SMS-SUBMIT and SMS-DELIVER TPDUs, otherwise,
the sMSTPDU field shall be used.
The MDF2 listed as the delivery endpoint for the LI_X2 generated by the IRI-
POI in the SMSF shall be provisioned over LI_X1 by the LIPF using the X1
protocol as described in clause 5.2.2. If SMS Content delivery is not
authorized, the MDF2 shall be provisioned with the TruncateTPUserData
included, otherwise it shall be be left absent.
Table 6.2.5-3 shows the minimum details of the LI_X1 ActivateTask message used
for provisioning the MDF2.
Table 6.2.5-3: ActivateTask message for MDF2
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 [7] | Description | M/C/O | | field name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One of the target | M | | | identifiers listed in | | | | clause 6.2.5.1. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". (Ignored | M | | | by the MDF2). | | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI_X2 for the IRI-POI in | | | | the SMSF. These delivery | | | | endpoints are configured | | | | using the CreateDestination | | | | message as described in | | | | ETSI TS 103 221-1 [7], | | | | clause 6.3.1 prior to the | | | | task activation. | | +-----------------------------+-----------------------------+-------+ | ListOfMediationDetails | Sequence of Mediation | M | | | Details, See Table 6.2.5-4. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | This field shall be | C | | | included if the delivery of | | | SMSFExtensions | the full TPDU is not | | | | authorised. See Table | | | | 6.2.5-2. | | +-----------------------------+-----------------------------+-------+
Table 6.2.5-4: Mediation Details for MDF2
* * *
ETSI TS 103 221-1 [7] field name Description M/C/O LIID Lawful Interception ID
associated with the task. M DeliveryType Set to \"HI2Only\". M ListOfDIDs
Details of where to send the IRI for this LIID. Shall be included if deviation
from the ListofDIDs in the ActivateTask message is necessary. If included, the
ListOfDIDs in the Mediation Details shall be used instead of any delivery
destinations specified in the ListOfDIDs field in the ActivateTask Message. C
ServiceScoping Shall be included to Identify the service(s) and associated
service-related delivery settings for this LIID. May include more than one
instance of this parameter to allow for different combinations of sub-
parameters associated with a single LIID. This parameter is defined in ETSI TS
103 221-1 [7], Annex C, Table C.2. C
* * *
#### 6.2.5.2 Generation of xIRI over LI_X2
The IRI-POI present in the SMSF shall send xIRI over LI_X2 for the event
listed in TS 33.127 [5] clause 6.2.5.3, the details of which are described in
the following sub-clause.
#### 6.2.5.3 SMS Message
The IRI-POI in the SMSF shall generate an xIRI containing an SMSMessage record
for the following cases:
SMS-MO case:
\- When a target UE originates an SMS message or when any UE originates an SMS
message destined to a target non-local ID.
SMS-MT case:
\- When an SMS message delivery to a target UE is attempted or when an SMS
message delivery originated from a target non-local ID is attempted to any UE.
\- When an SMS message is successfully delivered to a target UE or when an SMS
message originated from a target non-local ID is successfully delivered to any
UE.
The SMS-MT case can also apply to the scenario when a receipt of SMS delivery
from the far end is delivered successfully to the target UE or when a receipt
of SMS delivery from a target non-Local ID is successfully delivered to the
originating UE.
The IRI-POI present in the SMSF shall generate the xIRI containing the
SMSMessage record when it detects following events:
\- The SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-SUBMIT, SMS-COMMAND]
(via AMF in Nsmsf_SMService_UplinkSMS message) from a target UE.
\- The SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-SUBMIT] (via AMF in
Nsmsf_SMService_UplinkSMS message) from any UE with TP-DA field within the
SMS-SUBMIT containing a target non-Local ID and SMSF returns the SMCP: CP-ACK
to that originating UE.
\- The SMSF receives an SMCP message CP-DATA_RP-DATA [SMS-COMMAND] (via AMF in
Nsmsf_SMService_UplinkSMS message) from any UE with TP-DA field within the
SMS-COMMAND containing a target non-Local ID and SMSF returns the SMCP: CP-ACK
to that originating UE.
\- The SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-
DELIVER, SMS-STATUS-REPORT] destined to a target UE.
\- The SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-
DELIVER] destined to any UE with the TP-OA field within the SMS-DELIVER
containing a target non-Local ID.
\- The SMSF receives a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Request [SMS-
STATUS-REPORT] destined to any UE with the TP-RA field within the SMS-STATUS-
REPORT containing a target non-Local ID.
The IRI-POI present in the SMSF shall generate the xIRI containing the
SMSReport record when it detects following events:
\- The SMSF sends a SMCP message CP-DATA_RP-ACK [SMS-SUBMIT-REPORT] (via AMF
in Namf_ Communication_N1N2MessageTransfer message) in response to a
previously intercepted CP-DATA_RP-DATA.
\- The SMSF sends a SMCP message CP-DATA_RP-ERROR [SMS-SUBMIT-REPORT] (via AMF
in Namf_ Communication_N1N2MessageTransfer message) in response to a
previously intercepted CP-DATA_RP-DATA.
\- The SMSF sends a TCAP message MAP MT-FORWARD-SHORT-MESSAGE Response [SMS-
DELIVER-REPORT] in response to a previously intercepted MAP MT-FORWARD-SHORT-
MESSAGE Request.
NOTE 1: In the above-mentioned descriptions, the requirements of target Non-
Local ID do not apply when both originating and terminating users of an SMS
message are served by the same CSP. The method used to identify a target non-
Local ID is different from the method used to identify a local target ID.
If the IRI-POI is provisioned with the TruncateTPUserData parameter included
and the IRI-POI is generating xIRI for the SMS-SUBMIT type (TS 23.040 [18]
Clause 9.2.2.2) or SMS-DELIVER type (TS 23.040 [18] Clause 9.2.2.1) TPDUs, the
IRI-POI shall use the truncatedSMSTPDU (as described in Table 6.2.5-7),
otherwise, the IRI-POI shall use the sMSTPDU.
Table 6.2.5-5: Payload for SMSMessage record
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | originatingSMSParty | Identity of the originating SMS | M | | | party. See NOTE 2. | | +---------------------+--------------------------------------+-------+ | terminatingSMSParty | Identity of the terminating SMS | M | | | party. See NOTE 3. | | +---------------------+--------------------------------------+-------+ | direction | Direction of the SMS with respect to | M | | | the target. See NOTE 4. | | +---------------------+--------------------------------------+-------+ | linkTransferStatus | Indicates whether the SMSF sent the | M | | | TPDU to the next network element. | | | | See NOTE 5. | | +---------------------+--------------------------------------+-------+ | otherMessage | In the event of a server-initiated | C | | | transfer, indicates whether the | | | | server will send another SMS. May be | | | | omitted if the transfer is | | | | target-initiated. See NOTE 6. | | +---------------------+--------------------------------------+-------+ | location | Location information associated with | C | | | the target sending or receiving the | | | | SMS, if available and authorised. | | | | See NOTE 7. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_loc | | | | ation >locationInfo>userLocation_), | | | | see Annex A. | | +---------------------+--------------------------------------+-------+ | peerNFAddress | Address of the other network | C | | | function (SMS-GMSC/IWMSC/SMS-Router) | | | | involved in the communication of the | | | | SMS, if available. | | +---------------------+--------------------------------------+-------+ | peerNFType | Type of the other network function | C | | | (SMS-GMSC/IWMSC/SMS-Router) involved | | | | in the communication of the SMS, if | | | | available. | | +---------------------+--------------------------------------+-------+ | sMSTPDUData | See Table 6.2.5-7. This is | C | | | conditional only for backwards | | | | compatibility. | | +---------------------+--------------------------------------+-------+ | messageType | See Table 6.2.5-8. This is | C | | | conditional only for backwards | | | | compatibility. | | +---------------------+--------------------------------------+-------+ | rPMessageReference | The SM-RL Message Reference of the | C | | | message per TS 24.011 [46] clause | | | | 7.3. This is conditional only for | | | | backwards compatibility. | | +---------------------+--------------------------------------+-------+
The sMSTPDU field shall always be used for the sMSTPDUData field of the
SMSReport record.
Table 6.2.5-6: Payload for SMSReport record
* * *
Field name Description M/C/O location Location information associated with the
target sending or receiving the SMS, if available and authorised. See NOTE 7.
C sMSTPDUData SMS TPDU, encoded as per TS 23.040 [18] clause 9. M messageType
See Table 6.2.5-8. M rPMessageReference The SM-RL Message Reference of the
message per TS 24.011 [46] clause 7.3. M
* * *
Table 6.2.5-7: SMSTPDUData field
* * *
Field name Description sMSTPDU SM-TL PDU encoded per the PDUs defined in TS
23.040 [18] clause 9.2.2. Shall be chosen if the TruncateTPUserData Parameter
is absent. truncatedSMSTPDU SM-TL PDU encoded per the PDUs defined in TS
23.040 [18] clause 9.2.2 but truncated to remove TP-User-Data (TS 23.040 [18]
clause 9.2.3.24). Shall be chosen if the TruncateTPUserData Parameter is set.
* * *
Table 6.2.5-8: SMSMessageType values
* * *
messageType value RP MTI Value RP Message Type TP-MTI Value SMS TPDU Message
Type deliver 001 RP-DATA (networkUE) 00 SMS-DELIVER deliverReportAck 010 RP-
ACK (UEnetwork) 00 SMS-DELIVER-REPORT deliverReportError 100 RP-ERROR
(UEnetwork) 00 SMS-DELIVER-REPORT statusReport 001 RP-DATA (networkUE) 10 SMS-
STATUS-REPORT command 000 RP-DATA (UEnetwork) 10 SMS-COMMAND submit 000 RP-
DATA (UEnetwork) 01 SMS-SUBMIT submitReportAck 011 RP-ACK (networkUE) 01 SMS-
SUBMIT-REPORT submitReportError 101 RP-ERROR (networkUE) 01 SMS-SUBMIT-REPORT
reserved Reserved 11 Reserved
* * *
The IRI-POI in the SMSF shall populate the messageType field with the values
listed in table 6.2.5-8 based on the SMS TPDU message type (see TS 23.040 [18]
clause 9.2.2) and the RP Message Type (see TS 24.011 [46] clause 8.2.2) that
triggered the generation of the xIRI. The SMS TPDU Message Type is indicated
by the value of the TP-Message Type Indicator (TP-MTI) (see TS 23.040 [18]
clause 9.2.3.1) as described in TS 23.040 [18] clause 9.2.3.1. The RP Message
Type is indicated by the value of the RP MTI (See TS 24.011 [46] clause
8.2.2).
NOTE 2: For the SMS-MO case, the originating party is the address of the UE
from which the SMSF receives the CP-DATA_RP-DATA [SMS-SUBMIT, SMS-COMMAND]
message (via AMF in the Nsmsf_SMService_UplinkSMS). The GPSI is one of the
data fields used in the Nsmsf related messages (see TS 29.540 [21]).
Alternatively, the SMSF may find the originating party address in the same way
it finds the address when generating charging records. For SMS-MT case, this
is derived from TP-OA field (TS 23.040 [18]) for SMS-DELIVER TPDUs or the TP-
RA field (TS 23.040 [18]) for SMS-STATUS-REPORT TPDUs. In cases where the
originatingSMSParty is not a GPSI, PEI, or SUPI, the sMSAddress parameter is
populated with the octets received in the field used to derive the address (as
per TS 23.040 [18] clause 9.1.2.5).
NOTE 3: For SMS-MT case, the terminating party is the address of the UE to
which the SMSF sends the CP-DATA_RP-DATA [SMS-DELIVER, SMS-STATUS-REPORT]
message (via AMF in Namf_Communications_N1N2MessageTransfer). The GPSI is one
of the data fields used in the Namf related messages (TS 29.518 [22]).
Alternatively, the SMSF may find the terminating party address in the same way
it finds the address when generating charging records. For SMS-MO case, this
is derived from the TP-DA field (TS 23.040 [18]). In cases where the
terminatingSMSParty is not a GPSI, PEI, or SUPI, the sMSAddress parameter is
populated with the octets received in the field used to derive the address (as
per TS 23.040 [18] clause 9.1.2.5).
NOTE 4: For the SMS-MO case, for SMS originated from the target UE, the value
fromTarget is used and for SMS destined to target Non-local ID, the toTarget
is used. For SMS-MT case, for SMS terminated to the target UE, the value
toTarget is used and for SMS originated from a target Non-local ID, the
fromTarget is used.
NOTE 5: This field is set to transferSucceeded or transferFailed as follows:
\- SMS-MO case:
\- To transferSucceeded: when the IRI-POI in the SMSF detects that SMSF sends
the MO-FORWARD-SHORT-MESSAGE-Request [SMS-SUBMIT] message to the SMS-IWMSC.
\- To transferFailed: when the IRI-POI in SMSF detects the scenarios where
SMSF cannot send the MO-FORWARD-SHORT-MESSAGE-Request [SMS-SUBMIT] to the SMS-
IWMSC, but still generates an xIRI containing the SMSMessage record.
\- SMS-MT case:
\- To transferSucceeded: when the IRI-POI in the SMSF detects that SMSF sends
the MT-FORWARD-SHORT-MESSAGE-Response [SMS-DELIVER-REPORT] message to the SMS-
IWMSC.
\- To transferFailed: when the IRI-POI in SMSF detects the scenarios where
SMSF cannot send the MT-FORWARD-SHORT-MESSAGE-Response [SMS-DELIVER-REPORT] to
the SMS-GMSC, but an xIRI containing the SMSMessage record is still generated.
NOTE 6: This is only applicable to the SMS-MT case and can be derived from the
TP-MMS (More Message to Send) field present in the SMS-DELIVER sent to the UE
(via AMF in the Namf_Communications_N1N2MessageTransfer).
NOTE 7: This is derived from the ueLocation field of SmsRecord IE received
from the AMF in the Nsmsf_SMService_UplinkSMS message (TS 29.540 [21]). For
the SMSMessage record, the SMCP message is CP-DATA_RP-DATA [SMS-SUBMIT, SMS-
COMMAND] and for the SMSReport record, the SMCP message is CP-DATA-RP-ACK
[SMS-DELIVER-REPORT]. This value is encoded as a _userLocation_ parameter
(_location >locationInfo>userLocation_), see Annex A.
#### 6.2.5.4 Generation of IRI over LI_HI2
When an xIRI containing the SMSMessage record is received over LI_X2 from the
IRI-POI in SMSF, the MDF2 shall send the IRI message over LI_HI2 without undue
delay. The IRI message shall contain a copy of the SMSMessage record received
over LI_X2. The SMSMessage record may be enriched by other information
available at the MDF (e.g. additional location information).
If the MDF2 is provisioned with the TruncateTPUserData parameter included, the
truncatedSMSTPDU field shall be used in SMSMessage IRI message, otherwise, the
sMSTPDU field shall be used.
The threeGPP33128DefinedIRI field (see ETSI TS 102 232-7 [10] clause 15) shall
be populated with the BER-encoded IRIPayload.
The timestamp field of the psHeader structure shall be set to the time that
the SMSF event was observed (i.e. the timestamp field of the xIRI).
Each SMSMessage record shall be delivered as an IRI REPORT (see ETSI TS 102
232-1 [9] clause 5.2.10) with a new CIN assigned (see ETSI TS 102 232-1 [9]
clause 5.2.4).
Each SMSReport record shall be delivered as a separate IRI REPORT (see ETSI TS
102 232-1 [9] clause 5.2.10) with the same CIN as the IRI REPORT of the
associated SMSMessage record.
### 6.2.6 LI support at NRF
The SIRF present within the NRF provides SBA-related information to the LIPF
over the LI_SI interface. Details for this interface are not considered in the
present document and are for further study.
## 6.3 4G
### 6.3.1 General
The present document allows two options for EPC LI stage 3 interfaces for 4G /
LTE:
1\. Use LI_X1, LI_X2 and LI_X3 interfaces specified below in the present
document for stage 3.
2\. Use TS 33.107 [36] clause 12 natively as defined in that document.
In both cases, the present document specifies the stage 3 for the LI_HI1,
LI_HI2 and LI_HI3 interfaces.
### 6.3.2 LI at MME
#### 6.3.2.1 Provisioning over LI_X1
The IRI-POI present in the MME is provisioned over LI_X1 by the LIPF using the
X1 protocol as described in clause 5.2.2.
The POI in the MME shall support the target identifiers specified in TS 33.107
[36] clause 12.2.1.1:
> \- IMSI (using the IMSI target identifier format from ETSI TS 103 221-1
> [7]).
>
> \- MSISDN (using the E164Number target identifier format from ETSI TS 103
> 221-1 [7]).
>
> \- ME Identity (using the IMEI target identifier format from ETSI TS 103
> 221-1 [7]).
#### 6.3.2.2 Generation of xIRI over LI_X2
##### 6.3.2.2.1 General
The IRI-POI present in the MME shall send the xIRIs over LI_X2 for each of the
events listed in TS 33.107 [36] clause 12.2.1.1, the details of which are
specified in clause 12.2.3 of the same TS, and in case of SMS over NAS as
specified in clause 18.2.4 of TS 33.107 [36].
For all records except MMEIdentifierAssociation (see clause 6.3.2.2.2), the
IRI-POI present in the MME shall set the payload format to
EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 and ETSI TS 103
221-2 [8] clause 5.4. The payload field shall contain an
EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12]
clauses 10.5, 15.2 and B.9.
As the LIID may be not available at the MME but is mandatory in
EpsHI2Operations.EpsIRIContent according to Annex B.9 of TS 33.108 [12], its
value in the lawfulInterceptionIdentifier field of the encoded PDU shall be
set to the fixed string \"LIIDNotPresent\".
In addition to the xIRIs events listed in TS 33.107 [36], the MME shall
support xIRI containing the MMEIdentiferAssociation record in clause
6.3.2.2.2.
The IRI-POI in the MME shall only generate xIRI containing the
MMEIdentifierAssociation record in the following scenarios;
\- IdentifierAssociation: MMEIdentifierAssociation and Tracking Area/EPS
Location Update (see TS 33.107 [36] clause 12.2.1.2) records shall be
generated. No other record types shall be generated for that target.
\- All: All MME record types shall be generated.
##### 6.3.2.2.2 MME identifier association
The IRI-POI present in the MME shall generate an xIRI containing an
MMEIdentifierAssociation record when the IRI-POI present in the MME detects a
new identifier association for a UE matching one of the target identifiers
provided via LI_X1. Generation of this record is subject to this record type
being enabled for a specific target (see clause 6.3.2.2.1).
Table 6.3.2-1: Payload for MMEIdentifierAssociation record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +=============================+=============================+=======+ | iMSI | IMSI associated with the | M | | | procedure. (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | iMEI | IMEI used in the procedure, | C | | | if available (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | mSISDN | MSISDN used in the | C | | | procedure, if available | | | | (see NOTE 1). | | +-----------------------------+-----------------------------+-------+ | gUTI | LTE GUTI used in the | M | | | procedure. | | +-----------------------------+-----------------------------+-------+ | location | Location information | M | | | available when identifier | | | | association occurs. | | | | | | | | Encoded as a _userLocation_ | | | | parameter | | | | (_location >locationInfo> | | | | userLocation_) and, when | | | | Dual Connectivity is | | | | activated, as an | | | | _additionalCellIDs_ | | | | parameter | | | | (_location >locatio | | | | nInfo>additionalCellIDs_), | | | | see Annex A. | | +-----------------------------+-----------------------------+-------+ | tAIList | List of tracking areas | C | | | associated with the | | | | registration area within | | | | which the UE is current | | | | registered. (See NOTE 2). | | +-----------------------------+-----------------------------+-------+ | NOTE 1: IMSI shall always | | | | be provided, in addition to | | | | the warrant target | | | | identifier if different to | | | | IMSI. Other identifiers | | | | shall be provided if | | | | available. | | | | | | | | NOTE 2: List shall be | | | | included each time there is | | | | a change to the | | | | registration area. | | | +-----------------------------+-----------------------------+-------+
When transmitting the xIRI, the IRI-POI present in the MME shall set the
payload format to 2, and provide the payload as a BER-encoded
TS33128Payloads.XIRIPayloads structure.
#### 6.3.2.3 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in the MME, the MDF2
shall generate the corresponding IRI message and deliver it over LI_HI2
without undue delay. The IRI message shall contain a copy of the relevant
record received in the xIRI over LI_X2.
When option 2 specified in clause 6.3.1 is used, the MDF2 shall generate IRI
messages based on the proprietary information received from the MME and
provide it over LI_HI2 without undue delay.
For all messages except MMEIdentifierAssociation, the IRI messages shall
include an IRI payload encoded according to Annex B.9 of TS 33.108 [12]. The
MDF2 shall encode the correct value of LIID in the IRI message, replacing the
value \"LIIDNotPresent\" given in the xIRI (see clause 6.3.2.2).
For MMEIdentifierAssociation messages, the IRI message shall be encoded as an
IRIEvent structure according to Annex B, and used to populate the
threeGPP33128DefinedIRI field in ETSI TS 102 232-7 [10] clause 15.
The IRI messages shall be delivered over LI_HI2 according to clause 10 of ETSI
TS 102 232-7 [10].
### 6.3.3 LI at SGW/PGW and ePDG
#### 6.3.3.1 Provisioning over LI_X1
The IRI-POI and CC-POI present in the SGW/PGW and ePDG are provisioned over
LI_X1 by the LIPF using the X1 protocol as described in clause 5.2.2. A single
task may be used.
The POIs in the SGW/PGW and ePDG shall support the target identifiers
specified in TS 33.107 [36] clause 12.2.1.1:
\- IMSI (using the IMSI target identifier format from ETSI TS 103 221-1 [7]).
\- MSISDN (using the E164Number target identifier format from ETSI TS 103
221-1 [7]).
\- ME Identity (using the IMEI target identifier format from ETSI TS 103 221-1
[7]).
#### 6.3.3.2 Generation of xIRI over LI_X2
The IRI-POI present in the SGW/PGW and ePDG shall send the xIRIs over LI_X2
for each of the events listed in TS 33.107 [36] clause 12.2.1.2, the details
of which are specified in clause 12.2.3 of the same TS.
The IRI-POI present in the SGW/PGW and ePDG shall set the payload format to
EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 and ETSI TS 103
221-2 [8] clause 5.4. The payload field shall contain an
EpsHI2Operations.EpsIRIContent structure encoded according to TS 33.108 [12]
clauses 10.5 and B.9.
As the LIID may be not available at the SGW/PGW and ePDG but is mandatory in
EpsHI2Operations.EpsIRIContent according to Annex B.9 of TS 33.108 [12], its
value in the lawfulInterceptionIdentifier field of the encoded PDU shall be
set to the fixed string \"LIIDNotPresent\".
#### 6.3.3.3 Generation of xCC at CC-POI in the SGW/PGW and ePDG over LI_X3
The CC-POI present in the SGW/PGW and ePDG shall send xCC over LI_X3 for each
IP packet belonging to the target's communication.
Each X3 PDU shall contain the contents of the user plane packet given using
the GTP-U, IP or Ethernet payload format.
The CC-POI present in the SGW/PGW and ePDG shall set the payload format to
indicate the appropriate payload type (5 for IPv4 Packet, 6 for IPv6 Packet, 7
for Ethernet frame or 12 for GTP-U packet as per ETSI TS 103 221-2 [8] clause
5.4).
If it is required to send the ICE-type for the xCC, the CC-POI shall set the
NFID attribute (see ETSI TS 103 221-2 [8] clause 5.3.7) to the appropriate
value from the ICE-type enumeration in TS 33.108 [12] Annex B.10 as a single
octet. As an example, an ICE-type of \"sgw\" is indicated by setting the
attribute to value 3.
The CC-POI present in the SGW/PGW and ePDG may use the Additional XID Related
Information attributes to facilitate efficient delivery of xCC, as specified
in ETSI TS 103 221-2 [8] clause 5.3.22.
#### 6.3.3.4 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in the SGW/PGW or ePDG,
the MDF2 shall generate the corresponding IRI message and deliver it over
LI_HI2 without undue delay. The IRI message shall contain a copy of the
relevant record received in the xIRI over LI_X2.
When option 2 specified in clause 6.3.1 is used, the MDF2 shall generate IRI
messages based on the proprietary information received from the SGW/PGW or
ePDG and provide it over LI_HI2 without undue delay.
The IRI messages shall include an IRI payload encoded according to Clause 10.5
and Annex B.9 of TS 33.108 [12]. The MDF2 shall encode the correct value of
LIID in the IRI message, replacing the value \"LIIDNotPresent\" given in the
xIRI (see clause 6.3.2.2).
The IRI messages shall be delivered over LI_HI2 according to clause 10 of ETSI
TS 102 232-7 [10].
#### 6.3.3.5 Generation of CC over LI_HI3
When xCC is received over LI_X3 from the CC-POI in the SGW/PGW or ePDG, the
MDF3 shall generate the corresponding CC and deliver it over LI_HI3 without
undue delay. The CC message shall contain a copy of the relevant xCC received
over LI_X3.
When option 2 specified in clause 6.3.1 is used, the MDF3 shall generate CC
based on the proprietary information received from the SGW/PGW or ePDG and
provide it over LI_HI3 without undue delay.
The CC shall include a CC payload encoded according to Annex B.10 of TS 33.108
[12].
The CC shall be delivered over LI_HI3 according to clause 10 of ETSI TS 102
232-7 [10].
## 6.4 3G
The Present document does not specify details of the LI interfaces for 3G /
UMTS. Details for this release are specified in TS 33.108 [12].
# 7 Service Layer Based Interception
## 7.1 Introduction
This clause describes any remaining fields, behaviours or details necessary to
implement the required LI interfaces for specific 3GPP-defined services which
are not described in clauses 4 and 5.
## 7.2 Central Subscriber Management
### 7.2.1 General description
This clause describes interception at central subscriber management functions
or databases (e.g. UDM and HSS).
### 7.2.2 LI at UDM
#### 7.2.2.1 General description
In 3GPP network, the UDM provides the unified data management for UE. The UDM
shall have LI capabilities to generate the target UE's service area
registration and subscription management related xIRI.
#### 7.2.2.2 Provisioning over LI_X1
The IRI-POI present in the UDM is provisioned over LI_X1 by the LIPF using the
X1 protocol as described in clause 5.2.2.
The POI in the UDM shall support the following target identifier formats in
the ETSI TS 103 221-1 [7] messages:
\- SUPIIMSI.
\- SUPINAI.
\- PEIIMEI.
\- PEIIMEISV.
\- GPSIMSISDN.
\- GPSINAI.
#### 7.2.2.3 Generation of xIRI over LI_X2
##### 7.2.2.3.1 General description
The IRI-POI present in the UDM shall send xIRI over LI_X2 for each of the
events listed in TS 33.127 [5] clause 7.2.2.4, the details of which are
described in the following sub-clauses.
##### 7.2.2.3.2 Serving system
The IRI-POI in the UDM shall generate an xIRI containing the
UDMServingSystemMessage record when it detects the following events:
\- When the UDM receives the amf3GPPAccessRegistration from the AMF as part of
the Nudm_UEContextManagement_Registration service operation (see TS 29.503
[25], clause 5.3.2.2.2).
\- When the UDM receives the amfNon3GPPAccessRegistration from the AMF as part
of the Nudm_UEContextManagement_Registration service operation (see TS 29.503
[25], clause 5.3.2.2.3).
When a target UE registers to both 3GPP and non-3GPP access, two separate
xIRIs each containing the UDMServingSystemMessage record may be generated by
the IRI-POI in the UDM.
Table 7.2.2.3-1: Payload for UDMServingSystemMessage record
* * *
Field name Description M/C/O sUPI SUPI associated with the target UE, see TS
29.571 [17]. M pEI PEI associated with the target UE, when known, see TS
29.571 17]. C gPSI GPSI associated with the target UE, when known, see TS
29.571 [17]. C gUAMI Serving AMF's GUAMI, when known. See NOTE 1. C gUMMEI
Serving MME's GUMMEI See NOTE 2. C pLMNID Serving PLMN Id. See TS 29.571 [17].
See NOTE 3. C servingSystemMethod Identifies method used to access the serving
system, see NOTE 4. M serviceID Identifies the target UE's 5G service
identifiers (e.g. SNSSAI, CAGID) when the AMF Registration is executed, when
known, see TS 29.571 [17]. C
* * *
NOTE 1: GUAMI is the global unique identifier of an AMF [2] and its format is
defined in TS 29.571 [17]. As defined in TS 23.501 [2], clause 5.9.4, GUAMI
consists of \ \ \ \ \. The
GUAMI is reported if the UDM receives the same from the AMF.
NOTE 2: GUMMEI is the global unique identifier of an MME and its format is
defined in TS 23.003 [19]. As defined in TS 23.003 [19], clause 2.8.1, GUMMEI
consists of \ \ \. The GUMMEI is reported if the UDM
has this information (e.g. in a combined UDM/HSS).
NOTE 3: PLMN Id provides the VPLMN Id when the target UE is roaming.
NOTE 4: This identifies whether the xIRI containing the
UDMServingSystemMessage record is generated due to the reception of an
amf3GPPAccessRegistration, or an amfNon3GPPAccessRegistration. See TS 29.503
[25].
TS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g.
IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with
reference to SUPI it requires \'imsi-\',\'nai-\'). However, identifiers and
parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of
the present document, so without the prefix specified in TS 29.571 [17].
##### 7.2.2.3.3 Subscriber record change
The IRI-POI in the UDM shall generate an xIRI containing the
UDMSubscriberRecordChangeMessage record when it detects the following events:
\- When the UDM receives the Amf3GppAccessRegistration from the AMF as part of
the Nudm_UEContextManagement Registration service operation (see TS 29.503
[25], clause 5.3.2.2.2) and detects a change in the SUPI/GPSI/PEI association
for a target.
\- When the UDM receives the AmfNon3GppAccessRegistration from the AMF as part
of the Nudm_UEContextManagement Registration service operation (see TS 29.503
[25], clause 5.3.2.2.3) and detects a change in the SUPI/GPSI/PEI association
for a target.
\- When the UDM receives the Amf3GppAccessRegistrationModification from the
AMF as part of Nudm_UEContextManagement Update service operation (see TS
29.503 [25], clause 5.3.2.6.2) and detects a change in the SUPI/GPSI/PEI
association for a target.
\- When the UDM receives the AmfNon3GppAccessRegistrationModification from the
AMF as part of Nudm_UEContextManagement Update service operation (see TS
29.503 [25], clause 5.3.2.6.3) and detects a change in the SUPI/GPSI/PEI
association for a target.
\- When the UDM receives the PeiUpdateInfo from the HSS as part of the
Nudm_UEContextManagement PEI Update service operation (see TS 29.503 [25],
clause 5.3.2.10.2) and detects a change in the SUPI/GPSI/PEI association for a
target.
\- Upon detection of modification between SUPI and GPSI association (if UDR is
deployed, when UDM receives the DataChangeNotify from the UDR including the
modified GPSI as part of the Nudr_DataRepository Notification service
operation (see TS 29.504 [48], clause 5.2.2.8.3 and TS 29.505 [49], clause
5.4.2.6); if UDR is not deployed, when the modification is detected as result
of UDM provisioning).
\- Upon UE de-provisioning (if UDR is deployed, when UDM receives the
DataChangeNotify from the UDR including the deleted SUPI as part of the
Nudr_DataRepository Notification service operation (see TS 29.504 [48], clause
5.2.2.8.3 and TS 29.505 [49], clause 5.4.2.6); if UDR is not deployed, when
the modification is detected as result of UDM deprovisioning).
\- When a new SUPI is provisioned (if UDR is deployed, when UDM receives the
DataChangeNotify from the UDR including the new and the old SUPI as part of
the Nudr_DataRepository Notification service operation (see TS 29.504 [48],
clause 5.2.2.8.3 and TS 29.505 [49], clause 5.4.2.6); if UDR is not deployed,
when the modification is detected as result of UDM provisioning).
\- When the UDM receives the Amf3GppAccessRegistrationModification from the
AMF as part of Nudm_UEContextManagement Update service operation (see TS
29.503 [25], clause 5.3.2.2.2) and detects a change in the ServiceID
association for a target.
\- Upon detection of modification in the Service ID association (if UDR is
deployed, when UDM receives the DataChangeNotify from the UDR including the
modified Service ID as part of the Nudr_DataRepository Notification service
operation (see TS 29.504 [48], clause 5.2.2.8.3 and TS 29.505 [49], clause
5.4.2.6); if UDR is not deployed, when the modification is detected as a
result of UDM provisioning.
When a target UE registers to both 3GPP and non-3GPP access, two separate
xIRIs each containing the UDMSubscriberRecordChangeMessage report record may
be generated by the IRI-POI in the UDM.
Table 7.2.2.3-2: Payload for UDMSubscriberRecordChangeMessage record
* * *
Field name Description M/C/O sUPI SUPI currently associated with the target
UE, see TS 29.571 [17], see NOTE 1 C pEI PEI currently associated with the
target UE, when known, see TS 29.571 17]. C gPSI GPSI currently associated
with the target UE, when known, see TS 29.571 [17]. C oldSUPI Old SUPI
associated with the target UE, when known. C oldServiceID Identifies the
target UE's old service identifiers (e.g. SNSSAI, CAGID), when known, see TS
29.571. C oldPEI Old PEI associated with the target UE, when known. C oldGPSI
Old GPSI associated with the target UE, when known. C
subscriberRecordChangeMethod Identifies the trigger of Subscriber Record
Change operation, see NOTE 2. M serviceID Identifies the target UE's 5G
service identifiers that have been modified (e.g. SNSSAI, CAGID), when known,
see TS 29.571. C
* * *
NOTE 1: When an identity is changed, both the old one and the current one are
reported; the target identity is always reported either as current identity or
old identity depending on the change, together with the other current
identities (e.g. ServiceIDs), if available. If the target identity is changed,
the old identity represents the target otherwise the current identity
represents the target (as examples, when SUPI is the target and PEI is
changing, SUPI (target), PEI and old PEI, along with GPSI, if available, are
reported; when SUPI is the target and SUPI is changed, SUPI and oldSUPI
(target), along with PEI and GPSI, if available, are reported).
NOTE 2: This identifies whether the xIRI containing the
UDMSubscriberRecordChangeMessage record is generated due to a PEI change, a
GPSI, a SUPI modification or ServiceID change, or a UE de-provisioning.
TS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g.
IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with
reference to SUPI it requires \'imsi-\',\'nai-\'). However, identifiers and
parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of
the present document, so without the prefix specified in TS 29.571 [17].
##### 7.2.2.3.4 Cancel location
The IRI-POI in the UDM shall generate an xIRI containing the UDMCancelLocation
record when it detects the following events:
\- When the UDM sends DeregistrationData to AMF as part of the
Nudm_UEContextManagement DeregistrationNotification service operation (see TS
29.503 [25], clause 5.3.2.3.2).
\- When the UDM receives the Amf3GppAccessRegistrationModification with
PurgeFlag set from the AMF as part of Nudm_UEContextManagement Deregistration
service operation (see TS 29.503 [25], clause 5.3.2.4.2).
\- When UDM receives the AmfNon3GppAccessRegistrationModification with
PurgeFlag set from the AMF as part of Nudm_UEContextManagement Deregistration
service operation (see TS 29.503 [25], clause 5.3.2.4.3).
When a target UE deregisters from both 3GPP and non-3GPP access, two separate
xIRIs each containing the UDMCancelLocation report record may be generated by
the IRI-POI in the UDM.
Table 7.2.2.3.4-1: Payload for UDMCancelLocationMessage record
Field name Description M/C/O
* * *
sUPI SUPI associated with the target UE, see TS 29.571 [17]. M pEI PEI
associated with the target UE, when known, see TS 29.571 17]. C gPSI GPSI
associated with the target UE, when known, see TS 29.571 [17]. C gUAMI
Previous serving AMF's GUAMI, when known. See NOTE 1. C pLMNID Previous
serving PLMN ID. See TS 29.571 [17]. See NOTE 2. C cancelLocationMethod
Identifies method used to access the serving system, see NOTE 3. M
NOTE 1: GUAMI is the global unique identifier of an AMF [2] and its format is
defined in TS 29.571 [17]. As defined in TS 23.501 [2], clause 5.9.4, GUAMI
consists of \ \ \ \ \. The
GUAMI is reported if the UDM receives the same from the AMF.
NOTE 2: PLMN ID provides the vPLMN ID when the target UE is roaming.
NOTE 3: This identifies whether the xIRI containing the
UDMCancelLocationMessage record is generated due to the reception of a UDM
deregistration, and AMF 3GPP Access deregistration, or an AMF Non 3GPP access
deregistration.
TS 29.571 [17] requires that the encoding of 3GPP defined identifiers (e.g.
IMSI, NAI) shall be prefixed with its corresponding prefix (e.g. with
reference to SUPI it requires \'imsi-\',\'nai-\'). However, identifiers and
parameters shall be coded over the LI_X2 and LI_HI2 according to Annex A of
the present document, so without the prefix specified in TS 29.571 [17].
##### 7.2.2.3.5 Location information request
Location information request is not supported in the present document.
#### 7.2.2.4 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in UDM, the MDF2 shall
send an IRI message over LI_HI2 without undue delay.
The timestamp field of the psHeader structure shall be set to the time that
the UDM event was observed (i.e. the timestamp field of the xIRI).
Each UDMServiceSystemMessage record shall be delivered as an IRI REPORT (see
ETSI TS 102 232-1 [9] clause 5.2.10). The CIN shall be omitted (see ETSI TS
102 232-1 [9] clause 5.2.4).
### 7.2.3 LI at HSS
#### 7.2.3.1 General
The HSS provides the support functions in the mobility management, session
setup and user authentication and access authorization.
The present document allows two options for HSS LI stage 3 interfaces:
1\. Use LI_X1 and LI_X2 interfaces specified below in the present document for
stage 3.
2\. Use TS 33.107 [36] natively as defined in that document.
In both cases, the present document specifies the stage 3 for the LI_HI1 and
LI_HI2 interfaces.
#### 7.2.3.2 Provisioning over LI_X1
The IRI-POI present in the HSS is provisioned over LI_X1 by the LIPF using the
X1 protocol as described in clause 5.2.2 of the present document.
The IRI-POI in the HSS shall support the target identifiers specified in TS
33.107 [36]:
\- IMSI (using the IMSI target identifier format from ETSI TS 103 221-1 [7]).
\- MSISDN (using the E164Number target identifier format from ETSI TS 103
221-1 [7]).
\- IMEI (using the IMEI target identifier format from ETSI TS 103 221-1 [7]).
\- IMPU (using the IMPU target identifier format from ETSI TS 103 221-1 [7]).
\- IMPI (using the IMPI target identifier format from ETSI TS 103 221-1 [7]).
#### 7.2.3.3 Generation of xIRI over LI_X2
The IRI-POI present in the HSS shall send the xIRIs over LI_X2 for each of the
events listed in TS 33.107 [36], the details of which are also specified in
the same TS [36].
The IRI-POI present in the HSS shall set the payload format to
EpsHI2Operations.EpsIRIContent (value 14), see clause 5.3 of the present
document and ETSI TS 103 221-2 [8] clause 5.4. The payload field shall contain
an EpsHI2Operations.EpsIRIContent structure encoded according to clause B.9 of
TS 33.108 [12].
As the LIID may be not available at the HSS but is mandatory in
EpsHI2Operations.EpsIRIContent according to clause B.9 of TS 33.108 [12], its
value in the lawfulInterceptionIdentifier field of the encoded PDU shall be
set to the fixed string \"LIIDNotPresent\".
#### 7.2.3.4 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in the HSS, the MDF2
shall generate the corresponding IRI message and deliver it over LI_HI2
without undue delay. The IRI message shall contain a copy of the relevant
record received in the xIRI over LI_X2.
When option 2 specified in clause 7.2.3.1 above is used, the MDF2 shall
generate IRI messages based on the proprietary information received from the
HSS and provide it over LI_HI2 without undue delay.
The IRI messages shall include an IRI payload encoded according to clause B.9
of TS 33.108 [12]. The MDF2 shall encode the correct value of LIID in the IRI
message, replacing the value \"LIIDNotPresent\" given in the xIRI (see clause
7.2.3.3 above).
The IRI messages shall omit the CIN (see ETSI TS 102 232-1 [9] clause 5.2.4).
The IRI messages shall be delivered over LI_HI2 according to clause 10 of ETSI
TS 102 232-7 [10].
## 7.3 Location
### 7.3.1 Lawful Access Location Services (LALS)
#### 7.3.1.1 General description
The LALS architecture and functionality is specified in TS 33.127 [5], clause
7.3.3.
#### 7.3.1.2 Provisioning over LI_X1
#### 7.3.1.2.1 Target positioning service
For the LALS target positioning service (TS 33.127 [5], clause 7.3.3.2) the
IRI-POI provided by the LI-LCS Client is directly provisioned over LI_X1 by
the LIPF using the LI_X1 protocol as described in clause 5.2.2 with the
TaskDetailsExtensions field of the ActivateTask message specifying the type of
the target positioning request, immediate vs. periodic, and, in the latter
case, the periodicity of the positioning requests.
Based on national regulatory requirements and CSP policy, the
TaskDetailsExtensions may also include the QoS parameters (specified in OMA-
TS-MLP-V3_5-20181211-C [20]) for the use on the Le interface towards the LCS
Server/GMLC. Alternatively, the QoS parameters may be statically configured in
the LI-LCS Client.
Table 7.3.1.2-1 shows the details of the LI_X1 ActivateTask message used for
the LI-LCS Client provisioning for the target positioning service.
The LI_X1 DeactivateTask shall be issued by the LIPF to terminate the target
positioning service and withdraw the associated provisioning data, except for
the Immediate target positioning service in which case the LI_X1
DeactivateTask is not used.
Table 7.3.1.2-1: ActivateTask message for LI-LCS Client target positioning
provisioning
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 field | Description | M/C/O | | name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One of the following (see | M | | | ETSI TS 103 221-1 [7]): | | | | | | | | - SUPIIMSI. | | | | | | | | - SUPINAI. | | | | | | | | - GPSIMSISDN. | | | | | | | | - GPSINAI. | | | | | | | | - IMSI. | | | | | | | | - MSISDN (E164Number | | | | target ID format, per ETSI | | | | TS 103 221-1 [7]). | | | | | | | | - IMPU. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints of | M | | | LI_X2 interface. These | | | | delivery endpoints are | | | | configured in LI-LCS Client | | | | using the CreateDestination | | | | message as described in | | | | ETSI TS 103 221-1 [7], | | | | clause 6.3.1 prior to the | | | | task activation. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | "Immediate" or "Periodic". | M | | | | | | PositioningServiceType | | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Time interval between the | C | | | positioning requests in | | | PositioningPeriodicity | case of Periodic | | | | positioning, in seconds. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Set of optional parameters | O | | | for MLP SLIR message, per | | | PositioningParameters | OMA-TS-MLP-V3_5-20181211-C | | | | [20]: | | | | | | | | - requested location type | | | | (clause 5.3.60). | | | | | | | | - requested response type | | | | (clause 5.3.112.1). | | | | | | | | - max location age (clause | | | | 5.3.65). | | | | | | | | - response timing required | | | | (clause 5.3.106). | | | | | | | | - response timer (clause | | | | 5.3.107). | | | | | | | | - horizontal accuracy with | | | | QoS class (clause 5.3.44). | | | | | | | | - altitude accuracy with | | | | QoS class (clause 5.3.6). | | | | | | | | - motion state request | | | | (clause 5.3.70). | | +-----------------------------+-----------------------------+-------+
#### 7.3.1.2.2 Triggered location service
For the LALS triggered location service (TS 33.127 [5], clause 7.3.3.3) the
LTF, as an IRI-TF, is provisioned by the LIPF using the LI_X1 protocol as
described in clause 5.2.2. The "TaskDetailsExtensions" parameter of the
ActivateTask message in this case will carry the address of LI-LCS Client to
be used for the service and, optionally, the positioning parameters for use on
the Le interface, similar to the target positioning provisioning.
Prior to issuing one or more \"ActivateTask\" requests towards an LTF, the
LIPF shall provision the LTF with the LI_X2 destinations by using the
\"CreateDestination\" operation(s), as per clause 5.2.2.
Table 7.3.1.2-2 defines the details of the LI_X1 ActivateTask message used for
the LTF provisioning for the Triggered Location service.
Table 7.3.1.2-2: ActivateTask message for LTF triggered location service
provisioning
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 field | Description | M/C/O | | name | | | +-----------------------------+-----------------------------+-------+ | XID | XID assigned by LIPF. | M | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One or more of the | M | | | following (see ETSI TS 103 | | | | 221-1 [7]): | | | | | | | | - SUPIIMSI. | | | | | | | | - SUPINAI. | | | | | | | | - GPSIMSISDN. | | | | | | | | - GPSINAI. | | | | | | | | - IMSI. | | | | | | | | - MSISDN (E164Number | | | | target ID format, per ETSI | | | | TS 103 221-1 [7]). | | | | | | | | - IMPU. | | | | | | | | NOTE: An ActivateTask for | | | | an LTF may be issued by the | | | | LIPF if and only if at | | | | least one of the | | | | identifiers in the above | | | | list was specified in the | | | | warrant. | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI-LCS Client LI_X2. These | | | | delivery endpoints are | | | | configured in LTF using the | | | | CreateDestination message | | | | as described in ETSI TS 103 | | | | 221-1 [7], clause 6.3.1 | | | | prior to the task | | | | activation. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | The IP address of the | M | | | LI-LCS Client for | | | LI-LCSClientAddress | triggering. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Set of optional parameters | O | | | for MLP SLIR message, per | | | PositioningParameters | OMA-TS-MLP-V3_5-20181211-C | | | | [20]: | | | | | | | | - requested location type | | | | (clause 5.3.60). | | | | | | | | - requested response type | | | | (clause 5.3.112.1). | | | | | | | | - max location age (clause | | | | 5.3.65). | | | | | | | | - response timing required | | | | (clause 5.3.106). | | | | | | | | - response timer (clause | | | | 5.3.107). | | | | | | | | - horizontal accuracy with | | | | QoS class (clause 5.3.44). | | | | | | | | - altitude accuracy with | | | | QoS class (clause 5.3.6). | | | | | | | | - motion state request | | | | (clause 5.3.70). | | +-----------------------------+-----------------------------+-------+
#### 7.3.1.3 Triggering over LI_T2
An LTF, as an IRI-TF, provisioned as described in clause 7.3.1.2.2, triggers
the LI-LCS Client (which plays the role of a triggered IRI-POI) using the
LI_T2 protocol as described in clause 5.2.4. The "TaskDetailsExtensions" in
the LI_T2 "ActivateTask" message carries the positioning parameters mapped
from information the LTF receives from the ADMF over the LI_X1. The LI_T2
"ActivateTask" message header may include a correlation ID from the triggering
xIRI, if available.
Prior to issuing one or more "ActivateTask" requests towards an LI-LCS Client,
the LTF shall provision the LI-LCS Client with the LI_X2 destinations by using
the "CreateDestination" operation(s), as per clause 5.2.2. The LI-LCS Client
shall deactivate the task on its own upon issuing the final xIRI for the
trigger. There is no DeactivateTask operation on the LI_T2 for the LI-LCS
Client.
The Table 7.3.1.3-1 shows the details of the LI_T2 ActivateTask message used
by the LTF to trigger LI-LCS Client for the triggered location service.
Table 7.3.1.3-1: ActivateTask message from LTF to LI-LCS Client for the
triggered location service triggering
+-----------------------------+-----------------------------+-------+ | ETSI TS 103 221-1 field | Description | M/C/O | | name | | | +-----------------------------+-----------------------------+-------+ | XID | The same value as in the | M | | | LTF provisioning (clause | | | | 7.3.3.2.2). | | +-----------------------------+-----------------------------+-------+ | TargetIdentifiers | One or more of the | M | | | following (see ETSI TS 103 | | | | 221-1 [7]): | | | | | | | | - SUPIIMSI. | | | | | | | | - SUPINAI. | | | | | | | | - GPSIMSISDN. | | | | | | | | - GPSINAI. | | | | | | | | - IMSI. | | | | | | | | - MSISDN (E164Number | | | | target ID format, per ETSI | | | | TS 103 221-1 [7]). | | | | | | | | - IMPU. | | | | | | | | NOTE: The target identifier | | | | used shall correspond to | | | | one of the target | | | | identifiers in the xIRI | | | | observed by the LTF, and | | | | shall be one of the | | | | identifiers provided in the | | | | ActivateTask for the LTF | | | | (clause 7.3.1.2.2). | | +-----------------------------+-----------------------------+-------+ | DeliveryType | Set to "X2Only". | M | +-----------------------------+-----------------------------+-------+ | ListOfDIDs | Delivery endpoints for | M | | | LI-LCS Client LI_X2. These | | | | delivery endpoints are | | | | configured in LI-LCS Client | | | | by the LTF using the | | | | CreateDestination message | | | | as described in ETSI TS 103 | | | | 221-1 [7], clause 6.3.1 | | | | prior to the task | | | | activation. | | +-----------------------------+-----------------------------+-------+ | CorrelationID | Correlates the requested | C | | | location to the triggering | | | | xIRI, if available. | | +-----------------------------+-----------------------------+-------+ | TaskDetailsExtensions/ | Set of optional parameters | O | | | for MLP SLIR message, per | | | PositioningParameters | OMA-TS-MLP-V3_5-20181211-C | | | | [20]: | | | | | | | | - requested location type | | | | (clause 5.3.60). | | | | | | | | - requested response type | | | | (clause 5.3.112.1). | | | | | | | | - max location age (clause | | | | 5.3.65). | | | | | | | | - response timing required | | | | (clause 5.3.106). | | | | | | | | - response timer (clause | | | | 5.3.107). | | | | | | | | - horizontal accuracy with | | | | QoS class (clause 5.3.44). | | | | | | | | - altitude accuracy with | | | | QoS class (clause 5.3.6). | | | | | | | | - motion state request | | | | (clause 5.3.70). | | +-----------------------------+-----------------------------+-------+
#### 7.3.1.4 Generation of xIRI over LI_X2
The IRI-POI provided by the LI-LCS client shall deliver the target location
reports to respective MDF(s) as xIRI over the LI_X2 interface.
Table 7.3.1.4-1: LALSReport record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | sUPI | SUPI of the target, if used | C | | | for the service (see NOTE). | | +-----------------------------+-----------------------------+-------+ | gPSI | GPSI of the target, if used | C | | | for the service (see NOTE). | | +-----------------------------+-----------------------------+-------+ | iMSI | IMSI of the target, if used | C | | | for the service (see NOTE). | | +-----------------------------+-----------------------------+-------+ | mSISDN | MSISDN of the target, if | C | | | used for the service (see | | | | NOTE). | | +-----------------------------+-----------------------------+-------+ | iMPU | IMPU of the target, if used | C | | | for the service (see NOTE). | | +-----------------------------+-----------------------------+-------+ | location | Location of the target, if | C | | | obtained successfully. | | | | | | | | Encoded as a | | | | _positioningInfo_ parameter | | | | (_l | | | | ocation >positioningInfo_). | | | | Both the _positionInfo_ | | | | (_location >posi | | | | tioningInfo>positionInfo_) | | | | and the _mLPPositionData_ | | | | (_locati | | | | on >positioningInfo>rawMLP | | | | Response>mLPPositionData_) | | | | are present in the case of | | | | successful positioning. In | | | | the case of positioning | | | | failure only the | | | | _mLPErrorCode | | | | (loc | | | | ation >positioningInfo>raw | | | | MLPResponse>mLPErrorCode)_ | | | | is present. See Annex A. | | +-----------------------------+-----------------------------+-------+ | NOTE: One and only one of | | | | SUPI, GPSI, IMSI, MSISDN, | | | | IMPU shall be present and | | | | it shall correspond to the | | | | target identifier included | | | | in the respective | | | | ActivateTask message for | | | | the LI-LCS Client. | | | +-----------------------------+-----------------------------+-------+
The LI_X2 header (as per clause 5.3.2) of the LALSReport record presented in
Table 7.3.1.4-1 shall contain the correlation ID (if provided) from a
respective LI_T2 ActivationTask message.
#### 7.3.1.5 Generation of IRI over LI_HI2
The LALSReport payload, defined in clause 7.3.1.4, shall be used as the
payload of the respective LALSReport record, no payload mediation is required.
A LALSReport message shall be assigned the same CIN (see ETSI TS 102 232-1 [9]
clause 5.2.4) as the IRI message that triggered the LALS reporting, if that
triggering IRI message is assigned a CIN. Otherwise, i.e. when the LALSReport
is a result of the LALS Target Positioning, or the triggering IRI message has
no CIN assigned, the CIN in the LALSReport shall be omitted.
NOTE: In some specific scenarios the amount of LALS reports data may overload
the LI-HI2 and/or LI_X2 interfaces. To prevent the overload, a flow control
for LALS triggered location reports may be implemented in MDF and/or LI-LCS
client, e.g. by limiting the frequency of the reports for individual targets.
### 7.3.2 Cell database information reporting
#### 7.3.2.1 General description
When the location information present within an xIRI includes the cell
identity, the MDF2 that receives the xIRI may retrieve the cell site
information for that cell from a CSP database and deliver the same to the LEMF
either within the IRI message generated from the received xIRI or in a
separate IRI message containing the MDFCellSiteReport record.
For each intercept, if the MDF2 reports the cell site information, then it
shall provide such information at least on the initial appearance of the cell
identity in the related xIRI.
NOTE: The CSP needs to ensure that the most recent cell site information is
reported to the LEA.
#### 7.3.2.2 Delivery of cell site information over LI_HI2
The cell site information is encoded as the cellSiteInformation ASN.1
parameter and delivered either within the location field of an IRI message
carrying the respective cell identity, or in a stand-alone IRI message
containing the MDFCellSiteReport record.
The MDF2 shall use the IRI message containing the MDFCellSiteReport record to
convey cell site information retrieved asynchronously with the sending of the
IRI message that caused the retrieval. The MDFCellSiteReport record shall be
delivered as an IRI REPORT (see ETSI TS 102 232-1 [9] clause 5.2.10) and
allocated the same CIN, if any, as the IRI message that caused the retrieval.
When the cell site information is readily available at MDF2 or is retrieved
synchronously (i.e. blocking the sending of the IRI message until the
retrieval is complete), the cell site information shall be conveyed within the
location field of the IRI message that caused the retrieval.
The cell site information for multiple cell identities can be delivered to the
LEMF within an IRI message that carries the respective cell identities or
within the IRI message containing the MDFCellSiteReport record (see Annex A).
### 7.3.3 Use of the Location structure
#### 7.3.3.1 General description
The _Location_ structure is used to convey geolocation information.
When the reference datum used for a latitude and longitude given in the
_GeographicalCoordinates_ structure is known by the operator, the reference
datum shall be identified in the _mapDatumInformation_ field. The reference
datum identity shall be specified as an Open Geospatial Consortium URN, as
defined in [35].
## 7.4 Messaging
### 7.4.1 Introduction
Stage 3 intercept capabilities for SMS at an SMSF are defined in clause 6.2.5.
Stage 3 for MMS interception follows in clause 7.4.3.
### 7.4.2 LI at the MMS Proxy-Relay
#### 7.4.2.1 Provisioning over LI_X1
The IRI-POI present in the MMS Proxy-Relay is provisioned over LI_X1 by the
LIPF using the X1 protocol as described in clause 5.2.2.
The POI in the MMS Proxy-Relay shall support the following target identifier
formats in the ETSI TS 103 221-1 [7] messages:
\- E164Number.
\- EmailAddress.
\- GPSIMSISDN.
\- IMPI.
\- IMPU.
\- IMSI.
\- SUPIIMSI.
\- NAI.
\- SUPINAI.
#### 7.4.2.2 Generation of xIRI over LI_X2
The IRI-POI present in the MMS Proxy-Relay shall send xIRI over LI_X2 for the
events listed in clause 7.5.2.3 of TS 33.127 [5], which is further expanded in
the present document in clause 7.4.2.4 below.
#### 7.4.2.3 Generation of xCC over LI_X3
The CC-POI present in the MMS Proxy-Relay shall send xCC over LI_X3 for any
MMS event where CC is available and authorized for reporting for the events
listed in clause 7.5.2.3 of TS 33.127 [5].
The xCC payload shall consist of the MMS contents given as a MIME encoded
document (RFC 2045) according to OMA-TS-MMS_ENC [39]. The payload format shall
be set to \"MIME document\" (value 15).
#### 7.4.2.4 MMS Record Generation Cases
The triggers for MMS record generation are detailed in each of the clauses
7.4.3.1 through 7.4.3.20. All triggers are defined by the detection of
messages at the local MMS Proxy-Relay. They belong to one of two following
high-level categories:
\- at the local MMS Proxy-Relay, the sending or arrival of a message, either
to or from the local target UE, using OMA-TS-MMS_ENC [39] definitions, or
\- at the local MMS Proxy-Relay, the sending or arrival of a message to or
from a non-local MMS Proxy-Relay, pertaining to messages either to or from a
non-local target UE served by that non-local MMS Proxy-Relay, using the inter-
proxy MM4 reference point, 3GPP TS 23.140 [40] clause 8.4 definitions.
The present document assumes that the intercepted MMS complies with version
1.3 of OMA-TS-MMS_ENC [39]. If the intercepted messages do not comply fully,
or the version is other than 1.3, parameters are required to be provided only
if available.
In the following tables, the acronym Multimedia Message (MM) refers to a
message in particular, while Multimedia Message Service (MMS) refers to the
service in general.
### 7.4.3 MMS Records
#### 7.4.3.1 MMSSend
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSSend record when the MMS Proxy-Relay sends _m-send-conf_ (as defined in
OMA-TS-MMS_ENC [39] clause 6.1.1) to local target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-send-req_ message (from the local target UE to
the MMS Proxy-Relay), and the _m-send-conf_ message (from MMS Proxy-Relay to
the local target UE).
Table 7.4.3-1: Payload for MMSSend
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | transactionID | An ID used to correlate an MMS | M | | | request and response between the | | | | target and the MMS Proxy-Relay. As | | | | defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.63. | | +---------------------+--------------------------------------+-------+ | version | The version of MM, to include major | M | | | and minor version. | | +---------------------+--------------------------------------+-------+ | dateTime | Date and Time when the MM was last | M | | | handled (either originated or | | | | forwarded). For origination, | | | | included by the sending MMS client | | | | or the originating MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | originatingMMSParty | ID(s) of the originating party in | M | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating party in | C | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | | | | | | | This parameter is included if the | | | | corresponding MM includes a "TO" | | | | field. | | | | | | | | At least one of the | | | | terminatingMMSParty, cCRecipients, | | | | or bCCRecipients must be included. | | +---------------------+--------------------------------------+-------+ | cCRecipients | Address of a recipient; the \"CC\" | C | | | field may include addresses of | | | | multiple recipients. When address | | | | translation occurs, both the pre and | | | | post translated addresses (with | | | | appropriate correlation) are | | | | included. This parameter is included | | | | if the corresponding MM includes a | | | | "CC" field. | | | | | | | | At least one of the | | | | terminatingMMSParty, cCRecipients, | | | | or bCCRecipients must be included. | | +---------------------+--------------------------------------+-------+ | bCCRecipients | Address of a recipient; the \"BCC\" | C | | | field may include addresses of | | | | multiple recipients. When address | | | | translation occurs, both the pre and | | | | post translated addresses (with | | | | appropriate correlation) are | | | | included. This parameter is included | | | | if the corresponding MM includes a | | | | "BCC" field. | | | | | | | | At least one of the | | | | terminatingMMSParty, cCRecipients, | | | | or bCCRecipients must be included. | | +---------------------+--------------------------------------+-------+ | direction | Indicates the direction of the MM. | M | | | This shall be encoded as "from | | | | target." | | +---------------------+--------------------------------------+-------+ | subject | The subject of the MM. Include if | C | | | sent to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | messageClass | Class of the MM. For example, a | C | | | value of \"auto\" is automatically | | | | generated by the UE. If the field is | | | | not present, the class should be | | | | interpreted as \"personal.\" Include | | | | if sent to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | expiry | Length of time in seconds the MM | M | | | will be stored in MMS Proxy-Relay or | | | | time to delete the MM. The field has | | | | two formats, either absolute or | | | | relative. | | +---------------------+--------------------------------------+-------+ | desiredDeliveryTime | Date and Time of desired delivery. | C | | | Indicates the earliest possible | | | | delivery of the MM to the recipient. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | priority | Priority of the MM assigned by the | C | | | originator MMS Client. Include if | | | | sent to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | senderVisibility | An indication that the sender\'s | C | | | address should not be delivered to | | | | the recipient. Sent by the target to | | | | indicate the target\'s visibility to | | | | the other party or if not signalled | | | | by the target and the default is to | | | | not make target visible to the other | | | | party. The values given in | | | | OMA-TS-MMA_ENC [39] clause 7.3.52 | | | | shall be encoded as follows: "Show" | | | | = True, "Hide" = False. Include if | | | | sent to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | deliveryReport | Specifies whether the originator MM | C | | | UE requests a delivery report from | | | | each recipient. Sent by the target | | | | to indicate the desired delivery | | | | report. The values given in | | | | OMA-TS-MMA_ENC [39] clause | | | | 7.3.13. shall be encoded as follows: | | | | "Yes" = True, "No" = False. Include | | | | if sent to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | readReport | Specifies whether the originator MM | C | | | UE requests a read report from each | | | | recipient. Sent by the target to | | | | indicate the desired read report. | | | | The values given in OMA-TS-MMA_ENC | | | | [39] clause 7.3.52 shall be | | | | encoded as follows: "Yes" = True, | | | | "No" = False. Include if sent to the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | store | Specifies whether the originator MM | C | | | UE wants the submitted MM to be | | | | saved in the user\'s MMBox, in | | | | addition to sending it. Sent by the | | | | target to indicate the MM is to be | | | | stored. The values given in | | | | OMA-TS-MMA_ENC [39] clause 7.3.52 | | | | shall be encoded as follows: "Yes" = | | | | True, "No" = False. Include if sent | | | | to the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+
+--------------------+-------------------------------------------+---+ | state | Identifies the value of the MM State | C | | | associated with a to be stored or stored | | | | MM. See OMA-TS-MMA_ENC [39] clause | | | | 7.3.33. Include if sent to the MMS | | | | Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | flags | Identifies a keyword to add or remove | C | | | from the list of keywords associated with | | | | a stored MM. See OMA-TS-MMA_ENC [39] | | | | clause 7.3.32. Include if sent to the MMS | | | | Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | replyCharging | If this field is present its value is set | C | | | to "accepted" or "accepted text only" and | | | | the MMS-version-value of the | | | | M-Notification.ind PDU is higher than | | | | 1.0, this header field will indicate that | | | | a reply to this particular MM is free of | | | | charge for the recipient. | | | | | | | | If the Reply-Charging service is offered | | | | and the request for reply-charging has | | | | been accepted by the MMS service provider | | | | the value of this header field SHALL be | | | | set to "accepted" or "accepted text | | | | only". | | | | | | | | See OMA-TS-MMA_ENC [39] clause 7.3.43. | | | | Include if sent to the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | applicID | Identification of the originating | C | | | application of the original MM. Sent by | | | | the target to identify the destination | | | | application as defined in OMA-TS-MMA_ENC | | | | [39] clause 7.3.2. Include if sent to | | | | the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | replyApplicID | Identification of an application to which | C | | | replies, delivery reports, and read | | | | reports are addressed. Sent by the target | | | | to identify the application to which | | | | replies, delivery reports, and read | | | | reports are addressed as defined in | | | | OMA-TS-MMS_ENC [39] clause 7.3.42. | | | | Include if sent to the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | auxApplicInfo | Auxiliary application addressing | C | | | information as indicated in the original | | | | MM. As defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.4. Include if sent to the MMS | | | | Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | contentClass | Classifies the content of the MM to the | C | | | smallest content class to which the | | | | message belongs. Sent by the target to | | | | identify the class of the content. See | | | | OMA-TS-MMS_ENC [39] clause 7.3.9. | | | | Include if sent to the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | dRMContent | Indicates if the MM contains any | C | | | DRM-protected element. Provide when sent | | | | by the target to indicate if the MM | | | | contains any DRM-protected element. The | | | | values given in OMA-TS-MMA_ENC [39] | | | | clause 7.3.54 shall be encoded as | | | | follows: "Yea" = True, "No" = False. | | | | Include if sent to the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | adaptationAllowed | Provide when sent by the target to | C | | | identify whether the target wishes the MM | | | | to be adapted or not. If overridden, an | | | | indication shall be included in the | | | | parameter. Include if sent to the MMS | | | | Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | contentType | The content type of the MM. See | M | | | OMA-TS-MMS_ENC [39] clause 7.3.11 | | +--------------------+-------------------------------------------+---+ | responseStatus | MMS specific status. See OMA-TS-MMS_ENC | M | | | [39] clause 7.3.48. | | +--------------------+-------------------------------------------+---+ | responseStatusText | Text that qualifies the Response Status. | C | | | Include if sent to the target. As defined | | | | in OMA-TS-MMA_ENC [39] clause 7.3.49. | | | | Include if sent by the MMS Proxy-Relay. | | +--------------------+-------------------------------------------+---+ | messageID | An ID assigned by the MMS Proxy-Relay to | M | | | uniquely identify an MM. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.29. | | +--------------------+-------------------------------------------+---+
#### 7.4.3.2 MMSSendByNonLocalTarget
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSSendByNonLocalTarget record when the MMS Proxy-Relay receives
_MM4_forward.REQ_ (as defined in TS 23.140 [40] clause 8.4.1) from the non-
local MMS Proxy-Relay, that contains a non-local target ID.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _MM4_forward.REQ_ message (from the non-local MMS
Proxy-Relay to the local MMS Proxy-Relay).
Table 7.4.3-2: Payload for MMSSendByNonLocalTarget
* * *
Field name Description M/C/O version The version of MM, to include major and
minor version. M transactionID An ID used to correlate an MMS request and
response between the proxies. As defined in TS 23.140 [40] clause 8.4.1.4. M
messageID An ID assigned by the MMS Proxy-Relay to uniquely identify an MM. As
defined in TS 23.140 [40] clause 8.4.1.4. M terminatingMMSParty ID(s) of the
terminating party in one or more of the formats described in 7.4.2.1. M
originatingMMSParty ID(s) of the originating party in one or more of the
formats described in 7.4.2.1. M direction Indicates the direction of the MM.
This shall be encoded as "from target." M contentType The content type of the
MM. See OMA-TS-MMS_ENC [39] clause 7.3.11 M messageClass Class of the MM. For
example, a value of \"auto\" is automatically generated by the UE. If the
field is not present, the class should be interpreted as \"personal.\" Include
if sent to the MMS Proxy-Relay. C dateTime Date and Time when the MM was last
handled (either originated or forwarded). M expiry Length of time in seconds
the MM will be stored in MMS Proxy-Relay or time to delete the MM. The field
has two formats, either absolute or relative. Include if sent to the MMS
Proxy-Relay. C deliveryReport Specifies whether the originator MM UE requests
a delivery report from each recipient. Indicates the desired delivery report.
The values given in TS 23.140 [40] clause 8.4.1.4 shall be encoded as follows:
"Yes" = True, "No" = False. Included if it exists in the MMS Proxy-Relay
message. Include if sent to the MMS Proxy-Relay. C priority Priority of the MM
assigned by the originator MMS Client. Reported if sent by the target. Include
if sent to the MMS Proxy-Relay. C senderVisibility An indication that the
sender\'s address should not be delivered to the recipient. Indicates the
target\'s visibility to the other party or if not signalled by the target and
the default is to not make target visible to the other party. The values given
in TS 23.140 [40] clause 8.4.1.4 shall be encoded as follows: "Show" = True,
"Hide" = False. Include if sent to the MMS Proxy-Relay. C readReport Specifies
whether the originator MM UE requests a read report from each recipient.
Provide when sent by the target to indicate the desired read report. The
values given in TS 23.140 [40] clause 8.4.1.4 shall be encoded as follows:
"Yes" = True, "No" = False. Include if sent to the MMS Proxy-Relay. C subject
The subject of the MM. Include if sent by the target. C forwardCount The
number of times the MM was forwarded C previouslySentBy History of UEs that
have forwarded (including originally submitted) the MM. Include if sent to the
MMS Proxy-Relay. C previouslySentByDateTime The timestamp associated with the
previous forward events. Include if sent to the MMS Proxy-Relay. C applicID
Identification of the originating application of the original MM. Provide when
sent by the target to identify the destination application as defined in TS
23.140 [40] clause 8.4.1.4. Include if sent to the MMS Proxy-Relay. C
replyApplicID Identification of an application to which replies, delivery
reports, and read reports are addressed. Provide when sent by the target to
identify the application to which replies, delivery reports, and read reports
are addressed as defined in TS 23.140 [40] clause 8.4.1.4. Include if sent to
the MMS Proxy-Relay. C auxApplicInfo Auxiliary application addressing
information as indicated in the original MM. As defined in OMA-TS-MMA_ENC [39]
clause 7.3.4. Include if sent to the MMS Proxy-Relay. C contentClass
Classifies the content of the MM to the smallest content class to which the
message belongs. Identifies the class of the content. Include if sent to the
MMS Proxy-Relay. Include if sent to the MMS Proxy-Relay. C dRMContent
Indicates if the MM contains any DRM-protected element. Indicates if the MM
contains any DRM-protected element. The values given as defined in TS 23.140
[40] clause 8.4.1.4 shall be encoded as follows: "Yes" = True, "No" = False.
Include if sent to the MMS Proxy-Relay. C adaptationAllowed Identifies whether
the target wishes the MM to be adapted or not. If overridden, an indication
shall be included in the parameter. Include if sent to the MMS Proxy-Relay. C
* * *
#### 7.4.3.3 MMSNotification
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSNotification record when the MMS Proxy-Relay sends a _m-notification-ind_
(as defined in OMA-TS-MMS_ENC [39] clause 6.2) to the MMS client in the local
target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-notification-ind_ message (from the local MMS
Proxy-Relay to the local target).
Table 7.4.3-3: Payload for MMSNotification
+-------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-------------------------+-----------------------------+-------+ | transactionID | An ID used to correlate an | M | | | MMS request and response | | | | between the target and the | | | | MMS Proxy-Relay. As defined | | | | in OMA-TS-MMA_ENC[ AA] | | | | clause 7.3.29. | | +-------------------------+-----------------------------+-------+ | version | The version of MM, to | M | | | include major and minor | | | | version. | | +-------------------------+-----------------------------+-------+ | originatingMMSParty | ID(s) of the originating | C | | | party in one or more of the | | | | formats described in | | | | 7.4.2.1 | | | | | | | | When address translation | | | | occurs (such as the case of | | | | a token sent by the client | | | | and replaced with a proper | | | | address by the MMS | | | | Proxy-Relay), both the pre | | | | and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | | | | | If the originating MMS | | | | client requested address | | | | hiding, but the MMS | | | | Proxy-Relay has access to | | | | the \"From\" field, this | | | | shall be reported, | | | | regardless of the fact that | | | | it may be hidden from the | | | | recepient. | | +-------------------------+-----------------------------+-------+ | direction | Indicates the direction of | M | | | the MM. This shall be | | | | encoded as "to target.\" | | +-------------------------+-----------------------------+-------+ | subject | The subject of the MM. | C | | | Include if sent by the MMS | | | | Proxy-Relay. | | +-------------------------+-----------------------------+-------+ | deliveryReportRequested | Specifies whether the | C | | | originator MMS UE requests | | | | a delivery report from each | | | | recipient. The values given | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.13 shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent by the MMS | | | | Proxy-Relay. | | +-------------------------+-----------------------------+-------+ | stored | Specifies whether the MM | C | | | was stored in the target\'s | | | | MMBox, and that the | | | | _content-location-value_ | | | | field is a reference to it. | | | | \"Stored\" is coded as | | | | True, and \"not Stored\" is | | | | coded as False. As defined | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.57. | | | | | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +-------------------------+-----------------------------+-------+ | messageClass | Class of the MM. For | M | | | example, a value of | | | | \"auto\" is automatically | | | | generated by the UE. | | +-------------------------+-----------------------------+-------+ | priority | Priority of the MM assigned | C | | | by the originator MMS | | | | Client. Include if sent by | | | | the MMS Proxy-Relay. | | +-------------------------+-----------------------------+-------+ | messageSize | Specifies the size of the | M | | | MM that was viewed or | | | | uploaded. Specified in | | | | bytes. | | +-------------------------+-----------------------------+-------+ | expiry | Length of time in seconds | M | | | the MM will be stored in | | | | MMS Proxy-Relay or time to | | | | delete the MM. The field | | | | has two formats, either | | | | absolute or relative. | | +-------------------------+-----------------------------+-------+ | replyCharging | If this field is present | C | | | its value is set to | | | | "accepted" or "accepted | | | | text only" and the | | | | MMS-version-value of the | | | | M-Notification.ind PDU is | | | | higher than 1.0, this | | | | header field will indicate | | | | that a reply to this | | | | particular MM is free of | | | | charge for the recipient. | | | | | | | | If the Reply-Charging | | | | service is offered and the | | | | request for reply-charging | | | | has been accepted by the | | | | MMS service provider the | | | | value of this header field | | | | SHALL be set to "accepted" | | | | or "accepted text only". | | | | | | | | See OMA-TS-MMA_ENC [39] | | | | clause 7.3.43. Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +-------------------------+-----------------------------+-------+
#### 7.4.3.4 MMSSendToNonLocalTarget
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSSendToNonLocalTarget record when the local MMS Proxy-Relay sends a
_MM4_forward.REQ_ (as defined in TS 23.140 [40] clause 8.4.1) to the non-local
MMS Proxy-Relay, that contains a non-local target ID.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _MM4_forward.REQ_ message (from the non-local MMS
Proxy-Relay to the local MMS Proxy-Relay).
Table 7.4.3-4: Payload for MMSSendToNonLocalTarget
* * *
Field name Description M/C/O version The version of MM, to include major and
minor version. M transactionID An ID used to correlate an MMS request and
response between the proxies. As defined in TS 23.140 [40] clause 8.4.1.4. M
messageID An ID assigned by the MMS Proxy-Relay to uniquely identify an MM. As
defined in TS 23.140 [40] clause 8.4.1.4. M terminatingMMSParty ID(s) of the
terminating party in one or more of the formats described in 7.4.2.1. M
originatingMMSParty ID(s) of the originating party in one or more of the
formats described in 7.4.2.1. M direction Indicates the direction of the MM.
This shall be encoded as "to target." M contentType The content type of the
MM. See OMA-TS-MMS_ENC [39] clause 7.3.11 M messageClass Class of the MM. For
example, a value of \"auto\" is automatically generated by the UE. If the
field is not present, the class should be interpreted as \"personal.\" Include
if sent by the MMS Proxy-Relay message. C dateTime Date and Time when the MM
was last handled (either originated or forwarded). M expiry Length of time in
seconds the MM will be stored in MMS Proxy-Relay or time to delete the MM. The
field has two formats, either absolute or relative. Include if sent by the MMS
Proxy-Relay message. C deliveryReportRequested Specifies whether the
originator MMS UE requests a delivery report from each recipient. Indicates
the desired delivery report. The values given in TS 23.140 [40] clause 8.4.1.4
shall be encoded as follows: "Yes" = True, "No" = False. Include if sent by
the MMS Proxy-Relay message. C priority Priority of the MM assigned by the
originator MMS Client. Reported if sent by the target. Include if sent by the
MMS Proxy-Relay message. C senderVisibility Indicates whether the sender\'s
address should not be delivered to the recipient. Indicates the target\'s
visibility to the other party or if not signalled by the target and the
default is to not make target visible to the other party. The values given in
TS 23.140 [40] clause 8.4.1.4 shall be encoded as follows: "Show" = True,
"Hide" = False. Include if sent by the MMS Proxy-Relay message. C readReport
Specifies whether the originator MMS UE requests a read report from each
recipient. Indicates the desired read report. The values given in TS 23.140
[40] clause 8.4.1.4 shall be encoded as follows: "Yes" = True, "No" = False.
Include if sent by the MMS Proxy-Relay message. C subject The subject of the
MM. Include if sent to the target. C forwardCount The number of times the MM
was forwarded C previouslySentBy History of UEs that have forwarded (including
originally submitted) the MM. Include if sent by the MMS Proxy-Relay message.
C previouslySentByDateTime The timestamp associated with the previous forward
events. Include if sent by the MMS Proxy-Relay message. C applicID
Identification of the originating application of the original MM. Provide when
sent by the target to identify the destination application as defined in TS
23.140 [40] clause 8.4.1.4. Include if sent by the MMS Proxy-Relay message. C
replyApplicID Identification of an application to which replies, delivery
reports, and read reports are addressed. identifies the application to which
replies, delivery reports, and read reports are addressed as defined in TS
23.140 [40] clause 8.4.1.4. Include if sent by the MMS Proxy-Relay message. C
auxApplicInfo Auxiliary application addressing information as indicated in the
original MM. As defined in OMA-TS-MMA_ENC [39] clause 7.3.4. Include if sent
by the MMS Proxy-Relay message. C contentClass Classifies the content of the
MM to the smallest content class to which the message belongs. Identifies the
class of the content. Include if sent by the MMS Proxy-Relay message. C
dRMContent Indicates if the MM contains any DRM-protected element. Indicates
if the MM contains any DRM-protected element. The values given as defined in
TS 23.140 [40] clause 8.4.1.4 shall be encoded as follows: "Yes" = True, "No"
= False. Include if sent by the MMS Proxy-Relay message. C adaptationAllowed
identifies whether the target wishes the MM to be adapted or not. If
overridden, an indication shall be included in the parameter. Include if sent
by the MMS Proxy-Relay message. C store Specifies whether the originator MMS
UE wants the submitted MM to be saved in the user\'s MMBox, in addition to
sending it. Indicates whether the MMS is to be stored. The values given in TS
23.140 [40] clause 8.4.1.4 shall be encoded as follows: "Yes" = True, "No" =
False. Include if sent by the MMS Proxy-Relay message. C
* * *
* * *
applicID Identification of the originating application of the original MM.
Identifies the destination application as defined in TS 23.140 [40] clause
8.4.1.4. Include if sent by the MMS Proxy-Relay message. C replyApplicID
Identification of an application to which replies, delivery reports, and read
reports are addressed. Identifies the application to which replies, delivery
reports, and read reports are addressed as defined in TS 23.140 [40] clause
8.4.1.4. Include if sent by the MMS Proxy-Relay message. C auxApplicInfo
Auxiliary application addressing information as indicated in the original MM.
As defined in OMA-TS-MMA_ENC [39] clause 7.3.4. Include if sent by the MMS
Proxy-Relay message. C contentClass Classifies the content of the MM to the
smallest content class to which the message belongs. Identifies the class of
the content. Include if sent by the MMS Proxy-Relay message. C dRMContent
Indicates if the MM contains any DRM-protected element. Indicates whether the
MM contains any DRM-protected element. The values given as defined in TS
23.140 [40] clause 8.4.1.4 shall be encoded as follows: "Yes" = True, "No" =
False. Include if sent by the MMS Proxy-Relay message. C
* * *
#### 7.4.3.5 MMSNotificationResponse
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSNotificationResponse record when the MMS Proxy-Relay receives a _m-
notifyresp-ind_ (as defined in OMA-TS-MMS_ENC [39] clause 6.2, Table 4) from
the MMS client in the target UE for the deferred retrieval case only. The
immediate retrieval trigger on _m-notifyresp-ind_ is in clause 7.4.3.7.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-notifyresp-ind_ message (from the local target
UE to the MMS Proxy-Relay).
Table 7.4.3-5: Payload for MMSNotificationResponse
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M direction Indicates the direction of the MM. This
shall be encoded as "to target" M status Provides a MM status. A status of
\"retrieved\" is only signalled by the retrieving UE after retrieval of the
MM. M reportAllowed Indication whether or not the sending of delivery report
is allowed by the recipient MMS Client. The values given in OMA-TS-MMA_ENC
[39] clause 7.3.47 shall be encoded as follows: "Yes" = True, "No" = False.
Include if sent to the MMS Proxy-Relay. C
* * *
#### 7.4.3.6 MMSRetrieval
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSRetrieval record when the MMS Proxy-Relay sends a _m-retrieve-conf_ (as
defined in OMA-TS-MMS_ENC [39] clause 6.3) to the MMS client in the target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-retrieve-conf_ message (from the MMS Proxy-
Relay to the local target UE).
Table 7.4.3-6: Payload for MMSRetrieval
+--------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +--------------------------+-----------------------------+-------+ | transactionID | An ID used to correlate an | M | | | MMS request and response | | | | between the target and the | | | | MMS Proxy-Relay. As defined | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.29. | | +--------------------------+-----------------------------+-------+ | version | The version of MM, to | M | | | include major and minor | | | | version. | | +--------------------------+-----------------------------+-------+ | messageID | An ID assigned by the MMS | M | | | Proxy-Relay to uniquely | | | | identify an MM. As defined | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.29. | | +--------------------------+-----------------------------+-------+ | dateTime | Date and Time when the MM | M | | | was last handled (either | | | | originated or forwarded). | | | | For origination, included | | | | by the sending MMS client | | | | or the originating MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | originatingMMSParty | ID(s) of the originating | C | | | party in one or more of the | | | | formats described in | | | | 7.4.2.1 | | | | | | | | When address translation | | | | occurs (such as the case of | | | | a token sent by the client | | | | and replaced with a proper | | | | address by the MMS | | | | Proxy-Relay), both the pre | | | | and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | previouslySentBy | History of UEs that have | C | | | forwarded (including | | | | originally submitted) the | | | | MM. Include if sent by the | | | | MMS Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | previouslySentByDateTime | The timestamp associated | C | | | with the previous forward | | | | events. Include if sent by | | | | the MMS Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating | C | | | party in one or more of the | | | | formats described in | | | | 7.4.2.1 | | | | | | | | When address translation | | | | occurs (such as the case of | | | | a token sent by the client | | | | and replaced with a proper | | | | address by the MMS | | | | Proxy-Relay), both the pre | | | | and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | | | | | | | At least one of the | | | | terminatingMMSParty or | | | | cCRecipients must be | | | | included. | | +--------------------------+-----------------------------+-------+ | cCRecipients | Address of a recipient; the | C | | | \"CC\" field may include | | | | addresses of multiple | | | | recipients. When address | | | | translation occurs, both | | | | the pre and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | | | | | | | At least one of the | | | | terminatingMMSParty or | | | | cCRecipients must be | | | | included. | | +--------------------------+-----------------------------+-------+ | direction | Indicates the direction of | M | | | the MM. This shall be | | | | encoded as "to target," or | | | | \"fromTarget,\" as | | | | appropriate. | | +--------------------------+-----------------------------+-------+ | subject | The subject of the MM. | C | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | state | Identifies the value of the | C | | | MM State associated with a | | | | to be stored or stored MM. | | | | See OMA-TS-MMA_ENC [39] | | | | clause 7.3.33. Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | flags | Identifies a keyword to add | C | | | or remove from the list of | | | | keywords associated with a | | | | stored MM. Include if sent. | | | | See OMA-TS-MMA_ENC [39] | | | | clause 7.3.32. Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | messageClass | Class of the MM. For | C | | | example, a value of | | | | \"auto\" is automatically | | | | generated by the UE. If the | | | | field is not present, the | | | | class should be interpreted | | | | as \"personal.\" Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | priority | Priority of the MM assigned | C | | | by the originator MMS | | | | Client. Include if sent by | | | | the MMS Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | deliveryReport | Specifies whether the | C | | | originator MM UE requests a | | | | delivery report from each | | | | recipient. Indicates | | | | whether a delivery report | | | | is desired. The values | | | | given in OMA-TS-MMA_ENC | | | | [39] clause 7.3.13. shall | | | | be encoded as follows: | | | | "Yes" = True, "No" = False. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | readReport | Specifies whether the | C | | | originator MM UE requests a | | | | read report from each | | | | recipient. Indicates | | | | whether a read report is | | | | desired. The values given | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.52 shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | replyCharging | If this field is present | C | | | its value is set to | | | | "accepted" or "accepted | | | | text only" and the | | | | MMS-version-value of the | | | | PDU is higher than 1.0, | | | | this header field will | | | | indicate that a reply to | | | | this particular MM is free | | | | of charge for the | | | | recipient. | | | | | | | | If the Reply-Charging | | | | service is offered and the | | | | request for reply-charging | | | | has been accepted by the | | | | MMS service provider the | | | | value of this header field | | | | SHALL be set to "accepted" | | | | or "accepted text only". | | | | | | | | See OMA-TS-MMA_ENC [39] | | | | clause 7.3.43. Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | retrieveStatus | MMS specific status. It is | C | | | used by the recipient MMS | | | | Proxy-Relay to inform the | | | | recipient MMS Client about | | | | errors, if any that | | | | occurred during the | | | | preceding retrieval | | | | operation. Include if sent | | | | by the MMS Proxy-Relay. | | +--------------------------+-----------------------------+-------+ | retrieveStatusText | Text that qualifies the | C | | | Retrieve Status. As defined | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.55. Include if | | | | sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-----------------------------+-------+
* * *
applicID Identification of the originating application of the original MM.
Sent by the target to identify the destination application as defined in OMA-
TS-MMA_ENC [39] clause 7.3.2. Include if sent by the MMS Proxy-Relay. C
replyApplicID Identification of an application to which replies, delivery
reports, and read reports are addressed. Sent by the target to identify the
application to which replies, delivery reports, and read reports are addressed
as defined in OMA-TS-MMS_ENC [39] clause 7.3.42. Include if sent by the MMS
Proxy-Relay. C auxApplicInfo Auxiliary application addressing information as
indicated in the original MM. As defined in OMA-TS-MMA_ENC [39] clause 7.3.4.
Include if sent by the MMS Proxy-Relay. C contentClass Classifies the content
of the MM to the smallest content class to which the message belongs. Sent by
the target to identify the class of the content. See OMA-TS-MMS_ENC [39]
clause 7.3.9. Include if sent by the MMS Proxy-Relay. C dRMContent Indicates
if the MM contains any DRM-protected element. Provide when sent by the target
to indicate if the MM contains any DRM-protected element. The values given in
OMA-TS-MMA_ENC [39] clause 7.3.54 shall be encoded as follows: "Yea" = True,
"No" = False. Include if sent by the MMS Proxy-Relay. C replaceID Indicates
the message ID of the message this one is intended to replace. Include if sent
by the MMS Proxy-Relay. C contentType The content type of the MM. See OMA-TS-
MMS_ENC [39] clause 7.3.11. M
* * *
#### 7.4.3.7 MMSDeliveryAck
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSDeliveryAck record when
\- the MMS Proxy-Relay receives an m-acknowledge-ind (as defined in OMA-TS-
MMS_ENC [39] clause 6.4) from the MMS client in the target UE (for deferred
retrieval), or
\- the MMS Proxy-Relay receives an m-notifyresp-ind (as defined in OMA-TS-
MMS_ENC [39] clause 6.4) from the MMS client in the target UE (for immediate
retrieval).
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-acknowledge-ind_ message (from the local target
UE to the MMS Proxy-Relay), and the _m-notifyresp-ind_ message (from the local
target UE to the MMS Proxy-Relay).
Table 7.4.3-7: Payload for MMSDeliveryAck
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M reportAllowed Indicates whether the target allows
sending of a delivery report. Encoded as \"Yes\" = True, \"No\" = False.
Include if received by the MMS Proxy-Relay. C status Provides a MM status. A
status of \"retrieved\" is only signalled by the retrieving UE after retrieval
of the MM. Include if received by the MMS Proxy-Relay and if generated from a
**_m-notifyresp-ind_**. C direction Indicates the direction of the MM. This
shall be encoded as "to target." M
* * *
#### 7.4.3.8 MMSForward
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSForward record when the MMS Proxy-Relay sends an _m-forward-conf_ (as
defined in OMA-TS-MMS_ENC [39] clause 6.5.2) to the MMS client in the target
UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-forward-req_ message (from the local target UE
to the MMS Proxy-Relay), and the _m-forward-conf_ message (from the MMS Proxy-
Relay to the local target UE).
Table 7.4.3-8: Payload for MMSForward
+-----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------+-----------------------------+-------+ | transactionID | An ID used to correlate an | M | | | MMS request and response | | | | between the target and the | | | | MMS Proxy-Relay. As defined | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.29. | | +-----------------------+-----------------------------+-------+ | version | The version of MM, to | M | | | include major and minor | | | | version. | | +-----------------------+-----------------------------+-------+ | dateTime | Date and Time when the MM | C | | | was last handled (either | | | | originated or forwarded). | | | | For origination, included | | | | by the sending MMS client | | | | or the originating MMS | | | | Proxy-Relay. Include if | | | | sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | originatingMMSParty | ID(s) of the originating | M | | | (forwarding) party in one | | | | or more of the formats | | | | described in 7.4.2.1 | | | | | | | | When address translation | | | | occurs (such as the case of | | | | a token sent by the client | | | | and replaced with a proper | | | | address to the MMS | | | | Proxy-Relay), both the pre | | | | and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | +-----------------------+-----------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating | C | | | party in one or more of the | | | | formats described in | | | | 7.4.2.1 | | | | | | | | When address translation | | | | occurs (such as the case of | | | | a token sent by the client | | | | and replaced with a proper | | | | address by the MMS | | | | Proxy-Relay), both the pre | | | | and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | | | | | | | At least one of the | | | | terminatingMMSParty, | | | | cCRecipients, or | | | | bCCRecipients must be | | | | included. | | +-----------------------+-----------------------------+-------+ | cCRecipients | Address of a recipient; the | C | | | \"CC\" field may include | | | | addresses of multiple | | | | recipients. When address | | | | translation occurs, both | | | | the pre and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | This parameter is included | | | | if the corresponding MM | | | | includes a "CC" field. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | | | | | | | At least one of the | | | | terminatingMMSParty, | | | | cCRecipients, or | | | | bCCRecipients must be | | | | included. | | +-----------------------+-----------------------------+-------+ | bCCRecipients | Address of a recipient; the | C | | | \"BCC\" field may include | | | | addresses of multiple | | | | recipients. When address | | | | translation occurs, both | | | | the pre and post translated | | | | addresses (with appropriate | | | | correlation) are included. | | | | This parameter is included | | | | if the corresponding MM | | | | includes a "BCC" field. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | | | | | | | At least one of the | | | | terminatingMMSParty, | | | | cCRecipients, or | | | | bCCRecipients must be | | | | included. | | +-----------------------+-----------------------------+-------+ | direction | Indicates the direction of | M | | | the MM. This shall be | | | | encoded as "from target." | | +-----------------------+-----------------------------+-------+ | expiry | Length of time in seconds | C | | | the MM will be stored in | | | | MMS Proxy-Relay or time to | | | | delete the MM. The field | | | | has two formats, either | | | | absolute or relative. | | | | Include either the | | | | signalled expiry or the | | | | default, whichever applies. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | desiredDeliveryTime | Date and Time of desired | C | | | delivery. Indicates the | | | | earliest possible delivery | | | | of the MM to the recipient. | | | | Include if sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | deliveryReportAllowed | An indication that the | C | | | target requested reporting | | | | to the original sender or | | | | the default, whichever | | | | applies. The values given | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.47 shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | deliveryReport | Specifies whether the | C | | | originator MMS UE requests | | | | a delivery report from each | | | | recipient. The values given | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.13. shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | store | Specifies whether the | C | | | originator MMS UE wants the | | | | submitted MM to be saved in | | | | the user\'s MMBox, in | | | | addition to sending it. | | | | Sent by the target to have | | | | the forwarded MM stored. | | | | The values given in | | | | OMA-TS-MMA_ENC [39] | | | | clause 7.3.52 shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+ | state | Identifies the value of the | C | | | MM State associated with a | | | | MM to be stored or stored | | | | MM. Sets the state for the | | | | forwarded MM when it is | | | | stored. As defined in | | | | OMA-TS-MMA_ENC [39] | | | | clause 7.3.33. Include if | | | | sent to the MMS | | | | Proxy-Relay. | | +-----------------------+-----------------------------+-------+
+---------------------+------------------------------------------+---+ | flags | Identifies a keyword to add or remove | C | | | from the list of keywords associated | | | | with a stored MM. Include if sent to the | | | | MMS Proxy-relay. See OMA-TS-MMA_ENC | | | | [39] clause 7.3.32. | | +---------------------+------------------------------------------+---+ | contentLocationReq | The content-location-value field defines | M | | | the URL for the MMS server location of | | | | the content to be retrieved as it | | | | appears in the m-forward-req. As defined | | | | in OMA-TS-MMA_ENC [39] clause 7.3.10. | | +---------------------+------------------------------------------+---+ | replyCharging | If this field is present its value is | C | | | set to "accepted" or "accepted text | | | | only" and the MMS-version-value is | | | | higher than 1.0, this header field will | | | | indicate that a reply to this particular | | | | MM is free of charge for the recipient. | | | | | | | | If the Reply-Charging service is offered | | | | and the request for reply-charging has | | | | been accepted by the MMS service | | | | provider the value of this header field | | | | SHALL be set to "accepted" or "accepted | | | | text only". | | | | | | | | See OMA-TS-MMA_ENC [39] clause | | | | 7.3.43. Include if sent to the MMS | | | | Proxy-Relay. | | +---------------------+------------------------------------------+---+ | responseStatus | MMS specific status. See OMA-TS-MMS_ENC | M | | | [39] clause 7.3.48. | | +---------------------+------------------------------------------+---+ | responseStatusText | Text that qualifies the Response Status. | C | | | Include if sent to the target. As | | | | defined in OMA-TS-MMA_ENC [39] clause | | | | 7.3.49. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+------------------------------------------+---+ | messageID | An ID assigned by the MMS Proxy-Relay to | C | | | uniquely identify an MM. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.29. | | | | Include if sent by the MMS Proxy-Relay. | | +---------------------+------------------------------------------+---+ | contentLocationConf | The _content-location-value_ field | C | | | defines the URL for the MMS server | | | | location of the MM as it appears in the | | | | _m-forward-conf_. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.10. | | | | Include if sent by the MMS Proxy-Relay. | | +---------------------+------------------------------------------+---+ | storeStatus | Indicates if the MM was successfully | C | | | stored in the MMBox. Include if sent by | | | | the MMS Proxy-Relay. | | +---------------------+------------------------------------------+---+ | storeStatusText | Text that qualifies the Store Status. As | C | | | defined in OMA-TS-MMA_ENC [39] clause | | | | 7.3.59. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+------------------------------------------+---+
#### 7.4.3.9 MMSDeleteFromRelay
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSDeleteFromRelay record when the MMS Proxy-Relay sends a _m-delete-conf_
(defined in OMA-TS-MMS_ENC [39]) to the MMS client in the target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-delete-req_ message (from the local target UE
to the MMS Proxy-Relay), and the _m-delete-conf_ message (from the MMS Proxy-
Relay to the local target UE).
Table 7.4.3-9: Payload for MMSDeleteFromRelay
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. M version The
version of MM, to include major and minor version. M direction Indicates the
direction of the MM. This shall be encoded as "to target," or \"fromTarget,\"
as appropriate. M contentLocationReq The _content-location-value_ field
defines the URL for the MMS server location of the MM as it appears in the _m-
delete-conf,_ as defined in OMA-TS-MMA_ENC [39] clause 7.3.10. Include if sent
to the MMS Proxy-Relay. M contentLocationConf The _content-location-value_
field defines the URL for the MMS server location of the MM as it appears in
the _m-delete-conf_ , as defined in OMA-TS-MMA_ENC [39] clause 7.3.10. Include
if sent by the MMS Proxy-Relay. C deleteResponseStatus The delete response, as
defined in OMA-TS-MMA_ENC [39] clause 7.3.48. M deleteResponseText The delete
response, as defined in OMA-TS-MMA_ENC [39] clause 7.3.49. Include if sent by
the MMS Proxy-Relay. C
* * *
#### 7.4.3.10 MMSMBoxStore
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSMBoxStore record when the MMS Proxy-Relay sends a m-mbox-store-conf
(defined in OMA-TS-MMS_ENC [39] clause 6.8) to the MMS client in the target
UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the m-mbox-store-req message (from the local target UE
to the MMS Proxy-Relay), and from the _m-mbox-store-conf_ message (from the
MMS Proxy-Relay to the local target UE).
Table 7.4.3-10: Payload for MMSMBoxStore
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M direction Indicates the direction of the MM. This
shall be encoded as "to target." M contentLocationReq The _content-location-
value_ field defines the URL for the MMS server location of the MM as it
appears in the _m-mbox-store-req_. As defined in OMA-TS-MMA_ENC [39] clause
7.3.10. Include if sent by the MMS Proxy-Relay. M state Identifies the value
of the MM State associated with a MM to be stored or stored MM. Sets the state
for the forwarded MM when it is stored. As defined in OMA-TS-MMA_ENC [39]
clause 7.3.33. Include if sent by the MMS Proxy-Relay. C flags Identifies a
keyword to add or remove from the list of keywords associated with a stored
MM. See OMA-TS-MMA_ENC [39] clause 7.3.32. Include if sent by the MMS Proxy-
Relay. C contentLocationConf The _content-location-value_ field defines the
URL for the MMS server location of the MM as it appears in the _m-mbox-store-
conf_. As defined in OMA-TS-MMA_ENC [39] clause 7.3.10. Include if sent by the
MMS Proxy-Relay. C storeStatus Indicates if the MM was successfully stored in
the MMBox. M storeStatusText Text that qualifies the Store Status. Include if
sent to the target. As defined in OMA-TS-MMA_ENC [39] clause 7.3.59. Include
if sent by the MMS Proxy-Relay. C
* * *
#### 7.4.3.11 MMSMBoxUpload
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSMBoxUpload record when the MMS Proxy-Relay sends a _m-mbox-upload-conf_
(defined in OMA-TS-MMS_ENC [39] clause 6.10) to the MMS client in the target
UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-mbox-upload-req_ message (from the local target
UE to the MMS Proxy-Relay), and from the _m-mbox-upload-conf_ message (from
the MMS Proxy-Relay to the local target UE).
Table 7.4.3-11: Payload for MMSMBoxUpload
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M direction Indicates the direction of the MM. This
shall be encoded as "to target," or \"fromTarget,\" as appropriate. M state
Identifies the value of the MM State associated with a MM to be stored or
stored MM. Sets the state for the forwarded MM when it is stored. As defined
in OMA-TS-MMA_ENC [39] clause 7.3.33. Include if sent by the MMS Proxy-Relay.
C flags Identifies a keyword to add or remove from the list of keywords
associated with a stored MM. See OMA-TS-MMA_ENC [39] clause 7.3.32. Include if
sent by the MMS Proxy-Relay. C contentType The content type of the MM. See
OMA-TS-MMS_ENC [39] clause 7.3.11 M contentLocation The _content-location-
value_ field defines the URL for the MMS server location of the MM. As defined
in OMA-TS-MMA_ENC [39] clause 7.3.10. Include if sent by the MMS Proxy-Relay.
C storeStatus Indicates if the MM was successfully stored in the MMBox. M
storeStatusText Text that qualifies the Store Status. Include if sent to the
target. As defined in OMA-TS-MMA_ENC [39] clause 7.3.59. Include if sent by
the MMS Proxy-Relay. C mMBoxDescription The MMBox description PDU as defined
in 7.4.3.20 corresponds to the particular MM. include if sent by the MMS
Proxy-Relay. C
* * *
#### 7.4.3.12 MMSMBoxDelete
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSMBoxDelete record when the MMS Proxy-Relay sends a _m-mbox-delete.conf_
(defined in OMA-TS-MMS_ENC [39]) to the MMS client in the target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-mbox-delete-req_ message (from the local target
UE to the MMS Proxy-Relay), and from the _m-mbox-delete-conf_ message (from
the MMS Proxy-Relay to the local target UE).
Table 7.4.3-12: Payload for MMSMBoxDelete
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M direction Indicates the direction of the MM. This
shall be encoded as "to target," or \"fromTarget,\" as appropriate. M
contentLocationReq The _content-location-value_ field defines the URL for the
MMS server location of the MM as it appears in the _m-mbox-delete-req_. As
defined in OMA-TS-MMA_ENC [39] clause 7.3.10. M contentLocationConf The
_content-location-value_ field defines the URL for the MMS server location of
the MM as it appears in the _m-mbox-delete-conf_. As defined in OMA-TS-MMA_ENC
[39] clause 7.3.10. Include if sent by the MMS Proxy-Relay. C responseStatus
MMS specific status. M responseStatusText Text that qualifies the Response
Status. As defined in OMA-TS-MMA_ENC [39] clause 7.3.49. C
* * *
#### 7.4.3.13 MMSDeliveryReport
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSDeliveryReport record when the MMS Proxy-Relay sends an _m-delivery-ind_
(as defined in OMA-TS-MMS_ENC [39] clause 6.11) to the MMS client in the
target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-delivery-ind_ message (from the MMS Proxy-Relay
to the local target UE).
Table 7.4.3-13: Payload for MMSDeliveryReport
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | version | The version of MM, to include major | M | | | and minor version. | | +---------------------+--------------------------------------+-------+ | messageID | An ID assigned by the MMS | M | | | Proxy-Relay to uniquely identify an | | | | MM. As defined in OMA-TS-MMA_ENC | | | | [39] clause 7.3.29. Include if | | | | sent by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating party of | M | | | the original message this Delivery | | | | Report refers to, in one or more of | | | | the formats described in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | dateTime | Date and Time when the MM was last | M | | | handled (either originated or | | | | forwarded).. Include if sent by the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | responseStatus | MMS specific status. | M | +---------------------+--------------------------------------+-------+ | responseStatusText | Text that qualifies the Response | C | | | Status. As defined in | | | | OMA-TS-MMA_ENC [39] clause | | | | 7.3.49. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | applicID | Identification of the originating | C | | | application of the original MM. Sent | | | | by the target to identify the | | | | destination application as defined | | | | in OMA-TS-MMA_ENC [39] clause | | | | 7.3.2. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | replyApplicID | Identification of an application to | C | | | which replies, delivery reports, and | | | | read reports are addressed. Sent by | | | | the target to identify the | | | | application to which replies, | | | | delivery reports, and read reports | | | | are addressed as defined in | | | | OMA-TS-MMS_ENC [39] clause | | | | 7.3.42. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | auxApplicInfo | Auxiliary application addressing | C | | | information as indicated in the | | | | original MM. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.4. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+
#### 7.4.3.14 MMSDeliveryReportNonLocalTarget
The IRI-POI in the MMS Proxy-Relay shall generate an xIRI containing an
MMSDeliveryReportNonLocalTarget record when the MMS Proxy-Relay:
\- sends MM4_delivery_report.REQ (as defined in TS 23.140 [40] clause 8.4.2),
that contains a non-local target ID, to the non-local MMS Proxy-Relay, or
\- receives MM4_delivery_report.REQ, that contains a non-local target ID, from
the non-local MMS Proxy-Relay.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _MM4_delivery_report.REQ_ message (from the local
MMS Proxy-Relay to the non-local MMS Proxy-Relay, or inversely).
Table 7.4.3-14: Payload for MMSDeliveryReportNonLocalTarget
* * *
Field name Description M/C/O version The version of MM, to include major and
minor version. M transactionID An ID used to correlate an MMS request and
response between the proxies. As defined in TS 23.140 [40] clause 8.4.1.4. M
messageID An ID assigned by the MMS Proxy-Relay to uniquely identify an MM. As
defined in TS 23.140 [40] clause 8.4.1.4. M terminatingMMSParty ID(s) of the
terminating party of the original message this Delivery Report refers to, in
one or more of the formats described in 7.4.2.1. M originatingMMSParty ID(s)
of the originating party of the original message this Delivery Report refers
to, in one or more of the formats described in 7.4.2.1. M direction Indicates
the direction of the MM. This shall be encoded as \"toTarget,\" or "from
target," as appropriate. M dateTime Date and Time when the MM was last handled
(either originated or forwarded). M forwardToOriginator Indicates whether the
MMS Proxy-Relay is allowed to forward the delivery report to the originating
UE. \"Yes\" is coded as True, and \"No\" is coded as False. Include if sent
to/by the MMS Proxy-Relay. C mMStatus Provides a MM status. A status of
\"retrieved\" is only signalled by the retrieving UE after retrieval of the
MM. M mMStatusExtension Extension of the MMStatus, that provides more
granularity. Include if sent to/by the MMS Proxy-Relay. C mMStatusText Text
that qualifies the MM Status. As defined in OMA-TS-MMA_ENC [39] clause 7.3.55.
Include if sent to/by the MMS Proxy-Relay. C applicID Identification of the
originating application of the original MM. Identifies the destination
application as defined in TS 23.140 [40] clause 8.4.1.4. Include if sent to/by
the MMS Proxy-Relay. C replyApplicID Identification of an application to which
replies, delivery reports, and read reports are addressed. Identifies the
application to which replies, delivery reports, and read reports are addressed
as defined in TS 23.140 [40] clause 8.4.1.4. Include if sent to/by the MMS
Proxy-Relay. C auxApplicInfo Auxiliary application addressing information as
indicated in the original MM. As defined in OMA-TS-MMA_ENC [39] clause 7.3.4.
Include if sent to/by the MMS Proxy-Relay. C
* * *
#### 7.4.3.15 MMSReadReport
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSReadReport record when the MMS Proxy-Relay:
\- sends a m-read-orig-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.7.2) to
the MMS client in the target UE, or
\- receives a m-read-rec-ind (as defined in OMA-TS-MMS_ENC [39] clause 6.7.2)
from the MMS client in the target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-read-orig-ind_ message (from the MMS Proxy-
Relay to the local target UE), and from the _m-read-rec-ind_ message (from the
local target UE to the MMS Proxy-Relay).
Table 7.4.3-15: Payload for MMSReadReport
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | version | The version of MM, to include major | M | | | and minor version. | | +---------------------+--------------------------------------+-------+ | messageID | An ID assigned by the MMS | M | | | Proxy-Relay to uniquely identify an | | | | MM. As defined in OMA-TS-MMA_ENC | | | | [39] clause 7.3.29. | | +---------------------+--------------------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating party (i.e. | M | | | the intended recipient of the read | | | | report or the originator of the | | | | initial MM message to which the read | | | | report applies) in one or more of | | | | the formats described in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | originatingMMSParty | ID(s) of the originating party (i.e. | M | | | the originator of the read report or | | | | the recipient the initial MM message | | | | to which the read report applies) in | | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | direction | Indicates the direction of the | M | | | original MM (**not** of this | | | | message). This shall be encoded | | | | either as \"from target,\" or "to | | | | target," as appropriate. | | +---------------------+--------------------------------------+-------+ | dateTime | Date and Time when the MM was last | C | | | handled (either originated or | | | | forwarded). Include if sent to/by | | | | the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | readStatus | Status of the MMS (e.g.read or | M | | | deleted without reading.) | | +---------------------+--------------------------------------+-------+ | applicID | Identification of the originating | C | | | application of the original MM. As | | | | defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.2. Include if sent to/by | | | | the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | replyApplicID | Identification of an application to | C | | | which replies, delivery reports, and | | | | read reports are addressed. As | | | | defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.42. Include if sent to/by | | | | the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | auxApplicInfo | Auxiliary application addressing | C | | | information as indicated in the | | | | original MM. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.4. | | | | Include if sent to/by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+
#### 7.4.3.16 MMSReadReportNonLocalTarget
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSReadReportNonLocalTarget record when the MMS Proxy-Relay:
\- sends a MM4_read_reply_report.REQ (as defined in TS 23.140 [40] clause
8.4.3), that contains a non-local target ID, to the non-local MMS Proxy-Relay,
or
\- receives a MM4_read_reply_report.REQ (as defined in TS 23.140 [40] clause
8.4.3), that contains a non-local target ID, from the non-local MMS Proxy-
Relay.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the **_MM4_read_reply_report.REQ_** message (from the
local MMS Proxy-Relay to the non-local MMS Proxy-Relay, or inversely).
Table 7.4.3-16: Payload for MMSReadReportNonLocalTarget
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | version | The version of MM, to include major | M | | | and minor version. | | +---------------------+--------------------------------------+-------+ | transactionID | An ID used to correlate an MMS | M | | | request and response between the | | | | proxies. As defined in TS 23.140 | | | | [40] clause 8.4.1.4. | | +---------------------+--------------------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating party in | M | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | originatingMMSParty | ID(s) of the originating party in | M | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. | | +---------------------+--------------------------------------+-------+ | direction | Indicates the direction of the | M | | | original MM (**not** of this | | | | message). This shall be encoded | | | | either as \"from target\" = True, or | | | | "to target" = False. | | +---------------------+--------------------------------------+-------+ | messageID | An ID assigned by the MMS | M | | | Proxy-Relay to uniquely identify an | | | | MM. As defined in TS 23.140 [40] | | | | clause 8.4.1.4. | | +---------------------+--------------------------------------+-------+ | dateTime | Date and Time when the MM was last | M | | | handled (either originated or | | | | forwarded). | | +---------------------+--------------------------------------+-------+ | readStatus | Status of the MMS (e.g.read or | M | | | deleted without reading.) | | +---------------------+--------------------------------------+-------+ | readStatusText | Text explanation corresponding to | C | | | the Read Status. Include if sent | | | | to/by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | applicID | Identification of the originating | C | | | application of the original MM. | | | | Identifies the destination | | | | application as defined in TS 23.140 | | | | [40] clause 8.4.1.4. Include if | | | | sent to/by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | replyApplicID | Identification of an application to | C | | | which replies, delivery reports, and | | | | read reports are addressed. | | | | Identifies the application to which | | | | replies, delivery reports, and read | | | | reports are addressed, as defined in | | | | TS 23.140 [40] clause 8.4.1.4. | | | | Include if sent to/by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | auxApplicInfo | Auxiliary application addressing | C | | | information as indicated in the | | | | original MM. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.4. | | | | Include if sent to/by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+
#### 7.4.3.17 MMSCancel
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSCancel record when the MMS Proxy-Relay sends a _m-cancel-req_ (as
defined in OMA-TS-MMS_ENC [39] clause 6.13) to the MMS client in the target
UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-cancel-req_ message (from the MMS Proxy-Relay
to the local target UE).
Table 7.4.3-17: Payload for MMSCancel
* * *
Field name Description M/C/O transactionID An ID used to correlate an MMS
request and response between the target and the MMS Proxy-Relay. As defined in
OMA-TS-MMA_ENC [39] clause 7.3.29. M version The version of MM, to include
major and minor version. M cancelID This field includes the Message ID
identifying the message to be cancelled. As defined in OMA-TS-MMA_ENC [39]
clause 7.3.6. M direction Indicates the direction of the original MM. This
shall be encoded as "to target.\" M
* * *
#### 7.4.3.18 MMSMBoxViewRequest
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSViewRequest record when the MMS Proxy-Relay receives a _m-mbox-view-req_
(as defined in OMA-TS-MMS_ENC [39] clause 6.9) from the MMS client in the
target UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-mbox-vew-req_ message (from the local target UE
to the MMS Proxy-Relay).
Table 7.4.3-18: Payload for MMSMBoxViewRequest
+-----------------+------------------------------------------+-------+ | Field name | Description | M/C/O | +-----------------+------------------------------------------+-------+ | transactionID | An ID used to correlate an MMS request | M | | | and response between the target and the | | | | MMS Proxy-Relay. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.29. | | +-----------------+------------------------------------------+-------+ | version | The version of MM, to include major and | M | | | minor version. | | +-----------------+------------------------------------------+-------+ | contentLocation | The _content-location-value_ field | C | | | defines the URL for the MMS Proxy-Relay | | | | location of the content to be retrieved. | | | | As defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.10. Include if sent to the | | | | MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | state | Specifies a MM State value to use in | C | | | selecting the messages to return. As | | | | defined in OMA-TS-MMA_ENC [39] clause | | | | 7.3.33. Include if sent to the MMS | | | | Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | flags | Specifies a MM Flags keyword to use in | C | | | selecting the messages to return in the | | | | response. See OMA-TS-MMA_ENC [39] | | | | clause 7.3.32. Include if sent to the | | | | MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | start | A number, indicating the index of the | C | | | first MM of those selected to have | | | | information returned in the response. | | | | Include if sent to the MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | limit | A number indicating the maximum number | C | | | of selected MMs whose information are to | | | | be returned in the response. | | | | | | | | If this is absent, information elements | | | | from all remaining MMs are to be | | | | returned. If this is zero then no | | | | MM-related information are to be | | | | returned. Include if sent to the MMS | | | | Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | mMSAttributes | A list of information elements that | C | | | should appear in the view for each | | | | selected message. Include if sent to the | | | | MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | mMSTotals | Indicates a request for or the actual | C | | | count of messages currently stored in | | | | the MMBox. The values given in | | | | OMA-TS-MMA_ENC [39] clause 7.3.62. | | | | shall be encoded as follows: "Yes" = | | | | True, "No" = False. Include if sent to | | | | the MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+ | mMSQuotas | Indicates a request for or the actual | C | | | quotas for the user\'s MMBox in messages | | | | or bytes. The values given in | | | | OMA-TS-MMA_ENC [39] clause 7.3.36. | | | | shall be encoded as follows: "Yes" = | | | | True, "No" = False. Include if sent to | | | | the MMS Proxy-Relay. | | +-----------------+------------------------------------------+-------+
#### 7.4.3.19 MMSMBoxViewResponse
The IRI-POI present in the MMS Proxy-Relay shall generate an xIRI containing
an MMSViewConfirm record when the MMS Proxy-Relay sends a _m-mbox-view.conf_
(as defined in OMA-TS-MMS_ENC [39] clause 6.9) to the MMS client in the target
UE.
The following table contains parameters generated by the IRI-POI, along with
parameters derived from the _m-mbox-vew-conf_ message (from the local target
UE to the MMS Proxy-Relay).
Table 7.4.3-19: Payload for MMSMBoxViewResponse
+--------------------+---------------------------------------+-------+ | Field name | Description | M/C/O | +--------------------+---------------------------------------+-------+ | version | The version of MM, to include major | M | | | and minor version. | | +--------------------+---------------------------------------+-------+ | responseStatus | MMS specific status. | M | +--------------------+---------------------------------------+-------+ | responseStatusText | Text that qualifies the Response | C | | | Status. As defined in OMA-TS-MMA_ENC | | | | [39] clause 7.3.49. | | +--------------------+---------------------------------------+-------+ | contentLocation | The _content-location-value_ field | C | | | defines the URL for the MMS server | | | | location of the content to be | | | | retrieved. As defined in | | | | OMA-TS-MMA_ENC [39] clause 7.3.10. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | state | Specifies a MM State value to use in | C | | | selecting the messages to return. As | | | | defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.33. Include if sent by the | | | | MMS Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | flags | Specifies a MM Flags keyword to use | C | | | in selecting the messages to return | | | | in the response. See OMA-TS-MMA_ENC | | | | [39] clause 7.3.32. Include if sent | | | | by the MMS Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | start | A number, indicating the index of the | C | | | first MM of those selected to have | | | | information returned in the response. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | limit | A number indicating the maximum | C | | | number of selected MMs whose | | | | information are to be returned in the | | | | response. | | | | | | | | If this is absent, information | | | | elements from all remaining MMs are | | | | to be returned. If this is zero then | | | | no MM-related information are to be | | | | returned. Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | mMSAttributes | A list of information elements that | C | | | should appear in the view for each | | | | selected message. Include if sent by | | | | the MMS Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | mMSTotals | Indicates a request for or the actual | C | | | count of messages currently stored in | | | | the MMBox. The values given in | | | | OMA-TS-MMA_ENC [39] clause 7.3.62. | | | | shall be encoded as follows: "Yes" = | | | | True, "No" = False. Include if sent | | | | by the MMS Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | mMSQuotas | Indicates a request for or the actual | C | | | quotas for the user\'s MMBox in | | | | messages or bytes. The values given | | | | in OMA-TS-MMA_ENC [39] clause | | | | 7.3.36. shall be encoded as follows: | | | | "Yes" = True, "No" = False. Include | | | | if sent by the MMS Proxy-Relay. | | +--------------------+---------------------------------------+-------+ | mMBoxDescription | The MMBox description PDU as defined | M | | | in 7.4.3.20 corresponds to the | | | | particular MM. | | +--------------------+---------------------------------------+-------+
#### 7.4.3.20 MMBoxDescription
The MMBoxDescription used in MMSMBoxViewResponse and MMSMBoxUpload records is
defined in table 7.4.3-20.
Table 7.4.3-20: Payload for MMBoxDescription
+---------------------+--------------------------------------+-------+ | Field name | Description | M/C/O | +---------------------+--------------------------------------+-------+ | contentLocation | The _content-location-value_ field | C | | | defines the URL for the MMS | | | | Proxy-relay location of the content | | | | to be retrieved. As defined in | | | | OMA-TS-MMA_ENC [39] clause | | | | 7.3.10. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | messageID | An ID assigned by the MMS | C | | | Proxy-Relay to uniquely identify an | | | | MM. Included unconditionally for the | | | | MMS View Confirm report and is | | | | included for the MMS Upload report | | | | if a Message ID was previously | | | | assigned to the MM. In this latter | | | | case, if a Message ID was not | | | | previously assigned, this parameter | | | | is excluded. As defined in | | | | OMA-TS-MMA_ENC [39] clause | | | | 7.3.29. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | state | Identifies the value of the MM State | C | | | associated with a MM to be stored or | | | | stored MM. Include for the MMS View | | | | Confirm. Include for the MMS View | | | | Request if provided by the target. | | | | As defined in OMA-TS-MMA_ENC [39] | | | | clause 7.3.33. Include if sent by | | | | the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | flags | Identifies a keyword to add or | C | | | remove from the list of keywords | | | | associated with a stored MM. This | | | | parameter may convey all the | | | | keywords associated with the MM. | | | | Include if at least one keyword is | | | | associated with the MM. If no | | | | keywords are associated with the MM, | | | | then this parameter may be excluded. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | dateTime | Date and Time when the MM request | C | | | was detected. Include if sent by the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | originatingMMSParty | ID(s) of the originating party in | C | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. Include if sent by the MMS | | | | Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | terminatingMMSParty | ID(s) of the terminating party in | C | | | one or more of the formats described | | | | in 7.4.2.1 | | | | | | | | When address translation occurs | | | | (such as the case of a token sent by | | | | the client and replaced with a | | | | proper address by the MMS | | | | Proxy-Relay), both the pre and post | | | | translated addresses (with | | | | appropriate correlation) are | | | | included. I Include if sent by the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | cCRecipients | Address of a recipient; the \"CC\" | C | | | field may include addresses of | | | | multiple recipients. When address | | | | translation occurs, both the pre and | | | | post translated addresses (with | | | | appropriate correlation) are | | | | included. This parameter is included | | | | if the corresponding MM includes a | | | | "CC" field. Include if sent by the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | bCCRecipients | Address of a recipient; the \"BCC\" | C | | | field may include addresses of | | | | multiple recipients. When address | | | | translation occurs, both the pre and | | | | post translated addresses (with | | | | appropriate correlation) are | | | | included. This parameter is included | | | | if the corresponding MM includes a | | | | "BCC" field. Include if sent by the | | | | MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | messageClass | Class of the MM. For example, a | C | | | value of \"auto\" is automatically | | | | generated by the UE. If the field is | | | | not present, the class should be | | | | interpreted as \"personal\". Include | | | | if sent by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | subject | The subject of the MM. Include if | C | | | sent by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | priority | Priority of the MM assigned by the | C | | | originator MMS Client. Reported if | | | | sent by the target. Include if sent | | | | by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+ | deliveryTime | Date and Time of delivery. Include | C | | | if sent by the MMS Proxy-Relay. | | +---------------------+--------------------------------------+-------+
+--------------------------+-------------------------------+---+ | readReport | Specifies whether the | C | | | originator MMS UE requests a | | | | read report from each | | | | recipient. The values given | | | | in OMA-TS-MMA_ENC [39] | | | | clause 7.3.37. shall be | | | | encoded as follows: "Yes" = | | | | True, "No" = False. Include | | | | if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-------------------------------+---+ | messageSize | Specifies the size of the MM | C | | | that was viewed or uploaded. | | | | Specified in bytes. Include | | | | if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-------------------------------+---+ | replyCharging | If this field is present its | C | | | value is set to "accepted" or | | | | "accepted text only" and the | | | | MMS-version-value of the | | | | M-Notification.ind PDU is | | | | higher than 1.0, this header | | | | field will indicate that a | | | | reply to this particular MM | | | | is free of charge for the | | | | recipient. | | | | | | | | If the Reply-Charging service | | | | is offered and the request | | | | for reply-charging has been | | | | accepted by the MMS service | | | | provider the value of this | | | | header field SHALL be set to | | | | "accepted" or "accepted text | | | | only". | | | | | | | | See OMA-TS-MMA_ENC [39] | | | | clause 7.3.43. Include if | | | | sent by the MMS Proxy-Relay. | | +--------------------------+-------------------------------+---+ | previouslySentBy | Address of the MMS Client | C | | | that forwarded or previously | | | | sent the message. along with | | | | a sequence number and | | | | timestamp. | | | | | | | | A higher sequence number | | | | indicates a forwarding event | | | | at a later point in time. The | | | | sequence number indicates the | | | | correspondence to the MMS | | | | Client\'s address in the | | | | \"X-Mms-Previously- Sent-By\" | | | | header field with the same | | | | sequence number.This header | | | | field MAY appear multiple | | | | times. Include if sent by the | | | | MMS Proxy-Relay. | | +--------------------------+-------------------------------+---+ | previouslySentByDateTime | Date/Time MM was previously | C | | | sent.This header field MAY | | | | appear multiple times. | | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-------------------------------+---+ | contentType | The content type of the MM. | C | | | Include if sent by the MMS | | | | Proxy-Relay. | | +--------------------------+-------------------------------+---+
#### 7.4.3.21 MMS Content
If content delivery is authorized, the CC-POI in the MMS Proxy-Relay shall
generate an xCC as per clause 7.4.2.3 when any of the events in clauses
7.4.3.1 through 7.4.3.19 are detected.
### 7.4.4 IRI and CC Generation
#### 7.4.4.1 Generation of IRI over LI_HI2
When an IRI-POI in the MMS Proxy-Relay generated xIRI is received over LI_X2,
the MDF2 shall send an xIRI over LI_HI2 without undue delay. The xIRI shall
contain a copy of the record received over LI_X2. The record may be enriched
by other information available at the MDF (e.g. additional location
information).
The threeGPP33128DefinedCC field (see ETSI TS 102 232-7 [10] clause 15) shall
be populated with the BER-encoded IRIPayload.
The timestamp field of the psHeader structure shall be set to the time that
the MMS event was observed (i.e. the timestamp field of the xIRI). The LIID
and CID fields shall correctly reflect the target identity and communication
session to which the IRI belongs.
#### 7.4.4.2 Generation of CC over LI_HI3
When a CC-POI in the MMS Proxy-Relay generated xCC message is received over
LI_X3, the MDF3 shall send a CC message over LI_HI3 without undue delay. The
CC message shall contain a copy of the MMS received over LI_X3. The record may
be enriched with other information available at the MDF.
## 7.5 PTC service
### 7.5.1 Introduction
The Stage 3 intercept capabilities defined in this clause for the Push to Talk
over Cellular (PTC) service apply when supported by a CSP. The term PTC
represents either a Push to Talk over Cellular (PoC) or Mission Critical Push
to Talk (MCPTT) type service. The use of the term PTC server represents either
a MCPTT function or PoC server.
#### 7.5.1.1 Provisioning over LI_X1
The IRI-POI present in the PTC server is provisioned over LI_X1 by the LIPF
using the X1 protocol as described in clause 5.2.2 of the present document.
The POI in the PTC Server shall support the identifier types given in Table
7.5.1-1.
Table 7.5.1-1: TargetIdentifier Types for PTC service
* * *
Identifier Owner ETSI TS 103 221-1 [7] TargetIdentifier type Definition iMPU
ETSI IMPU See ETSI TS 103 221-1 [7] iMPI ETSI IMPI See ETSI TS 103 221-1 [7]
mCPTTID ETSI TargetIdentifierExtension See XSD schema instanceIdentifierURN
3GPP TargetIdentifierExtension See XSD schema pTCChatGroupID 3GPP
TargetIdentifierExtension See XSD schema
* * *
#### 7.5.1.2 Generating xIRI over LI_X2
The IRI-POI present in the PTC server shall send xIRI over LI_X2 for each of
the events listed in TS 33.127 [5] clause 7.6.3, each of which is described in
the following clauses. The IRI events are based on the use of 3GPP MCPTT
features as defined in 3GPP TS 24.379 [41] and OMA PoC features as defined in
OMA-TS-PoC_System_Description-V2_1-20110802-A [42].
#### 7.5.1.3 Generation of xCC over LI_X3
The CC-POI present in the PTC server shall send xCC over LI_X3.
The CC-POI shall set the payload format to indicate the appropriate payload
type (5 for IPv4 Packet, 6 for IPv6 Packet) as per clause 6.2.3.6 of the
present document.
### 7.5.2 IRI events
#### 7.5.2.1 PTC registration
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCRegistration record when the IRI-POI present in the PTC server detects that
a PTC target matching one of the PTC target identifiers, referenced in clause
7.5.1.1, provided via LI_X1 has registered, re-registered, or de-registered
for PTC services , regardless of whether it is successful or unsuccessful.
Accordingly, the IRI-POI in the PTC server generates the xIRI when the
following event is detected:
\- when the PTC server receives a SIP REGISTER from a PTC target.
Table 7.5.2-1: Payload for PTCRegistration record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCServerURI
Shall include the identity of the PTC server serving the PTC target. M
pTCRegistrationRequest Identifies the type of registration request (register,
re-register, or de-register). M pTCRegistrationOutcome Identifies success or
failure of the registration. M
* * *
#### 7.5.2.2 PTC session initiation
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCSessionInitiation record when the IRI-POI present in the PTC server detects
that the PTC target initiates an on-demand session or the target receives an
invitation to join an on-demand session regardless of the success or the final
disposition of the invitation. The PTCSessionIniation record shall also be
reported when a chat group is the PTC target. Accordingly, the IRI-POI in the
PTC server generates the xIRI when the following events are detected:
\- when the PTC server receives a SIP INVITE from a PTC target.
\- when the PTC Server sends a SIP INVITE to the PTC target.
\- when the PTC Server hosting a PTC chat group session, where the PTC chat
group is the target, receives a SIP INVITE from a participating PTC server to
initiate a PTC chat group session.
Table 7.5.2-2: Payload for PTCSessionInitiation record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-----------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +-----------------------------+-----------------------------+-------+ | pTCServerURI | Shall include the identity | M | | | of the PTC server serving | | | | the PTC target. | | +-----------------------------+-----------------------------+-------+ | pTCSessionInfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +-----------------------------+-----------------------------+-------+ | pTCOriginatingID | Shall identify the | M | | | originating party. | | +-----------------------------+-----------------------------+-------+ | pTCParticipants | Shall identify the | C | | | individual PTC participants | | | | of the communication | | | | session, when known. | | +-----------------------------+-----------------------------+-------+ | p | Shall provide the | C | | TCParticipantPresenceStatus | Participant Presence | | | | Status, which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC client | | | | is available, while false | | | | indicates PTC client is | | | | unavailable. | | | | | | | | Report when the Presence | | | | functionality is supported | | | | by the PTC server and the | | | | PTC server assumes the role | | | | of the watcher on behalf of | | | | the PTC target or in the | | | | case of a target PTC chat | | | | group, when the PTC server | | | | assumes the role of the | | | | watcher on behalf of any | | | | member of the chat group. | | +-----------------------------+-----------------------------+-------+ | location | Shall include the PTC | C | | | target's location when | | | | reporting of the PTC | | | | target's location | | | | information is authorized | | | | and available. | | +-----------------------------+-----------------------------+-------+ | pTCBearerCapability | Shall provide when known | C | | | the media characteristics | | | | information elements of the | | | | PTC session, encoded in SDP | | | | format as per RFC 4566 | | | | [43] clause 5. | | +-----------------------------+-----------------------------+-------+ | pTCHost | Shall identify the PTC | C | | | participant who has the | | | | authority to initiate and | | | | administrate a PTC session, | | | | if known. | | +-----------------------------+-----------------------------+-------+
#### 7.5.2.3 PTC session abandon attempt
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCSessionAbandon record when the IRI-POI present in the PTC server detects
that the PTC Session is not established and the request is abandoned before
the PTC session starts. Accordingly, the IRI-POI in the PTC server generates
the xIRI when the following events are detected:
\- when the PTC server serving the PTC target receives a SIP CANCEL from the
PTC target or sends a SIP CANCEL to the PTC target.
Table 7.5.2-3: Payload for PTCSessionAbandonAttempt record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCDirection
Indicates the direction of the session relative to the target: \"toTarget\" or
\"fromTarget.\" M pTCSessionInfo Shall provide PTC session information such as
PTC Session URI and PTC Session type (e.g. on-demand, pre-established, ad-hoc,
pre-arranged, group session). M location Shall include the PTC target's
location when reporting of the PTC target's location information is authorized
and available. C pTCAbandonCause Shall identify the reason for the abandoned
PTC session based on the warning header field code provided in a response to a
SIP INVITE per 3GPP TS 24.379 [41] clause 4.4.2. M
* * *
#### 7.5.2.4 PTC session start
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCSessionStart record when the IRI-POI present in the PTC server detects that
the PTC Session is initiated and communication begins for both an on-demand
and pre-established PTC session. The PTCSessionStart record shall also be
reported when a chat group is the PTC target. Accordingly, the IRI-POI in the
PTC server generates the xIRI when the following events are detected:
\- when the PTC server sends a SIP 200 OK to the PTC target in response to a
SIP INVITE from the PTC target for an on-demand PTC session where the PTC
target originates the PTC session.
\- when the PTC server receives a SIP 200 OK from the PTC target in response
to a SIP INVITE for an on-demand PTC session where the PTC target receives an
invitation to join a PTC session.
\- when the PTC server receives a SIP 200 OK from the participant PTC server
in response to a SIP INVITE previously sent to that participating PTC server
for PTC sessions initiated by the PTC target with a pre-established PTC
session (PTC server sends a TBCP Connect to the PTC target with a pre-
established session).
\- when the PTC server sends a SIP 200 OK to the participant PTC server in
response to a SIP INVITE previously received from that participating PTC
server for PTC sessions terminated to the PTC target with a pre-established
PTC session (PTC server sends a TBCP Connect to the PTC target with a pre-
established session).
\- when the PTC server hosting a PTC chat group session, where PTC chat group
is the PTC target, sends a SIP 200 OK in response to a SIP INVITE previously
received from the participant PTC server to initiate a PTC chat group session.
Table 7.5.2-4: Payload for PTCSessionStart record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-----------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +-----------------------------+-----------------------------+-------+ | pTCServerURI | Shall include the identity | M | | | of the PTC server serving | | | | the PTC target. | | +-----------------------------+-----------------------------+-------+ | pTCSessionInfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +-----------------------------+-----------------------------+-------+ | pTCOriginatingID | Shall identify the | M | | | originating party. | | +-----------------------------+-----------------------------+-------+ | pTCParticipants | Shall identify the | C | | | individual PTC participants | | | | of the communication | | | | session, when known. | | +-----------------------------+-----------------------------+-------+ | p | Shall provide the | C | | TCParticipantPresenceStatus | Participant Presence | | | | Status, which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC client | | | | is available, while false | | | | indicates PTC client is | | | | unavailable. | | | | | | | | Report when the Presence | | | | functionality is supported | | | | by the PTC server and the | | | | PTC server assumes the role | | | | of the watcher on behalf of | | | | the PTC target. | | +-----------------------------+-----------------------------+-------+ | location | Shall include the PTC | C | | | target's location when | | | | reporting of the PTC | | | | target's location | | | | information is authorized | | | | and available. | | +-----------------------------+-----------------------------+-------+ | pTCHost | Shall identify the PTC | C | | | participant who has the | | | | authority to initiate and | | | | administrate a PTC Session, | | | | if known. | | +-----------------------------+-----------------------------+-------+ | pTCBearerCapability | Shall provide the media | C | | | characteristics information | | | | elements of the PTC | | | | session, encoded in SDP | | | | format as per RFC 4566 | | | | [43] clause 5 when known. | | +-----------------------------+-----------------------------+-------+
#### 7.5.2.5 PTC session end
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCSessionEnd record when the IRI-POI present in the PTC server detects that
the PTC session is released for any reason (i.e. normal or abnormal release)
and voice communications ends. Accordingly, the IRI-POI in the PTC server
generates the xIRI when the following events are detected:
\- when the PTC server receives a SIP BYE from the PTC target to end the
session.
\- when the PTC server receives a SIP 200 OK from the PTC target in response
to a SIP BYE.
\- when the PTC server sends a SIP BYE to the participating PTC server to end
the PTC session of a PTC target with a pre-established PTC session (PTC server
also sends a TBCP Disconnect to the PTC target with a pre-established PTC
session).
\- when the PTC server receives a SIP BYE from the participant PTC server to
end the PTC session of a PTC target with a pre-established PTC session (PTC
server sends a TBCP Disconnect to the PTC target with a pre-established PTC
session).
\- when the PTC server hosting a PTC chat group session, where PTC chat group
is the PTC target, sends a SIP 200 OK in response to a SIP BYE received from
the participating PTC server of the last participant in the PTC chat group
session.
\- when the PTC server sends a SIP 487 to the PTC target in response to a SIP
CANCEL to end the session.
Table 7.5.2-5: Payload for PTCSessionEnd record
+----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +----------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +----------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +----------------------+-----------------------------+-------+ | pTCServerURI | Shall include the identity | M | | | of the PTC server serving | | | | the PTC target. | | +----------------------+-----------------------------+-------+ | pTCSessionInfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +----------------------+-----------------------------+-------+ | pTCParticipants | Shall identify the | C | | | individual PTC participants | | | | of the communication | | | | session, when known. | | +----------------------+-----------------------------+-------+ | location | Shall include the PTC | C | | | target's location when | | | | reporting of the PTC | | | | target's location | | | | information is authorized | | | | and available. | | +----------------------+-----------------------------+-------+ | pTCSessionEndCause | Shall identify the reason | M | | | for the PTC session end | | | | based on the following | | | | events per | | | | OMA-TS-PoC_System_D | | | | escription-V2_1-20110802-A | | | | [42] clause 4.5.7: | | | | | | | | - PTC session initiator | | | | leaves session | | | | | | | | - Defined participant | | | | leaves session | | | | | | | | - Number of participants | | | | less than certain value | | | | | | | | - PTC Session timer | | | | expired | | | | | | | | - PTC Speech inactive for | | | | specified time | | | | | | | | - All Media types inactive | | | | for specified time | | +----------------------+-----------------------------+-------+
#### 7.5.2.6 PTC start of interception
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCStartOfInterception record when a PTC target or a PTC chat group as a
target has an active PTC session in progress. If multiple PTC Sessions are
active at the start of interception, a PTCStartOfInterception record is
generated for each active session. Accordingly, the IRI-POI in the PTC server
generates the xIRI when the following event is detected:
\- when the PTC server detects that LI is enabled on a PTC participant or a
PTC chat group with an active PTC session.
Table 7.5.2-6: Payload for PTCStartOfIntercept record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCDirection
Indicates the direction of the session relative to the target: \"toTarget\" or
\"fromTarget.\" M pTCPreEstSessionID Identifies the PTC Pre-Established
Session Identity when available. C pTCOriginatingID Shall identify the
originating party. M pTCSessionInfo Shall provide PTC session information such
as PTC Session URI and PTC Session type (e.g. on-demand, pre-established, ad-
hoc, pre-arranged, group session) when available. C pTCHost Shall identify the
PTC participant who has the authority to initiate and administrate a PTC
session, if known. C pTCParticipants Shall identify the individual PTC
participants of the communication session, when known. C location Shall
include the PTC target's location when reporting of the PTC target's location
information is authorized and available. C pTCMediaStreamAvail Shall include
this parameter to indicate if the PTC target is able/not able to receive media
streams immediately. True indicates available for media, while false indicates
not able to accept media. M pTCBearerCapability Shall provide when known the
media characteristics information elements of the PTC session, encoded in SDP
format as per RFC 4566 [43] clause 5. C
* * *
#### 7.5.2.7 PTC pre-established session
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCPre-EstablishedSession record when the IRI-POI present in the PTC server
detects that a pre-established session is setup/modified/released between the
PTC target and the PTC server associated with the PTC target. Accordingly, the
IRI-POI in the PTC server generates the xIRI when the following events are
detected:
\- when the PTC Server receives a SIP INVITE from the PTC target to setup a
pre-established session.
\- when the PTC Server receives a SIP BYE from the PTC target to release a
pre-established session.
\- when the PTC Server receives a SIP UPDATE or SIP re-INVITE from the PTC
target for a pre-established session to modify the current session.
Table 7.5.2-7: Payload for PTCPre-EstablishedSession record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCServerURI
Shall include the identity of the PTC server serving the PTC target. M
rTPSetting The IP address and the port number of the PTC target at the PTC
server for the RTP Session. M pTCMediaCapability The codec(s) and media
parameters selected by the PTC server from those contained in the original SDP
offer from the PTC target's SIP REFER and encoded in SDP format as per RFC
4566 [43] clause 5. M pTCPreEstSessionID Identifies the PTC Pre-Established
Session Identity. M pTCPreEstStatus Indicates if the pre-established session
is established (setup completed), modified, or released. M pTCMediaStreamAvail
Shall include for a pre-established session to indicate if the PTC target\'s
PTC client is able/not able to receive media streams immediately, when the
pre-established session is established. True indicates available for media,
while false indicates not able to accept media. M location Shall include the
PTC target's location when reporting of the PTC target's location information
is authorized and available. C pTCFailureCode Provide when the pre-established
session cannot be established or modified. C
* * *
#### 7.5.2.8 PTC instant personal alert
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCInstantPersonalAlert record when the IRI-POI present in the PTC server
detects that an Instant Personal Alert (IPA) (i.e. a request for one
participant to initiate a one-to-one PTC session) is initiated by or sent to
the PTC target. Accordingly, the IRI-POI in the PTC server generates the xIRI
when the following events are detected:
\- when the PTC server receives a SIP MESSAGE from a PTC target for an IPA.
\- when the PTC Server sends a SIP MESSAGE to the PTC target for an IPA.
Table 7.5.2-8: Payload for PTCInstantPersonalAlert record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCIPAPartyID
Identifies the PTC participant that receives or has sent the Instant Personal
Alert to the target. M pTCIPADirection Identifies the direction (To PTC target
or From PTC target) of the Instant Personal Alert. M
* * *
#### 7.5.2.9 PTC party join
The IRI-POI present in the PTC server hosting the PTC chat group session when
the PTC chat group is the PTC target, shall generate an xIRI containing a
PTCPartyJoin record when the IRI-POI present in that PTC server detects when a
PTC participant joins (or re-joins) an on-going PTC chat group session. The
PTCPartyJoin record shall also be generated when the IRI-POI present in the
participating PTC server of the PTC target detects when a PTC Participant
joins (or re-joins) an on-going PTC chat group session. Accordingly, the IRI-
POI in the participating PTC server generates the xIRI when the following
event is detected:
\- when the PTC server hosting a PTC chat group session sends a SIP 200 OK in
response to a SIP INVITE indicating a PTC participant joining the PTC chat
group session.
\- when the participating PTC server of a PTC target forwards a SIP NOTIFY
(received from the PTC server hosting the PTC chat group session) to the PTC
target containing information about a PTC participant joining the PTC chat
group session.
Table 7.5.2-9: Payload for PTCPartyJoin record
+---------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +---------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +---------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +---------------------------+-----------------------------+-------+ | pTCSessionInfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +---------------------------+-----------------------------+-------+ | pTCParticipants | Shall identify the | C | | | individual PTC participants | | | | of the communication | | | | session, when known. | | +---------------------------+-----------------------------+-------+ | participantPresenceStatus | Shall provide the | C | | | Participant Presence | | | | Status, which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC client | | | | is available, while false | | | | indicates PTC client is | | | | unavailable. | | | | | | | | Report when the Presence | | | | functionality is supported | | | | by the PTC server and the | | | | PTC server assumes the role | | | | of the watcher on behalf of | | | | the PTC target. | | +---------------------------+-----------------------------+-------+ | pTCMediaStreamAvail | Shall include this | M | | | parameter to indicate if | | | | the PTC target is able/not | | | | able to receive media | | | | streams immediately. True | | | | indicates available for | | | | media, while false | | | | indicates not able to | | | | accept media. | | +---------------------------+-----------------------------+-------+ | pTCBearerCapability | Shall provide when known | C | | | the media characteristics | | | | information elements of the | | | | PTC session, encoded in SDP | | | | format as per RFC 4566 | | | | [43] clause 5. | | +---------------------------+-----------------------------+-------+
#### 7.5.2.10 PTC party drop
The IRI-POI present in the PTC server hosting the PTC chat group session, when
the PTC chat group is the PTC target, shall generate an xIRI containing a
PTCPartyDrop record when the IRI-POI present in that PTC server detects that a
PTC participant leaves the PTC chat group session that still remains active
with other PTC participants. The PTCPartyDrop record shall also be generated
when the IRI-POI present in the participating PTC server of the PTC target
detects when a PTC Participant leaves an on-going PTC chat group session.
Accordingly, the IRI-POI in the participating PTC server generates the xIRI
when the following event is detected:
\- when the PTC server hosting a PTC chat group session, where the PTC chat
group is the target, sends a SIP 200 OK in response to a SIP BYE with the PTC
chat group session remaining active with other PTC participants.
\- when the participating PTC server of a PTC target forwards a SIP NOTIFY
(received from the PTC server hosting the PTC chat group session) to the PTC
target containing information about a PTC participant leaving the PTC chat
group session.
Table 7.5.2-10: Payload for PTCPartyDrop record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-----------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +-----------------------------+-----------------------------+-------+ | pTCSessionInfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +-----------------------------+-----------------------------+-------+ | pTCPartyDrop | Shall provide the identity | M | | | of the participant that | | | | leaves the PTC session. | | +-----------------------------+-----------------------------+-------+ | p | Shall provide the | C | | TCParticipantPresenceStatus | Participant Presence | | | | Status, which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC client | | | | is available, while false | | | | indicates PTC client is | | | | unavailable. | | | | | | | | Report when the Presence | | | | functionality is supported | | | | by the PTC server and the | | | | PTC server assumes the role | | | | of the watcher on behalf of | | | | the PTC target. | | +-----------------------------+-----------------------------+-------+
#### 7.5.2.11 PTC party hold
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCPartyHold record when the IRI-POI present in the PTC server detects that an
on-going PTC session is placed on hold or retrieved from hold by the PTC
target or by a PTC participant in a PTC chat group, where the PTC chat group
is the PTC target. Accordingly, the IRI-POI in the PTC server generates the
xIRI when the following event is detected:
\- when the PTC server receives a SIP UPDATE or SIP re-INVITE from the PTC
target and returns a SIP 200 OK to the PTC target for hold/resume operations.
\- when the PTC server hosting a PTC chat group, where PTC chat group is the
PTC target, receives a SIP UPDATE or SIP re-INVITE from a PTC participant for
hold/resume operations.
Table 7.5.2-11: Payload for PTCPartyHold record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCDirection
Indicates the direction of the session relative to the target: \"toTarget\" or
\"fromTarget.\" M pTCSessionInfo Shall provide PTC session information such as
PTC Session URI and PTC Session type (e.g. on-demand, pre-established, ad-hoc,
pre-arranged, group session). M pTCParticipants Shall identify the individual
PTC participants of the communication session, when known. C pTCHoldID The
identity of the PTC participant that placed the PTC session on hold or
retrieved the held PTC session. M pTCHoldRetrieveInd Shall indicate the PTC
session is put on hold (i.e. deactivate Media Bursts or a PTC session is
locked for talking/listening) or retrieved from hold. True indication equals
placed on hold, false indication was retrieved from hold. M
* * *
#### 7.5.2.12 PTC media modification
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCMediaModification record when the IRI-POI present in the PTC server detects
that a re-negotiation of the media parameters occurs during a PTC session
involving the PTC target. Accordingly, the IRI-POI in the PTC server generates
the xIRI when the following event is detected:
\- when the PTC server receives a SIP UPDATE or SIP reINVITE to indicate a PTC
media modification on a PTC session being intercepted.
Table 7.5.2-12: Payload for PTCMediaModification record
* * *
Field name Description M/C/O pTCTargetInformation Provide PTC target identity.
At least one among MCPTT ID, IMPU, IMPI, InstanceIdentifierURN and
PTCChatGroupID shall be provided for PTCTargetInformation. M pTCDirection
Indicates the direction of the session relative to the target: \"toTarget\" or
\"fromTarget.\" M pTCSessionInfo Shall provide PTC session information such as
PTC Session URI and PTC Session type (e.g. on-demand, pre-established, ad-hoc,
pre-arranged, group session). M pTCMediaStreamAvail Shall include this
parameter to indicate if the PTC target is able/not able to receive media
streams immediately. True indicates available for media, while false indicates
not able to accept media. M pTCBearerCapability Shall provide when known the
media characteristics information elements of the PTC session, encoded in SDP
format as per RFC 4566 [43] clause 5. C
* * *
#### 7.5.2.13 PTC group advertisement
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCGroupAdvertisement record when the IRI-POI present in the PTC server
detects when a PTC target sends group advertisement information to a single
PTC participant, a list of PTC participants, or to all members of a PTC chat
group, as well as when a PTC target receives group advertisement information
from a single PTC participant, a list of PTC participants, or from members of
a PTC chat group using the group identity. Accordingly, the IRI-POI in the PTC
server generates the xIRI when the following events are detected:
\- when the PTC server receives a SIP MESSAGE (containing group advertisement
information) from a PTC target.
\- when the PTC server sends a SIP MESSAGE (containing group advertisement
information) to the PTC target.
Table 7.5.2-13: Payload for PTCGroupAdvertisement record
+----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +----------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +----------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +----------------------+-----------------------------+-------+ | pTCIDList | Shall provide Identities of | C | | | each participant from the | | | | target\'s contact list | | | | (i.e. individuals) and PTC | | | | group list (i.e. list of | | | | pre-identified individuals | | | | using a group | | | | identification) for a group | | | | call when available. | | +----------------------+-----------------------------+-------+ | pTCGroupAuthRule | Identifies the action | C | | | requested by the PTC target | | | | to the PTC Group | | | | Authorization Rules: | | | | | | | | - Report when action | | | | requested to the PTC Group | | | | Authorization Rules by the | | | | PTC target. | | | | | | | | - Report when the PTC | | | | target attempts a change or | | | | queries the access control | | | | list(s). | | +----------------------+-----------------------------+-------+ | pTCGroupAdSender | Identifies the sender of | M | | | the group advertisement. | | +----------------------+-----------------------------+-------+ | pTCGroupNickname | The nickname is a | C | | | human-readable tag (e.g. | | | | \"display-name\" in a SIP | | | | header associated with a | | | | PTC client or PTC group per | | | | OMA-TS-PoC_System_D | | | | escription-V2_1-20110802-A | | | | [42]). | | +----------------------+-----------------------------+-------+
#### 7.5.2.14 PTC floor control
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCFloorControl record when the IRI-POI present in the PTC server detects when
the PTC target requests floor control (i.e. send media), when floor control is
granted to PTC target, when floor control request from the PTC target is
rejected/released, when the floor becomes open (e.g. idle), when the floor
control request from the PTC target is queued, when the floor control request
from the PTC target is dequeued, or when the floor control request is revoked.
In addition, when the PTC chat group is the PTC target, the IRI-POI present in
the PTC server hosting the PTC chat group shall generate an xIRI containing a
PTCFloorControl record when the IRI-POI present in the PTC server detects any
of the previously mentioned scenarios for all PTC participants participating
in the PTC chat group session. Accordingly, the IRI-POI in the PTC server
generates the xIRI when the following events are detected:
\- when the PTC server receives a TBCP Talk Burst Request from the PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, receives a TBCP Talk Burst Request from a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Granted to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Granted to a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Taken to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Taken to a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Deny to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Deny to a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Release to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Release to a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Idle to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Idle to a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Request Queue Status Response
to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Request Queue Status Response to a PTC
participant.
\- when the PTC server receives a TBCP Talk Burst Cancel from a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, receives a TBCP Talk Burst Cancel from a PTC participant.
\- when the PTC server sends a TBCP Talk Burst Revoke to a PTC target.
\- when the PTC server hosting the PTC chat group, where the PTC chat group is
the PTC target, sends a TBCP Talk Burst Revke to a PTC participant.
Table 7.5.2-14: Payload for PTCFloorControl record
+-----------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-----------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +-----------------------+-----------------------------+-------+ | pTCSessioninfo | Shall provide PTC session | M | | | information such as PTC | | | | Session URI and PTC Session | | | | type (e.g. on-demand, | | | | pre-established, ad-hoc, | | | | pre-arranged, group | | | | session). | | +-----------------------+-----------------------------+-------+ | pTCFloorActivity | Sequence of: | M | | | | | | | a) \"TBCP_Request\": | | | | Received by the PTC server | | | | to request permission for | | | | the PTC target or PTC | | | | participant to send a talk | | | | burst. | | | | | | | | b) \"TBCP_Granted\": Used | | | | by the PTC server to notify | | | | the PTC target or PTC | | | | participant that it has | | | | been granted permission to | | | | send a talk burst. | | | | | | | | c) \"TBCP_Deny\": Used by | | | | the PTC server to notify a | | | | PTC target or PTC | | | | participant that it has | | | | been denied permission to | | | | send a talk burst. | | | | | | | | d) \"TBCP_Idle\": Used by | | | | the PTC server to notify | | | | the PTC target or PTC | | | | participant that no one has | | | | the permission to send a | | | | Talk Burst at the moment | | | | and that it may accept the | | | | TBCP talk burst request | | | | message. | | | | | | | | e) \"TBCP_Taken\": Used | | | | by the PTC server to notify | | | | the PTC target or PTC | | | | participant that another | | | | PTC participant has been | | | | given permission to send a | | | | talk burst. | | | | | | | | f) \"TBCP_Revoke\": Used | | | | by the PTC server to revoke | | | | the media resource from the | | | | PTC target or PTC | | | | participant and can be used | | | | for pre-emption | | | | functionality but is also | | | | used by the system to | | | | prevent overly long use of | | | | the media resource. | | | | | | | | g) \"TBCP_Queued\": | | | | Indicates the request to | | | | talk is queued, if queued | | | | floor control is supported. | | | | Include identification of | | | | the PTC target or PTC | | | | participant that has the | | | | queued talk burst, if | | | | known. | | | | | | | | h) \"TBCP_Release\": | | | | Indicates the request to | | | | talk has completed. | | +-----------------------+-----------------------------+-------+ | pTCFloorSpeakerID | Include identification of | C | | | the PTC participant that | | | | has initiated the talk | | | | burst, if known. | | +-----------------------+-----------------------------+-------+ | pTCMaxTBTime | Include the maximum | C | | | duration value for the talk | | | | burst before the permission | | | | is revoked. This parameter | | | | is defined in seconds. | | | | Provide when known. | | +-----------------------+-----------------------------+-------+ | pTCQueuedFloorControl | Indicates if queuing is | C | | | supported by the PTC server | | | | and the PTC target\'s | | | | device. | | +-----------------------+-----------------------------+-------+ | pTCQueuedPosition | Include if queue position | C | | | in the TBCP is detected by | | | | the IRI-POI. | | +-----------------------+-----------------------------+-------+ | pTCTalkBurstPriority | If more than one level of | C | | | priority is supported, | | | | indicates the talk burst | | | | priority level of the PTC | | | | target. | | +-----------------------+-----------------------------+-------+ | pTCTalkBurstReason | The reason for the denial | C | | | or revoke of a Talk Burst. | | | | Provide when known. | | +-----------------------+-----------------------------+-------+
#### 7.5.2.15 PTC target presence
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCTargetPresence record when the IRI-POI present in the PTC server detects
that the PTC server publishes network presence information to the Presence
server on behalf of the PTC target. Accordingly, the IRI-POI in the PTC server
generates the xIRI when the following event is detected:
\- when the PTC server sends a SIP PUBLISH message to the Presence server
based on the PTC target's PTC session involvement.
Table 7.5.2-15: Payload for PTCTargetPresence record
+-------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-------------------------+-----------------------------+-------+ | pTCTargetPresenceStatus | Shall provide the PTC | M | | | target presence status, | | | | which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC target | | | | is available, while false | | | | indicates PTC target is | | | | unavailable. | | +-------------------------+-----------------------------+-------+
#### 7.5.2.16 PTC participant presence
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCParticipantPresence record when the IRI-POI present in the PTC server (when
it supports the Presence functionality and assumes the role of the Watcher on
behalf of the PTC target) detects that the PTC server receives presence status
notifications from the Presence servers after having subscribed to the PTC
presence status of other PTC participants (i.e. participants in communication
with the PTC target). Accordingly, the IRI-POI in the PTC server generates the
xIRI when the following event is detected:
\- when the PTC server receives a SIP NOTIFY in response to a SIP SUBSCRIBE
updating presence information for a participant.
Table 7.5.2-16: Payload for PTCParticipantPresence record
+-----------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +-----------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +-----------------------------+-----------------------------+-------+ | p | Shall provide the | M | | TCParticipantPresenceStatus | Participant Presence | | | | Status, which is a list of: | | | | | | | | - _PresenceID_ : Identity | | | | of PTC client(s) or PTC | | | | group, when known. | | | | | | | | - _PresenceType_ : | | | | Identifies type of ID [PTC | | | | client(s) or PTC group]. | | | | | | | | - _PresenceStatus_ : | | | | Presence state of each ID. | | | | True indicates PTC client | | | | is available, while false | | | | indicates PTC client is | | | | unavailable. | | | | | | | | Report when the Presence | | | | functionality is supported | | | | by the PTC server and the | | | | PTC server assumes the role | | | | of the watcher on behalf of | | | | the PTC target. | | +-----------------------------+-----------------------------+-------+
#### 7.5.2.17 PTC list management
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCListManagement record when the IRI-POI present in the PTC server detects
that the PTC target attempts to change their contact list/group list(s) or
those lists are updated by the network. Accordingly, the IRI-POI in the PTC
server generates the xIRI when the following events are detected:
\- when the PTC server receives a SIP PUBLISH from a PTC target to change the
PTC target's contact list or group list(s).
\- when the PTC server receives a SIP NOTIFY from other PTC participants
updating the PTC target's contact list or group list(s) (e.g. participant
reachability).
Table 7.5.2-17: Payload for PTCListManagement record
+--------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +--------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +--------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +--------------------------+-----------------------------+-------+ | pTCListManagementType | The \"List Management | C | | | Attempts\" identify the | | | | type of list being managed | | | | by the target when | | | | available: | | | | | | | | a) | | | | C | | | | ontactListManagementAttempt | | | | | | | | b) | | | | GroupListManagementAttempt | | | | | | | | c) | | | | ContactListManagementResult | | | | | | | | d) | | | | GroupListManagementResult | | | | | | | | e) Request unsuccessful | | | | | | | | For example, a) and b) are | | | | reported when PTC target | | | | attempts changes to their | | | | contact list and their PTC | | | | group list(s). | | | | | | | | The \"List Management | | | | Results\" identify the | | | | network response to a | | | | modification by the PTC | | | | target. | | | | | | | | For example, c), d), or e) | | | | is reported when the | | | | network notifies the PTC | | | | target of changes to their | | | | contact list or their PTC | | | | group list(s). | | +--------------------------+-----------------------------+-------+ | pTCListManagementAction | Identifies the action | C | | | requested by the PTC target | | | | to the contact lists or PTC | | | | group list(s). Report when | | | | PTC target attempts changes | | | | to his contact list or PTC | | | | group list(s): | | | | | | | | a) Create | | | | | | | | b) Modify | | | | | | | | c) Retrieve | | | | | | | | d) Delete | | | | | | | | e) Notify | | | | | | | | Also report when a | | | | notification is sent to the | | | | PTC target due to changes | | | | occurring to his contact | | | | list or PTC group list(s). | | +--------------------------+-----------------------------+-------+ | pTCListManagementFailure | Report when list management | C | | | request is unsuccessful. | | +--------------------------+-----------------------------+-------+ | pTCContactID | Identity of the contact in | C | | | the list. One contact per | | | | contact list or PTC group | | | | list. Report if known. | | +--------------------------+-----------------------------+-------+ | pTCIDList | Shall provide identities of | C | | | each participant from the | | | | PTC target\'s contact list | | | | (i.e. individuals) and PTC | | | | group list (i.e. list of | | | | pre-identified individuals | | | | using a group | | | | identification) for a group | | | | call. Report if known. | | +--------------------------+-----------------------------+-------+ | pTCHost | Identifies the PTC | C | | | participant who has | | | | authority to initiate and | | | | administrate an active PTC | | | | group session. Provide when | | | | known. | | +--------------------------+-----------------------------+-------+
#### 7.5.2.18 PTC access policy
The IRI-POI present in the PTC server shall generate an xIRI containing a
PTCAccessPolicy record when the IRI-POI present in the PTC server detects when
the PTC target attempts to change the access control lists (e.g. PTC user
access policy and PTC group authorization rules) located in the PTC XML
Document Management Server (XDMS). Accordingly, the IRI-POI in the PTC server
generates the xIRI when the following event is detected:
\- when the PTC server receives a SIP PUBLISH from a PTC target to change the
access control lists.
Table 7.5.2-18: Payload for PTCAccessPolicy record
+------------------------+-----------------------------+-------+ | Field name | Description | M/C/O | +------------------------+-----------------------------+-------+ | pTCTargetInformation | Provide PTC target | M | | | identity. At least one | | | | among MCPTT ID, IMPU, IMPI, | | | | InstanceIdentifierURN and | | | | PTCChatGroupID shall be | | | | provided for | | | | PTCTargetInformation. | | +------------------------+-----------------------------+-------+ | pTCDirection | Indicates the direction of | M | | | the session relative to the | | | | target: \"toTarget\" or | | | | \"fromTarget.\" | | +------------------------+-----------------------------+-------+ | pTCAccessPolicyType | Identifies the type of | C | | | access policy list being | | | | managed or queried by the | | | | target when known: | | | | | | | | a) | | | | PTCUserAccessPolicyAttempt | | | | | | | | b) | | | | Gro | | | | upAuthorizationRulesAttempt | | | | | | | | c) | | | | PTCUserAccessPolicyQuery | | | | | | | | d) | | | | G | | | | roupAuthorizationRulesQuery | | | | | | | | e) | | | | PTCUserAccessPolicyResult | | | | | | | | f) | | | | Gr | | | | oupAuthorizationRulesResult | | | | | | | | g) Request unsuccessful | | | | | | | | - Report a), b), c), or d) | | | | when the PTC target | | | | attempts a change or | | | | queries the Access Control | | | | list(s). | | | | | | | | - Report e), f), or g) | | | | when the network notifies | | | | the target of changes to | | | | the access control list(s) | | | | or the request was | | | | unsuccessful. | | +------------------------+-----------------------------+-------+ | pTCUserAccessPolicy | Identifies the action | C | | | requested by the PTC target | | | | to the PTC user or group | | | | access policy: | | | | | | | | a) Allow Incoming PTC | | | | session request | | | | | | | | b) Block Incoming PTC | | | | session request | | | | | | | | c) Allow Auto Answer Mode | | | | | | | | d) Allow Override Manual | | | | Answer Mode | | | | | | | | - Report when action | | | | requested to the PTC user | | | | access policy. | | | | | | | | - Report when the PTC | | | | target attempts a change or | | | | queries the access control | | | | list(s). | | +------------------------+-----------------------------+-------+ | pTCGroupAuthRule | Identifies the action | C | | | requested by the PTC target | | | | to the PTC Group | | | | Authorization Rules: | | | | | | | | a) Allow Initiating PTC | | | | session | | | | | | | | b) Block Initiating PTC | | | | session | | | | | | | | c) Allow Joining PTC | | | | session | | | | | | | | d) Block Joining PTC | | | | session | | | | | | | | e) Allow Add Participants | | | | | | | | f) Block Add Participants | | | | | | | | g) Allow Subscription PTC | | | | session state | | | | | | | | h) Block Subscription PTC | | | | session state | | | | | | | | i) Allow Anonymity | | | | | | | | j) Forbid Anonymity | | | | | | | | - Report when action | | | | requested to the PTC group | | | | authorization rules by the | | | | PTC target. | | | | | | | | - Report when the PTC | | | | target attempts a change or | | | | queries the access control | | | | List(s). | | +------------------------+-----------------------------+-------+ | pTCContactID | Identity of the contact in | C | | | the list. One contact per | | | | contact list or PTC group | | | | list. Report if known. | | +------------------------+-----------------------------+-------+ | pTCAccessPolicyFailure | Reports the reason for | C | | | failure when access policy | | | | request is _unsuccessful._ | | +------------------------+-----------------------------+-------+
### 7.5.3 IRI and CC Generation
#### 7.5.3.1 Generation of IRI over LI_HI2
When an xIRI is received over LI_X2 from the IRI-POI in the PTC server, the
MDF2 shall generate the corresponding IRI message and deliver it over LI_HI2
without undue delay. The IRI shall contain a copy of the record received over
LI_X2. This record may be enriched with any additional information available
at the MDF2 (e.g. additional location information).
#### 7.5.3.2 Generation of CC over LI_HI3
When xCC is received over LI_X3 from the CC-POI in the PTC server, the MDF3
shall populate the threeGPP33128DefinedCC field with a CCPayload structure
containing PTCCCPDU and send it over LI-HI3 interface to LEMF without undue
delay.
The PTC media contents are structured in a CC payload as formatted in clause
5.5.3 of the present document.
## 7.6 Identifier Association Reporting
### 7.6.1 General
The IEF, ICF and IQF are responsible for detecting, storing and providing to
the LEA permanent to temporary identifier associations, requested by the LEA
in authorised requests. The IEF as defined in clause 6.2.2A is responsible for
detecting and generating identifier associations records. The ICF is
responsible for caching identifier associations for short duration and the IQF
is responsible for handling requests from the LEA and providing those requests
to the ICF in order to identify the matching identifier associations.
### 7.6.2 ICF
#### 7.6.2.1 General
The ICF is responsible for caching identifier associations provided in event
records from the IEF over LI_XER and handling queries and subsequent responses
from the IQF for responses over LI_XQR.
#### 7.6.2.2 ICF receipt of records over LI_XER
When the ICF receives an identifier association event record over LI_XER from
an IEF (see clause 5.9), the ICF shall use the records to update the
identifier associations cached by the ICF. The ICF shall handle the event
records as described in clause 7.6.2.4.
#### 7.6.2.3 ICF Query and Response over LI_XQR
When the ICF receives an identifier association query request from the IQF,
the ICF shall search the cached identifier associations to establish a match,
based on RequestValues received in the request (see clause 5.8), subject to
clause 7.6.2.4.
Upon successful matching of one or more identifier associations which were
active at or around (within a pre-defined search time window) the observed
time specified in the query, the ICF shall provide a response to the IQF using
the IdentityAssociationResponse message as defined in clause 5.8. Where the
ICF is not able to provide a single identifier association based on the
RequestValues, the IQF is responsible for any subsequent handling of multiple
identifier associations in terms of whether to provide all associations to the
LEA over LI_HIQR.
#### 7.6.2.4 ICF Identifier Association Event Handling
Upon receipt of an Association event as defined in clause 6.2.2A.2, the ICF
shall cache the identifier association(s) contained within the record as
follows:
\- SUPI to 5G-GUTI association received, in an IEFAssociationRecord is stored
by ICF as an active association. The previous active association for the same
SUPI, if any, is marked as a previously active association and cached until
the cache time limit is reached.
\- If the IEFAssociationRecord also contains a SUCI, the SUCI is stored as a
part of the received SUPI to 5G-GUTI association, for the lifetime of that
association.
\- Where the IEFDeassociationRecord corresponds to an active SUPI to 5G-GUTI
association at ICF, the association is marked as a previously active
association and cached until the cache time limit is reached.
The ICF shall have a CSP defined maximum active association lifetime (upon
expiry of which the association is deleted from the ICF).
NOTE 1: This is needed to prevent an association from not being deleted from
ICF under some error conditions (e.g. a loss of IEF message carrying
IEFDeassociationRecord caused by the implicit deregistration of an out-of-
service UE). The selection of the maximum active association lifetime value
needs to ensure that no valid active associations are deleted upon the
lifetime expiry, i.e. the longest possible association refresh time supported
by CSP's network needs to be accommodated.
For previous associations placed in the cache, the ICF shall store the times
of association and disassociation, respectively.
Where an IEFAssociationRecord contains a PEI or a TAI list, the ICF shall
store the received values and associate them both the current received SUPI to
5G-GUTI association and any future association until:
\- A subsequent IEFAssociationRecord is received which updates the PEI or TAI
list values.
\- The old PEI / TAI list shall be retained in association with previous SUPI
to 5G-GUTI associations until those associations are deleted from cache.
\- New PEI / TAI list shall be used in association with both the
association(s) with which it was received and any subsequent associations
until another update is received.
\- All SUPI associations for which the PEI / TAI list is valid are deleted
from the cache.
When the ICF receives a query request from the IQF as defined in clause
7.6.2.3, the ICF shall search available identifier associations (both active
associations and those marked for deletion in the cache) for a match. The ICF
shall be able to use both time and TAI (as a single TAI and in relation to a
TAI list) to identify the correct SUPI to 5G-GUTI association(s). For
associations which have been disassociated (and will be deleted once the cache
time limit is reached), the time of disassociation is used by the ICF to
identify the correct association match (based on observed time in LEA
request), where multiple associations are held in the cache.
NOTE 2: Use of nCGI to match associations based on physical location for SUCI
/ 5G-S-TMSI to SUPI requests, is out of scope of the present document.
As the LEA and CSP are unlikely to have synchronised the time of identifier
observation / association provided by the LEA in the query request, with NF
time of the IEFs, the ICF shall search the cached identifier associations
using a short window time duration both before and after (subject to overall
cache duration) the observed time provided by the LEA in the RequestValues
over LI_XQR.
NOTE 3: While the search window duration before and after the LEA provided
observed time value is outside the scope of the present document, selection of
this value by the CSP needs to take into consideration, among other aspects,
the duration of a potential period of recovery from a 5G-GUTI update error, in
order to prevent missing of otherwise matching associations due to
discrepancies between their stored association/disassociation time and the
observed time provided by LEA.
NOTE 4: While the value of the short-term caching time is outside the scope of
the present document, selection of this value by the CSP needs to take into
consideration, among other aspects, the duration of potential period of
recovery from a 5G-GUTI update error, in order to prevent previous
associations being deleted before they have been fully disassociated by both
the UE and AMF.
### 7.6.3 IQF
#### 7.6.3.1 General
The IQF is responsible for receiving and responding to LEA requests over
LI_HIQR. Following receipt of a request over LI_HIQR, the IQF shall validate
the request and ensure that the request is within the cache period of
associations stored in the ICF. If the request is valid and within the ICF
cache period, the IQF shall send an association search request to the ICF over
LI_XQR. If the request is not within the ICF cache period or overwise invalid,
the IQF shall reject the request and respond to the LEA over LI_HIQR.
Following receipt of an association search request response from the ICF over
LI_XQR, the IQF shall forward any matching identifier association(s) to the
LEA over LI_HIQR. If the ICF indicates zero matches were found based on the
information provided in the initial request over LI_HIQR, the IQF shall
respond to the LEA over LI_HIQR indicating that no identifier associations
were found based on the request from the LEA.
If the ICF responds with multiple associations of 5G-GUTIs / SUCIs to a single
SUPI, the IQF shall provide all matched associations to the LEA over LI_HIQR.
Handling in the case of multiple SUPIs to a single 5G-GUTI (where the initial
request over LI_HIQR is based on 5G-S-TMSI or SUCI) is outside the scope of
the present document.
#### 7.6.3.2 IQF Query and Response over LI_HIQR
The IQF is responsible for receiving query requests from and providing query
responses to the LEA over LI_HIQR. Further details of LI_HIQR messages are
defined in clause 5.7.
#### 7.6.3.3 IQF Query and Response over LI_XQR
The IQF is responsible for generating queries to and receiving query responses
requests from the ICF over LI_XQR, based on queries received from the LEA over
LI_HIQR. Further details of LI_XQR messages are defined in clause 5.8.
###### ## Annex A (normative): Structure of both the Internal and External
Interfaces
The ASN.1 module describing the structures used for LI_X2, LI_X3, LI_HI2 and
LI_HI3 (\"TS33128Payloads\") is given in the file _TS33128Payloads.asn_ which
accompanies the present document.
###### ## Annex B (normative): LI Notification
Based on clause 5.6 of the present document, this annex defines a system of
management notification of LI system with the LI_HI4 interface.
The LI_HI4 interface shall be used to transport specific LI service O&M
information (referred to as LI Notification) from the CSP to the LEMF. The
individual parameters of the LI Notification message shall be coded using
ASN.1 and the basic encoding rules (BER). The delivery of LI Notification
shall be performed directly using the same mechanism as used for delivery of
IRI messages over LI_HI2 and CC over LI_HI3.
The LI Notification shall be used to send electronic notification to the LEMF
in the following cases:
1) after the activation of lawful interception;
2) after the deactivation of lawful interception;
3) after the modification of an active lawful interception.
Table B.1-1: LINotification message
* * *
**Field name** **Description** **M/C/O** notificationType Information on the
type of notification: activation, deactivation or modification M
deliveryInformation Delivery Information which has been decided by the LEA in
terms of delivery numbers, IP addresses for LI_HI2 and LI_HI3 O
appliedTargetID Target Identifier applied in the ADMF for the warrant O
appliedStartTime Start time applied to the ADMF for the warrant C
appliedEndTime End time applied to the ADMF for the warrant C
* * *
Conditional parameters shall be set as follows:
+---------------------------+---------------------------+-----------+ | **LI Activation | | | | Notification** | | | +---------------------------+---------------------------+-----------+ | **Field name** | **Description** | **M/C/O** | +---------------------------+---------------------------+-----------+ | notificationType | Activation | M | +---------------------------+---------------------------+-----------+ | appliedStartTime | Always present and | C | | | represents: | | | | | | | | The Start Date/Time in | | | | the warrant or, | | | | | | | | The Date/Time of the CSP | | | | activation in the ADMF | | | | or, | | | | | | | | The scheduled future | | | | Start Date/Time. | | +---------------------------+---------------------------+-----------+ | appliedEndTime | [Absence | C | | | means]{.underline} the | | | | interception has been | | | | activated with no | | | | predefined End Date/Time. | | | | | | | | [Presence | | | | means]{.underline} the | | | | End time is scheduled to | | | | be applied at that | | | | (future) time. | | +---------------------------+---------------------------+-----------+
* * *
**LI Modification Notification**  
**Field name** **Description** **M/C/O** notificationType Modification M
appliedStartTime Present and provides the new Start Date/Time if modified by
the LI Modification command C appliedEndTime Present and provides the new End
Date/Time if modified by the LI Modification command C
* * *
* * *
**LI Deactivation Notification**  
**Field name** **Description** **M/C/O** notificationType Deactivation M
appliedStartTime Absent C appliedEndTime Present and provides the actual End
Date/Time, e.g. timed stop as per initial warrant or as per new warrant, or as
pre-emptive audited stop from the LEA, or major LI failure. C
* * *
The individual notifications parameters shall be sent to the LEMF as soon as
possible with the lowest latency at least once (if available).
The MDF2/3 will deliver the LINotification message to LEMF.
###### ## Annex C (normative): XSD Schema for LI_X1 extensions
The XSD schema describing the extensions used for LI_X1 is given in the file
_urn_3GPP_ns_li_3GPPX1Extensions.xsd_ which accompanies the present document.
###### ## Annex D (informative): Drafting Guidance
# D.1 Introduction
This annex provides drafting guidance for contributors wishing to propose
changes to the present document.
# D.2 Drafting conventions
Table D.2-1: Drafting conventions
D.2.1 The details for each field, including a complete description of the
usage, format, cardinality and conditionality of that field, are given in the
prose in the main body of the document.
* * *
D.2.2 The field names used in the main body of the document match those used
in the ASN.1. D.2.3 ASN.1 comments are not used, except for to indicate where
to find a description of the field or structure in the main body of the
specification. D.2.4 If a field is made conditional, the condition for its
presence or absence is specified.
# D.3 Naming conventions
Table D.3-1: Naming conventions
D.3.1 To meet ASN.1 syntax rules, the first character of each ASN.1 field name
are lower-cased.
* * *
D.3.2 To meet ASN.1 syntax rules, the first character of an ASN.1 type name
are upper-cased. D.3.3 To meet ASN.1 syntax rules, the first character of a
field or a type name is not a number. D.3.4 Only the character ranges A-Z, a-z
and 0-9 are used in names. D.3.5 Names are be CamelCased, where the first
character of each word is upper-cased (except for the first character of the
name -- see rule D.3.1). D.3.6 Any acronyms in a name should be entirely
upper-cased (except for the first character of the name -- see rule D.3.1).
ExampleBadStructure ::= SEQUENCE
{
[F]{.underline}irstField [1] FirstFieldType, -- D.3.1 First letter of field is
upper case
secondField [2] [s]{.underline}econdFieldType, -- D.3.2 First letter of type
is lower case
[3]{.underline}rdField [3] [3]{.underline}rdFieldType, -- D.3.3 Names starts
with digit
fourth[-]{.underline}field [4] Fourth[_]{.underline}Field_Type, -- D.3.4 Names
include hyphen and underscore
fifth[f]{.underline}ield [5] Fifth[f]{.underline}ield[t]{.underline}ype, --
D.3.5 Names are not camelCased
m[sisdn]{.underline} [6] MSISDN, -- D.3.6 Acronyms in field name not wholly
upper-cased
mSISDN [7] M[sisdn]{.underline} -- D.3.6 Acronyms in type name not wholly
upper-cased
}
Figure 1 -- Naming convention counter-examples
# D.4 ASN.1 Syntax conventions
Table D.4-1: ASN.1 Syntax conventions
D.4.1 Modules are be defined with EXTENSIBILITY IMPLIED unless there is a
specific reason to limit extensibility.
* * *
D.4.2 The AUTOMATIC TAGS module directive is not used. D.4.3 SEQUENCE and
CHOICE tag numbers start at one. D.4.4 ENUMERATED tag numbers start at one.
D.4.5 Anonymous types are not used. Non-trivial fields are assigned their own
named type. D.4.6 Consideration should be given to making types re-usable and
independent of a particular release. Re-using or extending an existing type,
where the intent is similar, is preferable to creating a new type. D.4.7
Consideration should be given to making types extensible by declaring them as
a SEQUENCE or CHOICE where possible. D.4.8 Multiple smaller messages or
structures with fewer OPTONAL fields are preferred to larger structures with
many OPTIONAL fields, as this increases the ability of the ASN.1 schema to
enforce the intent of the specification. D.4.9 Field names, tag numbers, field
types and optional flags are be space-aligned where possible. An indent of
four spaces is used. D.4.10 Field and type names (when defining a type) are
not in bold. D.4.11 Braces are given their own line. D.4.12 OIDs containing a
version number are updated when the structure that uses the OID is changed,
even if the change is solely to correct a syntactic error. Other OIDs in the
same module need not be updated if they are not associated with structures
that have been changed. D.4.13 For backward compatibility, fields added to
existing SEQUENCE or SET are defined as OPTIONAL, irrespective of their M/C/O
designation in the main body of the present document.
ConformatModule
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2)
lawfulIntercept(2) ... }
DEFINITIONS EXTENSIBILITY IMPLIED ::=
BEGIN
Structure1 ::= SEQUENCE
{
field1 [1] Field1,
field2 [2] Field2
}
Field1 ::= ENUMERATED
{
choice1(1),
choice2(2),
choice3(3)
}
Field2 ::= OCTET STRING
END
Figure 2 -- Syntax convention example
NonconformantModule
{itu-t(0) identified-organization(4) etsi(0) securityDomain(2)
lawfulIntercept(2) ... }
DEFINITIONS [AUTOMATIC TAGS]{.underline} ::= -- D.4.1 Not declared with
EXTENSIBILITY IMPLIED
\-- D.4.2 Declared AUTOMATIC TAGS
BEGIN
Structure1 ::= SEQUENCE [{]{.underline} -- D.4.11 Braces not given their own
line
field1 [[0]]{.underline} ::= [ENUMERATED]{.underline} -- D.4.3 SEQUENCE tags
don't start at 1
{ -- D.4.5 Anonymous type used
choice1[(0),]{.underline} -- D.4.4 ENUMERATED tag numbers don't start at 1
choice2(2),
choice3(3)
},
**[field2]{.underline}** [2] Field2 -- D.4.10 Field name is bold
}
**[Field2]{.underline}** ::= OCTET STRING -- D.4.10 Type names in definitions
is bold
END
Figure 3 -- Syntax convention counter-examples
###### ## Annex E (normative): XSD Schema for Identity Association
The XSD schema describing the extensions used for Identity Association is
given in the file _urn_3GPP_ns_li_3GPPIdentityExtensions.xsd_ which
accompanies the present document.
###### ## Annex F (normative): ASN.1 schema for LI_XER messages
The ASN.1 schema describing the structures used for LI_XER is given in the
file _TS33128IdentityAssociation.asn_ which accompanies the present document.
###### ## Annex G (normative): XSD Schema for State Transfers
The XSD schema describing the structures used for state transfer is given in
the file _urn_3GPP_ns_li_3GPPStateTransfer.xsd_ which accompanies the present
document.
#