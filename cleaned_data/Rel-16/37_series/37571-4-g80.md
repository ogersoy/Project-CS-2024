# Foreword
This Technical Specification has been produced by the 3^rd^ Generation
Partnership Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# Introduction
The present document is part 4 of a multi-part conformance test specification.
The specification contains a TTCN design frame work and the detailed test
specifications in TTCN for the UE:
\- A-GPS at the UTRA Uu interface in TTCN-2;
\- A-GNSS at the UTRA Uu interface in TTCN-3;
\- LTE positioning at the LTE-Uu interface in TTCN-3.
\- NR positioning at the NR-Uu interface in TTCN-3.
The present document is part 4 of a multi-parts TS:
**-** 3GPP TS 37.571-1: User Equipment (UE) conformance specification for UE
positioning; Part 1: Terminal conformance.
**\- 3GPP TS 37.571-2: User Equipment (UE) conformance specification for UE
positioning; Part 2: Protocol conformance.**
\- **3GPP TS 37.** 571**-3:** User Equipment (UE) conformance specification
for UE positioning; **Part 3: Implementation Conformance Statement (ICS).**
**\- 3GPP TS 37.571-4: User Equipment (UE) conformance specification for UE
positioning; Part 4: Test suites.**
**\- 3GPP TS 37.** 571**-5:** User Equipment (UE) conformance specification
for UE positioning; **Part 5: Test scenarios and assistance data.**
# 1 Scope
The present document specifies the protocol and signalling conformance testing
in TTCN for the UE:
\- A-GPS at the UTRA Uu interface;
\- LTE positioning at the LTE-Uu interface;
\- A-GNSS at the UTRA Uu interface.
\- NR positioning at the NR-Uu interface.
The following TTCN test specification and design considerations can be found
in the present document:
\- Test system architecture;
\- Test models and ASP definitions;
\- Test methods and usage of communication ports definitions;
\- Test configurations;
\- Design principles and assumptions;
\- TTCN styles and conventions;
\- Partial PIXIT proforma;
\- Test suites in TTCN-2 and TTCN-3;
\- The Test Suites designed and implemented in the present document are based
on the test specifications in prose in 3GPP TS 37.571‑2 [3];
\- The applicability of the individual test cases is specified in the test ICS
proforma specification in 3GPP TS 37.571‑3 [4].
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document in the same
Release as the present document unless the context in which the reference is
made suggests a different Release is relevant (information on the applicable
release in a particular context can be found in e.g. test case title,
description or applicability, message description or content).
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 37.571-1: \" User Equipment (UE) conformance specification for UE
positioning; Part 1: Conformance test specification\".
[3] 3GPP TS 37.571-2: \" User Equipment (UE) conformance specification for UE
positioning; Part 2: Protocol conformance\".
[4] 3GPP TS 37.571-3: \" User Equipment (UE) conformance specification for UE
positioning; Part 3: **Implementation Conformance Statement (ICS)** \".
[5] 3GPP TS 37.571-5: \" User Equipment (UE) conformance specification for UE
positioning; Part 5: Test scenarios and assistance data\".
[6] 3GPP TS 36.523-3: \"Evolved Universal Terrestrial Radio Access (E-UTRA)
and Evolved Packet Core (EPC); User Equipment (UE) conformance specification;
Part 3: Test suites\".
[7] 3GPP TS 36.508: \"Evolved Universal Terrestrial Radio Access (E-UTRA) and
Evolved Packet Core (EPC); Common test environments for User Equipment (UE)
conformance testing\".
[8] 3GPP TS 34.123-3: \"User Equipment (UE) conformance specification; Part 3:
Abstract test suite (ATS)\".
[9] 3GPP TS 34.108: \"Common test environments for User Equipment (UE);
Conformance testing\".
[10] 3GPP TS 37.355: \" LTE Positioning Protocol (LPP)\".
[11] 3GPP TS 24.301: \"Non-Access-Stratum (NAS) protocol for Evolved Packet
System (EPS); Stage 3\".
[12] 3GPP TS 25.331: \"Radio Resource Control (RRC); Protocol specification\".
[13] 3GPP TS 24.080: \"Mobile radio interface layer 3 supplementary services
specification; Formats and coding\".
[14] 3GPP TS 29.002: \"Mobile Application Part (MAP) specification\".
[15] ITU-T Recommendation X.880: \"Information technology - Remote Operations:
Concepts, model and notation\".
[16] ITU-T Recommendation Q.773: \"Transaction capabilities formats and
encoding\".
[17] ETSI ES 201 873-1: \"Methods for Testing and Specification (MTS); The
Testing and Test Control Notation version 3; Part 1: TTCN-3 Core Language\".
[18] 3GPP TS 34.109: \"Terminal logical test interface; Special conformance
testing functions\".
[19] 3GPP TS 23.038: \"Alphabets and language-specific information\".
[20] ETSI TR 101 666 (V1.0.0): \"Information technology; Open Systems
Interconnection Conformance testing methodology and framework; The Tree and
Tabular Combined Notation (TTCN) (Ed. 2++)\".
[21] 3GPP TS 24.008: \"Mobile radio interface Layer 3 specification; Core
network protocols; Stage 3\".
[22] 3GPP TS 23.032: \"Universal Geographical Area Description (GAD)\".
[23] 3GPP TS 36.211: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Physical channels and modulation\".
[24] 3GPP TS 38.523-3: \"**5GS; User Equipment (UE) conformance specification;
Part 3: Protocol Test Suites** \".
[25] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[26] 3GPP TS 36.331: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Radio Resource Control (RRC); Protocol specification\".
[27] 3GPP TS 38.331: \"NR; Radio Resource Control (RRC) protocol
specification\".
[28] 3GPP TS 38.508-1: \"5GS; User Equipment (UE) conformance specification;
Part 1: Common test environment\".
[29] 3GPP TS 38.211: \"NR; Physical channels and modulation\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
3GPP TR 21.905 [1] apply.
## 3.2 Symbols
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] apply.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in 3GPP TR
21.905 [1] and the following apply:
ASP Abstract Service Primitive
# 4 A-GPS system architecture and test model
A-GPS signalling conformance tests are specified in TTCN-2. The system
architecture and the test model are based on 3GPP TS 34.123-3 [].
## 4.1 ATS and module structure
Refer to 3GPP TS 34.123-3 [], clause 5.
## 4.2 Upper tester
Refer to 3GPP TS 34.123-3 [], clause 7.3.5.1.
## 4.3 SV PCO
Refer to 3GPP TS 34.123-3 [], clause 7.3.5.2.
## 4.4 A-GPS Primitives
Refer to 3GPP TS 34.123-3[], clause 7.3.5.3.
## 4.5 Specific test suite operation for A-GPS testing
Refer to 3GPP TS 34.123-3 [], clause 8.7.7.
# 5 A-GNSS and LTE positioning system architecture and test models
## 5.1 Test system architecture
### 5.1.1 General system architecture
Refer to 3GPP TS 36.523-3 [], clause 4.1.1.
### 5.1.2 Component architecture
Each access technology (RAT) is hosted by a separate TTCN-3 parallel component
(PTC):
\- E-UTRA PTC;
\- UTRA PTC.
The PTCs are controlled by the TTCN-3 positioning master test component (POS
MTC) which:
\- Is an extension of the MTC as defined in 3GPP TS 36.523-3 [], clause 4.1.2.
\- Controls the SS Positioning Simulator.
Figure 5.1.2-1 shows this component architecture for an E-UTRA and UTRA
scenario.
Figure 5.1.2-1: Component architecture for an E-UTRA and UTRA scenario
The PTCs are allocated according to the following principles:
\- For LTE positioning tests cases, the E-UTRA PTC is created.
\- For LTE positioning CS fallback test cases, E-UTRA and UTRA PTCs are
created.
\- For UTRA A-GNSS test cases, the UTRA PTC is created.
#### 5.1.2.1 Interfaces
A number of interfaces are taken into consideration.
**POS MTC - PTC** :
Common synchronisation of PTCs.
Positioning simulator command/data coordination messages.
Upper tester primitives.
**POS MTC - System Interface** :
Upper tester primitives.
**POS MTC- Positioning Simulator** :
Positioning simulator command and data primitives.
**PTC - PTC** :
Primitives containing information for IRAT handover.
**PTC - System Interface** :
Primitives containing peer-to-peer message.
Configuration primitives.
## 5.2 Test model
In order to perform the LTE positioning and A-GNSS tests, the Positioning
Simulator shall have two basic functional unites:
\- Satellite simulator generating and broadcasting satellite signals.
> \- Assistance data source storing the data associated with the pre-defined
> GPS and GNSS test scenarios (see 3GPP TS 37.571-5 []).
This specification supports the following GNSS: GPS, Galileo, GLONASS and BDS.
### 5.2.1 LTE GNSS test model
Figure 5.2.1-1: E-UTRA Test model for LTE positioning GNSS testing
The LTE positioning test model consists of an SS E-UTRAN protocol stack and a
positioning simulator. The SS E-UTRA emulation part is the same as the model
defined in 3GPP TS 36.523-3 [].
The UE is configured in normal mode. On UE side Ciphering/Integrity (PDCP and
NAS) is enabled. The tests are performed on C-Plane.
The ASPs at POS Port are used to:
\- Load a pre-defined test scenario into the positioning simulator.
\- Start or stop generating and broadcasting satellite signals from the
positioning simulator.
\- Retrieve the GNSS assistance data from assistance data source.
Under the ASP commands, the upper tester loads or re-loads pre-defined GNSS
test scenario to the positioning simulator. The generated satellite signals
shall simulate the GNSS environment as specified in 3GPP TS 37.571-2 [],
clause 5.
The SS also sends the GNSS assistance data to the UE through LPP signalling
(see 3GPP TS 37.355 []) to facilitate the UE acquiring and tracking
satellites. Such assistance data shall be consistent to within ±2 seconds with
the satellite signals generated (see 3GPP TS 37.571-2 [], clause 5.2.1).
The assistance data source shall provide the assistance data consistent to
+1/-0 second with the GNSS test scenario currently running in the satellite
simulator (i.e. the data shall be up to 1 second in advance of the scenario);
this allows for a further 2 seconds of latency in the SS. In case multiple
satellite systems are configured in a test, the assistance data are requested
or retrieved in a single ASP command for all satellite systems.
The UE positioning services are encoded in a TCAP [] ROSE component [] of the
facility information element [] in the Supplement Service [] conveyed in the
NAS messages. The facility information element is encoded in BER in TTCN
referred to 3GPP TS 24.080 [], clause 3.6.1 and 3GPP TS 29.002 [], clause
17.1.1.
### 5.2.2 UTRA A-GNSS test model
Figure 5.2.2-1: UTRA Test model for A-GNSS testing
The A-GNSS test model consists of an SS UTRAN protocol stack and a positioning
simulator. The SS UTRA emulation part is the same as the model defined in 3GPP
TS 36.523-3 [], clause 4.4.1.
The UE is configured in normal mode. Ciphering and Integrity (RRC) are
enabled. The tests are performed on C-Plane.
The ASPs at POS Port are used to:
\- Load a pre-defined test scenario into the positioning simulator.
\- Start or stop generating and broadcasting satellite signals from the
positioning simulator.
\- Retrieve the GPS and GNSS assistance data from assistance data source.
Under the ASP commands, the upper tester loads or re-loads pre-defined GPS or
GNSS test scenario to the positioning simulator. The generated satellite
signals shall simulate the A-GPS and A-GNSS environment as specified in 3GPP
TS 37.571-2 [], clause 4.2.
The SS also sends the GPS or GNSS assistance data to the UE through RRC
signalling to facilitate the UE acquiring and tracking satellites. Such
assistance data shall be consistent to within ±2 seconds with the satellite
signals generated (see 3GPP TS 37.571-2 [], clause 4.2).
The assistance data source shall provide the assistance data consistent to
+1/-0 second with the GPS or GNSS test scenario currently running in the
satellite simulator (i.e. the data shall be up to 1 second in advance of the
scenario); this allows for a further 2 seconds of latency in the SS. In case
multiple satellite systems are configured in a test, the assistance data are
requested or retrieved in a single ASP command for all satellite systems.
The UE positioning services are encoded in a TCAP [] ROSE component [] of the
facility information element [] in the Supplement Service [] conveyed in the
NAS messages. The facility information element is encoded in BER in TTCN
referred to 3GPP TS 24.080 [], clause 3.6.1 and 3GPP TS 29.002 [], clause
17.1.1.
## 5.3 ASP specifications
The E-UTRAN and UTRAN ASP definitions are specified according to 3GPP TS
36.523-3 [], clause 6.
The positioning simulator ASP definitions are documented in annex C.
## 5.4 LTE OTDOA test model
Figure 5.4-1: E-UTRA OTDOA test model
The LTE OTDOA test model consists of an SS E-UTRAN protocol stack. The SS
E‑UTRA emulation part is the same as the model defined in 3GPP TS 36.523-3 []
with an additional port to configure the antenna port 6 and the Positioning
Reference Signal (PRS) in the LTE cells. The extension of LTE ASPs is defined
in annex C.
The simulated OTDOA environment is specified in 3GPP TS 37.571-2 [], clause
5.2.2), cells are synchronous and configured with the timing offset set to 0.
The PRS is transmitted according to 3GPP TS 36.211 [], clause 6.10.4.
The UE is configured in normal mode. On UE side Ciphering/Integrity (PDCP and
NAS) is enabled. The tests are performed on C-Plane.
The PRS signals are transmitted by the SS E-UTRAN, the assistance data are
written in TTCN.
## 5.5 LTE ECID test model
The test model is referred to the LTE positioning test model defined in clause
5.2.1; except that no satellite signals are required.
# 6 LTE indoor positioning system architecture and test models
## 6.1 Test system architecture
### 6.1.1 General system architecture
Refer to 3GPP TS 36.523-3 [], clause 4.1.1.
### 6.1.2 Component architecture
The same architecture as in 5.1.2 applies, excluding the UTRA PTC.
Figure 6.1.2-1: Component architecture for an E-UTRA scenario
#### 6.1.2.1 Interfaces
Refer to 5.1.2.1.
## 6.2 Test model
### 6.2.1 LTE indoor positioning test model
Figure 6.2.1-1: E-UTRA Test model for LTE indoor positioning testing
The LTE Indoor Positioning test model consists of an SS E-UTRAN protocol stack
and an Indoor Positioning simulator. Depending on the Indoor Positioning
Technology to be tested, the Indoor Positioning simulator will generate:
\- MBS beacon signals, for MBS test cases;
\- WLAN signals, for WLAN test cases;
\- Bluetooth signals, for Bluetooth test cases.
\- The Indoor Positioning simulator will be switched off for Sensor test
cases.
The SS E-UTRA emulation part is the same as the model defined in 3GPP TS
36.523-3 [].
The UE is configured in normal mode. On UE side Ciphering/Integrity (PDCP and
NAS) is enabled. The tests are performed on C-Plane.
The ASPs at POS Port are used to:
\- Load a pre-defined test scenario into the Indoor Positioning simulator.
\- Start or stop generating and broadcasting signals from the Indoor
Positioning simulator.
\- Retrieve the appropriate (MBS, WLAN, Sensor) assistance data from the
assistance data source.
Under the ASP commands, the upper tester loads or re-loads pre-defined test
scenario to the Indoor Positioning simulator. The generated signals shall
simulate the corresponding Indoor Positioning environment as specified in 3GPP
TS 37.571-2 [], clause 5.
The SS also sends the appropriate assistance data to the UE through LPP
signalling (see 3GPP TS 37.355 [10]) to facilitate the UE acquisition of MBS
Beacons or WLAN APs. For UE-based tests, the SS also sends the appropriate
assistance data to enable the UE to calculate its position for MBS or WLAN
tests, or calculate altitude based on barometric pressure sensor measurements.
The UE positioning services are encoded in a TCAP [] ROSE component [] of the
facility information element [] in the Supplement Service [] conveyed in the
NAS messages. The facility information element is encoded in BER in TTCN
referred to 3GPP TS 24.080 [], clause 3.6.1 and 3GPP TS 29.002 [], clause
17.1.1.
# 6A LTE test models requiring GNSS support
Several LTE test models specified in TS 36.523-3 [6] require the presence of a
GNSS emulation. Those are:
\- V2X services: refer to TS 36.523-3 [] clause 4.2.11
\- Aerial UE: refer to TS 36.523-3 [6] clause 4.2.12
The positioning simulator shall be capable of generating and broadcasting the
following GNSS: GPS, Galileo, GLONASS and BDS.
The ASPs at POS Port for the both test models are used to:
\- Load a pre-defined test scenario into the positioning simulator.
\- Start or stop generating and broadcasting satellite signals from the
positioning simulator.
The ASPs at POS Port for V2X services are additionally used to:
\- Trigger the positioning simulator to move in the test scenario to the next
geographical area or zone.
\- Trigger the positioning simulator to switch on/off the transmitter without
stopping the UTC time sequence.
The ASPs at POS Port for aerial UE communication are additionally used to:
\- Set an initial altitude above the sea level. Geographical latitude and
longitude are defined in the test scenario and remain constant during the test
execution.
\- Trigger the positioning simulator to simulate a vertical movement in the
test scenario towards a specified altitude level.
# 6B NG-RAN NR positioning system architecture and test models
## 6B.1 Test system architecture
### 6B.1.1 General system architecture
Refer to 3GPP TS 36.523-3 [], clause 4.1.1.
### 6B.1.2 Component architecture
The NR PTC is controlled by the TTCN-3 positioning master test component (POS
MTC) which:
\- Is an extension of the MTC as defined in 3GPP TS 38.523-3 [24], clause 4.2.
\- Controls the SS Positioning Simulator.
Figure 6B.1.2-1: Component architecture for a NR scenario
As specified in TS 37.571-2 [2], subclause 8.2.8:
\- The connection between the Position Simulator and the UE (Satellite signal)
shall be conducted.
\- The connection between the System Simulator and the UE (Radio Interface)
shall be conducted for NR FR1 and radiated (OTA) for NR FR2.
## 6B.2 Test models
### 6B.2.1 NR GNSS positioning test model
The NR positioning test model consists of an SS NR protocol stack and a
positioning simulator. The SS NR/5GC emulation part is the same as the model
defined in 3GPP TS 38.523-3 [24]. The positioning simulator is the same as for
LTE positioning test model defined in clause 5.2.1.
Figure 6B.2.1-1: Test model for NR GNSS positioning testing
### 6B.2.2 NR indoor positioning test model
The NR indoor positioning test model is the same as the NR positioning test
model in clause 6B.2.1 but replacing the Positioning simulator with an Indoor
Positioning simulator. The same principles as in clause 6.2.1 apply but
replacing LTE with NR.
### 6B.2.3 NR OTDOA (LTE) positioning test model
OTDOA measurements are not supported on NR cells in Rel-15. The OTDOA
measurements are provided by LTE cells instead. The UE will be attached to an
NR cell and the LPP session will be established over NR/5GC NAS. The UE will
report OTDOA RSTD measurements from LTE neighbour cells.
The NR OTDOA (LTE) positioning model consists of an SS NR/5GC protocol stack
and a SS E-UTRAN protocol stack. The SS NR/5GC emulation part is the same as
the model defined in 3GPP TS 38.523-3 [34]. The SS E-UTRAN emulation part is
the same as the model defined in clause 5.4 (i.e. including an additional port
to configure the antenna port 6 and the Positioning Reference Signal (PRS) in
the LTE cells). The E-UTRA PTC will not be connected to NASEMU or IMS/IP PTCs.
Figure 6B.2.3-1: Test model for NR OTDOA (LTE) positioning testing
### 6B.2.4 NR Multi-RTT, DL-AoD and DL-TDOA positioning test model
Figure 6B.2.4-1: NR Multi-RTT, DL-AoD and DL-TDOA test model
The NR Multi-RTT, DL-AoD and DL-TDOA test model is the same as the NR/5GC
Layer 3 test model (TS 38.523-3 [24], clause 5.2.1.1) with an additional port
to configure the DL Positioning Reference Signal (DL-PRS) in the NR cells. The
extension of NR ASPs is defined in annex X [TBD].
The simulated NR Multi-RTT, DL-AoD and DL-TDOA environments are specified in
TS 37.571-2 [], clauses 8.2.9, 8.2.10 and 8.2.11, respectively. The DL-PRS is
transmitted according to TS 38.211 [29], clause 7.4.1.7.
The UE is configured in normal mode. On UE side Ciphering/Integrity (PDCP and
NAS) is enabled. The tests are performed on C-Plane.
The DL-PRS is transmitted by the physical layer of the NR cell(s) in the SS.
The assistance data to provide the UE with the configuration of the DL-PRS is
sent from the SS to the UE via LPP signalling.
For Multi-RTT, the SS will be also configured through the NR_SYS port to
receive UL-SRS from the UE.
### 6B.2.5 NR E-CID test model
The test model is the same as the NR/5GC Layer 3 test model (TS 38.523-3 [24],
clause 5.2.1.1).
# 6C NR/5GC test models requiring GNSS support
The NR sidelink test model specified in TS 38.523-3 [24] clause 5.2.1.6
requires the presence of a GNSS emulation.
The positioning simulator shall be capable of generating and broadcasting the
following GNSS: GPS, Galileo, GLONASS and BDS.
The ASPs at POS Port for NR sidelink are used to:
\- Load a pre-defined test scenario into the positioning simulator.
\- Start or stop generating and broadcasting satellite signals from the
positioning simulator.
\- Trigger the positioning simulator to move in the test scenario to the next
geographical area or zone.
\- Trigger the positioning simulator to switch on/off the transmitter without
stopping the UTC time sequence.
\- Retrieve the current UTC time of the GNSS scenario.
# 7 Upper Tester Interface
## 7.1 MMI for A-GPS
Refer to 3GPP TS 34.123-3 [], clause B.1.12.
## 7.2 MMI for A-GNSS, LTE and NR positioning
Refer to 3GPP TS 36.523-3 [], clause 5.
The following MMI commands are defined for A-GNSS, LTE and NR positioning.
Table 7.2-1: MMI commands
Command Parameters
* * *
                           Name         Value
\"CHECK_LCS_CLIENT\" none  
"LOCATION_INFO" none
Table 7.2-2: MMI commands imported from 3GPP TS 36.523-3 [], clause 5
Command
* * *
\"SWITCH_ON\" \"SWITCH_OFF\" \"POWER_ON\" \"POWER_OFF\"
\"CHECK_DTCH_THROUGHCONNECTED\" \"CLEAR_STORED_ASSISTANCE_DATA\"
The following AT commands are applied in TTCN.
Table 7.2-3: AT Commands
* * *
Command Reference AT+CMOLR TS 27.007 [] AT+CMTLR TS 27.007 [] AT+CMTLRA TS
27.007 []
* * *
# 8 IXIT Proforma
## 8.1 A-GPS test suite parameters declarations
Refer to 3GPP TS 34.123-3 [], clause B.1.13.
## 8.2 A-GNSS, LTE and NR positioning test suite parameters declarations
Same PIXIT parameters are referred to clause 8.1.
Additionally, the following PIXIT parameter shall be used:
Table 8.2-1: A-GNSS, LTE and NR positioning PIXIT
Parameter Name Description Type Default Value Supported Value
* * *
px_GnssScenario2012 Usage of GNSS scenarios with date in 2012 from 3GPP TS
37.571-5 [5] BOOLEAN FALSE
# 9 Other SS Requirements with TTCN-3 impact
## 9.1 Codec Requirements
Refer to 3GPP TS 36.523-3 [6] clause 8.1 and TS 38.523-3 [24] clause 8.1.
###### ## Annex A (normative): Test Suites
This annex contains the approved TTCN Test Suites.
# A.1 UTRA A-GPS test suite
This annex includes the reference to those approved A-GPS ATS which are
contained in 3GPP TS 34.123-3 [], clause A.11.
The ATSs have been produced using the Tree and Tabular Combined Notation
(TTCN2) according to TR 101 666 [].
## A.1.1 Baseline of specifications
Table A.1.1-1 shows the baseline of the relevant core specifications and the
test specifications which the delivered ATSs are referred to.
Table A.1.1-1: Versions of the test and Core specifications
* * *
Core specifications 3GPP TS 25.331 [] Test specifications 3GPP TS 37.571-2 []
3GPP TS 37.571-3 [] 3GPP TS 37.571-5 [] 3GPP TS 34.123-3 [] 3GPP TS 34.108 []
3GPP TS 34.109 []
* * *
## A.1.2 AGPS ATS
The approved AGPS test cases are listed. An \"X\" in columns FDD or LCR TDD
indicates the test case approved for the relevant ATS.
Table A.1.2-1: AGPS TTCN test cases
* * *
Test case reference Description FDD TDD  
TS 37.571-2 [] TS 34.123-3 []  
6.1.1.1 17.2.2.1 LCS Network Induced location request/UE-Based GPS/Emergency
Call/with USIM X  
6.1.1.2 17.2.2.2 LCS Network Induced location request/UE-Based GPS/Emergency
Call/without USIM X  
6.1.1.3 17.2.2.3 LCS Network induced location request/UE-Assisted
GPS/Emergency call/With USIM X  
6.1.1.4 17.2.2.4 LCS Network induced location request/UE-Assisted
GPS/Emergency call/Without USIM X  
6.1.2.1 17.2.3.2 LCS Mobile originated location request/UE-Based GPS/Position
estimate request/Success X  
6.1.2.7 17.2.3.9 LCS Mobile originated location request/UE-Assisted
GPS/Position Estimate/Success X  
6.1.3.1 17.2.4.1 LCS Mobile terminated location request/UE-Based GPS X  
6.1.3.2 17.2.4.2 LCS Mobile-terminated location request/UE-Based GPS/Request
for additional assistance data/Success X  
6.1.3.3 17.2.4.3 LCS Mobile-terminated location request/UE-Based GPS/Failure -
Not Enough Satellites X  
6.1.3.4 17.2.4.4 LCS Mobile terminated location request/UE-Assisted
GPS/Success X  
6.1.3.5 17.2.4.5 LCS Mobile terminated location request/UE-Assisted
GPS/Request for additional assistance data/Success X  
6.1.3.7 17.2.4.7 LCS Mobile terminated location request/UE-Based GPS/Privacy
Verification/Location Not Allowed if No Response X
* * *
## A.1.3 The TTCN Machine Processable form (TTCN.MP)
The TTCN.MP representation corresponding to the corresponding FDD ATS is
referred to 3GPP TS 34.123-3 [], clause A.11.
# A.2 UTRA A-GNSS, LTE and NR/5GC positioning test suite
The test suites have been produced using the Testing and Test Control Notation
version 3 (TTCN-3) according to ES 201 873-1 [].
## A.2.1 Baseline of specifications
Table A.2.1-1 shows the baseline of the relevant core specifications and the
test specifications which the delivered TTCN test suites are referred to.
Table A.2.1-1: References of the test and Core specifications
**Core specifications** 3GPP TS 37.355 [10]
* * *
**baseline** 3GPP TS 24.301 [11] 3GPP TS 25.331 [12] 3GPP TS 24.501 [25] 3GPP
TS 36.331 [26] 3GPP TS 38.331 [27] **Test specifications** 3GPP TS 37.571-2
[3] 3GPP TS 37.571-3 [4] 3GPP TS 37.571-5 [5] 3GPP TS 36.508 [7] 3GPP TS
38.508-1 [28]
The Test Suite in TTCN3 is contained in multiple ASCII files which accompany
the present document.
## A.2.2 E-UTRA LTE positioning Test Cases
Table A.2.2-1 lists all approved test cases.
Table A.2.2-1: E-UTRA LTE positioning TTCN test cases
* * *
Test case Description 7.1.1 UE Network Capability 7.2.1.1 Location
Notification 7.2.1.2 Privacy Verification -- Location Allowed if no Response
7.2.1.3 Privacy Verification -- Location not Allowed if No Response 7.2.2.2.5s
Basic Self Location: UE-assisted sub-test 5 7.3.1.1 Position Capability
Transfer 7.3.2.1 LPP Duplicated Message 7.3.2.2 LPP Acknowledgment 7.3.2.3 LPP
Retransmission 7.3.3.1 LPP Requested Method not Supported -- UE-Assisted sub-
test 1 7.3.4.2.5s E-SMLC Initiated Assistance Data Delivery followed by
Location Information Transfer: UE-Assisted sub-test 5 7.3.4.2.6s E-SMLC
Initiated Assistance Data Delivery followed by Location Information Transfer:
UE-Assisted sub-test 6 7.3.4.2.7s E-SMLC Initiated Assistance Data Delivery
followed by Location Information Transfer: UE-Assisted sub-test 7 7.3.4.4.5s
E-SMLC Initiated Position Measurement without assistance data: UE-Assisted
sub-test 5 7.3.4.4.7s E-SMLC Initiated Position Measurement without assistance
data: UE-Assisted sub-test 7 7.3.5.1.5s E-SMLC initiated Abort sub-test 5
* * *
## A.2.3 UTRA A-GNSS Test Cases
Table A.2.3-1 lists all approved test cases.
Table A.2.3-1: UTRA A-GNSS TTCN test cases
* * *
Test case Description 6.2.1.1.4s NI-LR Emergency Call: UE-Based A-GNSS sub-
test 4 6.2.2.1.4s MO-LR Position Estimate: UE-Based A-GNSS sub-test 4
6.2.2.3.4s MO-LR Position Estimate: UE-Based A-GNSS -- Failure Not Enough
Satellites sub-test 4 6.2.3.2.4s MT-LR Position Estimate: UE-Based A-GNSS --
Failure Not Enough Satellites sub-test 4 6.2.3.3 Location Notification 6.2.3.4
Privacy Verification - Location Allowed if No Response 6.2.3.5 Privacy
Verification - Location Not Allowed if No Response
* * *
## A.2.4 NR/5GC Test Cases
Table A.2.4-1 lists all approved test cases.
Table A.2.4-1: NR/5GC TTCN test cases
* * *
Test case Description 9.3.1.1.NR5GC Position Capability Transfer
9.3.1.2.5s.NR5GC LPP Abort: Subtest 5 9.3.1.2.15s.NR5GC LPP Abort: Subtest 15
9.3.1.2.19s.NR5GC LPP Abort: Subtest 19 9.3.2.1.NR5GC LPP Duplicated Message
9.3.2.2.NR5GC LPP Acknowledgement 9.3.2.3.NR5GC LPP Retransmission
9.3.4.1.15s.NR5GC E-SMLC Initiated Assistance Data Delivery followed by
Location Information Transfer: UE-Based: Subtest 15 9.3.4.2.15s.NR5GC E-SMLC
Initiated Assistance Data Delivery followed by Location Information Transfer:
UE-Assisted: Subtest 15 9.3.4.2.19s.NR5GC E-SMLC Initiated Assistance Data
Delivery followed by Location Information Transfer: UE-Assisted: Subtest 19
9.3.4.2.20s.NR5GC E-SMLC Initiated Assistance Data Delivery followed by
Location Information Transfer: UE-Assisted: Subtest 20 9.3.4.2.21s.NR5GC
E-SMLC Initiated Assistance Data Delivery followed by Location Information
Transfer: UE-Assisted: Subtest 21 9.3.4.2.22s.NR5GC E-SMLC Initiated
Assistance Data Delivery followed by Location Information Transfer: UE-
Assisted: Subtest 22 9.3.4.3.15s.NR5GC E-SMLC Initiated Position Measurement
without Assistance Data: UE-Based: Subtest 15 9.3.4.4.15s.NR5GC E-SMLC
Initiated Position Measurement without Assistance Data: UE-Assisted: Subtest
15
* * *
###### ## Annex B (informative): ASN.1 modules
# B.1 A-GPS ASN.1 module
Refer to 3GPP TS 34.123-3 [], annex H.1.
# B.2 A-GNSS ASN.1 modules
Refer to 3GPP TS 34.123-3 [], annex H.2.
# B.3 LPP ASN.1
The LPP asn.1 modules are extracted from 3GPP TS 37.355 [] without any change.
###### ## Annex C (informative): E-UTRA System Simulator Extension ASP
Definitions in TTCN-3
# C.1 EUTRA_POS_ASP_TypeDefs
Type definitions for configuration of Positioning Reference Signal in the
system simulator; Common design principles: refer to 3GPP TS 36.523-3 [],
annex D.
## C.1.1 System_Configuration_PosExt
Formal ASP Definitions for EUTRA PRS system configuration.
SystemRequest_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#Syste | **SystemReq | | | mRequest_PosExt_Type | uest_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | NOTE: Same structure | | | | as | | | | SystemRequest_Type | | | | in 3GPP TS 36.523-3 | | | | [], annex D. | | +----------------------+----------------------+----------------------+ | Cell | Cell | configure PRS in an | | | ConfigRequest_PosEx | LTE cell; | | | t_Type | the cell shall be | | | | configured as usual | | | | beforehand and SS | | | | shall raise an error | | | | when the cell does | | | | not exist yet; | | | | | | | | there is no explicit | | | | release of the PRS | | | | but the whole cell | | | | needs to be released | +----------------------+----------------------+----------------------+
SystemConfirm_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#Syste | **SystemCon | | | mConfirm_PosExt_Type | firm_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | confirmations for | | | | system | | | | configuration; | | | | | | | | in general to be | | | | sent after the | | | | configuration has | | | | been done | | +----------------------+----------------------+----------------------+ | Cell | Null_Type | (no further | | | | parameters from SS) | +----------------------+----------------------+----------------------+
## C.1.2 Cell_Configuration_PosExt
Specific Info for PRS Cell Configuration Primitive.
### C.1.2.1 Cell_Configuration_Common_PosExt
CellConfigRequest_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#CellConfi | **CellConfigReq | | | gRequest_PosExt_Type | uest_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | NOTE: Same structure | | | | as | | | | SystemRequest_Type | | | | in 3GPP TS 36.523-3 | | | | [], annex D. | | +----------------------+----------------------+----------------------+ | AddOrReconfigure | CellConfigInfo_Po | for PRS | | | sExt_Type | given cell: | | | | | | | | CellId : identifier | | | | of the cell to be | | | | configured | | | | | | | | RoutingInfo : None | | | | | | | | TimingInfo : Now | | | | (for initial | | | | configuration and | | | | for reconfiguration | | | | in general) | | | | | | | | ControlInfo : | | | | CnfFlag:=true; | | | | FollowOnFlag:=false | | | | (in general) | +----------------------+----------------------+----------------------+
CellConfigInfo_PosExt_Type
+-------------------+-------------------+-----+-------------------+ | **TTCN-3 Record | | | | | Type** | | | | +-------------------+-------------------+-----+-------------------+ | []{#CellConfi | **CellConfigInf | | | | gInfo_PosExt_Type | o_PosExt_Type** | | | | .anchor}**Name** | | | | +-------------------+-------------------+-----+-------------------+ | **Comment** | NOTE: Same | | | | | structure as | | | | | Sy | | | | | stemRequest_Type | | | | | in 3GPP TS | | | | | 36.523-3 [], | | | | | annex D; | | | | | | | | | | common | | | | | information for | | | | | initial cell | | | | | configuration or | | | | | reconfiguration; | | | | | | | | | | in case of | | | | | reconfiguration | | | | | OMIT means \'keep | | | | | configuration as | | | | | it is\'. | | | +-------------------+-------------------+-----+-------------------+ | Basic | BasicCell | opt | Extended PRS | | | Config_PosExt_T | | information for a | | | ype | | | +-------------------+-------------------+-----+-------------------+
BasicCellConfig_PosExt_Type
+-------------------+-------------------+-----+-------------------+ | **TTCN-3 Record | | | | | Type** | | | | +-------------------+-------------------+-----+-------------------+ | []{#BasicCellC | **BasicCellConfi | | | | onfig_PosExt_Type | g_PosExt_Type** | | | | .anchor}**Name** | | | | +-------------------+-------------------+-----+-------------------+ | **Comment** | NOTE: Same | | | | | structure as | | | | | Sy | | | | | stemRequest_Type | | | | | in 3GPP TS | | | | | 36.523-3 [], | | | | | annex D. | | | | | | | | | | Physical layer: | | | +-------------------+-------------------+-----+-------------------+ | Phys | Phys | opt | Default settings | | icalLayerConfigDL | icalLayerConfigDL | | regarding | | | _PosExt_Type | | | +-------------------+-------------------+-----+-------------------+
### C.1.2.2 Downlink_Physical_Layer_Configuration_PosExt
Downlink physical layer configuration:
\- DL antenna configuration for port 6.
\- PRS configuration.
AntennaPort6_Config_Type
+----------------------------+----------------------------+-----+---+ | **TTCN-3 Record Type** | | | | +----------------------------+----------------------------+-----+---+ | [] | **An | | | | {#AntennaPort6_Config_Type | tennaPort6_Config_Type** | | | | .anchor}**Name** | | | | +----------------------------+----------------------------+-----+---+ | **Comment** | to configure antenna port | | | | | 6 for positioning; | | | | | | | | | | all fields are declared as | | | | | optional to allow single | | | | | reconfigurations; in this | | | | | case omit means \"keep as | | | | | it is\" | | | +----------------------------+----------------------------+-----+---+ | Port | AntennaPort_Type | opt | | +----------------------------+----------------------------+-----+---+ | PRS | PRS_Info | opt | | +----------------------------+----------------------------+-----+---+
PhysicalLayerConfigDL_PosExt_Type
* * *
**TTCN-3 Record Type**  
[]{#PhysicalLayerConfigDL_PosExt_Type .anchor}**Name**
**PhysicalLayerConfigDL_PosExt_Type**  
**Comment** all fields are declared as optional to allow single
reconfigurations; in this case omit means \"keep as it is\"  
AntennaPort6 AntennaPort6_Config_Type opt
* * *
## C.1.3 System_Interface_PosExt
SYSTEM_CTRL_POSEXT_REQ
* * *
**TTCN-3 Record Type**  
[]{#SYSTEM_CTRL_POSEXT_REQ .anchor}**Name** **SYSTEM_CTRL_POSEXT_REQ**  
**Comment**  
Common ReqAspCommonPart_Type For configuration of antenna port 6 TimingInfo is
now Request SystemRequest_PosExt_Type configure a PRS in a cell
* * *
SYSTEM_CTRL_POSEXT_CNF
+--------------------+--------------------+---+--------------------+ | **TTCN-3 Record | | | | | Type** | | | | +--------------------+--------------------+---+--------------------+ | []{#SYST | **SYSTEM_C | | | | EM_CTRL_POSEXT_CNF | TRL_POSEXT_CNF** | | | | .anchor}**Name** | | | | +--------------------+--------------------+---+--------------------+ | **Comment** | | | | +--------------------+--------------------+---+--------------------+ | Common | CnfA | | TimingInfo is | | | spCommonPart_Type | | ignored by TTCN | | | | | | | | | | => SS may set | | | | | TimingInfo to | | | | | \"None\" | +--------------------+--------------------+---+--------------------+ | Confirm | Sy | | | | | stemConfirm_PosEx | | | | | t_Type | | | +--------------------+--------------------+---+--------------------+
EUTRA_SYSTEM_POSEXT_PORT
* * *
**TTCN-3 Port Type**  
**Name** **EUTRA_SYSTEM_POSEXT_PORT**  
**Comment** EUTRA PTC: Ext Port for system configuration of antenna port 6  
out SYSTEM_CTRL_POSEXT_REQ  
in SYSTEM_CTRL_POSEXT_CNF
* * *
# C.2 References to TTCN-3
* * *
**References to TTCN-3**  
**EUTRA_POS_ASP_TypeDefs** Positioning/EUTRA_POS_ASP_TypeDefs.ttcn Rev 6449
* * *
###### ## Annex D (informative) Positioning System Simulator ASP Definitions
in TTCN-3
# D.1 PosSystem_ASP_TypeDefs
PosSystem_ASP_TypeDefs: Constant Definitions
* * *
**TTCN-3 Basic Types**  
[]{#tsc_MaxPosSystems .anchor}**tsc_MaxPosSystems** integer 12
* * *
PositioningSystemType
* * *
**TTCN-3 Enumerated Type**  
[]{#PositioningSystemType .anchor}**Name** **PositioningSystemType**
**Comment**  
gps  
modernizedGPS  
glonass  
galileo  
qzss  
otdoa  
ecid  
bds  
mbs  
wlan  
bluetooth  
sensor
* * *
PositioningSystemList_Type
* * *
**TTCN-3 Record of Type**  
[]{#PositioningSystemList_Type .anchor}**Name** **PositioningSystemList_Type**
**Comment**  
record length (1..tsc_MaxPosSystems) of PositioningSystemType
* * *
Altitude_Type
* * *
**TTCN-3 Record Type**  
**Name** **Altitude_Type**  
**Comment**  
Height integer Height above a sea level in meters
* * *
## D.1.1 PosSystem_Load_Scenario
Load scenarios follow 3GPP TS 37.571-5 [5]
PosSystem_Load_Scenario: Basic Type Definitions
* * *
**TTCN-3 Basic Types**  
[]{#ScenarioNumber_Type .anchor}**ScenarioNumber_Type** integer
* * *
PositioningScenario_Type
* * *
**TTCN-3 Union Type**  
[]{#PositioningScenario_Type .anchor}**Name** **PositioningScenario_Type**  
**Comment**  
LTE_Positioning ScenarioNumber_Type Reference to 3GPP TS 37.571-5 [5] AGNSS
ScenarioNumber_Type Reference to 3GPP TS 37.571-5 [5] V2X ScenarioNumber_Type
V2X Reference to 3GPP TS 36.508 [7] clause 4.11 NR_Positioning
ScenarioNumber_Type Reference to 3GPP TS 37.571-5 [5] Aerial
ScenarioNumber_Type Reference to 3GPP TS 36.508 [7] clause 4.12 NR_Sidelink
ScenarioNumber_Type Reference to 3GPP TS 38.508-1 [30] clause 4.11
* * *
## D.1.2 PosSystem_Retrieve_Data
### D.1.2.1 SatSystem_Retrieve_UTRAN_Data
UTRAN_GPS_AssistanceDataRequest_Type
* * *
**TTCN-3 Record Type**  
[]{#UTRAN_GPS_AssistanceDataRequest_Type .anchor}**Name**
**UTRAN_GPS_AssistanceDataRequest_Type**  
**Comment**  
AssistanceDataReqGPS bitstring bitstring containing 3GPP TS 25.331 [12] type
UE-Positioning-GPS-AdditionalAssistanceDataRequest
* * *
UTRAN_GANSS_AssistanceDataRequest_Type
* * *
**TTCN-3 Record Type**  
[]{#UTRAN_GANSS_AssistanceDataRequest_Type .anchor}**Name**
**UTRAN_GANSS_AssistanceDataRequest_Type**  
**Comment**  
AssistanceDataReqGANSS bitstring opt bitstring containing 3GPP TS 25.331 [12]
type UE-Positioning-GANSS-AdditionalAssistanceDataRequest
AssistanceDataReqGANSSv860ext bitstring opt bitstring containing 3GPP TS
25.331 [12] type UE-Positioning-GANSS-AdditionalAssistanceDataRequest-v860ext
AssistanceDataReqGANSSvc50ext bitstring opt bitstring containing 3GPP TS
25.331 [12] type UE-Positioning-GANSS-AdditionalAssistanceDataRequest-vc50ext
* * *
UTRAN_AssistanceDataRequest_Type
* * *
**TTCN-3 Union Type**  
[]{#UTRAN_AssistanceDataRequest_Type .anchor}**Name**
**UTRAN_AssistanceDataRequest_Type**  
**Comment**  
GPS UTRAN_GPS_AssistanceDataRequest_Type  
GANSS UTRAN_GANSS_AssistanceDataRequest_Type
* * *
UTRAN_AssistanceDataRequestList_Type
* * *
**TTCN-3 Record of Type**  
[]{#UTRAN_AssistanceDataRequestList_Type .anchor}**Name**
**UTRAN_AssistanceDataRequestList_Type** **Comment**  
record length(1..tsc_MaxPosSystems) of UTRAN_AssistanceDataRequest_Type
* * *
UTRAN_GPS_AssistanceData_Type
+-------------------+-------------------+-----+-------------------+ | **TTCN-3 Record | | | | | Type** | | | | +-------------------+-------------------+-----+-------------------+ | []{#UTRAN_GPS_As | ** | | | | sistanceData_Type | UTRAN_GPS_Assis | | | | .anchor}**Name** | tanceData_Type**| | | +-------------------+-------------------+-----+-------------------+ |** Comment** | The returned | | | | | Almanac | | | | | information is | | | | | split into two | | | | | fields: | | | | | | | | | | Almanac for | | | | | satellites 1 to | | | | | 16 in | | | | | As | | | | | sistanceDataGPSr7 | | | | | together with | | | | | other | | | | | information; | | | | | | | | | | Almanac for | | | | | satellites 17 to | | | | | 31: in | | | | | \'a | | | | | lmanacSat17To31\' | | | +-------------------+-------------------+-----+-------------------+ | As | bitstring | opt | bitstring | | sistanceDataGPSr7 | | | containing 3GPP | | | | | TS 25.331 [12] | | | | | type | | | | | UE | | | | | -Positioning-GPS- | | | | | AssistanceData-r7 | +-------------------+-------------------+-----+-------------------+ | Ass | bitstring | opt | bitstring | | istanceDataGPSr12 | | | containing 3GPP | | | | | TS 25.331 [12] | | | | | type | | | | | UE- | | | | | Positioning-GPS-A | | | | | ssistanceData-r12 | +-------------------+-------------------+-----+-------------------+ | Almanac | bitstring | opt | bitstring | | SatInfoList17To31 | | | containing 3GPP | | | | | TS 25.331 [12] | | | | | type | | | | | A | | | | | lmanacSatInfoList | +-------------------+-------------------+-----+-------------------+
UTRAN_GANSS_AssistanceData_Type
* * *
**TTCN-3 Record Type**  
[]{#UTRAN_GANSS_AssistanceData_Type .anchor}**Name**
**UTRAN_GANSS_AssistanceData_Type**  
**Comment**  
AssistanceDataGANSS_r8 bitstring opt bitstring containing 3GPP TS 25.331 [12]
type UE-Positioning-GANSS-AssistanceData-r8 AssistanceDataGANSS_r12 bitstring
opt bitstring containing 3GPP TS 25.331 [12] type UE-Positioning-GANSS-
AssistanceData-r12
* * *
UTRAN_AssistanceData_Type
* * *
**TTCN-3 Union Type**  
[]{#UTRAN_AssistanceData_Type .anchor}**Name** **UTRAN_AssistanceData_Type**  
**Comment**  
GPS UTRAN_GPS_AssistanceData_Type  
GANSS UTRAN_GANSS_AssistanceData_Type
* * *
UTRAN_AssistanceDataList_Type
* * *
**TTCN-3 Record of Type**  
[]{#UTRAN_AssistanceDataList_Type .anchor}**Name**
**UTRAN_AssistanceDataList_Type** **Comment**  
record length(1..tsc_MaxPosSystems) of UTRAN_AssistanceData_Type
* * *
### D.1.2.2 PosSystem_Retrieve_LPP_Data
When data is to be requested for more than one positioning system, they will
be included into one single template. This template will include a list with
one element for each positioning system.\ See template
\"cs_RequestAssistData_UEB_GpsAndGlonass\" as an example.
LPP_AssistanceDataRequest_Type
* * *
**TTCN-3 Union Type**  
**Name** **LPP_AssistanceDataRequest_Type**  
**Comment**  
LPP_AssistanceData bitstring bitstring containing 3GPP TS 37.355 [10] type
RequestAssistanceData-r9-IEs
* * *
LPP_AssistanceDataProvide_Type
* * *
**TTCN-3 Union Type**  
**Name** **LPP_AssistanceDataProvide_Type**  
**Comment**  
LPP_AssistanceData bitstring bitstring containing 3GPP TS 37.355 [10] type
ProvideAssistanceData-r9-IEs
* * *
LPP_AssistanceDataRequestList_Type
* * *
**TTCN-3 Record of Type**  
**Name** **LPP_AssistanceDataRequestList_Type** **Comment**  
record length(1..tsc_MaxPosSystems) of LPP_AssistanceDataRequest_Type
* * *
LPP_AssistanceDataList_Type
* * *
**TTCN-3 Record of Type**  
**Name** **LPP_AssistanceDataList_Type** **Comment**  
record length(1..tsc_MaxPosSystems) of LPP_AssistanceDataProvide_Type
* * *
### D.1.2.3 PosSystem_Retrieve_Data_Common
AssistanceDataRetrieveRequest_Type
* * *
**TTCN-3 Union Type**  
[]{#AssistanceDataRetrieveRequest_Type .anchor}**Name**
**AssistanceDataRetrieveRequest_Type**  
**Comment**  
LPP LPP_AssistanceDataRequestList_Type LTE/NR positioning UTRA_GNSS
UTRAN_AssistanceDataRequestList_Type Retrieve A-GNSS data list in the order of
positioning system provided in PositioningSystemList
* * *
AssistanceDataRetrieveResponse_Type
* * *
**TTCN-3 Union Type**  
[]{#AssistanceDataRetrieveResponse_Type .anchor}**Name**
**AssistanceDataRetrieveResponse_Type**  
**Comment**  
LPP LPP_AssistanceDataList_Type LTE/NR positioning UTRA_AGNSS
UTRAN_AssistanceDataList_Type Retrieve A-GNSS data list in the order of
positioning system provided in PositioningSystemList
* * *
## D.1.3 PosSystem_PowerControl
PowerControl_Type
* * *
**TTCN-3 Union Type**  
[]{#PowerControl_Type .anchor}**Name** **PowerControl_Type**  
**Comment** V2X. The GNSS simulator is switched on/off without stopping the
UTC time sequence  
PowerOn Null_Type By default the power is on in the GNSS simulator PowerOff
Null_Type
* * *
## D.1.4 PosSystem_GnssUtcTime
GnssUtcTime_Type
* * *
**TTCN-3 Record Type**  
[]{#GnssUtcTime_Type .anchor}**Name** **GnssUtcTime_Type**  
**Comment**  
Struct_tm Struct_tm_Type Local GNSS time TimezoneInfo integer Difference (in
seconds) between the UTC time (GMT) and the local time
* * *
## D.1.5 System_Interface
Common ASP definitions
PosSystemCrtlRequest_Type
* * *
**TTCN-3 Union Type**  
[]{#PosSystemCrtlRequest_Type .anchor}**Name** **PosSystemCrtlRequest_Type**  
**Comment**  
Start Null_Type  
Stop Null_Type  
LoadScenario PositioningScenario_Type  
RetrieveData AssistanceDataRetrieveRequest_Type  
TriggerMove Null_Type V2X. Start moving to the next area/zone in the scenario
TriggerPowerOnOff PowerControl_Type V2X. Switch on/off the transmitter without
stopping UTC time sequence SetAltitude Altitude_Type Aerial Set the height
above the sea level to the provided value TriggerAerialMove Altitude_Type
Aerial Start moving towards target height RetrieveGnssUtcTime Null_Type Get
current UTC time of the GNSS scenario. This can only be used once a GNSS
scenario has been loaded and started
* * *
PosSystemCrtlConfirm_Type
* * *
**TTCN-3 Union Type**  
[]{#PosSystemCrtlConfirm_Type .anchor}**Name** **PosSystemCrtlConfirm_Type**  
**Comment** In general, to be sent after the configuration has been done  
Start Null_Type  
Stop Null_Type  
LoadScenario Null_Type  
RetrieveData AssistanceDataRetrieveResponse_Type  
TriggerMove Null_Type V2X TriggerPowerOnOff Null_Type V2X SetAltitude
Null_Type Aerial TriggerAerialMove Null_Type Aerial RetrieveGnssUtcTime
GnssUtcTime_Type
* * *
POS_SYSTEM_CTRL_REQ
* * *
**TTCN-3 Record Type**  
[]{#POS_SYSTEM_CTRL_REQ .anchor}**Name** **POS_SYSTEM_CTRL_REQ**  
**Comment**  
PositioningSystemList PositioningSystemList_Type The list of positioning
systems to be configured; there is only one system of one type in the list
e.g. gps, galileo etc. CnfFlag boolean true => SS shall send CNF Request
PosSystemCrtlRequest_Type
* * *
POS_SYSTEM_CTRL_CNF
* * *
**TTCN-3 Record Type**  
[]{#POS_SYSTEM_CTRL_CNF .anchor}**Name** **POS_SYSTEM_CTRL_CNF**  
**Comment**  
PositioningSystemList PositioningSystemList_Type  
Confirm PosSystemCrtlConfirm_Type
* * *
POS_MTC_SYSTEM_PORT
* * *
**TTCN-3 Port Type**  
**Name** **POS_MTC_SYSTEM_PORT**  
**Comment** Positioning: port at the MTC to be mapped to the system  
out POS_SYSTEM_CTRL_REQ  
in POS_SYSTEM_CTRL_CNF
* * *
POS_MTC_PTC_PORT
* * *
**TTCN-3 Port Type**  
**Name** **POS_MTC_PTC_PORT**  
**Comment** Positioning: port at the MTC to hand over information from the
positioning system to the PTC(s)  
out POS_SYSTEM_CTRL_CNF  
in POS_SYSTEM_CTRL_REQ
* * *
POS_PTC_MTC_PORT
* * *
**TTCN-3 Port Type**  
**Name** **POS_PTC_MTC_PORT**  
**Comment** Positioning: port at the PTC(s) to send commands to the
positioning system via the MTC  
out POS_SYSTEM_CTRL_REQ  
in POS_SYSTEM_CTRL_CNF
* * *
# D.2 CommonDefs
CommonDefs: Basic Type Definitions
* * *
**TTCN-3 Basic Types**  
[]{#Null_Type .anchor}**Null_Type** boolean (true) dummy type for \'typeless\'
fields in unions
* * *
Struct_tm_Type
* * *
**TTCN-3 Record Type**  
[]{#Struct_tm_Type .anchor}**Name** **Struct_tm_Type**  
**Comment** TTCN-3 equivalent for the \"struct tm\" as defined on C standard
library (time.h or ctime.h for C or C++)  
tm_sec integer seconds after the minute 0..61 (tm_sec is generally 0-59. Extra
range to accommodate for leap seconds in certain systems) tm_min integer
minutes after the hour 0..59 tm_hour integer hours since midnight 0..23
tm_mday integer day of the month 1..31 tm_mon integer months since January
0..11 tm_year integer years since 1900 tm_wday integer days since Sunday 0..6
tm_yday integer days since January 1 0..365 tm_isdst integer Daylight Saving
Time flag
* * *
# D.3 References to TTCN-3
* * *
**References to TTCN-3**  
**PosSystem_ASP_TypeDefs** POS/PosSystem_ASP_TypeDefs.ttcn Rev 32599
**CommonDefs** Common/CommonDefs.ttcn Rev 32608
* * *
###### ## Annex E (informative) NR5GC System Simulator Extension ASP
Definitions in TTCN-3
# E.1 NR5GC_POS_ASP_TypeDefs
Type definitions for configuration of DL Positioning Reference Signal in the
system simulator;\ Common design principles: refer to 3GPP TS 38.523-3 [24]
annex D.
## E.1.1 NR_System_Configuration_PosExt
Formal ASP Definitions for NR5GC DL-PRS system configuration
NR_SystemRequest_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#NR_Syste | **NR_SystemReq | | | mRequest_PosExt_Type | uest_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | NOTE: Same structure | | | | as | | | | NR\ | | | | _SystemRequest_Type | | | | in 3GPP TS 38.523-3 | | | | [24] annex D | | +----------------------+----------------------+----------------------+ | Cell | NR_CellCon | configure DL-PRS in | | | figRequest_PosExt_ | an NR cell; | | | Type | the cell shall be | | | | configured as usual | | | | beforehand and SS | | | | shall raise an error | | | | when the cell does | | | | not exist yet; | | | | | | | | there is no explicit | | | | release of the PRS | | | | but the whole cell | | | | needs to be released | +----------------------+----------------------+----------------------+
NR_SystemConfirm_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#NR_Syste | **NR_SystemCon | | | mConfirm_PosExt_Type | firm_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | confirmations for | | | | system | | | | configuration; | | | | | | | | in general to be | | | | sent after the | | | | configuration has | | | | been done | | +----------------------+----------------------+----------------------+ | Cell | Null_Type | (no further | | | | parameters from SS) | +----------------------+----------------------+----------------------+
## E.1.2 NR_Cell_Configuration_PosExt
Specific Info for DL-PRS Cell Configuration Primitive
### E.1.2.1 NR_Cell_Configuration_Common_PosExt
NR_CellConfigRequest_PosExt_Type
+----------------------+----------------------+----------------------+ | **TTCN-3 Union | | | | Type** | | | +----------------------+----------------------+----------------------+ | []{#NR_CellConfi | **NR_CellConfigReq | | | gRequest_PosExt_Type | uest_PosExt_Type** | | | .anchor}**Name** | | | +----------------------+----------------------+----------------------+ | **Comment** | NOTE: Same structure | | | | as | | | | NR\ | | | | _SystemRequest_Type | | | | in 3GPP TS 38.523-3 | | | | [24] annex D | | +----------------------+----------------------+----------------------+ | AddOrReconfigure | NR_C | for PRS | | | ellConfigInfo_PosEx | configuration of | | | t_Type | | | | | CellId : identifier | | | | of the cell to be | | | | configured | | | | | | | | RoutingInfo : None | | | | | | | | RlcBearerRouting : | | | | \'None\' | | | | | | | | MacBearerRouting : | | | | \'omit\' | | | | | | | | TimingInfo : Now | | | | (for initial | | | | configuration and | | | | for reconfiguration | | | | in general) | | | | | | | | ControlInfo : | | | | CnfFlag:=true; | | | | FollowOnFlag:=false | | | | (in general) | +----------------------+----------------------+----------------------+
NR_CellConfigInfo_PosExt_Type
+-------------------+-------------------+-----+-------------------+ | **TTCN-3 Record | | | | | Type** | | | | +-------------------+-------------------+-----+-------------------+ | []{#NR_CellConfi | ** | | | | gInfo_PosExt_Type | NR_CellConfigInf | | | | .anchor}**Name** | o_PosExt_Type**| | | +-------------------+-------------------+-----+-------------------+ |** Comment** | NOTE: Same | | | | | structure as | | | | | NR_Sy | | | | | stemRequest_Type | | | | | in 3GPP TS | | | | | 38.523-3 [24] | | | | | annex D | | | | | | | | | | common | | | | | information for | | | | | initial cell | | | | | configuration or | | | | | reconfiguration; | | | | | | | | | | in case of | | | | | reconfiguration | | | | | OMIT means \'keep | | | | | configuration as | | | | | it is\' | | | +-------------------+-------------------+-----+-------------------+ | PhysicalLayer | NR_CellConfigP | opt | Extended DL-PRS | | | hysicalLayer_Pos | | information for a | | | Ext_Type | | | +-------------------+-------------------+-----+-------------------+
NR_CellConfigPhysicalLayer_PosExt_Type
+-------------------+-------------------+-----+-------------------+ | **TTCN-3 Record | | | | | Type** | | | | +-------------------+-------------------+-----+-------------------+ | []{#NR_C | **NR_CellC | | | | ellConfigPhysical | onfigPhysicalLaye | | | | Layer_PosExt_Type | r_PosExt_Type** | | | | .anchor}**Name** | | | | +-------------------+-------------------+-----+-------------------+ | **Comment** | NOTE: Same | | | | | structure as | | | | | NR_Sy | | | | | stemRequest_Type | | | | | in 3GPP TS | | | | | 38.523-3 [24] | | | | | annex D | | | | | | | | | | Physical layer: | | | +-------------------+-------------------+-----+-------------------+ | Downlink | NR_Cell | opt | Default settings | | | ConfigPhysicalLay | | regarding | | | erDownlink_PosEx | | physical control | | | t_Type | | | +-------------------+-------------------+-----+-------------------+
### E.1.2.2 Downlink_Physical_Layer_Configuration_PosExt
Downlink physical layer configuration:\ \- DL-PRS Frequency Layer
configuration.\ \- DL-PRS TRP configuration.
Downlink_Physical_Layer_Configuration_PosExt: Basic Type Definitions
* * *
**TTCN-3 Basic Types**  
[]{#DlPrs_CombSizeN_Type .anchor}**DlPrs_CombSizeN_Type**
NR_DL_PRS_PositioningFrequencyLayer_r16.dl_PRS_CombSizeN_r16
* * *
DlPrs_FreqLayerConfig_Type
* * *
**TTCN-3 Record Type**  
[]{#DlPrs_FreqLayerConfig_Type .anchor}**Name** **DlPrs_FreqLayerConfig_Type**  
**Comment**  
DlPrs_ResourceBW integer opt  
DlPrs_CombSizeN DlPrs_CombSizeN_Type opt
* * *
DlPrs_TRPConfig_Type
* * *
**TTCN-3 Record Type**  
[]{#DlPrs_TRPConfig_Type .anchor}**Name** **DlPrs_TRPConfig_Type**  
**Comment**  
NrDlPrsSfn0Offset NR_DL_PRS_SFN0_Offset_r16 opt  
NrDlPrsExpectedRstd integer opt  
NrDlPrsExpectedRstdUncertainty integer opt  
NrDlPrsInfo NR_DL_PRS_Info_r16 opt
* * *
DL_PRSConfig_Type
+----------------------------+----------------------------+-----+---+ | **TTCN-3 Record Type** | | | | +----------------------------+----------------------------+-----+---+ | []{#DL_PRSConfig_Type | **DL_PRSConfig_Type** | | | | .anchor}**Name** | | | | +----------------------------+----------------------------+-----+---+ | **Comment** | to configure DL-PRS for | | | | | positioning; | | | | | | | | | | all fields are declared as | | | | | optional to allow single | | | | | reconfigurations; in this | | | | | case omit means \"keep as | | | | | it is\" | | | +----------------------------+----------------------------+-----+---+ | DlPrs_FreqLayerConfig | DlPrs\ | opt | | | | _FreqLayerConfig_Type | | | +----------------------------+----------------------------+-----+---+ | DlPrs_TRPConfig | DlPrs_TRPConfig_Ty | opt | | | | pe | | | +----------------------------+----------------------------+-----+---+
NR_CellConfigPhysicalLayerDownlink_PosExt_Type
* * *
**TTCN-3 Record Type**  
[]{#NR_CellCon__PhysicalLayerDownlink_PosExt .anchor}**ame**
**NR_CellConfigPhysicalLayerDownlink_PosExt_Type**  
**Comment** all fields are declared as optional to allow single
reconfigurations; in this case omit means \"keep as it is\"  
DL_PRSConfig DL_PRSConfig_Type opt
* * *
## E.1.3 NR_System_Interface_PosExt
NR_SYSTEM_CTRL_POSEXT_REQ
* * *
**TTCN-3 Record Type**  
[]{#NR_SYSTEM_CTRL_POSEXT_REQ .anchor}**Name** **NR_SYSTEM_CTRL_POSEXT_REQ**  
**Comment**  
Common NR_ReqAspCommonPart_Type For configuration of DL-PRS TimingInfo is now
Request NR_SystemRequest_PosExt_Type configure a DL-PRS in a cell
* * *
NR_SYSTEM_CTRL_POSEXT_CNF
+--------------------+--------------------+---+--------------------+ | **TTCN-3 Record | | | | | Type** | | | | +--------------------+--------------------+---+--------------------+ | []{#NR_SYST | **NR_SYSTEM_C | | | | EM_CTRL_POSEXT_CNF | TRL_POSEXT_CNF** | | | | .anchor}**Name** | | | | +--------------------+--------------------+---+--------------------+ | **Comment** | | | | +--------------------+--------------------+---+--------------------+ | Common | NR_CnfA | | TimingInfo is | | | spCommonPart_Type | | ignored by TTCN | | | | | | | | | | => SS may set | | | | | TimingInfo to | | | | | \"None\" | +--------------------+--------------------+---+--------------------+ | Confirm | NR_Syste | | | | | mConfirm_PosExt_ | | | | | Type | | | +--------------------+--------------------+---+--------------------+
NR_SYSTEM_POSEXT_PORT
* * *
**TTCN-3 Port Type**  
**Name** **NR_SYSTEM_POSEXT_PORT**  
**Comment** NR PTC: Ext Port for system configuration of DL-PRS  
out NR_SYSTEM_CTRL_POSEXT_REQ  
in NR_SYSTEM_CTRL_POSEXT_CNF
* * *
# E.2 References to TTCN-3
* * *
**References to TTCN-3**  
**NR5GC_POS_ASP_TypeDefs** NR5GC/NR5GC_POS_ASP_TypeDefs.ttcn Rev 20699
* * *
#