# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The objective of this study is to enhance the common 5G core network defined
in TS 23.501 [2] and TS 23.502 [3] in order to support wireline access
networks and Trusted N3GPP.
The key areas of the investigation are:
\- **Support of** wireline access networks**:**
\- Definition of the 5G Core network (5GC) with respect to wireline access
functional split;
\- Investigation on whether enhancements are needed to interfaces (e.g. N1, N2
and N3) used to connect wireline customer devices (CPE/Residential Gateway)
and wireline access network to the converged 5GC;
\- Study the impact of the common framework for authentication and security,
policy and QoS, Network Slicing and investigation on whether enhancements are
needed;
NOTE 1: The area of investigation for authentication and security will be
limited to the part relevant to SA WG2 scope and responsibility.
\- Study on how to support CPE/Residential Gateway (RG) capable of connecting
via wireline and/or wireless access to the 5G CN;
\- Study on how to support end user devices, with or without UICC, connected
to the convergent 5GC from behind a CPE/RG;
\- Identification of the impacts on mobility, session management and
interaction with Access Traffic Steering, Switching and Splitting for UEs
accessing the 5G convergent network studied in TR 23.793 [4] and investigation
on whether enhancements are needed;
\- Study on how to support CPE/RG capable of connecting simultaneously via
both NG RAN and wireline access to 5GC.
NOTE 2: The above scenario is referred as Hybrid Access in Broadband Forum
(BBF TR-348 [5]).
\- Definition of architecture for the Trusted N3GPP scenario applicable not
only to wireline accesses.
\- **Support of** Trusted access networks**:**
\- Requirements for the Trusted Non-3GPP access in 5G system;
\- Architecture definition for the Trusted Non-3GPP access in 5G System;
\- Investigation on whether enhancements are needed to interfaces (e.g. N1, N2
and N3) used to connect the trusted non-3GPP access network to converged 5GC;
\- study the impact of the common framework for authentication and security,
policy and QoS, Network Slicing and investigation on whether enhancements are
needed.
NOTE 3: The study will consider whether \"Trusted\" terminology or a different
terminology would be more suitable for representing the scenario where there
is a more tight relationship compared to Untrusted case between the WLAN
Access Network and the 5GC.
This study will follow the high level principles, agreements, and conclusions
of the normative work agreed in TS 22.261 [7], TS 23.501 [1] and TS 23.502
[2].
The study will take into account information provided by the BBF on wireless
and wireline convergence.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[3] 3GPP TS 23.502: \"Procedures for the 5G system, Stage 2\".
[4] 3GPP TR 23.793: \"Study on Access Traffic Steering, Switch and Splitting
support in the 5G system architecture\".
[5] BBF TR-348: \"Hybrid Access Broadband Network Architecture\".
[6] 3GPP TR 23.799: \"Study on Architecture for Next Generation System\".
[7] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets; Stage 1\".
[8] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System\".
[9] BBF TR-124 issue 5: \"Functional Requirements for Broadband Residential
Gateway Devices\".
[10] BBF TR-101 issue 2: \"Migration to Ethernet-Based Broadband
Aggregation\".
[11] BBF TR-178 issue 1: \"Multi-service Broadband Network Architecture and
Nodal Requirements\".
[12] BBF TR-069: \"CPE WAN\" Management Protocol.
[13] CableLabs DOCSIS MULPI: \"Data-Over-Cable Service Interface
Specifications DOCSIS 3.1, MAC and Upper Layer Protocols Interface
Specification\".
[14] IETF RFC 3046: \"DHCP Relay Agent Information Option\".
[15] IETF RFC 3376: \"Internet Group Management Protocol, Version 3\".
[16] IETF RFC 3810: \"Multicast Listener Discovery Version 2 (MLDv2) for
IPv6\".
[17] IETF RFC 2131: \"Dynamic Host Configuration Protocol\".
[18] IETF RFC 3633: \"IPv6 Prefix Options for Dynamic Host Configuration
Protocol (DHCP), version 6\".
[19] IETF RFC 3315: \"Dynamic Host Configuration Protocol for IPv6 (DHCPv6\".
[20] IETF RFC 5175: \"IPv6 Router Advertisement Flags Option\".
[21] 3GPP TS 23.003: \"Numbering, addressing and identification\".
[22] IETF RFC 6347: \"Datagram Transport Layer Security, Version 1.2\".
[23] 3GPP TS 33.402: \"3GPP System Architecture Evolution (SAE); Security
aspects of non-3GPP accesses\".
[24] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[25] 3GPP TS 33.501: \"Security architecture and procedures for 5G System\".
[26] BBF SD-420: \"5G Fixed Mobile Convergence Study (External) \".
[27] IEEE Std 802.11-2016 (Revision of IEEE Std 802.11-2012) - IEEE Standard
for Information technology---Telecommunications and information exchange
between systems Local and metropolitan area networks---Specific requirements -
Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY)
Specifications.
[28] IETF RFC 6696: \"EAP Extensions for the EAP Re-authentication Protocol
(ERP)\", July 2012.
[29] IETF RFC 5295: \"Specification for the Derivation of Root Keys from an
Extended Master Session Key (EMSK)\", Aug. 2008.
[30] IETF RFC 2865: \"Remote Authentication Dial In User Service (RADIUS)\".
[31] IETF RFC 3162: \"RADIUS and IPv6\".
[32] 3GPP TR 26.891: \"5G enhanced mobile broadband; Media distribution\".
[33] IEEE 802.1x: \"Port-Based Network Access Control\".
[34] IETF RFC 5191: \"Protocol for Carrying Authentication for Network Access
(PANA)\".
[35] IETF RFC 5448: \"Improved Extensible Authentication Protocol Method for
3rd Generation Authentication and Key Agreement (EAP-AKA\')\".
[36] IEEE 802.11i: \"IEEE 802.11i-2004: Amendment 6: Medium Access Control
(MAC) Security Enhancement\".
[37] ETSI TS 102 542‑1 V2.1.1: \"Digital Video Broadcasting (DVB); Guidelines
for the implementation of DVB-IPTV Phase 1 specifications; Part 1: Core IPTV
Functions\".
[38] IETF RFC 4604: \"Using Internet Group Management Protocol Version 3
(IGMPv3) and Multicast Listener Discovery Protocol Version 2 (MLDv2) for
Source-Specific Multicast\".
[39] 3GPP TS 32.240: \"Charging management; Charging architecture and
principles\".
[40] IETF RFC 4601: \"Protocol Independent Multicast - Sparse Mode (PIM-SM):
Protocol Specification\".
[41] IETF RFC 3973: \"Protocol Independent Multicast - Dense Mode (PIM-DM):
Protocol Specification (Revised)\".
[42] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[43] 3GPP TS 23.402: \"Architecture enhancements for non-3GPP accesses\".
[44] 3GPP TS 24.007: \"Mobile radio interface signalling layer 3; General
aspects\".
[45] IETF RFC 5216: \"The EAP-TLS Authentication Protocol\".
[46] IETF RFC 5281: \"Extensible Authentication Protocol Tunneled Transport
Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)\".
[47] IETF RFC 6221: \"Lightweight DHCPv6 Relay Agent\".
[48] BBF TR 369: \"User Services Platform (USP)\".
[49] BBF TR-181: \"Device Data Model for TR-069\".
[50] BBF TR-177: Corrigendum 1 (Nov 17): \"IPv6 in the context of TR-101\".
[51] IETF RFC 6788: \"The Line-Identification Option\".
[52] IETF RFC 2236: \"Internet Group Management Protocol, Version 2\".
[53] IETF RFC 7761: \"Protocol Independent Multicast - Sparse Mode (PIM-SM)\".
[54] 3GPP TS 24.302: \"Access to the 3GPP Evolved Packet Core (EPC) via
non-3GPP access networks; Stage 3\".
[55] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
nodes\".
[56] 3GPP TS 23.002: \"Network architecture\".
[57] IETF RFC 6603: \"Prefix Exclude Option for DHCPv6-based Prefix
Delegation\".
[58] IETF RFC 7296: \"Internet Key Exchange Protocol Version 2 (IKEv2)\".
[59] IETF RFC 2410: \"The NULL Encryption Algorithm and Its Use With IPsec\".
[60] IETF RFC 2401: \"Security Architecture for the Internet Protocol\".
[61] IETF RFC 4555: \"IKEv2 Mobility and Multihoming Protocol (MOBIKE)\".
[62] IETF RFC 3748: \"Extensible Authentication Protocol (EAP)\".
[63] IETF RFC 4187: \"Extensible Authentication Protocol Method for 3rd
Generation Authentication and Key Agreement (EAP-AKA)\".
# 3 Definitions, symbols and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
The definitions in TS 23.501 [2], TS 23.502 [3] and TS 23.503 [8] are
applicable unless differently defined in the following:
\- **5G-RG** : A 5G-RG is a RG capable of connecting to 5GC playing the role
of a UE with regard to the 5G core. It supports secure element and exchanges
N1 signalling with 5GC.
\- **5G-CRG** : A 5G-CRG is a cable residential gateway capable of connecting
to 5GC playing the role of a UE with regard to the 5G core. It supports secure
elements and exchanges N1 signalling with 5GC. . The 5G-CRG is a RG specified
by CableLabs DOCSIS MULPI [13].
\- **Cable Fixed Access Gateway Function** (CFAGF): A Network function in
W-5GCAN that provides connectivity to the 5G Core of 5G-CRG.
\- **DOCSIS** **Wireline Access Network** : An access network that conforms to
CableLabs DOCSIS MULPI [13].
\- **RG** : The RG is a device capable of providing voice, data, broadcast
video, video on demand, specified by BBF.
\- **FN-RG** : A Fixed Network RG (FN-RG) is a RG playing a role similar of a
UE with regard to the 5G core. It does not support N1 signalling. The FN-RG is
a RG specified by BBF TR-124 [9].
\- **FN-CRG** : A fixed Network cable RG (FN-CRG) is a cable RG playing the
role similar of a UE with regard to the 5G core. It does not support N1
signalling. The FN-CRG is a RG with cable modem specified by CableLabs DOCSIS
MULPI [13].
\- **Fixed Access Gateway Function** (FAGF): A Network function in W-5GAN that
provides connectivity to the 5G Core of 5G-RG.
\- **Hybrid Access 5G-RG** : it is 5G-RG capable of connecting simultaneously
via both 5G RAN and wireline access network to 5GC.
\- **Hybrid Access 5G-CRG** : it is 5G-CRG capable of connecting
simultaneously via both 5G RAN and wireline access network to 5GC.
\- **Wireline 5G Access Network** : The Wireline 5G Access Network (W-5GAN) is
a wireline AN that connects to a 5GC via N2 and N3 reference points.
\- **Wireline 5G Cable Access Network** : The Wireline 5G Cable Access Network
(W-5GCAN) is a DOCSIS Wireline Access Network that connects to a 5GC via N2
and N3 reference points.
\- **Wireline Access Network** : An access network (optical or electrical)
which is conform to BBF TR-101 [10] or BBF TR-178 [11].
\- **Non-3GPP Access Network** : In the context of this TR a Non-3GPP Access
Network is an access network that is not defined by 3GPP including for example
the Wireline 5G Access Network.
Editor\'s note: The definition of Trusted Non-3GPP is FFS.
## 3.2 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1], TS 23.501 [2] and the following apply. An abbreviation defined in the
present document takes precedence over the definition of the same
abbreviation, if any, in TR 21.905 [1].
5G-RG 5G Residential Gateway
5G-CRG 5G Cable Residential Gateway
CFAGF Cable Fixed Access Gateway Functi
W-5GAN Wireline 5G Access Network
W-5GCAN Wireline 5G Cable Access Network
BBF Broadband Forum
CPE Customer Premises Equipment
FAGF Fixed Access Gateway Function
FN-RG Fixed Network RG
FN-CRG Fixed Network Cable RG
HA Hybrid Access
HFC Hybrid Fiber-Coax
RG Residential Gateway
TMBR Total Maximum Bit Rate
# 4 Architecture Requirements, Assumptions and principles
## 4.1 Common Architecture Requirements, Assumptions and principles
### 4.1.1 High level Architectural Requirements
Editor\'s note: This clause will document high-level architectural
requirements (new or revised) of the 5GS common to WWC and Trusted N3GPP.
Editor\'s note: The requirements related to wireline network will be verified
with BBF and this clause may capture the requirement or refer to BBF
documentation.
### 4.1.2 Architectural Principles
Editor\'s note: This clause will document the identified architecture
principles.
## 4.2 Wireless and Wireline Convergence
### 4.2.1 High level Architectural Requirements
Editor\'s note: This clause will document high-level architectural
requirements (new or revised) of the 5GS for supporting WWC. This clause may
document requirement for the wireline access network defined by BBF, if
needed.
Editor\'s note: The requirements related to wireline network will be verified
with BBF and this clause may capture the requirement or refer to BBF
documentation.
In order to support wireless and wireline convergence the architecture of the
5GC network shall support the additional requirements listed in the following:
1 Support the connection of a 5G-RG via NG-RAN or via W-5GAN to a 5GC, or a
FN-RG via Wireline AN to 5GC. Both the Residential Gateway supporting N1
interface and the Residential Gateway not supporting N1 interface may be
studied.
2 Support end user devices, with or without UICC, connected to the convergent
5G CN from behind a 5G-RG or FN-RG.
3 Support the Hybrid access scenario where the 5G-RG is connecting
simultaneously via both NG RAN and Wireline AN to 5GC. The system shall
support the scenario where the 5G-RG/FN-RG is connected only via a single
access either NG-RAN or Wireline AN and the scenario when the 5G-RG/FN-RG is
simultaneously connected via both accesses. In the latter case the traffic may
be split or switched between the two accesses.
4 Based on the operator policy and inter-operator agreement, support the
capability to enable 5GC to identify a 3GPP UE (i.e. UE with 3GPP credentials)
accessing the network behind any type of gateway (i.e. 5G-RG/5G-CRG and FN-
RG/FN-CRG) to the extent possible (i.e, identifying the UEs behind a local NAT
may not be possible).
Editor\'s note: The Identities provided/available for non-3GPP managed devices
behind a 5G-RG/5G-CRG are FFS.
### 4.2.2 Architectural Principles
NOTE 1: The interworking scenario where FN-RG, which is not capable to support
5GC feature, connects to 5GC will be studied after having received input from
BBF.
NOTE 2: Scenario 3 and scenario 5 cover only those 3GPP UEs that support N1.
3GPP UEs that do not support N1 (e.g. pre-5G UEs) are not addressed.
Editor\'s note: Whether the scenarios will be extended to cover non-N1 capable
3GPP UEs is FFS.
Editor\'s note: Additional scenarios where a 3GPP UE that is not 5GC capable
is a device behind the RG, are for further study.
#### 4.2.2.1 Scenario 1
The following architectural principles apply for a 5G-RG (N1 capable RGs):
1\. 5G-RG shall use 3GPP procedures and impact on 3GPP reference points shall
be minimized.
2\. 5G-RG shall behave as an 3GPP UE towards the 5GC. Not all 3GPP procedures
might be applicable for a 5G-RG and the 5G-RG will also need to support BBF
specific functionality.
3\. The Hybrid Access 5G-RG can be registered and have PDU Sessions with
active user planes via multiple accesses at the same time (i.e. via W-5GANand
NG RAN access) as depicted in figure 4.2.2.1-2. When using Hybrid Access, the
following additional requirements apply:
a. The 5G-RG may operate as an ATSSS-capable UE, applying the ATSSS procedures
defined in TR 23.793 [4] for traffic steering across NG-RAN and W-5GAN.
b. The ATSSS functions for the 5G-RG shall be applied independently of ATSSS
functions that may be used by a 5GC UE behind the 5G-RG, as defined in
scenario 3.
4\. A W-5GAN interface the 5GC using the 3GPP reference points N2 and N3 as
depicted in figure 4.2.2.1-1. The interface(s) between 5G-RG and the W-5GAN
are not specified by 3GPP but these requirements apply:
a. The interface shall support transport of N1 messages between 5G-RG and the
W-5GAN. The W-5GAN shall relay the N1 messages un-changed between 5G-RG and
5GC.
b. The interface shall support transport of AS-level parameters (e.g.,
5G-GUTI, S-NSSAI).
c. For user plane multiple PDU sessions shall be supported.
d. QoS flows should be supported.
e. Support for transport of QFI and RQI parameters shall be supported for each
user plane data packet.
Figure 4.2.2.1-1: High level architecture for the 5G-RG case connected via
W-5GAN
Figure 4.2.2.1-2: High level architecture for the Hybrid Access 5G-RG case
connected via NG RAN and W‑5GAN
5 The 5G-RG is connected to 5GC via NG RAN using the 3GPP reference points N2
and N3 as depicted in figure 4.2.2.1-3. These requirements apply:
a. The 5G-RG supports the NG RAN and the impact on NG RAN shall be minimized.
Figure 4.2.2.1-3: High level architecture for the 5G-RG case connected via NG
RAN
#### 4.2.2.2 Scenario 2
The following architectural principles apply for a FN-RG (not N1 capable
CPEs/RGs):
1\. FN-RG does not support any 3GPP procedure.
NOTE: The scenario of FN-RG connected to 5GC via NG RAN and the Hybrid Access
scenario (i.e. connected via W-5GAN and NG RAN) are not applicable.
2\. The impact on 3GPP reference points shall be minimized.
3\. The W-5GAN shall support an interworking function that enables FN-RG to be
connected to 5GC.
4\. The Interworking function interfaces the 5GC using the 3GPP reference
points N1, N2 and N3 as depicted in figure 4.2.2.2-1.
Figure 4.2.2.2-1: High level architecture for the FN-RG case
#### 4.2.2.3 Scenario 3
In addition to scenario 1, the following architectural principles apply for a
5GC capable UE behind a 5G-RG:
1\. 5GC capable UE shall use 3GPP procedures and impact on 3GPP reference
points shall be minimized.
2\. 5G-RG shall enable the N1 signalling between the 5GC capable UE and the
5GC capable UE\'s AMF/SMF.
3\. 5G-RG shall enable the UP transport between the 5GC capable UE and the 5GC
capable UE\'s UPF.
4\. 5G-RG and 5GC shall enable the 5GC capable UE to exchange traffic with the
other devices on the Home LAN network without that traffic having to consume
user plane resources from the W-5GAN.
5a. For communication with \"the 5G-RG playing the role of a 3GPP UE\", the
W-5GAN interfaces to the 5GC using the 3GPP reference points N2 and N3 as
depicted in figure 4.2.2.3-1. For the interface(s) between 5G-RG and the
W-5GAN the followingprinciples apply:
a The interface shall support transport of N1 messages between 5G-RG and the
W-5GAN. The W-5GAN shall relay the N1 messages un-changed between 5G-RG and
5GC.
b. The interface shall support transport of AS-level parameters (e.g.,
5G-GUTI/5G-S-TMSI, S-NSSAI).
c. For user plane multiple PDU sessions shall be supported.
d. QoS flows should be supported.
e. Support for transport of QFI and RQI parameters shall be supported for each
user plane data packet.
5b. The communication between the \"5GC capable UE behind the 5G-RG\" and the
5GC is solution specific.
6\. 5GC shall be able to support the functionality for user-plane treatment in
the UPF defined in TS 23.501 [2] clause 6.2.3 also for a 5GC capable UE behind
a 5G-RG. This includes being the anchor point for the PDU session of the 5GC
capable UE when moving between 5G-RG and 3GPP access.
7\. W-5GAN shall be enabled to support QoS treatment of QoS flows for a 5GC
capable UE using 5G-RG access. This implies that the W-5GAN needs to
simultaneously manage QoS resources for PDU Session of the 5G-RG as well as
PDU Session of 5GC capable UEs connecting via the 5G-RG.
Figure 4.2.2.3-1: High level architecture for the 5GC capable UE behind a
5G-RG with 5G-RGconnected via W-5GAN
NOTE 1: The reference points N2 and N3 might be impacted on protocol level.
8\. The 5GC capable UE can be registered and have PDU Sessions with active
user planes via multiple accesses at the same time (i.e. via 5G-RG and NG RAN)
as depicted in figure 4.2.2.3-2. These requirements apply:
A 5GC and 5GC capable UE shall be able to support ATSSS functions between 3GPP
access and 5G-RG access.
Figure 4.2.2.3-2: High level architecture for the Hybrid access 5GC capable UE
connected via NG RAN and 5G-RG
NOTE 2: The 5G-RG can also in this scenario use multiple accesses (i.e., NG-
RAN and W-5GAN).
9\. The 5G-RG is connected to 5GC via NG RAN using the 3GPP reference points
N2 and N3 as depicted in figure 4.2.2.3-3.
10\. The Hybrid Access 5G-RG can be registered and have PDU Sessions with
active user planes via multiple accesses at the same time (i.e. via W-5GAN and
NG RAN) as depicted in figure 4.2.2.3-4.
Figure 4.2.2.3-3: High level architecture for the 5GC capable UE behind a
5G-RG with 5G-RGconnected via NG RAN
Figure 4.2.2.3-4: High level architecture for the 5GC capable UE behind an
Hybrid Access 5G-RG case connected via NG RAN and W-5GAN
11\. The 5GC shall be able to authenticate and authorize the 5GC capable UE
behind the 5G-RG/HA 5G-RG.
12\. The 5G-RG/HA 5G-RG can only provide service for the 5GC capable UE when
the 5G-RG/HA 5G-RG is in th RM-REGISTERED state.
13\. It shall be possible to offer different services to different categories
of devices, for example for 5GC capable UE considered as host or guest of the
local network of 5G-RG/HA 5G-RG , such as different QoS control, permission to
use certain resources e.g. printer in LAN or being allowed to get Internet
access.
Editor\'s note: How the 5GC capable UE shall be consider as a host or guest is
left to the description of solutions.
#### 4.2.2.4 Scenario 4
In addition to scenario 1, the following architectural principles apply for a
Non-3GPP device behind a 5G-RG:
Editor\'s note: In the following it is assumed that a Non-3GPP device, e.g. a
PC, tablet , does not support USIM. The exact definition will be an outcome of
the study.
1\. A non-5GC capable device may be a 3GPP UE that supports EPC, or a non-3GPP
device that supports neither USIM nor 3GPP signalling. These devices are
similar in that they do not support 5GC related procedures.
Editor\'s note: It is FFS whether distinguishing between 3GPP (but not 5GC
capable) UE and non-3GPP UE is relevant for this TR.
2\. A W-5GAN interface the 5GC using the 3GPP reference points N2 and N3 as
depicted in figure 4.2.2.4-1. For the interface(s) between 5G-RG and the
W-5GAN the same principles defined for scenario 1 bullet 4 apply.
3\. The 5G-RG is connected to 5GC via NG RAN using the 3GPP reference points
N2 and N3 as depicted in figure 4.2.2.4-2.
4\. The Hybrid Access 5G-RG can be registered and have PDU Sessions with
active user planes via multiple accesses at the same time (i.e. via W-5GAN and
NG RAN) as depicted in figure 4.2.2.4-3.
5\. The network providing service(s) to a Non-5GC capable device behind a
5G-RG is aware of the identity of the 5G-RG requesting services based on
information provided during the registration request.
Figure 4.2.2.4-1: High level architecture for the Non-5GC capable device
behind a 5G-RG case connected via W-5GAN
Figure 4.2.2.4-2: High level architecture for the Non-5GC capable device
behind a 5G-RG case connected via NG RAN
Figure 4.2.2.4-3: High level architecture for the Non-5GC capable device
behind an Hybrid Access 5G-RG case connected via NG RAN and W-5GAN
#### 4.2.2.5 Scenario 5
In addition to scenario 2, the following architectural principles apply for a
5GC capable UE behind a FN-RG:
1\. 5GC capable UE shall use 3GPP procedures and impact on 3GPP reference
points shall be minimized.
2 FN-RG does not support any 3GPP procedure.
NOTE 1: The scenario of FN-RG connected to 5GC via NG RAN and the Hybrid
Access scenarios (i.e. connected via W-5GAN and NG RAN) are not applicable.
3\. FN-RG shall transparently enable direct N1 signalling between the 3GPP UE
and AMF/SMF.
4\. FN-RG shall transparently enable direct UP transport between the 3GPP UE
and UPF.
5\. FN-RG and 5GC shall enable the 5GC capable UE to exchange traffic with the
other devices on the Home LAN network.
6\. For the interfaces between the W-5GAN and the 5GC the same principles
defined for scenario 2 bullet 3 and bullet 4 apply.
7\. 5GC shall be able to support the functionality for user-plane treatment in
the UPF defined in TS 23.501 [2] clause 6.2.3 also for a 3GPP UE behind a FN-
RG. This includes being the anchor point for the PDU session of the 3GPP UE
when moving between FN-RG and 3GPP access.
8\. W-5GAN may be enabled to support QoS treatment of QoS flows for a 3GPP UE
using FN-RG access. This implies that the W-5GAN may need to simultaneously
manage QoS resources for PDU Session of the FN-RG as well as PDU Session of
3GPP UEs connecting via the FN-RG.
Figure 4.2.2.5-1: High level architecture for the 5GC Capable UE behind a FN-
RG case
NOTE 2: The reference points N2 and N3 might be impacted on protocol level.
9\. The 5GC capable UE can be registered and have PDU Sessions with active
user planes via multiple accesses at the same time (i.e. via FN-RG and NG RAN)
as depicted in figure 4.2.2.5-2. These requirements apply:
a. 5GC and 5GC capable UE shall be able to support ATSSS functions between
3GPP access and FN-RG access.
Figure 4.2.2.5-2: High level architecture for the Hybrid access 5GC capable UE
connected via NG RAN and FN-RG
#### 4.2.2.6 Scenario 6
In addition to scenario 2, the following architectural principles applies for
a Non-5GC capable device behind a FN-RG:
Editor\'s note: In the following it is assumed that a Non-3GPP device, e.g. a
PC, tablet, does not support USIM. The exact definition will be an outcome of
the study.
1\. A non-5GC capable device may be a 3GPP UE that supports EPC, or a non-3GPP
device that supports neither USIM nor 3GPP signalling and consequently does
not support 3GPP procedures.
2\. FN-RG does not support any 3GPP procedure.
NOTE 1: The scenario of FN-RG connected to 5GC via NG RAN and the Hybrid
Access scenarios (i.e. connected via W-5GAN and NG RAN) are not applicable.
3\. The network providing service(s) to a Non-5GC capable device behind an FN-
RG is aware of the identity of the subscription information of the FN-RG
requesting services based on information provided during the registration
request.
Figure 4.2.2.6-1: High level architecture for the Non-5GC Capable device
behind a FN-RG
#### 4.2.2.7 Scenario 7
The following architectural principles apply for a 5G-CRG.
Similar to scenario 1, the following architectural principles apply for a
5G-CRG:
\- A W-5GCAN interface the 5GC using the 3GPP reference points N2 and N3 as
depicted in figure 4.2.2.7-1. The interface(s) between 5G-CRG and the W-5GCAN
are not specified by 3GPP.
\- The Hybrid Access 5G-CRG can be registered and have PDU Sessions with
active user planes via one or multiple accesses at the same time, i.e., via
W-5GCAN and/or NG RAN, as depicted in figure 4.2.2.7-2.
Figure 4.2.2.7-1: High level architecture for the 5G-CRG case with N1, N2, and
N3 interfaces
{width="2.9006944444444445in" height="2.3229166666666665in"}
Figure 4.2.2.7-2: High level architecture for the Hybrid Access 5G-CRG case
connected via NG RAN and W-5GCAN
#### 4.2.2.8 Scenario 8
In addition to scenario 7, the following architectural principles apply for a
3GPP UE behind a 5G-CRG:
1\. 3GPP UE shall use 3GPP procedures and impact on 3GPP reference points
shall be minimized.
2\. 5G-CRG shall enable the N1 signalling between the 3GPP UE and AMF/SMF.
3\. 5G-CRG shall enable the UP transport between the 3GPP UE and UPF.
4\. 5G-CRG and 5GC should enable the 3GPP UE to exchange traffic with the
other devices on the Home LAN network.
5\. A W-5GCAN interfaces the 5GC using the reference points N2 and N3 as
depicted in figure 4.2.2.8-1. For the interface(s) between 5G-CRG and the
W-5GCAN the same principles defined for scenario 7 bullet 1 apply.
Figure 4.2.2.8-1: High level architecture for the 3GPP UE behind a 5G-CRG case
with N1, N2, and N3 interfaces
The 5G capable UE can be registered and have PDU Sessions with active user
planes via one or multiple accesses at the same time, i.e., via 5G-CRG and/or
NG RAN, as depicted in figure 4.2.2.8-2.
{width="3.9791666666666665in" height="2.470138888888889in"}
Figure 4.2.2.8-2: High level architecture for the Hybrid access 5GC capable UE
connected via NG RAN and 5G-CRG
The Hybrid Access 5G-CRG can be registered and have PDU Sessions with active
user planes via one or multiple accesses at the same time, i.e., via W-5GCAN
and/or NG RAN, as depicted in figure 4.2.2.8-3.
{width="3.9722222222222223in" height="2.275in"}
Figure 4.2.2.8-3: High level architecture for the 5GC capable UE behind an
Hybrid Access 5G-CRG case connected via NG RAN and W-5GCAN
#### 4.2.2.9 Scenario 9
The following architectural principles apply for a FN-CRG (not N1 capable
CPEs/CRGs):
1\. FN-CRG does not support any 3GPP procedure.
NOTE: The scenario of FN-CRG connected to 5GC via NG RAN and the Hybrid Access
scenario (i.e. connected via W-5GAN and NG RAN) are not applicable.
2\. The impact on 3GPP reference points shall be minimized.
3\. The W-5GCAN shall support an interworking function that enables FN-CRG to
be connected to 5GC.
4\. The Interworking function interfaces the 5GC using the 3GPP reference
points N1, N2 and N3 as depicted in figure 4.2.2.9-1.
Figure 4.2.2.9-1: High level architecture for the FN-CRG case
#### 4.2.2.10 Scenario 10
In addition to scenario 9, the following architectural principles apply for a
5GC capable UE behind a FN-CRG:
1\. 5GC capable UE shall use 3GPP procedures and impact on 3GPP reference
points shall be minimized.
2\. FN-CRG does not support any 3GPP procedure.
NOTE 1: The scenario of FN-CRG connected to 5GC via NG RAN and the Hybrid
Access scenarios (i.e. connected via W-5GCAN and NG RAN) are not applicable.
3\. FN-CRG shall transparently enable direct N1 signalling between the 3GPP UE
and AMF/SMF.
4\. FN-CRG shall transparently enable direct UP transport between the 3GPP UE
and UPF.
5\. FN-CRG and 5GC shall enable the 5GC capable UE to exchange traffic with
the other devices on the Home LAN network.
6\. For the interfaces between the W-5GCAN and the 5GC the same principles
defined for scenario 9 bullet 3 and bullet 4 apply.
7\. 5GC shall be able to support the functionality for user-plane treatment in
the UPF defined in TS 23.501 [2] clause 6.2.3 also for a 3GPP UE behind a FN-
CRG. This includes being the anchor point for the PDU session of the 3GPP UE
when moving between FN-CRG and 3GPP access.
8\. W-5GCAN may be enabled to support QoS treatment of QoS flows for a 3GPP UE
using FN-CRG access. This implies that the W-5GCAN may need to simultaneously
manage QoS resources for PDU Session of the FN-CRG as well as PDU Session of
3GPP UEs connecting via the FN-CRG.
Figure 4.2.2.10-1: High level architecture for the 5GC Capable UE behind a FN-
CRG case
NOTE 2: The reference points N2 and N3 might be impacted on protocol level.
9\. The 5GC capable UE can be registered and have PDU Sessions with active
user planes via multiple accesses at the same time (i.e. via FN-CRG and NG
RAN) as depicted in figure 4.2.2.10-2. These requirements apply:
a. 5GC and 5GC capable UE shall be able to support ATSSS functions between
3GPP access and FN-CRG access.
Figure 4.2.2.10-2: High level architecture for the Hybrid access 5GC capable
UE connected via NG RAN and FN-CRG
#### 4.2.2.11 Scenario 11
In addition to scenario 11, the following architectural principles applies for
a Non-5GC capable device behind a FN-CRG:
Editor\'s note: In the following it is assumed that a Non-3GPP device, e.g. a
PC, tablet, does not support USIM. The exact definition will be an outcome of
the study.
1\. A non-5GC capable device may be a 3GPP UE that supports EPC, or a non-3GPP
device that supports neither USIM nor 3GPP signalling and consequently does
not support 3GPP procedures.
2\. FN-CRG does not support any 3GPP procedure.
NOTE 1: The scenario of FN-CRG connected to 5GC via NG RAN and the Hybrid
Access scenarios (i.e. connected via W-5GCAN and NG RAN) are not applicable.
3\. The network providing service(s) to a Non-5GC capable device behind an FN-
CRG is aware of the identity of the subscription information of the FN-CRG
requesting services based on information provided during the registration
request.
Figure 4.2.2.11-1: High level architecture for the Non-5GC Capable device
behind a FN-CRG
#### 4.2.2.12 Scenario 12
In addition to scenario 7, the following architectural principles apply for a
Non-3GPP device behind a 5G-CRG:
Editor\'s note: In the following it is assumed that a Non-3GPP device, e.g. a
PC, tablet , does not support USIM. The exact definition will be an outcome of
the study.
1\. A non-5GC capable device may be a 3GPP UE that supports EPC, or a non-3GPP
device that supports neither USIM nor 3GPP signalling. These devices are
similar in that they do not support 5GC related procedures.
Editor\'s note: It is FFS whether distinguishing between 3GPP (but not 5GC
capable) UE and non-3GPP UE is relevant for this TR.
2\. A W-5GCAN interface the 5GC using the 3GPP reference points N2 and N3 as
depicted in figure 4.2.2.12-1. For the interface(s) between 5G-CRG and the
W-5GCAN the same principles defined for scenario 7 bullet 1 apply.
3\. The Hybrid Access 5G-CRG can be registered and have PDU Sessions with
active user planes via one or multiple accesses at the same time, i.e. via
W-5CGAN and/or NG RAN, as depicted in figure 4.2.2.12-2.
{width="3.65625in" height="2.09375in"}
Figure 4.2.2.12-1: High level architecture for the Non-5GC capable device
behind a 5G-CRG case connected via W-5GCAN
{width="3.7895833333333333in" height="2.1743055555555557in"}
Figure 4.2.2.12-2: High level architecture for the Non-5GC capable device
behind an Hybrid Access 5G-CRG case connected via NG RAN and W-5GCAN
## 4.3 Trusted N3GPP network
Editor\'s note: This clause will document the requirement, assumption and
principle for the definition of architecture for the Trusted N3GPP scenario.
### 4.3.1 High level Architectural Requirements
Editor\'s note: This clause will document high-level architectural
requirements (new or revised) of the 5GS for the support of Trusted N3GPP
scenario.
### 4.3.2 Architectural Principles
Editor\'s note: This clause will document the identified architecture
principles during the study.
Trusted N3GPP access interfaces the 5G Core Network CP and UP functions via N2
and N3 reference point, respectively.
#### 4.3.2.1 Non-roaming Architecture for Trusted N3GPP Accesses
Figure 4.3.2.1-1: Non-roaming architecture for 5G Core Network with trusted
N3GPP access
NOTE: The reference architecture in figure 4.3.2.1-1 only shows the
architecture and the network functions directly connected to non-3GPP access.
# 5 Key Issues
## 5.1 Common Key Issue for Wireless and Wireline Convergence and Trusted
Editor\'s note: This clause will document the key issue common to wireless and
wireline convergence and to Trusted.
## 5.2 Key Issue for Wireless and Wireline Convergence
Editor\'s note: This clause will document the key issue related to wireless
and wireline convergence.
### 5.2.1 Key Issue #1: NAS support for 5WWC
The key issue is to study NAS support for wireline access. Two cases have been
identified:
a) 5G-RG and FN-RG connected to 5GC;
b) 3GPP UE connect to the 5GC via a 5G-RG/FN-RG.
For these 2 cases the KI will study:
\- how to transport the NAS between the UE/5G-RG/FN-RG and the AMF;
\- the impact on 5G-RG/FN-RG and wireline access for NAS support and
transport. this includes the requirements on wireline access;
\- the potential impact on NAS messages, if any;
\- what non-NAS information (e.g. GUTI) needs to be exchanged between the
5G-RG/FN-RG and 5GC.
### 5.2.2 Key issue #2: architecture for FN-RG that do not support NAS
This key issue is to study the architecture and functionalities needed to
enable FN-RG that do not support NAS to connect to 5GC. The study will be
based on BBF feedback on the required architecture.
It is assumed that no change is required on these FN-RG.
Impacts to the these FN-RG are expected to be as much as possible limited.
Impacts to the 5GC due to these FN-RG are expected to be limited.
### 5.2.3 Key Issue #3: Security
The authentication function is responsible for the authentication of the
identity (i.e. SUPI) that is presented to the network, when a UE requests to
receive service(s) from Wireless wireline convergence.
Two scenarios are considered in this key issue:
a) 5G-RG and FN-RG connect via wireline access or 5G-RG via NG RAN to the 5GC.
b) 3GPP UE connect to the 5GS via a 5G-RG/FN-RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
The solution for this key issue will study the following aspects:
\- Overall security architecture for Wireless wireline convergence based on
the unified authentication framework.
\- How authentication solution efficiently and adequately supports the
Wireless wireline convergence. In particular the key issue will study:
\- Whether and how existing wireline access network authentication solutions
(e.g. PPPoE,IEEE 802.1x [33], DHCP Option 82, etc.) may be considered.
\- Whether and how NAS based authentication apply to Wireless wireline
convergence.
NOTE: The solutions for this key issue will be developed in co-operation with
BBF for wireline access network security are involved and with SA WG3 for 3GPP
security are involved.
### 5.2.4 Key issue #4: SMF related subscription data
As the connectivity service provided by a BNG as currently defined by BBF
(possibly corresponding Wireline wholesaling, to the support of virtual RG, to
the management of multiple IP sessions beyond the IP session for the RG
itself) may be different from the DN connectivity service currently provided
by a SMF/UPF, both may need different subscription data. This key issue is,
for subscriptions corresponding to RG, to study whether and if yes how it is
needed to change the SMF subscription data sent over N10.
The KI considers both 5G-RG and FN-RG (as the DN connectivity services should
be the same in both cases).
Editor\'s note: For other aspects of subscription data, it is needed to
enlarge this KI or to create similar KI(s).
### 5.2.5 Key Issue #5: Mobility management
This key issue will identify the difference in Wireless wireline convergence
compared to the existing Mobility Management (MM) in 5G and propose Wireless
wireline convergence specific adaptions, as needed, for Mobility Management
(MM) framework.
Two scenarios are considered in this key issue:
1) 5G-RG and FN-RG connect via wireline access or 5G-RG connects via NG RAN to
the 5GC.
2) 3GPP UE connect to the 5GS behind a 5G-RG/FN-RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
For both scenario 1) and scenario 2), this key issue will study:
\- Applicability of Registration and Connection states in AMF and UE (i.e.
RM_REGISTERED/RM_DEREGISTERED and CM_IDLE/CM_CONNECTED) and how to transition
between the states;
\- Detection of UE no longer reachable;
\- Whether and how to support the existing Mobility Management feature
described in TS 23.501 [2] in Wireless wireline convergence;
\- Existing registration management, for example whether \"mobility
registration update\" applicable for Wireless wireline convergence;
\- Registration Area management described in TS 23.501 [2] clause 5.3.2.3.
For scenario 2), this key issue will further study:
\- RM/CM state:
\- The relationship of RM state between 3GPP UE and 5G-RG/FN-RG;
\- The relationship of CM state between 3GPP UE and 5G-RG/FN-RG;
\- Mobility support including;
\- 3GPP UE moves between 5G-RG/FN-RG;
\- 3GPP UE moves between 5G-RG/FN-RG and 3GPP access;
\- 3GPP UE moves between 5G-RG/FN-RG and non-3GPP access.
### 5.2.6 Key issue #6: UP transport
This key issue is to study how the User plane traffic can be carried between
the Customer Premises and the UPF;
Following cases will be considered:
1) Traffic for a 5G-RG that supports NAS;
2) Traffic for a FN-RG that does not support NAS;
3) Traffic from UE reaching the 5GC via a 5G-RG/FN-RG.
### 5.2.7 Key Issue #7: Policy
This key issue will identify the difference in Wireless wireline convergence
compared to the existing Policy in 5G and propose Wireless wireline
convergence specific adaptions as needed, for Policy framework.
The following scenarios are considered in this key issue:
1) 5G-RG and FN-RG connect via wireline access or 5G-RG connects via NG RAN to
the 5GC;
2) 3GPP UE connect to the 5GS via a 5G-RG/FN-RG.
3) 3GPP UE connect to the 5GS via a 5G-CRG/FN-CRG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
For all scenarios below this key issue will study:
\- Charging Policy for Wireless wireline convergence;
\- URSP for Wireless wireline convergence;
\- Whether and how to coordinate policies from ACS with UE policies sent by
the PCF to the 5G-RG/FN-RG acting as a 3GPP UE.
NOTE: BBF TR-069 [12] allows the Auto-Configuration Server (ACS) to provision
at the time of initial connection and to re-provision or re-configure at any
subsequent time the configuration of the RG. BBF TR-069 [12] allows for
example to provision parameters for voice services, enable Set-Top Box
configuration for IPTV, etc.
\- Whether and how to coordinate configuration policies from DOCSIS Wireline
Access Network with UE policies sent by the PCF to the 5G-CRG/FN-CRG.
Editor\'s note: It is TBD on which entity from within DOCSIS Wireline Access
Network is used for policy coordination with the policy from PCF
\- Whether a specific PDU session should be used for the management of
5G-RG/FN-RG based on BBF TR-069 [12].
\- Access Network Discovery and Selection Policy.
### 5.2.8 Key Issue #8: How to support QoS in 5WWC
Editor\'s note: This clause will document the key issue #1 related to wireless
and wireline convergence to be addressed.
The Key Issue is to study how the 3GPP QoS model can be used in wireline
access scenario. The following scenarios shall be investigated: 5G-RG/FN-RG as
UE and UE behind 5G-RG/FN-RG, as well as 5G-CRG/FN-CRG as UE and UE behind the
5G-CRG/FN-CRG. The study will consider:
1\. Study what QoS can be supported for wireline access given fixed and 3GPP
QoS model differ;
2\. Study how to transport the QFI and reflective QoS indication;
3\. Study how to map 3GPP QoS to non-3GPP QoS;
4\. Study how to interwork / prioritise between QoS policies applicable for an
5G-RG/FN-RG and a UE behind 5G-RG/FN-RG.
5\. Study how to interwork / prioritise between QoS policies applicable for an
5G-CRG and a UE behind the 5G-CRG/FN-CRG.
### 5.2.9 Key Issue #9: Support end user devices via 5G-RG/FN-RG for wireline
access network
The following aspects need to be studied to support end user devices via the
5G-RG/FN-RG as a 3GPP UE:
\- How to identify which end user devices (e.g., with or without 3GPP
credentials UICC) using a 5G-RG/FN-RG can be connected to the 5GC, what
information must be available for the 5GC about such devices, and for what
purpose (e.g. charging, LI, authentication). In addition, to study which
identifier is used to identify the end user devices using a 5G-RG/FN-RG.
\- How to identify, when needed, the traffic between 5G-RG/FN-RG and the 5GC
network for a specific UE behind the residential gateway (e.g. for charging,
lawful intercept).
### 5.2.10 Key Issue #10: Traffic management in Hybrid Access
The following aspects need to be studied to support Hybrid Access. Two cases
have been identified. That is 5G-RG as UE and UE behind 5G-RG.
1\. How the 5GC and the 5G-RG can support access traffic
steering/switching/splitting is under the Study of ATSSS SI.
2\. Study how to avoid excessive traffic flow transmitted over one access when
the other access is disconnected. Let assumed for example that the traffic is
transmitted is transmitted over wireline network. At one point in time the
wireline access network is no more available, hence the traffic flow may be
redirect over 3GPP access, but it may be avoided that all traffic flow is
transmitted in 3GPP access causing an excessive resource usage taking
appropriate actions such as terminating given traffic, modifying the QoS, etc.
NOTE: The Hybrid Access includes also the case where at a given point in time
only 1 access can be present, e.g. due to not available of an access due a
fault, coverage condition which make radio not available, wireline not yet
deployed, etc.
Editor\'s note: Hybrid Access is defined by BBF.
### 5.2.11 Key Issue #11: IPTV Service Support
This key issue will identify how to support IPTV Service transmission defined
in BBF TR-101 [10] clause 6 in Wireless wireline convergence. The key issue
will consider the support of both unicast (e.g. VoD) and broadcast (e.g.
linear TV, broadcast of event).
This key issue will consider only the scenario of 5G-RG and FN-RG connected
via wireline access or 5G-RG connected via NG RAN to the 5GC;
NOTE 1: the scenario of a 3GPP UE connected behind a 5G-RG and FN-RG is not
applicable since the IPTV services is intended to be terminated in the
5G-RG/FN-RG or in a separated Set-Top Box.
In this phase of the study, for the scenario of RG connected via NG RAN the
key issue will focus on the support of IPTV services not relying on the
support of multicast by NG RAN.
For the Multicast packets transmission, the aspect below should be studied:
\- How to develop the solutions based on the criteria of minimizing the
changes to 5G systems and IPTV application server.
\- Which network element should perform the packets replication to complete
the multicast transmission and how to do it.
\- Whether and how to perform the Session Management to support multicast
considering IGMP/MLD usage for IPTV service.
\- Whether and how to handle the IGMP/MLD (Multicast Listener Discovery, in
the case of IPv6) message in 5GS to support multicast transmission.
\- Whether and how to perform the multicast admission control in 5GC.
\- How to support the QoS mechanism for IPTV service.
### 5.2.12 Key Issue #12: Emergency Service support
This key issue will study whether changes to Emergency Service procedures
defined by 3GPP are required to support the defined scenarios.
Two scenarios are considered in this key issue:
1) 5G-RG and FN-RG connect via wireline access or 5G-RG connects via NG RAN to
the 5GC;
2) 3GPP UE connect to the 5GS via a 5G-RG/FN-RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
### 5.2.13 Key Issue #13: Mobile restriction and LADN support
This key issue will study which service restrictions based on UE location
currently defined in 3GPP (e.g. LADN) may apply in the context of BBF
interworking. In case they apply, the key issue will study whether changes to
TS 23.501 [2] and TS 23.502 [3] are required for supporting the defined
scenarios.
Two scenarios are considered in this key issue:
1) 5RG and RG connected to 5GC;
2) 3GPP UE connect to the 5GC via a 5RG/RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
### 5.2.14 Key Issue #14: Update Location Reporting
This key issue will study whether changes to Update Location Reporting defined
in TS 23.501 [2] and TS 23.502 [3] is required for supporting the define
scenarios. In addition the KI will study which information shall be reported
in case of wireline.
Two scenarios are considered in this key issue:
1) 5RG and RG connected to 5GC;
2) 3GPP UE connect to the 5GC via a 5RG/RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
### 5.2.15 Key Issue #15: Session Management support
This key issue will study how the PDU session type is applicable to the
defined scenarios.
Two scenarios are considered in this key issue:
1) 5RG and RG connected to 5GC;
2) 3GPP UE connect to the 5GC via a 5RG/RG.
Editor\'s note: The scenario of devices connected to 5G which are not 3GPP UE
(e.g. laptop, PC table not supporting N1 interface) is FFS.
### 5.2.16 Key Issue #16: User plane efficiency
The key issue is to study how the user plane packet handling can be optimised
for wireline access.
This key issue is relevant for Scenario1 (refer to clause 4.2.2.1), with 5G-RG
connected via W-5GAN or using hybrid access.
For this scenario, the KI will study:
\- How to optimise the user plane path and packet handling, e.g. for number of
hops, tunnelling requirements between UP nodes - if the 5G-RG or FN-RG
connects to the 5GC via FAGF.
\- How to optimise user plane path and packet handling for a 5G-RG using
hybrid access.
## 5.3 Key Issue for Trusted N3GPP
Editor\'s note: This clause will document the key issue related to Untrusted
N3GPP.
### 5.3.1 Key Issue #1: Registration and NAS transport for trusted non-3GPP
access
The following aspects need to be investigated to enable trusted non-3GPP
access to converged 5G Core Network:
\- the registration procedure of a UE through trusted non-3GPP access to the
5GC and study the impact this may have on the N1,N2 and N3 interfaces.
\- authentication procedures associated with the registration procedure for
trusted non-3GPP access as applicable in the scope of SA WG2.
### 5.3.2 Key Issue #2: QoS model and SM procedures for trusted non-3GPP
access
The following aspects need to be investigated to enable user plane over
trusted non-3GPP access to converged 5G Core Network:
\- study the 5G QoS model applicability for UE over trusted non-3GPP access.
\- study the session management procedures through trusted non-3GPP access to
the 5GC.
### 5.3.3 Key Issue #3: Access to 5GC from UEs that do not support NAS
The current assumption is that only UEs that support NAS are capable of
accessing the 5GC via trusted non-3GPP access. However, given that many
non-3GPP devices (e.g. WLAN-only devices), do not support NAS, this assumption
drastically limits the number of devices that can access the 5GC via trusted
non-3GPP access. This calls for 5G architectural extensions that would enable
UEs to establish 5GC connectivity via trusted non-3GPP access without using
NAS signalling. In EPS such capability is already supported: UEs can connect
to EPC via S2a (see SaMOG) without using NAS signalling.
This key issue will consider only how UEs, which do not support NAS, can
connect to 5GC via trusted WLAN access. It shall not consider wireline access
and, therefore, it shall not impact the RG and the W-5GAN.
Specifically, this key issue will study:
\- How the 5GS architecture can be extended to enable UEs with 3GPP
credentials (in USIM) but without NAS support to connect to 5GC via trusted
non-3GPP access; and
\- How the above capability can be provided by minimizing the impact to the
5GC network functions and interfaces.
# 6 Solutions for WWC
Editor\'s note: This clause will document the solution for the key issue for
WWC.
## 6.1 Solution #1 - General architecture for wireless and wireline
convergence
This solution provide the following architectures.
Editor\'s note: Whether these are architecture assumptions is FFS.
\- Figure 6.1-1 shows the architecture for 5GS with Wireline Access Network,
5G-RG and devices not supporting N1 connected behind 5G-RG.
\- Figure 6.1-2 shows the architecture for 5GS with Wireline Access Network,
5G-RG and 3GPP UE connected behind 5G-RG.
\- Figure 6.1-3 shows the architecture for 5GS with NG RAN, 5G-RG and devices
not supporting N1 connected behind 5G-RG.
\- Figure 6.1-4 shows the architecture for 5GS with NG RAN, 5G-RG and 3GPP UE
connected behind 5G-RG.
\- Figure 6.1-5 shows the architecture for 5GS supporting Hybrid Access and
devices not supporting N1 connected behind 5G-RG.
\- Figure 6.1-6 shows the architecture for 5GS supporting Hybrid Access and
3GPP UE connected behind 5G-RG.
In all figures within this clause, a 3GPP UE depicts a 3GPP UE supporting
access to 5GC.
In all figures describing an architecture where a 3GPP UE supporting access to
5GC is connected via RG the following applies: even though the figure depicts
a single AMF, SMF, UPF and PCF to serve the RG and the 3GPP UE, the
architecture shall support deployments where the AMF, SMF, UPF and PCF that
serve a RG can differ from those serving a 3GPP UE connected behind this RG.
Figure 6.1-7 gives terminology for the high level architecture for the 5GC
capable UE behind a 5G-RG.
Architectures that assume that a single AMF or SMF or UPF or PCF are used by
both RG and \"5GC capable UE behind the 5G-RG\" shall explain how that common
NF is selected.
Figure 6.1-1: Non-roaming architecture for 5GS with Wireline Access Network,
with 5G-RG and devices not supporting N1 connected behind 5G-RG
NOTE 1: The reference architecture in figure 6.1-1 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Figure 6.1-2: Non-roaming architecture for 5GS with Broadband Wireline access,
5G-RG and 3GPP UE connected behind 5G-RG
NOTE 2: The reference architecture in figure 6.1-2 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Figure 6.1-3: Non-roaming architecture for 5GS with NG RAN, 5G-RG and devices
not supporting N1 connected behind 5G-RG
NOTE 3: The reference architecture in figure 6.1-3 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Figure 6.1-4: Non-roaming architecture for 5GS with NG RAN, 5G-RG and 3GPP UE
connected behind 5G-RG
NOTE 4: The reference architecture in figure 6.1-4 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Figure 6.1-5: Non-roaming architecture for 5GS supporting Hybrid Access and
devices not supporting N1 connected behind 5G-RG
NOTE 5: The reference architecture in figure 6.1-5 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Figure 6.1-6: Non-roaming the architecture for 5GS supporting Hybrid Access
and 3GPP UE connected behind 5G-RG
NOTE 6: The reference architecture in figure 6.1-6 only shows the architecture
with SBI representation, but the reference point representation is under the
scope of the study and only not represented in the figure.
Editor\'s note: The definition of network element included in W-5GAN (e.g.
Optical termination, BNG, etc) and functionalities needs to be agreed with
BBF.
Editor\'s note: For all figure above whether the UPF is equivalent to the BNG
is FFS and needs to be verified with BBF.
Editor\'s note: For all figure above the roaming architecture is FFS.
The description of the reference points N2, N3, N4, N6 are defined in clause
4.2 of TS 23.501 [2].
Editor\'s note: For all figure above whether and how the reference points N1,
N2, N3, N4 and N6 require further improvements and changes is FFS.
Editor\'s note: How the 5G-RG and devices connected behind 5G-RG supporting N1
is FFS.
Figure 6.1-7: Terminology for discussing high level architecture for the 5GC
capable UE behind a 5G-RG
Figure 6.1-7, above shows different roles that AMF, SMF and UPF could take in
relation to handling mobility and PDU Sessions of 5G RG and 5G-Capable UE
behind the 5G RG. Solutions for scenarios with UE behind RG may or may not use
all roles described in the figure. Solutions should describe if, when and how
these roles are used.
## 6.2 Solution #2: 5G-RG Registration to 5GC
### 6.2.1 General
This solution specifies how the 5G-RG can register to 5GC in case the EAP
protocol is used to transport NAS messages between the 5G-RG and the
Wireline-5G Access Network (W-5GAN).
Editor\'s note: The protocol between the 5G-RG and W-5GAN will be decided by
BBF.
It is assumed that the W-5GAN is composed of two functional elements:
(i) one or more Wireline Access Node functions; and
(ii) a Fixed Access Gateway Function (FAGF) which exposes the N2/N3 interfaces
towards the 5GC.
The 5G-AGF may be split into CP-plane and UP-plane functions but this is not
further considered in this clause.
{width="6.059722222222222in" height="1.3576388888888888in"}
Figure 6.2.1-1: Considered reference architecture
### 6.2.2 5G-RG Registration Procedure
The signalling flow shown in the figure below illustrates how a 5G-RG can
register with the 5GC via a W-5GAN. This procedure aligns well with the
registration procedure via untrusted non-3GPP access, as specified in _TS
23.502 [3]_ , clause 4.12.2.2.
Figure 6.2.2-1: Signalling flow for 5G-RG registration to 5G core
1\. A layer-2 (L2) connection is established between the 5G-RG and the 5G-AGF.
This L2 connection could, for example, be established with PPP/PPPoE
procedures. The details of this step are outside the scope of 3GPP.
2-10. An EAP-5G procedure is executed between the 5G-RG and the 5G-AGF,
similar to the procedure specified in TS 23.4502, clause 4.12.2.2, for the
untrusted non-3GPP access. However, in this case, the following differences
exist:
\- The EAP-5G packets are transferred over the L2 connection (e.g. PPP)
established between the 5G-RG and the F-AGF in step 1 (not over IKEv2).
\- The RAT Type provided to AMF in step 5 indicates \"Wireline 5G\" (not
untrusted non-3GPP).
\- An AGF key (instead of an N3IWF key) is created in the 5G-RG and in the AMF
after the successful authentication. The AGF key is transferred from the AMF
to AGF in step 10a within the N2 Initial Context Setup Request. After the
5G-RG receives the AGF key, it completes the EAP-5G procedure by sending to UE
an EAP-Success packet within EAP-5G.
Editor\'s note: Whether the N2 Initial Context Setup Request message in step
10a may trigger the establishment of a security association between the 5G-RG
and the F-AGF should be investigated by SA wg3 and BBF.
\- The authentication procedure executed in step 8 may be different from the
EAP-AKA\' procedure executed over untrusted non-3GPP access. This should be
further investigated by SA3 and BBF.
11\. The 5G-AGF responds to AMF with an N2 Initial Context Setup Response
message.
12\. The AMF sends the NAS Registration Accept within an N2 message and the
5G-AGF forwards this NAS message to 5G-RG over the L2 connection established
in step 1. All subsequent NAS messages between the 5G-RG and the AMF are
transferred via the 5G-AGF over this L2 connection. As mentioned above, SA3
and BBF should specify what security procedures (if any) are needed to protect
the traffic carried over this L2 connection.
Editor\'s note: Whether the EAP-5G exchange between the 5G-RG and the network
is followed by an IP configuration is to be determined by the BBF.
### 6.2.3 Impact on 5GC
Since the proposed registration procedure is based on the existing
registration procedure for untrusted non-3GPP access, the impact on 5GC is
minimum.
Editor\'s note: A more detailed analysis of 5G impact is FFS.
## 6.3 Solution #3 - NAS and Security for 5G-RG on Wireline Access
### 6.3.1 General
This solution is for key issue #1 and #3 for 5G-RG connected to W-5GAN.
NOTE: The protocol stack and call flows below need to be updated according to
the solution specified by BBF for NAS transport and other communication
between 5G-RG and FAGF. Such alignment can be done as part of normative work.
The control protocol stack in figure 6.3.1-1 is used between 5G-RG and AMF. In
the description below, a \"Fixed Access Control Protocol\" (FCP) is used to
establish the link, transport AS and NAS parameters, create sessions, etc.
Detailed functionality associated with FCP and the protocol layers below in
this solution shall be specified by BBF and is out of 3GPP scope (e.g.,
whether it is re-using existing protocol(s) or is newly defined). There is
e.g. no assumption that FCP below refers to a single protocol or a specific
protocol layer. The purpose to include FCP in this solution is just to have a
generic concept to discuss the end-to-end solution, that can later be adapted
to the actual solution selected by BBF.
Figure 6.3.1-1: Control Plane stack for Wireline access for 5G-RG
The 5G-RG use the unified authentication framework to do NAS based
authentication in the registration procedure.
Provided below are call-flows for registration and PDU session establishment
(non-roaming and LBO) procedures. The purpose with these are to show that the
impact on these procedures due to Wireline Access is minor compared with
existing Rel-15 non-3GPP access procedures.
### 6.3.2 5G-RG Registration via Wireline Network
The signalling flow in Figure 6.3.2-1 does not show all the details of a
registration procedure via wireline access. It shows primarily the steps
executed between the 5G-RG and FAGF.
Figure 6.3.2-1. 5G-RG Registration via Wireline Access Network
1\. The 5G-RG connects to a Wireline Access Network with procedures outside
the scope of 3GPP.
2\. The 5G-RG proceeds with the establishment of a FCP connection with the
FAGF.
3\. The 5G-RG sends a FCP message that contains the Access Network parameters
(AN-Params) and a NAS Registration Request message. The AN-Params contain
information (e.g. SUCI or the 5G-GUTI, the Selected PLMN ID and NSSAI) that is
used by the FAGF for selecting an AMF in the 5G core network.
4\. The FAGF shall select an AMF based on the received AN-Params and local
policy, as specified in TS 23.501 [2], clause 6.3.5. The FAGF shall then
forward the NAS Registration Request received from the 5G-RG, together with N2
parameters such as PLMN ID and UE location information, to the selected AMF.
5\. The selected AMF may decide to request the UE\'s permanent identity (SUCI)
by sending a NAS Identity Request message to 5G-RG. This NAS message and all
subsequent NAS messages are sent to 5G-RG using FCP. The 5G-RG respond with
the SUCI.
6\. The AMF may decide to authenticate the 5G-RG. In this case, the AMF shall
select an AUSF as specified in TS 23.501 [2] clause 6.3.4 by using the SUPI or
SUCI, and shall send a key request to the selected AUSF. The AUSF may initiate
an authentication as specified in TS 33.501 [25]. The authentication packets
are encapsulated within NAS authentication messages. The NAS authentication
messages are encapsulated within FCP messages between the 5G-RG and the FAGF.
Multiple rounds of steps 6b-6g can be performed depending on the
authentication method used. After the successful authentication:
\- In step 6h, the AUSF shall send the anchor key (SEAF key) to AMF which is
used by AMF to derive NAS security keys and a AS level security key (AS key).
The 5G-RG also derives the anchor key (SEAF key) and from that key it derives
the NAS security keys and the AS level security key (AS key).
\- In step 6h, the AUSF shall also include the SUPI (unencrypted), if in step
6a the AMF provided to AUSF a SUCI.
7\. The AMF shall send a Security Mode Command (SMC) request to 5G-RG in order
to activate NAS security. The 5G-RG replies with a SMC Complete.
8a. The AMF initiates NG Context Setup. The AMF sends a Initial Context Setup
Request to the FAGF together with the AS key.
NOTE: Whether the AS key is used to establish security for FCP between FAGF
and 5G-RG is determined by BBF.
8b. The FAGF replies with a Initial Context Setup Response.
9\. The AMF sends a NAS Registration Accept message to the 5G-RG. This NAS
message may be included with the NGAP Initial Context Setup Request in step 8
or sent before the NGAP Initial Context Setup Response is received.
### 6.3.3 5G-RG Requested PDU Session Establishment via Wireline Access
Network
In this procedure the term \"FCP UP connection\" is used and it refers to a
user plane connection between the 5G-RG and the FAGF. Each FCP UP connection
is associated with one or multiple QoS profiles.
NOTE: BBF needs to provide feedback if multiple user plane connections are
needed for QoS and what a FCP UP connection is (e.g., a separate VLAN
identity).
Figure 6.3.3-1. 5G-RG Requested PDU Session Establishment via Wireline Access
Network
1\. The 5G-RG shall send a PDU Session Establishment Request message to AMF as
specified in _TS 23.502 [3]_ step 1 of clause 4.3.2.2.1. The FAGF shall
transparently forward the NAS message to AMF in the 5GC by encapsulating it in
a N2 message.
2a. In case of non-roaming or roaming with Local Breakout, steps 2-11
specified in _TS 23.502 [3]_ clause 4.3.2.2.1 are executed according to the
PDU Session Establishment procedure over 3GPP access. In case of home-routed
roaming, steps 2-14 specified in _TS 23.502 [3]_ clause 4.3.2.2.2 are executed
according to the PDU Session Establishment procedure over 3GPP access.
2b. As described in step 11 of _TS 23.502 [3]_ clause 4.3.2.2.1, the AMF shall
send a N2 PDU Session Request message to FAGF to establish the access
resources for this PDU Session.
3\. FAGF determines the UP resources needed and the access parameters to be
used. QoS may be setup between 5G-RG and FAGF.
4a. The FAGF sets up the UP resources for the PDU session. This step is AN
specific and defined by BBF.
Editor\'s note: This step will be updated with relevant information and
reference when available from BBF.
5\. After the required UP resources are established, the FAGF shall forward to
5G-RG via FCP for NAS signalling the PDU Session Establishment Accept message
received in step 2b.
6\. The FAGF shall send to 5G-RG an N2 PDU Session Request Ack. The FAGF
allocates AN N3 tunnel information for the PDU Session and includes the AN N3
tunnel endpoint in the message.
7\. In case of non-roaming or roaming with Local Breakout, all steps specified
in _TS 23.502 [3]_ clause 4.3.2.2.1 after step 14 are executed according to
the PDU Session Establishment procedure over 3GPP access. In case of home-
routed roaming, all steps specified in clause 4.3.2.2.2 after step 18 are
executed according to the PDU Session Establishment procedure over 3GPP
access.
8\. On the user-plane:
\- When the 5G-RG has to transmit an UL PDU, the 5G-RG shall determine the QFI
associated with the UL PDU (by using the QoS rules of the PDU Session). The UP
packet carries the QFI associated with the UL PDU.
\- When the FAGF forwards a DL PDU via N3, the corresponding QFI and
Reflective QoS Indicator (RQI), if any, shall be provided with the DL PDU.
### 6.3.4 5G-RG or Network Requested PDU Session Modification via W-5GAN
The 5G-RG or network requested PDU Session Modification procedure via wireline
access is depicted below. The procedure applies in non-roaming, roaming with
LBO as well as in home-routed roaming scenarios.
For non-roaming and LBO scenarios, the functional entities in the following
procedures are located in the PLMN of the FAGF.
The procedure below is based on the PDU Session Modification procedure
specified in TS 23.502 [3], clause 4.3.3.2 (for non-roaming and roaming with
LBO) and on the PDU Session Modification procedure specified in TS 23.502 [3],
clause 4.3.3.3 (for home-routed roaming).
Figure 6.3.4-1: UE or Network Requested PDU Session Modification via wireline
access
1\. If the PDU Session Modification procedure is initiated by the 5G-RG, the
5G-RG shall send a PDU Session Modification Request message to AMF as
specified in step 1 of TS 23.502 [3], clause 4.3.2.2. The FAGF shall
transparently forward the PDU Session Modification Request to AMF/SMF.
2\. In case of non-roaming or LBO, the steps 1a (from AMF) to 1e and steps 2-3
as per the PDU Session Modification procedure in TS 23.502 [3], clause 4.3.3.2
are executed.
In case of home-routed, the steps 1a (from AMF) to 1e and steps 2-3 as per the
PDU Session Modification procedure in TS 23.502 [3], clause 4.3.3.3 are
executed.
3\. The AMF sends N2 PDU Session Request (N2 SM information received from SMF,
NAS message) message to the FAGF. This step is the same as step 4 in TS 23.502
[3], clause 4.3.3.2 (for non-roaming and roaming with Local Breakout) and step
5 in TS 23.502 [3], clause 4.3.3.3 (for home-routed roaming).
4\. The FAGF may trigger an access-specific resource modification towards the
5G-RG.
NOTE: Whether this step is needed, and if so, the details of this step, is to
be defined by BBF.
5\. The FAGF acknowledges N2 PDU Session Request by sending a N2 PDU Session
Response Message to the AMF to acknowledge the success or failure of the
request.
6\. In case of non-roaming or LBO, step 7 as per the PDU Session Modification
procedure in TS 23.502 [3], clause 4.3.3.2 is executed. In case of home-
routed, the steps 8-10 as per the PDU Session Modification procedure in TS
23.502 [3], clause 4.3.3.3 are executed.
7\. The FAGF sends the PDU Session Modification Command to UE (if received in
step 3) and receives the response message from UE.
Step 4 and step 7a may happen consecutively. Further details may be defined by
BBF.
8\. The FAGF forwards the NAS message to the AMF.
9\. For non-roaming and roaming with LBO, all the steps from step 10 in TS
23.502 [3], clause 4.3.3.2 are executed according to the general PDU Session
Modification procedure. For home-routed roaming, all steps from step 13 in TS
23.502 [3], clause 4.3.3.3 are executed according to the general PDU Session
Modification procedure.
### 6.3.5 5G-RG or Network Requested PDU Session Release via wireline access
This clause specifies how a 5G-RG or the network can release a PDU Session via
W-5GAN. The procedure applies in non-roaming, roaming with LBO as well as in
home-routed roaming scenarios.
For non-roaming and LBO scenarios, if the UE is simultaneously registered to a
3GPP access in a PLMN different from the PLMN of the FAGF, the functional
entities in the following procedures are located in the PLMN of the FAGF. For
home-routed roaming scenarios, the AMF, V-SMF and associated UPF in VPLMN in
the following procedure is located in the PLMN of the FAGF.
Figure 6.3.5-1: UE Requested PDU Session Release via wireline access
1 One or more PDU Sessions are already established for the 5G-RG.
2\. The 5G-RG sends a PDU Session Release Request message to the SMF via the
FAGF as defined in TS 23.502 [3], clause 4.3.4.
3\. For non-roaming and roaming with LBO, the steps 1a (from AMF) to 4
according to the PDU Session Release procedure defined in TS 23.502 [3],
clause 4.3.4.2 are executed. For home-routed roaming, the steps 1a (from AMF)
to step 7 according to the PDU Session Release procedure defined in TS 23.502
[3], clause 4.3.4.3 are executed.
4\. This step is the same as step 4 in TS 23.502 [3], clause 4.3.4.2 (non-
roaming and LBO) and step 6 in TS 23.502 [3], clause 4.3.4.3 (home-routed
roaming).
5\. Upon receiving AN session release request message from the AMF, the FAGF
may trigger the release of resources associated with the PDU Session in the
W-5GAN.
NOTE: This step isWhether this step is needed and if so, the details of this
step, is to be defined by BBF.
6\. This step is the same as step 6 in TS 23.502 [3], clause 4.3.4.2 (non-
roaming and LBO) and step 8 in TS 23.502 [3], clause 4.3.4.3 (home-routed
roaming).
7\. For non-roaming and roaming with LBO, step 7 according to the PDU Session
Release procedure defined in TS 23.502 [3], clause 4.3.4.2 are executed. For
home-routed roaming, step 9-10 according to the PDU Session Release procedure
defined in TS 23.502 [3], clause 4.3.4.3 are executed.
8\. The FAGF delivers the NAS message (PDU Session Release Command) to the UE.
9\. The 5G-RG sends a NAS message (PDU Session Release Ack) to the FAGF.
10\. This step is the same as step 9 in TS 23.502 [3], clause 4.3.4.2 (non-
roaming and LBO) and step 11 in TS 23.502 [3], clause 4.3.4.3 (home-routed
roaming).
Steps 5 and 8 may happen consecutively.
11\. For non-roaming and roaming with LBO, all steps from step 10 in the PDU
Session Release procedure defined in TS 23.502 [3], clause 4.3.4.2 are
executed. In the case of home-routed roaming, all steps from step 12 in the
PDU Session Release procedure defined in TS 23.502 [3], clause 4.3.4.3 are
executed.
### 6.3.6 Deregistration procedure for 5G-RG via Wireline Access Network
Figure 6.3.6-1: Deregistration procedure for wireline access
1\. The Deregistration procedure is triggered by one of the events:
1a. For 5G-RG-initiated Deregistration as in steps from 1 to 7 of TS 23.502
[3], Figures 4.2.2.3.2-1.
1b. For network initiated deregistration as in steps from 1 to 6 of TS 23.502
[3], Figure 4.2.2.3.3-1.
If the 5G-RG is in CM-CONNECTED state either in 3GPP access, wireline access
or both,
\- the AMF may explicitly deregister the 5G-RG by sending a Deregistration
request message (Deregistration type, access type set to non-3GPP) to the
5G-RG as in step 2 of TS 23.502 [3], Figure 4.2.2.3.3-1. The 5G-RG will
interpret access type set to non-3GPP as referring to wireline access.
\- the UDM may want to request the deletion of the subscribers RM contexts and
PDU Sessions with the reason for removal set to subscription withdrawn to the
registered AMF as in step 1 of TS 23.502 [3], Figure 4.2.2.3.3-1.
2\. AMF to FAGF: The AMF sends a N2 Context UE Release Command message to the
FAGF with the cause set to Deregistration to release N2 signalling as defined
in step 4 of TS 23.502 [3], clause 4.12.4.2.
3\. The FAGF may initiate the release of the signalling connection between
5G-RG and FAGF.
NOTE: Whether this step is needed, and if so, the details of this step is
defined by BBF.
4\. FAGF to AMF: The FAGF acknowledges the N2 UE Context Release Command
message by sending N2 UE Context Release Complete message to the AMF as
defined in step 7 of TS 23.502 [3], clause 4.12.4.2.
### 6.3.7 Service Request procedures via W-5GAN
The Service Request procedure via W-5GAN shall be used by a 5G-RG in CM-IDLE
state over W-5GAN to request the re-establishment of the NAS signalling
connection and the re-establishment of the user plane for all or some of the
PDU Sessions which are associated to wireline access. This may e.g. occur when
the 5G-RG has entered CM-IDLE state due to access network connectivity failure
and the UE regains connectivity before the UE non-3GPP Deregistration timer
expires.
The Service Request procedure via W-5GAN shall be used by a 5G-RG in CM-
CONNECTED state over wireline access to request the re-establishment of the
user plane for one or more PDU Sessions which are associated to wireline
access.
When the 5G-RG is in CM-IDLE state over wireline access, the Service Request
procedure via W-5GAN is as described in TS 23.501 [2], clause 4.2.3.2 (UE
Triggered Service Request) with the following exceptions:
\- The Service Request procedure is never a response to a Paging, i.e. there
is no Network Triggered Service Request procedure via W-5GAN.
\- The (R)AN corresponds to an FAGF.
\- The UE corresponds to the 5G-RG.
\- The means for carrying NAS messages between 5G-RG and FAGF is to be defined
by BBF.
\- The 5G-RG includes AN parameters together with the Service Request. The AN
parameters include the Selected PLMN ID and Establishment cause. The
Establishment cause provides the reason for requesting a signalling connection
with the 5GC. The 5G-RG includes GUAMI information in the AN parameters. The
FAGF selects the AMF according to GUAMI information.
\- The N2 parameters sent from FAGF to AMF include the Establishment cause and
the RAT type.
\- The means for managing the user plane for the PDU Session between 5G-RG and
FAGF is to be determined by BBF.
When the 5G-RG is in CM-CONNECTED state over wireline access, the Service
Request procedure via W-5GAN is as described in TS 23.502 [3], clause 4.2.3.2
(UE Triggered Service Request) with the following exceptions:
\- The means for carrying NAS messages between 5G-RG and FAGF is to be defined
by BBF.
\- The (R)AN corresponds to an FAGF.
\- The UE corresponds to the 5G-RG.
\- The means for managing the user plane for the PDU Session between 5G-RG and
FAGF is to be determined by BBF.
When the 5G-RG is in CM-CONNECTED state over wireline access and the network
receives downlink data for a PDU Session over wireline access that has no user
plane connection, the steps 1-4a in TS 23.502 [3], clause 4.2.3.3 (Network
Triggered Service Request) shall be performed with the following exceptions:
\- The (R)AN corresponds to an FAGF.
\- The UE corresponds to the 5G-RG.
\- The means for managing the user plane for the PDU Session between 5G-RG and
FAGF is to be determined by BBF.
## 6.4 Solution #4 - Handover support for KI #5
### 6.4.1 General
This solution describes handover support and handover procedures applicable to
scenarios described in clause 4.2.2.
### 6.4.2 5G-RG connected via W-5GAN
For the scenario of 5G-RG connected only via W-5GAN (as shown in Figure
4.2.2.1-1 in Scenario 1) the handover procedures defined in TS 23.502 [3]
clause 4.9 are not applicable, since the 5G-RG is stationary and connected
only via a wired network.
### 6.4.3 5G-RG connected via NG-RAN
A 5G-RG (as a 3GPP UE) connected to NG-RAN (as shown in Figure 4.2.2.1-3 in
Scenario 1) supports the handover procedures in 3GPP access as defined in TS
23.502 [3], clause 4.9.1.
### 6.4.4 5G-RG connected via W-5GAN and NG-RAN
#### 6.4.4.1 General
For the scenario of 5G-RG with capability to connect both via NG-RAN and
W-5GAN (as shown in Figure 4.2.2.1-2 in Scenario 1), the handover procedures
between 3GPP access and Non-3GPP access are described below.
#### 6.4.4.2 Handover of a PDU Session procedure from W-5GAN to 3GPP access
(non-roaming and roaming with local breakout)
This clause specifies how a 5G-RG can handover a PDU Session from W-5GAN
access to 3GPP access. It is based on the PDU Session Establishment procedure
for 3GPP access as specified in TS 23.501 [2], clause 4.3.2.
Figure 6.4.4.2-1: Handover of a PDU Session procedure from W-5GAN access to
3GPP access (non-roaming and roaming with local breakout)
1\. If the 5G-RG is not registered via 3GPP access, the 5G-RG shall initiate
Registration procedure as defined in TS 23.501 [2], clause 4.2.2.2.2.
2\. The 5G-RG performs a PDU Session Establishment procedure with the PDU
Session ID of the PDU Session to be moved as specified TS 23.501 [2], clause
4.3.2.2.1.
3\. The SMF executes the release of resources in W-5GAN access. Because the
PDU Session shall not be released, the SMF shall not send the PDU Session
Release Command to the 5G-RG. The SM context between the AMF and the SMF is
maintained.
Editor\'s note: The procedure for release of resources in W-5GAN access is FFS
#### 6.4.4.3 Handover of a PDU Session procedure from 3GPP to W-5GAN access
(non-roaming and roaming with local breakout)
This clause specifies how to hand over a PDU Session from 3GPP access to
target W-5GAN access. It is based on the PDU Session Establishment procedure
for W-5GAN access as specified in clause 6.3.3.
Figure 6.4.4.3-1: Handover of a PDU Session from 3GPP access to W-5GAN access
(non-roaming and roaming with local breakout)
1\. If the 5G-RG is not registered via W-5GAN access, the UE shall initiate
Registration procedure. Solutions for Registration procedure in W-5GAN access
are described in clause 6.3.2 and clause 6.3.3.
2\. The UE performs PDU Session Establishment procedure with the PDU Session
ID of the PDU Session to be moved as specified in clause 6.3.3.
3 The SMF executes the release of resource in 3GPP as described instep 3, in
TS 23.501 [2], clause 4.9.2.2.
### 6.4.5 5GC-capable UE connected via NG-RAN and 5G-RG
#### 6.4.5.1 General
For the scenario of 5GC-capable UE connected via 5G-RG and NG-RAN (as shown in
Figure 4.2.2.3-2 in scenario 3), the handover procedures between 3GPP access
and Non-3GPP access are described below.
#### 6.4.5.2 Handover of a PDU Session procedure from W-5GAN to 3GPP access
(non-roaming and roaming with local breakout)
This clause specifies how a 5GC-capable UE can handover a PDU Session from
5G-RG/W-5GAN access to 3GPP access. It is based on the PDU Session
Establishment procedure for 3GPP access as specified in TS 23.501 [2], clause
4.3.2.
Figure 6.4.5.2-1: Handover of a PDU Session procedure from 5G-RG/W-5GAN access
to 3GPP access (non-roaming and roaming with local breakout)
1\. If the 5GC-capable UE is not registered via 3GPP access, the 5GC-capable
UE shall initiate Registration procedure as defined in TS 23.501 [2], clause
4.2.2.2.2.
2\. The 5GC-capable UE performs a PDU Session Establishment procedure with the
PDU Session ID of the PDU Session to be moved as specified TS 23.501 [2],
clause 4.3.2.2.1.
3\. The SMF executes the release of resources in W-5GAN access. Because the
PDU Session shall not be released, the SMF shall not send the PDU Session
Release Command to the 5GC-capable UE. The SM context between the AMF and the
SMF is maintained.
Editor\'s note: The procedure for release of resources in W-5GAN access is
FFS.
#### 6.4.5.3 Handover of a PDU Session procedure from 3GPP to W-5GAN access
(non-roaming and roaming with local breakout)
This clause specifies how a 5GC-capable UE can handover a PDU Session from
3GPP access to target 5G-RG/W-
Figure 6.3.5.3-1: Handover of a PDU Session from 3GPP access to 5G-RG/W-5GAN
access (non-roaming and roaming with local breakout)
1\. If the 5GC-capable UE is not registered via 5G-RG/W-5GAN access, the UE
shall initiate Registration procedure.
Editor\'s note: The Registration procedures for 5GC-capable UE connected via
5G-RG is FFS and discussed as part of other solutions.
2\. The 5GC-capable UE performs PDU Session Establishment procedure with the
PDU Session ID of the PDU Session to be moved.
Editor\'s note: The PDU Session Establishment procedures for 5GC-capable UE
connected via 5G-RG is FFS and discussed as part of other solutions.
3 The SMF executes the release of resource in 3GPP as described in step 3, in
TS 23.501 [2], clause 4.9.2.2.
## 6.5 Solution #5 - Connection Management support for KI #5
The solution proposed in this clause are based on architecture describe in
Solution #1 clause 6.1.
### 6.5.1 5G-RG connected to W-5GAN
The CM-IDLE state defined in TS 23.501 [2] clause 5.3.3 for 3GPP access
applies to 5G-RG connected via W-5GAN with following modifications:
\- The UE is replaced by 5G-RG.
\- The 5G-RG moves from CM-CONNECTED state to CM-IDLE state only in the case
of connectivity failure with the AMF.
\- When the 5G-RG is in CM-CONNECTED state and moves to CM-IDLE state and
starts the UE Non-3GPP deregistration timer.
\- the paging procedure is not applicable for 5G-RG.
\- MICO mode is not applicable.
The CM-CONNECTED state defined in TS 23.501 [2] clause 5.3.3 applies to 5G-RG
connected via W-5GAN with following modifications:
\- The UE is replaced by 5G-RG.
\- The 5G-RG shall remain in CM-CONNECTED state until any of those conditions
arise:
\- the 5G-RG AMF connectivity fails, in which case the 5G-RG moves to CM-IDLE
state;
\- it receives an explicit NAS deregistration from the 5G Core in which case
the 5G-RG moves to RM-DEREGISTERED state;
\- the 5G-RG explicitly deregisters e.g. when 5G-RG equipment is gracefully
shut down, in which case the 5G-RG moves to RM-DEREGISTERED state.
\- The AMF shall keep the 5G RG in CM-CONNECTED state until one of those
conditions is met:
\- the 5G-RG AMF connectivity fails, in which case the 5G-RG moves to CM-IDLE
state.
\- The AMF shall keep the 5G RG in RM-REGISTERED state until one of those
conditions is met:
\- the 5G-RG explicitly deregisters e.g. when 5G-RG equipment is gracefully
shut down, in which case the 5G-RG moves to RM-DEREGISTERED state;
\- the 5G-RG is explicitly de-registered by the core network by means of
Deregistration procedure in which case the 5G-RG moves to RM-DEREGISTERED
state;
\- the 5G-RG is implicitly de-registered due to the expiry of the Network
Non-3GPP Implicit Deregistration timer configured in the AMF, in which case
the 5G-RG moves to RM-DEREGISTERED state.
NOTE : the management of CM-IDLE state is based on the same timers as for
Untrusted Non-3GPP.
The Connection procedures defined in TS 23.502 [3] are applicable as described
in the table 6.5.1-1.
Table 6.5.1-1: Applicability of Connection procedure defined in TS 23.502 [3]
* * *
Procedure Reference Applicability to 5G-RG connected via W-5GAN UE triggered
service request in CM_IDLE state TS 23.502 [3] clause 4.2.3.2 Applicable. It
can be used by the 5G-RG to try to move from CM_IDLE state to CM_CONNECTED
state. UE triggered service request in CM_CONNECTED state TS 23.502 [3] clause
4.2.3.3 Applicable. It is used to activate PDU sessions. Network triggered
service request TS 23.502 [3] clause 4.2.3.4 Applicable only when the 5G-RG is
CM_CONNECTED state since there is no connectivity in CM_IDLE state in non-3GPP
access. For example, the paging part of the procedure is not applicable, while
in case that UPF receives downlink data of a PDU session and there is no
W-5GAN tunnel information stored in UPF for the PDU session, the network
triggered service request can be performed UE configuration update TS 23.502
[3] clause 4.2.4 Applicable UE reachability TS 23.502 [3] clause 4.2.5 Not
applicable UE context release in AN TS 23.502 [3] clause 4.2.6 Applicable N2
procedure TS 23.502 [3] clause 4.2.7 Applicable Feature specific UE/RAN Radio
information and Compatibility Request procedure TS 23.502 [3] clause 4.2.8 Not
applicable
* * *
Editor\'s note: Whether a procedure equivalent to Feature specific UE/RAN
Radio information and Compatibility Request procedure is required for 5G-RG is
FFS.
Editor\'s note: The detailed description of Connection management procedures
defined in TS 23.502 [3] for the scenario of 5G-RG connected to a W-5GAN are
FFS.
## 6.6 Solution #6 - Registration management support for KI #5
The solution proposed in this clause are based on architecture describe in
Solution #1 clause 6.1.
### 6.6.1 5G-RG connected to W-5GAN
The RM-DEREGISTERED state and the RM-REGISTERED state defined in TS 23.501 [2]
clause 5.3.2 apply to 5G-RG connected via W-5GAN with the following
difference:
\- The RM-DEREGISTERED state defined in TS 23.501 [2] clause 5.3.2.2.2 applies
to 5G-RG as defined for the UE.
\- The RM-REGISTERED state defined in TS 23.501 [2] clause 5.3.2.2.3 applies
to 5G-RG as defined for the UE.
\- Mobility Registration Update procedure defined in TS 23.501 [2] and TS
23.502 [3] is not applicable, since the 5G-RG is assumed to be connected via
wireline access and it is not moving.
\- Periodic Registration Update procedure, defined by 3GPP in TS 23.501 [2]
and TS 23.502 [3], triggered by expiration of the periodic update timer to
notify the network that the 5G-RG is still active is not applicable.
\- When the 5G-RG registers to the 5G Core, the 5G Core provides the 5G RG
with a UE Non-3GPP Deregistration timer. When moving to CM-IDLE state, the
5G-RG starts the UE Non-3GPP Deregistration timer. When the UE Non-3GPP
Deregistration timer expires, the 5G-RG moves to RM-DEREGISTERED.
\- When the 5G-RG has a PDU session with an active the user plane connection
and moves to CM-IDLE state, the PDU session user plane connection becomes
inactive but the PDU session is not released as long as the UE Non-3GPP
Deregistration timer has not expired. This allows the 5G-RG to try to re-
activate the PDU session user plane connection in a seamless way (with same
RG-5G IP address). The 5G-RG uses the Service Request procedure to re-activate
the user-plane connection.
NOTE: the management of CM-IDLE state is based on the same timers as for
Untrusted Non-3GPP.
## 6.7 Solution #7 - IPTV Service Support
This is the solution to Key issue #11.
### 6.7.1 Description
This solution describes how to support the IPTV services without impacting the
IPTV platform, including IPTV Authentication, IP allocation from IPTV network
and the support of Unicast Packets transmission and Multicast Packets
transmission without MBS supports in 5GC and NG RAN.
NOTE 1: Some specifications about IPTV are standardized by ETSI, e.g. ETSI TS
102 542‑1 [37] and ITU. However this solution is proposed based on the
existing common IPTV platform already deployed.
Editor\'s note: The reference to the existing specification for IPTV is FFS.
This solution is based on establishment of PDU session dedicated to IPTV
service where the IP address is assigned by IPTV platform. The UPF performs
the control of user to the multicast group via IGMP, packet replication and
enforces the Channel Access Control of Multicast Channels.
Considering the architecture of Figure 6.1-3 that 5G-RG connecting to NG-RAN,
the solution include the procedures listed as below:
\- Two Alternatives of Channel Access Control list Provision Procedure.
\- Alternative one: the Channel Access Control list is provided by IPTV SMS
(Service Management System) in IPTV network to UDM in order to be included in
user subscription data via the Channel Access Control list Provision Procedure
shown in figure 6.7.2-1a.
\- Alternative two: the Channel Access Control list is provided by IPTV SMS
(Service Management System) in IPTV network to PCF to be included in 3GPP
policy via the Channel Access Control list Provision Procedure shown in figure
6.7.2-1b.
\- Registration Procedure and PDU Session Establishment Procedure for a PDU
session dedicated to IPTV service for 5G-RG shown in Figure 6.7.2-2. The
Registration Procedure is used to register to 5GS and the PDU Session
Establishment Procedure is used to establish the PDU Session for IPTV Service.
\- IPTV Access Procedure shown in Figure 6.7.2-3. The IPTV Access Procedure is
used to access the IPTV network, including completing the IPTV Authentication
and IP allocation function.
\- Multicast Service Support Procedure shown in Figure 6.7.2-4. The Multicast
Service Support Procedure is used to enhance the 5GS to support Multicast
Service from IPTV network.
NOTE 1: 5GS can support Unicast Service from IPTV network directly.
Editor\'s note: How to enhance the 5GS to support Multicast Packets
transmission for the architecture of Figure 6.1-1 and Figure 6.1-5 that 5G-RG
connecting to Wireline Access Network is FFS.
In current IPTV network, Line ID is used to perform IPTV Authentication. In
addition, User ID&&Password and/or STB MAC address should also be used to
perform IPTV Authentication. Line ID includes Circuit ID and Remote ID defined
in RFC 3046 [14]. The Line ID is provided by the wireline access network or
BNG during the DHCPv4 procedure. User ID&&Password and/or STB MAC address is
provided by STB during the DHCPv4 procedure to IPTV network. After that IPTV
Authentication is completed, the DHCP Server in the IPTV system will allocate
the IP address to the RG.
In order to minimize the impact to the existing IPTV system, Line ID, User
ID&&Password, STB MAC address can be reused to perform IPTV Authentication.
The Line ID is added to the subscription data in UDM via the management system
(e.g. when the user subscribed the IPTV services). The SMF receives the Line
ID included in the subscription data and send the Line ID to UPF in during the
PDU Session Establishment Procedure.
NOTE 2: The Line ID reused to perform IPTV Authentication is allocated by the
IPTV System and has the same format as the Line ID used in the traditional
wireline network, but it doesn\'t used to identify the incoming circuit and
the remote high-speed modem in the wireline network as specified in RFC 3046
[14].
Editor\'s note: Whether the procedure to add the Line ID to subscription data
should be standardized in 3GPP is FFS.
NOTE 3: Based on IPTV network deployment, IPTV Authentication is performed
using either the STB MAC address or User ID &&password or both as
subscription.
The solution assumes that a PDU session per STB is dedicated to the IPTV
services and that the IP address is assigned via DHCPv4 by a server located in
IPTV network. The DHCPv4 procedure enables the Line ID based authentication
via Option 82. Furthermore, DHCPv4 procedure may also enable the STB MAC
address based authentication via Option 61 and/or enable the User ID&&Password
based authentication via Option 60 mechanism extensively used in current BBF
network deployment.
NOTE 4: The PDU session dedicated to the IPTV services is per STB. If multiple
STB(s) are under the coverage of one 5G-RG, corresponding multiple PDU
Sessions dedicated to the IPTV services are needed.
Editor\'s note: How to support Multicast for IPv6 (e.g. the support of MLD and
DHCPv6) is FFS.
The Multicast Support relies on the IGMP and on the support of IGMP Join in
UPF for binding the Multicast address included in the IGMP Join message to the
related PDU Session from the 5G-RG. When the UPF receives a downlink Multicast
packet from IPTV network, the UPF identifies the corresponding PDU session via
the Multicast address in the Multicast packet and send the downlink Multicast
packet to 5G-RG.
NOTE 5: UPF shall enforce PIM (**Protocol-Independent Multicast**) to ensure
receive DL multicast traffic. Which PIM mode (e.g. Sparse Mode PIM-SM defined
in RFC 4601 [40] or Dense Mode PIM-DM defined in RFC 3973 [41]) should be
enforced is based on local policies in SMF/UPF.
Channel Access Control of Multicast Channels is performed in UPF to support
some access right status of the entitlement to each of the Multicast channels
for each user, such as fully allowed, preview allowed, not allowed. A Channel
Access Control list is provided by IPTV SMS (Service Management System) in
IPTV network to UDM in order to add in user subscription data via the Channel
Access Control list Provision Procedure shown in figure 6.7.2-1a or to PCF in
order to add in 3GPP policy via the Channel Access Control list Provision
Procedure shown in figure 6.7.2-1b. UPF obtains the Channel Access Control
list from from user subscription data or 3GPP policy during PDU Session
Establishment procedure shown in figure 6.7.2-2 and performs the Channel
Access Control based on the Channel Access Control list. The format of the
Channel Access Control list is specific for IPTV network. An example of
Channel Access Control list is given in table 6.7.1-1.
UPF shall map the STB ID in the Channel Access Control list received during
PDU session procedures to the IP address assigned to the PDU Session dedicated
to the IPTV services. The procedure is shown in Figure 6.7.2-3 step 12-2. An
example of Channel Access Control list after mapping is given in table
6.7.1-2.
NOTE 6: The STB ID is decided by IPTV network. Based on IPTV network
deployment, it can be MAC address of the STB or User ID. Furthermore, the
Channel Access Control list will not be specified in 3GPP, but decided by IPTV
network. 3GPP network only take the Channel Access Control list as input from
IPTV network to perform Channel Access Control. In this solution UDM
(alternative one in 6.7.2) or PCF (alternative two in 6.7.2) only
transparently transmit it to UPF without understanding and translation.
\- UPF sends the DL multicast traffic to the 5G-RG via the related PDU Session
when the Channel is fully allowed for the STB.
\- UPF sends the DL multicast traffic to the 5G-RG under certain condition via
the related PDU Session when the Channel is Preview allowed for the 5G-RG PDU
Session, e.g. the preview will be allowed for 10 seconds. After that, the UPF
unbinds the multicast address and the PDU Session, and stops sending DL
multicast traffic.
NOTE 7: The condition is defined by the IPTV system is also included in the
Channel Access Control list, but not shown in table 6.7.1-1.
\- UPF drops the IGMP join message when the Channel is not allowed for the
5G-RG PDU Session and doesn\'t send the DL multicast traffic to the 5G-RG.
Table 6.7.1-1: An example of Channel Access Control list before mapping
* * *
             Multicast address 1 (Channel 1)   Multicast address 2 (Channel 2)   Multicast address 3 (Channel 3)
STB ID 1 Fully allowed Not allowed Preview allowed STB ID Fully allowed Fully
allowed Not allowed STB ID 3 Fully allowed Preview allowed Preview allowed
* * *
Table 6.7.1-1: An example of Channel Access Control list after mapping
* * *
                                                                                   Multicast address 1 (Channel 1)   Multicast address 2 (Channel 2)   Multicast address 3 (Channel 3)
IP address assigned to the PDU Session dedicated to the IPTV services for STB1
Fully allowed Not allowed Preview allowed IP address assigned to the PDU
Session dedicated to the IPTV services for STB2 Fully allowed Fully allowed
Not allowed IP address assigned to the PDU Session dedicated to the IPTV
services for STB3 Fully allowed Preview allowed Preview allowed
* * *
### 6.7.2 Procedure
Alternative one: Channel Access Control list Provision Procedure via
subscription data,
Figure 6.7.2-1a: Channel Access Control list Provision Procedure
1\. User subscribe or update the Channel authority. The information is updated
to IPTV SMS.
2\. IPTV SMS send the Channel Access Control list Provision message to 3GPP
NMS, which includes the Channel Access Control list and 5G-RG ID (e.g.GPSI).
3GPP NMS send the Channel Access Control list Provision Response message to
IPTV SMS in step 3.
3\. 3GPP NMS provides the Channel Access Control list and 5G-RG ID (e.g.GPSI)
to UDR. Based on the 5G-RG ID, UDR add the Channel Access Control list to the
subscription data of the corresponding 5G-RG. UDM can synchronize the
subscription data from UDR based on existing UDR service in clause 5.2.12 of
TS 23.502 [3].
NOTE 1: The Interactions between 3GPP NMS and UDR, and between 3GPP NMS and
IPTV SMS belong to SA5 scope and given in this solution only for shown.
Alternative two: Channel Access Control list Provision Procedure via policy,
Figure 6.7.2-1b: Channel Access Control list Provision Procedure
The difference from alternative one in figure 6.7.2-1a is that the Channel
Access Control list is sent to PCF instead of UDM.
Editor\'s note: Whether the Secondary authentication/authorization procedure
can be used to provide the Channel Access Control list is FFS.
Editor\'s note: Whether both or only one of the two alternatives above should
be standardized is FFS.
Figure 6.7.2-2: Registration Procedure and PDU Session Establishment Procedure
to support IPTV service
0\. Registration Procedure for 5G-RG is depicted in TS 23.502 [3] clause
4.2.2.2. The difference is that the Line ID is included in the Subscription
data and stored in UDM.
NOTE 1: 5G-RG can act as the UE depicted in Registration Procedure in TS
23.502 [3] clause 4.2.2.2.
1a. 5G-RG initiates the PDU session establishment procedure dedicated to IPTV
service. The following steps are the same as described in TS 23.502 [3] clause
4.2.2.2 with the differences below.
NOTE 2: The condition to trigger the 5G-RG to establish the PDU Session for
IPTV service is implementation specific (e.g. when the STB is switch on).
1b. The DNN for IPTV is sent by the 5G-RG to the AMF. Furthermore, since IPTV
network allocates the IP address to this PDU session via DHCPv4, the 5G-RG
shall indicate within the Protocol Configuration Options element that the UE
requests to obtain the IPv4 address with DHCPv4.
2\. The AMF shall select a SMF that support IPTV Service if the AMF receive
the DNN for IPTV in step 1b.
4a-4b. SMF receives the user subscription data from UDM which includes the
Line ID. . For Alternative one of Channel Access Control list Provision
Procedure, the Channel Access Control list is included in the user
subscription data.
6b. SMF receives QoS Profile(s) related to IPTV Service, including the QoS
Profile(s) for multicast service. For Alternative two of Channel Access
Control list Provision Procedure, the Channel Access Control list is included
in the policy provided to SMF by PCF.
7\. SMF selects the UPF which supports IPTV Service.
9a. Line ID and Channel Access Control list is included in the N4 Session
Establishment/Modification Request to UPF.
New 9b. UPF shall bind the Line ID received in step 9a with the CN Tunnel
Info.
Figure 6.7.2-3: IPTV Access Procedure
When PDU Session Establishment Procedure is completed, the STB shall initial
the IPTV Access Procedure based on the DHCPv4 Procedure as follows:
1\. The STB sends the DHCP Discover message to the UPF over the user plane.
The UPF and the SMF interacts as described in TS 23.501 [2] clause 5.8.2.2.
STB ID may be included in DHCP Discover message.
NOTE 1: Based on the deployment of IPTV network, STB ID may be either MAC
address of STB included in Option 61 of the DHCP Discover message or User
ID&&Password included in Option 60 of the DHCP Discover message, or both.
2\. The SMF acts as DHCP Proxy and adds the Option 82 defined in RFC 3046 [14]
including Line ID to the DHCP Discover message.
3\. The DHCP Discover message with Option 82 is sent to DHCP Server located in
IPTV network via UPF.
NOTE 1: In order to route the DHCP Discover message to the DHCP Server in IPTV
network, the DHCP Discover message is broadcasted inside the IPTV network.
4\. The IPTV system shall perform IPTV Authentication based on the Line ID
included in the Option 82.
NOTE 2: The IPTV Authentication procedure performed by IPTV system is out of
3GPP Scope.
5\. If the IPTV Authentication procedure in step 4 succeeds, the DHCP Server
in the IPTV system shall respond with DHCP Offer message with Option 82. The
IP address allocated by the DHCP Server in the IPTV system is included in the
DHCP Offer message.
6\. Since the DHCP Offer message doesn\'t contain destination IP address, the
UPF is not able to identify the PDU Session that the DHCP Offer message
belongs to. The UPF shall use the Line ID included in Option 82 and the
binding relationship between Line ID and CN Tunnel info acquired in step 9b of
Figure 6.7.2-1a to identify the PDU Session that the DHCP Offer message
belongs to.
7-1. DHCP Offer message is sent to 5G-RG via PDU Session identified in step 6.
7-2. The 5G-RG shall replace the IP address allocated by the DHCP Server in
IPTV network with the local IP address.
7-3. The DHCP Offer message including local IP address is sent to STB.
8-1. The STB sends the DHCP Request message to confirm the local IP address is
applicable.
8-2. The 5G-RG shall replace the local IP address with the IP address
allocated by the DHCP Server in IPTV network.
8-3. The 5G-RG sends the DHCP Request message to confirm the IP address
allocated by the DHCP Server in IPTV network is applicable.
9\. The SMF acts as DHCP Proxy and add the Option 82 defined in RFC 3046 [14]
including Line ID to the DHCP Request message.
10\. The DHCP Request message with Option 82 is sent to DHCP Server in IPTV
network.
11\. If the IPTV Server confirm the IP address allocated to 5G-RG is
applicable, the DHCP Server in the IPTV network shall respond with DHCP Ack
message with Option 82. The IP address allocated by DHCP Server in the IPTV
network is included in the DHCP Ack message.
12-1. Similar as step 6, the UPF shall identify the PDU Session that the DHCP
Ack message belongs to base on the Line ID included in Option 82 and the
binding relationship between Line ID and CN Tunnel info acquired in step 9b of
Figure 6.7.2-1.
12-2. After IPTV network allocate IP address, UPF shall map the STB ID in the
Channel Control List to IP address for the PDU Session dedicated to the IPTV
services per STB.
13-1. The DHCP Ack message is sent to the 5G-RG via PDU Session identified in
step 12.
13-2. Similar as Step 7-2, the 5G-RG shall replace the IP address allocated by
the DHCP Server in IPTV network with the local IP address.
13-3. The DHCP Ack message including local IP address is sent to STB.
After the STB receives the DHCP Ack message, the STB can obtain the IPTV
Service.
NOTE 3: NAT (Network Address Translation) function should be performed by
5G-RG.
14\. When the SMF receives the DHCP Ack message in step 11, the SMF may
trigger the PDU Session Modification to update the QoS Profile for IPTV
service.
Editor\'s note: How to enhance the 5GS to support other IPTV Authentication is
FFS, e.g. Authentication based on PPPoE.
Editor\'s note: Whether and how to perform the IPTV Access Procedure via the
interface between SMF and IPTV network is FFS.
Figure 6.7.2-4: Multicast Service Support Procedure
In order to obtain the multicast service from IPTV network, the Multicast
Service Support Procedure should be performed.
1\. In order to obtain the multicast service, STB send the IGMP Join message
to the 5G-RG as specified in BBF TR-101 [10].
2\. The 5G-RG shall relay the IGMP Join message to the UPF via the user plane
as defined in BBF TR-101 [10].
3\. When the UPF receives the IGMP Join message the UPF shall check the
Channel Access Control list obtained in step 12-2 of figure 6.7.2-3. If the
Multicast address is allowed for the IP address for the PDU Session dedicated
to the IPTV services per STB, the UPF shall add the 5G-RG IP address to the
requested multicast group. If the Multicast address is not allowed for this IP
address for the PDU Session dedicated to the IPTV services per STB, the UPF
shall drop the IGMP Join message. If the Multicast address is previewed
allowed for the IP address, the UPF shall add the IP address for the PDU
Session dedicated to the IPTV services per STB to the requested multicast
group under certain condition, e.g. the preview will be allowed for 10
seconds.
4-5. When the UPF receives multicast packets from multicast server in IPTV
network, the UPF shall select the PDU Session where to transmit the multicast
packets based on the multicast group, constructed in step 3.
6-7. The UPF shall send the multicast packets to the 5G-RG via the PDU Session
selected in step 5. Then the 5G-RG relay the multicast packets to the STB.
If some other STB also subscribes the same multicast group, the UPF shall
perform replication of the Multicast packets and send them to the
corresponding 5G-RG and STB as well.
### 6.7.3 Solution Evaluation
Editor\'s note: The solution evaluation is FFS.
## 6.8 Solution #8 - Support of IPTV leveraging IGMP / MLD
### 6.8.1 Overview
This solution addresses KI #11.
This solution is meant to apply to both 5G-RG (connected over FWA and/or via a
Wireline access) and FN-RG collectively called \"UE \" in this solution. In
this solution IP means IPv4 or IPV6.
When the solution refers to the \"UE\" this collectively refers to the RG
and/or to the STB (Set Top Box) behind the RG. The split of functionality
between UE(RG) and UE(STB) is under responsibility of BBF and any reference to
UE(RG) and UE(STB) in this solution is only for illustrative purpose.
Corresponding impacts and requirements will be taken into account in normative
phase.
The solution is meant to apply to a great variety of IPTV deployments. The
IPTV infrastructure (architecture, protocol used by the STB to reach this
infrastructure) are not to be defined by 3GPP. 3GPP specifications focus only
on:
\- Setting up the needed PDU Session and ensuring a corresponding IP address
is allocated to the UE (supporting deployments where the IP address is
allocated by the 5GC itself and deployments where the IP address is allocated
by an external server).
\- Handling of IGMP/MLD (and corresponding traffic replication towards the UE)
and of the control on which multicast group the UE can join.
The solution relies on autonomous handling of multicast by the UPF based on an
indication received from the SMF that the N4 (PDU) Session is eligible for IP
multicast traffic.
The solution assumes the UE (RG) sends IGMP / MLD \"signalling\" (see
[15],[52] and [16]) to indicate its desire to receive IP multicast traffic
identified by this IGMP / MLD \"signalling\".
NOTE 1: The IGMP / MLD \"signalling\" may actually have been sent by a device
(like a Set Top Box) inside the Customer Premises.
In 5G-RG case, the UE (RG) requests a dedicated PDU Session for IPTV service
(dedicated DNN and/or S-NSSAI).
When required by IPTV sub-system, in-band (UP) DHCP based address allocation
is requested by the UE for the PDU Session.
Over this dedicated PDU Session the UE (STB) issues IGMP / MLD \"signalling\"
and receives the corresponding DL IP multicast traffic. SMF/UPF that support
the mechanisms described in this solution are selected based on the dedicated
DNN and/or S-NSSAI.
The UPF enforces the Access Control of Multicast Channels by checking whether
the subscription allows access to a multicast group identified by IGMP / MLD
\"signalling\" sent by the UE. The UPF receives from the SMF over N4 the
necessary information to carry out Access Control of Multicast Channels; the
SMF receives policies related with Access Control of Multicast Channels over
Npcf_SMPolicyControl.
Based on the detection of IGMP / MLD \"signalling\" over the User Plane, the
SMF/UPF carries out following actions (assuming Access Control of Multicast
Channels allows accessing to the content identified by this IGMP / MLD
\"signalling\"):
1) if the UPF does not already receive the DL multicast traffic identified by
this IGMP / MLD request e.g. if this is the first IGMP / MLD request, the
SMF/UPF has received about an IP multicast traffic: the SMF/UPF exchanges N6
signalling such as PIM (Protocol-Independent Multicast) in order to connect to
the N6 multicast distribution tree related with this IP multicast traffic;
This ensures that the UPF receives the DL multicast traffic.
NOTE 2: The IP multicast related signalling protocol used on N6 (e.g. Sparse
Mode PIM-SM) to be supported over N6 is defined by local policies on the UPF.
2) Add the PDU Session over which the IGMP / MLD request has been received to
the UPF replication tree corresponding to the DL multicast traffic.
\- This does not require any multicast capability (such as \"MBMS\") from the
5G-AN. It can therefore apply for FWA e.g. when the NG-RAN does not support a
multicast capability (such as \"MBMS\" evolutions for 5GS). But this implies
replication of the IP multicast traffic over N3.
The UPF referred to by this solution is the UPF acting as PSA for the PDU
Session.
The solution assumes that UE and 5GC support RFC 4604 [38] on SSM;
The solution considers that the UE (STB) has been configured with the target
IP multicast traffic information (e.g. IP multicast address, source of the
multicast traffic) by means out of 3GPP specifications.
The solution assumes that the UE is not roaming Editor\'s note: HR roaming
would be possible as in HR the IP multicast address(es) that can be used can
be configured by the Home operator on the UE while the IP multicast tree on N6
is under control of the Home operator .
### 6.8.2 Description of the solution
#### 6.8.2.1 PDU Session establishment
In 5G-RG case, the UE (RG) requests a dedicated PDU Session for IPTV service
(dedicated DNN and/or S-NSSAI). The establishment of this PDU Session is
handled per R15 specifications by the AMF. If the RG has no subscription to
IPTV (no subscription to the relevant DNN), the PDU Session establishment
request is rejected.
Any UE IP address allocation mechanism defined as part of existing R15
mechanisms or as part of the conclusions of this TR may be used for a PDU
Session used by IPTV.
For deployments that require the IPTV system to allocate the IP address of the
UE, following mechanism (or a subset of) may be used:
\- Deferred DHCPV4 IP address allocation is requested by the UE and granted by
the network.
\- The SMF/UPF are, for the Network Instance corresponding to the DNN,
configured with a DHCP server belonging to the IPTV subs-system.
\- The SMF may receive within SM subscription data in UDM related with the DNN
being used by IPTV information (under the form of a DHCP option) to add in
DHCP signalling sent by the UE to request an IP Address. In that case the SMF
has this information added in DHCP signalling relayed to the IPTV sub-system
and acts as a DHCP relay (to be able to correlate the DHCP offer from IPTV
server with the PDU Session).
During the establishment of a dedicated PDU Session for IPTV service
(dedicated DNN and/or S-NSSAI) the SMF indicates to the UPF acting as PSA for
the PDU Session that the PDU Session is eligible for IP multicast traffic and
provides over N4 the necessary information to carry out Access Control of
Multicast Channels. This information may correspond.
\- Wither to the Network Instance associated with the N6 interface of the PDU
Session. In this case the UPF may determine the locally provisioned
corresponding IP multicast configuration (Access Control of Multicast Channels
Information) based on this information (Network Instance + indication that the
PDU Session is eligible for IP multicast traffic).
\- - Or to an explicit Access Control of Multicast Channels Information sent
over N4.
#### 6.8.2.2 UP handling (IP multicast)
When the N4 Session is associated with the multicast indicator, the UPF
enforces the multicast feature described below. Otherwise it forwards IGMP /
MLD traffic and IP multicast traffic without any dedicated processing related
with IP Multicast.
NOTE1: The IP multicast configuration can e.g. include Access Control List
related with Source-Specific Multicast (SSM) as well as configuration
parameters defined in clause 8 of [15].
When it receives IGMP / MLD \"signalling\" over the User Plane from the UE,
the UPF (PSA):
\- checks the validity of the request using the Access Control of Multicast
Channels information.
\- The Access Control of Multicast Channels information at the UPF tells for a
target multicast join (identified by an IP Multicast address and possibly a
Source IP address range in case SSM applies) whether the UPF should deny
multicast request, redirect multicast request (redirect to default channel),
or process multicast request;
\- acts as a Multicast Router as defined in [15], [52], [53] and [16]. This
may include following actions.
\- if this is the first IGMP / MLD request the UPF has received about the
target IP multicast traffic : the UPF exchanges N6 signalling such as PIM
(Protocol-Independent Multicast) in order to connect to the N6 multicast
distribution tree related with this IP multicast traffic; This ensures that
the UPF receives the DL multicast traffic.
\- Configuration parameters of the N6 multicast related signalling protocol
are associated by local UPF configuration with the Network Instance of the PDU
Session.
\- the UPF adds the interface corresponding to the UE to list of interfaces
towards which it should replicate DL packets corresponding to the IP multicast
traffic target of IGMP / MLD request.
Editor\'s Note: Having the UPF doing DL multicast traffic replication is
defined at least for the FWA case. Whether and How to adapt the solution to
wireline access including the case of FN-RG will be studied in normative phase
The UPF (PSA) maintains membership for IP multicast traffic as defined in
[15], [52] and [16].
For deployments requiring SSM the UPF (PSA) supports the RFC 4604 [38].
Figure 6.8.2.2-1: UP handling
#### 6.8.2.3 IPTV subsystem configuration of Access Control of Multicast
Channels information
The IPTV subsystem can control Access Control of Multicast Channels based on
mechanism described in this sub-clause;
The IPTV subsystem (acting as an AF) may via API exposed by the NEF associate
a subscription with policy information on Access Control of Multicast Channels
and can modify such policy information.
The NEF may check the authorization rights of the IPTV subsystem to associate
a subscription with Access Control of Multicast Channels policy information.
If the IPTV subsystem request is granted, the NEF updates Policy information
related with the corresponding (UE, DNN, S-NSSAI) on the UDR.
The PCF takes into account such policy information to build PCC rules for the
SMF:
\- At SM Policy Association Establishment;
\- When this policy information has been changed.
When it receives PCC rules or modified PCC rules with Access Control of
Multicast Channels information, the SMF updates the UPF over N4.
The PCF may define a PCRT requesting to be notified when the UE \"joins\" to a
multicast group. This allows to apply pre-view policies where the user is
allowed to view a channel during some time after which it is redirected to a
page where he/she is invited to pay for the content.
Other ways to configure PCF related data in UDR used for Access Control of
Multicast Channels are not excluded but not defined in SA WG2.
### 6.8.3 Impacts on existing Network Functions
1 The UPF need to be able to detect IGMP/MLD traffic and to support
corresponding IP level multicast signalling (like IGMP/MLD and PIM).
2 The UPF needs to enforce DL traffic replication and to maintain membership
for IP multicast traffic.
3 The SMF and N4 are upgraded to indicate that a PDU Session is eligible for
IP multicast traffic and for SMF to be able to provide Access Control of
Multicast Channels information.
The solution does not require capabilities to replicate (multicast) traffic in
the 5G AN but does not optimize N3 resources.
NOTE 1: Even though the solution applies equally to IPV4 and to IPV6,
considering the IPTV current deployments, and in order to limit the amount of
3GPP work in R16 it can be envisaged to limit the solution to IPV4 case.
## 6.8.4 Evaluation
The solution applies to a great variety of IPTV deployments. The definition of
the IPTV infrastructure (architecture, protocol used by the STB to reach this
infrastructure) are not defined by 3GPP. 3GPP specifications focus only on:
\- Setting up the needed PDU Session and ensuring a corresponding IP address
is allocated to the UE (supporting deployments where the IP address is
allocated by the 5GC itself and deployments where the IP address is allocated
by an external server).
\- Handling of IGMP/MLD (and corresponding traffic replication towards the UE)
and of the control on which multicast group the UE can join (and for how
long).
## 6.9 Solution #9 - new IPV6 address allocation mechanisms
### 6.9.1 Overview
This solution addresses KI # 15.
This solution is meant to apply to 5G-RG (connected over FWA and/or via a
Wireline access) and FN-RG collectively called \"UE (RG)\" in this solution;
the IPV6 address allocation mechanisms described in this solution could also
apply to other kind of UE.
5GS Rel15 specifications already supports that IPv4 address allocation and/or
IPv4 parameter configuration via DHCPv4 (according to RFC 2131 [17]) can be
used once the PDU Session is established.
In this solution both for IPV4 and IPV6 cases the UE can get any IP
configuration parameter without relying on PCO (i.e. these parameters can be
retrieved via purely UP based DHCP interactions with the network).
NOTE 1: IPv4 parameter configuration via DHCPv4 (according to RFC 2131 [9])
and IPv6 parameter configuration via Stateless DHCPv6 (according to RFC 3736
[14]) are already supported in R15 specifications.
As some BBF networks use DHCPv6 IA NA and/or PD (Prefix Delegation), the 5GS
needs to supports these capabilities.
NOTE 2: TS 23.401 [24] supports IPv6 Prefix Delegation via DHCPv6.
### 6.9.2 Description of the solution
#### 6.9.2.1 IPv6 Prefix Delegation via DHCPv6
When IPv6 Prefix Delegation (PD) via DHCPv6 applies to a PDU Session, a single
(global) network prefix of a size shorter than the default /64 prefix may be
assigned to the PDU Session and provided to the UE (RG) allowing the UE(RG) to
further allocate /64 prefixes to other device within the customer premises.
The default /64 prefix allocated to the UE (RG) at the PDU Session
establishment may be allocated from this (global) shorter network prefix; the
remaining address space from the network prefix can be delegated to the PDU
Session using prefix delegation according to RFC 3633 [18].
In this case, the address space provided is maintained as an IPv6 address
space pool available to the PDU session for DHCPv6 IPv6 prefix requests with
the exclusion of the default IPv6 prefix that is allocated during the PDU
Session establishment.
The UE (RG) uses DHCPv6 to request additional IPv6 prefixes (i.e. prefixes in
addition to the default prefix) from the network after completing the PDU
Session establishment procedure including the acquisition of the default /64
prefix. The UE acts as a \"Requesting Router\" as described in RFC 3633 [18]
and inserts one or more IA_PD option(s) into a DHCPv6 Solicit message sent
from the UE (RG) to the network in the User Plane. The SMF/UPF acts as the
DHCP server and fulfils the role of a \"Delegating Router\" according to RFC
3633 [18].
While the RG may use DHCP IA_PD to get delegated Prefixes, for the own RG
address (RG WAN interface management) any supported address allocation scheme
may be used e.g. SLAAC or DHCPv6 IA_NA.
The following figure shows the message flow for a PDU Session establishment
(copied from TS 23.502 [3] Figure 4.3.2.2.1-1: \"UE-requested PDU Session
Establishment for non-roaming and roaming with local breakout\"). The changes
to the R15 procedure introduced for the support of the solution are
highlighted in dark red in the figure and are described in the text below the
figure while otherwise the PDU Session Establishment proceeds as described in
R15 specifications.
Figure 6.9.2-1: Impacts of IPv6 Prefix Delegation to TS 23.502 [3] UE-
requested PDU Session Establishment for non-roaming and roaming with local
breakout (Figure 4.3.2.2.1-1)
Step 4: For a subscription allowing Prefix Delegation, the subscription data
provided by the UDM contains the maximum size of the prefix that may be
allocated for the PDU Session.
Step 9: The SMF indicates to the PCF the maximum size of the prefix received
in step 4 together with the individual prefix that has been allocated as part
of the PDU Session establishment procedure.
New step 21: Once the UE has received an IPv6 address, acting as \"Requesting
Router\" the UE may initiate a request for Prefix delegation. The Prefix
Delegation procedure takes place as described in RFC 3633 [18]. If the Prefix
to be provided via Prefix Delegation to the UE includes the /64 Prefix that
was provided at PDU Session establishment, the SMF indicates to the UE that
the /64 prefix is excluded as described in RFC 6603 [57].
NOTE: As an example the SMF provides the UE with the /64 Prefix at PDU Session
establishment and chooses this prefix as part of a /40 that can be delegated
to the UE. If later on the RG(UE) requires a /40 Prefix via Prefix Delegation
procedures, it gets a /40 Prefix with an indication according to RFC 6603 [57]
that excludes the /64 Prefix allocated at PDU Session establishment.
#### 6.9.2.2 IPv6 address allocation via DHCPv6
IPv6 address allocation and/or IPv6 parameter configuration via DHCPv6
(according to RFC 3315 [19]) may be used once the PDU Session is established.
Corresponding exchanges between the UE and the 5GC take place in the User
Plane.
The procedure may apply in case of following PDU Session Types: IPv6, IPv4v6,
Combo Ethernet & IP.
IPv6 Router Advertisement (RA) using the (M) flag, according to RFC 5175 [20]
may be used to force an UE (a RG) to go through DHCPv6 process for IPV6
Address allocation. In that case the IPv6 address of the UE is allocated using
Identity Association for non-temporary addresses (IA_NA) and mechanisms
defined in RFC 3315 [19].
Both RA and DHCPV6 signalling are exchanged between the UE (RG) and the
SMF/UPF over the User Plane.
A /64 prefix may be allocated for the PDU Session at PDU Session
Establishment. In that case /128 address(es) provided to the UE (RG) as part
of DHCP IA_NA procedure are allocated from that /64 prefix. Alternatively,
individual 128-bit address(es) are allocated for the PDU Session, and provided
to the UE (RG) as part of DHCP IA_NA procedure. When a /64 prefix is allocated
for the PDU Session, the SMF may provide the /64 prefix to the PCF instead of
/128 bits address(es). When individual /128 address(es) are allocated, the SMF
provides the /128 bits address(es) to PCF. Whether the SMF allocates a /64
prefix for the PDU Session or individual 128-bit addresses is transparent to
the UE/RG.
Upon reception of DHCPv6 signalling from the UE, the SMF/UPF acts as a DHCPv6
server as seen from the UE. The SMF/UPF may allocate the IP address itself or
use an external server to allocate the IP address. The alternative to apply
may depend on local policies that take into account the (DNN, S-NSSAI) of the
PDU Session but may also depend on policies received from the PCF.
NOTE: The end point for DHCPV6 signalling exchanges with the UE depends on the
deployment and on whether the solution endorsed as part of ETSUN objective 2
supports SMF delegating to the UPF the termination of DHCP signalling
exchanges with the UE.
An RG may send both DHCP options: IA_NA and IA_PD together in a single DHCP
solicit or relay-forward message. An SMF should be able to answer to both
IA_NA and IA_PD; If it is not able, it should process the DHCP IA_NA first.
The UE may issue multiple different IA_NA related DHCP requests within the
same PDU Session.
In this release of the specifications, a PDU Session where DHCP IA_NA applies
cannot benefit of IPV6 multi-homing mechanisms.
The following figure shows the message flow for a PDU Session establishment
(copied from TS 23.502 [3] Figure 4.3.2.2.1-1: \"UE-requested PDU Session
Establishment for non-roaming and roaming with local breakout\"). The changes
to the R15 procedure introduced for the support of the solution are
highlighted in dark red in the figure and are described in the text below the
figure while otherwise the PDU Session Establishment proceeds as described in
R15 specifications.
Figure 6.9.2.2-1: Impacts of IPv6 address allocation via DHCPv6 to TS 23.502
[3] UE-requested PDU Session Establishment for non-roaming and roaming with
local breakout (Figure 4.3.2.2.1-1)
The First uplink Data in the figure above may correspond to a RS (Router
Solicitation) sent by the UE.
The First Downlink Data in the figure above may correspond to a RA (Router
Advertisement) using the (M) flag, according to RFC 5175 [20], to force the UE
(RG) to go through DHCPv6 process for IPV6 Address allocation.
The step 19 of the SLAAC procedure is replaced by DHCPV6 (according to RFC
3315 [19]) exchanges between the UE and the network in order for the UE to
acquire an IPv6 address ad possibly IP(v6) related configuration parameters.
#### 6.9.2.3 General DHCPv6 support
The SMF (/UPF) should support the server and relay function specified in RFC
3315 [19] and RFC which includes:
\- Supporting DHCPv6 inform request for DNS.
\- Supporting messages from LDRA (Lightweight DHCPv6 Relay Agent) further
specified in RFC 6221 [47].
NOTE 1: The SMF (/UPF) needs to be able to handle message from a LDRA agent
which typically resides in the Access Network. A Lightweight DHCPv6 Relay
Agent (LDRA) allows Relay Agent Information to be inserted by an access node
that performs a link-layer bridging (i.e., non-routing) function. An LDRA
resides on the same IPv6 link as the client and a DHCPv6 Relay Agent or
server. Unlike a DHCPv6 Relay Agent specified in RFC 3315 [19], an LDRA does
not implement any IPv6 control functions (e.g. ICMPv6) or have any routing
capability in the node.
\- Supporting the various DHCPv6 options defined in RFC 3315 [19].
NOTE 2: The Level of UPF involvement in DHCP procedures will be defined as
part of ETSUN.
### 6.9.3 Impacts on existing Functions
1\. SMF/UPF need to support DHCPV6 NA and PD.
NOTE 1: The end point for DHCPV6 signalling exchanges with the UE depends the
deployment and on whether the solution endorsed as part of ETSUN objective 2
supports SMF delegating to the UPF the termination of DHCP signalling
exchanges with the UE.
2\. During the life time of the PDU Session the PCF (CHF/LI) may receive
indications (via PCRT) of the allocation of a new Prefix range for a PDU
Session.
NOTE 2: No N4 impact foreseen as TS 29.244 [55] Frame-Routing IE and Framed-
IPv6-Route IEs are alaredy defined in DL PDRs.
## 6.10 Solution #10 - Support of \"combo Ethernet + IP\" service
### 6.10.1 Overview
This solution addresses KI # 15; it relates to BBF SD-420 [26] Key Issue
6:\"Session Management\"
This solution is meant to apply to both 5G-RG (connected over FWA and/or via a
Wireline access) and FN-RG collectively called \"UE\" in this solution.
This solution aims at serving RG working in Bridged and Bridged/Routed mode
(at least for some services), where the \"service edge\" (that in the 5GC
context can be mapped to SMF/UPF) may need to:
\- provide an IP service to the Customer premises devices e.g. allocate
IPv4/v6 address / Prefix to devices behind the UE (RG).
\- map between the IPv4/v6 address / Prefix of a device behind the UE (RG) and
its MAC address.
\- identify each device behind the UE (RG) via the MAC address of the device:
for this purpose Ethernet frames are exchanged between the UE (RG) and the 5GC
so that the network (UPF) is capable to identify traffic from individual
devices in the Customer Premises.
NOTE 1: This is e.g. to apply specific policies related with the terminal
(e.g. parental control or Enhanced home office service where a work laptop
gets bandwidth and prioritization).
This solution is only meant to be used in deployments with RG working in
Bridged and Bridged/Routed mode.
The Ethernet PDU Session Type does not support an IP service over N6. For
example, TS 23.501 [2] states that \"Neither a MAC nor an IP address is
allocated by the 5GC to the UE for a PDU Session\". Furthermore, with the
Ethernet PDU Session the Layer 2 header received from the access side is
copied on the N6 side of the PSA while it is not meant to be copied over N6 in
the case of an IP service provided to RG working in Bridged and Bridged/Routed
mode. In case of Ethernet PDU Session Type DL forwarding is basically done
based on the Destination MAC address of the UE while here DL forwarding is to
be made based on the IP address of the UE ; in case an IP PDU Session type
would be used to support an RG working in Routed mode with no NAT, as many PDU
Sessions as there are devices in the Customer Premises requiring an IP address
would be required.
A dedicated PDU Session Type called \"Combo Ethernet + IP\" is used for that
purpose. It basically supports an access Router in the PSA while an Ethernet
PDU Session supports a bridge in the PSA;
In case of \"combo Ethernet + IP\" PDU Session Type:
1\. Ethernet frames are exchanged between the UE (RG) and the UPF acting as
PSA.
2\. Ethernet frames exchanged between the UE (RG) and the UPF acting as PSA
carry IP traffic (and IP auxiliary protocols: ARP, ND).
3\. An IP service is delivered at N6 where for example IP addresses are
allocated to individual devices behind the UE (RG) (devices in the Customer
Premises). Any User Plane address delivery mechanism may be used to deliver an
IP address to the devices behind the RG i.e. SLACC, DHCPV4 or DHCPV6. The SMF
related subscription data associated with the RG apply to a whole PDU Session
regardless of whether multiple IP addresses are allocated on this PDU Session.
NOTE 2: IP address(es) allocated to devices can correspond to public or to
private addresses.
4\. In the UL direction the UPF acting as PDU Session Anchor (PSA) receives
(as a payload of the GTP-u tunnel coming from the AGF) IP traffic within a
Layer 2 framing; This layer 2 framing below IP is called \"access side layer 2
header\" below. The PSA maps between the IPv4/v6 address / Prefix of a device
behind the UE (RG) and the \" access side layer 2 header\" as follows:
\- in UL the \"access side layer 2 header\" framing coming from a device in
the Customer Premises is removed by the PSA. The UPF keeps track of the
association between an IP address of the UE and the corresponding \" access
side layer 2 header\".
\- in DL the \" access side layer 2 header\" is added by the UPF before
sending the traffic towards a device in the Customer Premises. Necessary MAC
address swapping is enforced by the PSA on the \" access side layer 2 header\"
stored from UL traffic.
The \"access side layer 2 header\" handled by the PSA contains the IEEE 802.3
MAC header possibly augmented by IEEE 802.1q header or by a IEEE 802.1ad
header (also known as « QinQ »).
Editor\'s note: The \"customer layer 2 header\" framing is to be defined by
BBF.NOTE 5: Iit is up to BBF access to determine whether this \"access side
layer 2 header\" includes any VLAN tagging (possibly multiple levels of VLAN
tagging) e.g. VLAN tagging added by the BBF access on top of the UL Ethernet
frames received from the RG. The PSA performs the mapping above regardless of
whether the \" access side layer 2 header\" contains 0, 1 or 2 level of VLAN
tagging.
Editor\'s note: BBF discussions are still on going on the number of levels of
VLAN tagging that the AGF relays to the PSA.
For a Combo Ethernet and IP PDU session type the UE exchanges with the 5GC IP
packets each carried within an Ethernet frame. The 5GC delivers an IP service
to the RG and to devices locally connected to the RG while it is able to
identify traffic of these devices by the MAC address they are using.
NOTE 6: No new traffic filters (PDR or PCC rule or N1 SM QoS related
signalling) need to be defined as traffic filters from the Ethernet PDU
Session Type are reused.
Figure 6.10.1-1: Protocol stack for the combo PDU Session Type
For UL traffic, the Ethernet layer 2 framing depicted in Figure 6.10.1-1 above
is subject of following processing:
\- The RG may add a VLAN header (*) to the traffic received from the devices
in the customer premises.
\- The BBF access may add a VLAN header (**) (e.g. S-tag) to the traffic
received from the RG.
For DL traffic, the Ethernet layer 2 framing depicted in Figure 6.10.1-1 above
is subject of following processing:
\- The BBF access may strip off a VLAN header (**) (e.g. S-tag) to the traffic
received from the network.
\- The RG may strip off a VLAN header (*) to the traffic received from the
network.
In this release of the specification, SSC mode 3, UL CL and IPV6 multihoming
do not apply to a PDU Session of the Combo type.
In this release of the specification, the Combo PDU Session type applies only
to the Wireline access.
A UE may use simultaneously a PDU Session with the \"combo Ethernet + IP\" a
PDU Session type and PDU Session(s) type with another PDU Session type.
A 5G-RG configured to work in Bridged and Bridged/Routed mode requests PDU
Sessions with the PDU Session Type \"combo IP + Ethernet\" or may be
associated in its subscription with this default PDU Session Type.
NOTE 3: This PDU Session Type has many similarities with the Ethernet PDU
Session Type but services described in bullets 3 and 4 above are not supported
by the Ethernet PDU Session Type.
The support of \"combo IP + Ethernet\" PDU Session type assume that multiple
devices served by the PDU Session may request an IP address at any time during
the lifetime of the PDU Session. The release of an IP address to such device
(e.g. when the DHCP lease has expired) does not release the PDU Session.
There is an unique UDM subscription for the RG regardless of the number of
devices in the customer premises that are subject of a specific handling.
When some devices are subject of a specific service, the identity of these
devices (MAC address) and the parameters of their specific service (e.g.
Access restriction for parental control, dedicated QoS) are configured in the
policy data related with the subscription (UDR). Other devices benefit of a
baseline service and do not require to be individually identified in the
policy data related with the subscription (UDR).
### 6.10.2 Description of the solution
The \"Combo Ethernet + IP\" PDU Session Type supports following features:
\- An IP service is delivered at N6 where for example IP addresses are
allocated to individual devices behind the UE (RG) . The same IP address
allocation mechanisms (including deferred IPv4 and DHCPV6 IP address
allocation) are supported than in case of RG supported by the IP PDU Session
Type.
\- The SMF indicates to the PSA that a PDU Session is of \"Combo Ethernet +
IP\" type at the N4 Session Establishment. Based on this the PSA (UPF) acts as
the first hop router of the devices in the customer premises. Especially it
supports the behaviour described in bullet 4 of clause 6.10.1 related with \"
access side layer 2 header\".
\- N4 FAR and PDR are those used for an IP PDU Session Type.
\- The QER is updated for the SMF to be able to control the Priority Code
Point of the VLAN Headers within the \"access side layer 2 header\".
\- When an IP address/prefix has been allocated to the PDU Session the SMF
reports it together with the MAC address of the UE to the PCF and the PCF may
use the MAC address of the UE to derive policies dedicated to a given device.
For a \"Combo Ethernet + IP\" PCC rules (sent to the SMF) need only to refer
to the IP header. No PCF policy differentiation is defined that would use the
VLAN header received by the UPF over a PDU Session.
\- PCF binding using BSF is based on the IP address of the devices. Service
differentiation upon application (AF) request is also possible using the same
mechanisms (e.g. Npcf_authorization service) as in the case of an IP PDU
Session type: the AF provides requests identifying the IP flow of a terminal
it wants to act upon, session binding with the IP address of the terminal
applies as described in clause 6.1.1.2 of the Rel-15 version of TS 23.503 [8]
and the PCF provides corresponding updated PCC rule. The BSF need not to be
aware of \"access side layer 2 header\".
\- There is no authentication of the devices behind the RG that are identified
by their MAC address.
The following figure shows the message flow for a PDU Session establishment
(copied from TS 23.502 [3] Figure 4.3.2.2.1-1: \"UE-requested PDU Session
Establishment for non-roaming and roaming with local breakout\"). The changes
to the R15 procedure introduced for the support of the solution are
highlighted in dark red in the figure and are described in the text below the
figure while otherwise the PDU Session Establishment proceeds as described in
R15 specifications.
Figure 6.10.2-1: impacts of Combo IP + Ethernet PDU Session Type to 23.502 [3]
Figure 4.3.2.2.1-1: UE-requested PDU Session Establishment for non-roaming and
roaming with local breakout
Step 1: The UE (5G RG or in case of FN RG the AGF) may be configured (e.g.
URSP) to request a PDU Session of the Combo IP + Ethernet PDU Session Type.
Other parameters of the PDU Session may be the same than in IP PDU Session
Type (E.g. the PDU Session establishment request may contain PCO asking for a
P-CSCF address, ACS address, etc.).
Step 4: The subscription data retrieved from the UDM may contain Combo IP +
Ethernet PDU Session Type as allowed PDU Session Type for a subscription.
Step 7. The SMF may indicate to the PCF that the PDU Session is of Combo IP +
Ethernet PDU Session Type.\ Per PDU Session policies sent by the PCF may
contain a control on the Maximum Number of IP address to allocate as part of
the PDU Session to devices in the customer premises (MNIP).Step 10a. The N4
session between the SMF and an UPF acting as PSA for the PDU Session may be
associated by the SMF with a Combo IP + Ethernet PDU Session Type; the SMF
controls the UPF to report MAC addresses detected in UL traffic of the PDU
Session.\ If the SMF requests the UPF to forward DHCP/RS (Router Solicitation)
traffic from devices using the PDU Session, the SMF may request the UPF to
report the \"access side layer 2 header\" on which the DHCP/RS has been
received.
Support of ACS
Access to ACS (Autoconfiguration server used in BBF TR 069 procedures) is
supported as for IP or Ethernet PDU Session types (e.g. as described in
solution #20). The UE(RG) is configured with URSP or local policies telling
it:
\- The PDU Session type and/or DNN to use to reach the ACS (so the PDU Session
type may be the \"Combo\" type).
\- Whether to request ACS info via PCO (NAS) or DHCP.
The UE(RG) sends SM signalling for PDU Session establishment and possibly DHCP
requests accordingly.
If the UE(RG) requests ACS information via PCO, the SMF answers with ACS
information via PCO (NAS).
If the UE(RG) requests ACS information via DHCP signalling, the 5GC answers
with ACS information via DHCP signalling.
Figure 6.10.2-2: Allocation of an IP address to a device behind the RG
For Combo PDU Session Type, the SMF requests the UPF to forward DHCP / RS
signalling over N4; the reporting from UPF shall contain the MAC address of
the device.
When during the life time of a PDU Session, an IP address is allocated to a
device supported by a PDU Session established with the Combo IP + Ethernet PDU
Session Type, the following applies:
1) In band UE IP allocation procedure (RS/RA, DHCPv4, DHCPv6). The SMF / UPF
uses policies received in step 7 of Figure 6.10.2-1 (IP index, max number of
IP addresses for the PDU Session) to determine whether to grant an IP address
to the device and if yes to determine the IP pool / allocation method to use.
NOTE : The usage of DHCPV4 signalling to allocate IP address to devices behind
the UE does not require sending dedicated NAS signalling with a request of
deferred IP address allocation. ; it is possible that the IP address allocated
to the RG itself is provided via NAS to the RG while in band IP address
allocation applies for the devices behind the RG.
2) if this corresponds to a PCRT (Policy Control Request Trigger) received
previously from the PCF, the SMF initiates the SM Policy Association
Modification procedure described in TS 23.502 [3] clause 4.16.5.1.
The reception of new policies from the PCF in step 2 may trigger the network
initiated PDU Session modification procedure per TS 23.502 [3] clause 4.3.3
which may include a corresponding N4 session modification procedure to create
or update the corresponding PDR/FAR/QER/URR on the UPF.
### 6.10.3 Impacts on existing functions
The impact on existing network function is the following:
\- SMF / UPF(N4), UDM and PCF (Npcf) need to support a new PDU Session type.
\- Support of Multiple IP address for a PDU session.
\- When the N4 session is associated by the SMF with a Combo IP + Ethernet PDU
Session Type, the UPF enforces the behaviour in bullet 4 of clause 6.10.1.
\- Npcf Policy Request Control Trigger mechanism is upgraded for the SMF to be
able to report the allocation of an IP address to a device behind the UE
together with the MAC address of that device.
\- the PCF may apply policies (possibly related with IP level traffic) related
with the MAC address of a device (as reported by the SMF via a Policy Request
Control Trigger).
\- The CHF and LI may receive an indication of a new IP address having been
allocated to a PDU Session together with the indication of the corresponding
MAC Address.
## 6.11 Solution #11 - Support 5GC-capable UEs via 5G-RG/FN-RG for wireline
access network using N3GPP solutions
### 6.11.0 Overview
This solution is addresses scenarios 3 and 5 (5G-Capable UE behind 5G-RG/FN-
RG) for key issue 9.
The solution is based on combining the solutions for untrusted N3GPP access
(as per Rel-15) and trusted N3GPP access (as per solution #1 in clause 7.1 in
this TR) with solutions for PDU connectivity for 5G-RG/FN-RG accessing over
wireline and FWA access as per solutions 2, 3, 13, 19 in this TR. The solution
allows the RG and W-5GAN to act as untrusted/trusted N3GPP access towards 5GC-
capable UEs behind the RG.
When FN-RG/5G-RG is serving a 5GC-capable UE, the control and user plane
packets of the 5GC-Capable UE is transported using a FN-RG/5G-RG IP PDU
session and then from PSA UPF of that PDU session to an IWF. A single FN-
RG/5G-RG IP PDU session can be used to serve multiple 5GC UEs. The IWF is a
term used in this solution which could include one or both of the N3IWF
function (as per rel 15) and a TNGF (as per solution #1 in clause 7.1) The
Figure below illustrates the overall solution.
Figure 6.11.0-1: Overall solution for UE behind RG
The enhancements to the above-mentioned solutions for trusted/untrusted N3GPP
access and 5G-RG/FN-RG access to 5GC is mainly to ensure that the IWF can be
collocated with the W-5GAN. The UPF for the RG PDU Session can also be
collocated with the W-5GAN, but a solution candidate for collocating UPF with
W-5GAN is already captured in solution #13 and therefore not described here.
NOTE: 5GC-capable UE can simultaneously use NG-RAN and FN-RG/5G-RG access and
if using the same PLMN for both accesses, the same AMF shall be used.
### 6.11.1 General Reference Architecture
Figure 6.11.1-1: Architecture for the 5G-capable UE behind a 5G-RG using
Broadband Wireline access
Figure 6.11.1-2: Architecture for the 5GC-capable UE behind a FN-RG using
Broadband Wireline access
Figure 6.11.1-1 and 6.11.1-2 shows the architectures used in this solution.
The W-5GAN maintains N2 and N3 connections for 5G-RG/FN-RG and IWF maintains
N2/N3 for the 5GC-capable UE. Consequently, the N1 connection from the 5GC-
capable UE is independent from the FN-RG/5G-RG N1 connection.
Maintaining N1/N2/N3 connections for the 5GC-capable UE that are separate from
the N1/N2/N3 connections of the 5G-RG will enable the 5GC-capable UE to keep
the same AMF and UPF at mobility between 3GPP and 5G-RG/FN-RG access if the
AMF/UPF used on 3GPP access is also reachable and usable from the W-5GAN. AMF
change as well as I-UPF insertion/change/removal when moving to 3GPP access
may be needed and is supported as for Rel‑15. Support for session continuity
and that IP services are kept when moving between the accesses can then be
provided by the 5GC-capable UE\'s 5GC nodes.
NOTE: 5G-capable UE will not need to know whether the access point is a FN-
RG/5G-RG or if it is an access point that can be used for normal
trusted/untrusted N3GPP access. For trusted N3GPP access over WiFi, this
implies that the RG can provide the ANQP information described in Solution 5
in clause 7.5.
In case IWF is collocated with W-5GAN, the same serving PLMN will be used for
both the 5G-RG/FN-RG and the 5GC-capable UE and in case the 5GC-capable UE has
a subscription for another PLMN, the 3GPP roaming model and interfaces are
used.
Network slicing can be supported for 5GC-capable UEs via 5G-RG/FN-RG as
described in TS 23.501 [2] clause 5.15 where the W-5GAN will need the similar
network slicing related functionality as 3GPP RAN and N3IWF.
### 6.11.2 Collocated deployment
#### 6.11.2.1 Introduction
The reference architecture in the previous clause shows the general functional
architecture. However, as described in solution #13 there are benefits with
collocated FAGF-U and UPF for the PDU Sessions of 5G-RG/FN-RG. In addition,
there are benefits with collocating also the IWF with the FAGF-U and UPF to
reduce the number of user plane hops. This possibility for colocation is a key
part of this solution and described in this clause.
#### 6.11.2.1 Collocated FAGF-U and 5G-RG UPF
As described in solution #13, a deployment option is to collocate FAGF-U with
UPF. This is possible when the PDU Session of the 5G-RG/FN-RG is established
over wireline access. The figure below illustrates the architecture, where the
RG can connect over either W-5GAN or NG-RAN (only for 5G-RG).
NOTE: The figures shows a FAGF separated into FAGF-C and FAGF-U. However, such
split is dependent on whether BBF defines split FAGF-C/FAGF-U.
Figure 6.11.2.1-1. Architecture with collocated FAGF-U and FN-RG/5G-RG UPF
#### 6.11.2.2 Collocated FAGF-U, UPF and IWF
To further reduce the UP hops, and to enable coordinated handling of both RG
and UE traffic in the W-5GAN, also the IWF can be collocated, as shown in the
figure below. This is applicable when the 5G-RG/FN-RG connects via wireline
access. The scenario where the 5GC-capable UE connects to IWF when the
5G-RG/FN-RG is using FWA is not standardized but may be enabled by deployment.
NOTE: The figures shows a FAGF separated into FAGF-C and FAGF-U. However, such
split is dependent on whether BBF defines split FAGF-C/FAGF-U.
Figure 6.11.2.2-1. Architecture with collocated FAGF-U, UPF and IWF
In the collocated case, when the FN-RG/5G-RG uses wireline access, the W-5GAN
and the IWF will be enabled to support QoS flows for a 5GC-capable UE using
5G-RG/FN-RG access, if the W-5GAN and the UWF can coordinate the QoS
profile(s) received over N2 to IWF for 3GPP UE with the QoS profile(s)
received over N2 to FAGF-C for the 5G-RG/FN-RG. For example, a QoS profile
which is setup for 5GCcapable UE can result in that the W-5GAN setup dedicated
resources between 5G-RG/FN-RG and the W-5GAN. This requires that the W-5GAN
can receive and coordinate requests for PDU Session QoS resources over
multiple N2 connections to different logical functions (FAGF-C and
IWF),corresponding to 5G-RG as well as 5GC-capable UEs behind the RG, and
perform e.g. admission control and coordination of the QoS requests associated
to the 5G-RG as well as 5GC-capable UEs behind the RG.
Editor\'s Note: How to support QoS for 5GC Capable UE shall be studied in
normative phase.
In the collocated case, when the FN-RG/5G-RG uses wireline access, the W-5GAN
and IWF can be enabled to provide wireline location information (line
identity) over N2 for the 5GC-capable UE, which could be especially useful in
emergency cases.
In the collocated case the AMF and PCF serving the 5GC-capable UE can use Line
ID e.g. for applying differentiated services (based on 5GC-capable UE
subscription data) As an example, the Line ID can be sent to PCF as ULI to be
used as input parameter to decide what PCC rules to apply for the 5GC-capable
UE.
Editor\'s Note: How to differentiate 5GC Capable UEs belonging to guests and
family in the Home LAN shall be studied in normative phase.
NOTE: The 5GC-capable UE traffic is carried in same transport between
5G-RG/FN-RG and W-5GAN as an IP PDU session. The interfaces between FN-
RG/5G-RG and W-5GAN to support a 5GC-capable UE is within BBF responsibility.
#### 6.11.2.3 Additional architecture aspects
The interfaces used by the 5GC-capable UE to access a FN-RG/5G-RG will
leverage the untrusted/trusted N3GPP interfaces. The untrusted N3GPP interface
is defined in 3GPP release 15. The trusted N3GPP interfaces are studied in
this report. When these interfaces are not sufficient to accomplish the
requirements for scenario 3 and 5, enhancements on top of the untrusted and
trusted solutions are described below.
The same interface between 5GC-capable UE and IWF (as described in clauses
6.11.3 and 6.11.4) is used independent of access used by the 5G-RG so for the
5GC-capable UE there is no difference if 5G-RG is using wireline or NG-RAN
access. Furthermore, the 5GC-capable UE will not be affected if 5G-RG changes
access. Note that even though the figure above shows a 5G-RG connected to both
NG-RAN and wireline access, it is not necessary that \"simultaneous\" hybrid
access is applied, the 5G-RG can use either wireline access or NG-RAN.
NOTE: Support for 5GC capable UEs connecting via 5G-RG when RG is connecting
via NG-RAN could be optional to implement it in the normative phase of the
first release of WWC.
### 6.11.3 WLAN association options
There are two different scenarios supported within this solution:
1\. 5GC-capable UE behind 5G-RG using Trusted N3GPP (IEEE 802.1x [33] with
3GPP credentials).
2\. 5GC-capable UE behind FN-RG/5G-RG using Untrusted N3GPP (IKEv2 and IPSec
based access procedures).
These two scenarios cover the common WLAN deployment models of using IEEE
802.1x [33]/EAPOL for access control as well as WLANs using open access or a
local access control based on private keys.
A 5GC-capable UE can select between option 1 and 2 above based on UE
implementation and using e.g. the means described below. (UE selection between
trusted and untrusted N3GPP access methods is however a generic issue and not
specific for this solution):
\- A 5GC-capable UE can select to use 802.1x with 3GPP credentials based on:
\- ANQP Information sent by the 5G-RG e.g., by using ANQP with the information
element \"3GPP cellular network\".
\- Configuration in the 5GC-capable UE to use 802.1x for a certain WLAN SSID.
\- A 5GC-capable UE can select to use IKEv2 and IPsec based access procedures
based on successful result of a normal N3IWF selection procedure.
### 6.11.3 5GC-capable UE behind 5G-RG using Trusted Non-3GPP access network
#### 6.11.3.1 General
This sub-solution is applicable when IEEE 802.1x [33] (EAP over LAN) and 3GPP
credentials are used to associate with the WLAN. In this option, the solution
for trusted N3GPP is used but with the additional property that the service is
offered via a wireline access and a 5G-RG. FN-RG is not applicable for this
case since changes may be needed in the RG (FN-RG is not supporting the role
of EAP Authenticator). This option can typically be used in case a service
provider offers services via wireline access to all the subscribers of the
service provider.
Figure 6.11.3.1-1. Mapping of 5GC-capable UE behind 5G-RG scenario to Trusted
N3GPP architecture
As shown in figure 6.11.3.1-1, the combination of 5G-RG, W-5GAN, UPF and IWF
will act as a trusted N3GPP access network from the 5GC-capable UE and 5GC
perspective. Interface between 5G-RG and IWF will be defined by BBF. SA WG3
will specify all security details, including whether NULL encryption is
sufficient and what type of security protection is generally required for NAS
transport and User Plane transport between the UE and the TNGF. Solution #1
described in clause 7.1 is used as baseline but it is expected that any
solution selected for trusted N3GPP can be re-used/enhanced for this scenario
as well.
The EAP-5G messages need to be forwarded between the 5G-RG and the IWF. The
5G-RG may include a AAA client for the AAA protocol between 5G-RG (TNAP) and
IWF (TNGF) or may forward the EAP-5G message using some other means to an
entity that acts as AAA client. The AAA traffic is carried in a PDU session of
the 5G-RG (same PDU session as is used for IKE/IPsec traffic from the 5GC-
capable UE). These different scenarios could be supported by BBF (with a AAA
client in the 5G-RG):
1\. 5G-RG in IP routed mode with IP PDU session established by 5G-RG (5G-RG
has NAT):
\- 5G-RG gets IP address for the PDU Session from SMF/UPF.
\- 5GC-capable UE gets IP address from 5G-RG.
\- DN for PDU Session of the RG must have IP connectivity to IWF.
2\. 5G-RG in IP routed mode with Ethernet PDU session established by 5G-RG
(5G-RG has NAT):
\- 5G-RG gets IP address over Ethernet PDU session which is terminated in DN
and the first router and DHCP server is in the DN.
\- 5GC-capable UE gets IP address from 5G-RG.
\- DN for PDU Session must have connectivity to IWF (and DHCP server and
router if AAA protocol use IP transport).
3\. 5G-RG in L2 bridge mode with an Ethernet PDU session (5G-RG has no NAT):
\- If AAA protocol use IP transport: 5G-RG gets an IP address over Ethernet
PDU session which is terminated in DN and the first router and DHCP is in the
DN.
\- 5GC-capable UE gets IP address over Ethernet PDU session which is
terminated in DN and the first router and DHCP server is in DN.
DN for PDU Session must have connectivity to IWF (and DHCP server and router
if AAA protocol use IP transport).
The 5G-RG needs to receive the TNGF contact info (IWF IP address or MAC
address) using one of the following mechanisms (to be specified by BBF):
1\. Parameter in FCP during 5G-RG registration.
2\. Parameter in EAP-5G during 5G-RG authentication.
3\. By using TR-69 mechanism.
#### 6.11.3.2 Registration procedure
The registration procedure in clause 7.1.3.3 (solution #1) will be used where
5G-RG act as TNAP and IWF act as TNGF. In similar manner the procedures
proposed in clause 7.1.3.4.2 (steps 1-15) on how to complete the registration
can be followed.
For the collocated FAGF-U, UPF and IWF case, when the 5G-RG/FN-RG is connected
via wireline access, the IWF may provide line identity as location information
for the 5GC-capable UE to the AMF.
Thei Interface between 5G-RG and W-5GAN will be defined by BBF.
#### 6.11.3.3 PDU session establishment procedure
The procedures in clause 7.1.3.4.2 (steps 20-24) will be followed where 5G-RG
act as TNAP and IWF act as TNGF.
For the collocated FAGF-U, UPF and IWF case, the IWF together with the W-5GAN
can setup QoS reservations for the 5G-RG when IWF receives the N2 PDU session
request from AMF.
#### 6.11.3.3 User plane stacks
As proposed in clauses 7.1.3.4.2, interface between 5GC-capable UE and IWF
(acting as TNGF-UP) will use IP/ESP/GRE/PDU, data.
### 6.11.4 5GC-capable UE behind FN-RG/5G-RG using Untrusted Non-3GPP Access
network
#### 6.11.4.1 General
In the second sub-solution, the WLAN association is assumed to have been
carried out before the 5GC-capable UE does 5GC registration. How that is done
is outside the scope of 3GPP. Services are only offered to 5GC-capable UEs
that can both 1) associate to the WLAN of the 5G-RG/FN-RG and 2) register to
the 5GC via the W-5GAN as described below.
This sub-solution re-uses procedures defined for untrusted N3GPP solution in
Rel-15 but put into a context of trusted W-5GAN. This enables supporting a
5GC-capable UE behind a legacy FN-RG at the same time as allowing the W-5GAN
and IWF to act as a trusted N3GPP access network, supporting e.g. QoS
enforcement and other features available in trusted N3GPP access.
For the collocated FAGF-U, UPF and IWF case the combination of these
functional roles can in contrast to standalone N3IWF provision the access
network specifically for the 5G capable UEs. For example, QoS flows could be
setup in the access network to carry voice traffic for the 5GC capable UE.
Differences compared to Rel-15 untrusted non-3GPP access procedures are
described in clause 6.11.5 below.
#### 6.11.4.2 Registration
The 5GC registration will follow the untrusted N3GPP access registration
procedure as defined in TS 23.502 [3] clause 4.12.2.2. To support the
collocated FAGF-U, UPF and IWF case:
\- During N3IWF selection, the UE shall select an IKE/IPsec endpoint (i.e. IP
address where to send the IKE signalling) in the collocated node. This can be
solved existing Rel-15 N3IWF selection procedure by having IP source address
based DNS policies in the DNS server to respond with the a collocated N3IWF.
\- The N2 message with the NAS registration request shall be adapted so it is
supported to include fixed access location information (Line ID).
#### 6.11.4.3 PDU session establishment procedure and user plane transport
The PDU session establishment procedure for trusted access networks is using
the UE Requested PDU Session Establishment via Untrusted non-3GPP Access as
baseline, see clause 4.12.5 of TS 23.502 [3].
For the collocated FAGF-U, UPF and IWF case, the access network/IWF can
coordinate the QoS profiles received in the N2 PDU session request with the
QoS profiles assigned for the 5G-RG/FN-RG in the AGF.
#### 6.11.4.3 User plane protocol stacks
For user-plane transport: IP/ESP/GRE/PDU data (as defined for Non-3GPP in TS
23.501 [2] (Release 15)).
### 6.11.5 Impacts on Existing Functions
The untrusted and trusted N3GPP procedures are re-used as is with the
following additions:
\- TNGF/N3IWF can provide wireline location information (line ID) over N2 for
trusted and collocated untrusted case (applicable when 5G-RG/FN-RG is
connected via wireline access).
\- The 5G-RG will include a AAA client for trusted case.
\- TNGF IP address shall be provided to 5G-RG during registration from AGF.
\- For the collocated FAGF-U, UPF and IWF case, the access network/IWF shall
be able to coordinate the QoS profiles received in the N2 PDU session request
with the QoS profiles assigned for the 5G-RG/FN-RG in the AGF. The interface
between F-AGF-U, UPF and IWF to accomplish this does not have to be specified
but the specifications should not prevent to support it.
NOTE: For the untrusted collocated case, the DNS server resolving N3IWF
address may e.g. use source UE IP address and DNS policy to provide a local
IWF.
### 6.11.6 Solution evaluation
The solution is re-using untrusted and trusted N3GPP solutions to support UE
behind 5G-RG and UE behind FN-RG scenarios. Apart from minor impacts to the
possible content of existing information elements there is no impact to the
procedures.
The 5GC-capable UEs will be identifiable by the 5GC with 3GPP credentials.
When the 5G-RG uses wireline access and the IWF is collocated with W-5GAN, the
W-5GAN can be enabled to support QoS flows for a 5GC-capable UE. Furthermore,
for the same deployment scenario, the W-5GAN and IWF can be enabled to provide
wireline location information (line identity) over N2 for the 5GC-capable UE.
It will be possible to support handover/service continuity for the 5GC capable
UE between wireline and 3GPP access. Also, solutions that are defined for
ATSSS can be re-used by the 5GC-capable UE for this scenario.
In scenarios where location information (Line id) is available in the IWF
(N3IWF/TNGF), the solution allows for applying different services (e.g.
policies, charging etc) based on that information and subscription information
for the 5GC-capable UE.
## 6.12 Solution #12 3GPP UE behind a 5G-RG Register to 5GS and Establish PDU
Session
### 6.12.1 General Description
This solution is based on Scenario 3, a 3GPP UE behind a 5G-RG connects to
5GS. Principles mentioned in Scenario 3, (1) a 3GPP UE shall use 3GPP
procedures specified in current specifications (i.e. TS 23.501 [2] and TS
23.502 [3]) and need to minimize impacts on current 3GPP reference points
(e.g., N1, N2 and N3). Also, (2) the W-5GAN shall be enabled to support QoS
treatment of QoS flows for a 3GPP UE using 5G-RG access which implies the
W-5GAN has the capability to handle the Control Plane (CP) and User Plane (UP)
transport traffic from 3GPP UE behind a 5G-RG. Therefore, the following clause
proposes the procedure how 3GPP UE behind a 5G-RG to register to 5GS and to
establish PDU Session based on the principles.
### 6.12.2 Registration procedure for a 3GPP UE behind a 5G-RG
For simplicity, it assumes that 5G-RG has registered to 5GS via W-5GAN, i.e.,
5G-RG has gotten a 5G-GUTI and an IP address/Prefix address allocated by 5GS.
Since 5G-RG needs to enable the N1 signalling and UP transport traffic between
3GPP UE and 5GS. However, to minimize the impact on current 5G procedures, a
3GPP UE can connect to 5GS by discovering a 5G-RG. A 5G-RG provides connection
ability to a 3GPP UE, and this UE can establish relay connection with this
5G-RG. How 3GPP UE discovers 5G-RG is out of the scope of this SID.
In Scenario 3, a 5G-RG connected to W-5GAN provides connection to 3GPP UE. A
3GPP UE can setup a Layer 2 (L2) connection (e.g., IPsec IKEv2) between W-5GAN
via 5G-RG. In this manner, this UE can trigger 5G related procedures by using
5G-RG to forward the N1 signalling or UP transport traffic to W-5GAN.
Figure 6.12.2-1: 3GPP UE\'s Registration Procedure via 5G-RG
1\. 5G-RG has registered to 5GS via W-5GAN.
The corresponding parameters have been allocated by serving AMF such as
5G-GUTI. If 5G-RG triggered PDU Session Establishment procedure as specified
in TS 23.502 [3], clause 4.3.2, the IP addresses/Prefixes is allocated to this
5G-RG.
2\. 3GPP UE discovers 5G-RG similar to Step 1 specified in TS 23.502 [3],
clause 4.12.2.2, e.g., 3GPP UE and 5G-RG can use any non-3GPP authentication
to set up the connection. After authentication, 3GPP UE can be allocated an IP
address by 5G-RG.
Editor\'s note: How 3GPP UE knows 5G-RG is in the same PLMN is FFS
3\. 3GPP UE discovers W-5GAN with protocol similar to discover N3IWF as
specify in TS 23.501 [2], clause 6.3.62.
To enable 3GPP UE discover W-5GAN successfully, some assumptions can beare
made. (1) IPsec endpoint shall implement in W-5GAN, (2) Protocol between 3GPP
UE and W-5GAN shall use IPsec protocol with IKE security association (SA), and
(3) W-5GAN has the abilityfunctionality similar to DNS server in 5WWC
architecture, e.g., by translating the query of FQDN sent by 3GPP UE..
The selection mechanism similar to N3IWF selection can be adopted in this
scenario. 3GPP UE can select the IPsec endpoint by querying FQDN.
Due to 5G-RG is under the coverage of the W-5GAN, W-5GAN can receive the query
of FQDN sent by 3GPP UE. Therefore, W-5GAN can reply the FQDN query from 3GPP
UE by transmitting an addresses (e.g. IP addresses) back to 3GPP UE. Then 3GPP
UE can start the security association with W-5GAN by using IKE SA
authentication between 3GPP UE and W-5GAN. After security association is
complete, 3GPP UE can start NAS message transmission with W-5GAN.
NOTE: W-5GAN establishes N2 and N3 interfaces for 3GPP UE and 5G-RG
separately.
4\. 5G-RG forwards the IP traffic from 3GPP UE to W-5GAN.
5\. When receiving the traffic from 5G-RG, W-5GAN needs to determine the
traffic from 5G-RG or from 3GPP UE behind this 5G-RG.
Editor\'s note: How to determine traffic from 5G-RG or from 3GPP in W-5GAN is
FFS.
6\. If the traffic is from 3GPP UE, W-5GAN executes registration procedures as
specific in TS 23.502 [3], clause 4.2.2.2 and 5G-RG keep forwarding the IP
traffic for the 3GPP UE. Otherwise, the traffic is from 5G-RG, W-5GAN executes
the corresponding procedures for 5G-RG.
### 6.12.3 PDU Session Establishment Procedure for a 3GPP UE behind a 5G-RG
After the 3GPP UE behind 5G-RG has registered to 5GS as described above. 3GPP
UE can request a PDU session establishment. Since 5G-RG can forward the IP
traffic from 3GPP UE to W-5GAN 3GPP UE can directly use the PDU session
establishment procedure in TS 23.502 [3], clause 4.3.2 to request a PDU
session.
Figure 6.12.3-1: 3GPP UE\'s PDU Session Establishment Procedure via 5G-RG
1\. 3GPP UE has registered to 5GS.
2\. 5G-RG forwards IP traffic from 3GPP UE to W-5G-AN.
3\. 3GPP UE can directly trigger PDU Session establishment procedure as
specified in TS 23.502 [3], clause 4.3.2.
4\. Once the PDU session establishment is accepted, 3GPP UE starts to transmit
UP traffic via 5G-RG.
## 6.13 Solution #13 - Co-location of UPF and FAGF or FAGF-U
### 6.13.1 Overview
This solution will apply to 5G-RG or FN-RG when it connects to the 5GC via
W-5GAN - either as the only access network or as part of hybrid access.
The key part of the solution is to enable that the user plane part of the
fixed access GW (FAGF-U) is co-located with the UPF. The co-location may apply
only for a single PDU session; other PDU sessions may or may not use the same
PSA UPF and thus, may use other non-colocated UPFs as PSA.
The co-location removes the requirement for N3 interface to be implemented
between the FAGF-U and UPF, but it is left for implementation whether and how
the tunnelling is eliminated or replaced by a different type of packet
forwarding; the N3 tunnel setup related signalling is kept unchanged.
The co-location of FAGF(-U) and UPF is achieved during PDU session setup; due
to lack of mobility on the W-5GAN access, it will be retained during to the
lifetime of the PDU session.
The following possible FAGF deployment options are supported in this solution:
\- Monolithic FAGF: The control and user plane are not separated, i.e. the UP
part is directly connected to / known by the CP part of FAGF. The terms FAGF-C
and FAGF-U are used to refer to the functions of the monolithic FAGF that
serve the N2 and N3 interfaces.
\- FAGF with separated control plane and user plane functions: In this case,
an FAGF-C may be physically separated from the FAGF-U. . There are two cases
to consider:
\- 1:1 relation between subscriber line and FAGF-U. In this case it is assumed
that the FAGF-C is aware of the FAGF-U identity for any 5G-RG. At a certain
point of time, the 5G-RG is connected to a single FAGF-U. The FAGF-U will not
change during a PDU session - if it needs to be changed (e.g. for failover
cases), the PDU session will have to be re-established.
\- 1:n relation between subscriber line and FAGF-U. In this case it is assumed
that the FAGF-C is aware of a set of FAGF-U Identities or one or more FAGF-U
Pool ID(s) that represent the set of FAGF-U(s) that may be selected for the
5G-RG. The actual FAGF-U for a PDU Session is selected when the PDU Session is
established. Once selected for a PDU Session, the FAGF-U will not change
during a PDU session - if it needs to be changed (e.g. for failover cases),
the PDU session will have to be re-established.
Editor\'s note: The FAGF deployment options are to be defined by Broadband
Forum. The above terminology will be aligned with BBF definitions.
The co-location of the FAGF-U and UPF shall be enabled by 5GC signalling and
node selection improvements, as detailed below.
A) In case a 5G-RG registers to 5GC via the W-5GAN, without or before using
NG-RAN:
\- The FAGF-C adds the identity/identities of the FAGF-U(s) of FAGF Pool(s) to
all uplink NAS signalling messages received from the 5G-RG. The AMF relays the
FAGF-U identity(s) / FAGF-U Pool identity(s) to the SMF, as part of session
management signalling.
\- During the PDU session setup, the SMF can use the FAGF-U information
received to select a UPF instance that can be co-located with a FAGF-U that
can serve the 5G-RG. This may be assisted by NRF or based on local
configuration and policies in the SMF.
\- The IE carrying the FAGF-U Identity(s) / FAGF-U Pool Identity(s) shall be
generic (e.g. an Octet string), allowing e.g. a SDO such as BBF and 3GPP or
operator to define the format of the content of the IE.
\- When the co-located UP resource reservation is successful, the session
setup procedure is implemented as defined in solution 3 of this document.
Information about the selected UPF is provided to the FAGF-C, allowing the
FAGF-C to select an appropriate FAGF-U. However, omitting or replacing the N3
interface will be subject to implementation.
\- Should the co-location not succeed (e.g. the SMF cannot identify or connect
the relevant UPF instance , or FAGF-C cannot select a corresponding FAGF-U
instance), the existing procedures for non-co-located FAGF/UPF shall be
followed. Selection of FAGF-U and UPF in close proximity may still be
possible.
B) For 5G-RG with hybrid access, which established PDU session via the W-5GAN
with co-located FAGF-U and UPF and adds NG-RAN access subsequently:
\- The SMF shall select the same PSA UPF that is in use for the PDU session.
\- The SMF will not be able to re-select the UPF due to mobility.
If NRF is used by the SMF for UPF selection, the FAGF-U information will be
stored as part of the UPF NF profile information. The FAGF co-location
information shall be included when registering the NF profile in the NRF (by
OAM or by UPF).
The reference architecture for the solution is depicted in figure 6.13.1-1.
Figure 6.13.1-1: Intended reference architecture for co-located FAGF-U and UPF
### 6.13.2 Description of the solution
#### 6.13.2.1 PDU session management for fixed access
The PDU session setup procedure in a non-roaming environment, supporting the
co-location of UPF with FAGF-U is presented on figure 6.13.2-1.
Figure 6.13.2-1: PDU session setup procedure supporting the FAGF-U and UPF co-
location
The following pre-requisites apply:
\- Registering UPF information:
\- The UPF NF profile may be registered in the NRF (by OAM or UPF).
\- For this solution, the UPF NF profile Information shall be extended by the
list of co-located FAGF-Us. It shall be possible to include the FAGF-U
identity information for all co-located F-AGFs and/or FAGF-U Pool ID(s).
NOTE 1: This step is optional, as using the NRF for UPF selection is optional.
However, if NRF is used for the UPF selection, the inclusion of the FAGF-U
information is mandatory, in order to support this solution.
NOTE 2: A given FAGF-U may be co-located with one or more UPFs, i.e. a given
FAGF-U identity may be registered with one or more UPF instances.
\- Establishing NAS transport. This functionality is defined by BBF.
The PDU session setup procedure involves the following steps.
1\. The 5G-RG sends PDU Session Establishment Request to the FAGF-C using the
NAS transport. If the F-AGF has separate CP and UP elements and the FAGF-C
controls multiple FAGF-U instances and there is a 1:1 mapping between the
subscriber line (Line ID) and a FAGF-U instance, the FAGF-C identifies that
FAGF-U instance. If the F-AGF has separate CP and UP elements and the FAGF-C
controls multiple FAGF-U instances and there is a 1:N mapping between the
subscriber line (Line ID) and FAGF-U instances that may serve the subscriber
line, the FAGF-C does not select FAGF-U instance at this point, but it
identifies the pool of FAGF-Us that can be co-located.
NOTE 3: The details for FAGF-U selection will be defined by BBF.
The FAGF-C shall encapsulate the NAS request into an UPLINK NAS TRANSPORT
message on N2 and forward it to the AMF. For this solution, the N2 interface
shall be extended with a new parameter FAGF-U Information and the FAGF-C
supporting the solution shall include this parameter in all UPLINK NAS
TRANSPORT message. The FAGF-U information may contain FAGF-U identity(s) of
one or more specific FAGF-U instance(s) or FAGF-U pool identity(s)
representing set(s) of FAGF-U instances.
2\. The AMF performs SMF selection. This step is same as in clause 4.3.2.2.1
of TS 23.502 [3].
3\. The AMF de-capsulates the NAS message and forwards the N1 SM container
that includes the PDU Session Establishment Request. For this solution, the
Nsmf_PDUSession_CreateSMContext Request shall be extended with the new
parameter FAGF-U Information and the AMF shall include this parameter
transparently, as received from the FAGF-C in step1c.
4\. The steps defined in TS 23.502 [3], clause 4.3.2.2.1 for SMF
registration/subscription data retrieval etc are executed.
5\. If the SMF uses NRF for discovering UPF information, this step is
applicable here. As defined in the pre-requisites, the SMF will receive here
the information about co-located F-AGFs for each UPF from NRF (if used).
6\. The SMF performs UPF selection either based on the information received
from the NRF or based on its local configuration. If the SMF received FAGF-U
information in step3, it shall search for a match in the UPF Provisioning
Information / the included FAGF-U list.
NOTE 4: The solution allows multiple matches in the UPFs; in that case the
selection of a single UPF is left for implementation. Any of the UPF selected
will ensure that the user plane is optimized via co-location, i.e. N3
tunnelling is not needed; it is replaced by internal signalling in the
relevant UPF/FAGF-U node.
7\. The remaining steps of the PDU session establishment as described in
clause 4.3.2.2.1 of TS 23.502 [3] are executed. If the UPF selection was based
on FAGF-U pool identity, the FAGF-C shall select the FAGF-U based on the
selected UPF/the N3 tunnel information.
NOTE 5: While the signalling among the nodes is not changed compared to the
non-co-located case, the result of the procedure is different: the N3 tunnel
is formally established between the FAGF-U and UPF parts of a single physical
or virtual node. This node will recognize that the remote end point is in
itself and will not use the N3 tunnel.
#### 6.13.2.1 PDU session management for hybrid access
For a PDU session that has been setup via the W-5GAN access, and is extended
to a multi-access session by adding 3GPP access, as defined in TR 23.793 [4],
the SMF shall keep using the existing UPF. The procedure defined in clause
6.2.3.1 of TR 23.793 [4] are applicable. The SMF shall modify the N4 session,
to establish N3 tunnel between the NG-RAN and the co-located FAGF-U/UPF, as
shown on figure 6.2.3-1, for UPF1.
Limitation: For a PDU session that has been setup using the 3GPP access and is
extended to a multi-access session by adding W-5GAN access, the solution does
not provide co-location of the FAGF-U and UPF. The existing UPF shall be used
and an N3 tunnel shall be established between the FAGF-U and the UPF. However,
even if the PDU Session Anchor UPF is not collocated in this case, depending
on deployment it may still be possible to select a UPF collocated / close to
FAGF-U to act as UL-CL/BP for breaking out traffic locally.
### 6.13.3 Impacts on existing Functions
The solution may be used for supporting either monolithic or split CP/UP
deployment options.
The following 5GC nodes are impacted:
\- The AMF shall support receiving the FAGF UP information parameter on N2
interface and forward it to SMF, in the Nsmf_PDUSession_CreateSMContext
Request.
NOTE: The AMF may forward this information with other requests carrying N1 SM
container, but this is not required by the current solution.
\- The UPF and NRF shall support the extension of the UPF Provisioning
Information with the information of co-located FAGF-Us (FAGF-U IDs or FAGF-U
Pool IDs).
\- The SMF shall support:
\- Receiving the FAGF-U information in the Nsmf_PDUSession_CreateSMContext
Request.
\- Receiving co-located FAGF-U as part of the UPF Provisioning Information.
\- Perform UPF selection by matching the FAGF-U information received from the
AMF by the UPF Provisioning Information.
The impacts detailed above are similar for the monolithic and split FAGF
deployments, but the nature of the parameters sent over N2 / Nsmf signalling
and stored for UPF provisioning information will be different: for monolithic
architecture only single AGF-U instance is relevant.
## 6.14 Solution #14 - Registration restriction support
This is the solution to Key issue #13.
NOTE: LADN is not applicable in this solution.
### 6.14.1 Description
Currently the Service area restriction mechanism specified in TS 23.501 [2]
and TS 23.502 [3] addresses the restriction for the UE to initiate Service
Request or SM signalling to obtain user services (both in CM-IDLE and in CM-
CONNECTED states), but the UE is registered in the network, so this mechanism
does not fulfil the scope. The Mobility Restriction mechanism based on
Forbidden Area under a given RAT enables to not be permitted to initiate any
communication with the network for this PLMN based on subscription. The
current granularity of Forbidden area based on TA is too wide in respect the
need to enforce the restriction of the usage to a small area, such the house
or the office. So in this solution we define a procedure based on Registration
Restriction.
Registration Restrictions is the mechanism to perform management of Mobile
Restriction for WWC.
Registration Restrictions for 5WWC defines areas in which the 5G-RG can or
cannot register to the 5GC as follows:
\- WWC Allowed Area: WWC Allowed Area is the area where the 5G-RG is allowed
to register to the 5GC based on subscription.
\- WWC Non-Allowed Area: WWC Non-Allowed Area in an area where the 5G-RG is
not allowed to register to the 5GC based on subscription.
NOTE: The WWC Allowed Area and WWC Non-Allowed Area are defined per Access
type, i.e. 3GPP for the case of 5G-RG connected via NG RAN and W-5GAN for the
case of 5G-RG connected via W-5GAN.
For the architecture of Figure 4.2.2.1-1, Figure 4.2.2.3-3 , Figure 4.2.2.4-1,
Figure 4.2.2.7-1 and Figure 4.2.2.8-1 in clause 4.2.2, 5G-RG is connected to
the Broadband Wireline network. A Registration Restriction may contain
Location Information in wireline access network, for example one or more Line
ID including the \"circuit ID\" and the \"remote ID\" defined in RFC 3046
[14].
For the architecture of Figure 4.2.2.1-3, Figure 4.2.2.3-3, and Figure
4.2.2.4-2 in clause 4.2.2, 5G-RG is connected to the NG RAN. A Registration
Restriction may contain Location Information in wireless access network, for
example one or more Cell ID.
For the architecture of Figure 4.2.2.1-2, Figure 4.2.2.3-4, Figure 4.2.2.4-3,
Figure 4.2.2.5-2 and Figure 4.2.2.10-2 in clause 4.2.2, HA 5G-RG is connected
to the NG RAN and wireline access network simultaneously. The Registration
Restriction may contain both Location Information in wireless access network
and Location Information in wireline access network. HA 5G-RG is allowed to
register to the 5GC only when HA 5G-RG is allowed for both Location
Information in wireless access network and Location Information in wireline
access network. The solution can be inferred via an example scenario that the
HA 5G-RG is in the user\'s neighbour\'s house (assuming the 5G-RG is not
allowed to registered in the user\'s neighbour\'s house) and the user\'s
neighbour\'s house is in the same cell with the user\'s house (assuming the
5G-RG is allowed to registered in this cell). Since this HA 5G-RG is in the
user\'s neighbour\'s house, it is obvious should not be allowed to register to
the 5GC. So, based on this example scenario, the solution above is proposed.
The 5G-RG\'s subscription data in the UDM includes a Registration Restriction
which may contain either WWC Allowed or WWC Non-Allowed Areas specified by
using explicit Location Information (Line ID or when 5G-RG is connected to the
Broadband Wireline network, or Cell ID when 5G-RG is connected to the NG RAN)
and/or other geographical information (e.g., longitude/latitude, zip code,
etc). The geographical information used to specify WWC allowed or WWC non-
allowed area will be mapped to Location Information (Line ID or when 5G-RG is
connected to the Broadband Wireline network, Cell ID when 5G-RG is connected
to the NG RAN).
The UDM stores the Registration Restrictions of a 5G-RG as part of the UE\'s
subscription data. The PCF in the serving network may (e.g. 5G-RG to varying
conditions such as UE\'s location, application in use, time and date) further
adjust Registration Restrictions of a UE, either by expanding an WWC allowed
area or by reducing a WWC non-allowed area. The UDM and the PCF may update the
Registration Restrictions of a 5G-RG at any time.
During registration, if the Registration Restrictions of the 5G-RG is not
present in the AMF, the AMF fetches from the UDM the Registration Restrictions
of the 5G-RG that may be further adjusted by the PCF. The serving AMF shall
enforce the Registration Restrictions of a UE.
The AMF shall send the information of Registration Restrictions to 5G-RG via
NG RAN during Registration Procedure or UE Configuration Update Procedure as
specified in TS 23.502 [3].
When the 5G-RG is located in the WWC Non-Allowed Area of the Registration
Restriction which is received from the network, it does not initiate
Registration Request, Service Request, and PDU Session Management Procedure.
The 5G-RG stores both Registration Restrictions and Forbidden Areas
Restrictions.
Editor\'s note: whether the existing Mobility Restrictions solution in R15 is
applicable is FFS.
Editor\'s note: For FWA scenario, how to handle the mobility of the 5G-RG are
FFS.
### 6.14.2 Procedure
Editor\'s note: The impacts to the procedures, e.g. Registration Procedure,
are FFS.
#### 6.14.2.1 Registration procedure
The Registration procedure described in TS 23.502 [3] clause 4.2.2.2.2 is
followed with the following differences:
1\. [Optional] In step 16, if the AMF notifies the Registration Restrictions
(e.g. 5G-RG location) to the PCF for adjustment or if the PCF updates the
Registration Restriction of the 5G-RG itself due to some conditions (e.g.
application in use, date and time), then the PCF shall provide the updated
Registration Restriction to the AMF.
2\. In step 22, the AMF sends a Registration Accept message to the 5G-RG
indicating that the Registration Request has been accepted. Registration
Restriction is included in case registration restriction applies for the
5G-RG.
#### 6.14.2.2 UE configuration update procedure
The UE Configuration Update procedure for access and mobility management
related parameters as described in TS 23.502 [3] clause 4.2.4.2 is followed
with the following differences:
1\. In step 1, the AMF sends UE Configuration Update command containing one or
more UE parameters including the Registration Restriction to the 5G-RG.
The UE Configuration Update procedure for transparent UE policy delivery as
described in TS 23.502 [3] clause 4.2.4.3 is followed with the following
differences:
1\. In step 1a/1b the AMF receives Registration Restriction as part of Access
and mobility related information or the UE Policy container from the PCF.
### 6.14.3 Solution Evaluation
Editor\'s note: The solution evaluation is FFS.
## 6.15 Solution #15 - General architecture for wireless and cable wireline
convergence
This solution provides the following architectures.
\- Figure 6.15-1 shows the architecture for 5GS with DOCSIS Wireline Access
Network, 5G-CRG and devices not supporting N1 connected behind the 5G-CRG.
\- Figure 6.15-2 shows the architecture for 5GS with DOCSIS Wireline Access
Network, 5G-CRG and 3GPP UE connected behind the 5G-CRG.
\- Figure 6.15-3 shows the architecture for 5GS with DOCSIS Wireline Access
Network, FN-CRG and W-5CGAN.
Figure 6.15-1: Non-roaming architecture for 5GS with Wireline Access Network,
with 5G-CRG and devices not support N1 connected behind 5G-CRG, and with N1,
N2, and N3
NOTE 1: The reference point DOCSIS between the 5G-CRG and the W-5GCAN in
Figure 6.15-1 is defined by CableLabs DOCSIS MULPI [13] and is outside the
scope of 3GPP.
Figure 6.15-2: Non-roaming architecture for 5GS with Wireline Access Network,
with 5G-CRG and 3GPP devices connected behind 5G-CRG, and with N1, N2, and N3
NOTE 2: The reference point DOCSIS between the 5G-CRG and the W-5GCAN in Fig
6.15-2 is defined by CableLabs DOCSIS MULPI [13] and is outside the scope of
3GPP.
{width="4.863194444444445in" height="2.714583333333333in"}
Figure 6.15-3: Non-roaming architecture for 5GS with Wireline Access Network,
with FN-CRG and W-5CGAN with N1, N2, and N3
NOTE 3: The reference point DOCSIS between the FN-CRG and the W-5GCAN in Fig
6.15-3 is defined by CableLabs DOCSIS MULPI [13] and is outside the scope of
3GPP.
## 6.16 Solution #16- Subscription control for the Support of a range of IP
address/Prefixes in a PDU Session
### 6.16.1 Overview
This solution addresses KI # 4 (SMF subscription data) and # 15 (SM support).
This solution is meant to apply to 5G-RG (connected over FWA and/or via a
Wireline access) and/or to FN RG called collectively \"UE (RG)\" in this
solution; the IP address allocation mechanisms described in this solution
could also apply to other kind of UE.
Some deployments (e.g. for corporate access) may require to associate one or
more ranges of IPv4 address / IPv6 Prefixes to a PDU Session (the PDU session
is associated with one or more \'subnets\'). These ranges of IPv4 address /
IPv6 Prefixes correspond to subnets reachable via the UE(RG) and that should
from DL packet forwarding perspective be associated with the PDU Session.
The actual ranges of IPv4 address / IPv6 Prefixes may be defined in the
subscription data (received by SMF from UDM) or may be provided to the SMF by
the DN-AAA server as part of PDU Session Establishment
authentication/authorization by a DN-AAA server (as defined in TS 23.501 [2]
clause 5.6.6).
The IPv4 address / IPv6 Prefix allocated to the UE as part of the PDU Session
establishment (e.g. delivered in NAS PDU Session Establishment Accept) may
belong to one of the ranges (static IPv4 address / IPv6 Prefix provided by the
UDM in Session Management Subscription data) or may be dynamically allocated.
In the latter case the IPv4 address / IPv6 Prefix allocated to the UE as part
of the PDU Session establishment and does not correspond to any ranges of IPv4
address / IPv6 Prefix associated with the PDU Session.
### 6.16.2 Description of the solution
N10 subscription data is modified as described in italics in the table below:
Table 6.16.2-1: N10 subscription data
* * *
Session Management Subscription data (data needed for PDU GPSI List List of
the GPSI (Generic Public Subscription Identifier) used _both inside and
outside of the 3GPP system_ to address a 3GPP subscription. Session
Establishment) Internal Group ID-list List of the subscribed internal group(s)
that the UE belongs to. Session Management Subscription data contains one or
more S-NSSAI level subscription data:  
S-NSSAI Indicates the value of the S-NSSAI. Subscribed DNN list List of the
subscribed DNNs for the S-NSSAI (NOTE 1). For each DNN in S-NSSAI level
subscription data:  
UE Address Indicates the subscribed static IP address(es) for the IPv4 or IPv6
or IPv4v6 type PDU Sessions accessing the DNN, S-NSSAI. Frame (IPV6) Route(s)
Set of Frame (IPV6) Route information that each refers to a range of IPv4
address / IPv6 Prefix to associate with a PDU Session established on this
(DNN, S-NSSAI) Allowed PDU Session Types Indicates the allowed PDU Session
Types (IPv4, IPv6, IPv4v6, Ethernet, and Unstructured) for the DNN, S-NSSAI.
Default PDU Session Type Indicates the default PDU Session Type for the DNN,
S-NSSAI. Allowed SSC modes Indicates the allowed SSC modes for the DNN,
S-NSSAI. Default SSC mode Indicate the default SSC mode for the DNN, S-NSSAI.
5GS Subscribed QoS profile The QoS Flow level QoS parameter values (5QI and
ARP) for the DNN, S-NSSAI (see clause 5.7.2.7 of TS 23.501 [2]). Charging
Characteristics This information is defined in TS 32.240 [39]; it may e.g.
contain information on how to contact the Charging Function. This information,
when provided shall override any corresponding predefined information at the
SMF Subscribed-Session-AMBR The maximum aggregated uplink and downlink MBRs to
be shared across all Non-GBR QoS Flows in each PDU Session, which are
established for the DNN, S-NSSAI. Static IP address/prefix Indicate the static
IP address/prefix for the DNN, S-NSSAI. User Plane Security Policy Indicates
the security policy for integrity protection and encryption for the user
plane.
* * *
NOTE: Frame (IPV6) Route(s) information will be defined by 3GPP (CT) while the
corresponding concept relate to RFC 2865 [30], and RFC 3162 [31].
The Subscribed-Session-AMBR and User Plane Security Policy apply to all
traffic of the PDU Session regardless of the Frame (IPV6) Route(s) associated
to the PDU Session.
When as part of PDU Session Establishment authentication/authorization by a
DN-AAA server (TS 23.502 [3] Figure 4.3.2.3-1) the DN-AAA server confirms the
successful authentication/authorization of a PDU Session, the DN-AAA server
may also provide one or more Frame (IPV6) Route(s) to apply to the PDU
Session. In that case the SMF cross checks the validity of the Frame (IPV6)
Route(s) received from the DN-AAA server wrt local policies associated with
the (DNN, S-NSSAI).
It is up to the subscription management (Management of subscription data)
and/or to the DN-AAA server to ensure that PDU Sessions of 2 UE are not
associated with overlapping Frame (IPV6) Route(s).
The SMF ensures that an UE does not simultaneously establish multiple PDU
Session to a (DNN, S-NSSAI) when the corresponding subscription is associated
with Frame (IPV6) Route(s),
NOTE: This is to ensure that the UPF does not receive conflicting forwarding
rules on multiple N4 Sessions associated with the same Frame (IPV6) Route(s),
The SMF notifies the PCF with the Frame (IPV6) Route(s) being associated with
the PDU Session; PCF policies may associate different Frame (IPV6) Route(s)
with different QoS and Charging levels.
The SMF provides the Frame (IPV6) Route(s) to the UPF in order that DL (N6)
traffic targeting any IP address/Prefix identified by the Frame (IPV6)
Route(s) can be:
\- properly forwarded to the relevant PDU Session.
\- provided proper QoS.
\- monitored.
This reuses existing N4 mechanisms (usage of PDR, FAR, URR and QER). It is
nevertheless expected that the definition of PDR will be updated to support
the association of a PDR with one or multiple Frame (IPV6) Route(s).
The Frame (IPV6) Route(s) associated with a PDU Session is stored in CDR and
provides as part of LI information associated with the PDU Session.
The following figure shows the message flow for a PDU Session establishment
(copied from TS 23.502 [3] Figure 4.3.2.2.1-1: \"UE-requested PDU Session
Establishment for non-roaming and roaming with local breakout\"). The changes
to the Rel-15 procedure introduced for the support of the solution are
highlighted in dark red in the figure and are described in the text below the
figure while otherwise the PDU Session Establishment proceeds as described in
R15 specifications.
Figure 6.16.2-1: impacts of Frame Route to TS 23.502 [3] Figure 4.3.2.2.1-1:
UE-requested PDU Session Establishment for non-roaming and roaming with local
breakout
In step 4, Session Management Subscription data that the SMF retrieves using
Nudm_SDM_Get (SUPI, Session Management Subscription data, DNN, S-NSSAI) may
contain Frame Route information.
In step 6, in case the SMF triggers the PDU Session establishment
authentication/authorization as described in TS 23.502 [3] clause 4.3.2.3,
when in step 4 of TS 23.502 [3] Figure 4.3.2.3-1 the DN-AAA server confirms
the successful authentication/authorization of the PDU Session, the DN-AAA
server may indicate Frame Route information in the authorization information
it provides to the SMF.
NOTE 1: This aspect is already supported by Rel15 specifications.
If in step 7b, the SMF performs an SM Policy Association Establishment
procedure as defined in TS 23.502 [3] clause 4.16.4, the SMF may provide Frame
Route information to the PCF; the PCF may take this Frame Route information
into account for its policy decisions.
NOTE 2: As within an IP Packet Filter Set (defined in TS 23.501 [2] clause
5.7.6.2) an IP address or Prefix may be combined with a prefix mask, PCC rules
do not need to be modified.
Step 10 a: When provides Packet detection, enforcement and reporting rules to
be installed on the UPF for this PDU Session, Packet Detection Rules may
contain Frame Route information.
NOTE 3: both UL and DL Packet Detection Rules may contain Frame Route
information. UL Packet Detection Rules may contain Frame Route information to
ensure proper charging or specific forwarding of the corresponding traffic.
NOTE 4: This aspect is already supported by Rel15 specifications.
### 6.16.3 Impacts on existing Functions
The following impacts have been identified:
\- UDM/UDR subscription data (sent to SMF) is updated to support Frame (IPV6)
Route(s).
\- SMF / CHF / Nchf impacts to associate Frame (IPV6) Route(s) with charging
data. . The SMF notifies the CHF with the Frame (IPV6) Route(s) being
associated with the PDU Session.
\- SMF / PCF impacts to associate Frame (IPV6) Route(s) with a SM Policy
Association. The SMF notifies the PCF with the Frame (IPV6) Route(s) being
associated with the PDU Session.
No N4 impact is expected to associate Frame (IPV6) Route(s) with DL traffic
forwarding.
## 6.17 Solution #17 - Support of IPTV using unicast
### 6.17.1 Overview
This solution addresses KI #11 and will be usable for both 5G-RG and FN-RG.
Same solution can also be used in case 5G-RG connect via NG-RAN access.
Figure 6.17.1-1: Network functions involved in media distribution/IPTV over
5GC wireline access
The solution leverage on media delivery via PDU Session and IP unicast
transport between the FN-RG/5G-RG and the IPTV system (e.g. Edge Media
Delivery function). The solution can be used for both linear IPTV and on-
demand IPTV.
As an alternative to deliver linear TV via 5GC and unicast on N6, it is also
possible for a deployment to continue using legacy linear/IPTV systems
available in the Wireline network (based on TR-101) where separate VLAN tags
are used in the access network to carry the linear/IPTV multicast traffic. The
wireline access network can separate out such traffic to the legacy
linear/IPTV systems instead of handling such traffic via the 5GC. Also, in
many systems a separate AAA is used for access and authorization control. In
this case this particular media traffic and e.g. enforcement of IPTV
subscriptions such as channel control etc is not handled by 5GC.
### 6.17.2 Description of the solution
The solution leverage on media delivery via PDU Sessions and IP unicast
transport between the FN-RG/5G-RG and the IPTV system. The solution may e.g.
be based on a system described in TR 26.891 [32] and the FN-RG/5G-RG may use
HTTPS to request media from the Edge Media Delivery Node.
In this solution unicast is used on N6 and UPF is not required to support
replication of multicast traffic. How media is distributed \"above\" the Edge
Media Delivery function, e.g. whether IP multicast is used or not, is out of
scope of this solution and specific to the IPTV system. In case of linear TV
with multicast delivery, the Edge Media Delivery function is mapping the IPTV
service to unicast on N6.
Editor\'s note: Additional description of the solution is FFS.
Editor\'s note: Impact on STB and IPTV system to support media delivery of
linear TV via unicast between the RG and edge media delivery function is FFS
### 6.17.3 Impacts on existing Network Functions
Editor\'s note: Impact to 5GS is FFS.
## 6.18 Solution#18 Mobility Restrictions to support W-5GAN use cases
### 6.18.1 Description
This solution applies to key issue #13.
#### 6.18.1.1 Overall description
This solution is based on the Rel-15 Mobility Restriction features (Service
Area Restrictions and Forbidden Area restrictions).
The existing features for Service Area Restrictions and Forbidden Area can be
re-used also for 5WWC, with enhancements to better cater for 5WWC deployments
and use cases.
#### 6.18.1.2 Service Area Restrictions
The current Service Area restrictions feature allows the operator to define
areas in which the RG may or may not initiate communication with the network.
An Allowed Area may be defined, in which the RG is permitted to initiate
communication with the network. Alternatively, a Non-Allowed Area can be
defined in which an RG is not allowed to initiate Service Request or SM
signalling to obtain user service.
When in a Non-Allowed Area (or outside an Allowed Area), the RG is allowed to
register but not receive any services (except emergency services).
The solution is re-using the Service Area Restrictions in Rel-15 with the
following enhancements:
\- Type of location information in the Allowed Area and Non-Allowed Area: The
current Allowed / Non-Allowed Area is based on lists of Tracking Area(s). The
Allowed Area may also be limited by a maximum allowed number of tracking areas
which can be suitable e.g. for cases where the exact location of the RG is not
known beforehand but it is desired to limit the mobility of the RG. This type
of location information is suitable for the case when a 5G-RG is connected via
NG-RAN. However, when a 5G-RG is connected over wireline access some other
location ID such as Line ID is required. An Allowed / Non-Allowed Area
containing Line ID(s) is however only managed in the network and not sent to
the UE (as the UE is not aware of the Line ID).
#### 6.18.1.3 Forbidden Area
The Forbidden Area mechanism described in TS 23.501 [2] is a feature where the
UE, when inside a Forbidden Area, is based on subscription not permitted to
initiate any communication with the network for this PLMN. The UE is thus not
even allowed to Register to the network when inside a Forbidden Area.
The solution is re-using the Forbidden Area solution in Rel-15 with the
following enhancements:
\- Type of location information in the Forbidden Area: The current Forbidden
Area is based on forbidden Tracking Area(s). This type of location information
is suitable for the case when a 5G-RG is connected via NG-RAN access. However,
when a 5G-RG is connected over wireline access some other location ID such as
Line ID is required.
\- Encoding of Forbidden Area: In the current Rel-15 solution, the Forbidden
Area is provided from UDM to AMF as a list of forbidden TAs. However, with
5WWC use cases it may be that the forbidden area is large and the 5G-RG is
only allowed to register in a small area, e.g. the subscriber\'s home and
possible some additional locations. The encoding of Forbidden Area from UDM to
AMF should thus be enhanced to allow an efficient encoding for the case all
TAs except a few TAs are forbidden (\"white list\" instead of \"black list\").
Also, the Handover Restriction List sent from AMF to RAN would need similar
capabilities.
#### 6.18.1.4 Aspects that are re-used
The solution proposes that Service Area Restrictions and Forbidden Area
restrictions can be applied mostly as is to 5WWC use cases. Below some
specific topics are discussed, including motivation for how it is applied to
5WWC use cases.
\- Granularity of Forbidden Area and Allowed / Non-Allowed Areas: For NG-RAN,
the granularity is currently based on TA, e.g. for Fixed Wireless Access (FWA)
use cases, and this solution maintains that granularity.
\- Creation of the forbidden area list in the UE (5G-RG) for the Forbidden
Area feature: According to the NAS specification (TS 24.501 [42]) the UE
builds the list of forbidden TAs dynamically based on registration rejects
with certain cause codes (e.g., \"tracking area not allowed\"). It is not
proposed to change this principle.
\- Erasing the forbidden area list and Allowed / Non-Allowed Areas in the UE
(5G-RG): According to the NAS specification (TS 24.501 [42]) the UE shall
erase the list of forbidden TAs as well as Allowed / Non-Allowed Areas when
the UE is switched off, the UICC containing the USIM is removed, and
periodically (with a period in the range 12 to 24 hours). For a 5G-RG it is
reasonable that the areas are erased e.g. at power off and UICC change, in
order for the UE to update the list e.g. in case subscription has changed
(e.g. if the user brings the RG to a friend\'s house while at the same time
upgrading the subscription to allow a new location).
### 6.18.2 Impacts on Existing Functions
The Registration and mobility procedures are re-used as is. The only impact is
the enhancements of certain information elements as described above. In
particular:
For Service Area Restrictions applied to WWC use cases:
\- To supBport wireline access, the type of location information in the
Allowed Area and Non-Allowed Area IEs stored in UDM and provided to AMF is
enhanced to support also Allowed Area and Non-Allowed Area to contain Line
ID(s). Also the PCF and corresponding interactions with AMF are enhanced to
handle Service Area Restrictions containing Line ID(s).
\- AMF enhanced to enforce Service Area restrictions based on Line ID when
5G-RG is using wireline access.
NOTE: Since Allowed Area and Non-Allowed Area is not provided to the UE/5G-RG
there is no impact to the NAS protocol.
For Forbidden Area applied to WWC use cases:
\- To support wireline access, the type of location information in the
Forbidden Area IEs stored in UDM and provided to AMF is enhanced to support
also Allowed Area and Non-Allowed Area to contain Line ID(s). The AMF is
enhanced to enforce Forbidden Area based on Line ID when 5G-RG is using
wireline access.
\- Encoding of Forbidden Area sent from UDM to AMF is enhanced to allow also
\"white list\". For NG-RAN access, Handover Restriction List sent from AMF to
RAN is enhanced to allow also \"white list\".
### 6.18.4 Solution Evaluation
The solution is re-using mobility restriction defined in Rel-15 (Service Area
Restrictions and Forbidden Areas). Apart from minor impacts to the possible
content of existing information elements there is no impact to the procedures.
The solution does not define a separate area restriction solution just for
5WWC use cases and is thus in line with the goal to have common core
functionality for multiple accesses. It thus allows a common handling of
mobility restrictions across different usage scenarios (e.g. wireline-wireless
convergence, FWA, MBB, etc.).
Particular aspects for the case the RG connects via wireline access:
The solution enables use of Rel-15 mobility restriction features also when UE
connects via wireline access.
Particular aspects for the case the RG connects via NG-RAN access:
\- For the case of NG-RAN access, the solution re-uses Forbidden Area and
Allowed / Non-Allowed Areas based on a list of Tracking Areas (for the case
the RG is connected via NG-RAN). There are several benefits with keeping the
granularity at TA level:
\- It minimizes impact on Rel-15 systems as Rel-15 mobility restriction can
largely be re-used.
\- Avoids RAN impacts (Having a more fine-grained area e.g. a granularity at
Cell ID level to limit a 5G-RG to be used in one or a few cells, will also
have RAN impact as it would need to be provided in the Handover Restriction
List and RAN would need to study whether such increased granularity is
feasible).
> A drawback with TA level granularity is that TAs may be big. However, also
> cells may be big, ranging between macro cells with 1-20 km radius to high
> frequency small cells with e.g. 200m radius. A cell-level area definition
> would thus anyway not fulfil the wish to limit the RG to be used in one
> specific household in residential areas (multi-apartment buildings adds
> further challenges to this). Furthermore, it may also not be possible to
> limit an area to a single cell as even a stationary UE/RG may handover
> between cells due to dynamic radio conditions. In practice a cell-level
> based area may therefore need to contain multiple cells. A TA may contain
> e.g. 5-20 cells (which is common for EPS, not clear whether it will be
> common also for 5GS). Therefore, it seems that there is no fundamental
> improvement reached by using cell-level areas, only a potential reduction to
> a somewhat smaller area which does anyway not limit the usage of the RG to a
> single household. Also, if required, operators may configure smaller TAs in
> certain areas. The use of three octet TACs allows a larger number of TAs in
> 5GS compared to EPS.
>
> In conclusion, both cell-level and TA-level areas would restrict usage to a
> certain city or part of city. In order to be able to limit usage of a FWA RG
> to a single household, other techniques than cell level restriction,
> allowing more exact positioning, would be needed (e.g. using UE location
> positioning) but these are not part of this solution.
## 6.19 Solution #19 - Support of FWA
This solution intends to provide a complete solution for the scenarios of
5G-RG connected only via NG RAN defines in scenario #1 figure 4.2.2..1-3
addressing all relevant KI.
This solution does not address the Hybrid Access scenario and the scenario of
5GC capable UE connected behind a 5G-RG, while the scenario of device Non 5GC
Capable connected behind the UE (e.g. a PC or a tablet) or a 5GC capable UE
not being visible by 5GC, i.e. not using its N1 NAS, for example connect only
via WLAN in NSWO as today, is supported.
The architecture applicable to this solution is define in solution #1 Figure
6.1-3 and Figure 6.1-4.
For a 5G-RG connected via only NG-RAN the specifications defined in TS 23.501
[2], TS 23.502 [3] and TS 23.503 [8] applies with the following modification:
\- the UE is replaced with the 5G-RG.
\- The support of interworking with EPC is not applicable for a 5G-RG.
\- The Non-3GPP requirements defined in TS 23.501 [2] and procedure defined in
TS 23.502 [3] clause 4.12 are not applicable to the 5G-RG connected via NG
RAN.
NOTE 1: The FWA does not apply to the FN-RG since the RG shall support NG RAN
features (e.g. NG RRC, 5GC NAS, etc) which are not supported by FN-RG by
definition.
The solution does not identify any additional modifications a part replacing
UE with 5G-RG required in the following specification:
\- Registration Management specification defined in TS 23.501 [2] clause
5.3.2.2
\- CM-IDLE state and CM-CONNECTED state defined in TS 23.501 [2] clause 5.3.2
\- 3GPP access specific aspects defined in TS 23.501 [2] clause 5.4
\- Session and service continuity defined in TS 23.501 [2] clause 5.6.5
\- Registration management procedures defined in TS 23.502 [3] clause 4.2.2.
The SUPI of the 5G-RG is based on IMSI as defined in TS 23.501 [2] clause
5.9.2. Based on SUPI, the UDM/ARPF shall choose the authentication method
based on the subscription data, as described in TS 33.501 [25].
NOTE 3: the 5G-RG is assumed to be equipped with UICC where the IMSI resides.
\- Service Request procedures defined in TS 23.502 [3] clause 4.2.3
\- Session Management procedures at least for IP PDU session and Ethernet PDU
session defined in TS 23.502 [3] clause 4.3
NOTE 3: during the lifetime of the session, the 5G-RG located at the board of
a cell due to the change of condition (e.g. due to propagation condition) may
change the cell at which is connected to with some of the neighbourhood cells.
NOTE 4: the SSC mode is not only related to UE mobility condition, but it is
also related to changes of serving UPF, e.g. when AF influences UPF selection.
\- The solution for 5G-RG configuration and management in FWA is described in
Solution #20 as described in clause 6.20.
Editor\'s note: whether Slice management defined in TS 23.501 [2] clause 15
requires modification or improvement to support FWA scenario is FFS.
\- The roaming scenario, i.e. the capability to connect a 5G-RG via NG RAN in
a VPLMN does not present specific issue from the current specification and it
can be supported without any modification of current specification. However
the requirement to support or to not support this scenario may be related to
national regulation and/or business relationship between VPLMN and HPLMN. In
fact roaming scenario can be seen from a BBF point of view as a sort of
wholesale or unbundling scenario. Consequently whether can be supported or
whether can be restricted is a BBF discussion. From 3GPP point of view not
support roaming scenario implies that roaming agreement is not signed; or in
case of operators deploying both mobile terminal and 5G-RG, the restriction
for 5G-RG is to attach only to HPLMN network, which does not require any
changes to current specification.
Editor\'s note: whether roaming scenario is applicable to FWA is should be
discussed in BBF.
Editor\'s note: Whether and how BBF wholesale model or 3GPP roaming model is
applied to FWA is should be discussed in BBF.
Editor\'s note: How to identify a 5G-RG as a different category device is for
further study.
Editor\'s note: Whether QoS model requires modification is FFS per KI#8.
Editor\'s note: Whether Policy model requires modification is FFS per KI#7.
Editor\'s note: Whether Registration or service restriction requires
modification is FFS per KI#56.19.1 Solution evaluation.
The solution above does not identify any impact on current TS 23.501 [2], TS
23.502 [3] and TS 23.503 [8] specifications.
## 6.20 Solution #20 - Solution for 5G-RG configuration and management
### 6.20.1 Overview
This solution addresses KI # 7.
This solution is meant to apply to 5G-RG connected over FWA described in
solution #1 figure 6.1-3 and figure 6.1-4, via a Wireline access described in
solution #1 figure 6.1-1 and in figure 6.1-2 and in hybrid access in solution
#1 figure 6.1-5 and figure 6.1-6.
The URSP policy is used as specified in TS 23.503 [8], for example for the
association of application and PDU session, slices, etc. Once the 5G-RG
connects to 5GC, the PCF shall provide the URSP policy, but it should neither
provide NSWO indication in the URSP nor any ANDSP policies to a 5G-RG. The
5G-RG shall ignore any such information if received from the 5GC.
The URSP may indicate for the application of Auto-Configuration and Dynamic
Service Provisioning (ACS). which PDU session type and/or DNN is to be used.
The 5G-RG decides based on URSP policy or configuration whether to use a
dedicated PDU session or a common PDU session to establish the connection with
the ACS.
Once the 5G-RG connects to 5GC, the 5G-RG shall establish a dedicated PDU
session for interaction with the Auto-Configuration Server (ACS) to support
the functionalities as described in BBF TR-069 [12].
The ACS URL may be provided to the 5G-RG during the PDU session establishment
procedure at least one of the following methods:
\- via DHCP interaction as defined in BBF TR-069 clause 3.1 if the 5G-RG sends
DHCP signaling indicating a request for ACS information.
\- via PCO (protocol Configuration Option) sent in N1 SM message if the 5G-RG
has asked to be provided with ACS information via PCO.
The ACS URL can be associated to the 5G-RG subscription and not to a specific
DNN and so can be provided to any PDU session establish by the given 5G-RG.
The ACS URL can be provided during the DHCP process when SMF is not the DHCP
server (e.g. in case of Ethernet PDU session), but in this case the whole
process is transparent to the 5GC and the 5GC is not aware of the ACS
information.
The 5G-RG may be pre-configured with an ACS URL.
The 5G-RG shall consider the ACS information received with the following
descending priority order:
1) ACS information received during the DHCP process.
2) ACS information received during the PDU session establishment procedure
from SMF PCO.
3) The pre-configured ACS information in the 5G-RG.
Editor\'s note: The ACS may also send QoS object to the RG including QoS
policy (L2 and L3 marking, see details in BBF TR-198) to some specific flows.
Whether the 5G-RG receives both the QoS object from the ACS and the QoS rule
from the 5GC, and the coordination between them are FFS.
### 6.20.2 Procedures
#### 6.20.2.1 ACS Address configuration procedure
Figure 6.20.2.2-1 ACS Address configuration procedure
The ACS Address configuration procedure enables the 3^rd^ party AF to
configure the ACS address (URL or IP address) to the 5GC.
1\. The 3rd party AF provides the ACS configuration information, e.g. the ACS
address, in the Nnef_ParameterProvision_Update Request to the NEF as in step 1
of TS 23.502 [3] figure 4.15.6.2-1.
2\. As in step 2 of TS 23.502 [3] figure 4.15.6.2-1 where the provisioned data
is the ACS configuration information.
3\. As in step 4 of TS 23.502 [3] figure 4.15.6.2-1 where the provisioned data
is the ACS configuration information.
4\. As in step 5 of TS 23.502 [3] figure 4.15.6.2-1.
5\. As in step 6 of TS 23.502 [3] figure 4.15.6.2-1.
Steps 7 and 8 of TS 23.502 [3] figure 4.15.6.2-1 are not applicable to this
case.
#### 6.20.2.2 PDU Session Establishment for purpose of BBF TR-069 support
The PDU session establishment procedure is using the UE Requested PDU Session
Establishment via 3GPP Access as baseline, see clause 4.3.2.2.1 in TS 23.502
[3]. The differences are:
\- UE is replaced by 5G-RG.
\- In FWA scenario the (R)AN is replaced by NG RAN access network, in wireline
scenario the (R)AN is replaced by W-5GAN and in HA scenario the (R)AN
represents the selected access where to established the PDU session.
\- Step1. When the 5G-RG sends the PDU session establishment request with
Request Type indicating \"Initial Request\", it includes the DNN which is
corresponding to the ACS. The UE may send in PCO a request to provide ACS
information. The UE indicates the PDU Session type per local configuration or
per URSP policies. In case of IP PDU Session type, the UE may indicate a
request to get the IP address of the PDU Session via DHCP by sending a
corresponding indication in PCO (as per Rel-15 procedure) and may include the
ACS information request in DHCP as defined in BBF TR-069 clause 3.
\- Step 4. The UDM may send the ACS information to the SMF together with the
subscription data based on the DNN.
\- Step 10. The SMF includes the ACS information in the N1 SM information
(PCO) if it has been requested by the UE and if it is available at the SMF (if
received in Step4). If the RG gets the ACS information via DHCP signaling,
this information will be provided later on to the RG(step 19)..
\- Step 11-12. The AMF forwards the NAS SM received from SMF per Rel-15
specification.
\- - Step 19: if the 5G-RG requested to receive ACS information via DHCP , the
5G-RG send a request in DHCPv4 option 55 or DHCP Option Request ( option 6)
and receiving from DHCP server in Vendor Specific Information (DHCPv4 option
43/ DHCPv4 Option 125/ DHCPv6 option 17) as specified in TR-096 clause3,1 for
ACS Discovery.
\- The 5G-RG uses the selected ACS URL to establish connection with the ACS.
Note 1: How the NAS message is transferred between the 5G-RG and the AN is not
discussed in this solution and will be decided in other solutions for other
key issue.
Note 2: For the scenario of 5G-RG connected via W-5GAN the possible
differences in PDU session procedures are not described.
### 6.20.3 Solution Evaluation
1) ACS configuration includes many kinds of configuration and management
functions. It is different from the policy received from the PCF, e.g. URSP,
QoS rule. Therefore, the configuration received from the ACS and policy
received from the PCF are both needed.
2) The solution also enables the possibility to request the ACS information in
DHCP exchange, or via PCO (NAS SM signaling)..
3) In this solution, the 5GC is extended to receive ACS information
configuration from the 3rd party AF and then send the ACS URL to the UE during
PDU session establishment procedure.
If the wireless and wireline operator are different, e.g. FWA scenario, the
wireline operator can configure ACS information via the NEF to the 5GC of the
wireless operator.
4) The URSP may indicate which PDU Session Type and DNN to usefor the
application of Auto-Configuration and Dynamic Service Provisioning (ACS) . But
this does not require URSP structure change.
## 6.21 Solution #21 - Collocation of UPF and W-5GCAN User Plane Function
### 6.21.1 Overview
It is assumed that the W-5GCAN is composed of two functional elements:
(i) one or more Wireline Access Node functions; and
(ii) a W-5GCAN CP and UP which exposes the N2/N3 interfaces towards the 5GC.
How the W-5GCAN is split into CP-plane and UP-plane functions is not further
considered in this clause.
{width="4.404861111111111in" height="1.051388888888889in"}
Figure 6.21.1-1: Considered reference architecture
This solution will apply to 5G-CRG when it connects to the 5GC via W-5CGAN -
either as the only access network or as part of hybrid access.
The key part of the solution is to enable that the user plane part of the
fixed access GW (W-5GCAN-UP) is collocated with the UPF. The collocation may
apply only for a single PDU session; other PDU sessions may or may not use the
same PSA UPF and thus, may use other non-collocated UPFs as PSA.
The collocation removes the requirement for N3 interface to be implemented
between the W-5GCAN-UP and the UPF, but it is left for implementation whether
and how the tunnelling is eliminated or replaced by a different type of packet
forwarding; the N3 tunnel setup related signalling is kept unchanged.
The collocation of W-5GCAN-UP and UPF is achieved during PDU session setup;
due to lack of mobility on the W5-GCAN access, it will be retained due to the
lifetime of the PDU session.
The collocation of the W-5GCAN-UP and UPF shall be enabled by 5GC signalling
and node selection improvements, as detailed below.
A) In case a 5G-CRG registers to 5GC via the W-5GCAN, without or before using
NG-RAN:
\- The W-5GCAN-CP adds the identity of the W-5GCAN-UP to all uplink NAS
signalling messages received from the 5G-CRG. The AMF relays the W-5GCAN-UP
identity to the SMF, as part of session management signalling.
\- During the PDU session setup, the SMF shall select a UPF instance that is
collocated with the W-5GCAN-UP. This may be assisted by NRF or based on local
configuration and policies in the SMF.
Editor\'s note: The format of W-5GCAN-UP identity shall be defined by
CableLabs.
B) For 5G-CRG with hybrid access, which established PDU session via the
W-5CGAN with collocated W-5GCAN-UP and UPF and adds NG-RAN access
subsequently:
\- The SMF shall select the same PSA UPF that is in use for the PDU session.
\- The SMF will not be able to re-select the UPF due to mobility.
The reference architectures for the solution is depicted in figure 6.21.1-2
and figure 6.21.1-3. Note that the W-5GCAN-CP may connect to a different AMF
from the rest of the 5GC.
{width="4.267361111111111in" height="1.7631944444444445in"}
Figure 6.21.1-2: 5G-CRG architecture for collocated W-5GCAN-UP and UPF
{width="4.459027777777778in" height="1.7631944444444445in"}
Figure 6.21.1-3: Hybrid Access 5G-CRG architecture for collocated W-5GCAN-UP
and UPF
### 6.21.2 Description of the solution
Editor\'s note: This clause is FFS.
### 6.21.3 Impacts on existing Functions
Editor\'s note: This clause is FFS.
## 6.22 Solution #22: Handover of a PDU session based on network awareness of
QoE, for accessing via W-5GCAN
### 6.22.1 General
In normal case, the UE is pre-provisioned with ATSSS rules such that UE will
try to move the existing PDU sessions from 3GPP RAT to fixed access via
W-5GCAN.
Based on similar procedure as described in clause 6.4.5.3, UE will register to
5GC via W-5GCAN and then establish a PDU session using the PDU session
establishment procedure via W-5GCAN. If W-5GCAN rejects the N2:PDU session
request procedure due to QoS reason then this PDU session \"handover\" is not
possible.
However, it should also be possible that UE first perform the registration to
5GC via W-5GCAN but not start the handover procedure until a positive
indication is given by the network as shown in the next clause.
### 6.22.2 Solution
Figure 6.22.2-1: Movable PDU sessions notification
1\. UE has ongoing PDU sessions over 3GPP RAT. In parallel, UE attaches to 5GC
via W-5GCAN.
2\. AMF requests the current active PDU sessions with QoS info from SMF(s).
3\. AMF requests the bandwidth status by indicating to W-5GCAN the QoS info
(required bandwidth, latency for each PDU session the UE current has) received
from SMF(s) in step 2.
4\. W-5GCAN indicates the possible PDU session that can be moved and still
able to maintain the same QoE.
5\. AMF indicates to UE via NAS on which PDU session should be moved.
NOTE: The primay usage of this solution is for PDU session with GBR. It is up
to the operator policy in AMF to determine if this is also triggered for non-
GBR session.
## 6.23 Solution #23: Supporting FN-RG in 5GC
### 6.23.1 Overview
This solution specifies the 5GC functionality required to support registration
and session management of FN-RG, when interworking functionality defined by
BBF is provided in the W-5GAN.
In essence, the solution is based on the FAGF authenticating the FN-RG,
providing registration and session management for / on behalf of the FN-RG.
The 5GC impacts are thus limited; the adjustments that are still needed are
described in this solution.
This solution can be applicable in two scenarios defined by BBF:
\- The interworking scenario, where the FMIF is used in W-5GAN as the GW
function to 5GC, i.e. FAGF=BBF\'s FMIF.
\- The interworking step of the migration scenario, where the adaptive AGF
provides the GW function to 5GC, i.e. FAGF=BBF\'s \"adaptive AGF\".
The relevant architecture is shown on figure 6.23.1-1; from 3GPP perspective
FAGF represents both of the above BBF options.
{width="3.55in" height="1.5145833333333334in"}
Figure 6.23.1-1: Solution architecture for supporting the FN-RG
### 6.23.2 Registration and PDU management for FN-RG
#### 6.23.2.1 Initial registration and session setup for FN-RG
When the connectivity is established between FN-RG and the FAGF in the W-5GAN,
the FAGF shall:
\- Authenticate the FN-RG.
\- Perform registration to 5GC, on behalf of the FN-RG.
\- Setup PDU session(s) on behalf of the FN-RG.
The high level flow diagram for this procedure is represented on Figure
6.23.2-2.
Figure 6.23.2-2: Registration and PDU session setup for FN-RG
1\. A layer-2 (L2) connection is established between the 5G-RG and the FAGF.
This is defined in BBF specifications.
2\. The FN-RG is authenticated by the W-5GAN. This may be based e.g. on the
fixed AN inserting line ID to a DHCP request. If the RG has sent a request for
IP addressing (DHCPv4, DHCPV6, RS) the FAGF stores it until the RG has been
registered and a PDU Session established for the RG. This step is defined in
BBF specifications.
NOTE 1: It is crucial that the existing BBF authentication methods can be used
for FN-RG, also when connected to 5GC via the W-5GAN and this is the only
authentication taking place during the procedure.
Editor\'s note: The authentication of the FN-RG based on the trust
relationship between 5GC/AMF and the access network/FAGF shall be
defined/approved by BBF and SA3.
3\. The FAGF may use the line ID to get the required 5GC parameters (e.g.
NSSAI) it needs to be able to send NAS signaling to 5GC (registration, PDU
Session related etc...) and to perform initial AMF selection..
NOTE 2: The method used by the FAGF to determine these 5GC parameters is to be
defined by BBF;
The FAGF shall perform initial registration on behalf of the FN-RG. The NAS
registration message is sent using same N2 mechanisms as defined in TS 23.502
[3] for N3GPP access with the difference that ULI contains a different set of
information (see solution 28).
4\. The FAGF sends a registration request to the AMF. The following
differences exist, compared to the 5G-RG case:
\- The NSSAI is provided based on FAGF determination done in step 3.
NOTE 3: mBased on FAGF determination of the 5GC NAS parameters in step 3, one
or multiple S-NSSAI can be required; e.g. when the FAGF has been configured to
use a specific slice for RG management purposes.
\- The FAGF shall use the LineID to build the SUCI that is used in the
Registration request. This is further documented in solution 28.
\- The FAGF will indicate to the AMF that it has authenticated the F-RG, no
authentication is to be performed by the 5GC.
\- The FAGF shall indicate that no PEI can be provided.
\- The NAS registration message is sent using same N2 mechanisms as defined in
TS 23.502 [3] for N3GPP access with the difference that:
\- ULI contains a different set of information (see solution #28).
\- The FAGF will indicates to the AMF that it has authenticated the FN-RG, no
authentication is to be performed by the 5GC.
Editor\'s note: the assumption that 5GC does not perform further
authentication exchange needs to be verified with SA3 and BBF.
5\. The AMF selects an AUSF based on information received in the SUCI and asks
for authentication from the AUSF. This solution assumes that, no
authentication is carried out and the AUSF answers with the SUPI corresponding
to the subscription.
6\. The AMF selects an UDM, registers to UDM, gets subscription data from UDM
and subscribes to changes of subscription data as defined in step 14 of TS
23.502 [3] Figure 4.2.2.2.2-1
7\. As defined in TS 23.501 [2] caluse 5.5 for Non-3GPPP access The AMF shall
create an MM context for the FN-RG taking into account that that the
registration is for W-5GAN access The mobility and paging are not applicable.
8\. The AMF may interact with the PCF for obtaining the Access and Mobility
policy for the FN-RG.
9\. The AMF sends Registration Accept message to the FAGF. This message
contains at least a 5G-GUTI, the allowed NSSAI and a non-3GPP Deregistration
timer as defined in TS 23.502 [3] clause 5.5.
NOTE 4: Registration area for FN-RG is the whole W-5GAN. Mobility
restrictions, LADN and MICO mode are not applicable for FN-RG.
10\. The FAGF send a registration complete message back to the AMF when the
procedure is completed. The FAGF shall store the 5G-GUTI in order to be able
to send it in potential later NAS procedures.
**PDU session establishment procedure**
The usage of the SUPI and ULI during this procedure is also documented in
solution 28.
11\. The FAGF may continue by establishing a PDU session for / on behalf of
the FN-RG. For this, the FAGF generates a PDU session ID and derives and
derives the parameters of the PDU Session (S-NSSAI, DNN, SSC mode, etc.) as
defined in step 3 of the registration procedure. If it had received a
DHCPvV4/DHCPv6 request from the RG, the FAGF requests a deferred IP address
allocation.
12\. The PDU session request is processed in the 5GC as defined in TS 23.502
[3] clause 4.3.2.2.1.. This includes UPF selection and resource reservation in
UPF.
NOTE 5: The UPF selection may be based on the UPF/FAGF co-location as defined
in clause 6.13, or UPF may be selected based on ULI equal LineID or based on
the FAGF\'s identity.
13\. The SMF responds via AMF as defined in step 11 of TS 23.502 [3] clause
4.3.2.2.1; the N2 with PDU Session Request includes QoS parameters and the N3
tunnel endpoint information for the UPF.
14\. The FAGF may perform BBF specific resource reservation with the AN.
15\. The FAGF allocates AN N3 tunnel information for the PDU Session and
includes the AN N3 tunnel endpoint in the PDU Session Request Ack message.
16\. The PDU session setup procedure is completed in 5GC.
17\. The FAGF sends on the user Plane of the PDU Session any DHCP or RS
message received beforehand from the FN RG. This allows the IP address
allocation to complete with the RG.
NOTE 6: Typically, the DHCP request is sent by FN-RG during the authentication
procedure; the FAGF caches this and completes the address allocation via 5GC
after the PDU session setup.
#### 6.23.2.2 Registration management for FN-RG
The FAGF shall be able to dere-register the FN-RG, e.g. when it has lost
connectivity to the FN-RG.
The 5GC may explicitly de-register the FN-RG, e.g. in case of termination of
the subscription.
#### 6.23.2.3 PDU session management for FN-RG
The FAGF shall be able to release a PDU session (e.g. when relevant PPP
session is terminated by FN-RG).
The 5GC may modify the PDU session, e.g. due to the change in QoS subscription
information.
### 6.23.3 Impacts on Existing Functions
The solution impacts the following 5GC nodes:
\- New type of SUPI/SUCI needs to be supported; and this impacts AMF, SMF,
PCF, UDM, AUSF, UDR, NWDAF and also CHF.
\- The new type of authentication (namely, no authentication in 5GC) that is
needed for the FN-RG will impact AUSF and UDM.
NOTE: If SA3 defines additional security requirements for FN-RG
authentication, the solution shall be adjusted accordingly.
## 6.24 Solution #24: Supporting BBF service migration
This solution describes the BBF service migration procedure from 3GPP
perspective, focusing on the aspects that needs to be supported in 5GC. This
involves support of replacing the FN-RG with 5G-RG (by the customer) without
major service disruption.
### 6.24.1 Overview
The migration scenario defined by BBF is based on 2 major steps:
\- First, the network solution serving a given fixed line is replaced, i.e.
the traffic is steered to the 5GC, instead of BBF core network. This stage is
referred to as interworking step, as in this case the W-5GAN will provide
interworking for the FN-RG. This is described in solution 23.
\- The second major step is to replace the RG: FN-RG is disconnected and 5G-RG
is connected to the same fixed access line. The W-5GAN shall detect this and
change its functionality to support the 5G-RG based service implementation. As
there are differences in the FN-RG and 5G-RG support in 5GC, the 5GC mode of
operation will change at this step as well.
The solution for 5G-RG / scenario1 is described in other solutions, e.g. in
clauses 6.2 and 6.3, while supporting FN-RG is covered in solution 23\. In
this solution, only the migration aspects are covered.
### 6.24.2 Description of the solution
The complete migration procedure of a BBF service with FN-RG to 5GC based
service, using 5G-RG is described on figure 6.24.2-1.
Figure 6.24.2-1: Migration procedure for FN-RG to 5G-RG
0\. The fixed broadband service is operated using the BBF solution.
1\. The network operator decides to migrate the service to 5GC based solution.
As a preparatory step, the subscription data needs to be provisioned to the
5GC / to UDR.\ At this stage, the subscription data required to support FN-RG
mode of operation must be provisioned; optionally, also the subscription to
support the 5G-RG mode can be added.
NOTE 1: The RG\'s replacement to 5G-RG (step 5-7) may be connected to the
customer being contracted to specific services that are implemented using only
5G-RG. This means that step4 and the further steps may be significantly
delayed (e.g. by multiple years), compared to step2/step3. This may justify
the partial provisioning.
2\. The service is migrated to the 5GC, with the FN-RG being unchanged.
a. The L2 traffic steering capability in the fixed AN and aggregation network
is used to direct the traffic of the given FN-RG to an FAGF.
b. The subscription in the BBF core may be de-provisioned by the network
operator at this stage.
Editor\'s note: It is BBF\'s responsibility to define when this step is to be
executed - is it e.g. required to prevent IP address allocation conflict
between BBF core and the 5GC.
3\. The traffic steering to FAGF leads to FAGF providing service for the FN-RG
via the 5GC:
a. L2 connectivity is established between the FN-RG and FAGF.
b. The FN-RG is authenticated by the FAGF. It does not support EAP, and thus,
the FAGF shall recognize that it is an FN-RG and that it needs to provide
interworking for this FN-RG towards the 5GC.
c. The FAGF shall be configured with the relevant access related information.
It derives registration and PDU session setup related information, and it
performs initial registration and PDU session setup for / on behalf of the FN-
RG, as described in the clause 6.23.1.
4\. If not done in step1, the network operator provisions the 5G-RG related
subscription information to the UDR.
As described in Solution 23, the subscription data required for the FN-RG is
significantly different from those needed for the 5G-RG: supporting the FN-RG
requires different SUPI format and authentication method. Due to the basic,
network (FAGF) configuration based registration and session management, it can
also be assumed that the PDU sessions in a region will use the same DNN. After
replacing the RGs to 5G-RG (see below) these could be different, for different
service offerings of the operator. Also, as presented in the next steps, there
is no requirement for the UDM/UDR to interact for session management handling
during/for the FN-RG/5G-RG replacement.
For this reason, this solution defines no requirement for the FN-RG and 5G-RG
related subscriptions of the same fixed broadband line; they can be handled as
independent subscriptions in UDM/UDR.
NOTE 2: as a deployment option, a network operator may choose to combine the
FN-RG and 5G-RG related UDM subscriptions. In that case, the lineID based SUPI
(for FN-RG) and the IMSI based SUPI (for 5G-RG) shall identify the same UDR
record.
5\. The customer may now replace the RG; for this, first she disconnects the
FN-RG.
Editor\'s note: The disconnection of the FN-RG will trigger the FAGF to
release the PDU session and de-register the FN-RG; however this shall be
delayed to avoid unnecessary signalling for short disruptions in connectivity.
It is FFS (in BBF), what timer value should be used for the PDU session
release/de-registration. The timers used will influence whether the 5G-RG
could be connected before these actions are executed.
6\. The customer will connect the 5G-RG to the same access network termination
(i.e. same lineID is used).
7\. The replacement of the FN-RG to 5G-RG will lead to the FAGF integrating
the RG to the 5GC in 5G-RG mode:
a. The L2 connectivity is established and the FAGF shall recognize that this
RG is a 5G-RG.
Editor\'s note: The method used for this is internal to W-5GAN and it is to be
defined by BBF.
b. The FAGF shall initiate EAP based authentication towards the 5G-RG.
c. When the FAGF recognizes that the FN-RG has been replaced by a 5G-RG, it
terminates any ongoing PDU session and de-registers the FN-RG.
Editor\'s note: This step may not be required. As described at step 5, it will
depend on BBF\'s decision for PDU session release/de-registration. The PDU
session release shall be performed latest at this stage, as the FN-RG-s PDU
session would otherwise cause e.g. IP address conflicts between the two modes
of operations.
d. The 5G-RG initiates registration to the 5GC, the registration is performed
as described in clause 6.2.
e. The 5G-RG requested PDU session setup is performed as described e.g. in
clause 6.3.3.
8\. As this stage, the network operator may decide to de-provision the
subscription data required for FN-RG mode.
Editor\'s note: It is FFS whether reverse migration to FN-RG mode shall be
supported as well. This may be required where customers are allowed to use BYO
device for RG and may (knowingly or unknowingly) revert to an FN-RG, after
already using a 5G-RG. If reverse migration is to be supported, step 8 is not
applicable and the procedure for the reverse migration itself is FFS.
## 6.25 Solution #25: Supporting FN-CRG in 5GC
### 6.25.1 Overview
This solution specifies the 5GC functionality required to support registration
and session management of FN-CRG, when interworking functionality defined by
CableLabs is provided in the W-5CGAN.
In essence, the solution is based on the W-5GCAN authenticating the FN-CRG,
providing registration and session management for / on behalf of the FN-CRG.
The 5GC impacts are thus limited; the adjustments that are still needed are
described in this solution.
The solution is applicable to one scenario, the interworking functions are
used in the W-5CGAN as the GW to the 5GC.
### 6.25.2 Registration and PDU management for FN-CRG
#### 6.25.2.1 Initial registration and session setup for FN-CRG
Initial registration and session setup procedures for the FN-CRG follow the
same structure as for the FN-RG as described in clause 6.23.2.1, except for
the following DOCSIS aspects:
\- The W-5CGAN provides registration and session set up interworking rather
than the FAGF.
\- A DOCSIS CM identifier defined by CableLabs is used rather than a Line ID.
SUPI is derived from this identifier. New SUPI format is expected.
\- The serving W-5GCAN identity is stored in the UDM as part of the Nudm_UECM
registration procedure (step 6 in figure 6.23.2-2).
\- Existing DOCSIS authentication methods apply - between FN-CRG and W-5GCAN
(i.e., outside 3GPP).
\- Resource reservations between FN-CRG and W-5GCAN, when applicable, are
defined by DOCSIS (i.e., outside 3GPP).
#### 6.25.2.2 Registration management for FN-CRG
The W-5CGAN shall provide re-registration for the FN-CRG, as requested by the
5GC.
The 5GC may explicitly de-register the FN-CRG, e.g. in case of termination of
the subscription.
#### 6.25.2.3 PDU session management for FN-CRG
The 5GC may modify the PDU session, e.g. due to the change in QoS subscription
information.
#### 6.25.2.4 Support of slicing for FN-CRG
There is no new requirement on the 5GC to support slicing with FN-CRG. The UDM
provides the AMF with the mapping from the SUPI (HFC_Identifier) to the
subscribed S-NSSAI (no change expected to slice management).
The W-5GCAN is provisioned with S-NSSAI(s) and access network resources
mapping for the FN-CRG (i.e., to be defined by CableLabs). The W-5GCAN
indicates the S-NSSAI to 5GC for slicing operating as defined in TS 23.501
[2].
## 6.26 Solution #26: Support of other MBR than UE-AMBR and Session-AMBR
### 6.26.1 Description
This solution addresses Key Issue #8.
A UE Total Maximum Bit Rate (TMBR) indicates the maximum overall bandwidth per
UE(RG), i.e. controls the maximum bandwidth for the sum of both GBR and non-
GBR traffic of the UE.
A Session Total Maximum Bit Rate (TMBR) indicates the maximum overall
bandwidth per PDU Session, i.e. controls the maximum bandwidth for the sum of
both GBR and non-GBR traffic of the PDU Session.
In this release of the specification the averaging window for non-GBR traffic
is taken into account as averaging window for TMBR checking.
For Wireline access, Session-TMBR (Session Total Maximum Bit Rate) and UE-TMBR
(UE Total Maximum Bit Rate) are used instead of Session-AMBR and UE-AMBR.
Session-TMBR and UE-TMBR apply only to the subscription of RG; they may impact
the traffic of 3GPP UE behind a RG as follows: the enforcement of the UE-TMBR
of a RG takes into account the traffic between 3GPP UE served by this RG and
the IWF(s) (N3IWF, TNGF) serving these UE(s).
Apart from the difference indicated above, Session-TMBR and UE-TMBR are used
exactly like Session-AMBR and UE-AMBR.
Session-TMBR (UE-TMBR) are provided as part of subscription data by the UDM to
the SMF (to the AMF).
It shall be possible for the PCF to provide the authorized Session-TMBR values
to the SMF.
It shall be possible for the PCF to request a change of the unconditional or
conditional authorized Session-TMBR value(s) at a specific point in time.
This solution applies to both 5G RG and FN RG.
### 6.26.2 Procedures
AMF and SMF receive (from UDM) and handle Subscribed-UE-TMBR and Subscribed-
Session-TMBR in the same procedures where they handle Subscribed-UE-AMBR and
Subscribed-Session-AMBR in R15 specifications.
In case of a wireline subscription, TS 23.502 [3] Table 5.2.3.3.1-1: UE
Subscription data types contains (on top of the Subscription data types
defined for Rel-15):
\- Subscribed-UE-TMBR information.
\- Subscribed-Session-TMBR information.
In case of Wireline access, the AMF provides AGF with Subscribed-UE-TMBR in
Initial UE context NGAP message (e.g. in registration and Service Request
procedures).
The SMF provides the UE with both Session-AMBR and Session-TMBR in NAS
signalling.
In case of Wireline access, the SMF provides the FAGF with Session-TMBR
(instead of Session-AMBR) in N2 SM signalling (PDU Session Resource Setup or
Modify Request Transfer).
The AGF shall set its UE-TMBR to the sum of the Session TMBR of all PDU
Sessions with active user plane to this AGF up to the value of the subscribed
UE-TMBR.
For a RG subscription the UDM provides both TMBR and AMBR information to AMF
and SMF:
\- In case of a PDU Session using Wireline access, the UPF acting as PSA
enforces only Session-TMBR (and not Session-AMBR). This may correspond to a
PDU Session using only Wireline access or to a PDU Session using Hybrid
access.
\- In case of a PDU Session using only Wireless access, the UPF acting as PSA
enforces only Session-AMBR.
\- Session-TMBR and UE-TMBR are provided to the AGF.
\- Session-AMBR and UE-AMBR are provided to the RAN.
### 6.26.3 Impacts
UDM/ UDR, PCF, AMF and SMF handle Subscribed-UE-TMBR and Subscribed-Session-
TMBR as they handle Subscribed-UE-AMBR and Subscribed-Session-AMBR in Rel-15.
More information is provided in clause 6.26.2.
The AMF and SMF provide an AMBR or a TMBR to the AN depending on the Access
type.
## 6.27 Solution #27 - Support 5GC-capable UEs via 5G-RG for wireline/wireless
access network using N3GPP solutions
This solution is based on solution #11 with the differences described in this
clause the co-located scenario is not considered.
The interfaces used by the 5GC-capable UE to access a 5G-RG will leverage the
untrusted/trusted N3GPP interfaces. The untrusted N3GPP interface is defined
in 3GPP release 15. The trusted N3GPP interfaces are studied in this report.
When these interfaces are not sufficient to accomplish the requirements for
5GC-capable UE accessing 5GC via 5G-RG case, enhancements on top of the
untrusted and trusted solutions are described below.
Figure 6.27.1-3: Architecture for the 5G-capable UE behind a 5G-RG with NG
RAN/W-5GAN case
Figure 6.27.1-3 shows how 5GC-capable UE connects via 5G-RG which is using
either NG RAN or fixed access. The NG-RAN or W-5GAN is providing the N2 and N3
interfaces for the 5G-RG. Furthermore, the 5GC-capable UE will not be affected
if 5G-RG changes access. Note that even though the figure shows a 5G-RG
connected to both NG-RAN and wireline access, it is not necessary that
\"simultaneous\" hybrid access is applied, the 5G-RG can use either wireline
access or NG-RAN.
When 5G-RG is using NG-RAN or W-5GAN access, the control and user plane
packets of the 5GC-Capable UE is transported using a 5G-RG IP PDU session and
then from PSA UPF of that PDU session to the N3IWF/TNGF. It is assumed that
the IP endpoints in the N3IWF/TNGF is reachable from the UPF/DN of the 5G-RG
IP PDU session, i.e. the N6 interface for the 5G-RG PDU Session carries
traffic to the N3IWF/TNGF. The 5G-RG identifies the traffic from 5GC-Capable
UE based on implementation, e.g. certain WLAN SSID is configured to support
the 5GC-Capable UE access.
NOTE: This assumes that the N3IWF/TNGF is reachable using IP from a 5G-RG PDU
Session over NG-RAN or W-5GAN. The N3IWF selection is as defined in TS 23.501
[2] clause 6.3.6. The TNGF IP address is configured on the 5G-RG or queried
through the DNS procedure. The 5GC-Capable UE received the IP address of TNGF
during the EAP-5G signalling as defined in the clause 7.1.3.3.
### 6.27.3 5GC-capable UE behind 5G-RG using 802.1x with 3GPP credentials
#### 6.27.3.1 General
This solution is applicable when 802.1x (EAP over LAN) and 3GPP credentials
are used to associate with the WLAN. In this option, the solution for trusted
N3GPP is used as baseline but with the additional property that the service is
offered via a wireline access and a 5G-RG. FN-RG is not applicable for this
case since changes may be needed in the RG (FN-RG is not supporting the role
of EAP Authenticator). This option can typically be used in case a service
provider offers services via wireline access to all the subscribers of the
service provider. This solution can also distinguish the 5GC-capable UE role
and apply the different policy for the different categories of devices, for
example for 5GC capable UE considered as host or guest of the local network of
5G-RG/HA 5G-RG , such as different QoS control, permission to use certain
resources e.g. printer in LAN or being allowed to get Internet access. The
member of the family decides on which 5GC capable UE considered as host (i.e.
subscriber of the 5G-RG) and reports these 5GC capable UE IDs (e.g.MSISDN) to
the operator via online or offline service. This is out of the scope of 3GPP.
After that, it is the 5GC\'s responsibility to maintain such information and
decides the 5GC capable UE role based on it.
The combination of 5G-RG and W-5GAN will act as a trusted N3GPP access network
from the 5GC-capable UE and 5GC perspective. Solution #1 described in clause
7.1 is used as baseline but it is expected that any solution selected for
trusted N3GPP can be re-used/enhanced for this scenario as well.
#### 6.27.3.2 Registration procedure
The registration procedure in 7.1.3.3 (solution #1) can be used where 5G-RG
connects TNGF via wireline or wirless acess network by using the PDU
connection. The 5G-RG acts as TNAP and is behaved as authenticator, the
interface between the 5G-RG and W-5GAN is assumed an AAA interface. In similar
manner the procedures proposed in 7.1.3.3 on how to complete the registration
can be followed with the following addition.
Figure 6.27.3.2-1: Registration procedure
0\. 5G-RG has successfully registered to the AMF1. 5G-RG obtained the 5G-RG
GUTI from 5GC.
A layer-2 connection is established between the UE and the 5G-RG. In case of
IEEE 802.11 this step corresponds to an 802.11 Association.
1a-1b. An EAP authentication procedure is initiated. EAP messages are
encapsulated into layer-2 packets, i.e. into Ethernet-over-LAN packets. The UE
provides a NAI in the EAP-Res/Identity message. This EAP-Res/Identity is
encapsulated in the AAA message as defined in 7.1.3.3 step 3 by 5G-RG, the
5G-RG includes 5G-RG 5G-GUTI in the AAA message. The AAA message is
encapsulated over IP layer, the source IP adderss is the 5G-RG\'s IP address
allocated by the 5GC in the PDU session established procedure via wireline or
wirless access, the destination IP address is the TNGF IP address configured
on the 5G-RG side or queried through the DNS procedure.
Editor\'s note: Whether the 5G-RG SUCI can be used to identify the 5G-RG in
this step is FFS.
1c. An EAP-5G procedure is executed as specified in TS 23.502 [3] and TS
33.501 [25]. The W-5GAN sends the EAP-5G start message including the 5G-RG
GUTI to the UE.
1d. The UE sends the AN parameters (e.g. UE SUCI or the 5G-GUTI, Requested
NSSAI, etc.) and NAS Registration request message (e.g. Registration type, UE
SUCI or 5G-GUTI, Security parameters, Requested NSSAI, etc.) in the EAP-5G. In
addition, in the NAS Registration request message, the UE includes the 5G-RG
5G-GUTI received from the EAP-5G start message. The 5G-RG 5G-GUTI is used by
AMF to find the 5G-RG context and obtain 5G-RG SUPI.
2\. W-5GAN selects the AMF2 for UE as specified in TS 23.501 [2] clause
4.2.2.2.2 with the UE 5G-GUTI or Requested NSSAI. This AMF2 may be the same or
different from the AMF1.
3-4. The AMF2 received the Registration request message and the UE
authentication procedure is performed based on the UE 3GPP credential as
defined in TS 23.502 [3] and TS 33.501 [25].
5-6. With the existing of 5G-RG GUTI, the AMF2 knows that the UE is accessing
5GC via 5G-RG. In order to obtain the 5G-RG SUPI, the AMF2 finds the 5G-RG
context based on the 5G-RG 5G-GUTI. If there is no 5G-RG context in the AMF2,
AMF2 requests the 5G-RG SUPI from AMF1. To be more specific, the AMF2 selects
the AMF1 based on the 5G-RG 5G-GUTI and sends the request message to the AMF1
including the 5G-RG 5G-GUTI and SUPI requested indication. AMF1 finds the
5G-RG context based on the 5G-RG 5G-GUTI and replies the 5G-RG SUPI to the
AMF2.
7-8. The AMF2 selects the UDM based on 5G-RG SUPI, and requests 5G-RG\'s
subscribed UE ID list from the UDM. The 5G-RG\'s subscribed UE ID list may
include more than one category. For example, the smartphone devices belong to
the category 1, the IoT devices blong to the category 2, the IPTV/STB devices
belong to the category 3, etc. The 5G-RG\'s subscribed UE ID list includes the
UE IDs, e.g. UE SUPI or UE MSISDN. If the UE ID sent by AMF2 to UDM belongs to
the subscribed UE ID list, the UE is treated as the subscriber of the 5G-RG.
If the UE ID does not belong to the subscribed UE ID list and the 5G-RG only
allows the subscribed UE, the UDM shall reject the UE. The UDM stores the
serving AMF identity and will notify the AMF when the 5G-RG\'s subscribed UE
ID list is updated.
9\. The UDM sends the subscribed UE ID list to the AMF2. AMF2 stored the
subscribed UE ID list and decides if the UE is the subscribed UE of the 5G-RG.
If the UE is not the subscriber of 5G-RG and the 5G-RG only allows the
subscribed UE, the AMF shall reject the UE.
Editor\'s note: It is FFS on how to offer different services/policies to
subscribed (e.g. for the different category) and non-subscribed UEs.
10-11. The AMF2 requests the policy from PCF.
12-16. The same steps as defined in clause 7.1.3.3 steps 10 to 15.
The protocol stack is defined in figure 6.27.3.2-2.
Figure 6.27.3.2-2: Protocol stack for Registration procedure
### 6.27.4 5GC-capable UE behind 5G-RG using IKEv2 and IPsec based access
procedures
#### 6.27.4.1 General
In the second sub-solution, the WLAN association is assumed to have been
carried out before the 5GC-capable UE does 5GC registration. How that is done
is outside the scope of 3GPP. Services are only offered to 5GC-capable UEs
that can both 1) associate to the WLAN of the 5G-RG and 2) register to the 5GC
via the N3IWF as described below.
This sub-solution re-uses procedures defined for untrusted N3GPP solution in
Rel-15.
Figure 6.27.4.1-1: Architecture for the 5GC-capable UE behind 5G-RG with
Broadband Wireline access using IKEv2 and IPsec based access procedures
Figure 6.27.4.1-2: Architecture for the 5GC-capable UE behind 5G-RG with NG
RAN access using IKEv2 and IPsec based access procedures
Figure 6.27.4.1-1 and Figure 6.27.4.1-2 shows the N1, N2 and N3 reference
points of the 5GC-capable UE and that 5GC-capable UE is using IKE/IPsec
(similar as 3GPP NWu reference point) functionality to connect to N3IWF.
Differences compared to Rel-15 untrusted N3GPP solution are:
\- The 5G-Capable UE obtains its local IP address from 5G-RG via LAN
interface. The 5G-RG changs this local IP to WAN IP address, which is
allocated in the 5G-RG\'s IP PDU session establishment procedure.
\- The UDP protocol is used between the 5G-Capable UE and N3IWF to enable NAT
traversal for IKEv2 and IPsec traffic.The 5G-RG can distinguish the 5G-Capable
UE by the differnet local IP address in LAN interface, and the different UDP
port number in WAN interface.
\- If the binding between the 5G-RG and 5GC capable UE is needed, then the
Registration procedure the AMF2 selects the UDM based on 5G-RG SUPI, and
requests 5G-RG\'s subscribed UE ID list from the UDM as described in step 7 to
9 in figure 6.27.3.2-1. The AMF 2 obtains the 5G-RG SUPI based on the 5G-RG
GUTI, using the same procedure as the trusted non3GPP solution as defined in
subclause 6.27.3.2. The AMF2 receives 5G-RG GUTI in NAS message sent by the
5GC capable UE, which got the 5G-RG GUTI via ANQP query. The 5G-RG advertises
its own 5G-RG GUTI via ANQP after the 5GC capable UE connects to the 5G-RG
without updating in ANQP server.
NOTE: The 5G-RG could be configured with certain WLAN SSID only accepting the
5GC capable UE connection with the correct credential. In this way, the ANQP
message with 5G-RG GUTI can be avoid to send to any 5GC capable UE.
## 6.28 Solution #28 -Line Id Transfer to and usage within 5GC
### 6.28.1 Overview
Current BBF service and customer management is centred around using the Line
Id (e.g. added by the AN in DHCP Option 82) to identify the RG and the
associated subscription.
This solution studies how 5GC is made aware of the Line Id and can use Line
Id.
This solution is meant to apply to 5G-RG (connected over Wireline access) and
FN-RG collectively called \"RG\" in this solution; the solution is specific to
Wireline access and does not apply to FWA. For FN-RG case this solution is a
complement of solution 22
NOTE: How the AGF gets the Line Id as well as the format of a Line Id is
determined by BBF. The Line Id format is further documented in sub-clause
6.28.2.3.
The Line ID is not guaranteed to be unique across multiple operators. Since a
5GC may be connected to multiple wireline access networks using overlapping
Line ID values, the Line ID needs to be combined with an ID of the operator
administrating the Line ID value in order to make it unique within 5GC.
### 6.28.2 Description of the solution
#### 6.28.2.1 Usage of the Line Id as ULI
In case of 5G-RG (connected over Wireline access) and FN-RG, the AGF provides
the Line Id as ULI (User Location Information) in any N2 message where, as any
5G-AN, it needs to send ULI to AMF (e.g. in the initial UE message).
It is expected that for both 5G RG and FN RG the AGF can provide ULI including
when transferring the first NAS signalling message (register) from (5G RG) or
about (FN RG) a RG.
#### 6.28.2.2 Usage of the Line Id to identify the FN RG
In case of FN-RG the AGF provides the Line Id (together with an operator Id of
the operator administrating the Line ID value) within the SUCI put in the NAS
registration request it builds on behalf of the RG and it sends to the AMF.
This solution assumes that the AGF ensures that the Line Id information it
provides to the AMF is accurate.
NOTE 1: Further security impacts of FN RG (e.g. related with NAS and UP
security) are to be defined as part of another solution. e.g. the 5GC is
assumed to trust the AGF and the SUCI information provided by the AGF, Where
needed Network Domain Security applies between the AGF and the AMF More
details are also provided in solution 23.
When it has received a SUCI made up to include a Line Id (together with an
operator Id of the operator administrating the Line ID value) from an AGF, the
AMF selects an AUSF based on information received in the SUCI and asks for
authentication from the AUSF. The SUCI made up to include a Line Id (together
with an operator Id of the operator administrating the Line ID value) is
provided to the AUSF that fetches the corresponding SUPI from the UDM and
provides back the SUPI to the AMF More details are provided in solution 23.
The AGF would also need to include a Home Network Identifier in the SUCI. In
non-roaming cases, the AGF could be configured with the same Home Network
Identifier for all FN-RGs.
If roaming architecture is applicable, e.g. to support wholesale scenarios
using the roaming architecture, SUCI needs to include the Home Network
Identifier of the operator owning the subscription for the FN-RG. To support
this, the Home Network Identifier of the FN-RG needs to be known by the AGF.
This information is assumed to be available as part of setting up a wholesale
arrangement between the access (visited) operator and the home network
operator.
NOTE: Whether the roaming architecture is applicable for wholesale and whether
AGF can know the home operator ID of an FN-RG needs to be confirmed by BBF.
Alternatively, it is assumed that only non-roaming architecture is applicable.
The the Line Id may be used as the SUPI in UDM (also within SUCI) and then
continue managing the RG using the Line Id (in PCF policies, in CDR, etc...)
or the Line Id in SUCI as a pseudonym of the SUPI may be used to map it to a
SUPI corresponding to an IMSI in UDM. Depending on SA3 requirements, Line ID
in SUCI can still be concealed.
When Line ID is used as pseudonym identity in SUCI and UDM does a mapping of
Line Id to IMSI, then the definition of SUCI need to be updated since it is
currently defined to carry a concealed version of SUPI. In this case, the SUCI
will contain a pseudonym identity (Line ID) that should be mapped by UDM into
a SUPI.
Wireline LI may use the Line Id to identify Wireline subscribers to intercept.
Wireline charging may use the Line Id to identify Wireline subscribers that
need to be billed.
The AMF uses the SUPI to fetch the subscription data using procedures already
defined in TS 23.502 [3]. The only difference due to the usage of a line ID in
the SUPI is in the UDM selection procedure.
The AMF then uses the ULI = Line Id to check the Registration restriction of
the RG (FN-RG in the case of this solution).
NOTE 2: The control of registration restriction for RG(s) to be defined by
another solution.
As defined in R15, both the SUPI and the Line Id (as ULI) are provided by the
AMF to the SMF over N11 (e.g. when issuing a Nsmf_PDUSession_CreateSMContext
Request), by the SMF to the PCF over N7 (e.g. when performing an SM Policy
Association Establishment procedure as defined in TS 23.502 [3] clause
4.16.4), by the AMF to the SMSF.
The SUPI is used by SMF, SMSF, PCF, etc... to fetch subscription data from
UDM/UDR using procedures already defined in TS 23.502 [3]. The only difference
due to the usage of a line ID in the SUPI is in the UDM (and PCF/CHF)
selection procedure.
#### 6.28.2.3 Format of the Line Id
NOTE 1: The Line ID format is to be defined by BBF; the content of this sub-
clause comes from BBF LS in S2‑1811672.
Different operators / different Access Networks may use different format of
the Line ID e.g.:
\- DHCPv4 option 82 exchange (TR-101i2 [10] Annex B, original specification
2006).
\- PPPoE Circuit and Remote ID AVP insertion (TR-101i2 [10] Annex A/8.3,
original specification 2006).
\- DHCPv6 use of option 18 via LDRA (Lightweight DHCPv6 Relay Agent)
functionality in the access node\ (TR-177 [50] R-07).
\- Use of the Line ID Option (LIO) in RS messaging (TR-177 [50] corr1 R-16,
original specification 2010). The LIO option is also documented in RFC 6788
[51].
NOTE 2: RFC 6788 [51] encoding differs slightly from the nBBF encodings.
### 6.28.3 Impacts on existing Functions
In case of FN-RG and 5G-RG served by Wireline access:
\- Any NF that uses the content of the ULI is impacted (for example the SMF
when it considers the ULI to select an UPF).
In case of FN-RG:
\- Need to add the possibility for SUCI derived from a Line Id in the SUCI
definition/format. Need to define proper AUSF and UDM discovery based on a
SUCI derived from a Line Id.
\- The UDM is modified to translate a SUCI based on a Line Id into a SUPI
(that based on operator configuration may either correspond to an IMSI or to
the Line Id).
\- SUPI/SUCI format change in order to include a Line ID.
\- When the SUCI or SUPI corresponds to a Line Id, the UDM selection
functionality is modified to select the UDM based on the Line Id and not based
on an IMSI).
\- PCF discovery is modified when the SUPI including a Line Id).
NOTE: Apart from the UDM (and from UDM/PCF/CHF selection by AMF, SMF, SMSF,
PCF) no 5GC NF needs to know whether the SUPI corresponds to a Line Id or to
an IMSI.
## 6.29 QoS framework proposal for 5G-RG and FN-RG
### 6.29.1 Comparison of the 5G and BBF QoS control
The tables 6.29.1-1, 6.29.1-2 and 6.29.1-3 contain a comparison of QoS
mechanisms used in 5GC (trusted and untrusted access) and existing BBF
networks (before WWC).
Table 6.29.1-1: comparison of QoS mechanisms used in 5GC (trusted and
untrusted access) and existing BBF networks (before WWC)
+----------------+----------------+----------------+----------------+ | Network | 5GC with | 5GC with | BBF (existing | | | NG-RAN | untrusted | / before WWC) | | | | non-3GPP | | | | | access | | +----------------+----------------+----------------+----------------+ | QoS mechanism | | | | +----------------+----------------+----------------+----------------+ | Traffic | - Up to 15 | - Multiple | | | separation to | PDU sessions | session | | | sessions and | (each with own | possible via | | | slices | IP | VLANs (1:1); | | | | a | as configured | | | | ddress/prefix) | on RG (Note 1) | | | | in max 8 | | | | | network | - Steering | | | | slices; all | via RG | | | | PDU session | configuration | | | | are requested | (e.g. map SSID | | | | by UE | or MAC address | | | | | to VLAN) | | | | - UE steers | | | | | applications | | | | | to | | | | | s | | | | | lices/DNNs/PDU | | | | | sessions based | | | | | on URSP rules; | | | | | network | | | | | steering based | | | | | on IP address | | | +----------------+----------------+----------------+----------------+ | Traffic | - Up to 15 | - Multiple | | | separation to | PDU sessions | session | | | sessions and | (each with own | possible via | | | slices | IP | VLANs (1:1); | | | | a | as configured | | | | ddress/prefix) | on RG (Note 1) | | | | in max 8 | | | | | network | - Steering | | | | slices; all | via RG | | | | PDU session | configuration | | | | are requested | (e.g. map SSID | | | | by UE | or MAC address | | | | | to VLAN) | | | | - UE steers | | | | | applications | | | | | to | | | | | s | | | | | lices/DNNs/PDU | | | | | sessions based | | | | | on URSP rules; | | | | | network | | | | | steering based | | | | | on IP address | | | +----------------+----------------+----------------+----------------+ | | - Separate | - IPsec child | | | | data radio | SAs (of the | | | | bearers (DRBs) | original | | | | / set of them | IKEv2) created | | | | must be used | for each PDU | | | | for each PDU | session | | | | session | | | +----------------+----------------+----------------+----------------+ | Traffic | - Rel-15: | - DSCP | | | separation | Single access | marking (by | | | within a | session, URSP | applications | | | session | rules drive | behind RG/in | | | | selecting | \"DNN\") | | | | 3GPP/Non-3GPP | | | | | access (vs. | - BNG and RG | | | | ANDSP for | mapping of | | | | selecting | DSCP marking | | | | non-seamless | to access | | | | offload) | specific | | | | | traffic | | | | - Rel16: | categories and | | | | Multi-access | queues - on L3 | | | | session, ATSSS | or L2. | | | | (steering, | | | | | switching, | - BNG does | | | | splitting) | this based on | | | | between | static Radius | | | | 3GPP/non-3GPP | policies; RG | | | | access | based on TR-69 | | | | | config | | | | - QoS flows | | | | | in core (based | | | | | on traffic | | | | | filters such | | | | | as IP flows, | | | | | application | | | | | ID, ... ) | | | +----------------+----------------+----------------+----------------+ | | - QoS flows | - QoS flows | | | | maps to data | may be mapped | | | | bearers | to further | | | | (DRABs) in the | child SAs | | | | RAN | | | +----------------+----------------+----------------+----------------+ | NOTE 1: \"All | | | | | traffic\" | | | | | typically | | | | | tethered, | | | | | therefore not | | | | | app driven. | | | | | | | | | | NOTE 2: GBR | | | | | bearers are | | | | | exempt from | | | | | AMBR. | | | | | | | | | | NOTE 3: | | | | | \"Absolute\" | | | | | MaxBR limit is | | | | | used - there | | | | | is no | | | | | exception e.g. | | | | | for GBR | | | | | traffic. | | | | | | | | | | NOTE 4: | | | | | Multiple | | | | | queues can be | | | | | used internal | | | | | to BNG/RG that | | | | | map to same TC | | | | | on the access. | | | | | | | | | | NOTE 5: There | | | | | is no | | | | | mechanism | | | | | defined for | | | | | the core | | | | | network (other | | | | | than ACS) | | | | | indicating any | | | | | QoS | | | | | c | | | | | ategorisation/ | | | | | p | | | | | rioritisation. | | | | +----------------+----------------+----------------+----------------+
Table 6.29.1-2: comparison of QoS mechanisms used in 5GC (trusted and
untrusted access) and existing BBF networks (before WWC)
+----------------+----------------+----------------+----------------+ | Network | 5GC with | 5GC with | BBF (existing | | | NG-RAN | untrusted | / before WWC) | | | | non-3GPP | | | | | access | | +----------------+----------------+----------------+----------------+ | QoS mechanism | | | | +----------------+----------------+----------------+----------------+ | Shaping | - UE, DNN | - Radius | | | mechanisms | (Aggregated | policy from | | | (max BR | Max BR, AMBR), | AAA to BNG | | | control) | based on UDM | (DL) on | | | | subscription | session and | | | | and QoS flow | packet flow | | | | level max BR | level | | | | control based | | | | | on static or | - TR-69 | | | | dynamic policy | settings in RG | | | | rules (Note 2) | (UL) based | | | | | policy on | | | | - DNN level | session and | | | | AMBR for DL is | packet data | | | | enforced by | flow level | | | | UPF | (Note 3) | | | | | | | | | - Shaping on | - High | | | | QoS flow | priority | | | | level: | queues should | | | | | be shaped | | | | - For DL is | | | | | enforced in | | | | | UPF for DL; | | | | | | | | | | - for UL, UE | | | | | is required | | | | | to, but UPF | | | | | enforces as | | | | | well. | | | +----------------+----------------+----------------+----------------+ | | - UE AMBR | - UE AMBR | | | | UL&DL, as well | UL&DL, as well | | | | as DNN AMBR | as DNN AMBR | | | | for UL is | for UL is | | | | enforced in | enforced in | | | | RAN | N3IWF | | +----------------+----------------+----------------+----------------+ | Traffic | - Static & | - Only static | | | prioritisation | dynamic policy | policies; no | | | mechanisms | (& charging) | feedback on | | | (general) | control in | enforcement | | | | each session, | | | | | mapping | Access | | | | traffic to QoS | technology | | | | flows - | specific | | | | packets in | means; | | | | which will | typically | | | | receive same | strict | | | | treatment | p | | | | | rioritisation, | | | | - QoS flows | e.g. | | | | allocated QoS | separation to | | | | profile: | traffic | | | | relative | classes, | | | | priority, | enforced via | | | | latency, | queues (Note | | | | packet loss | 4); | | | | ratio; for GBR | | | | | flows also | - The access | | | | minBR + maxBR | network may be | | | | | aware of | | | | - May use | multiple | | | | access | \"sessions\" | | | | specific PCC | (e.g. using | | | | rules (3GPP/ | multiple VLANs | | | | N3G) | per RG) and | | | | | manage the QoS | | | | | in them | | | | | separately | | +----------------+----------------+----------------+----------------+ | | - NGRAN: QoS | - QoS flows | | | | flows mapped | mapped to | | | | to bearers | child SAs | | | | | | | | | - Absolute | QoS mechanism | | | | and relative | to be used on | | | | prioritisation | non-3GPP | | | | algorithms in | access (UE to | | | | the RAN | N3IWF), e.g. | | | | resource | DSCP marking | | | | scheduler, | based on QoS | | | | acting on | flows or child | | | | bearers, but | SAs is NOT | | | | trying to meet | defined by | | | | individual QoS | 3GPP | | | | flow | | | | | requirements | | | | | | | | | | - For GBR | | | | | bearers: RAN | | | | | admission | | | | | control and | | | | | indicates when | | | | | GBR is not met | | | +----------------+----------------+----------------+----------------+ | NOTE 1: \"All | | | | | traffic\" | | | | | typically | | | | | tethered, | | | | | therefore not | | | | | app driven. | | | | | | | | | | NOTE 2: GBR | | | | | bearers are | | | | | exempt from | | | | | AMBR. | | | | | | | | | | NOTE 3: | | | | | \"Absolute\" | | | | | MaxBR limit is | | | | | used - there | | | | | is no | | | | | exception e.g. | | | | | for GBR | | | | | traffic. | | | | | | | | | | NOTE 4: | | | | | Multiple | | | | | queues can be | | | | | used internal | | | | | to BNG/RG that | | | | | map to same TC | | | | | on the access. | | | | | | | | | | NOTE 5: There | | | | | is no | | | | | mechanism | | | | | defined for | | | | | the core | | | | | network (other | | | | | than ACS) | | | | | indicating any | | | | | QoS | | | | | c | | | | | ategorisation/ | | | | | p | | | | | rioritisation. | | | | +----------------+----------------+----------------+----------------+
Table 6.29.1-3: comparison of QoS mechanisms used in 5GC (trusted and
untrusted access) and existing BBF networks (before WWC)
+----------------+----------------+----------------+----------------+ | Network | 5GC with | 5GC with | BBF (existing | | | NG-RAN | untrusted | / before WWC) | | | | non-3GPP | | | | | access | | +----------------+----------------+----------------+----------------+ | QoS mechanism | | | | +----------------+----------------+----------------+----------------+ | Traffic | - (AF), PCF, | - BNG | | | prioritisation | SMF allocating | typically uses | | | DL | p | DSCP marking | | | | olicies/packet | provided by | | | | detection | remote | | | | rules and | e | | | | forwarding | nd/application | | | | actions | (where this is | | | | | preserved) | | | | - UPF: | | | | | mapping | - BNG marking | | | | traffic to QoS | DL packets for | | | | flows, QFI | transport | | | | indication | specific QoS | | | | added (GTP | means, e.g. | | | | header on N3), | p-bits | | | | QoS marking | | | | | for underlying | - This | | | | transport | possible based | | | | | on DL packet | | | | | marking by | | | | | application, | | | | | BNG local | | | | | configuration | | | | | and Radius | | | | | policies | | +----------------+----------------+----------------+----------------+ | | NG-RAN (gNB, | Core: mapping | | | | eNB), mapping | traffic to QoS | | | | QoS flows to | flows; N3IWF: | | | | DRABs, then | IPsec SAs. | | | | resource | | | | | scheduler | QoS mechanism | | | | acting on | on access not | | | | DRABs. | defined by | | | | | 3GPP | | +----------------+----------------+----------------+----------------+ | Traffic | - UE: mapping | - RG to mark | | | p | traffic to QoS | packets with | | | rioritisation: | flows & | to access | | | UL | prioritises | specific QoS | | | | its own | marking (e.g. | | | | traffic, based | p-bits); | | | | on | typically | | | | | based on | | | | - PCC rules | application | | | | received via | marking | | | | NAS signalling | received from | | | | and/or | end devices or | | | | | it may use | | | | - QoS flow ID | local policies | | | | + Reflective | for this, | | | | QoS | provisioned | | | | indication, | via TR-69. | | | | received in DL | (Note 5) | | | | packets | | | +----------------+----------------+----------------+----------------+ | | - UE also | - UE: mapping | | | | maps traffic | traffic to | | | | to DRABs | IPsec SAs. | | | | (based on info | | | | | from RAN) | - QoS | | | | | mechanism on | | | | - NG-RAN | access not | | | | (gNB, eNB), | defined by | | | | resource | 3GPP | | | | scheduler | | | | | acting on | | | | | DRABs | | | +----------------+----------------+----------------+----------------+ | NOTE 1: \"all | | | | | traffic\" | | | | | typically | | | | | tethered, | | | | | therefore not | | | | | app driven. | | | | | | | | | | NOTE 2: GBR | | | | | bearers are | | | | | exempt from | | | | | AMBR. | | | | | | | | | | NOTE 3: | | | | | \"absolute\" | | | | | MaxBR limit is | | | | | used - there | | | | | is no | | | | | exception e.g. | | | | | for GBR | | | | | traffic. | | | | | | | | | | NOTE 4: | | | | | multiple | | | | | queues can be | | | | | used internal | | | | | to BNG/RG that | | | | | map to same TC | | | | | on the access. | | | | | | | | | | NOTE 5: there | | | | | is no | | | | | mechanism | | | | | defined for | | | | | the core | | | | | network (other | | | | | than ACS) | | | | | indicating any | | | | | QoS | | | | | c | | | | | ategorisation/ | | | | | p | | | | | rioritisation. | | | | +----------------+----------------+----------------+----------------+
### 6.29.2 Proposal for 5WWC QoS control framework
The tables in this clause contain a proposal along the same tasks as the 5GC
and BBF networks have been compared - with the aim being to take the BBF
access specific characteristics into consideration.
Table 6.29.2-1: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Traffic | Up to 15 | Multiple | | | | separation | PDU | PDU | | | | to sessions | sessions | sessions | | | | | (each with | but only | | | | | own IP | 1:1 VLAN to | | | | | addr | PDU session | | | | | ess/prefix) | mapping | | | | | in max 8 | | | | | | network | Single PDU | | | | | slices | session for | | | | | | interne | | | | | Note: each | t/corporate | | | | | PDU session | access | | | | | has its | | | | | | default QoS | RG is | | | | | flow with | completely | | | | | specific | ignorant of | | | | | 5QI | any 5GC | | | | | | means. | | | | | Wireline, | support | | | | | FWA or | traffic | | | | | hybrid | mapping to | | | | | access (HA) | VLANs | | | | | | and/or | | | | | 5G-RG | tunnels as | | | | | should | per | | | | | support | existing | | | | | multiple | BBF | | | | | PDU | functions | | | | | sessions | | | | | | and | | | | | | multiple | | | | | | network | | | | | | slices | | | | | | | | | | | | But the RG | | | | | | has no | | | | | | visibility | | | | | | of the | | | | | | a | | | | | | pplications | | | | | | (without | | | | | | DPI) cannot | | | | | | use URSP | | | | | | (as RG is a | | | | | | proxy) to | | | | | | steer | | | | | | a | | | | | | pplications | | | | | | to | | | | | | slic | | | | | | es/DNNs/PDU | | | | | | sessions. | | | | | | | | | | | | Single PDU | | | | | | session for | | | | | | generic | | | | | | interne | | | | | | t/corporate | | | | | | access | | | | | | provided | | | | | | for the LAN | | | | | | users of | | | | | | the RG | | | | | | | | | | | | Optionally, | | | | | | use RG | | | | | | co | | | | | | nfiguration | | | | | | to steer | | | | | | specific | | | | | | traffic to | | | | | | dedicated | | | | | | PDU | | | | | | sessions | | | | | | (DN | | | | | | Ns/slices). | | | | | | TBA whether | | | | | | URSP or | | | | | | T | | | | | | R-69/TR-181 | | | | | | extensions | | | | | | should be | | | | | | used for | | | | | | \"internal | | | | | | apps\" in | | | | | | RG (e.g. RG | | | | | | mgmt., SIP | | | | | | client etc) | | | | | | | | | | | | RG is to | | | | | | initiate | | | | | | sessions | | | | | | when | | | | | | relevant | | | | | | traffic is | | | | | | requested. | | | | | | | | | | | | Example | | | | | | traffic | | | | | | cases for | | | | | | dedicated | | | | | | PDU | | | | | | session: | | | | | | SSIDs | | | | | | (community | | | | | | WiFi, \"5GC | | | | | | UE behind | | | | | | RG\" | | | | | | scenario), | | | | | | IMS | | | | | | (traffic | | | | | | from SIP | | | | | | client or | | | | | | built-in | | | | | | SIP stack), | | | | | | devices | | | | | | di | | | | | | stinguished | | | | | | via MAC | | | | | | address, RG | | | | | | management | | | | | | | | | | | | Ongoing BBF | | | | | | study | | | | | | SD-406 is | | | | | | not aligned | | | | | | with 3GPP | | | | | | slicing | | | | | | concepts; | | | | | | TBA if/how | | | | | | that is to | | | | | | be | | | | | | considered | | | | | | in Rel-16. | | | | | | As the | | | | | | motivation | | | | | | in SD-406 | | | | | | is at least | | | | | | partly QoS | | | | | | based, this | | | | | | should be | | | | | | made part | | | | | | of the QoS | | | | | | related | | | | | | decisions | | | | +-------------+-------------+-------------+-------------+-------------+ | | NG-RAN to | Optional | L-AGF shall | FMIF may | | | map each | support for | support 1:1 | support | | | PDU session | multiple | VLAN to PDU | multiple | | | to own set | PDU | session | PDU | | | of RABs | sessions on | mapping | sessions, | | | | the BBF | | assuming | | | | access, | | VLANs on | | | | with the | | BNG are | | | | following | | extended to | | | | sub-options | | FMIF | | | | | | | | | | RG & AGF to | | | | | | support | | | | | | multiple | | | | | | PDU | | | | | | sessions | | | | | | multiplexed | | | | | | to a VLAN | | | | | | | | | | | | Static | | | | | | mapping of | | | | | | DNNs (and | | | | | | PDU | | | | | | sessions) | | | | | | to VLANs | | | | | | | | | | | | A | | | | | | combination | | | | | | of these | | | | | | may be used | | | | | | | | | | | | Optional | | | | | | support of | | | | | | multiple | | | | | | network | | | | | | slices in | | | | | | AGF | | | +-------------+-------------+-------------+-------------+-------------+
Table 6.29.2-3: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Traffic | QoS flows | Only single | | | | separation | in core | access PDU | | | | within a | (based on | sessions | | | | session | traffic | (using the | | | | | filters | BBF access) | | | | | such as IP | are in | | | | | flows, | scope | | | | | application | | | | | | ID, ... ) | QoS flows | | | | | | cannot be | | | | | Traffic | signalled | | | | | mapping to | E2E. | | | | | QoS flows / | However, | | | | | policy | PCC rules | | | | | control | may be | | | | | shall be | acted on | | | | | supported | the DL | | | | | for frame | traffic, | | | | | routes and | which is | | | | | frame IPv6 | more | | | | | routes as | critical | | | | | well, i.e. | for | | | | | traffic | resource | | | | | filters can | constraints | | | | | be specific | than UL. | | | | | to local | Therefore, | | | | | IPv4 | we propose | | | | | addresses | to keep 5GC | | | | | or cover | based QoS | | | | | more than a | control as | | | | | /64 IPv6 | optional | | | | | prefix | part of the | | | | | | solution | | | | | For HA RG: | for FN-RG. | | | | | | | | | | | Single | Propose new | | | | | access | \"QoS | | | | | sessions, | capability | | | | | access type | i | | | | | selection | ndication\" | | | | | based on | - by the | | | | | ANDSP rules | FAGF - for | | | | | | support of | | | | | M | 3GPP QoS | | | | | ulti-access | mechanism, | | | | | sessions | i.e. make | | | | | can be | the whole | | | | | supported | QoS | | | | | optionally, | framework | | | | | with ATSSS | optional, | | | | | rules used | with SMF | | | | | for access | involving | | | | | type | PCF only if | | | | | select | the | | | | | ion/steerin | capability | | | | | g/splitting | is \"on\". | | | | | (probably | | | | | | with | When that | | | | | li | capability | | | | | mitations). | is | | | | | | indicated, | | | | | | 5GC core | | | | | | might use | | | | | | dynamic | | | | | | policies | | | | | | for QoS | | | | | | flows, but | | | | | | operators | | | | | | should be | | | | | | aware that | | | | | | only DL is | | | | | | acted on, | | | | | | based on | | | | | | N2+N3 | | | | | | signaling. | | | | | | For UL | | | | | | traffic, no | | | | | | policy | | | | | | control | | | | | | based QoS | | | | | | can be | | | | | | used. | | | | | | | | | | | | It should | | | | | | be agreed | | | | | | whether to | | | | | | use QoS | | | | | | signalling | | | | | | on N1. It | | | | | | is not | | | | | | needed, so | | | | | | the | | | | | | question is | | | | | | only | | | | | | whether | | | | | | keeping it | | | | | | reduces | | | | | | changes in | | | | | | 5GC. | | | | | | | | | | | | RQoS cannot | | | | | | and shall | | | | | | not be | | | | | | used. | | | +-------------+-------------+-------------+-------------+-------------+ | | QoS flows | AGF and | L-AGF to | 5GC based | | | maps to | 5G-RG to | provide the | policy | | | data | map traffic | \"QoS | control can | | | bearers | to QoS | capability | clash with | | | (DRABs) in | flows | in | the | | | the RAN | | dication\", | AAA/Radius | | | | AGF to | depending | based one, | | | | support | on network | therefore | | | | N2/N3 | co | only one of | | | | signalling | nfiguration | them should | | | | for QoS | | be used in | | | | flows | If it | one | | | | | indicated | network. | | | | RG to | \"QoS | | | | | support PCC | support\", | If 5GC | | | | rules on | the L-AGF | based | | | | NAS | shall map | policies | | | | signalling | Qos flows | are used, | | | | | in DL | FMIF will | | | | Optional | traffic to | indicate | | | | support on | access | the new | | | | AGF, AN and | specific | \"QoS | | | | RG for | traffic | ca | | | | QFI+RQI | classes, | pability\", | | | | transport | based on | based on | | | | and thus | QoS | network | | | | RQoS (See | signalling | con | | | | details | received | figuration. | | | | later). | over N1, N2 | In this | | | | | and N3. | case, FMIF | | | | | | + BNG will | | | | | | map QoS | | | | | | flows to | | | | | | access | | | | | | specific | | | | | | TCs, based | | | | | | on N2/N3 | | | | | | signalling. | +-------------+-------------+-------------+-------------+-------------+
Table 6.29.2-4: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Shaping | UE and DNN | As per | | | | mechanisms | level max | existing | | | | (max | bitrate | BBF | | | | bitrate | (Aggregated | solution, | | | | control) | Max BR, | the FN-RG | | | | | AMBR), | is expected | | | | | based on | to be | | | | | UDM | configured | | | | | s | with what | | | | | ubscription | is \"UE | | | | | | level UL | | | | | For HA RG, | AMBR\", | | | | | separate | i.e. max | | | | | AMBR values | access line | | | | | shall be | bitrate for | | | | | defined for | UL traffic | | | | | the 2 | - via | | | | | access | TR-069. | | | | | types. | This should | | | | | | be the only | | | | | QoS flow | traffic | | | | | level max | shaping | | | | | BR control | means used | | | | | based on | for UL. | | | | | static or | (i.e. no | | | | | dynamic | traffic | | | | | policy | shaping in | | | | | rules | UPF). | | | | | | | | | | | DNN level | For | | | | | AMBR: for | multiple | | | | | DL traffic | VLANs (i.e. | | | | | is enforced | multiple | | | | | by UPF. | PDU | | | | | | sessions in | | | | | For HA RG, | 5GC), the | | | | | UPF/the | FN-RG does | | | | | ATSSS rule | both RG | | | | | shall | level and | | | | | enforce the | VLAN level | | | | | AMBR per | shaping for | | | | | access. | UL. | | | | | | | | | | | QoS flow | UPF may | | | | | level | provide DNN | | | | | shaping for | and QoS | | | | | GBR QoS | flow level | | | | | flows | traffic | | | | | (maxBR): | shaping for | | | | | propose to | DL (based | | | | | support GBR | on UDM data | | | | | only on | and PCC | | | | | wireless | rules, | | | | | access (see | res | | | | | details | pectively). | | | | | later). | | | | | | | | | | | | For HA RG, | | | | | | any GBR QoS | | | | | | flow is | | | | | | then to be | | | | | | steered to | | | | | | 3GPP access | | | | | | (ATSSS | | | | | | rules need | | | | | | to be | | | | | | aligned | | | | | | with PCC | | | | | | rules) and | | | | | | QoS level | | | | | | shaping | | | | | | enforced by | | | | | | RAN. | | | | +-------------+-------------+-------------+-------------+-------------+ | | GBR bearers | UE (RG) | UE level | Depending | | | shall be | level AMBR | AMBR shall | whether | | | supported | shall be | be enforced | policy | | | by 5G-RG | enforced by | by L-AGF | control in | | | and they | AGF for DL | for DL. | in AAA or | | | are exempt | and 5G-RG | | in 5GC. | | | from AMBR | for UL. | AMF shall | | | | | | provide the | DL traffic | | | UE level | AMF shall | L-AGF with | shaping may | | | AMBR - for | provide the | the UE | be | | | wireless | AGF with | level DL | controlled | | | access - | the UE | AMBR at | via AAA | | | enforced by | level DL | re | based | | | RAN, both | AMBR at | gistration. | policies. | | | UL/DL | re | | | | | | gistration. | | AMF may | | | QoS flow | | | provide UE | | | level | 5G-RG shall | | level DL | | | shaping | be | | AMBR to | | | (MaxBR) | configured | | FMIF and | | | enforced by | via TR-69 | | FMIF shall | | | RAN | for the UE | | enforce it | | | | level UL | | then. | | | | AMBR. | | | | | | | | | | | | If | | | | | | supported, | | | | | | GBR bearers | | | | | | cannot be | | | | | | exempt of | | | | | | the UE and | | | | | | DNN level | | | | | | AMBR values | | | | | | defined for | | | | | | wireline | | | | | | access | | | | | | | | | | | | In the lack | | | | | | of dynamic | | | | | | resource | | | | | | control in | | | | | | the fixed | | | | | | AN, TC | | | | | | level | | | | | | shaping is | | | | | | also | | | | | | required in | | | | | | AGF and | | | | | | 5G-RG,. The | | | | | | TC level | | | | | | shaping may | | | | | | require | | | | | | \"TC | | | | | | overflow\" | | | | | | being used. | | | +-------------+-------------+-------------+-------------+-------------+
Table 6.29.2-5: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Traffic | Static & | The | | | | pri | dynamic | limitations | | | | oritisation | policy (& | in applying | | | | mechanisms | charging) | 5GC based | | | | (general) | control in | QoS are | | | | | each | exaggerated | | | | | session, | further | | | | | mapping | (compared | | | | | traffic to | to 5G-RG | | | | | QoS flows - | case for | | | | | packets in | AGF) by the | | | | | which will | fact that | | | | | receive | the FN-RG | | | | | same | will be | | | | | treatment. | ignorant to | | | | | | any QoS | | | | | QoS flows | control | | | | | allocated | that is | | | | | QoS | provided in | | | | | profile: | the core | | | | | relative | network. | | | | | priority, | There is a | | | | | latency, | strong | | | | | packet loss | split in | | | | | ratio; for | the 2 | | | | | GBR flows | directions: | | | | | also minBR | | | | | | + maxBR. | - QoS | | | | | | control for | | | | | May use | the UL will | | | | | access | remain | | | | | specific | unchanged | | | | | PCC rules | (i.e. use | | | | | (3GPP/ BBF | the | | | | | access). | existing | | | | | | BBF | | | | | | mechanism). | | | | | | This also | | | | | | means that | | | | | | any UL QoS | | | | | | management | | | | | | functions | | | | | | shall be | | | | | | provisioned | | | | | | via TR-69, | | | | | | as done | | | | | | today. | | | | | | | | | | | | - QoS | | | | | | control for | | | | | | DL may be | | | | | | improved. | | | +-------------+-------------+-------------+-------------+-------------+ | | NGRAN: QoS | One major | The L-AGF | The PCC | | | flows | difference | can provide | based QoS | | | mapped to | from 3GPP | similar | control may | | | bearers. | access is | functions | provide | | | | that the UL | for QoS | more | | | Absolute | and DL | control to | flexible | | | and | directions | those | pri | | | relative | are | provided by | oritisation | | | pri | controlled | AGF for the | in the DL, | | | oritisation | separately | 5G-RG. (The | but this | | | algorithms | and quite | only | will | | | in the RAN | in | difference | strongly | | | resource | dependently | is in RQoS | depend on | | | scheduler, | - by the RG | support | the | | | acting on | and the | that is | interaction | | | bearers, | AGF, | N/A). | between the | | | but trying | r | | BNG and the | | | to meet | espectively | | FMIF as | | | individual | - so all | | well as AAA | | | QoS flow | evaluation | | to BNG QoS | | | re | is provided | | control. | | | quirements. | for UL and | | | | | | DL (see | | There is a | | | For GBR | next | | strong | | | bearers: | slides). | | potential | | | RAN | | | for clash | | | admission | Another | | in the AAA | | | control and | major | | based and | | | indicates | difference | | 5GC based | | | when GBR is | is that | | QoS control | | | not met. | dynamic | | and this | | | | resource | | puts the | | | | reservation | | completion | | | | in the | | of work at | | | | fixed AN | | risk, | | | | (using | | unless it | | | | ARCF) is | | is decided | | | | not an | | to use one | | | | existing | | or the | | | | capability | | other at | | | | in most | | one time / | | | | networks. | | for one UE. | | | | Therefore, | | BBF should | | | | we propose | | study how | | | | not to | | to avoid | | | | support GBR | | clashes. | | | | bearers in | | | | | | the 3GPP / | | | | | | 5GC term | | | | | | (e.g. | | | | | | 5QI=1..4). | | | | | | For BBF | | | | | | access, | | | | | | bitrates | | | | | | can be | | | | | | guaranteed | | | | | | via TCs, | | | | | | if/as long | | | | | | as only | | | | | | certain QoS | | | | | | flows are | | | | | | mapped to a | | | | | | TC. | | | | | | | | | | | | QoS | | | | | | char | | | | | | acteristics | | | | | | for the | | | | | | 3GPP | | | | | | defined | | | | | | 5QIs may | | | | | | not be | | | | | | realistic | | | | | | or | | | | | | appropriate | | | | | | (desirable) | | | | | | for | | | | | | wireline | | | | | | access | | | | | | networks. | | | | | | We propose | | | | | | to review | | | | | | them and if | | | | | | needed, | | | | | | define new | | | | | | ones for | | | | | | BBF access. | | | +-------------+-------------+-------------+-------------+-------------+
Table 6.29.2-6: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Traffic | (AF), PCF, | Static | | | | prio | SMF | policies | | | | ritisation: | allocating | may be used | | | | DL | poli | by PCF/SMF | | | | | cies/packet | in line | | | | | detection | with the UL | | | | | rules and | scheme | | | | | forwarding | | | | | | actions. | Alt | | | | | | ernatively, | | | | | UPF maps DL | full set of | | | | | packets to | 5GC policy | | | | | QoS flows | control may | | | | | and adds | be used, | | | | | QFI | but | | | | | indication | ac | | | | | added (GTP | knowledging | | | | | header), it | this is | | | | | marks | only acted | | | | | packets as | on in the | | | | | required | DL | | | | | for | direction. | | | | | underlying | This | | | | | transport | requires | | | | | used on N3. | \"DL-only | | | | | | PCC rules\" | | | | | Optionally, | to be | | | | | UPF | de | | | | | provides | fined/used. | | | | | RQI marking | | | | | | as well (as | Use ToS | | | | | requested | based PCC | | | | | by PCF/SMF, | rules to | | | | | based on RG | observe DL | | | | | capability | QoS marks | | | | | i | provided in | | | | | ndication). | DNN. | | | | | | | | | | | Note: in | RQI is N/A. | | | | | general, | | | | | | the 5GC | | | | | | does not | | | | | | observe the | | | | | | QoS marking | | | | | | in the DL | | | | | | packets | | | | | | received | | | | | | from DNN. | | | | | | PCC rules | | | | | | with ToS | | | | | | based | | | | | | traffic | | | | | | filters can | | | | | | be used to | | | | | | achieve | | | | | | this. Same | | | | | | rules apply | | | | | | to RG/UL. | | | | +-------------+-------------+-------------+-------------+-------------+ | | NG-RAN | AGF is | Same as | FMIF | | | (gNB, eNB), | expected to | 5G-AGF for | mapping the | | | mapping QoS | use the QoS | using the | QoS flows | | | flows to | flows as | QoS flows | to DSCP or | | | DRABs, then | input to | in | VLAN PCP | | | resource | internal | enforcing | codes for | | | scheduler | queues. | the UE | BNG. BNG | | | acting on | When | level AMBR | following | | | DRABs. | enforcing | DL and | same QoS | | | | the UE | marking | mapping | | | | level AMBR | packets | towards AN | | | | DL, it | with access | as before | | | | shall take | specific | 5GC | | | | the QoS | traffic | in | | | | profile of | classes. | terworking. | | | | the flows | | | | | | into | RQoS is | | | | | con | N/A. | | | | | sideration. | | | | | | | | | | | | AGF marks | | | | | | packet with | | | | | | access | | | | | | specific | | | | | | traffic | | | | | | classes; | | | | | | fixed AN | | | | | | p | | | | | | rioritising | | | | | | packets | | | | | | accordingly | | | | | | | | | | | | (See AGF | | | | | | support for | | | | | | RQoS in the | | | | | | UL | | | | | | de | | | | | | scription). | | | +-------------+-------------+-------------+-------------+-------------+
Table 6.29.2-7: Comparison of QoS mechanisms WWC scenarios
+-------------+-------------+-------------+-------------+-------------+ | | 5G-RG with | W-5GAN | | | | | NG-RAN and | access | | | | | 5GC | | | | +-------------+-------------+-------------+-------------+-------------+ | | | Integration | Legacy | I | | | | scenario | integration | nterworking | | | | | scenario | scenario | | | | (5G-RG / | | | | | | 5G-AGF | (F | (FN-RG / | | | | | N-RG/L-AGF) | BBF core + | | | | | | FMIF) | +-------------+-------------+-------------+-------------+-------------+ | Traffic | 5G-RG: | Only static | | | | prio | mapping | policies - | | | | ritisation: | traffic to | pre | | | | UL 4 | QoS flows, | -configured | | | | | based on | to the | | | | | PCC rules | FN-RG - can | | | | | received | be used to | | | | | via NAS | map UL | | | | | signalling. | packets to | | | | | | TC classes | | | | | For RG used | on the | | | | | in wireline | wireline | | | | | access or | AN. (I.e. | | | | | HA, the | 5GC QoS | | | | | network | concepts | | | | | operator | are not | | | | | shall | used). | | | | | ensure that | | | | | | RG is | Rely on | | | | | configured | existing UL | | | | | via TR-069 | queueing | | | | | to indicate | from RG. | | | | | RQI support | | | | | | only if the | | | | | | AGF and | | | | | | wireline AN | | | | | | supports | | | | | | QFI+RQI in | | | | | | DL. | | | | +-------------+-------------+-------------+-------------+-------------+ | | For HA | Optionally, | L-AGF will | No QoS | | | 5G-RG: | if both the | use default | control | | | optionally, | RG supports | QoS flow | provided on | | | if | RQoS and | for the UL | UL; the BNG | | | capability | the | packets on | and the | | | is | wireline AN | N3 (reverse | FMIF are | | | supported | supports | mapping | expected to | | | on wireline | the | from TC to | preserve | | | access, | transport | QoS flow is | QoS marking | | | 5G-RG may | of QFI+RQI | only | in the UP | | | use RQoS | in DL, then | possible if | packet, as | | | for the UL | 5G-RG may | the | provided by | | | mapping to | also use | policies in | the RG / | | | QoS flows. | RQoS for | 5GC are | the end | | | | mapping UL | completely | user device | | | Propose to | packets to | static), | behind it. | | | define RQoS | QoS flows. | but it may | | | | support | | use traffic | | | | optional | For this, | classes | | | | also for | AGF shall | used on the | | | | 5G-RG used | include | AN to | | | | for FWA. | QFI+RQI in | provide QoS | | | | | DL packets | marking for | | | | 5G-RG also | sent to | the | | | | maps | 5G-RG. For | underlying | | | | traffic to | this, a new | transport | | | | DRABs | shim layer | for N3. | | | | (based on | is to be | | | | | info from | defined by | | | | | RAN) | BBF, which | | | | | | is TBA. | | | | | NG-RAN | | | | | | (gNB, eNB), | Note: VLAN | | | | | resource | tag could | | | | | scheduler | only | | | | | acting on | support 7 | | | | | DRABs. | QFIs i.e. | | | | | | QFI=5QI | | | | | | could not | | | | | | be used. It | | | | | | is proposed | | | | | | not to use | | | | | | it for QFI | | | | | | transport. | | | | | | | | | | | | 5G-RG | | | | | | mapping the | | | | | | QoS flows | | | | | | to access | | | | | | specific | | | | | | traffic | | | | | | classes; | | | | | | fixed AN | | | | | | acting | | | | | | a | | | | | | ccordingly. | | | | | | | | | | | | The RQoS | | | | | | may | | | | | | conflict | | | | | | with the TC | | | | | | throughput | | | | | | limits, | | | | | | therefore | | | | | | the RG may | | | | | | need to | | | | | | overflow | | | | | | the traffic | | | | | | to other | | | | | | TCs then | | | | | | what is | | | | | | defined per | | | | | | mapping | | | | | | rules. This | | | | | | means the | | | | | | QoS flow | | | | | | char | | | | | | acteristics | | | | | | may not be | | | | | | met. | | | | | | Alt | | | | | | ernatively, | | | | | | the RG may | | | | | | throttle | | | | | | the RQI | | | | | | traffic but | | | | | | keep the | | | | | | TC. | | | | | | | | | | | | The RG may | | | | | | also modify | | | | | | DSCP | | | | | | marking in | | | | | | uplink | | | | | | packets, n | | | | | | line with | | | | | | the QoS | | | | | | flow / the | | | | | | 5QI in the | | | | | | RQI | | | | | | traffic. | | | | | | This can | | | | | | align the | | | | | | UL/DL | | | | | | traffic for | | | | | | ap | | | | | | plications. | | | +-------------+-------------+-------------+-------------+-------------+
### 6.29.3 Critical decisions and proposed way forward
The following tables include decision to be taken for addressing QoS Key
Issue.
Table 6.29.3-1: Decision to be addressed
+----+---------------+---------------+---------------+---------------+ | No | Required | Alternatives | Proposal | Comments | | | decision | | | | +----+---------------+---------------+---------------+---------------+ | | | | | | +----+---------------+---------------+---------------+---------------+ | 1 | Usage of 5QIs | 1) Use | use existing | The QFI | | | and QoS | existing | QFI | represents | | | ch | 5QIs. | | the upper | | | aracteristics | | | bound value | | | | 2) Revise | | for the QoS | | | | the | | parameters in | | | | applicability | | order to | | | | of 5QIs and | | support a | | | | define new | | given | | | | ones. | | service. When | | | | | | received in | | | | | | Wireline | | | | | | access | | | | | | network they | | | | | | can been | | | | | | enforced with | | | | | | more | | | | | | stringent | | | | | | values. To | | | | | | maintain the | | | | | | same QFI in | | | | | | term of upper | | | | | | bound will | | | | | | simplify the | | | | | | case where an | | | | | | IP flow can | | | | | | be supported | | | | | | other | | | | | | Wireline | | | | | | access and NG | | | | | | RAN, such as | | | | | | in HA. | | | | | | | | | | | | if there is | | | | | | specific | | | | | | needs for | | | | | | additional | | | | | | QFI value for | | | | | | specific | | | | | | wireline | | | | | | services | | | | | | (e.g. 4K TV | | | | | | support) this | | | | | | might be | | | | | | considered | | | | | | based on | | | | | | requests. | +----+---------------+---------------+---------------+---------------+ | 2 | Traffic | 1) Use 5G-RG | 3GPP | - To perform | | | shaping on UL | as trusted | specification | the traffic | | | for | part of the | does not | shaping at | | | | solution. | preclude that | overlay level | | | | | both RG and | in both 5G-RG | | | | 2) Use also | AGF can apply | and AGF does | | | | AGF to apply | traffic | not represent | | | | shaping by | shaping for | an issue. | | | | discarding | UL | | | | | traffic. | | - The | | | | | | traffic | | | | | | shaping needs | | | | | | to consider | | | | | | whether the | | | | | | New Total | | | | | | Traffic per | | | | | | UE would be | | | | | | introduced | | | | | | and whether | | | | | | the UE --AMBR | | | | | | would be | | | | | | considered | | | | | | valid (see | | | | | | solution | | | | | | #26). | | | | | | | | | | | | In general to | | | | | | perform | | | | | | traffic | | | | | | shaping in 2 | | | | | | different | | | | | | network | | | | | | functions | | | | | | does not | | | | | | represent an | | | | | | issue when | | | | | | this produces | | | | | | a limited | | | | | | amount of | | | | | | discarded | | | | | | packets. From | | | | | | other hand in | | | | | | any condition | | | | | | where the | | | | | | amount of | | | | | | discarded | | | | | | packets is | | | | | | elevated , | | | | | | for example | | | | | | in case of | | | | | | congestion, | | | | | | the effect on | | | | | | QoS and | | | | | | charging may | | | | | | be | | | | | | significant. | +----+---------------+---------------+---------------+---------------+ | 3 | Support of | 1) RQoS | The 3GPP RQoS | 3GPP assumes | | | RQoS for | support shall | mechanism is | that there is | | | FN-RG | not be | support as | no need to | | | | indicated by | defined and | change 3GPP | | | | FAGF | rely on the | specification | | | | supporting | indication | of RQoS | | | | FN-RG. | provided by | mechanism. In | | | | | AGF/FMIF | fact the | | | | 2) Use RQoS | whether | W-5GAN can | | | | also for | supported or | indicate | | | | FN-RG. | not | whether RQoS | | | | | | is support or | | | | | | not. | | | | | | | | | | | | In | | | | | | interworking | | | | | | scenario if | | | | | | the | | | | | | Reflective | | | | | | QoS are not | | | | | | supported, | | | | | | the AGF/FMIF | | | | | | shall | | | | | | indicate that | | | | | | RQoS is not | | | | | | supported at | | | | | | PDU session | | | | | | e | | | | | | stablishment, | | | | | | so the | | | | | | explicitly | | | | | | signally of | | | | | | QoS will take | | | | | | place. | | | | | | | | | | | | Alternatively | | | | | | it can be | | | | | | signalled to | | | | | | be supported | | | | | | and the | | | | | | interworking | | | | | | function | | | | | | (AGF/FMIF) | | | | | | will act as | | | | | | considered | | | | | | suitable | | | | | | (e.g. | | | | | | performing | | | | | | traffic | | | | | | shaping or | | | | | | traffic class | | | | | | mapping). The | | | | | | decision | | | | | | whether to | | | | | | support both | | | | | | approaches or | | | | | | limited to a | | | | | | single one is | | | | | | left to BBF | | | | | | decision | +----+---------------+---------------+---------------+---------------+
Table 6.29.3-2: Decision to be addressed
+----+---------------+---------------+---------------+---------------+ | No | Required | Alternatives | Proposal | Comments | | | decision | | | | +----+---------------+---------------+---------------+---------------+ | | | | | | +----+---------------+---------------+---------------+---------------+ | 4 | TC level | 1) Define | BBF inputs | For GBR | | | shaping / | strict | are expected. | flows, the | | | \"TC | mapping from | | overflow | | | overflow\" | QoS flows to | This issue | could trigger | | | (flexible | TCs and let | will be | indication of | | | mapping to | traffic be | solved in | the GBR | | | TC) | throttled if | normative | ch | | | | needed or | phase, if | aracteristics | | | | thrown away. | needed. | not being met | | | | | | | | | | 2) Provide | | The GBR | | | | flexible | | services is | | | | mapping to | | considered | | | | TCs and | | supported in | | | | \"overflow\" | | Untrusted and | | | | to next | | Trusted N3GPP | | | | priority TC | | access | | | | when TC | | network where | | | | limits | | the | | | | exceeded. | | enforcement | | | | | | is in reality | | | | | | performed via | | | | | | priority | | | | | | management of | | | | | | packets and | | | | | | the exact | | | | | | bandwidth | | | | | | value is not | | | | | | strictly | | | | | | enforced. The | | | | | | same | | | | | | consideration | | | | | | can apply to | | | | | | W-5GAN. | | | | | | However the | | | | | | maximum GBR | | | | | | can be | | | | | | enforced via | | | | | | Traffic | | | | | | Shaping. | | | | | | | | | | | | 3GPP does not | | | | | | have | | | | | | exces | | | | | | sive/overflow | | | | | | of Traffic | | | | | | Class. | | | | | | | | | | | | **Question to | | | | | | BBF** : Can TC | | | | | | level shaping | | | | | | in W-5GAN | | | | | | entities | | | | | | (5G-RG, AGF | | | | | | and FMIF) | | | | | | dynamically | | | | | | defined based | | | | | | on QoS | | | | | | received in | | | | | | N2/N1? | +----+---------------+---------------+---------------+---------------+ | 5a | RQoS support | 1) Mandate | Per current | NG RAN access | | | for 5G-RG on | RQoS support | 3GPP RQoS | support RQoS | | | FWA | for 5G-RG. | procedure the | mechanism per | | | | | usage of RQoS | TS 23 | | | | 2) RQoS | is | .501 [2]/TS | | | | support | ena | 23.502 [3] | | | | optional for | bled/disabled | & | | | | 5G-RG. | based on | TS | | | | | indication | 23.503 [8] | | | | | provided by | s | | | | | 5G-RG at PDU | pecification. | | | | | session | | | | | | establishment | Per 3GPP | | | | | | specification | | | | | | both | | | | | | alternatives | | | | | | are possible | | | | | | and 3GPP does | | | | | | not see | | | | | | issues on | | | | | | implementing | | | | | | the | | | | | | signalling. | | | | | | | | | | | | 3GPP assumes | | | | | | that also is | | | | | | case that | | | | | | RQoS will be | | | | | | not supported | | | | | | due decision | | | | | | and | | | | | | specification | | | | | | of BBF, the | | | | | | NAS | | | | | | signalling | | | | | | mechanism is | | | | | | supported and | | | | | | not changed. | +----+---------------+---------------+---------------+---------------+ | 5b | RQoS support | 1) Mandate | | The support | | | for 5G-RG HA | RQoS support | | for HA need | | | | for 5G-RG. | | further | | | | | | discussion | | | | 2) RQoS | | during | | | | support | | normative | | | | optional for | | phase. | | | | 5G-RG. | | | +----+---------------+---------------+---------------+---------------+ | 7 | Are network | 1) Dynamic | Existing | 3GPP assumes | | | slices to be | slice | slice | that current | | | used/invoked | invocation by | specification | mechanism of | | | for QoS? | 5G-RG, for | and QoS | slice | | | | satisfying | management in | selection and | | | | QoS. | PDU session | QoS | | | | | is supported. | management in | | | | 2) Find ways | | PDU session | | | | for reusing | | is supported. | | | | existing QoS | | | | | | concepts. | | The change of | | | | | | current | | | | | | principles of | | | | | | slice and QoS | | | | | | management | | | | | | has been not | | | | | | considered in | | | | | | this study. | +----+---------------+---------------+---------------+---------------+
Table 6.29.3-3: Decision to be addressed
+----+---------------+---------------+---------------+---------------+ | No | Required | Alternatives | Proposal | Comments | | | decision | | | | +----+---------------+---------------+---------------+---------------+ | | | | | | +----+---------------+---------------+---------------+---------------+ | 8 | Methods for | 1) Use URSP. | See | Whether | | | steering | | conclusion in | parameters | | | traffic for | 2) Use | clause X | need to be | | | RG\'s | TR-69/TR-181 | | added in | | | \"internal | extensions. | This aspects | URSP/ANDSF is | | | a | | will be | FFS and left | | | pplications\" | | considered in | to BBF | | | like SIP | | normative | co | | | client, | | phase. | nsiderations. | | | special SSID, | | | | | | connectivity | | | | | | for RG mgmt. | | | | +----+---------------+---------------+---------------+---------------+ | 9 | Should 5G QoS | 1) Apply as | BBF | , 5G QoS | | | be applied | for any other | r | mechanisms | | | for FN-RG | UE. | esponsibility | cannot be | | | case at all? | | to provide | used in UL | | | | 2) Make it | proposal | direction in | | | | optional / | whether | FN-RG. | | | | adjust for | interworking | | | | | reality. | in AGF/FMIF | 3GPP assumed | | | | | is not | that 5G QoS | | | | | possible | will be | | | | | | managed with | | | | | | access | | | | | | specific | | | | | | mechanism and | | | | | | based on 3GPP | | | | | | mechanism QoS | | | | | | modification | | | | | | or reject | | | | | | might be | | | | | | used. | | | | | | | | | | | | How to manage | | | | | | 5G QoS in | | | | | | W-5GAN is BBF | | | | | | decision and | | | | | | whether | | | | | | impact 3GPP | | | | | | needs to be | | | | | | considered | | | | | | based BBF | | | | | | request. | | | | | | | | | | | | In case of | | | | | | interworking | | | | | | where the | | | | | | operator may | | | | | | decide to | | | | | | keep using | | | | | | AAA based | | | | | | policies on | | | | | | BNG for the | | | | | | interworking | | | | | | model in that | | | | | | case the QoS | | | | | | via PCF may | | | | | | be not used. | | | | | | In this | | | | | | scenario | | | | | | whether QoS | | | | | | procedure may | | | | | | be impact is | | | | | | for further | | | | | | study in | | | | | | normative | | | | | | phase. | +----+---------------+---------------+---------------+---------------+ | 10 | Usage of N1 | 1) Remove N1 | BBF | It is assumed | | | signalling | signalling | r | AGF receives | | | for FN-RG | from SMF for | esponsibility | all required | | | case | FN-RG. | to provide | info N1 and | | | | | feedback on | N2 per | | | | 2) Send N1 | how N1/N2 are | current 3GPP | | | | QoS info but | supported and | s | | | | ignore in | where there | pecification. | | | | AGF/L-AGF | is impact to | | | | | (except | be considered | 3GPP assumed | | | | acknowledge | | that there is | | | | to SMF). | | no impact on | | | | | | N1/N2. | | | | 3) send N1 | | | | | | to AGF/FMIF | | | | | | which will | | | | | | perform the | | | | | | appropriate | | | | | | actions. | | | +----+---------------+---------------+---------------+---------------+ | 11 | RQoS support | 1) Mandatory | supported | Supported | | | on BBF access | for the | | according to | | | for 5G-RG | network and | | BBF | | | | RG. | | SD- | | | | | | 420v3 [26]. | | | | 2) Mandatory | | | | | | for the | | According to | | | | network and | | TS | | | | optional for | | 23.501 [2] | | | | RG (as in | | c | | | | 3GPP | | lause 5.7.5.1 | | | | sp | | If the 3GPP | | | | ecification). | | UE supports | | | | | | Reflective | | | | 3) Optional | | QoS | | | | for both | | f | | | | network RG. | | unctionality, | | | | | | the UE should | | | | | | indicate | | | | | | support of | | | | | | Reflective | | | | | | QoS to the | | | | | | network (i.e. | | | | | | SMF) for | | | | | | every PDU | | | | | | Session. | +----+---------------+---------------+---------------+---------------+
Table 6.29.3-4: Decision to be addressed
+-----+---------------+---------------+---------------+---------------+ | No | Required | Alternatives | Proposal | Comments | | | decision | | | | +-----+---------------+---------------+---------------+---------------+ | | | | | | +-----+---------------+---------------+---------------+---------------+ | 12 | Using ATSSS | 1) Use all | will be | The present | | | rules for HA | ATSSS rule | address in | TR assumes | | | 5G-RG | types as | normative | that ATSSS | | | | defined in | phase based | solution is | | | | TR | on ATSSS | applicable to | | | | 23.793 [4] | conclusion | WWC and | | | | for untrusted | | supported in | | | | non-3GPP | | 5G-RG and | | | | access. | | 5GC. | | | | | | | | | | 2) Provide | | | | | | separate | | | | | | evaluation | | | | | | and use only | | | | | | subset of the | | | | | | ATSSS rule | | | | | | types. | | | +-----+---------------+---------------+---------------+---------------+ | 13 | Traffic | 1) If RQoS | To be agreed | Resolution | | | shaping vs | is supported | | depends by | | | RQoS | and UL | | the | | | | traffic does | | resolution of | | | | not fit the | | Issue 4 | | | | TC limits, | | | | | | provide | | | | | | overflow. | | | | | | | | | | | | 2) Throttle | | | | | | traffic as | | | | | | required, if | | | | | | traffic is to | | | | | | be mapped to | | | | | | a given TC. | | | +-----+---------------+---------------+---------------+---------------+ | 14a | AGF support | 1) As any 5G | yes | Per 3GPP | | | for QoS flows | AN, AGF shall | | specification | | | for PDU | support the | | within the | | | session to | existing PCC | | 5GS, a QoS | | | 5G-RG | & QoS | | Flow is | | | (convergence) | framework, | | controlled by | | | | i.e. QoS | | the SMF and | | | | flows | | may be | | | | indicated | | p | | | | over N2/N3. | | reconfigured, | | | | | | or | | | | | | established | | | | | | via the PDU | | | | | | Session | | | | | | Establishment | | | | | | procedure | | | | | | (see | | | | | | TS | | | | | | 23.502 [3], | | | | | | c | | | | | | lause 4.3.2), | | | | | | or the PDU | | | | | | Session | | | | | | Modification | | | | | | procedure | | | | | | (see | | | | | | TS | | | | | | 23.502 [3] | | | | | | clause 4.3.3. | | | | | | | | | | | | 3GPP assume | | | | | | that QoS | | | | | | controlled by | | | | | | SMF are | | | | | | supported for | | | | | | convergence | | | | | | scenairo | +-----+---------------+---------------+---------------+---------------+ | 14b | AGF/FMIF | 1) As any 5G | as for issue | As in issue 9 | | | support for | AN, , AGF and | 9. | | | | QoS flows for | FMIF) shall | | | | | interworking | support the | | | | | | existing PCC | | | | | | & QoS | | | | | | framework, | | | | | | i.e. QoS | | | | | | flows | | | | | | indicated | | | | | | over N2/N3. | | | | | | | | | | | | 2) Allow | | | | | | exceptions, | | | | | | where | | | | | | AGF/FMIF | | | | | | signals that | | | | | | QoS framework | | | | | | is not | | | | | | usable. | | | +-----+---------------+---------------+---------------+---------------+
Table 6.29.3-5: Decision to be addressed
+----+---------------+---------------+---------------+---------------+ | No | Required | Alternatives | Proposal | Comments | | | decision | | | | +----+---------------+---------------+---------------+---------------+ | | | | | | +----+---------------+---------------+---------------+---------------+ | 15 | Support of | 1) Define | both are | The PCC rules | | | QoS flow for | DL-QoS flow | supported per | are only | | | FN-RG | for FN-RG. | 3GPP spec | relevant for | | | | | | SMF and they | | | | 2) Use only | | will be | | | | pre-defined | | executed by | | | | static rules, | | UPF. | | | | which will | | | | | | match those | | Within the | | | | set for the | | 5GS, a QoS | | | | 5G-RG in the | | Flow is | | | | UL direction. | | controlled by | | | | | | the SMF and | | | | | | may be | | | | | | p | | | | | | reconfigured, | | | | | | or | | | | | | established | | | | | | via the PDU | | | | | | Session | | | | | | Establishment | | | | | | procedure | | | | | | (see | | | | | | TS | | | | | | 23.502 [3], | | | | | | c | | | | | | lause 4.3.2), | | | | | | or the PDU | | | | | | Session | | | | | | Modification | | | | | | procedure | | | | | | (see | | | | | | TS | | | | | | 23.502 [3] | | | | | | clause 4.3.3 | | | | | | | | | | | | FN-RG will be | | | | | | ignorant to | | | | | | the 5GC\'s | | | | | | QoS | | | | | | mechanisms | | | | | | and use | | | | | | existing BBF | | | | | | mechanisms | | | | | | for UL | | | | | | traffic. The | | | | | | Interworking | | | | | | function | | | | | | shall perform | | | | | | the suitable | | | | | | action acting | | | | | | as UE in | | | | | | respect the | | | | | | 5GS. | +----+---------------+---------------+---------------+---------------+ | 16 | Using AAA vs | 1) Allow | under BBF | | | | PCC rules | parallel | r | | | | based QoS | usage of both | esponsibility | | | | control for | AAA based QoS | as per issue | | | | BBF\'s | rules and | 9 | | | | interworking | 3GPP PCC / | | | | | scenario | | | | | | | 2) QoS flow | | | | | | based policy | | | | | | control. | | | | | | | | | | | | 3) These 2 | | | | | | mechanisms | | | | | | should be | | | | | | kept mutually | | | | | | exclusive. | | | +----+---------------+---------------+---------------+---------------+
## 6.30 Solution #30: Overall Solutions for accessing 5GC via W-5GCAN for non
3GPP devices.
### 6.30.1 General
Device such as laptop can access the network/internet via FN-CRG/5G-CRG and
W-5GCAN without 3GPP credentials. In order for such devices to access the 5GC,
it is proposed to reuse the EAP framework for this purpose. This is similar to
the \"additional EAP methods for primary authentication\" mechanism as
specified in TS 33.501 [25] (Annex B) for registering UE to 5GC using method
other than EAP-AKA. These additional EAP methods can be EAP-TLS messages (see
IETF RFC 5216 [45]) or EAP-TTLS (RFC 5281 [14]).
### 3.60.2 Overall procedure
The follow figure shows how such method can be applied for FN-CRG (or
5G-CRG)/W-5GCAN.
{width="6.4875in" height="3.2618055555555556in"}
NOTE: Only the key information elements w.r.t W-5GCAN is listed.
Figure 6.30.2-1: 5GC Registration via W-5GCAN without 3gpp credential
1\. A layer-2 connection is established between the UE and the W-5GCAN. EAP
based authentication method is triggered.
2\. UE sends its identity as anonymous\@realm.
3\. W-5GCAN selects an AMF based on the local policy and formulate a N2
message to that AMF similar to (R)AN to new AMF: N2 message (N2 parameters,
Registration Request). W-5GCAN creates the N1 within this N2 message which
includes the serving W-5GCAN ID and user identity \"anonymous\@realm\".
Step 4 to 7 is executed similar to the \"additional EAP methods for primary
authentication\" mechanism as specified in TS 33.501 [25] (Annex B) for
registering UE to 5GC using method other than EAP-AKA. The exact details will
be defined by SA WG3.
4\. AMF authenticates the UE by invoking an AUSF. AUSF selection can be based
on the realm part of the NAI - \"anonymous\@realm\".
5\. SEAF (as described in TS 33.501 [25]) is acting as pass-through
authenticator as described in RFC 3748 [62], for the appropriate EAP method
(TLS or TTLS) between the device and AUSF. As part of this procedure, the real
UE identity is discovered - username\@realm. This is the SUPI.
6\. AUSF/ returns a success indication along with the SUPI and SEAF key as
master key.
7\. EAP success indication is sent to UE via W-5GCAN.
8\. AMF stores the SUPI, PEI, and W-5GCAN ID association to the UDM.
NOTE: W-5GCAN ID will be specified by CableLabs.
9\. AMF returns N2 message carrying the Registration Accept message to
W-5GCAN.
### 6.30.3 Storage information in UDM
SUPI: user_identity (e.g. john.doe@cable-x.net):
\- Serving W-5GCAN-ID#1:
\- PEI#1 (Equipment Identifier from the first device), PEI#2 (Equipment
Identifier from the second devices), etc.
\- Serving W-5GCAN-ID#2 (e.g., the same SUPI is used in multiple geographic
areas):
\- PEI#3 (Equipment Identifier from the third device), PEI#4 (Equipment
Identifier from the forth devices), etc.
NOTE: The format of this PEI is outside the scope of 3GPP.
### 6.30.4 Impacts on existing Functions
1\. The NAS (Registration Req) from W-5GCAN contains W-5GCAN ID, PEI, and
Registration type indicates DOCSIS.
2\. Appropriate EAP method (e.g., TLS or TTLS) to be invoked based on the
procedure described in TS 33.501 [25]. EAP message is transparent to AMF.
Details on EAP related requirements are to be defined by SA WG3.
3\. Duplicated SUPI within 5GC (i.e, AMF/SMF/UPF, etc) can be avoided by
appending PEI to the current user identity as first label (e.g,
PEI.john.doe\@cable-x.net).
4\. UDM contains registration record for the same user with multiple PEIs.
5\. No roaming is required.
6\. IP address allocation and PDU session establishment procedure follow TS
23.501 [2]/TS 23.502 [3]. No new impacts foreseen. However, only one PDU
session per UE is supported.
## 6.31 Interworking between 5G QoS Framework and the DOCSIS Cable Access
Network
This clause describes the interworking between the 5G QoS framework and the
DOCSIS QoS Framework. DOCSIS QoS flows, natively referred to a DOCSIS service
flows in DOCSIS specifications, can be identified with combinations of number
of classifiers, specifically:
\- Cable modem MAC address.
\- VLAN.
\- DSCP codes.
\- Source IP address and/or port.
\- Destination IP address and/or port.
\- Media type.
\- Vendor specific HFC traffic management features.
During the PDU Session Request, the 5G QoS downlink and uplink filters are
distributed from the 5G core to the cable AN on the N2 interface as defined in
TS 23.502 [3]. The W-5GCAN issues AN-specific signalling exchange to the
5G-CRG related to the information received from the SMF on the N2 interface,
establishing AN resources related to the QoS Rules for the PDU Session
Request. As a result, the 5G PDU Session is associated with a set of DOCSIS
QoS parameters as indicated above.
DOCSIS MAC layer traffic management classes that implement QoS classes are
specified and identified within CableLabs DOCSIS MULPI [13]. The cable network
translates 5G QoS to DOCSIS QoS.
DOCSIS QoS flows may be static and configured upon cable modem initialization.
DOCSIS QoS flows may be also be dynamic, triggered by applications. QoS can be
dynamically set in the upstream or downstream. 5G core procedures will be
leveraged to trigger the dynamic DOCSIS QoS flows.
The interworking and mapping between the 5G QoS framework, and the DOCSIS QoS
framework does not impact the converged architecture with DOCSIS as described
in this TR. If there are specific needs for additional value for cable
wireline AN (e.g., QFI value), they can be considered based on CableLabs
requests.
# 7 Solutions for Trusted Network
Editor\'s note: This clause will document the solution for the key issue for
Trusted Network.
## 7.1 Solution #1: Support of Trusted Non-3GPP Access
### 7.1.1 General Concepts
The solution specified in this clause is applicable only when the UE supports
NAS over non-3GPP access.
A Trusted Non-3GPP Access Network (TNAN) is considered an access network that:
(a) Employs an access technology not specified by 3GPP (e.g. WLAN);
(b) Can connect to 5GC by exposing north-bound interfaces compliant with
N2/N3; and
(c) Is deployed and managed either (_a_) by a 5G mobile operator or (_b_) by a
third-party who is trusted by the 5G mobile operator. How trust is established
between a third-party and a 5G mobile operator is currently not considered in
this document.
From a functional point of view, a TNAN is composed at least of two types of
network functions (see Figure 7.1.1-1):
(i) A Trusted Non-3GPP Access Point (TNAP): The TNAP enables UEs to access the
TNAN by using a non-3GPP wireless or wired access technology. In case of an
IEEE 802.11 [27] WLAN, the TNAP corresponds to a WLAN access point. A TNAP
terminates the UE\'s IEEE 802.11 [27] link defined in IEEE Std 802.11 [27].
(ii) A Trusted Non-3GPP Gateway Function (TNGF): The TNGF exposes the N2/N3
interfaces and enables the UE to connect to 5GC over a non-3GPP access
technology. The TNGF is functionally split into a control-plane function,
referred to as TNGF-CP, and to a user-plane function, referred to as TNGF-UP.
The interface between these functions is not defined.
Figure 7.1.1-1: Network functions in a TNAN
NOTE 1: When the TNAN is a trusted WLAN access network, it may also include
additional network functions, such as a Trusted WLAN Interworking Function
(TWIF), defined in clause 7.3 and in clause 7.4, and/or a Trusted WLAN AAA
Proxy and a Trusted WLAN Access Gateway (TWAG), defined in TS 23.402 [43],
clause 16.
Physical TNAN deployments may contain multiple TNAP instances and multiple
TNGF instances, as shown in the figure below. Each TNAP connects to one or
multiple TNGFs but the details of this connection are outside the scope of
3GPP. Each TNGF exposes N2/N3 interfaces that enable connection with 5GC.
Also, a TNGF may support a Tn interface for communication with other TNGFs.
Such communication enables direct inter-TNGF mobility. Inter-TNGF mobility may
also be supported via 5GC by using the N2/N3 interfaces.
Figure 7.1.1-2: A TNAN with multiple TNAP and TNGF instances
### 7.1.2 Reference Architecture
The architecture diagrams in this clause are based on the architecture
diagrams in TS 23.501 [2] and show the main network functions required to
support trusted non-3GPP access networks in 5GS. Other network functions are
not shown for simplicity.
Figure 7.1.2-1: Non-roaming and LBO Roaming Architecture for TNAN
Figure 7.1.2-2: Home-routed Roaming Architecture for TNAN
Figure 7.1.2-3: Roaming Architecture - different PLMNs for TNAN and 3GPP
access
#### 7.1.2.1 Network Functions
**Trusted Non-3GPP Access Point (TNAP)** : This is the function that provides
UE-access to the TNAN. For instance, it can be a WLAN access point, an
Ethernet switch, etc. This function is outside the scope of 3GPP but it is
shown in the figures for completeness.
**Trusted Non-3GPP Gateway Function (TNGF)** : This is the gateway function
that enables connectivity with 5GC. The TNGF supports the following functions:
\- Terminates the N2 and N3 interfaces (at the TNGF-CP and at the TNGF-UP
respectively).
\- Terminates the EAP-5G signalling and behaves as authenticator when the UE
attempts to register to 5GC via the TNAN (see the registration flow in clause
7.1.3.3).
\- Implements the AMF selection procedures specified in TS 23.501 [2].
\- Transparently relays NAS messages between the UE and the AMF.
\- Handles SM signalling with SMF (relayed by AMF) for supporting PDU sessions
and QoS.
\- Transparently relays PDU data units between the UE and a UPF in 5GC.
\- Implements a local mobility anchor within the TNAN.
\- Supports inter-TNAN mobility by using signalling over the Tn interface.
\- Implements a local EAP Re-authentication (ER) server (as per RFC 6696 [28])
to facilitate intra-TNGF and inter-TNGF mobility.
The TNGF can be implemented as a standalone function or as a function inside
another network element, e.g. inside a WLAN access controller or even inside a
WLAN access point.
#### 7.1.2.2 Reference Points
The following new reference points are introduced:
**Yt** A reference point between the UE and the TNAN that depends on
technology applied by the TNAN and is outside the scope of 3GPP. In case the
TNAN is a WLAN, the Yt reference point transports IEEE 802.11 [27] messages.
**NWt** A reference point between the UE and the TNGF. As shown in figure
below, this reference point implements two interfaces: A control-plane
interface referred to as NWt-cp, which terminates at the TNGF-CP, and a user-
plane interface referred to as NWt-up, which terminates at the TNGF-UP. The
NWt-cp interface is used to transfer NAS signalling. The TNGF transparently
relays NAS messages between an NWt-cp interface and the associated N2
connection. The NWt-up interface is used to transfer user-plane PDU data
between the UE and the TNGF. The TNGF transparently relays PDU data between an
NWt-up interface and the associated N3 connection.
Figure 7.1.2.2-1: NWt supports a control-plane interface (NWt-cp) and a user-
plane interface (NWt-up)
**Tn** A reference point between two TNGFs, which is used to facilitate UE
mobility between different TNGFs (inter-TNGF mobility). The interface used on
this reference point is in the scope of 3GPP.
**N2** The N2 reference point specified in TS 23.501 [2] with possible
additions.
**N3** The N2 reference point specified in TS 23.501 [2] with possible
additions.
Potential additions/enhancements to N2/N3 reference points are discussed in
subsequent clauses.
Editor\'s note: It is FFS if there is need for an interface between the TNGF
and the NG-RAN. Such interface may be used is to enable mobility between a
TNAN and NG-RAN.
### 7.1.3 Procedures
#### 7.1.3.1 TNAN Selection
When a UE wants to register to 5GC via a TNAN, the UE discovers all non-3GPP
access networks available at its present location and determines which of
these access networks support \"5G connectivity\" to one or more PLMNs. A TNAN
supports \"5G connectivity\" to a PLMN when the TNAN has a TNGF that
interfaces with the PLMN via the N2/N3 interfaces. Each TNAN advertises, e.g.
with ANQP, the PLMNs with which it can support \"5G connectivity\".
The steps executed by the UE for selecting a TNAN, as well as a PLMN for
connecting via the TNAN, are specified in Solution #5: Access Network
Selection for Trusted Non-3GPP Access.
#### 7.1.3.2 Selection of \"trusted connectivity\" type
When the non-3GPP access network is a WLAN access network, which is trusted by
a PLMN, then the non-3GPP access network may support one or more types of
\"trusted connectivity\" to this PLMN, such as \"5G connectivity\" and \"S2a
connectivity\" (see also clause 7.5).
When the UE decides to access a WLAN access network in order to establish
\"trusted connectivity\" to a PLMN, the UE shall indicate the requested type
of \"trusted connectivity\" by formatting its NAI appropriately. More
specifically:
a) When the UE wants to access the WLAN access network in order to connect to
EPC of the PLMN, the UE shall format its NAI as specified in TS 23.002 [56]:
NAI = \"\\@nai.epc.mnc\.mcc\.3gppnetwork.org\".
b) When the UE wants to access the WLAN access network in order to connect to
5GC of the PLMN, the UE shall format its NAI as follows:
NAI = \"\\@nai.5gc.mnc\.mcc\.3gppnetwork.org\".
#### 7.1.3.3 5GC Registration and TNAN Access Authentication
The UE registers to 5GC and, at the same time, it authenticates with the TNAN
by using the EAP-based procedure shown in the figure below. This procedure is
essentially the same with the registration procedure for untrusted non-3GPP
access in _TS 23.502 [3]_ , clause 4.12.2.2. The link between the UE and the
TNAN can be any data link (L2) that supports EAP encapsulation, e.g. PPP, PANA
(RFC 5191 [34]), Ethernet, IEEE 802.3, IEEE 802.11 [27], etc. The interface
between the TNAP and TNGF-CP is an AAA interface.
Figure 7.1.3.3-1: 5GC Registration and TNAN access authentication
1\. A layer-2 connection is established between the UE and the TNAP. In case
of IEEE 802.11 [27], this step corresponds to an 802.11 [27] Association. In
case of PPP, this step corresponds to a PPP LCP negotiation. In other types of
non-3GPP access (e.g. Ethernet), this step may not be required.
2-3. An EAP authentication procedure is initiated. EAP messages are
encapsulated into layer-2 packets, e.g. into IEEE 802.3/802.1x packets, into
IEEE 802.11/802.1x packets, into PPP packets, etc. The UE provides a special
NAI that triggers the TNAP to send an AAA request to a TNGF-CP, which operates
as an AAA proxy. Between the TNAP and TNGF-CP the EAP packets are encapsulated
into AAA messages.
4-10. An EAP-5G procedure is executed as specified in TS 23.402 [43], clause
4.12.2.2 with the following modifications:
\- A TNGF key (instead of an N3IWF key) is created in the UE and in the AMF
after the successful authentication. The TNGF key is transferred from the AMF
to TNGF-CP in step 10a (within the N2 Initial Context Setup Request) . From
the TNGF key, the TNGF-CP derives a TNAP key, which depends on the non-3GPP
access technology used. For example, in case of IEEE 802.11 [27], the TNAP key
is a Pairwise Master Key (PMK). and then The TNAP is transferred from and then
from TNGF-CP to TNAP in step 10b (within an AAA message). The UE derives the
TNGF key and the TNAP key after the successful authentication in step 8.
\- In step 9b the UE receives the \"TNGF Contact Info\" which includes (a) the
IP Address of TNGF-CP to which NAS signalling should be sent and (b)
optionally more information that may be used for NAS signalling transport
(e.g. a TCP port number, if NAS signalling is transferred over TCP).
Alternatively, the \"TNGF Contact Info\" may be retrieved by the UE in step
12, e.g. via DHCP.
If, in step 4, the UE does not receive an EAP-Request/5G-Start packet, then
the UE determines that the non-3GPP access network cannot support registration
to 5GC. Then, it is up to the UE implementation to continue or stop the access
authentication procedure.
11\. The common TNAP key is used to establish layer-2 security between the UE
and TNAP. In case of IEEE 802.11 [27], the TNAP key is used to derive an IEEE
802.11 [27] Pairwise Master Key (PMK) and a 4-way handshake is executed (see
IEEE 802.11 [27]) which establishes a security context between the WLAN AP and
the UE that is used to protect unicast and multicast traffic over the air.
12\. The UE receives IP configuration from the TNAN, e.g. with DHCP.
13\. At this point the UE has successfully connected to the TNAN and has
obtained IP configuration. The UE uses one of the options defined in clause
7.1.3.4.1 to establish an NWt-cp connection, i.e. a connection with the TNGF-
CP for transporting NAS signalling. When IKEv2/IPsec is used over NWt (as in
Option 1 in clause 7.1.3.4.1), then step 13 includes an IKE_INIT exchange,
followed by an IKE_AUTH exchange that applies the TNGF key as a shared key for
mutual authentication.
14\. After the NWt-cp connection is successfully established, the TNGF
responds to AMF with an N2 Initial Context Setup Response message.
15\. Finally, the NAS Registration Accept message is sent by the AMF and is
forwarded to UE via the established NWt-cp connection. Now the UE can use the
TNAN (a) to transfer non-seamless offload traffic and (b) to establish one or
more PDU sessions.
How the NWt-cp connection is established between the UE and TNGF for NAS
transport (in step 13) and how PDU sessions are established after the
completion of the above procedure, are in discussed in the next clause.
#### 7.1.3.4 NAS transport and User-Plane Aspects
##### 7.1.3.4.1 General
This clause specifies (a) how NAS messages are transported between the UE and
TNGF-CP and (b) how user-plane (UP) data is transported between the UE and
TNGF-UP.
For creating NWt-cp and NWt-up connections between the UE and TNGF for NAS
transport and UP data transport respectively, a certain protocol is required
on the NWt reference point. This is schematically shown in the figure below.
Note that non-seamless offload traffic (i.e. UP traffic carried outside of a
PDU session) does not need to be tunnelled to the TNGF.
Figure 7.1.3.4.1-1: NWt connections for NAS transport and UP data transport
Various mechanisms can be applied to establish NWt-cp and NWt-up connections
for NAS transport and UP data transport respectively. The following options
are considered below. These options should be evaluated and the best option
should be selected.
\- Option 1: IKEv2 and IPsec with NULL encryption.
\- Option 2: NWt protocol between the UE and TNGF.
\- Option 3: IP protocol between the UE and TNGF.
Several existing tunnelling protocols could be used between the UE and TNGF,
including L2TP, PPTP, etc., but none of these protocols is sufficient to meet
the requirements of trusted non-3GPP access operation and specifically the
mobility requirements.
##### 7.1.3.4.2 Option 1: IKEv2 and IPsec with NULL Encryption
In this option, the IKEv2 protocol (specified in RFC 7296 [58]) is used as a
signalling protocol between the UE and TNGF. IKEv2 is used to establish (a) an
IPsec SA for NAS transport between the UE and TNGF and (b) one or more IPsec
child SAs for user-plane data transport. However, since encryption is applied
between the UE and TNAP by using layer-2 mechanisms (e.g. IEEE 802.11 [27]
security), the IPsec SAs established between the UE and TNGF do not need to
perform encryption. The UE and TNFG can negotiate NULL encryption during IPsec
SA setup, as specified in RFC 2410 [59].
What kind of security protection is needed for the IPsec SAs should be
evaluated by SA WG3. The assumption here is that there is no need for IPsec
encryption on top of the layer-2 encryption. However, authentication and
integrity protection may still be applied. According to RFC 2401 [60], it
should not be possible to nullify both encryption and authentication /
integrity protection: \"Note that if ESP is specified, either (but not both)
authentication or encryption can be omitted. So it MUST be possible to
configure the SPD value for the authentication or encryption algorithms to be
\"NULL\". However, at least one of these services MUST be selected, i.e., it
MUST NOT be possible to configure both of them as \"NULL\".\"
The main advantage of using IKEv2/IPsec is that it makes the solution for
trusted non-3GPP access almost identical with the solution for untrusted
non-3GPP access specified in TS 23.501 [2] and TS 23.502 [3]. Thus, the UE can
use the same protocols and procedures for both trusted and untrusted non-3GPP
access and the TNGF can become very similar to N3IWF.
The UE starts the establishment of the first IPsec SA with the TNGF as shown
in the figure below. The TNGF shown comprises both the TNGF-CP and the TNGF-
UP.
Figure 7.1.3.4.2-1: Using IPsec for NAS transport and UP data transport
13\. The UE initiates an IKE_INIT exchange with the TNGF. The UE has received
the IP address of TNGF during the EAP-5G signalling, as shown in Figure
7.1.3.3-1. Subsequently, the UE initiates an IKE_AUTH exchange and provides
its identity. The identity provided by the UE in the IKEv2 signalling should
enable the TNGF to locate the TNGF key that was created before for this UE,
during the EAP authentication phase. The common TNGF key is used for mutual
authentication. NULL encryption is negotiated as specified in RFC 2410 [59].
After step 13b, an IPsec SA is established between the UE and TNGF (i.e. a
NWt-cp connection) and it is used to transfer all subsequent NAS messages.
This IPsec SA does not apply encryption but may apply integrity protection. SA
WG3 should define what kind of protection is required for NAS transport
between the UE and TNGF.
The IPsec SA is established between the UE and TNGF operates in Tunnel mode.
This is needed in order to use MOBIKE for re-establishing the IPsec SAs when
the UE performs Inter-TNGF Mobility (see clause 7.1.3.5.2).
14-15. Same steps as in Figure 7.1.3.3-1. After the IPsec SA is established,
the 5GC Registration is completed by sending a NAS Registration Accept from
the AMF to UE.
20-24. The UE initiates a PDU session establishment. This is carried out
exactly as specified in _TS 23.502 [3]_ , clause 4.12.5 (UE initiated PDU
session establishment). The TNGF may establish one or more IPsec child SAs per
PDU session. If supported by the TNAN technology, QoS resources may be
reserved in the TNAN based on the QoS Profile(s) and the QFI(s) included in
step 21.
25\. Similarly with the solution for untrusted non-3GPP access, the PDU
session data is encapsulated into GRE and then into ESP/IP (UDP may also be
used for NAT traversal).
The figure below shows the user-plane protocol stacks for an example scenario
where the UE has established two PDU sessions and the TNGF has established one
IPsec child SA per PDU session (although it can establish more child SAs per
PDU session). The figure shows how user data is transferred in the uplink
direction but a similar process applies also to the downlink direction.
However, in the downlink direction the GRE header includes, not only the QFI,
but also the RQI (Reflective QoS Indication). The figure below assumes
operation in IPsec Transport mode but could be easily extended to apply to
operation in IPsec Tunnel mode.
{width="6.4215277777777775in" height="3.276388888888889in"}
Figure 7.1.3.4.2-2: User-plane protocol stacks
##### 7.1.3.4.3 Option 2: NWt protocol between UE and TNGF
In this option, a new signalling protocol is employed between the UE and TNGF-
CP, called NWt protocol. This protocol is specified by 3GPP to fulfil the
specific requirements of trusted non-3GPP access. The NWt protocol runs on top
of IP and can use UDP, TCP, or other transport. It is used to establish (a) an
NWt-cp connection between the UE and TNGF-CP for NAS transport and (b) one or
more NWt-up connections between the UE and TNGF-UP for user-plane data
transport.
The NWt protocol is also used to facilitate mobility, e.g. to transfer the
NWt-cp and the NWt-up connections to a new TNGF or to a new IP address of the
UE.
Figure 7.1.3.4.3-1: Control-plane protocol stacks
The following figure illustrates when the NWt-cp connection is created (see
step 13a) and when the NWt-up connections are created during the establishment
of a PDU session (see step 22). For each PDU session the TNGF-CP may decide to
setup one or multiple NWt-up connections.
Figure 7.1.3.4.3-2: Using the NWt protocol for NAS transport and setup of UP
connections
Editor\'s note: Further details of the NWt solution are FFS. It is FFS also if
a new encapsulation scheme is needed on the user-plane or if an existing
encapsulation scheme (e.g. GRE) would be sufficient.
##### 7.1.3.4.4 Option 3: IP layer between the UE and the TNGF
In this solution, the TNAP forwards the DHCP message from UE to the TNGF. The
TNAP behaves as the DHCP relay.
This solution assumed that the UE has 1 IP address assigned to transport NAS
and 1 different IP address assigned for each PDU session. In user plane, the
UE encapsulates the PDU session data with the GRE layer and the IP layer as
shown in figure 7.1.3.4.4-1. The different TNGF user plane IP address can be
used to identify the different PDU session, and the GRE layer can be used to
carry the QFI/RQI.
Figure 7.1.3.4.4-1: PDU session procedure
0a. The UE registers to the 5GC as defined in 7.1.3.3 from step 1-11.
Especially, the UE receives the NAS IP address allocated by the TNGF as
defined in the clause 7.1.3.3 step 9b.
0b-0d. The UE requests the IP address via DHCP message as defined in 7.1.3.3
step 12. The TNAP forwards the DHCP message from UE to the TNGF. The UE
includes the UE ID and the TNGF NAS IP address as the Server IP address in the
DHCP request message. The UE ID, e.g. the UE NAI, is used by the TNGF to
identify the UE.
The TNGF allocates the UE IP address and sends back to the UE via DHCP ACK.
The following NAS message can be encapsulated in the IP header with the TNGF
NAS IP and UE IP address.
1\. The UE sends the PDU session establishment request message (). This NAS
message is encapsulated by the NAS IP and the UE IP address.
2-5. The same steps as defind in the TS 23.502 [3] to establish PDU session.
6\. After receiving the PDU Session Establishment Accept message, the UE
triggers the DHCP information message to the TNGF. In the DHCP information
message, the UE includes the PDU session ID in the DHCP Option IE.
7\. The TNGF allocates the TNGF user plane IP address for the PDU session, and
stores the binding relationship betweent the TNGF user plane IP address and
the PDU session ID.
8\. The TNGF sends the TNGF user plane IP address with the related PDU session
ID to the UE.
Editor\'s note: security aspects need further considerations, for example how
to detect that a UE message is coming from a different UE which has spoof the
IP address of a legitimate UE.
Figure 7.1.3.4.4-1: User-plane protocol stacks
#### 7.1.3.5 Mobility Aspects
##### 7.1.3.5.1 Intra-TNGF Mobility
To enable efficient intra-TNGF mobility, e.g. when the UE moves from a source
TNAP (TNAP-s) to a target TNAP (TNAP-t) within the area of the same TNGF, the
EAP Re-authentication Protocol (ERP) can be used, as specified in RFC 6696
[28]. The use of ERP avoids the need to perform a full authentication when the
UE moves to TNAP-t and makes the mobility event transparent to 5GC.
NOTE 1: It is expected that SA WG3 will define all security-related aspects of
the procedure below, such as how the re-authentication root key (rRK) is
created and if the existing TNGF key can be re-used.
The figure below illustrates how intra-TNGF mobility can be executed by
applying EAP Re-authentication. In this case, the TNGF-CP operates also as a
local EAP Re-authentication (ER) server. Note that before the intra-TNGF
mobility (steps 20-27), the executed 5GC registration procedure (steps 1-15)
should enable ERP implicit bootstrapping (see RFC 6696 [28]). In order to
support intra-TNGF mobility with the ERP, the 5GC registration procedure needs
to be enhanced, as shown in the figure below (steps 1-9).
Figure 7.1.3.5.1-1: Intra-TNGF mobility with EAP Re-authentication
1-15. The same steps as in the 5GC Registration procedure in Figure 7.1.3.3-1
but with one addition: A re-authentication root key (rRK) is created in the UE
and in the AUSF, as specified in RFC 6696 [28], which is used to create an EAP
re-authentication context in the UE and in the TNGF. More specifically:
\- In step 6b, the TNGF includes an ERP Request, which indicates that an EAP
re-authentication root key (rRK) is needed. If necessary, the ERP Request may
also contain a domain name, in which case, a domain-specific rook key (DSRK)
is requested (see RFC 6696 [28]). In step 8a, the ERP Request is sent to the
AUSF.
\- After the successful authentication in step 8b, the AUSF creates an EAP re-
authentication root key (rRK) from the Extended Master Session Key (EMSK) by
applying the procedures in RFC 5295 [29]. If a domain name was received in
step 8a, then a DSRK is created instead.
\- In step 8c, the AUSF sends an ERP Response, which contains the created EAP
re-authentication root key (e.g. rRK or DSRK) along with other information,
such as the root key lifetime and an EMSKname, as specified in RFC 6696 [28].
The ERP Response is forwarded to TNGF in step 9a.
\- In step 9e, the TNGF uses the received EAP re-authentication root key to
derive other EAP re-authentication keys, such as a re-authentication integrity
key (rIK). These keys are stored in the TNGF and are used later when an EAP
re-authentication procedure is executed (as in steps 22-26 below).
20-26. The UE moves to a new TNAP (TNAP-t) , which belongs to the same ERP
domain as the domain of TNAP-s,and an EAP re-authentication procedure is
initiated as per RFC 6696 [28]. In step 23, the UE derives the same EAP re-
authentication keys as those derived by TNGF in step 9e. The EAP-Initiate/Re-
auth in step 24 and the EAP-Finish/Re-auth in step 25 are integrity protected
using the re-authentication integrity keys created independently in the UE and
in the TNGF, respectively. If these integrity keys are the same, the EAP re-
authentication procedure is successful and the re-authentication MSK (rMSK)
key is used to establish security between the UE and TNAP-t.
27\. It is assumed that an intra-TNGF mobility does not change the IP address
allocated to UE by the TNAN. Therefore, the UE can use the same IP address to
resume communication with the TNGF over the existing NWt-cp and NWt-up
connections.
In the special case where the trusted non-3GPP access network is a WLAN and
both the UE and the WLAN support Fast Initial Link Setup (FILS), as specified
in IEEE 802.11ai, then the transition to the TNAP-t can be executed as shown
in the figure below. This procedure is outside the scope of 3GPP (it is
provided for information only) but it requires again the 5GC Registration to
enable EAP re-authentication bootstrapping, as shown in Figure 7.1.3.5.1-1,
steps 1-15. Note that the DHCP server in step 25 is required only when a new
IP address should be allocated to UE.
Figure 7.1.3.5.1-2: Intra-TNGF mobility with Fast Initial Link Setup (FILS)
NOTE 1: The EAP Re-authentication Protocol (ERP) provides an access-agnostic
mechanism that can be used over any type of non-3GPP access network. However,
additional mechanisms may exist that can also be used to enable efficient
intra-TNGF mobility, such as the Fast BSS Transition, specified in IEEE 802.11
[27] (formerly known as IEEE 802.11r). The Fast BSS Transition however is
specific to WLANs and cannot be considered as a general mobility mechanism
that can be applied over a wide range of different non-3GPP access networks.
##### 7.1.3.5.2 Inter-TNGF Mobility
When the UE transitions to a target TNAP (TNAP-t), which cannot communicate
directly with the TNGP-CP previously used by the UE (the source TNGF-CP), then
the following mobility procedure is executed to transfer the UE context and
the NWt connections to a new TNFG-CP (the target TNGF-CP). Before this
mobility procedure is executed, it is assumed that the UE has registered with
5GC as shown in Figure 7.1.3.5.1-1, steps 1-15. In other words, the 5GC
registration with ERP implicit bootstrapping has been executed and the source
TNGF-CP holds the EAP re-authentication context of the UE.
NOTE 1: An inter-TNGF mobility may be required in large TNAN deployments where
a single TNGF cannot serve all TNAPs and/or all UEs, e.g. due to resource
limitations.
Figure 7.1.3.5.2-1: Inter-TNGF mobility with EAP Re-authentication
20-22. The UE associates with TNAP-t and the EAP re-authentication procedure
is initiated.
23-24. The UE uses the EMSK derived from the previous full EAP authentication
and creates an EAP re-authentication root key, an EAP re-authentication
integrity key, an rMSK and an EMSKname, as specified in RFC 5295 [29]. The UE
sends an EAP-Initiate/Re-auth message including its NAI identity
(EMSKname\@Domain). The EMSKname is used as a username that identifies the UE
to the ER server and the Domain identifies the ER server that holds the EAP
re-authentication context for this UE. The TNAP-t forwards the EAP-
Initiate/Re-auth message to the target TNGF-CP. Note that the TNAP-t cannot
communicate directly with the source TNGF-CP.
25\. The target TNGF-CP determines from the Domain the ER server that holds
the EAP re-authentication context for this UE. In this case, it is the source
TNGF-CP.
26\. The target TNGF-CP retrieves from the source TNGF-CP the UE context over
the Tn interface. The UE context includes the GUAMI of the serving AMF, the
EAP re-authentication root key, information about the established PDU
sessions, etc.
27\. The target TNGF-CP uses the received EAP re-authentication root key to
derive the EAP re-authentication integrity key (rIK) and utilizes this key to
verify the integrity of the received EAP-Initiate/Re-auth message.
28\. If the integrity verification is successful, the target TNGF-CP derives
an EAP re-authentication MSK (rMSK) and sends this rMSK together with an EAP-
Finish/Re-auth message to TNAP-t. The EAP-Finish/Re-auth message is sent to
UE, which also verifies the integrity of this message by using its own EAP re-
authentication integrity key (rIK).
29\. Using the common rMSK, the UE and the TNAP-t establish a security context
to protect all subsequent communication. In case of a WLAN access, this
corresponds to a 4-way handshake procedure (see IEEE 802.11 [27]). Optionally,
the UE may receive new IP configuration data, e.g. via DHCP.
30\. The NWt-cp and the NWt-up connections are re-established between the UE
and the target TNGF-CP. This is needed in case the UE changed IP address. When
IKEv2/IPsec is used for the NWt-cp and NWt-up connections, as specified in
clause 7.1.3.4.2 (Option 1: IKEv2 and IPsec with NULL Encryption), the re-
establishment of these connections is executed by using MOBIKE, as specified
in RFC 4555 [61] (IKEv2 Mobility and Multihoming Protocol).
31-33. The target TNGF-CP sends an NGAP Patch Switch Request to the serving
AMF. This triggers the update of the PDU session(s) in the SMF and the update
of the corresponding N4 session(s), as specified in TS 23.502 [3], clause
4.9.1.2, \"Xn based inter NG-RAN handover\". Further downlink traffic is sent
to the target TNGF.
In the special case where the trusted non-3GPP access network is a WLAN and
both the UE and the WLAN support Fast Initial Link Setup (FILS), as specified
in IEEE 802.11ai, then the signalling between the UE and TNAP-t can be the
signalling shown in the figure 7.1.3.5.1-2 above.
## 7.2 Solution #2 - Solution for UE Registration via Trusted non-3GPP access
### 7.2.1 Architecture Description
In TS 23.501 [2], 5GS supports untrusted non-3GPP architecture, in which N3IWF
is introduced to interconnect UE and the AMF in the 5GC via Untrusted Non-3GPP
access, i.e. N1 connection. Similarly, N3IWF can be applicable for
interconnecting UE and the AMF via Trusted Non-3GPP access with optional
addition of the AAA Proxy at Trusted Non-3GPP access to transfer AAA
signalling and interface with N3IWF, as shown in Figure 1.
The N3IWF acts as an interworking function exposing the same set of interfaces
(N2, N3) to the 5GC on behalf of the Trusted Non-3GPP UE. The reference
architecture in figure 7.2.1-1 only shows the architecture and the network
functions directly connected to non-3GPP access and other parts of the
architecture are the same as defined in clause 4.2 in TS 23.501 [2].
Figure 7.2.1-1: Architecture to enable trusted non-3GPP access to 5GC
### 7.2.2 Registration via trusted non-3GPP access
Editor\'s note: This clause is intended to for registration procedure for
trusted non-3GPP access.
The N3IWF enables UEs to register with the 5GC via both trusted and untrusted
non-3GPP accesses. The registration procedure for the UE connecting to the 5GC
via the trusted non-3GPP access is as shown in Figure 7.2.2-1, which shows the
signalling flows when the UE attempts to connect to a WLAN (the WLAN is used
as an example non-3GPP access). The UE is authenticated by the 5GC (via N2)
and is authorized to access the WLAN. This authentication and authorization is
performed by \"registering\" the UE to the 5GC.
Editor\'s note: The following texts requires updates to be conformed to terms
used in TS 23.501 [2] for 5GS.
Error! Objects cannot be created from editing field codes.
Figure 7.2.2-1: Registration procedure via Trusted WLAN using the N2 interface
1\. The UE discovers and associates with the WLAN according to the existing
procedures. At this point, the NAS layer in the UE sends a Registration
Request message to the Adaptation layer in order to register to the NextGen
over the WLAN.
2\. The WLAN starts the IEEE 802.1x [33] access control procedure by
transmitting an EAP-REQ/Identity request.
NOTE 1: IEEE 802.1x [33] messages (i.e. EAP-over-LAN) are not shown in the
figure. The UE provides an identity along with a realm, which is primarily
used for routing purposes (according to RFC 3748 [62]). Based on the provided
realm, the WLAN access network routes the EAP-RSP/Identity message containing
Registration Request message to the N3IWF. From the WLAN access network point
of view, the N3IWF serves as an AAA server.
3\. The N3IWF forwards Registration Request message sent from the UE to the CP
functions over NG2.
Editor\'s note: The method used for network slice selection in Step 2, 3a
needs to be aligned with the agreements in 5GS. This may require further
study.
4\. The CP functions send an Authentication Request (RAND, AUTN, TEKs) back to
N3IWF. The TEKs are the Transient EAP Keys (i.e. K_aut and K_encr) which are
used to protect the EAP-AKA\' signalling between the UE and N3IWF. The TEKs
keys are generated as specified in RFC 5448 [35]. These keys are included in
the Authentication Request only when the type IE in the Registration Request
indicates non-3GPP access. Depending on SA WG3 decisions, the Authentication
Request message may include additional IEs than those shown in the above
figure.
5\. The N3IWF sends an EAP-REQ/AKA-Challenge message to UE. The RAND, AUTN
received in step 4 are included in this message. Also the AT_MAC is calculated
based on the K_aut key received in step 4. If there is need to send encrypted
parameters to the UE (inside the AT_ENC_DATA attribute), these parameters are
encrypted based on the K_encr key received in step 4.
6-8. The UE verifies the AUTN, generates the session keys (MSK, EMSK, K_aut,
K_encr, etc.) and derives the Result (RES) which is sent to N3IWF in an EAP-
RSP/AKA-Challenge message. The N3IWF sends an Authentication Response (RES) to
CP functions over NG2. As normally, the CP functions verify RES and, if
correct, they respond with a Registration Accept message. This message may
include parameters (referred to as IEs in the above figure) that should be
transferred to UE, e.g. a new temporary UE identity.
In step 8c the N3IFW receives also the session keys (MSK, EMSK) which are
needed to protect the WLAN air interface traffic. The MSK is further
transferred to the WLAN access network (in step 13a) in order to derive the
Pairwise Master Key (PMK), as defined in the IEEE 802.11 [27] specification.
9\. The N3IWF derives a \'DTLS key\' (e.g. from EMSK) which will be needed
later for the establishment of a secure DTLS connection with the UE. The same
\'DTLS key\' is also derived by the UE after the successful authentication in
step 15.
10\. The N3IWF sends an EAP-REQ/AKA-Notification message to UE which includes
the address of N3IWF and other parameters (IEs) that were included in the
Registration Accept message (e.g. a new temporary identity). After step 10b,
the Adaptation layer in the UE creates an Registration Accept message and
sends it to the NAS layer.
NOTE 2: A legacy UE will ignore the address of N3IWF and the other parameters
(IEs).
11-12. The UE responds with an EAP-RES/AKA-Notification which contains
Registration Complete message to CP functions.
13\. The EAP authentication procedure completes with an EAP-Success message.
The N3IWF creates a UE Context which stores information such as the UE MAC
address, the UE identity (included in the Registration Accept message), the
EAP-AKA\' identities of the UE (e.g. a pseudonym and/or fast re-authentication
identities), etc.
14\. At this point, the UE is connected to the WLAN access network and can
establish layer-3 connectivity, e.g. by receiving IPv4 address via DHCP. The
UE can then use the WLAN for NSWO traffic.
15\. After successful authentication the UE derives the \'DTSL key\' as
discussed above.
16\. The Adaptation layer in the UE receives the address of N3IWF and the
\'DTLS key\' and establishes a secure DTSL connection to N3IWF (DTLS with pre-
shared key as defined in RFC 6347 [22]).
NOTE 3: The same procedure has been specified to protect the WLCP signalling
between the UE and a TWAG (see TS 33.402 [23]).
17\. The Adaptation layer in the UE notifies the NAS layer that the attachment
via trusted WLAN access is completed. It also provides to the NAS layer the
IEs provided by the network in the Registration Accept message (and received
by the UE in step 10b).
After this step, the NAS layer in the UE may initiate NAS signalling with the
CP functions in the network in order e.g. to setup a PDU session over WLAN
access.
Editor\'s note: The registration procedure shown in figure 7.2.2-1 needs to be
updated to indicate how NAS security is setup between the UE and CP functions.
## 7.3 Solution #3: Access to 5GC from UEs without supporting NAS on non-3GPP
access
### 7.3.1 General
This solution enables UEs, which do not support 5G NAS signalling over WLAN,
to register to 5GC and to establish 5GC connectivity via a trusted WLAN access
network. These UEs are referred to as \"Non-5G-capable over WLAN\" UEs since
they are not capable to operate as 5G UEs over a WLAN access network. A
\"Non-5G-capable over WLAN\" UE, however, may be capable to operate as a 5G UE
over NG-RAN. These UE(s) may also correspond to devices without any NAS
capability at all.
Unless otherwise specified, any reference to a UE in this solution means a
\"Non-5G-capable over WLAN\" UE.
### 7.3.2 Reference Architecture
The architecture diagram below is based on the architecture diagrams in TS
23.501 [2] and it shows the main network functions required to enable a UE,
which cannot perform 5G NAS signalling over WLAN access, to establish
connectivity to 5GC via a trusted WLAN access network. Other network functions
are not shown for simplicity.
Note that the UE may be able to perform 5G NAS signalling over 3GPP access,
thus the diagram below illustrates an N1 connection between the UE and AMF via
3GPP access.
{width="5.638888888888889in" height="2.7604166666666665in"}
Figure 7.3.2-1: Non-roaming and LBO Roaming Architecture for TNAN
#### 7.3.2.1 Network Functions
**Trusted WLAN Access Point (TWAP)** : It provides a point-of-access to the
WLAN access network. This function is outside the scope of 3GPP but it is
shown in the figures for completeness.
**Trusted WLAN Interworking Function (TWIF)** : It provides interworking
functionality that enables connectivity with 5GC. The TWIF supports the
following functions:
\- Terminates the N1, N2 and N3 interfaces.
\- Implements the AMF selection procedures specified in TS 23.501 [2].
\- Implements the NAS protocol stack and exchanges NAS messages with the AMF
on behalf of the UE.
\- On the user plane, it relays protocol data units (PDUs) between the Yw
connection and the N3 connection. It may also steer some PDUs to a local
breakout point in order to support \"non-seamless WLAN offload\".
\- May implement a local mobility anchor within the trusted WLAN access
network.
#### 7.3.2.2 Reference Points
The Yt and Yw reference points are both outside the scope of 3GPP. The Yt
reference point transports IEEE 802.11 [27] messages, while the Yw reference
point may support a L2 or L3 connection per UE.
The N1, N2 and N3 reference points are the same reference points defined in TS
23.501 [2], with possible extensions or modifications. Such extensions or
modifications are identified and discussed in the next clause.
### 7.3.3 Procedures
#### 7.3.3.1 WLAN Selection
The UE must select a WLAN access network that supports the N1, N2, N3
interfaces to one or more 5G core networks, and is capable of establishing 5GC
connectivity for \"Non-5G-capable over WLAN\" UEs, i.e. it is capable of
supporting \"5G connectivity without NAS\".
#### 7.3.3.2 Initial Registration & PDU Session Establishment
The Figure 7.3.3.2-1 illustrates how the UE can simultaneously connect to a
trusted WLAN access network and to a 5G core network. A single EAP-based
authentication procedure is executed for connecting the UE both to the trusted
WLAN access network and to the 5G core network.
Figure 7.3.3.2-1: Initial registration and PDU session establishment
Steps 1-10: Initial registration to 5GC.
1\. The UE associates with the trusted WLAN network and the EAP authentication
procedure is initiated.
2\. The UE provides its Network Access Identity (NAI) The Trusted WLAN Access
Point (TWAP) selects a Trusted WLAN Interworking Function (TWIF), e.g. based
on the received realm or based on pre-configured information possibly
associated with the SSID used by the UE and sends an AAA request to the
selected TWIF.
> In case of a UE with 5GC capabilities, the NAI has the format of
> \\@realm, where the realm indicates the home PLMN. The UE discovers
> the PLMNs with which the WLAN supports \"5G connectivity without NAS\" and
> selects a PLMN, by using procedure defined in clause 7.6.
If the UE has registered to 5GC over 3GPP access when the above procedure is
initiated, then the NAI includes the 5G-GUTI assigned to UE over 3GPP access.
This enables the TWIF in step 4a below to select the same AMF as the one
serving the UE over 3GPP access.
The NAI provided by the UE in step 2b indicates that the UE wants \"5G
connectivity without NAS\" towards a specific PLMN. For example, with
NAI=\\@nai.5gc-nn.mnc123.mcc45.3gppnetwork.org, the UE indicates that it
wants \"5G connectivity without NAS\" (5gc-nn) to the PLMN with MCC=45 and
MNC=123,
3\. The TWIF creates a 5GC Registration Request message on behalf of the UE.
The TWIF uses default values to populate the parameters in the Registration
Request message, which are the same for all UEs that do not support 5G NAS.
The Registration type indicates \"Initial Registration\".
4\. The TWIF selects an AMF (e.g. by using the 5G-GUTI in the NAI, if provided
by the UE) and sends an N2 message to the AMF including the Registration
Request, the User Location and an AN Type.
5\. The AMF triggers an authentication procedure by sending a request to AUSF
indicating the AN type.
6\. An EAP authentication (e.g. EAP-AKA\') takes place between the UE and
AUSF. Over the N2 interface, the EAP messages are encapsulated within NAS
Authentication messages, as usually.
7\. After a successful authentication, the AUSF sends to AMF the EAP-Success
message and the created SEAF key. The AMF derives NAS keys and an AN key from
the received SEAF key.
8\. A NAS security context is activated between the TWIF and AMF by sending a
Security Mode Command to TWIF. Since the TWIF does not have the SEAF key (this
key is created in the UE and in AUSF), the message in step 8a must include the
SEAF key. If the N2 interface between the AMF and TWIF is considered unsecure,
then the SEAF key should be sent encrypted to TWIF. For this purpose, the AMF
could be provisioned with a TWIF public key and it could use this TWIF public
key to encrypt the SEAF key.
Editor\'s note: Aspects related with NAS security and Key handling are to be
defined by SA3; For example if and how the SEAF key is encrypted needs further
study from SA WG3.
9\. The AMF sends an N2 Initial Context Setup Request and provides the AN key
to TWIF. In turn, the TWIF derives a Pairwise Master Key (PMK) from the AN key
and sends the PMK key and the EAP-Success message to the Trusted WLAN Access
Point, which forwards the EAP-Success to the UE. The PMK is the key used to
secure the WLAN air-interface communication according to IEEE 802.11i [36]
(now incorporated into IEEE 802.11 [26]). A layer-2 or layer-3 connection is
established between the Trusted WLAN Access Point and the TWIF for
transporting all user-plane traffic of the UE to TWIF. This connection is
later bound to an N3 connection that is created for this UE.
10\. Finally, the AMF sends a Registration Accept message to TWIF At this
point, the UE is connected to the WLAN access network..
Steps 20-21: PDU Session Establishment. This procedure is compliant with TS
23.502 [3] Figure 4.3.2.2.1-1 with the TWIF acting both as the AN and as the
UE.
20\. The TWIF creates a PDU Session Establishment Request message on behalf of
the UE and sends this message to AMF. This may be triggered by receiving an IP
configuration request (e.g. DHCP Offer/Request) from the UE. The TWIF may use
default values to populate the parameters in the PDU Session Establishment
Request message , but may also not provide some PDU session parameters and let
the AMF or the SMF determine these parameters based on UE subscription
information received during the registration procedure. This way, default PDU
session parameters can be used per UE.
> The value of the PDU Session id provided by TWIF in step 20b shall always be
> the same. It will be a value reserved for the PDU sessions requested by the
> TWIF and it will be different from the values that can be used by the UE
> when requesting a PDU session over 3GPP access. For example, the TWIF could
> use the value 16, while the UE can use any value from 1 to 15, according to
> TS 24.007 [44]. Thus, the PDU session id provided by the TWIF cannot be the
> same with the PDU Session Id of any PDU session established by the UE over
> 3GPP access.
21\. The AMF sends upon request of the SMF an N2 PDU Session Request message
to TWIF in order to reserve the appropriate access network resources. As
usually, this N2 message includes the PDU Session Establishment Accept
message. In step 21b, the TWIF may reserve WLAN resources for the user-plane
communication between the UE and TWIF. If and how this resource reservation is
performed is outside the scope of 3GPP.
After the establishment of the PDU session, the TWIF assigns IP configuration
data to UE (e.g. with DHCP). The IP address assigned to UE is the IP address
allocated to the PDU session.
Step 25: User plane communication.
The TWIF binds the UE-specific L2/L3 connection created in step 9g with the N3
connection created in step 21. All user-plane traffic sent by the UE is
forwarded to TWIF via the L2/L3 connection and then to UPF via the N3
connection. The TWIF functions as a Layer-2 relay.
> The TWIF may receive URSP rules (see TS 23.503 [8]), which indicate the
> traffic that should be offloaded locally by TWIF (sent outside the PDU
> session) and the traffic that should be sent inside the PDU session.
Only one PDU session is supported per \"non-5G-capable over WLAN\" UE.
The above procedure supports only one PDU session per UE whose parameters are
either configured for all UE in the TWIF or are derived from default values in
the UE susbscription.
The TWIF may be co-located with a local UPF that, acting as UL CL or IPv6
Branching Point, can offload locally some traffic. For this purpose, following
mechanism applies (same mechanism than defined in clause 6.13):
\- When establishing a N2 association for an UE with an AMF (INITIAL CONTEXT
SETUP REQUEST) or when sending UL NAS to the AMF, the TWIF provides
information to the AMF about TWIF User Plane; the AMF is not meant to
understand this information but may further propagate this information to SMF.
\- When the AMF establishes a SM association with a SMF (when invoking
Nsmf_PDUSessionCreateSMContext e.g. at the establishment of a PDU Session),
the AMF provides the TWIF User Plane information it has received from the
access. The SMF may use this information to understand that the AN (here TWIF)
supports a co-located UPF and to use this information to (when needed) select
a local UPF to support the PDU Session.
#### 7.3.3.3 Subsequent Registration
The mechanism described in this clause is not used for 3GPP R16 normative
specifications.
Since the EAP authentication shown in Figure 7.3.3.2-1, step 6, is based on
EAP-AKA\', the UE can be assigned a temporary EAP identity, i.e. a pseudonym
or fast re-authentication identity, as specified in RFC 5448 [35]. The TWIF
stores the temporary EAP identity of the UE and the 5G-GUTI assigned by the
AMF in the UE\'s context. Since the temporary EAP identity included in the
EAP/AKA\'-Challenge message is encrypted (see RFC 4187 [63]), the TWIF
receives the temporary EAP identity assigned to UE inside an N2 message. The
AUSF sends the temporary EAP identity to AMF and then the AMF includes it in
the next N2 message sent to TWIF.
When the UE is disconnected from the WLAN access network, the TWIF maintains
the UE\'s context (including the 5G-GUTI, the EAP temporary identity, the 5GMM
context, the 5GSM context, etc.) for some implementation-specific duration. If
the UE attempts to re-connect to the WLAN and provides an EAP temporary
identity, which is known to the TWIF, then the TWIF initiates a \"subsequent\"
registration towards the AMF, by including the associated 5G-GUTI in the
Registration Request message. In addition, the TWIF activates the user-plane
of the established PDU session.
When the UE does not re-connect to the WLAN within the above implementation-
specific duration, the TWIF initiates a 5G deregistration procedure and
releases all the stored information for this UE. The next time the UE attempts
to re-connect to the WLAN network, the TWIF will request the permanent EAP
identity of the UE and will start the initial registration and PDU Session
Establishment described in clause 7.3.3.2.
#### 7.3.3.4 Transfer of PDU session to 3GPP access
The mechanism described in this clause is not used for 3GPP R16 normative
specifications.
If the UE supports 3GPP access, then UE may initiate a PDU session handover
procedure (as the one specified in TS 23.502 [3], clause 4.9.2.1) to transfer
the PDU session established by the TWIF over trusted non-3GPP access to the
3GPP access. For this purpose, the UE sends over 3GPP access a PDU Session
Establishment Request message including the value of the PDU Session id used
by the TWIF and indicates that this is an \"Existing PDU Session\". As
described above (see clause 7.3.3.2, step 20), the value of the PDU Session id
used by TWIF is always the same and, thus, it is known to UE.
If the UE attempts to re-connect to a WLAN and the UE has transferred to 3GPP
access the PDU session previously established by TWIF for this UE (as
specified above), then the new PDU session requested by the TWIF would release
the PDU session that was transferred to 3GPP access. The UE is aware of this
when it decides to re-connect to the WLAN.
### 7.3.4 Solution Evaluation
This solution 7.3 allows UE that do not support 5GC NAS (over WLAN) to get
access to 5GC services. It can be used to access to community WiFi services.
It supports a single PDU session per UE with a possibility of local traffic
offload. The PDU Session cannot support mobility with 3GPP access.
## 7.4 Solution #4: Access to 5GC from UEs without supporting NAS on non-3GPP
access
### 7.4.1 General
This solution enables UEs, which do not support 5G NAS signalling over WLAN,
to establish 5GC connectivity via a trusted WLAN access network. These UEs are
referred to as \"Non-5G-capable over WLAN\" UEs since they are not capable to
operate as 5G UEs over a WLAN access network. A \"Non-5G-capable over WLAN\"
UE, however, may be capable to operate as a 5G UE over NG-RAN.
Unless otherwise specified, any reference to a UE in this solution means a
\"Non-5G-capable over WLAN\" UE.
### 7.4.2 Reference Architecture
The same reference architecture is used, as the one specified for the Solution
#3 in clause 7.3.2.
### 7.4.3 Procedures
#### 7.4.3.1 WLAN Selection
The same WLAN selection procedure is used, as the one specified for the
Solution #3 in clause 7.3.3.1.
#### 7.4.3.2 WLAN Connection & PDU Session Establishment
Figure 7.4.3.2-1: WLAN Connection and PDU Session establishment
0\. By using the 5G NAS protocol, the TWIF registers with the 5GC and receives
a list of allowed S-NSSAIs. Whether the TWIF must be authenticated using 3GPP
credentials or may be authenticated using non-3GPP credentials (e.g. a digital
certificate) is for SA3 to decide. The TWIF must have a 5G subscription.
During the registration with the 5GC, the AMF-1 is allocated as the serving
AMF of TWIF.
In addition, during the registration with the 5GC, the AMF-1 may receive from
UDM a \"default DNN for delegated PDU Sessions\" and a \"default S-NSSAI for
delegated PDU Sessions\", which may be used later when the TWIF requests a
delegated PDU Session and no DNN or S-NSSAI is explicitly requested. The
\"default DNN for delegated PDU Sessions\" and the \"default S-NSSAI for
delegated PDU Sessions\" may be part of the TWIF subscription, which contains
special information that enables the TWIF to initiate delegated PDU Sessions.
Alternatively, the TWIF may not have special information in its subscription
but, during registration, it may request to initiate delegated PDU Sessions.
If this request is accepted by 5GC, a \"default DNN for delegated PDU
Sessions\" and a \"default S-NSSAI for delegated PDU Sessions\" may be
provided to its serving AMF-1, either from UDM or from PCF.
The TWIF may indicate to TWAP (step 0b) the supported PLMN and the allowed
S-NSSAIs. This enables the TWAP to be informed about the PLMNs and S-NSSAIs
supported by all TWIFs it can interwork with. The TWAP can use this
information to advertise (e.g. with ANQP) the PLMNs and the S-NSSAIs with
which \"5G connectivity without NAS\" is supported.
1\. The UE selects a trusted WLAN that supports \"5G connectivity without
NAS\" and a PLMN behind this WLAN as specified in clause 7.3.3.1. Then it
associates with this WLAN and an EAP authentication procedure is initiated.
The NAI (\\@realm) provided by the UE in step 1c indicates that the UE
wants \"5G connectivity without NAS\" towards a specific PLMN and (optionally)
using a specific network slice (S-NSSAI) in this PLMN. For example, with
NAI=\\@sdD16273.sst03.5gc-nn.mnc123.mcc45.3gppnetwork.org, the UE
indicates that it wants \"5G connectivity without NAS\" (5gc-nn) to the PLMN
with MCC=45 and MNC=123, and it wants to use a network slice in this PLMN with
Slice/Service Type=03 and Slice Differentiator=D16273. The UE may be pre-
configured to use a certain S-NSSAI (e.g. an S-NSSAI supported by its HPLMN),
or the UE may discover the S-NSSAIs supported a PLMN, in case the WLAN
advertises these S-NSSAIs, as defined in clause 7.6.
2\. The trusted WLAN access point (TWAP) selects a TWIF that supports
delegated PDU Sessions with the PLMN and the S-NSSAI (if any) contained in the
UE\'s NAI. The TWAP may be preconfigured to know the PLMN and S-NSSAIs
supported by each TWIF, or may receive this information from the TWIF in step
0b.
3\. The TWIF receives a request from the WLAN access network indicating that a
UE requests to connect to the WLAN access network. This request includes the
Network Access Identifier (NAI) of the UE, which a PLMN identity and may
include a requested S-NSSAI , as discussed in step 1.
Editor\'s note: If and how a requested DNN may also be indicated by the UE is
FFS..
4\. The TWIF decides whether a delegated PDU Session for this UE should be
established. This delegated PDU Session would create a tunnel between the TWIF
and an external DN, which would be used to transfer data packets between the
UE and the external DN, via the 5G core network.
The TWIF may establish a delegated PDU Session for every UE that attempts to
connect to a WLAN, or only for some UEs. For example, the TWIF may decide to
establish a delegated PDU Session only if the NAI of the UE includes a special
indication as part of the username (e.g. NAI = delegated!username\@realm) or
as part of the realm. This indication may be pre-defined in the UE and in the
TWIF, or it may be received by TWIF during its 5G registration. Alternatively,
the TWIF may decide to establish a delegated PDU Session for the UE, if the
request in step 3 includes a DNN and/or an S-NSSAI parameter.
If the TWIF decides not to establish a delegated PDU Session for the UE, then
the data traffic of the UE may be carried inside a PDU Session, which
multiplexes the traffic of all UEs that have no delegated PDU Sessions. In
other words, the TWIF may establish a \"delegated\" PDU Session for a group of
UEs..
5\. After deciding to establish a delegated PDU Session for the UE, the TWIF
sends a NAS message to AMF-1 including a PDU Session Establishment Request.
This NAS message contains a Request Type = \"initial delegated request\",
indicating that the requested PDU Session is a delegated PDU Session, i.e. a
PDU Session that will carry, not the traffic of TWIF, but the traffic of a
\"non-5G-capable over WLAN\" UE that is located \"behind\" the TWIF.
The NAS message sent by TWIF also contains the NAI of the UE, and this NAI
(username\@realm) is used to uniquely identify the delegated PDU Session
across all delegated PDU Sessions in the 5G PLMN.
The PDU Session ID in the NAS message sent by TWIF may include any suitable
value. It may even contain a fixed value (e.g. \"255\") which is used for all
delegated PDU Sessions. Note that, a normal PDU Session is identified by the
permanent identity of the UE that requests the PDU Session (the SUPI) and a
unique PDU Session ID ranging from 1-15. A delegated PDU Session, however, can
be uniquely identified by the NAI of the \"Non-5G-capable over WLAN\" UE.
Therefore, the PDU Session ID is not necessary, assuming that the same UE may
have only one delegated PDU Session. Although the PDU Session ID is not
necessary, the signaling flow in Fig. 7.4.3.2-1 includes the PDU Session ID in
all messages required by Rel-15 specifications.
NOTE 1: Although this procedure requires the NAI of the UE to be used as a PDU
session identifier, this requirement can be relaxed to minimize the 5GC
impact. The PDU Session ID could still be used to identify delegated PDU
sessions. To increase the number of delegated PDU sessions supported by a
single TWIF, the value range of the PDU Session ID could be extended from 1-15
to e.g. 1-255 or 1-65535. Alternatively, the value range of the PDU Session ID
could remain the same (1-15) but the TWIF could establish a delegated PDU
session for a group of UEs (not only one UE). In this case, the TWIF would
need to count the traffic exchanged by each UE and provide this information
for charging purposes.
The TWIF may establish normal PDU Sessions for its own use and delegated PDU
Sessions for \"non-5G-capable over WLAN\" UEs. The maximum number of delegated
PDU Sessions is not limited by the PDU Session ID (since the PDU Session ID is
not used as a unique identifier), but may be limited by the TWIF subscription
or by policy configured in the 5G core network.
The PDU Session Establishment Request may include a PDU Type (e.g. IPv4 or
IPv6) and an SSC Mode (e.g. SSC Mode 2), if the TWIF is configured with
default values for the PDU Type and/or the SSC Mode. These default values
however can be overridden by other values provided later by the AAA server
(see last message in step 9).
6a. After the AMF-1 receives the request from TWIF, it confirms that the TWIF
is authorized to establish delegated PDU Sessions. This confirmation may be
based on subscription information received from UDM during the TWIF
registration, or other type of information, such as policy information
received from PCF.
If the request from TWIF does not include a DNN and/or an S-NSSAI, the AMF-1
uses the \"default DNN for delegated PDU Sessions\" and the \"default S-NSSAI
for delegated PDU Sessions\" that were received during the TWIF registration
procedure. Based on these DNN and S-NSSAI values, the AMF-1 selects an SMF, as
currently specified in TS 23.501 [2].
6b. The AMF-1 sends a Create Session Management (SM) Context request to the
selected SMF. This request contains the NAI of the UE. This NAI indicates to
SMF that this is a request for a delegated PDU Session and the UE is
identified by the NAI. The SUPI is the permanent identity of the TWIF, which
requests the delegated PDU Session.
7\. The SMF registers with the UDM by sending a Nudm_UECM_Registration
request, as specified in TS 23.502 [3]. This registration includes the
identity of SMF (SMF ID) and indicates to UDM that this SMF holds the SM
context of a PDU Session requested by TWIF (SUPI), for a UE identified by NAI,
and for a certain DNN. Subsequently, any authorized network function may
request from UDM to provide the identity of the SMF that holds the SM context
of the delegated PDU Session of the UE (identified by NAI).
The SMF creates the SM context for the delegated PDU Session and sends a
response to AMF-1.
8\. The SMF starts a \"secondary authentication\" procedure, as the one
specified in TS 23.502 [3], before the delegated PDU Session is accepted. This
authentication is necessary in order to validate the identity of the UE and to
decide if this UE is authorized to use a delegated PDU Session with certain
DNN and S-NSSAI parameters. It is also necessary in order to derive a Master
Session Key (MSK) in the UE and in the AAA server, which can be used to secure
the communication over the trusted WLAN air interface (see details below).
9\. The SMF sends a request to the AAA server to authenticate the UE
identified by NAI. Optionally, the SMF may select a certain AAA server, which
holds the subscription information for the received NAI. This selection may be
based e.g. on the realm in NAI. The AAA server is assumed inside the 5GC but
it may also be located inside the data network (DN) associated with the DNN.
In the latter case, the SMF would communicate with the AAA server in the DN
via a UPF (as currently specified in TS 23.502 [3]), so a UPF selection would
be required before step 9.
An EAP-based authentication procedure takes place wherein EAP messages are
exchanged between the AAA server and the UE. An EAP message originated at the
AAA server is encapsulated into an AAA message, which is sent to SMF. Then,
the EAP message is encapsulated into a 5GSM message (PDU Session
Authentication Command), which is sent to TWIF via AMF-1. Finally, the EAP
message is encapsulated into another AAA message, which is sent from TWIF to
the WLAN access network (e.g. to the WLAN AP where the user UE is located, or
to a centralized AAA client in the WLAN access network). In the opposite
direction (from the UE to the AAA server), the same encapsulation mechanisms
exist. The TWIF performs interworking between the 5GSM signaling with the SMF
and the AAA signaling with the WLAN access network. This interworking enables
EAP messages to be exchanged between the UE and the AAA server and to
authenticate the UE (or to mutually authenticate the UE and the AAA server) by
means of any applicable EAP authentication method. As an example, EAP-AKA
messages (see RFC 4187 [63]) could be exchanged in order to carry out an EAP-
AKA authentication procedure, or EAP-TLS messages (see RFC 5216 [45]) could be
exchanged in order to carry out an EAP-TLS authentication procedure.
In the final step of a successful authentication procedure, the AAA server
sends a AAA Accept message to SMF, which may include, not only the MSK derived
during the EAP authentication, but also the PDU Type and/or the SSC Mode that
should be used for the delegated PDU Session. If necessary, additional
parameters may be provided by the AAA server, such as the DNN and the S-NSSAI
(although they are not shown in the figure). All these parameters can be based
on the subscription information of the UE, stored in the AAA server. Note that
the PDU Type and the S-NSSAI provided by the AAA server override the PDU Type
and the S-NSSAI respectively that may be provided by the TWIF in step 5 and
sent to SMF in step 6b.
10\. After receiving the AAA Accept message from the AAA server, the SMF
requests from PCF to provide the SM policy for the delegated PDU Session,
according to the existing procedures in TS 23.502 [3]. The only difference is
that the SMF sends to PCF also the NAI to indicate to PCF that this is a
delegated PDU Session requested by the TWIF (SUPI) for a specific UE (NAI). In
response, the PCF sends to SMF the default QoS, the Aggregated Maximum Bit
Rate (AMBR) and other parameters, including PCC rules, which should be applied
for the delegated PDU Session.
11\. The SMF selects a UPF and establishes a normal N4 session with the
selected UPF.
12\. The SMF sends an N1N2MessageTransfer request to AMF-1, which includes
both an N2 SM Information (that should be delivered to the access network -
the TWIF in this case) and an N1 SM Container (that should be delivered to the
requester of the delegated PDU Session - again the TWIF in this case). The N2
SM Information includes all information required by the access network to
reserve the necessary resources for this PDU Session, including the PDU
Session ID, the QoS Profiles, etc. In addition, however, it includes the NAI
associated with the delegated PDU Session and the MSK derived after the
successful authentication. The N1 SM Container includes a 5GSM message (PDU
Session Establishment Accept), which contains an EAP-Success message, the QoS
Rules, the PDU Type, the SSC Mode, etc.
After receiving the N1N2MessageTransfer request with both the N2 SM
Information and the N1 SM Container, the AMF-1 sends a PDU Session Resource
Setup request to TWIF (step 12b) in order to reserve the applicable resources
for the delegated PDU Session. Note that the TWIF receives both the N2 SM
Information and the N1 SM Container because it operates both as a radio access
node and as a 5G-capable UE.
After receiving the PDU Session Resource Setup request, the TWIF sends an AAA
Accept message to the TWAN (step 12c) that includes the EAP-Success message
and Pairwise Master Key (PMK) derived from the MSK, which should be used to
protect the data traffic over the WLAN air interface (between the UE and the
TWAP). In addition, it includes information that can be used by the TWAP to
setup a Layer 2 (L2) or Layer 3 (L3) connection with the TWIF and to send all
data traffic of the UE to TWIF via this connection.
After the TWAP receives the AAA Accept message, it forwards the EAP-Success
message to the UE (step 12d).
13\. The MSK (which is also created in the UE) is used to derive a Pairwise
Master Key (PMK - see IEEE 802.11 [27]) and to secure the WLAN air-interface
traffic between the UE and the TWAP.
14\. A L2/L3 connection is established between the trusted WLAN AP and TWIF,
which will carry all data traffic of the UE.
15\. The IP address/prefix assigned for the delegated PDU Session is delivered
to the UE (e.g. with DHCP).
16\. The TWIF responds to AMF-1 with a PDU Session Resource Setup response,
confirming the reservation of the necessary radio access resources for the
delegated PDU Session. In turn, the AMF-1 updates the SM context in the SMF
for the delegated PDU Session.
17\. Finally, the N4 session with the UPF is updated too, in order to provide
to UPF the TWIF address and port (tunnel information) which downlink traffic
should be forwarded to.
18\. This completes the establishment of the delegated PDU Session. After this
point, all data (user-plane) traffic sent by the UE is forwarded by the
trusted WLAN AP to the TWIF via the L2 connection, and from the TWIF is
forwarded to the UPF via the established N3 tunnel. This N3 tunnel was
established during the delegated PDU Session setup and may be configured
(based on the received QoS Rules) with one or more QoS flows. In Fig.
7.4.3.2-1 an example is shown with two QoS flows. In the uplink direction, the
TWIF applies the provisioned QoS Rules and determines to which QoS flow to
forward an uplink data packet. In the downlink direction, the UPF applies the
provisioned Packet Detection Rules and determines to which QoS flow to forward
a downlink data packet.
During the above PDU session establishment procedure, the TWIF may be
provisioned with rules that indicate which of the UE\'s data traffic should be
locally offloaded (i.e. sent outside the PDU session). As an example, some
data traffic may be locally offloaded in order to access services deployed
close to the TWIF and which cannot be accessed via the DN.
Editor\'s note: If and how a delegated PDU Session can be transferred to 3GPP
access, is FFS.
### 7.4.4 Impacts on existing Functions
As specified in clause 7.4.3.2 (see step 5), the PDU Session ID that is
provided by TWIF, when it requests a PDU Session for a UE, may take any
suitable value. It may even contain a fixed value (e.g. \"255\") for all the
PDU Sessions requested by the TWIF. This means that the PDU Session ID does
not uniquely identify a PDU session. Instead, a PDU session is uniquely
identified by the NAI of the UE that utilizes the PDU session.
This creates impact on the AMF, SMF and other 5GC network functions, which
currently (Rel-15) use the PDU Session ID and the SUPI to uniquely identify
PDU sessions.
To avoid this impact, the PDU Session ID could still be used to identify
delegated PDU sessions. To increase the number of delegated PDU sessions
supported by a single TWIF, the value range of the PDU Session ID could be
extended from 1-15 to e.g. 1-255 or 1-65535. Alternatively, the value range of
the PDU Session ID could remain the same (1-15) but the TWIF could establish a
delegated PDU session for a group of UEs (not only one UE). In this case, the
TWIF would need to count the traffic exchanged by each UE and provide this
information for charging purposes.
Editor\'s note: The detailed impact on the 5GC network functions is FFS.
## 7.5 Solution #5: Access Network Selection for Trusted Non-3GPP Access
### 7.5.1 General
This solution specifies the steps executed by the UE when the UE wants to
connect to a PLMN over _trusted_ non-3GPP access. The UE decides to use
trusted non-3GPP access for connecting to a PLMN based e.g. on
\- the UE implementation; or
\- the UE configuration, e.g. the UE is configured to try first the trusted
non-3GPP access procedure; or
\- the UE capabilities, e.g. the UE supports only the trusted non-3GPP access
procedure; or
\- the advertised capabilities of the discovered non-3GPP access networks,
e.g. one or more available non-3GPP access networks advertise support of
\"trusted connectivity, etc.
An example deployment scenario is schematically illustrated in Figure 7.5.1-1.
In this scenario, the UE has discovered 5 WLAN access networks. These WLANs
advertise information about the 3GPP networks they interwork with, e.g., by
using the ANQP protocol, as defined in the HS2.0 specification. Each WLAN may
support \"S2a connectivity\" and/or \"5G connectivity\" to one or more PLMNs.
The UE needs to select (a) a WLAN access network, (b) a PLMN, and (c) a
connectivity type, i.e. either \"S2a connectivity\" or \"5G connectivity\".
Selecting \"S2a connectivity\" or \"5G connectivity\" is similar to selecting
an ePDG or an N3IWF for the case of untrusted non-3GPP access.
Each WLAN may advertise one or more of the following PLMN lists:
1) A PLMN List-1, which includes PLMNs with which \"AAA connectivity\" is
supported. A WLAN supports \"AAA connectivity\" with a PLMN when it deploys an
AAA function that can connect with a 3GPP AAA Server/Proxy in this PLMN, via
an STa interface (trusted WLAN to EPC), or via an SWa interface (untrusted
WLAN to EPC); see TS 23.402 [43].
2) A PLMN List-2, which includes PLMNs with which \"S2a connectivity\" is
supported. A WLAN supports \"S2a connectivity\" with a PLMN when it deploys a
TWAG function that can connect with a PGW in this PLMN, via an S2a interface;
see TS 23.402, clause 16.
3) A PLMN List-3, which includes PLMNs with which \"5G connectivity\" is
supported. A WLAN supports \"5G connectivity\" with a PLMN when it deploys a
TNGF function that can connect with an AMF function and an UPF function in
this PLMN via N2 and N3 interfaces, respectively; see clause 7.1 in this
document.
When the UE sends a query (e.g. an ANQP query) to a WLAN requesting \"3GPP
Cellular Network\" information, the WLAN replies with a response containing a
\"3GPP Cellular Network\" information element containing the PLMN List-1,
and/or the PLMN List-2, and/or the PLMN List-3. Note that the PLMN List-1 and
the PLMN List-2 are already supported in the EPS specifications (see e.g. TS
23.402 [43] and TS 24.302 [54]). However, the PLMN List-3 is a new list, used
to indicate interworking with 5G PLMNs.
The UE determines if a WLAN support \"trusted connectivity\" to a given PLMN
by receiving the PLMN List-2 and the PLMN List-3 advertised by this WLAN. If
this PLMN is not included in any of these lists, then the WLAN can only
support connectivity to an ePDG or N3IWF in the PLMN (i.e. \"untrusted
connectivity\").
{width="6.169444444444444in" height="6.353472222222222in"}
Figure 7.5.1-1: Example deployment scenario
### 7.5.2 Access Network Selection Procedure
The steps below specify the steps executed by the UE when the UE wants to
connect to a PLMN over trusted non-3GPP access. Note that the UE executes
these steps before connecting to a non-3GPP access network. This is different
from the untrusted non-3GPP access, where the UE first connects to a non-3GPP
access (without using 3GPP-based authentication), obtains IP configuration and
then proceeds to PLMN selection and ePDG/N3IWF selection. In case of trusted
non-3GPP access, the UE uses 3GPP-based authentication for connecting to a
non-3GPP access, so it must first select a PLMN and then attempt to connect to
a non-3GPP access. In case of \"S2a connectivity\", the UE includes the
selected PLMN in the decorated NAI and, in case of \"5G connectivity\", the UE
provides the selected PLMN to the TNGF.
Step 1: The UE constructs a list of available PLMNs. This list contains the
PLMNs included in the PLMN List-2 and PLMN List-3, advertised by all
discovered non-3GPP access networks. For each PLMN the supported type(s) of
trusted connectivity is also included.
a. In the example shown in Figure 7.5.1-1, the list of available PLMNs
includes:
\- PLMN-a: \"S2a connectivity\", \"5G connectivity\"
\- PLMN-b: \"5G connectivity\"
\- PLMN-c: \"S2a connectivity\", \"5G connectivity\"
\- PLMN-d: \"S2a connectivity\"
Step 2: The UE selects a PLMN that is included in the list of available PLMNs,
as follows:
a. If the UE is connected to a PLMN via 3GPP access and this PLMN is included
in the list of available PLMNs, the UE selects this PLMN. If this PLMN is not
included in the list of available PLMNs, but it is included in the \"Non-3GPP
access node selection information\" (see TS 23.501 [2]), the UE selects this
PLMN and executes the combined ePDG/N3IWF selection procedure specified in TS
23.501 [2].
b. Otherwise (the UE is not connected to a PLMN via 3GPP access, or the UE is
connected to a PLMN via 3GPP access but this PLMN is neither in the list of
available PLMNs nor in the \"Non-3GPP access node selection information\"):
i) If the UE determines to be located in its home country, then:
\- The UE selects the HPLMN, if included in the list of available PLMNs.
Otherwise, the UE selects an E-HPLMN (Equivalent HPLMN), if an E-HPLMN is
included in the list of available PLMNs. If the list of available PLMNs does
not include the HPLMN and does not include an E-HPLMN, the UE stops the
procedure and may attempt to connect via untrusted non-3GPP access.
ii) If the UE determines to be located in a visited country, then:
\- The UE determines if it is mandatory to select a PLMN in the visited
country, as follows:
\- If the UE has IP connectivity (e.g. the UE is connected via 3GPP access),
the UE sends a DNS query and receives a DNS response that indicates if a PLMN
must be selected in the visited country. The DNS response includes a lifetime
that denotes how long the DNS response can be cached. Note that the FQDN in
the DNS query will be different from the DNS query used for ePDG/N3IWF
selection. Also, the DNS response does not need to include a list of PLMNs
that support \"S2a connectivity\" and/or \"5G connectivity\" because the UE
has the list of available PLMNs.
\- If the UE has no IP connectivity (e.g. the UE is not connected via 3GPP
access), then the UE may use a cached DNS response that was received in the
past, or may use local configuration that indicates which visited countries
mandate a PLMN selection in the visited country.
\- If the UE determines that it is not mandatory to select a PLMN in the
visited country, and the HPLMN or an E-HPLMN is included in the list of
available PLMNs, then the UE selects the HPLMN or an E-HPLMN, whichever is
included in the list of available PLMNs.
\- Otherwise, the UE selects a PLMN in the visited country by considering, in
priority order, the PLMNs in the Operator Controlled PLMN Selector list (in
USIM). The UE selects the highest priority PLMN in the Operator Controlled
PLMN Selector list that is also included in the list of available PLMNs.
\- If the list of available PLMNs does not include a PLMN that is also
included in the Operator Controlled PLMN Selector list, the UE stops the
procedure and may attempt to connect via untrusted non-3GPP access.
c. In the example shown in Figure 7.5.1-1, the UE may select PLMN-c, for which
\"S2a connectivity\" and \"5G connectivity\" is supported.
Step 3: The UE selects the type of trusted connectivity (\"S2a connectivity\"
or \"5G connectivity\") for connecting to the selected PLMN, as follows:
a. If the list of available PLMNs indicates that both \"S2a connectivity\" and
\"5G connectivity\" is supported for the selected PLMN, then:
\- The UE selects \"5G connectivity\" because the \"5G connectivity\" is
preferred type of trusted access.
Editor\'s note: It is FFS if another mechanism is needed to select between
\"S2a connectivity\" and \"5G connectivity\".
b. Otherwise, if the list of available PLMNs indicates that only one type of
trusted connectivity (either \"S2a connectivity\" or \"5G connectivity\") is
supported for the selected PLMN, the UE selects this type of trusted
connectivity.
c. In the example shown in Figure 7.5.1-1, the UE may select PLMN-c and \"5G
connectivity\". There are two WLAN access networks that support \"5G
connectivity\" to PLMN-c: WLAN access network 2 and WLAN access network 4.
Step 4: Finally, the UE selects a non-3GPP access network to connect to, as
follows:
a. The UE puts the available non-3GPP access networks in priority order. In
case of WLAN access, the UE constructs this prioritized list by using the
WLANSP rules. In case of other types of non-3GPP access, it is FFS how this
prioritized list is constructed.
b. From the prioritized list of non-3GPP access networks, the UE selects the
highest priority non-3GPP access network that supports the selected type of
trusted connectivity to the selected PLMN.
c. In the example shown in Figure 7.5.1-1, the UE selects either WLAN access
network 2 or WLAN access network 4, whichever has the highest priority in the
prioritized list of non-3GPP access networks. Over this WLAN access network
the UE starts the 5GC registration procedure as specified in clause 7.1.3.3
(because \"5G connectivity\" was selected in step 3), and it provides the
selected PLMN to the TNGF.
## 7.6 Solution #6: Access Network Selection for UEs not supporting NAS
{#solution-6-access-network-selection-for-ues-not-supporting-nas .list-
paragraph}
### 7.6.1 General
This clause specifies the procedure executed by a UE, which does not support
the NAS protocol over WLAN access (aka \"Non-5G-capable over WLAN\" UE), in
order to (a) select a 5G PLMN network, and (b) select a WLAN access network
that can provide _5G_ _connectivity-without-NAS_ to the selected 5G PLMN. This
procedure is called \"access network selection\" procedure.
An example deployment scenario is schematically illustrated in Figure 7.6.1-1.
In this scenario, the \"Non-5G-capable over WLAN\" UE has discovered 4 WLAN
access networks. These WLANs advertise information about the 3GPP networks
they interwork with, e.g., by using the ANQP protocol, as defined in the HS2.0
specification. Each WLAN may support \"S2a connectivity\" to one or more
PLMNs, and/or \"5G connectivity\" to one or more PLMNs, and/or \"5G
connectivity without NAS\" to one or more PLMNs. The UE needs to select a WLAN
access network that supports \"5G connectivity without NAS\" to one or more
PLMNs, and a PLMN to connect to without using the NAS protocol.
Each trusted WLAN may advertise one or more of the following PLMN lists:
1) A PLMN List-1, which includes PLMNs with which \"AAA connectivity\" is
supported. A WLAN supports \"AAA connectivity\" with a PLMN when it deploys an
AAA function that can connect with a 3GPP AAA Server/Proxy in this PLMN, via
an STa interface (trusted WLAN to EPC), or via an SWa interface (untrusted
WLAN to EPC); see TS 23.402 [43].
2) A PLMN List-2, which includes PLMNs with which \"S2a connectivity\" is
supported. A WLAN supports \"S2a connectivity\" with a PLMN when it deploys a
TWAG function that can connect with a PGW in this PLMN, via an S2a interface;
see TS 23.402, clause 16.
3) A PLMN List-3, which includes PLMNs with which \"5G connectivity\" is
supported. A WLAN supports \"5G connectivity\" with a PLMN when it deploys a
TNGF function that can connect with an AMF function and an UPF function in
this PLMN via N2 and N3 interfaces, respectively; see clause 7.1 in this
document.
4) A PLMN List-4, which includes PLMNs with which \"5G connectivity without
NAS\" is supported. A WLAN supports \"5G connectivity without NAS\" with a
PLMN when it deploys a TWIF function that can connect with an AMF function and
an UPF function in this PLMN via N2 and N3 interfaces, respectively; see
clause 7.3 and clause 7.4.
When the UE sends a query (e.g. an ANQP query) to a WLAN requesting \"3GPP
Cellular Network\" information, the WLAN replies with a response containing a
\"3GPP Cellular Network\" information element containing the PLMN List-1,
and/or the PLMN List-2, and/or the PLMN List-3, and/or the PLMN List-4. Note
that the PLMN List-1 and the PLMN List-2 are already supported in the EPS
specifications (see e.g. TS 23.402 [43] and TS 24.302 [54]). The PLMN List-3
is defined in clause 7.5 and the PLMN List-4 is a list used to advertise 5G
PLMNs with which the WLAN can establish connectivity without the NAS protocol.
{width="5.766666666666667in" height="5.254861111111111in"}
Figure 7.6.1-1: Access selection example
### 7.6.2 Access Network Selection Procedure
This clause specifies the steps executed by a \"Non-5G-capable over WLAN\" UE
when the UE wants to establish a data connection to a Data Network (DN), via a
trusted WLAN access and via a 5G PLMN. Note that the UE executes these steps
_before_ connecting to a WLAN access network.
The steps executed by a \"Non-5G-capable over WLAN\" UE are described below.
These steps are very similar to the corresponding steps executed by a UE that
supports NAS; see clause 7.5.2.
Step 1: The UE constructs a list of available PLMNs. This list contains the
PLMNs included in the PLMN List-4 advertised by all discovered WLAN access
networks.
a. In the example shown in Figure 7.6.1-1, the list of available PLMNs may
include:
\- PLMN-a.
\- PLMN-d.
Step 2: The UE selects a PLMN that is included in the list of available PLMNs
as follows. In the example scenario shown in Fig. 7.6.1-1, the UE may select
PLMN-d.
a. If the UE is connected to a PLMN via 3GPP access and this PLMN is included
in the list of available PLMNs, the UE selects this PLMN.
b. Otherwise (the UE is not connected to a PLMN via 3GPP access, or the UE is
connected to a PLMN via 3GPP access but this PLMN is not in the list of
available PLMNs):
i) If the UE determines to be located in its home country, then:
\- The UE selects the HPLMN if the UE has a USIM or a pre-configured PLMN, if
included in the list of available PLMNs. Otherwise, the UE selects an E-HPLMN
(Equivalent HPLMN), if an E-HPLMN is included in the list of available PLMNs.
If the list of available PLMNs does not include the HPLMN and does not include
an E-HPLMN, the UE stops the access network selection procedure.
ii) If the UE determines to be located in its visited country, then:
\- The UE determines if it is mandatory to select a PLMN in the visited
country, as follows:
\- If the UE has IP connectivity (e.g. the UE is connected via 3GPP access),
the UE sends a DNS query and receives a DNS response that indicates if a PLMN
must be selected in the visited country. The DNS response includes a lifetime
that denotes how long the DNS response can be cached.
\- If the UE has no IP connectivity (e.g. the UE is not connected via 3GPP
access), then the UE may use a cached DNS response that was received in the
past, or may use local configuration that indicates which visited countries
mandate a PLMN selection in the visited country.
\- If the UE determines that it is not mandatory to select a PLMN in the
visited country, and the HPLMN or an E-HPLMN is included in the list of
available PLMNs, then the UE selects the HPLMN or an E-HPLMN, whichever is
included in the list of available PLMNs.
\- Otherwise, the UE selects a PLMN in the visited country by considering a
pre-configured list of PLMNs in priority order. If the UE has a USIM, this
list shall be the Operator Controlled PLMN Selector list. The UE selects the
highest priority PLMN in the pre-configured list that is also included in the
list of available PLMNs.
\- If the list of available PLMNs does not include a PLMN that is also
included in the pre-configured list, the UE either stops the access network
selection procedure, or may select a PLMN based on UE implementation means.
Step 3: Finally, the UE selects a WLAN access network (e.g. an SSID) to
connect to, as follows:
a. The UE puts the available WLAN access networks in priority order. The UE
constructs this prioritized list by using the WLANSP rules (if they have been
received via 3GPP access), or any other UE implementation specific means.
b. From the prioritized list of WLAN access networks, the UE selects the
highest priority WLAN access network that supports \"5G connectivity without
NAS\" to the PLMN selected in step 2.
c. In the example shown in Figure 7.6.1-1, if the UE selected PLMN-d in step
2, then the UE would select the either the WLAN access network 2, or the WLAN
access network 3.
After the UE completes the above access network selection procedure, the UE
initiates the establishment of the desired data connection by associating with
the selected WLAN and by sending an EAP-Response/Identity message. The Network
Address Identifier (NAI) provided by the UE indicates that the UE wants \"5G
connectivity without NAS\" towards a specific PLMN. For example, with NAI=_\
\@nai.5gc-nn.mnc123.mcc45.3gppnetwork.org_, the UE indicates that it
wants \"5G connectivity without NAS\" (5gc-nn) to the PLMN with MCC=45 and
MNC=123.
# 8 Conclusions
## 8.1 Conclusions on Trusted Non-3GPP Access
The following list summarizes the conclusions regarding the support of trusted
non-3GPP access:
\- The 5GC registration over trusted non-3GPP access (as required by Key Issue
#1 in clause 5.3.1) will be based on the procedure specified in clause
7.1.3.3.
\- Over the NWt reference point between the UE and TNGF, the IKEv2/IPsec
protocols will be used, as specified in clause 7.1.3.4.2, \"Option 1: IKEv2
and IPsec with NULL Encryption\". SA WG3 will specify all security details,
including whether NULL encryption is sufficient and what type of security
protection is generally required for NAS transport and User Plane transport
between the UE and the TNGF.
\- A TNAN advertises (e.g. with ANQP) the PLMNs with which it can support
\"trusted connectivity\" and the types of supported \"trusted connectivity\",
i.e. \"5G connectivity\", defined in clause 7.5, or \"S2a connectivity\",
defined in TS 23.402 [43].
\- A UE that supports NAS over non-3GPP access shall select a PLMN and a TNAN
to connect to this PLMN with a \"trusted connectivity\" procedure, as
specified in clause 7.5.
\- When the UE decides to access to a TNAN in order to establish \"trusted
connectivity\" to a PLMN, the UE shall indicate the requested type of
\"trusted connectivity\" by formatting its NAI, as defined in clause 7.1.3.2.
\- There is no interface between the TNGF and the NG-RAN in Release 16.
\- A TNAN shall be able to support EAP Re-authentication, as specified in RFC
6696 [28]. In the special case of a trusted WLAN access network, the EAP Re-
authentication enables the support of Fast Initial Link Setup (FILS),
specified in IEEE 802.11ai. The TNGF shall implement the functionality of an
ERP server and the \"Intra-TNGF Mobility\" procedure specified in clause
7.1.3.5.1 shall be supported.
\- During the normative phase of the work, it will be decided if the \"Inter-
TNGF Mobility\" procedure shall be supported.
\- for the Access to 5GC from UEs without supporting NAS on non-3GPP access,
the solution 7.3 will be used as the baseline for normative specifications if
SA3 accepts a primary authentication that is not based on EAP AKA.
\- A UE that does not support NAS over WLAN access shall select a 5G PLMN and
a WLAN access network to connect to this 5G PLMN, as specified in clause 7.6.
## 8.2 Conclusions on WWC
### 8.2.1 Conclusions on FWA
The following list summarizes the conclusions regarding the support of FWA :
\- The reference architecture is defined in scenario #1 figure 4.2.2.1-3
\- The solution applies only for 5G-RG connected only via NG RAN.
\- solution #19 as described in clause 6.19 is endorsed as a basis for
normative specifications.
\- The applicability of roaming scenario and whether and how wholesale model
are applicable to FWA is under the scope of BBF. The capability to support or
to restrict 5G-RG to connect only to HPLMN is currently support by 3GPP
specification and it does not require any modification.
\- - No specific cable related aspect identified. Solution can be reused.
### 8.2.2 Conclusions for the scenario that 5G-RG/5G-CRG connected via
W-5GAN/W-5GCAN
Regarding the architecture that 5G-RG connected via W-5GAN shown in Figure
4.2.2.1-1, conclusions are listed as below:
NOTE: Unless otherwise stated, the following conclusion applies to
5G-RG/W-5GCAN as well.
NAS transmission after registration:
\- A signalling connection based on protocol FCP between 5G-RG and AGF should
be established to transmit the NAS message;
\- Details about FCPthe signalling connection should be specified in BBF.
NOTE 1: the definition of FCP signalling connection is within BBF scope that
from SA2 perspective is capable to transport NAS messages between 5G-RG and
AGF.
\- Between 5G-CRG and CFAGF, \"Cable Fixed Access Control Protocol\" (CFCP)
for transporting NAS message will be defined by CableLabs.
Registration procedure:
\- The Registration procedure is based on following principles:
\- Authentication shall be based on NAS exchange encapsulating authentication
messages as defined in TS 33.501 [25] where the 5G-RG acts as the UE and AGF
act as the (R)AN.
\- As determined by BBF, NAS signalling is encapsulated in EAP-5G between
5G-RG and AGF.
NOTE 2: Further updates on the transport of NAS and EAP-5G during the
Registration procedure is to be handled as part of normative work based on
additional input from BBF.
De-Registration procedure:
\- The De-Registration procedure is based on the De-Registration procedure in
solution 3 clause 6.3.6.
Session Management:
\- The PDU Session Establishment Procedure via Wireline Access Network is
based on the 5G-RG Requested PDU Session Establishment procedure in solution 3
clause 6.3.3.
\- The PDU Session Modification Procedure via Wireline Access Network is based
on the UE or Network Requested PDU Session Modification procedure in solution
3 clause 6.3.4.
\- The PDU Session Release Procedure via Wireline Access Network is based the
UE Requested PDU Session Release procedure in solution 3 clause 6.3.5.
Connection Management and Registration Management:
\- The Connection Management is based on solution 5 in clause 6.5.
\- The Registration Management is based on solution 6 in clause 6.6.
Mobility Management:
\- For the scenario of 5G-RG connected only via W-5GAN (as shown in Figure
4.2.2.1-1 in Scenario 1) per solution 4 clause 6.4.2 the handover procedures
defined in TS 23.502 [3] clause 4.9 are not applicable, since the 5G-RG is
stationary and connected only via a wired network.
### 8.2.3 Conclusions on SUPI
The recommendations on SUPI definition in BBF SD-420 [26] clause 13.1.4 are
considered as conclusion. The SUPI definition in TS 23.501 [2] clause 5.9.2
applied with the following modification:
\- For 5G-RG:
\- the SUPI shall be based on IMSI defined in TS 23.003 [21] for
authentication and authorization.
\- For FN-RG:
\- FN-RG does not support IMSI.
\- the SUPI can be based on access specific identifier.
Editor\'s note: Whether the Line ID can be used as access specific identifier
as in candidate Solution #28 needs to be verified with BBF.
Editor\'s note: Whether SUPI can be based on IMSI and retrieved by AMF during
the registration procedure from the SUCI based on Line ID as described in
candidate Solution #28 needs to be verified with BBF and SA WG3.
\- The SUPI may contain an access specific identifier also for public networks
when accessed from W-5GAN.
\- The SUPI may be not in NAI format.
\- For 5G-CRG:
\- the SUPI shall be based on IMSI or non-IMSI based NAI as defined in TS
23.501 [2] for authentication and authorization.
\- For FN-CRG:
\- FN-CRG does not support IMSI.
\- SUPI can be based on access specific identifier. The access specific
identifier is in the form of HFC_Identifier, where the HFC_Identifier is a 32
character string. The identifier may contain a cable modem MAC address or an
overall HFC account identifier. This HFC_Identifier is unique within the
operating network (i.e, not necessary globally unique).
### 8.2.4 Other Conclusions
Solution #8 \" Support of IPTV leveraging IGMP / MLD\" as described in clause
6.8 is endorsed as a basis for normative specifications.
Solution #9 \"New IPV6 address allocation mechanisms\" as described in clause
6.9 is endorsed as a basis for normative specifications.
Editor\'s note: This solution would apply to Combo Ethernet PDU Session type
only if that PDU Session type is endorsed as part of the study.
Solution #16 \" Subscription control for the Support of a range of IP
address/Prefixes in a PDU Session \" as described in clause 6.16 is endorsed
as a basis for normative specifications.
For cable:
\- Supporting FN-CRG in 5GC based on solution #25 (clause 6.25) is endorsed.
\- Collocation of UPF and W-5GCAN User Plane Function based on solution #21
(clause 6.21) shall be possible, i.e, standard shall allow this possible
deployment option.
NOTE: During normative specification phase, solution to be specified for both
BBF and cable based network shall be aligned as much as possible.
For non NAS devices accessing 5GC via W-5GCAN, solution #30 (subclause 6.30)
is endorsed if SA3 accepts a primary authentication that is not based on EAP-
AKA\'.
For 5G QoS and cable aspects (see 6.31): 5G QoS framework can be reused for
converged architecture with cable AN as described in this TR. If there is
specific needs for additional value for cable wireline AN (e.g., 5QI value),
this can be considered based on CableLabs requests.
### 8.2.5 Conclusions on Hybrid Access
The conclusions regarding the support of Hybrid Access are described in this
clause.
Hybrid Access applies only to a 5G-RG capable of connecting to both NG RAN and
to W-5GAN, and to 5G-CRG capable of connecting to both NG RAN and to W-5GCAN.
The ATSSS solution concluded in TR 23.793 [4] (including ATSSS function and
MPTCP function) can be used by a 5G-RG/5G-CRG to support Hybrid Access in
scenario 3 (clause 4.2.2.3) with simultaneous PDU Session connectivity over
NG-RAN and W-5GAN/W-5GCAN and operator-controlled traffic steering.
Some Hybrid Access use cases can be supported using PDU session carried only
on a single access, either NG-RAN or W-5GAN, but that cannot be simultaneously
on both accesses. Such PDU Session can be handed over between NG-RAN and
W-5GAN using Rel-15 procedures.
NOTE: Scenarios for 5GC-Capable UE behind a 5G-RG/5G-CRG/FN-RG/FN-CRG
simultaneously connected to 5GC via the RG, e.g. via WLAN and W-5GAN, and via
NG-RAN are addressed by the ATSSS TR 23.793 [4] conclusions, for the aspects
related to MA-PDU support for traffic steering, splitting and switching.
### 8.2.6 Conclusions for key issue #13 (mobility restrictions)
NG-RAN access (FWA):
> To support mobility restriction based on RG/UE location when RG/UE connects
> over NG-RAN access, it is concluded that the Rel-15 solution for Service
> Area Restrictions and Forbidden Area can be re-used as is, with no updates
> due to this study.
>
> This means that the area definition is based on TAs and use cases where it
> is desired to restrict access for FWA to a small area such as a single
> household or single office building may not be supported (since TAs
> typically cover a larger area). Further work on features to support access
> restrictions with finer granularity will not be done in Rel-16 but may be
> done in a later release.
Wireline access and Hybrid access:
> To support mobility restriction based on RG/UE location when RG/UE connects
> over wireline access, it is concluded that the Rel-15 solution for Service
> Area Restrictions and Forbidden Area shall be extended to cover area
> definition based on Line Id(s). It is concluded that the type of location
> information in the Allowed Area, Non-Allowed Area and Forbidden Area IEs
> stored in UDM and provided to AMF is enhanced to support also Line ID(s).
>
> The interface between PCF and AMF is enhanced to handle Service Area
> Restrictions containing Line ID(s).
>
> AMF is enhanced to enforce Service Area restrictions and Forbidden Area
> based on Line ID when 5G-RG is using wireline access.
NOTE: Since Allowed Area and Non-Allowed Area is not provided to the UE/RG
when using wireline access, there is no impact to the NAS protocol.
### 8.2.7 Conclusions on QoS
The QoS conclusions and principles described in solution #29 in clause 6.29.3
and in solution #26 in clause 6.26 are the basis for the normative work.
NOTE: BBF feedback on solution has been requested and it will be considered
during normative work, if required.
### 8.2.8 Conclusions for key issue #9
Solution #11 \"Support 5GC-capable UEs via 5G-RG/FN-RG for wireline access
network using N3GPP solutions\" as described in clause 6.11 is endorsed as a
basis for normative specifications.
### 8.2.9 Conclusions for user plane optimisation
The parts of solution #13 in clause 6.23 that cover the monolithic FAGF
deployment will be used as basis for normative work for ensuring that the FAGF
can be co-located with UPF for a PDU session. This addresses KI#16, as well as
the \"support for co-located AGF and UPF\" as per BBF SD-420v3 [26].
If BBF defines split AGF-C/AGF-U and/or FMIF-C/FMIF-U architecture option(s),
the other parts of the solution #13 will be used for the normative phase as
well.
### 8.2.10 Conclusions on Key Issue #7
The following list summarizes the conclusions regarding the Key Issue #7 that
are applicable to both FWA and W-5GAN scenarios.
\- The solution for 5G-RG configuration and management will be based on
solution #20 as described in clause 6.20, including the following aspects and
the following modification based on BBF SD-420v3 [26]:
1) The configuration received from the Management Entity (ACS) and policy
received from the PCF are both needed for a 5G-RG.
2) The URSP rules are used as specified in TS 23.503, for example for the
association of application and PDU session, slices, etc. The NSWO indication
in the URSP and ANDSP rules are not applicable to 5G-RG The PCF should not
send ANDSP or NSWO policy to 5G-RG and the 5G-RG shall ignore any such
information if received from the PCF. The 5G-RG enforces the URSP rule as
defined in TS 23.503 [8] clause 6.1.2.2.1.
NOTE: In W-5GAN and NG RAN the traffic can ben not offload to a local network
since it is not available per deployment. Furthermore in this release the Wide
Area interface to which the 5G-RG can connect to is only NG RAN or W-5GAN.
3) The URSP may indicate for the application of Management Entity (ACS) which
PDU session type and/or DNN is to be used.
4) The Management Entity (ACS) information may be pre-configured in the 5G-RG,
or sent to the 5G-RG during the DHCP process or via PCO. The 5G-RG shall
consider the ACS information received with the following descending priority
order:
\- ACS information received during the DHCP process;
\- ACS information received during the PDU session establishment procedure
from SMF PCO;
\- The pre-configured ACS information in the 5G-RG.
5) The ACS information may be configured from the 3rd party AF to the 5GC.
6) The solution enables to use either TR-069 [12] or USP (TR-369 [48])
depending on the supported management specifications.
7) Management Entity (ACS) information may be received via the DHCP process as
specified in TR-069 Amendment 6 clause 3.1 part bullet 2 or as specified in
USP (TR-369 [48]) R-DIS.1 and R-DIS.2.
8) The SMF shall support the DHCP procedures for discovering the Management
Entity information defined in TR-069 Amendment 6 clause 3.1 or in USP BBF
TR-369 [48].
9) The TR-069 Amendment 6 or USP (TR-369 [48]) specification shall be extended
in order to consider the procedure based on PDU session for 5GC proposed in
the present TR and described in solution #20.
11) NAS and UE management (i.e URSP) are assumed to be responsible for
configuration of connectivity (e.g. NAS procedure and User plane) between the
5G-RG and the 5GC.
BBF will be responsible for the improvement of TR-069 [12], TR-369 [48] and
BBF TR-181 [49] data models.
### 8.2.11 Conclusions for supporting FN-RG connecting to 5GC
Solution #23 in clause 6.23 and solution #28 in clause 6.28 are endorsed as a
basis for normative work for the scenario of connecting legacy RG (FN-RG) to
the 5G core. These solutions address KI#2, as well as the scenarios
\"Integration in Adaptive Mode (FN-RG)\" and \"Interworking (FN-RG)\" as per
BBF SD-420v3 [26].
If required, the solution will be adjusted during the normative phase to meet
any additional security requirements defined by SA WG3.
### 8.2.12 Conclusions for the migration scenario from FN-RG to 5G-RG with AGF
It is proposed to consider the solution #24 in clause 6.24 as a basis for
normative work for the scenario of migration from FN-RG to 5G-RG for the
scenario of AGF called \"Integration in Adaptive Mode (FN-RG)\" and
\"Integration in Direct Mode and scenario\" according to BBF SD-420v3 [26].
The solution may be further revised during normative phase based on the
information and specification of issues under BBF responsibility, if needed.
### 8.2.13 Conclusions for the scenario that 5G-CRG connected via W-5GCAN
Regarding the architecture that 5G-CRG connected via W-5GCAN shown in Figure
4.2.2.7-1, interim conclusions are listed as below:
NAS transmission after registration:
\- A signalling connection based on protocol CFCP between 5G-CRG and CFAGF
should be established to transmit the NAS message and associated info e.g.,
NSSAI.
\- \"Cable Fixed Access Control Protocol\" (CFCP) is the control protocol
stack used between 5G-CRG and CFAGF within the W-5GCAN. CFCP is used to
establish the link, transport AS and NAS parameters, create sessions, etc.
\- Details about CFCP the signalling connection should be specified in
CableLabs.
NOTE: the definition of CFCP signalling connection is within CableLabs scope.
From SA2 perspective, CFCP is capable to transport NAS messages between 5G-CRG
and CFAGF.
# 9 Evaluations
## 9.1 Evaluation for key issue #13
There are two solutions addressing KI#13: Solutions #14 and #18. The solutions
are evaluated according to the following criteria:
\- Type of restriction.
\- Granularity of area.
\- Fulfilment of use cases, i.e. to restrict usage to a house or an office.
\- (R)AN impacts.
\- 5GC impacts.
\- Solution maturity / Open issues.
Table 9.1-Evaluation of solution for KI #13
+-------------+-------------+-------------+-------------+-------------+ | Criteria / | Solution | Solution | Comment | | | Solution | #14: | #18: | | | | | \"R | \"Mobility | | | | | egistration | R | | | | | restriction | estrictions | | | | | support\" | to support | | | | | | W-5GAN use | | | | | | cases\" | | | +-------------+-------------+-------------+-------------+-------------+ | Type of | R | As per | | | | restriction | egistration | Rel-15, | | | | | | i.e. either | | | | | | service | | | | | | level | | | | | | restriction | | | | | | (Service | | | | | | Area | | | | | | R | | | | | | estriction) | | | | | | or | | | | | | r | | | | | | egistration | | | | | | (Forbidden | | | | | | Area) | | | +-------------+-------------+-------------+-------------+-------------+ | When RG is | Granularity | Can | Can | | | connected | of | restrict to | restrict to | | | via NG-RAN | restriction | one or | one or | | | access | in case of | multiple | multiple | | | | NG-RAN | cells. | TAs. | | | | access | Extension | Extension | | | | | of area | of area | | | | | depends on | depends on | | | | | cell size. | number of | | | | | Typically | cells in TA | | | | | ranges from | and cell | | | | | 100 m to | size. | | | | | several | Typically | | | | | kilometres | ranges from | | | | | | 500 m to | | | | | | several | | | | | | kilometres | | +-------------+-------------+-------------+-------------+-------------+ | | Fulfilment | No. Not | No. Not | Neither | | | of use | possible to | possible to | solution | | | cases, i.e. | restrict to | restrict to | fulfils the | | | to restrict | specific | specific | intended | | | usage to a | houses or | houses or | use case | | | house or an | offices | offices | | | | office | unless | unless TAs | | | | | cells are | are very | | | | | very small | small and | | | | | and | house/offi | | | | | house/offi | ce/property | | | | | ce/property | size is | | | | | size is | very big | | | | | very big | | | +-------------+-------------+-------------+-------------+-------------+ | | NG-RAN | RAN need to | Update to | RAN impacts | | | impacts | support | existing | for sol | | | | Handover | Handover | #14 has | | | | Restriction | Restriction | not been | | | | List on | List to | studied by | | | | cell level | allow a | RAN. May | | | | g | \"white | also impact | | | | ranularity. | list\" IE | handling of | | | | | for | RAN areas | | | | | forbidden | in case of | | | | | TAs in | RRC | | | | | addition to | INACTIVE | | | | | TA \"black | | | | | | list\". | | +-------------+-------------+-------------+-------------+-------------+ | | 5GC impacts | New area | No impacts | | | | | restriction | for SAR. | | | | | concept in | Extension | | | | | UDM, AMF | to TA | | | | | | \"white | | | | | | list\" in | | | | | | addition to | | | | | | TA \"black | | | | | | list\" for | | | | | | forbidden | | | | | | area | | +-------------+-------------+-------------+-------------+-------------+ | | O&M impacts | Need to | Need to | | | | | maintain | maintain | | | | | up-to-date | up-to-date | | | | | mapping | mapping | | | | | between | between | | | | | Cell IDs | TAIs and | | | | | and | g | | | | | g | eographical | | | | | eographical | location. | | | | | location. | Should be | | | | | This may be | less effort | | | | | significant | than | | | | | work since | sol#14 | | | | | cell | since TA | | | | | planning | coverage is | | | | | can | more static | | | | | frequently | | | | | | change as | | | | | | cells are | | | | | | added/rem | | | | | | oved/moved. | | | | | | It e.g. | | | | | | requires | | | | | | impacted RG | | | | | | su | | | | | | bscriptions | | | | | | in UDM to | | | | | | be | | | | | | identified | | | | | | when a new | | | | | | cell is | | | | | | deployed. | | | | | | There is | | | | | | also a | | | | | | large risk | | | | | | for | | | | | | incorrect | | | | | | service | | | | | | denials in | | | | | | case | | | | | | s | | | | | | ubscription | | | | | | data is not | | | | | | fully up to | | | | | | date at all | | | | | | times, e.g. | | | | | | when a new | | | | | | cell is | | | | | | deployed. | | | +-------------+-------------+-------------+-------------+-------------+ | When RG is | Granularity | Line | Line | | | connected | of | | | | | via | restriction | | | | | wireline | in case of | | | | | access | wireline | | | | | | access | | | | +-------------+-------------+-------------+-------------+-------------+ | | Fulfilment | Yes, | Yes, | | | | of use | possible to | possible to | | | | cases, i.e. | restrict to | restrict to | | | | to restrict | single | single | | | | usage to a | house | house | | | | house or an | hold/office | hold/office | | | | office | per Line ID | per Line ID | | +-------------+-------------+-------------+-------------+-------------+ | | Wireline | None | None | | | | access | | | | | | impacts | | | | +-------------+-------------+-------------+-------------+-------------+ | | 5GC impacts | New area | Extension | | | | | restriction | of existing | | | | | concept in | mobility | | | | | UDM, AMF | restriction | | | | | | solutions | | | | | | by | | | | | | supporting | | | | | | SAR and FA | | | | | | based on | | | | | | Line ID. | | +-------------+-------------+-------------+-------------+-------------+ | | O&M impacts | Need to | Need to | | | | | maintain | maintain | | | | | mapping | mapping | | | | | between | between | | | | | Line ID and | Line ID and | | | | | home/office | home/office | | +-------------+-------------+-------------+-------------+-------------+ | | Open issues | - NG-RAN | No open | | | | | aspects, | issues | | | | | e.g. how | | | | | | Ran handles | | | | | | cell-based | | | | | | HR? | | | | | | | | | | | | - How does | | | | | | AMF and UE | | | | | | handle | | | | | | R | | | | | | egistration | | | | | | Area if not | | | | | | all cells | | | | | | in the RA | | | | | | is allowed? | | | +-------------+-------------+-------------+-------------+-------------+
#