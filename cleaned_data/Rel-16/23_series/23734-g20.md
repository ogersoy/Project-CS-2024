# Foreword
This Technical Report has been produced by the 3^rd^ Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The objective and scope of this TR is to study enhancements to 5GS that are
required to fulfil Stage-1 service requirements in vertical domains defined in
TS 22.261 [2] and TS 22.104 [13]:
\- Enablers (e.g. time synchronization of packet delivery in each hop) to
support Time Sensitive Networking, and industrial control use cases specified
by Stage 1.
\- Architecture enhancements required to support security requirements.
NOTE 1: Security aspects will be studied in cooperation with SA WG3.
\- Enhancements to the 5G system to support 5GLAN service.
\- Enhancements to service exposure via APIs for 3rd party use of
functionalities e.g. for information regarding the geographic location of
coverage area of non-public network;
\- Enablers to support new KPIs (e.g. 5QI) to meet service requirements of
vertical;
\- Support for non-public networks:
\- Support for UEs being registered in non-public network and a PLMN when the
UE supports credentials required for non-public network and credentials
required for a PLMN and is able to maintain both registrations independently.
\- Support for roaming, mobility and service continuity between PLMN and non-
public networks (e.g. for mobility from non-public networks to PLMN) with
direct interaction between non-publicnetworks and PLMN.
NOTE 2: While support for stand-alone operation of non-public network and
interworking between PLMN and non-public networks is one of the objectives of
the study, there is no assumption that either are required in all deployment
scenarios.
NOTE 3: The objectives are subject to alignment with the corresponding
normative work of TS 22.261 [2] and TS 22.104 [13] that is still ongoing in SA
WG1.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or nonâ€‘specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets\".
[3] 3GPP TS 23.501: \"System Architecture for the 5G System\".
[4] 3GPP TS 23.502: \"Procedures for the 5G System\".
[5] 3GPP TS 23.503: \"Policy and Charging Control Framework for the 5G
System\".
[6] 3GPP TR 22.804: \"Study on Communication for Automation in Vertical
domains (CAV)\".
[7] 3GPP TR 22.821: \"Feasibility Study on LAN Support in 5G\".
[8] 3GPP TS 38.304: \"User Equipment (UE) procedures in Idle mode and RRC
Inactive state\".
[9] IEEE P802.1Qcc/D1.6: \"Draft Standard for Local and metropolitan area
networks - Bridges and Bridged Networks - Amendment: Stream Reservation
Protocol (SRP) Enhancements and Performance Improvements\".
[10] 3GPP TS 29.561: \"5G System; Interworking between 5G Network and external
Data Networks; Stage 3\".
[11] 3GPP TS 33.501: \"Security architecture and procedures for 5G system\".
[12] IEEE P802.1Qcc: \"Standard for Local and Metropolitan Area Networks-Media
Access Control (MAC) Bridges and Virtual Bridged Local Area Networks
Amendment: Stream Reservation Protocol (SRP)\".
[13] 3GPP TS 22.104: \"Service requirements for cyber-physical control
applications in vertical domains\".
[14] International Telecommunication Union (ITU), Standardization Bureau
(TSB): \"Operational Bulletin No. 1156.\";
http://handle.itu.int/11.1002/pub/810cad63-en (retrieved October 5, 2018).
[15] 3GPP TS 23.122: \"Non-Access-Stratum (NAS) functions related to Mobile
Station (MS) in idle mode\".
[16] 3GPP TS 29.244: \"Interface between the Control Plane and the User Plane
nodes\".
[17] 3GPP TS 23.682: \"Architecture enhancements to facilitate communications
with packet data networks and applications\".
[18] 3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".
[19] 3GPP TR 23.724: \"Study on Cellular Internet of Things (CIoT) support and
evolution for the 5G System (5GS)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] and the following apply. A term defined in the present document
takes precedence over the definition of the same term, if any, in TR 21.905
[1].
**5GLAN group** : a set of UEs using private communication for 5G LAN-type
service.
**5G LAN-type service** : a service over the 5G system offering private
communication using IP and/or non-IP type communications.
**5G LAN-virtual network** : a virtual network capable of supporting 5G LAN-
type service.
**5GLAN one to one communication** : communication between two UEs in a 5GLAN
group.
**5GLAN one to many communication:** communication between one UE and many UEs
in a 5GLAN group.
**IEEE Time Sensitive Networking (TSN):** a set of standards to define
mechanisms for the time-sensitive (i.e. deterministic) transmission of data
over Ethernet networks under development by the Time-Sensitive Networking task
group of the IEEE 802.1 working group.
**private communication** : a communication between two or more UEs belonging
to a restricted set of UEs.
**Time Sensitive Communication (TSC):** a communication service that supports
deterministic communication and/or isochronous communication with high
reliability and availability. It is about providing packet transport with
bounds on latency, loss, packet delay variation (jitter), and reliability,
where end systems and relay/transmit nodes can be strictly synchronized.
**Non-public network:** a network that is intended for non-public use.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
VLAN Virtual LAN
C-tag **Customer VLAN tag**
S-tag Service VLAN tag
# 4 Architecture Assumptions
Following are the architectural assumptions for this study item:
1) This study is assumed to inherit the exposure framework as defined in
Rel-15 for 5G System. It is also assumed that each Key issue identified for
this study item determines the need for capabilities and events (as needed)
that will be exposed.
2) This study is assumed that the 5G LAN-type service is provided to UE
connecting to 5G system.
# 5 Key Issues
## 5.1 Key Issue #1: Network discovery, selection and access control for non-
public networks
### 5.1.1 General description
This key issue aims at studying network discovery, selection and access
control for non-public networks. Solutions to this key issue are expected to
address the following aspects:
\- Non-public network subscriptions.
\- How is information identifying a non-public network provided to the UE for
network discovery and selection?
\- Which criteria are used by the UE for automatic selection of non-public
networks.
\- How to support manual selection of non-public networks.
\- How to prevent UEs not authorized for a given non-public network from
attempting to automatically select and register in that non-public network?
How to enable the network to verify whether a UE is authorized to access a
non-public network?
\- Which network entities perform access control for non-public networks?
\- Access barring aspects for non-public networks.
\- Where access restrictions are configured (e.g. subscription or
configuration)?
\- How to enable UEs to access non-public networks but prevent the same UEs
from accessing public PLMNs?
\- How to prevent UEs not supporting non-public networks from attempting to
access type-a and type-b networks?
\- How to prevent NG-RAN from handing over a UE to a non-public network if the
UE is not permitted to access the non-public network?
## 5.2 Key Issue #2: Network Identification for non-public networks
### 5.2.1 General description
This key issue aims at studying network identification for non-public
networks.
Solutions to this key issue are expected to address the following aspects:
\- What are the information elements included in the network identification
and what is the granularity of each information, e.g. network operator
identifier, type of the network, location information?
\- What are the assumption on the uniqueness of the network identification?
\- Whether and how is the network identification related to the UE
identification.
## 5.3 Key issue #3: Enablers to support Time Sensitive Networking (TSN)
### 5.3.1 Key issue #3.1: System Enhancements to support Time Sensitive
Networking (TSN)
#### 5.3.1.1 Description
The objective of this Key Issue is to introduce support for Time Sensitive
Networking in 5G System. With starting point in TR 22.804 [6] and TS 22.261
[2], further clarify reference scenarios (i.e. at the architectural level) for
5G System support for TSN, including functional as well as performance
requirements related to TSN use-cases (e.g. user plane jitter versus
synchronization requirements).
Editor\'s note: definition for TSN is FFS.
The open issues for this key issue in order to support TSN are as follows:
\- What are the architecture assumptions and principles for supporting TSN in
5G System?
\- What are the necessary enhancements to QoS (e.g. new 5QI), policy framework
to support TSN?
\- What are the necessary enhancements to 3GPP network to support scheduling
requirements between UE(s) and application for wireless TSN deployment (e.g.
coordination and synchronization of scheduling across multiple cells, multiple
gNBs for multiple UE(s) etc.) in the 5G System for TSN support?
\- What are the impact on 5G System when TSN support is introduced due to
mobility and determine to what extent TSN can be supported when there is
mobility?
\- How and whether interworking and co-existence can be supported with
existing TSN deployments should be identified?
\- It needs to be studied whether and how work done in other SDOs (e.g. IEEE,
IETF) can be leveraged for support of TSN in 5G System e.g. scheduling of
traffic (IEEE 802.1Qbv).
NOTE: Items that are not specific to TSN are in the scope of FS_5G_URLLC. For
instance, system enhancements to increase reliability (e.g. by potentially
enabling support for IEEE 802.1CB) and to reduce handover related Jitter is in
the scope of FS_5G_URLLC.
\- If gNB is becoming part of TSN subnet and it needs to support requirements
to perform resource reservation using SRP (in IEEE 802.1Qat), centralised
Network Configuration (in IEEE 802.1Qcc [12]) and support time-aware
scheduling (in IEEE 802.1Qbv)?
Editor\'s note: Before proceeding with solutions requiring TSN support inside
the 5G System network functions the following, needs to be checked: Whether
delay Tolerance, Packet Loss and jitter requirements defined in TR 22.804 [6]
and in current industrial networks are accomplished by TSN can be fulfilled by
5G System existing QoS architecture e.g. by adding new parameters but without
full integration of TSN inside the 5G System. Depending on the answer
appropriate architecture for \"adaptation\" or \"integration\" with TSN will
be considered.
### 5.3.2 Key issue #3.2: Time synchronization aspect
#### 5.3.2.1 Description
TR 22.821 [7] describes a use case for factory automation in clause 5.17 and
corresponding performance requirement in clause 5.21.
Factory Automation applications have stringent requirements on latency, jitter
and error rate. Among these requirements, time synchronization is the pre-
condition to achieve deterministic packet delivery.
Besides that, time synchronization is also used for other use cases such as
defined in TR 22.804 [6], clause 5.6.5, Smart Grid: synchronicity between the
entities.
This key issue is to study:
\- How the 5G system achieves time synchronization for the devices connected
to the 3GPP network, to meet the requirement defined by SA WG1.
\- How the 5G system achieves time synchronization between the devices
connected to the 3GPP network and external time-sensitive network to meet the
requirement defined by SA WG1.
\- Can it be assumed that all UEs connected to the 5G system need to be
synchronized to the same time source?
\- What is the complexity of supporting 802.1AS operation via the transport of
802.1AS messages over the 5G system (analysis requires work in RAN WGs also)?
\- What is the complexity of signalling precise timing to the UE via 5G air
interface signalling (analysis primarily requires work in RAN WGs)?
## 5.4 Key Issue #4: Support of 5G LAN-type service
### 5.4.1 Key Issue #4.1: 5GLAN Group Management
#### 5.4.1.1 Description
According to TR 22.821 [7], use cases are defined for 5G LAN-type service. For
example, in the enterprise environment, equipment like smartphone, laptop may
communicate with each other within a 5GLAN Group. The 5GLAN Group may be
dynamically created by an operator or possibly requested by Application
Function via service exposure.
Editor\'s note: The architectural requirements requires further clarifications
based on stage 1 normative requirements regarding to the definitions and
relationship between 5GLAN Group and 5GLAN-type service including
clarification of if the 5GLAN Group applies to the UEs or Users and whether
group aspects are required on application level or/and 5G system level.
This key issue 4.1 is to study:
\- What is the system architecture and procedure supporting service exposure
for creation and management of a 5GLAN Group?
\- How the 5G system create a 5GLAN Group for private communication;
\- How the 5G system identify a 5GLAN Group for private communication;
\- How the UE is added into a 5GLAN Group, e.g. based on the request from an
Application Function, including the authentication and authorization of UE to
join a 5GLAN Group;
\- How the 5G system remove a UE from a 5GLAN Group, e.g. based on the request
from an Application Function;
> \- How the 5G system remove a 5GLAN Group.
### 5.4.2 Key Issue #4.2: Service Discovery, Selection, and Restrictions
#### 5.4.2.1 General description
The 5GLAN type services can span over wide area mobile network. This key issue
aims at studying the mechanism in 5GS to enable the support for a UE to
discover and select 5GLAN services and the mechanism for the 5GS to configure
service restriction, e.g. based on location of a UE group membership, for a
particular 5GLAN service.
The following open issues need to be studied:
\- How to identify a 5GLAN service?
\- Whether and how the 5GS network provide the required information to a UE
and what the required information to support 5GLAN service discovery?
\- What is the procedure and criteria for a UE to perform 5GLAN service
discovery and selection?
\- What is the granularity of 5GLAN service restriction, e.g. per UE, per
5GLAN group, per UE\'s location information, or other information and
combination of such information?
\- How does the 5GS network configure and enforce service restriction for a UE
from 5GLAN?
\- Whether and how does the 5GS network enforce respective service
restrictions on a UE using multiple 5GLAN services without conflicts?
## 5.5 Key Issue #5: Support of 5GLAN communication
### 5.5.1 Description
TR 22.821 [7] describes use cases and potential requirements for 5GLAN
service, TS 22.261 [2] describes normative requirements to support the
Ethernet transport services of 5GLAN.
This key issue aims to provide solutions to support efficient 5GLAN
communication, including IP-type 5GLAN communication and Ethernet-type 5GLAN
communication, between two or more UEs within a 5GLAN group.
The following points should be studied:
\- How to authorize a UE for 5GLAN communication.
\- How to support service exposure function for AF managing 5GLAN
communications.
\- How to support the one to one or one to many data communication for 5GLAN
communication service within a single 5GLAN group, the procedure to establish,
modify, and release the one to one and one to many 5GLAN communication.
\- How to know the UE reachability status for 5GLAN communication.
\- How to keep the service continuity for 5GLAN communication due to UE
mobility within the same PLMN.
\- How to address the UE within the 5GLAN group for 5GLAN communication.
\- How to ensure isolation of 5GLAN communication between 5GLAN groups.
\- How to secure the 5GLAN one to one and one to many communication.
\- For a UE, how to enable simultaneous 5GLAN communication with multiple
groups.
Specifically, for Ethernet-type 5GLAN communication, following aspects are for
study:
\- How to support the Ethernet transport service of the 5GLAN group over wide
area mobile network.
\- How to route the Ethernet frames efficiently between UEs within a 5GLAN
group.
\- How to support the communication between Ethernet type 5GLAN and Ethernet
network in data network.
## 5.6 Key issue #6: Accessing PLMN services via non-public networks and vice
versa
### 5.6.1 Description
Non-public networks are restricted for use by authorized subscribers only. It
is not available for public use. However, UE can be authorized to use both a
Public PLMN and non-public networks in which case, it should be studied how
the UE can obtain service continuity for services offered by Public PLMN via
non-public network and vice versa.
The open issues for this key issue are as follows:
\- Study System architecture aspects to support service continuity between
Public PLMN and non-public network. How to enable the 5G system to provide:
\- access to Public PLMN offered services (e.g. voice services) while
accessing non-public network;
\- service continuity for PLMN offered services (e.g. voice services) between
a non-public and a Public PLMN;
\- access to selected non-public network offered services while accessing
Public PLMN;
\- service continuity for non-public network offered services between a non-
public network and a Public PLMN.
Note 1: It is assumed that the UE requires the credential needed for Public
PLMN in order to access and obtain Public PLMN offered services. Similarly, it
is assumed that the UE requires the credential needed for non-public network
in order to access and obtain non-public offered services.
How to support the following?
\- Ability for UE to remain registered in both a PLMN (using the credential
needed for Public PLMN) and a non-public network (using the credential needed
for non-public network) when NR is deployed in both the PLMN and the non-
public network.
# 6 Solutions
## 6.1 Solution #1: Identification, selection and access control for non-
public networks
### 6.1.1 Description
The solution addresses key issue #1 (\"Network discovery, selection and access
control for non-public networks\") and key issue #2 (\"Network Identification
for non-public networks\").
The solution supports the following network types:
\- stand-alone non-public networks (i.e. networks that are not relying on
network functions of a public PLMN)
The solution is based on the following principles:
\- Identities
\- A Non-public network ID (NPN-ID) identifies a non-public network. The NPN-
ID supports two assignment models
\- Locally managed NPN-IDs are assumed to be chosen randomly at deployment
time to avoid collisions (and may therefore not be unique in all scenarios)
\- Universally managed NPN-ID are managed by a central entity are therefore
assumed to be unique.
NOTE 1: Which legal entity manages the number space is out of scope of 3GPP.
\- A human-readable network name identifies a non-public network. The human-
readable name may be unique.
\- The following information is broadcasted in SIB by gNBs providing access to
a non-public network:
\- PLMN ID consisting of MCC 999 (assigned by ITU for private networks [14])
and an MNC defined by 3GPP to identify the cell as part of a non-public
network.
NOTE 2: Which MNC to use for non-public networks is up to Stage 3 to define.
Whether the full PLMN ID identifying non-public networks needs to be
broadcasted or whether this can be further optimized in SIB is up to RAN2 and
CT1 to decide.
Editor\'s note: Whether other regional PLMN IDs assigned for non-public
networks can be used is FFS.
\- cellReservedForOtherUse indication (to prevent non supporting UEs from
accessing the cell; see also TS 38.304 [8]). UEs that support non-public
networks consider a cell that broadcasts both the cellReservedForOtherUse and
the non-public network indication as not barred.
\- List of NPN-IDs identifying the non-public networks the cell provides
access to
\- (Optional) Human-readable network name (per NPN-ID)
\- Network and cell selection
\- UE performs network selection between gNBs broadcasting different NPN-IDs
\- UE performs cell (re-)selection between gNBs broadcasting the same NPN-ID
\- A UE shall only automatically select and attempt to register with a non-
public network the UE has a subscriber identifier and credentials for. If
multiple non-public networks are available that the UE has subscriber
identifier and credentials for, then the priority order for selecting and
attempting to register with non-public networks is based on UE implementation.
NOTE 3: Further details of automatic network selection are up to CT1 to
define.
\- For manual selection the UE presents the list of NPN-IDs and related human-
readable names (if available) of the available non-public networks.
\- Subscription
\- Subscriptions to a non-public network are stored in the non-public
network\'s UDM.
\- A subscriber of a non-public network is identified based on a NAI. The
realm part of the NAI includes the NPN-ID of the non-public network.
\- UE can be configured with subscriber identifiers and credentials for
multiple non-public networks.
Editor\'s note: The syntax of the username part of the non-IMSI-based NAI is
FFS. Whether the non-public networks a UE can access can be changed by PCF is
FFS.
### 6.1.2 Procedures
NOTE: NPN-ID may need to be added in existing procedures where currently only
PLMN ID is signaled. This will be analyzed and decided on a case by case basis
during the normative phase.
### 6.1.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.1.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.2 Solution 2: Closed Access Group
### 6.2.1 Description
The solution addresses key issue #1 (\"Network discovery, selection and access
control for non-public networks\") and key issue #2 (\"Network Identification
for non-public networks\").
The solution supports the following network types:
\- non-stand-alone non-public networks (i.e. non-public networks that are
deployed as part of a PLMN)
The solution is based on the following principles:
\- Identities:
\- A Closed Access Group (CAG) ID uniquely identifies a closed access group
(CAG) in a PLMN.
\- A human-readable network name identifies the CAG. The human-readable name
may be unique.
\- The following information is broadcasted in SIB for a PLMN that supports a
CAG:
\- CAG indication identifying the cell as a Closed Access Group cell.
\- cellReservedForOtherUse indication (to prevent non-supporting UEs from
accessing the cell; see also TS 38.304 [8]). UEs that support non-public
networks consider a cell that broadcasts both the cellReservedForOtherUse and
the CAG indication as not barred.
\- CAG ID.
\- (Optional) Human-readable network name.
\- Network and cell selection
\- UE maintains a white list of CAG IDs
\- UE configured to only access CAG cells are not allowed to register via non-
CAG cells of any PLMN.
\- UE shall only automatically select and attempt to register via a CAG cell
whose identity is contained in the white list.
\- For manual CAG selection the UE presents the list of available CAG IDs and
related human-readable names (if available). If a UE has successfully
registered to a CAG which was not listed in the white list yet, the CAG ID is
added to the CAG white list.
\- Subscription
\- Subscription contains the list of CAGs the UE is entitled to access
\- Subscription contains indication whether the UE is only allowed to access
CAG cells (UE is also configured accordingly); this is to address factory
devices that are supposed to remain on the CAG cells
### 6.2.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
### 6.2.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.2.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.3 Solution #3: Non-public network identification, selection and access
control
### 6.3.1 Description
The solution addresses key issue #1 (\"Network discovery, selection and access
control for non-public networks networks\") and key issue #2 (\"Network
Identification for non-public networks\").
#### 6.3.1.1 Network Identification
The network is identified with a non-public network identifier (NPN ID)
advertised in the broadcast channels of a non-public network cell. A non-
public network may support services provided by one or more Service Providers
(SP), which can include MNOs, or 3rd party service provider.
Figure 6.3.1.1-1: Example of non-public to UE#A/UE#B/UE#C
As shown in figure 6.3.1.1-1, UE#A and UE#B are registered to the non-public
network (NPN) identified by a Non-public network ID (NPN-ID).
\- Service provider represented by SP #1, which is a PLMN, provides the
authorized service for UE #A.
\- Service provider represented by SP#N, which is 3^rd^ party service
provider, provides the authorized service for UE#B.
The UE has a subscription with one or multiple Service Providers, each of
which is identified with an SP ID. For UE, which has subscription with service
provider (SP) that is a PLMN, the UE subscription data and authentication
credentials are stored at the UDM/AUSF of the service provider.
For non-public network identification, this solution proposes the following
principles:
\- The network identification of non-public network is given by NPN ID.
\- The SP-ID which is the identifier for the service provider, may be
advertised by the non-public network cell in the system information; however,
this is not a pre-requisite for network selection. A given non-public network
identified by NPN ID may support multiple SP-ID. For the service provider,
which is a PLMN, SP-ID will be PLMN-ID. For the service provider, which is not
a PLMN, SP-ID could be the domain name and selection procedure may be based on
domain name.
\- The UE has subscription with one or more service providers. In case of
multiple SPs, the user first selects the SP whose services it wishes to use.
How the user selects the SP is considered out of scope of 3GPP.
\- The RAN node in the non-public network shall broadcast the following
information:
\- non-public network indicator: The indicator may be, for example:
> \- a new non-public network indicator; or
>
> \- PLMN-MCC=999 to inhibit \'public UEs\' to access the non-public network;
> or
>
> \- cellReservedForOtherUse indication: existing bit in SIB. It is up to RAN
> WG2 and CT WG1 to decide whether this or any other indicator is the best to
> inhibit legacy UEs from accessing the non-public network.
\- NPN-ID.
\- (Optional) Supported SP-IDs list.
NOTE: The broadcast of SP-ID list by RAN node is optional when the UE is
configured with the \"Equivalent Home Network\" list or the \"Operator
Controlled Network Selector with Access Technology\" list. In this case, the
network selection is driven by the \"Equivalent Home Network\" list or the
\"Operator Controlled Network Selector with Access Technology\" list
configured in the UE.
\- The UE shall be configured with the following information:
\- at least one SP-IDs for the service provider that owns the UE subscription.
\- NPN ID or list of NPN-IDs for the NPNs that can provide the UE with the
access to the SP that owns the UE subscription.
\- Authentication parameters including credential, authentication method of
the configured SP-ID.
> For each subscription to an SP, the UE is configured with an \"Equivalent
> Home Network\" list, which is modelled based on the EHPLMN list defined in
> TS 23.122 [15]. This list can includes both NPN-IDs and the SP-ID that are
> ranked in priority order. An \"Equivalent Home Network\" list in the UE is
> configured for each subscription in the case where the UE has subscription
> with more than one service providers. Alternatively, the UE may be
> configured with an \"Operator Controlled Network Selector with Access
> Technology\" list, which is modelled based on the Operator Controlled PLMN
> Selector with Access Technology list defined in TS 23.122 [15].
#### 6.3.1.2 Network Discovery and Selection
For a UE configured with non-public network profile, it is important that non-
public network discovery and selection is compatible with existing PLMN
selection procedure as in TS 23.122 [15]/TS 38.304 [8]:
> _When a UE is switched on, a public land mobile network (PLMN) is selected
> by NAS. On request of the NAS, the AS shall perform a search for available
> PLMNs with CN type if available for each PLMN and report them to NAS._
**For Key issue#2, this solution proposes the following principles:**
\- In the PLMN selection procedure, a non-public network indicator (NID) is
used as an indication to differentiate between the PLMN and non-public
network:
\- The RAN node in non-public network needs to broadcast the non-public
network indicator along with other supported PLMNs, if available, in the
system information. The non-public network indicator can be either a new
indicator broadcast in SIB or a reserved globally unique PLMN ID.
Editor\'s note: The information broadcast by the RAN node for non-public
network has RAN dependency and needs alignment with the RAN working group.
\- For the UE configured with non-public network profile information (as
defined in clause 6.3.1.1), when it detects the non-public network indicator,
it continues with non-public network Discovery and Selection procedure.
\- For the non-public network selection procedure, the UE goes through the
\"Equivalent Home Network\" list or \"Operator Controlled Network Selector
with Access technology\" list in priority order until it finds a suitable cell
(in the sense of TS 23.122 [15] and TS 38.304 [8]) that matches the NPN-ID
advertised in a particular location.
#### 6.3.1.3 Access Control
The access class information may be stored in USIM or a part of the
configuration of the non-public network Profile, the UE shall be also
configured with the access class information corresponding to the configured
SP-ID.
For the access control of the non-public network, the solution is based on the
following principles:
RAN node may broadcast access class barring information for the UEs allowed to
access the non-public network.
\- The UE(s) determines if it is allowed to access a non-public network based
on the configured access class per NPN-ID in the non-public network profile.
### 6.3.2 Procedures
The UE is configured with a non-public network Profile with the following
parameters:
\- at least one SP-ID for the service provider that owns the subscription, If
the user has subscription with multiple SPs, the UE has a separate
configuration for each of the SP-IDs.
\- For each subscribed SP-ID the UE is configured with an \"Equivalent Home
Network\" list or \"Operator Controlled Network Selector with Access
Technology\" list.
\- Authentication parameters including credential, authentication method of
the configured SP-ID.
For the non-public network discovery and selection the following principles
apply:
\- UE has subscription with a service provider identified by its SP-ID (For
example - identified as SP#X).
\- SP#X has an agreement with non-public network that is identified by its
NPN-ID (For example - identified as NPN#A), allowing the UEs that have
subscription with SP#X to access the services of SP#X via NPN#A.
\- The UE has a stored \"Equivalent Home Network\" list or \"Operator
Controlled Network Selector with Access Technology\" list that contains both
SP#X and NPN#A.
\- The radio access network of NPN#A broadcasts its own ID i.e., NPN#A.
Additionally, it may broadcast the SP-IDs of the supported service providers
to which it provides access.
\- The UE, which has subscription with SP #X selects NPN #A since NPN #A, is
configured in UE\'s \"Equivalent Home Network\" list or \"Operator Controlled
Network Selector with Access Technology\" list.
\- Once the network selection is complete, the UE registers with the network
by providing the UE identity and credential corresponding to the SP-ID. It is
assumed that the authentication request is routed to a subscriber database
residing in the SP\'s administrative domain. When the service provider is a
PLMN, the subscriber database can correspond to a UDM.
### 6.3.3 Impacts on Existing Nodes and Functionality
\- The RAN node in the non-public network shall broadcast the following
information:
\- Non-public network indication.
\- NPN ID.
\- (Optional) Supported SP-IDs list.
\- The UE shall be configured with the following information:
\- Subscription parameters for at least one SP-ID for the service provider
that owns the subscription.
\- Authentication parameters including credential, authentication method of
the configured SP-ID.
\- NPN-ID or list of NPN-IDs for the NPNs that can provide the UE with access
to the SP that owns the UE subscription.
### 6.3.4 Solution Evaluation
The principles described in Solution #3 addresses the Key Issue #1 and Key
Issue #2 for non-public network identification, discovery and selection.
Solution#3 allows for more deployment flexibility by having separate network
provider and service provider.
Solution #1 is subsumed under Solution #3 by having a single NPN-ID in the
\"Equivalent Home Network\" list and setting NPN-ID equal to SP-ID.
## 6.4 Solution #4: Identification for non-public network
### 6.4.1 Description
To address the key issue #2 (\"Network Identification for non-public
networks\"), the solution is based on the following principles:
\- A non-public network is uniquely identified by the combination of a PLMN ID
and a non-public network ID.
\- For a non-public network isolated from a PLMN (i.e., standalone non-public
network), a reserved dedicated PLMN ID, which is assigned globally (e.g.,
MCC=999 and MNC=3GPP specified value) or within a country (e.g., special MCC
and MNC values specified by a local regulatory) is used.
For a non-public network deployed as part of a PLMN, the PLMN ID of the PLMN
operator is used.
A non-public network ID may be managed by the local regulation or assigned in
un-managed manner by individual network operators, per policy of the local
regulation in a given region.
To address the key issue #1 (\"Network discovery & selection and access for
non-public networks\"), the solution is based on the following principles:
\- NG-RAN nodes supporting access to non-public networks broadcast in SIB one
or more tuples of PLMN ID and NPN ID to indicate to UEs the non-public
networks they support.
\- In automatic network selection mode when a UE discovers available networks,
the UE would select the highest priority available network out of the
preferred network selection list, which indicates the preference on UE\'s
network selection among public networks and non-public networks, which RAT
type can be considered together. How to define or use the preferred network
selection list will be decided by CT1 WG.
\- The UEs have subscription for a non-public network are authorized to
register with non-public network. The UEs are configured with their UE
identity (e.g. SUPI, or NAI) and credentials for the subscribed non-public
networks.
\- legacy or normal UEs which are not authorized to a non-public network
access, may access the NG-RAN which supports non-public network because if
they have no capability to distinguish between public network and non-public
network. To solve the problem, we may use the cellReservedForOtherUse
indication, e.g. the NG-RAN node broadcasts both the cellReservedForOtherUse
and the non-public network indication as not barred.
\- Depending on the UE\'s subscription to a public PLMN and whether public
PLMN is accessible through the non-public network, (i.e. AMF in the non-public
network can access UDM/AUSF in the public PLMN. Or AMF resides in the public
PLMN), the UE identity and its corresponding credential used inthe non-public
network are determined as follows:
\- For UEs in a non-public network which is allowed to accessto the public
PLMNs of the UEs:
\- UE ID (i.e. SUPI) which is assigned by the public PLMN is used for the non-
public network as well as the public PLMN. And UE authentication can be
performed by the public PLMN\'s AUSF/UDM.
\- UE subscription data for the non-public network is stored in the non-public
network\'s UDM (This UDM can reside in the public PLMN). So UE authorization
for non-public network is performed by the non-public network\'s UDM.
NOTE: This secondary authorization aspect can be enhanced following the
conclusion of FS_eNS.
\- For UEs in a non-public network which is not allowed to accessthe public
PLMNs of the UEs (e.g. the non-public network which is managed by a different
PLMN operator or isolated from any PLMN):
\- UE ID (i.e. NAI) is assigned in the non-public network, where the realm
part of the NAI should include non-public network identification (e.g. NPN-
dedicated PLMN ID+NPN ID).
\- UE subscription data for the non-public network is stored in the non-public
network\'s UDM only. So UE authentication and authorization is performed by
the AUSF/UDM in the non-public network.
\- A UE includes the non-public network Identification(e.g. PLMN ID+NPN ID) in
the RRC message to indicate that the UE intends to access the non-public
network.
\- A UE indicates to the AMF identification information of (e.g. by including
the non-public network Identification in the registration request message).
\- On receiving the registration request message, the AMF may perform for UE
authentication in the non-public network:
\- UE authentication procedure in the public PLMN based on the SUPI or SUCI if
the public PLMN of the UE is accessible via the non-public network; and
\- UE authentication procedure in the non-public network if the non-public
network is not allowed to access to the public PLMN of the UE or isolated from
any public PLMN.
\- Source NG-RAN shall not hand over the UE to a target NG-RAN node if the
target is a cell not supporting its NPN.
Editor\'s note: How to support in detail that source NG-RAN shall not hand
over the UE in CM-CONNECTED state to a target NG-RAN node if the target is a
cell not supporting its NPN is FFS.
### 6.4.2 Procedures
The Figure 6.4.2-1 shows the UE Registration procedure in a non-public network
which is allowed to access the public PLMN for UE credentials that manages the
UE credentials (i.e. non-standalone NPN case):
Figure 6.4.2-1: UE Registration procedure in a non-public network (public PLMN
credential)
0\. A new SIB provided by 5G-RAN indicates non-public network(s) which it
supports (i.e. combination of NPN ID and PLMN ID is broadcast in the SIB). UE
discovers and select the non-public network which the UE has subscription to.
1\. UE to RAN: AN message (AN parameters, Registration Request (Registration
type, SUCI or 5G-GUTI, etc.), where the AN parameters include the selected NPN
ID.
2\. The RAN selects an AMF which is in the non-public network as described in
TS 23.501 [3], clause 6.3.5.
3\. RAN to AMF: N2 message (N2 parameters, Registration Request), where the N2
parameters include the selected NPN ID.
4\. [conditional] the new AMF retrieves the UE context from the old AMF which
the UE indicates by 5G-GUTI included in the Registration Request.
5\. The AMF may decide to initiate UE authentication for the non-public
network by invoking an AUSF. In that case, the AMF selects an AUSF in the
hPLMN if the UE Identity in the Registration Request message from the UE is
SUPI or SUCI or 5G-GUTI.
6\. If authentication is required, the AMF requests it from the AUSF, which is
in the hPLMN. NAS/AS Security contexts are shared between UE and non-public
network.
7\. The AMF selects a UDM to retrieve the UE subscription data for the non-
public network and register UE context, based on the SUPI and NPN ID.
Depending on the network deployment, a UDM in the public PLMN or a UDM in a
non-public network can be selected for the UE subscription data.
\- If UE subscription data for NPN is managed in the public PLMN, the AMF
selects the UDM in the public PLMN to retrieve the UE subscription data for
the public PLMN and the NPN.
\- If UE subscription data for the NPN is managed in the NPN, the AMF selects
a UDM in the PLMN to retrieve the UE subscription data for the public PLMN and
an additional UDM in the NPN to retrieve the UE subscription data for the NPN.
8\. The AMF registers with the UDM(s), which (are) selected for the PLMN and
the non-public network in step 7, using Nudm_UECM_Registration and subscribes
to be notified when the UDM deregisters this AMF, and retrieves the Access and
Mobility Subscription data, SMF Selection Subscription data and UE context in
SMF data using Nudm_SDM_Get.
9\. Based on the subscription data for the public PLMN and the NPN, the AMF
sends a Registration Accept message to the UE indicating that the result of
the Registration Request for the public PLMN and the NPN.
10\. The UE completes the Registration procedure.
The Figure 6.4..2-2 shows the UE Registration procedure in a non-public
network for the isolated NPN case:
Figure 6.4.2-2: UE Registration procedure in a non-public network (NPN
credential)
0\. A new SIB provided by 5G-RAN indicates non-public network(s) which it
supports (i.e. combination of NPN ID and PLMN ID is broadcast in the SIB). UE
discovers and select the non-public network which the UE has subscription to.
1\. UE to RAN: AN message (AN parameters, Registration Request (Registration
type, NAI or 5G-GUTI, etc), where the AN parameters include the selected NPN
ID.
2\. The RAN selects an AMF which is in the non-public network as described in
TS 23.501 [3], clause 6.3.5.
3\. RAN to AMF: N2 message (N2 parameters, Registration Request), where the N2
parameters include the selected NPN ID.
4\. [conditional] the new AMF retrieves the UE context from the old AMF which
the UE indicates by 5G-GUTI included in the Registration Request.
5\. The AMF may decide to initiate UE authentication for the non-public
network by invoking an AUSF. The AMF selects an AUSF in the NPN if the UE
Identity in the Registration Request message from the UE is an NPN UE ID.
6\. If authentication is required, the AMF requests it from the AUSF in the
NPN. NAS/AS Security contexts are shared between UE and non-public network.
7\. The AMF selects a UDM in the NPN to retrieve the UE subscription data and
register UE context, based on the NAI and the NPN ID.
8\. The AMF registers with the UDM, which is selected for the non-public
network in step 7, using Nudm_UECM_Registration and subscribes to be notified
when the UDM deregisters this AMF, and retrieves the Access and Mobility
Subscription data, SMF Selection Subscription data and UE context in SMF data
using Nudm_SDM_Get.
9\. Based on the subscription data for the non-public network, for the
authorized UE the AMF sends a Registration Accept message to the UE indicating
that the Registration Request has been accepted.
10\. The UE completes the Registration procedure.
### 6.4.3 Impacts on Existing Nodes and Functionality
UE
\- enhancement for NPN discovery and selection based on PLMN ID and NPN ID
RAN
\- enhancement for broadcasting NPN information in SIB (PLMN ID, NPN ID)
\- enhancement for selection of AMF based on NPN information from a UE
AMF
\- enhancement for handling UE subscription data for an NPN
\- enhancement for support of a UDM managed in an NPN
UDM
\- enhancements for NPN subscription (NPN UE ID, allowed NPN list)
### 6.4.4 Solution Evaluation
Solution 4 enables network discovery, selection and identification for non-
stand-alone non-public networks by broadcasting the list of non-public network
IDs that a given cell provides access to, where network discovery and
selection is performed based on available PLMN ID+ NPN ID, which is same as
for standalone non-public networks. The UE selects and attempts to register
with a non-public network the UE has a subscription for. UE authentication can
be performed by the public PLMN\'s AUSF/UDM. And UE authorization for non-
public network is performed by the non-public network\'s UDM or the public
PLMN\'s UDM per operator\'s deployment scenario on where the UE subscription
for non-public network is stored.
## 6.5 Solution #5: Solution for Access Control
### 6.5.1 Description
This is a solution for Key Issue #1 in order to prevent Network access for
cell re-selection and access control:
1) For UE(s) that are unauthorized to access the Non-public network, following
are the three levels of access control that the network can support in guard
itself from access by unauthorized UE(s):
a) Reject Registration request to prevent UE(s) from obtaining connectivity
and services from its network as described in TS 23.501 [3].
b) Ensure that unauthorized UE(s) are not selecting the cell in its network.
c) Use access barring mechanism to ensure that the unauthorized UE(s) are not
accessing the cell (i.e. RACH access) in its network.
2) To prevent access due to network congestion/overload for authorized UE(s),
network can support the following mechanisms in order to guard itself in case
of congestion:
a) Reactive congestion control: Perform AS/NAS congestion and overload control
as described in TS 23.501 [3] to alleviate congestion.
b) Proactive congestion control: In case of extreme congestion scenarios, use
access barring mechanism to ensure that the unauthorized UE(s) are not even
accessing the cell (i.e. RACH access) in its Non-public network to alleviate
congestion.
In order to support 1b), 1c), 2b), it proposes the following solution options:
**Option 1:** Non-public network assigns a special access identity (as part of
UAC framework) to its UE(s). Thus UE(s) assigned with regular access class
(allowed in public PLMNs) that are not authorized to access Non-public network
are not allowed to even initiate RACH access towards the Non-public Network.
**Option 2:** Non-public network bars access to UE(s) not configured with its
network identifier by default. RAN should broadcast that access is barred for
UE(s) not configured with its certain network identifier. Furthermore, RAN can
broadcast cell-reserv-for-other-use to ensure that the unauthorized UE(s)
(from public PLMN) are not accessing the Non-public network:
\- If the Non-public network is standalone with NPN-ID as described in
solution #1, then the network can broadcast cell-reserv-for-other-use and NPN-
ID to prevent access from UE(s) not authorized to access Non-public network.
Network can also broadcast PLMN ID with MCC value set to 999 and 3GPP defined
MNC value in order to prevent access from UE(s) not authorized to access Non-
public network.
\- If the Non-public network is non-standalone with PLMN ID and CAG ID as
described in solution #2, then the network can broadcast cell-reserv-for-
other-use and CAG-ID to prevent access from UE(s) not authorized to access the
CAG cell hosted by PLMN.
Thus, it allows access only for UE(s) that are authorized to access the non-
public network.
On top of Option #2, UAC framework can be leveraged to perform Proactive
congestion control for scenario 2a) described above.
Either option can be supported based on configuration in the network thus it
is optional for the network to leverage access control mechanism based on
local policies.
In order to support UAC for NPN, Rel-15 approach can be reused for RRC_Idle
and RRC_Inactive UEs.
Editor\'s note: The need to support UAC for NPN needs to be confirmed with SA
WG1.
### 6.5.2 High Level Description
### 6.5.3 Impacts on Existing Nodes and Functionality
\- Network needs to broadcast a parameter (e.g. cell-reserv-other-use) in
order to prevent legacy UE(s) and non-supporting UE(s) (i.e. Rel-16 UE(s) that
are not supporting non-public network specific broadcast parameters) from
accessing the Non-public network. The actual choice of broadcast parameters to
achieve this functionality is up to RAN2 to decide.
\- Network needs to broadcast an indication that it is Non-public network.
This can be achieved either by broadcasting NPN ID or CAG ID, PLMN ID with MCC
999 and 3GPP defined MNC value. The actual choice of broadcast parameters to
achieve this functionality is up to RAN2 to decide.
### 6.5.4 Solution Evaluation
Option #1 has the benefit of leveraging existing access control framework
specified as part of UAC for supporting scenario 1) but provides an additional
method for controlling access to only UE(s) assigned the special access
identity. However, option #1 has a drawback, that is the non-public network
will have restricted access categories (in addition to the special access
identity), e.g to allow/inhibit access of own devices in case of extreme
congestion scenarios for scenario 2b).
Option #2 would be a new framework, but it has the benefit of not having to
assign a new access identity rather leveraging the assigned network
identifier. This solution allows the Non-public network to use the fullblown
set of UAC features, assign own access control categories for own UE(s) in
order to support proactive congestion control mechanism for its UE(s) for
scenario 2a).
## 6.6 Solution #6: Architecture framework for integration with TSN
### 6.6.1 TSN Network
The 5GS may be operated as stand-alone TSN network or part of a TSN network,
e.g. an industrial communication network. Common to both options is that a 5GS
solution needs to support the three TSN configuration models, which are
defined in IEEE P802.1Qcc/D1.6 [9]:
**Fully distributed model (see Figure 6.6.1-1):** The TSN end stations, i.e.
Talkers and Listeners, communicate the TSN stream requirements directly to the
TSN network. Each TSN bridge on the path from Talker to Listeners propagates
the TSN user and network configuration information along with the active
topology for the TSN stream to the neighbouring bridge(s). The network
resources are managed locally in each TSN bridge, i.e. there is neither a
Centralized Network Configuration (CNC) entity nor an entity that has the
knowledge of the entire TSN network.
Figure 6.6.1-1: Fully distributed model
**Centralized network and distributed user model (see Figure 6.6.1-2):** The
TSN end stations, i.e. Talkers and Listeners, communicate the TSN stream
requirements directly to the TSN network. In contrast to the fully distributed
model, the TSN stream requirements are forwarded to a Centralized Network
Configuration (CNC). The TSN bridges provide their network capabilities
information and active topology information to the CNC. The CNC has a complete
view of the TSN network and is therefore enabled to compute respective end-to-
end communication paths from a Talker to the Listeners that fulfil the TSN
stream requirements as provided by the end stations. The computation result is
provided by the CNC as TSN configuration information to each TSN bridge in the
path between involved TSN end stations (Talkers to the Listeners) as network
configuration information.
Figure 6.6.1-2: Centralized network and distributed user model
**Fully centralized model (see Figure 6.6.1-3):** The fully centralized model
acts similar to the centralized network and distributed user model. Main
difference is that the TSN end stations, i.e. Talkers and Listeners,
communicate the TSN stream requirements not directly to the TSN network but to
a Centralized User Configuration (CUC). The CUC may adapt these TSN end
station stream requirements before forwarding them to the CNC. The CNC
performs the same actions as described in the centralized network/distributed
user model, except that CNC sends specific TSN configuration information to
the CUC. From this, the CUC may derive the TSN configuration information for
the TSN end stations and notify them accordingly.
Figure 6.6.1-3: Fully centralized model
### 6.6.2 5GS Network
The 5GS provides multiple interfaces to external services/networks that can be
used for TSN integration:
**N6:** Reference point between the UPF and a Data Network. This interface is
mainly used for the user plane data transport.
**N5:** Reference point between the PCF and an AF. This interface can be used
to exchange service requirements.
**N33:** Reference point between NEF and AF. This interface can be used by the
5GS to expose its capabilities.
**N60:** New reference point between UE and non-3GPP devices connected to the
UE for URTSC specific requirements (e.g. time synchronization, user plane
impacts, etc.).
Figure 6.6.2-1: System architecture of the 5GS with internal and external
interfaces
### 6.6.3 5GS and TSN Network Integration
With respect to existing definitions on 5GS and TSN, we consider two options
how the TSN network sees the 5GS. The first option considers the 5GS as a TSN
link, and the second option considers the 5GS as a TSN bridge within the TSN
network. It is proposed to evaluate both options taking into account that the
following principles need to be supported:
\- Ingress and Egress ports connecting TSN end stations or TSN Bridges to the
UE;
\- Egress and Ingress ports connecting TSN end stations or TSN Bridges to the
UPF;
\- TSN time synchronization needs to be guaranteed for all Ingress and Egress
ports;
\- Mapping of TSN QoS requirements to 3GPP QoS requirements and vice versa;
\- Mapping of 5GS capabilities to TSN bridge capabilities and vice versa (e.g.
TSN bridge Managed Objects (MO):
\- TSN bridge capabilities (e.g., bridge-related Managed Objects (MO)) and
vice versa (in case of 5GS is modelled as a TSN bridge); or
\- TSN link capabilities (e.g., bandwidth, propagation delay) and vice versa
(in case of 5GS is modelled as a TSN link);
\- TSN bridge self-management for fully distributed model; handling of TSN
information exchange (CUC, CNC, TSN bridges, TSN end stations) according to
the TSN models;
\- Support of TSN protocols and functionality (e.g. FRER, SRP, MSRP, LLDP,
FQTSS, etc.) as defined in IEEE 802.1 family for TSN.
## 6.7 Solution #7: 5GS appearing as a TSN link for integration with TSN
In this solution option, the 5GS appears to the external network as a TSN
link, i.e, as an Ethernet cable which would have to be plugged into the TSN
bridge on either side (UE and UPF). The advantage of this option is that the
link model used in TSN it is quite simplistic, it uses a limited set of
attributes to characterize the link. The link is defined by the connected
entities, i.e. either two TSN bridges or a TSN end station and a TSN bridge or
two TSN end stations. The link capabilities are described by the
ingress/egress ports of the TSN bridges connected to the end of a link or by
the TSN streaming requirements of an TSN end station directly connected to the
link. The main problem is that the 5GS doesn\'t behave like an Ethernet cable
but still would need to expose its capabilities according to the limited
possibilities of the TSN link model. These exposed capabilities may include
delay information, link speed, and available bandwidth information.
Figure 6.7-1: Example for system architecture view with 5GS appearing as link
between two TSN bridges and/or TSN End stations
A potential solution to solve this issue could be to change the IEEE TSN
standards and to define respective Managed Objects for a \"5GS Link\" or
similar wireless link (i.e. in order to support the distributed model, there
needs to be an 5GS adaptation function supported inside the TSN bridge/End
station and this is controlling how the TSN streams are transmitted).
The architecture assumes support of standardized QoS characteristics. There
are two possibilities:
1) Since there is no QoS negotiation on control plane or user plane
interfaces, one option is that the QoS requirements for TSN are pre-configured
in the PCF thus it is possible that there is over dimensioning of the
requirement.
2) Another option, if dynamic adaptation of 3GPP 5G System capabilities (e.g.
based on RAN resource status) is needed, then 5GS adaptation function is
needed in the TSN Bridge/End Station but this requires IEEE standards change
to support the 5GS adaptation function. In addition, 5GS adaptation function
in the TSN bridge can interface with the PCF for dynamic QoS support.
NOTE: Besides TSN streams carrying payload data, any TSN user and network
configuration information (e.g. stream requirements, discovery information,
etc.) needs to be provided via the \"5GS Link\".
### 6.7.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause describes impacts to existing services and
interfaces.
### 6.7.4 Solution Evaluation
Editor\'s note: This clause describes evaluation of this solution.
## 6.8 Solution #8: 5GS appearing as a TSN bridge (black box) for integration
with TSN
5G system overall adopts a QoS framework where applications request QoS
properties that the 5G system then meets using 5G framework such as QoS Flow
type (GBR, delay critical GBR), 5QI, ARP, etc.
**5G System appearing as a TSN bridge** : In this option, the 5G system
receives TSN related reservation requests using the well-established 5G QoS
framework. The 5G system then uses _5G internal signalling_ to satisfy the TSN
reservation request.
In this solution option, the 5GS appears to the external network as a TSN
bridge. This \"logical\" TSN bridge (see Figure 6.8-1) includes adaptation
function(AF) to translate the 5GS protocols and information objects to TSN
protocols and information objects and vice versa. 5GS-specific procedures in
CN and RAN, wireless communication links, etc. remain hidden from the TSN
network. To achieve such transparency to the TSN network and appear as any
other TSN Bridge, the 5GS Bridge provides TSN ingress and egress ports via the
so-called TSN Translator (Device) on the UE side and via the \"TSN
Translator\" (CP and UP) on the CN side towards the DN. The fact that the 5GS
Bridge needs to support the different TSN configuration models (see clause
6.6.1) requires several TSN compliant interfaces with the respective protocols
towards TSN end stations, TSN bridges, CNC, and CUC both on the control plane
and user plane. The TSN bridge self-management (for the fully distributed
model) and the functions required to interact with CNC are preferably located
at the Network Translator. There might be potential impact to 5G internal
interfaces (e.g. N1, N2, N3) due to this solution option.
NOTE 1: Besides TSN streams carrying payload data, any TSN user and network
configuration information (e.g. stream requirements, discovery information,
etc.) need to be provided by the 5GS Bridge via the AF.
Figure 6.8-1: Example for system architecture view with 5GS appearing as TSN
bridge (TSN Translator (TT) shown within UPF)
Figure 6.8-2: Example for system architecture view with 5GS appearing as TSN
bridge (TSN Translator shown outside UPF)
Modelling the 5GS as a TSN Bridge has the advantage that 5GS capabilities can
be exposed using the respective information models for describing TSN bridge
capabilities, which are better suited to capture the characteristics of the
5GS compared to the TSN link model attributes. Moreover, the approach allows
for controlling the interaction with the major TSN control entity (TSN CNC),
e.g., for negotiating QoS attributes. Finally, with the introduction of the
TSN Translators at the UE side and the network side, it should be possible to
reuse many of the existing interfaces defined for 5GS.
NOTE 2: Note that under this option the 5G system may use TSN internally, e.g.
for the link layer for the N3 interface between CU and DU, but these TSN
functions do not interwork with TSN nodes outside the 5G system. Such link
layer use until now is typically outside the scope of 3GPP specifications.
Whether specifically for TSN link layer aspects in the backhaul interface need
to be standardized in 3GPP will be decided in RAN WG3.
A simple way to describe this approach is that 5G System is considered a black
box from the TSN viewpoint. This approach would be easier since it adopts the
specified QoS framework of the 3GPP 5GS and there is no explicit need for any
of the 3GPP network nodes to support TSN protocols and procedures that are
part of the external TSN system.
Editor\'s note: Transport Level Marking is provided from SMF to UPF as
currently defined in TS 29.244 [16]. Whether some enhancement or new
indication is needed in order to indicate mapping of Transport Level Marking
to TSN parameters in case TSN is assumed to be deployed in underlay used in
link layer is FFS.
### 6.8.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause describes impacts to existing services and
interfaces.
### 6.8.4 Solution Evaluation
Editor\'s note: This clause describes evaluation of this solution.
## 6.9 Solution #9: Adapted TSN framework
### 6.9.1 Description
This is a solution for key issue 3.1. This solution has been merged with
solution #8 thus it will not be updated further.
5G system overall adopts a QoS framework where applications request QoS
properties that the 5G system then meets using 5G framework such as QoS Flow
type (GBR, delay critical GBR), 5QI, ARP, etc.
**Adapted TSN framework** : In this option, the 5G system receives TSN related
reservation requests using the well-established 5G QoS framework. The 5G
system then uses _5G internal signalling_ to satisfy the TSN reservation
request.
Figure 6.9.1-1: 5G System interworking with TSN adaptations (Adapted TSN
framework)
A simple way to describe this approach is that 5G System is considered a black
box from the TSN viewpoint. This approach would be easier to the traditional
handling of QoS inside the 3GPP system and there is no need for any of the
3GPP network nodes to support TSN protocols and procedures that are integrated
with the external TSN system.
Note that under this option the 5G system may use TSN internally, e.g. for the
link layer for the N3 interface or for the fronthaul interface between CU and
DU, but these TSN functions do not interwork with TSN nodes outside the 5G
system. Such link layer use of TSN until now is typically outside the scope of
3GPP specifications.
### 6.9.2 Procedures
### 6.9.3 Impacts on Existing Nodes and Functionality
### 6.9.4 Solution Evaluation
Though this approach has simplicity, it needs to be assessed whether it is
valid or not based on whether delay Tolerance, Packet Loss and jitter
requirements that are currently accomplished by TSN in fixed network
deployment, can be fulfilled by a 5G System.
Between RAN and SA WG2 it needs to be assessed, whether the performance KPIs
are currently defined in clause 8.1 of TR 22.804 [6] can be met with this
approach. This can determine whether existing 5G QoS mechanisms already meet
these requirements, whether potentially extensions in the 5G QoS framework
e.g. by adding new parameters can also be considered or is essential to
support TSN \"inside\" the 5G System.
## 6.10 Solution #10: Integrated TSN framework
### 6.10.1 Description
This is a solution for key issue 3.1.
**Integrated TSN framework** : In this option, individual nodes of the 5G
system (e.g. UPF, gNB) interact with TSN procedures initiated by TSN end-
points and TSN controllers. This allows the 5G system and associated
infrastructure to present itself as multiple TSN-compatible end-points.
Adopting the Integrated TSN approach will involve more extensive specification
work, and should be considered if the \"adapted TSN approach\" is found to
have significant difficulties.
Figure 6.10.1-1: 5G System interworking with TSN integration (Integrated TSN
framework)
Editor\'s note: It is FFS whether the backhaul delays between gNB and UPF can
be assumed to be are symmetric in terms of transmission directions and time-
invariant.
### 6.10.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
### 6.10.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.10.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.11 Solution #11 Options for time synchronisation using TSN (key issue
3.2)
### 6.11.1 Description
This is a set of solutions for Key Issue 3.2.
TR 22.804 [6] describes a requirement for synchronization of all automation
endpoints, in order for the endpoints to coordinate sensing and actuation
procedures at a common sampling point, with alignment of the order of 1
microsecond. Refer to bullet 4, Clause 5.3.2.3 of TR 22.804 [6] for a
description of the use case.
With TSN, synchronization is performed by 802.1AS/gPTP messages where each
automation endpoint acts as an 802.1AS client, and a TSN Master Clock that
generates the 802.1AS messages. For automation systems operating over a
wireless interface, there are two options for the deliver of precise timing
information to the UE.
**Option 1:** Transport of 802.1AS messages over the 5G system to convey
timing to the UE. In this option, the 5G system appears as an 802.1AS
compliant entity that allows northbound and southbound nodes to use 802.1AS
standardized signalling to exchange time information.
**Option 2:** 5G RAN conveying timing to the UE that acts as boundary master
clocks towards connected TSN device via 5G specific signalling via 5G
broadcast/5G unicast RRC. The 5G RAN indicates time associated with a specific
point (e.g. start of frame boundary) of 5G RAN\'s fine-frame structure. In
case of multiple clock domains, 5G RAN using broadcast signalling (including
on demand SI) can convey timing information associated with all clock domains
to UE or 5G RAN using unicast/RRC signalling can convey timing information
associated with a subset of clock domains.
The 5G RAN can receive the TSN timing information via direct connectivity with
TSN master clocks, e.g. via underlying transport network by having an embedded
TSN client within the gNB (this option does not use UE specific 802.1AS
messages).
NOTE 1: Other means for NG RAN to receive TSN timing information is not
precluded and it is up to network deployment.
Similarly, UPF implementations may need to be synchronized with TSN master
clock for TSN traffic forwarding reasons using an embedded PTP slave entity.
External TSN clock is made available for UEs when gNB is synchronized with TSN
GM through underlying PTP capable transport network by using (g)PTP.
Quality of supported clocks may have impact to usage of SIB/RRC resources.
Figure 6.11.1-1: Worst case frequency variations of industrial working clock
grand masters
Obtaining required precision for external clock may need quite frequent time
information updates over Uu. For instance, frequency drift of TSN working
clock GM is up to 3 ppm/s related to 5G GM, clock jitter is 3 Âµs per second at
worst case. To keep time error due to frequency variations \ NOTE 2: Use of SIB broadcasting/RRC signalling for time synchronization
> needs confirmation from RAN WG2.
Figure 6.11.1-2: Overview for time synchronization with external clock mode
approach (option 2)
Multi-Time domain scalability:
Timing for multiple domains may be provided to the gNB, either from a directly
connected GM, or via to PTP capable transport that conveys clocks from PTP
connected GM clocks. 5G specific signalling of clock time information aligned
with the frame structure (e.g. an SFN boundary) is then used to covey time to
the UE, which then acts as a boundary master clock towards connected TSN
devices.
Support for clock transmission across the 5GS for multiple clocks can be based
on the following:
\- Leverage the approach as described in Option 4 (Multiple time domains
merged into one domain using 5G clock) of this clause. In this case, when
multiple time domain is supported, they are merged into one domain using 5G
clock.
\- PTP is supported in the 5GS, allowing clocks to be synchronized between the
gNB, UPF and TSN bridges in a DN. A GM may be configured anywhere in the PTP
connected network.
\- A clock time may be synchronized via SIB broadcast over Uu, using
mechanisms similar to that defined in LTE Rel-15.
\- To provide efficient signalling, working clock information may be
transmitted via SIB (SIB9) or on demand SI or via dedicated RRC as specified
by RAN groups.
Both broadcast (SIB) and unicast (RRC) methods are supported by LTE Rel-15 and
industrial use cases provide further justifications for adopting both methods
in the 5GS to transmit time information for the required domains.
NOTE 1: It is up to RAN groups to consider permitting both the SIB and
dedicated RRC signalling to transmit time information for the required
domains. To improve efficiency and better support scalability, RAN WG2 may
further consider optimizations to compress redundant information sent by
working clocks and more efficiently encode working clock information.
**gPTP compliancy with preserving origin timestamp:**
According to IEEE P802.1AS-Rev/D7,5 \"Draft Standard for Local and
Metropolitan Area Networks - Timing and Synchronization for Time-Sensitive
Applications\". the origin time stamp received in slave port of time aware
relay shall be copied to SYNC messages sent by a master ports also in case
with SyncLocked variable is set FALSE i.e. when transmission of gPTP SYNC
messages in master port (UE) is not following the periodicity of slave port
(gNB).
Conveying of the origin time stamp with synchronized time through Uu will
introduce small signalling overhead compared to case were only synchronized
time is conveyed. gNB determines the time in scale of NR time base when TSN GM
time has been equal to time indicated in the origin timestamp. Thus, time
information that conveys both the origin time stamp and TSN time over Uu at
gNB transmitter port, consists of:
\- Reference SFN (10bits)
\- Time offset within reference SFN with [10ns] resolution (20 bits)
\- Origin Timestamp, which is copied from the last received gPTP SYNC message
(80bits)
Reference SFN and Time offset, determine the time at local (NR) clock scale
(at TX port of gBN) when TSN time has been equal to the time indicated in the
origin time stamp.
Figure 1 illustrates operation with incoming gPTP SYNC interval in gNB of
125ms, SIB periodicity of 160ms and outgoing gPTP SYNC interval in UE of 250
ms.
Figure 6.11.1-3: Preservation of gPTP origin timestamps with Solution #11
Option 2
UE populates correction field (Ci) based on difference between SYNC message
transmission time related to the origin timestamp in TSN time scale. UE may
determine also frequency offset between external GM and NR time base from
consecutive time information messages and can thus populate rate ratio (Ri)
field of sent SYNC. Same applies also for populating related fields in sync
follow-up message in case of two step sync.
**gPTP compliancy with support for gPTP slave port in UE:**
Solution 11 option 2 can be extended also to support gPTP slave port in UE. If
BMCA detects, with considering also clock location related aspects, that the
best GM is in UE side, then UE needs to determine refSFN and ref_offset
related reusing greatly the same mechanisms that are used in case where gNB
provides the time information. It needs to be defined, if compensation of
propagation delay over Uu (TA/2) is done either in UE or gNB. Dedicated RRC
signalling with same IE formats as in SIB can be used to convey time
information from UE to gNB. gNB broadcasts then time information to other UEs
via SIB.
**Option 3:** one time-aware relay implemented with Solution#8.
This solution has been further merged with solution # 28 to provide one single
solution in clause 6.28A.
Single Time Domain:
An alternative option can be an implementation with 5G black box model as
described by Solution#8. In such an implementation, the entire 5G system can
be kept untouched, therefore there will be minimal impact on the 5G system
nodes. The translator/adaptor function located at the edge of 5G system, can
take care all 802.1AS related functions. For example, the (g)PTP support, time
stamping, BMCA can be all implemented in the translator.
It is a type of \"distributed boundary clock\" implementation, or in a 802.1AS
term \"distributed time-aware relay\". Only the network elements at the edges
of the 5G system (i.e. translator/adaptor) needs to support the IEEE 802.1AS
operations. The 5G internal system clock will keep these network elements
synchronized so that the timestamping of the gPTP event messages is done
correctly. The 5G system has to properly handle the BMCA (in particular
handling the gPTP Announce messages) in order to properly the set up the state
of the PTP ports and select the GM. Given the specific operation described by
the IEEE802.1AS, the actual timing operation consist in the processing of the
correction field in the sync message (as well as of the proper handling of the
peer-to-peer delay operations).
The translator function can be implemented either as part of UPF/UE, or as a
stand-alone entity.
Figure 6.11.1-2a: 5G system is modelled as one time-aware relay using
solution#8
The timing information from TSN working domain (external clock) is delivered
via the UEs to the respective End stations. This option assumes the 5G
internal system clock (black clock) is made available to all nodes in the 5G
system and this is made available to the network translator/adaptor via the
underlying PTP compatible transport network. The 5G internal system clock can
be made available to UE with signalling of time information related to
absolute timing of radio frames (i.e. using SIB/RRC based methods described
for LTE Rel-15). The timing information (gPTP messages, including the
information on the incoming sync message timestamping) can be carried from the
UPF to the UE as data packets (e.g. payload). The time stamp of UPF and UE are
based on the 5G internal system clock.
Multiple Time domains support:
gPTP frames from two (or more) different TSN working domains arrive at the UPF
or translator at UPF side, these frames carry the gPTP multicast Ethernet
destination MAC address and a specific PTP \"domainNumber\" that indicate the
time domain they are referring to.
The UPF / translator makes ingress timestamping (TSi) per time domain for the
gPTP messages. The TSi can be carried, for example, either in the suffix or
\"correctionField\" of the gPTP message together with the original TSN timing
information. UPF then forwards the modified gPTP messages to every UE via user
plane (e.g. PDU session).
A UE receives the original TSN clock timing information and the TSi per time
domain via gPTP messages and forwards them to the UE side translator. The UE
translator then makes egress timestamping (TSe) for the gPTP messages for
every external TSN working domains. The difference between TSi and TSe is
considered as the residence time spent within the 5G system. The UE/translator
regenerates the gPTP messages towards an end station with the original TSN
timing information and calculated residence time in the \"correctionField\".
An end-station can select the proper TSN timing information based on the
\"domainNumber\" in the gPTP message. Ingress and egress time stamping of the
5G system is based on a 5G time domain provided to gNBs from a 5G grand master
(GM) clock. The 5G RAN remains independent from the one or more TSN working
time domains. The solution is independent from the number of working time
domains that are supported. This solution is compliant with IEEE 802.1AS,
according to which it appears as a \"time-aware system\".
NOTE 2: The 5G system time can be provided to the UE/translator via over-the-
air time synchronization and to the UPF/translator via a transport network.
Figure 6.11.1-2b: Supporting multiple TSN working domains with Solution#11
option3
Solution#11 option3 supports \"merge\" and \"separate\" cases through
application layer (\"application merge\" and \"application separate\"). The
end station receives gPTP messages for both working domains, then it can
select \"domainNumber\" based on application decision. For example, in figure
2, if the application decides \"separate\" case, then the green end station
will select green working domainNumber, and the orange end station selects the
orange working domainNumber. If the application decides \"merge\" (orange
working domain merges to green), the orange end station selects the green
domainNumber. The detailed mechanism of merging is outside 3GPP scope.
**Option 4.** Multiple time domains merged into one domain using 5G clock.
In this option a single clock domain is sufficient and a suitable one could be
provided by the 5G system itself (in fact, it normally has to operate
synchronous with an internationally recognized standard such as GPS).
In the example shown in figure 6.11.1-3, the UE only receives 5G timing
information through gNB, and acts as master clock to the TSN end stations. The
TSN bridges and End stations at the right side of the figure also receives
timing information from the 5G GM via UPF and underlying PTP compatible
transport network. Therefore, all connected domains are locked to the 5GS
clock (same universal time; all working clock domains synchronous to the
universal time)
In this case each interface of the 5G system is seen by the connected TSN
networks and by the End stations, as separate GMs, each of them operating in
independent gPTP domains, but providing the same time to all the connected
networks. For example, the 5G clock at the transport function (TP) of the UPF
is acting as TSN GM and provides GM reference to the TSN work domain 1 and 2
on the right side of the figure. The 5G clock at UEs acts as TSN GM for the
End stations that belonging to TSN domain 1 and 2 respectively.
{width="6.689583333333333in" height="2.4208333333333334in"}
Figure 6.11.1-3: Different time domains are merged into one time domain
Figure 6.11.1-4: An implementation option of figure 3 using black box model
mentioned in Solution#8
An alternative option as shown in figure 6.11.1-4 can be an implementation
with 5G black box model as described by Solution#8. In such an implementation,
the entire 5G system can be kept untouched, therefore there will have minimal
impact on the 5G system nodes. The translator/adaptor function located at the
edge of 5G system, can take care all 802.1AS related functions. For example,
the (g)PTP support, time stamping, can be all implemented in the translator.
The translator function can be implemented either as part of UPF/UE, or as a
stand-alone entity.
### 6.11.2 Procedures
### 6.11.3 Impacts on Existing Nodes and Functionality
### 6.11.4 Solution Evaluation
## 6.12 Solution #12: 5G LAN-type service and 5GLAN communications using
principles in TS 29.561 [10]
### 6.12.1 Description
The solution addresses key issue #4.1 (\"5GLAN Group Management\") and key
issue #5 (\"Support of 5GLAN communication\"). The solution is based on the
following principles:
\- The solution assumes that the 5GLAN administrator makes a request for
5GLAN-type service by means that are outside of 3GPP scope.
NOTE: As an example, the 5GLAN administrator goes to the operator\'s portal
and makes a request for 5G LAN-type service. The request includes the GPSI
(General Public Subscription Identifier) or SUPI (Subscriber Permanent
Identity) of all UEs that are supposed to use this 5G LAN-type service for
private communication and the type of communication (IP or Ethernet). In
addition the 5GLAN administrator may indicate any of the following additional
information: requested QoS, IPv4 or IPv6 communication, static or dynamic IP
address, additional IP services (e.g. DNS, Dynamic DNS, DHCP, IMS, egress to
Internet), additional Ethernet services (e.g. multiple IEEE 802.1Q VLANs).
\- If the operator accepts the 5GLAN administrator\'s request, the operator
configures the network and the UE for 5G LAN-type service as follows:
\- The configuration of the UE is performed from a logical Application
Function (AF) that configures the UE via the PCF directly or indirectly via
the NEF first and the PCF second. According to TS 23.501 [3] clause 5.6.7 the
direct path via PCF is used \"in the case of requests targeting specific on-
going PDU Sessions of individual UE(s)\", whereas the indirect path (NEF-PCF)
is used for \"AF requests that target existing or future PDU Sessions of
multiple UE(s)\". Eventually the policy configuration is delivered from the
PCF to the UE using the UE Configuration Update procedure. Alternatively, the
configuration for 5GLAN-type service described in clause 6.12 can be
configured manually.
\- The configuration of the network can be performed manually. The
configuration process consists in: instantiating a private IP or Ethernet
network by configuring a set of hardware and software resources (e.g. IP
routers, DNS servers, DHCP servers, Ethernet switches, egress to internet, IMS
servers, etc.) and configuring a selected PDU Session Anchor (PSA) as the
ingress point to the 5GLAN.
Editor\'s note: It is FFS whether the network configuration can be performed
by using the 5GC Control plane functions (e.g. NEF, SMF).
### 6.12.2 Procedures
Once the UE and the network are configured, the 5G LAN-type service and 5GLAN
communication is provided largely by using the procedures for access to
external networks specified in TS 29.561 [10]:
\- UE wishing to connect to the 5G LAN makes a PDU Session Establishment
request to the configured DNN.
\- During PDU Session establishment the network selects the preconfigured PDU
Session Anchor (PSA) that is the ingress point to the preconfigured 5G LAN.
\- In case of IP communication the interworking procedures are specified in TS
29.561 [10], clause 8.
\- In case of Ethernet communication the interworking procedures are specified
in TS 29.561 [10], clause 14. If IEEE 802.1Q tags are used, the PSA selects
the appropriate Ethernet VLAN based on the 802.1Q VID tag.
\- If the DNN is configured for secondary (PDU Session-level) authentication,
it is performed as specified in TS 33.501 [11].
\- For any enhanced services such as IMS, the additional interworking
procedures are defined in TS 29.561 [10] clause 13.
\- The one-to-one and one-to-many communications are achieved by using native
IP and Ethernet mechanisms. In all cases the transport between UE and the PSA
is in point-to-point manner.
### 6.12.3 Impacts on Existing Nodes and Functionality
The solution requires definition of configuration information for 5G LAN-type
service. This information is provided to the UE by using the existing
procedure for UE policy delivery.
For 5G LAN-type service for IP communication the configuration information may
include the following:
\- DNN and optionally S-NSSAI for access to the 5G LAN for IP communication.
NOTE 1: One PDU Session provides access to one 5G LAN for IP communication.
\- Credentials for secondary (PDU Session-level) authentication with a AAA
server in the 5G LAN.
\- Authorised QoS (e.g. in terms of DSCPs).
\- DNS server name or address, and indication of support for dynamic DNS.
\- P-CSCF address (in case of enhanced services such as IMS).
Editor\'s note: It is FFS whether there is a need to provide DNS server
address and P-CSCF address as part of the UE configuration, given that both
parameters can be provided to UE upon PDU Session Establishment via the PCO.
\- Time of service activation indicating to the UE when it can start using the
configured information for access to the 5G LAN-type service.
For 5G LAN-type service for Ethernet communication the configuration
information may include the following:
\- DNN and optionally S-NSSAI for access to the 5G LAN for Ethernet
communication.
NOTE 2: One PDU Session can provide simultaneous access to several 5G LANs for
Ethernet communication.
\- Credentials for secondary (PDU Session-level) authentication with a AAA
server in the 5G LAN.
\- Indication of support of IEEE 802.1Q operation providing access to multiple
virtual networks and QoS tagging support.
\- 5GLAN identifiers for 5GLANs associated with this DNN e.g. IEEE 802.1Q VID
tags for virtual 802.1Q networks associated with this DNN.
\- List of GPSIs (or SUPIs) associated with each IEEE 802.1Q tag.
\- Authorised QoS (e.g. in terms of 5QIs or IEEE 802.1Q PCP values).
\- Indication of ARP (Address Resolution Protocol) support in the 5G LAN.
NOTE 3: ARP is an auxiliary protocol for IP and is strictly speaking not part
of the 5G LAN-type service for Ethernet communication. If the end user is
using IP communication on top of the 5G LAN-type service for Ethernet
communication, this can result in significant ARP traffic that the operator
may want to disallow.
\- Indication of Spanning tree protocol support in the 5G LAN.
NOTE 4: When the 5GLAN does not include entities handling the Spanning tree
protocol, while the end user is using it, this can result in significant
Spanning tree protocol traffic that the operator may want to disallow.
\- Max number of Ethernet addresses reachable via this UE. This configuration
parameter is used to limit the volume of reporting from the PSA to the PCF on
per MAC address as described in TS 23.501 [3], clause 5.6.10.2.
\- Time of service activation indicating to the UE when it can start using the
configured information for access to the 5G LAN-type service.
### 6.12.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.13 Solution #13: 5G LAN service network (switch mode) architecture
### 6.13.1 Description
The solution addresses key issue #5 (\"Support of 5GLAN communication\").
In this solution the SMF configures the UE to operate as an Ethernet switch
with configuration parameters provided during the establishment of the PDU
Session. This PDU Session provides access to the 5G LAN-type service (i.e.
5GLAN Group communication). The UE operating as an Ethernet switch may be part
of multiple 5G LAN Groups. Multiple backend devices can be connected to the UE
operating as an Ethernet switch but each device may only be part of a single
5GLAN Group.
The configuration parameters provided by the SMF are as follows:
\- An indicator whether the UE in Ethernet switch mode shall turn on or off
the Spanning Tree Algorithm.
\- A periodic timer of sending BDPU messages.
\- A bridge identifier of the UE in Ethernet switch mode.
\- An indicator whether the UE in Ethernet switch mode notifies the change of
port\'s status.
\- An indicator whether the UE in Ethernet switch mode reports the list of MAC
address(es) of the backend devices connected in the backend networks.
If the SMF indicates the UE to report the list of MAC address(es) of the
backend devices, the UE in switch mode gains the list of MAC address(es) of
the backend devices connected or changed in the backend networks, and in case
one PDU Session provides 5GLAN communication for more than one 5GLAN groups,
the UE also gains the mapping relationship of MAC address(es) and the 5GLAN
group . The UE informs the SMF of the list of MAC address(es) and the mapping
relationship during the PDU Session establishment/modification procedure when
the UE receives the indicator or detects the changes on the backend devices.
Then the SMF provides to the UPF Ethernet Packet Filter Set and forwarding
rule(s) based on the MAC address(es) and the mapping relationship. The UPF
detects and forwards Ethernet frames based on the Ethernet Packet Filter Set
and forwarding rule(s) received from the SMF.
Editor\'s note: How the UE learns the MAC addresses of backend devices is FFS.
The further enhancement to optimize Ethernet networks over 5G link including
the following:
\- The UE in Ethernet switch mode may report its port states that results from
the execution of the Spanning Tree Algorithm so that the SMF may control the
UPF\'s port states based on the report to prevent the waste of air-resource.
### 6.13.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
### 6.13.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.13.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.14 Solution #14: Private DNN for 5GLAN Group Communication
### 6.14.1 Overview
This solution addresses Key Issue #4 and #5. The solution proposes to
introduce Private DNN for 5GLAN group communication.
A Private DNN uniquely identifies a 5GLAN group and all the member UEs of the
same group need to establish a PDU Session towards the same Private DNN for
5GLAN group communication. Reserved special labels in the DNN syntax can
easily indicate whether it\'s a Private DNN. Private DNNs might be
preconfigured in the network and the group member UEs. They may be also
dynamically created on demand by the operator or the group
owners/administrators, as part of the 5GLAN group creation. When a new Private
DNN is created on demand, the information may be propagated into the concerned
network entities (e.g. AMF, SMF, UDR, etc.) in the core network and group
member UEs may receive the Private DNN information, together with the related
configurations such as the Service Area configuration, via NAS procedures
(e.g. Registration or UE Configuration Update).
Editor\'s note: It is FFS what information is configured in the UE and the
network in case of preconfigured 5GLAN Group.
A 5GLAN group member UE establishes a dedicated PDU Session towards the target
Private DNN before it can communicate with the group. The legacy PDU Session
management procedures can be reused for group communication. According to the
Private DNN, the network selects the appropriate network functions (e.g. SMFs
and UPFs) for the UEs of the same group. For example, all the UEs of the same
group and in the same local area may be assigned the same SMF and UPF.
Figure 6.14.1-1: Private DNN for 5GLAN communication
Figure 6.14.1-1 illustrates the solution. In the figure there are two 5GLAN
groups: 5GLAN Group 1 which consists of UE1 and U2, and 5GLAN Group 2 which
consists of UE2 AND UE3. UE2 is in both Group 1 and Group 2\. Each UE
establishes the PDU Session (dotted line) towards the Private DNN
corresponding to its group. The real group traffic (blue and red line) goes
between UPFs selected for the group, under the control of the SMF or App
Server, without going to the DN.
Editor\'s note: It is for FFS how the 5GLAN group communication traffic can be
routed/switched within 3GPP core network (e.g. between multiple UPFs). and
what is the required functionality in the UPFs in case of 5GLAN service of
Ethernet type and IP type.
Editor\'s note: The impact of this solution on the 5GS architecture is FFS.
### 6.14.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
#### 6.14.2.1 Private DNN creation and configuration
The Private DNN, as the identifier of a 5GLAN group, can be dynamically
created along with the 5GLAN group itself.
It is assumed that a Group Management Function, as introduced in Solution 15,
may interact with the group administrator to handle the group creation and
other group management functions. The initiator of the 5GLAN group creation,
e.g. the group administrator, can choose or specify a P-DNN for the 5GLAN
group in creation. The syntax of P-DNN may follow the general syntax of
ordinary DNN but may bear some special labels that indicate its \"private
group\" nature and the organization that own it. For example,
\"department-1.enterprise-a.pvn\" may specify a P-DNN for a 5GLAN group of
\"enterprise-a\".
NOTE: The details of group management procedures (e.g. group creation) is not
in the scope of this study.
When a 5GLAN capable UE Registers with the network, it should indicate its
5GLAN capability in Registration Request. The serving AMF determines that the
UE belongs to one or more 5GLAN groups based on the P-DNN configurations in
the subscription data. The AMF may further determine whether those 5GLAN
services are allowed based on location configurations or policies (e.g. the
area restriction configuration for the 5GLAN groups). The AMF may also
initiate the 5GLAN group authentication/authorization procedure for the UE,
and receives other necessary group related configurations from the 5GLAN-GMF
via UDM. Finally, a list of allowed 5GLAN Groups, identified by corresponding
P-DNNs, along with the corresponding group configurations, may be returned to
the UE in the Registration Accept.
Figure 6.14.2-2 illustrates the high-level procedure how a 5GLAN capable UE
may discover its allowed 5GLAN groups and receives the corresponding group
configurations.
Figure 6.14.2-2: 5GLAN group discovery and configuration through Registration
1\. The UE initiates Registration and include its 5GLAN capability in the
Registration Request message. The UE may indicate its 5GLAN capability and
optionally include a list of its pre-configured P-DNNs if available.
2\. The UE is authenticated.
3\. The serving AMF retrieves the UE subscription/context data from the UDM.
4\. The AMF recognizes that the UE belongs to one or more 5GLAN groups based
on subscription data or pre-configured P-DNNs. It further determines which
5GLAN service/groups are allowed based on local configurations.
5\. The AMF may initiate the group authentication/authorization towards the
5GLAN-GMF. It is also possible that group authentication/authorization may be
conducted at a later time after Registration completes.
6-7. The 5GLAN-GMF authenticates/authorizes the UE for the group
communication.
Editor\'s note: It is for FFS how group authentication/authorization are
carried out.
8\. The AMF also receives the corresponding group configuration parameters.
9\. The AMF returns the list of allowed 5GLAN service/groups (e.g. P-DNNs) and
corresponding configurations to the UE. The UE stores the information for
future 5GLAN group communication.
The UE may be configured with multiple P-DNNs if the UE belongs to multiple
groups. The UE may use network-provided (e.g. URSP) or locally configurated
mapping between 5GLAN service/application and P-DNN to select the target P-DNN
for selecting or establishing 5GLAN PDU Sessions when 5GLAN services are
triggered.
### 6.14.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.14.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.15 Solution #15: Basic architecture for supporting dynamic 5G LAN-type
service and 5GLAN communication
### 6.15.1 Description
This solution addresses Key Issue #4: Support of 5G LAN-type service and Key
Issue #5: Support of 5GLAN communication. It focuses on scenarios where 5G
LAN-type service is dynamically requested and proposes basic architecture for
supporting such dynamic 5G LAN-type service and 5GLAN communication.
A 5GLAN Group may be managed (i.e. created, modified, and removed) based on AF
request or UE request. A UE that belongs to the 5GLAN Group can access the 5G
LAN-type service corresponding to the 5GLAN Group. 5GLAN Groups are isolated
from each other, that is, communication between 5GLAN Groups is not supported.
Editor\'s note: It is FFS what information is provided by UE or AMF for
management of the 5GLAN Group.
The UE can access the 5G LAN-type service by establishing a PDU Session.
During establishment of the PDU Session, the UE is authenticated/authorized
for accessing the 5G LAN-type service. The 5G LAN-type service supports 5GLAN
communication within the 5GLAN Group by coordinating PDU Sessions of the UEs,
e.g. traffic routing between PDU sessions takes place within the 5GS.
Editor\'s note: It is FFS how the network identifies that the PDU Session
requested by UE is related to access to 5GLAN.
The 5GS offers the 5G LAN-type service by establishing a user plane composed
of one UPF or multiple interconnected UPFs. When the UEs within the 5GLAN
Group need to communicate with a physical LAN in the DN for some data
services, the Ethernet transport service is associated with the DN and
supports connecting the UEs to the physical LAN in the DN.
Editor\'s note: It is FFS whether for specific 5GLAN Group there is any user
plane pre-established before the first UE requests PDU Session for access to
this 5GLAN Group.
The user plane of a 5G LAN-type service has two parts, the Access UP and the
Backbone UP:
\- The Access UP contains the UP paths of PDU Sessions.
\- The Backbone UP contains UPFs and Nx connections in between, or Backbone UP
bridges the UP paths in the Access UP and the physical LAN (if it exists) in
the DN. The Nx connections in the Backbone UP are managed by the 5GC. Traffic
routing over Nx in the Backbone UP is configured at the 5G LAN-type service
level (i.e. per hop).
NOTE 1: The UPF(s) in the Backbone UP functions as a router or switch and
treats the user plane path of the PDU Session as the cable connecting the UE
to one port/interface on the router or switch.
NOTE 2: The topology of the Backbone UP is implementation specific.
Editor\'s note: It is FFS what functionality needs to be supported in the UPF
for 5GLAN service of Ethernet and IP type.
The Access UP and the Backbone UP intersect at UPFs, which are PSA UPFs from
the access part point of view and BUAP (Backbone UP Access Point) UPFs from
the backbone part point of view. Figure 6.15.1-1 shows the user plane
architecture of 5GLAN communication framework.
Figure 6.15.1-1: The user plane architecture of 5GLAN communication framework
To enable 5G LAN-type service, the 5GC is enhanced with the following
functions/functionalities in the control plane:
\- Group Management Function (GMF): The GMF is responsible for 5GLAN Group
management, including creating, modifying or removing a 5GLAN Group, according
to authorised request from the UE or the AF. The GMF is also responsible for
authentication/authorization of UEs for accessing 5G LAN-type service.
\- Path Management Function (PMF): The PMF is **responsible for managing the
UP path to support 5GLAN communication within a 5GLAN group and to ensure
desired isolation. During the UP management, the PMF takes into account UE
location information, and DNAI information (if available). PMF retrieves the
UE PDU session information from the SMF.**
**\- SMF enhancements: Perform 5GLAN group authentication and authorization
with GMF during PDU Session establishment/modification procedure; configure
packet handling rules (e.g. packet routing & forwarding rules, packet marking
rules) in the UPF to support 5GLAN communication. SMF interacts with PMF in
order for the UP path management of 5G LAN-type service.**
Editor\'s note: It is FFS whether other new functions/functionalities are
needed.
Editor\'s note: It is FFS the signalling flows between GMF, PMF and SMF.
Editor\'s note: It is FFS the configuration for 5G LAN-type service, if any.
Editor\'s note: The role of PMF and whether it can be part of SMF are FFS.
Figure 6.15.1-2 depicts the enhanced 5GS architecture for non-roaming
scenario.
Figure 6.15.1-2: The 5G LAN-type service architecture with SBI presentation
Figure 6.15.1-3: The 5G LAN-type service architecture with PtP presentation
#### 6.15.1.1 PDU session establishment for 5G LAN-type service
After added into a 5GLAN group, a UE accesses 5G LAN-type service by
establishing a PDU Session targeting the 5GLAN group. The PDU session
establishment request message is sent from UE to the SMF, as defined in
release 15. During establishment of the PDU Session, SMF contacts the GMF in
order to authenticate and authorize the UE for accessing 5G LAN-type service
to the intended 5GLAN group. The authentication/authorization information
provided by the UE maps to the 5GLAN Group. The mapping is maintained by the
GMF as part of the 5GLAN Group context and is provisioned by an AF or a UE
during management of the 5GLAN Group (e.g. creation of the 5GLAN Group)
The SMF discovers the GMF based on local configuration, e.g. assuming a PLMN
only has one GMF, or by querying the NRF with 5GLAN group ID.
During PDU session establishment, the SMF also contacts the PMF for the sake
of user plane path establishment of the PDU session. SMF discovers the PMF
using the same approach as finding the GMF. PMF responds SMF with the UP path
selection decision for the PDU Session taking into account other PDU Sessions
accessing the 5GLAN service (if any exists). The UP path of the PDU Session
terminates at a UPF in the Backbone UP.
### 6.15.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
### 6.15.3 User plane path management for 5G LAN-type service
#### 6.15.3.1 General description
Private communication (of 5G LAN-type service) is achieved by shared anchor
UPF or by interconnecting two anchor UPFs via an Nx interface. The combination
of two anchor UPFs and the Nx interface in between is called an Nx connection.
For example, UE A establishes a PDU session targeting 5GLAN group A, and UE B
establishes another PDU session targeting the same group. The user plane of
the private communication between UE A and UE B are established by connecting
the anchor UPF of UE A\'s PDU session and that of UE B\'s PDU session, as
shown in the figure below, when the two anchor UPFs are not the same UPF:
Figure 6.15.3.1-1: The user plane path for two UEs accessing 5G LAN-type
service targeting the same 5GLAN group
Multiple Nx connections can be further interconnected for the private
communication in the same 5GLAN group, depending how many group member UEs are
involved. The overall user plane architecture figure is shown as Figure
6.15.1-1.
The user plane of a 5G LAN-type service has two parts, the Access UP and the
Backbone UP:
\- The Access UP contains the UP path of a PDU Session, of which UP paths
terminates at an anchor UPF but not to a DN.
\- The Backbone UP includes one or multiple Nx connections which bridges the
UP paths in the Access UP with each other. The Nx connections in the Backbone
UP are managed by the 5GC. Traffic routing over Nx in the Backbone UP is
configured at the 5G LAN-type service level (i.e. per hop).
NOTE 1: The UPF(s) bridged by Backbone UP functions as a router or switch and
treats the user plane path of the PDU Session as the cable connecting the UE
to one port/interface on the router or switch.
NOTE 2: The topology of the Backbone UP is implementation specific. It is
limited by, but not necessarily identical to the physical interconnectivity of
the comprising UPFs.
NOTE 3: Depending on implement and operator\'s configuration, the Backbone UP
(i.e. comprising UPFs and Nx connections in between) can be pre-established
before the UE requests PDU Session for access to the 5G LAN-type service and
updated afterward.
The Nx connections in the Backbone UP support IP traffic and/or Ethernet
traffic and are managed by the 5GC. An Nx connection does not belong to a
specific PDU Session; it is a per 5GLAN Group connection, shared by multiple
PDU Sessions for support of traffic routing between those Sessions.
Editor\'s note: It is FFS what functionality needs to be supported in the UPF
for 5GLAN service of Ethernet and IP type.
#### 6.15.3.2 Support of traffic routing in Backbone UP
In 5GLAN communication, traffic routing between PDU Sessions support three
types of traffic, i.e. unicast traffic, multicast traffic and broadcast
traffic. To support broadcast traffic, a UPF in the Backbone UP can be
configured to forward the traffic over a spanning, connected acyclic subgraph
of the Backbone UP. That is, the UPF forwards the traffic over every Nx
connection incidental to it except for the one that the traffic is received
from in the subgraph. In support of unicast traffic, the UPF routes the
traffic using Nx connection(s) leading to the target UE\'s PDU sessions.
Editor\'s note: It is FFS how multicast traffic is routed.
The PMF maintains all the PDU sessions of UEs accessing 5G LAN-type service to
the same 5GLAN group, including the anchor UPF of each PDU session. Therefore,
SMF connects with PMF to receive the information of the anchor UPF of another
PDU session.
Upon detection of traffic destined to an unknown unicast address from the UE,
the source PSA reports the unknown address to the SMF. SMF subscribes to PMF
by providing the unknown address.
PMF may immediately respond to SMF with the anchor UPF address, of which the
PDU session correlates with the unknown address. PMF may defer the response
until the PDU session correlates with the unknown address is established some
time later.
The SMF notifies the source PSA with the address of target PSA UPF.
#### 6.15.3.3 Correlate the UE PDU sessions that access to the same 5G LAN-
type service
UPF can support more than one 5G LAN-type services. To enable 5GLAN
communication and isolation for **respective** 5G LAN-type service, i.e.,
traffic routing between UE PDU Sessions accessing to the same 5G LAN-type
service, the **UPF shall** associate the traffic from the path of PDU Session
to **packet** **handling** rules of the corresponding 5G LAN-type service
e.g., based on VLAN Tag, UE address, session tunnel information, the
**packet** **handling** rules are used to route the traffic to the correct UP
path based on target address within the Backbone UP of the 5G LAN-type
service.
When the SMF identifies that the UE PDU Session is accessing to the 5G LAN-
type service, in order to bind the UE PDU Session to the 5G LAN-type service
the SMF shall **configure packet handling rules for the** 5G LAN-type service
and the UE PDU Session **in the UPF** to enable traffic differentiation for
proper handling (e.g. marking, steering). 5G LAN-type service can span over
wide area mobile network, the 5G network shall coordinate UE PDU sessions that
access to the same 5G LAN-type service in the cases illustrated in figure
6.15.4.3-1. In these cases, the **packet handling rules for the 5G LAN-type
service and related PDU Sessions, if required, the Nx connection are used to**
connect two or more PDU Sessions accessing to the same 5G LAN-type service.
Figure 6.15.3.3-1: Different cases for 5GLAN communication
Case 1: Private data communication within one UPF, the only SMF **configures
the only UPF the packet handling rules for the** 5G LAN-type service and PDU
Sessions**.**
Case 2: Private data communication across UPFs managed by the same SMF, the
only SMF **configures UPF1 the packet handling rules for the** 5G LAN-type
service and the PDU Sessions anchored at UPF1**, while configures UPF2 the
packet handling rules for the** 5G LAN-type service and the PDU Sessions
anchored at UPF2**.**
Case 3: Private data communication across UPFs managed by different SMFs, the
SMF1 **configures UPF1 the packet handling rules for the** 5G LAN-type service
and the PDU Sessions anchored at UPF1**, while the SMF2 configures UPF2 the
packet handling rules for the** 5G LAN-type service and the PDU Sessions
anchored at UPF2**.**
Case 4: Private data communication in case of relocating UPFs due to UE
mobility, the SMF unbinds the handover PDU Session to the 5GLAN-type service
in the UPF2 and **configures UPF1 the packet handling rules for the** 5G LAN-
type service and the handover PDU Session.
#### 6.15.3.5 Procedures
##### 6.15.3.5.1 UP path (re)selection by the PMF
Figure 6.15.3.5.1-1 depicts the procedure of (re)selection of UP path for
efficient 5GLAN communication.
Figure 6.15.4.5.1-1: Procedure of UP path (re)selection for efficient 5GLAN
communication
1\. The SMF is establishing a PDU Session for a UE to access a 5G LAN-type
service. The SMF subscribes to receive notifications of UP path (re)selection
decision for the PDU Session from the PMF. In the subscription, the SMF
provides UE location information, UE IP address, PDU Session information (e.g.
PDU Session ID), and information (e.g. PDU Session correlation information
like 5GLAN group ID etc,) in the PCC rules obtained from the PCF to the PMF.
2\. The PMF selects UP path for the PDU Session according to the SMF
subscription, UPF information, and local configuration. The UP path selection
decision takes into account other PDU Sessions that are correlated to this PDU
Session.
In this step, the PMF can determine or update the composition (e.g. UPFs)
and/or the structure (e.g. interconnection between UPFs) of the Backbone UP of
the 5G LAN-type service for efficient 5GLAN communication.
3\. The PMF (a) notifies the SMF of the UP path selection decision and (b)
(optionally) configures or reconfigures the Backbone UP of the 5G LAN-type
service. The substep (b) includes configuring Nx connection(s) and is
performed via a selected SMF; it is optional when the Backbone UP has already
been configured and there is no change to the Backbone UP introduced in the
step 2.
Editor\'s note: It is FFS how the PMF selects an SMF for the substep 3b.
4\. The SMF configures the UP path for the PDU Session according to the UP
path selection decision received from the PMF.
In this step, the SMF **configures packet handling rules in the UPF to bind
the PDU Session with the 5G LAN-type service so that the UPF can identify
traffic of the** 5G LAN-type service **for proper packet handling (e.g.
marking, steering).**
5\. The PMF receives a trigger for UP path reselection for the PDU Session.
(1) A update to the subscription in step 1, received from the SMF.
(2) A subscription to UP path (re)selection decision is created, modified or
removed for a PDU Session that is correlated to this PDU Session.
(3) Other factors, e.g. load change in UPF.
6\. The PMF reselects UP path for the PDU Session according to the trigger(s)
(and the information associated with the trigger(s)). The UP path selection
decision takes into account other PDU Sessions that are correlated to this PDU
Session.
In this step, the PMF can update the composition (e.g. UPFs) and/or the
structure (e.g. interconnection between UPFs) of the Backbone UP of the 5G
LAN-type service for efficient 5GLAN communication..
7\. The PMF (a) notifies the SMF of the UP path reselection decision for the
PDU Session and (b) (optionally) reconfigures the Backbone UP. The substep (b)
includes configuring Nx connection(s) and is performed via a selected SMF; it
is optional if there is no change to the Backbone UP introduced in the step 6.
Editor\'s note: It is FFS how the PMF selects an SMF for the substep 7b.
8\. The SMF reconfigures the UP path for the PDU Session according to the UP
path reselection decision received from the PMF. This step happens during PDU
Session modification.
In this step, the SMF **configures packet handling rules in the UPF to bind
the PDU Session with the 5G LAN-type service** , **so that the UPF can
identify traffic of the** 5G LAN-type service **for proper handling (e.g.
marking, steering).**
9\. The SMF-1 unsubscribes from the PMF for the PDU Session when the PDU
Session is released or when the UP connection of the PDU Session is
deactivated. The subscription can trigger the PMF to perform UP path
reselection for the PDU Sessions correlated to this PDU Session.
##### 6.15.3.5.2 Address resolution
Figure 6.15.3.5.2-1 depicts the procedure of resolving an unknown network
address during user plane data forwarding in the Backbone UP to support 5GLAN
communication.
Figure 6.15.3.5.2-1: Procedure of resolving a network address during user
plane forwarding
The UPF receives UL traffic destined to a unknown network address, which may
be a unicast address pointing to one UE or a multicast address pointing to
multiple UEs. The UPF identifies the 5GLAN Group that the traffic belongs to
according to the UP tunnel information and preconfigured mapping between UP
tunnel and 5GLAN Group.
1\. The PSA UPF subscribes to receive location information of the PSA
associated with the network address for the 5GLAN Group from the PMF via the
SMF. The SMF provides information identifying the 5GLAN group and the unknown
address to PMF for this subscription.
2\. The PMF optionally responds to the PSA UPF via the SMF by including the
subscribed information in the response.
3\. When the subscribed information changes, the PMF notifies the PSA UPF via
the SMF about the change. This step may take place immediately after the PMF
receives the subscription from the PSA UPF in step 1; in this case, this step
servers as a response to the subscription, and the response in the step 2 is
optional.
5\. Using the location information of PSA, the UPF identifies the respective
Nx connection and routes the data traffic using the identified Nx connection.
6\. When the PSA UPF detects that there is no data activity associated with
the network address for the 5GLAN Group, the PSA UPF removes location
information of PSA associated with the network address from its local storage
and unsubscribes from the PMF via the SMF.
##### 6.15.3.5.3 Correlate the PDU sessions that access to the same 5G LAN-
type service
Figure 6.15.3.5.3-1 depicts the procedure of correlating the PDU sessions that
access to the same 5G LAN-type service:
Figure 6.15.3.5.3-1: Correlate the PDU sessions that access to the same 5G
LAN-type service
1\. The UE requests the PDU Session to a 5G LAN-type service.
2\. PMF manages the UP paths as described in clause 6.15.4.5.1.
3\. In order to bind the UE PDU Session to the 5G LAN-type service, the SMF
**configures packet handling rules for the** 5G LAN-type service and the UE
PDU Session **in the UPF** in the following way:
\- set the forwarding rules (UE address/VID, session tunnel information,
identifier of the 5GLAN group) for the UE PDU Session in the UPF, which
indicate the UPF to transfer the traffic from the UL path of UE PDU Session
based on the routing rules corresponding to the identifier of the 5GLAN group.
\- update the routing rules corresponding to the identifier of the 5GLAN group
in the UPF, which allow the UPF to transfer the traffic destined to the UE
address on the UE PDU Session.
4\. UPF performs routing for traffic from/to the UE PDU Session in Backbone
UP. This is described in clause 6.15.4.5.2.
### 6.15.4 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.15.5 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.16 Solution #16: Enhancements to support Deterministic Services
### 6.16.1 Description
This is a solution proposal for Key Issue #3. This solution proposes
enhancement needed to 5G System in order to support deterministic services
that require guarantee packet delivery within a \"bounded time window\".
**Implication of Deterministic services (TSN) on 5G System:**
In the strictest case where a message arrives at the 5GS guaranteed at a
defined time instance and has to be delivered at another defined time
instance, the relevant QoS parameter to support this message may be a fixed,
exact delay value (with very tight lower and upper bound around that target
delay value). Note this value can be split between UE (using a buffer) and the
rest of the 5GS in the downlink direction. A generalized view of a possible
requirement for a deterministic traffic flow is shown in Figure 6.16.1-1. In
case the arrival time is only defined within a certain time window, but the
message has to be delivered at a defined time instance, a fixed, exact delay
value cannot capture the varying delay that has to be achieved in order to
deliver the message correctly. The equivalent allowed delay (both minimum and
maximum) for the TSC system can be calculated provided that the allowed egress
jitter (e.g. size of egress time window) is equal to or larger than the
ingress jitter. If not, a maximum delay can be derived and the TSC system may
need an internal _\"hold-and-forward\"_ function (at the UPF over N6 for UL
and at the UE over N60 for DL as an option) to meet the requirements of the
egress window. In this case, the exact delay that has to be achieved by 5GS
can only be calculated after the message has been received.
Figure 6.16.1-1: Example of deterministic data flow X (TSN example) defined by
a window at both ingress (reception) and egress (transmission) side
In case the arrival time and the reception time both are defined with bounded
time windows, the 5GS can calculate the resulting delay budget window after
the message reception and may use the delay budget window for e. g. diversity,
possibly considering the multiplexing of several such message streams.
For TSN, it should be noted that above framework applies for both the link and
the bridge model. In the link model, to be recognized as a well-functioning
link there are some strict requirements for the 5GS that can be derived and
can be mapped to a similar model (jitter, delay but consistent for all data
flows). For the bridge model, configurations such as seen above are provided
directly by the configuration system, i.e. the CNC, and are specific to a
certain data flow (e.g. TSN flow).
3GPP Network needs to be able to deliver the capabilities expected by TSN
system. Following requirements have to be supported:
\- Enforcement of QoS requirements for deterministic services within a 3GPP
network. TSN is one example of deterministic services.
\- QoS profile parameters needed for deterministic services, in general (with
TSN as one example).
\- Enablers to identify whether it is TSN traffic or not.
\- Ability to properly handle TSN traffic e.g. scheduling, dropping of delayed
packets.
### 6.16.2 Main Principles
This solution has the following main components in order to meet the
requirements mentioned and deliver the capabilities expected by TSN system:
1) Exposure of 3GPP Network capabilities to applications requiring
deterministic services (e.g. TSN bridge, specifically TSN CNC)
2) Enhancements to 5GS QoS framework in order to support the capabilities
essential for deterministic services (i.e. QoS characteristics that are needed
for applications such as TSN).
3) Hold and Forward Buffer to provide deterministic and time sensitive
communication services (TSC), 5GS must have inherent means to time-gate TSC
QoS flows in terms of both ingress (defined as either N6 or N60 interfaces)
and egress (defined as either N6 or N60 interfaces) arrival and departure
times.
**Exposure of 3GPP Network capabilities:**
Following principles are proposed:
\- 3GPP network should support derivation of TSN Bridge Delay managed object
attributes (independentDelayMin/Max and dependentDelayMin/Max) for a 3GPP
Bridge based on 3GPP attributes, e.g., QoS flow packet delay budget (PDB)
values, GFBR, and the MDBV indicated in the QoS profile. Mapping of 3GPP
attributes to TSN capabilities could happen in the SMF or PCF and the exposure
of capabilities towards TSN Bridge can happen via NEF (if it is an untrusted
AF) or SMF/PCF (in case of trusted AF).
\- Once the schedules for specific TSN streams are received by the CNC and the
session is established, the 3GPP Bridge needs to be able to deliver previously
exposed QoS characteristics.
\- To overcome the time dependencies of the wireless network, it may be
beneficial to expose the 3GPP bridge\'s capabilities as a function of the
characteristics of the data flows to serve. Such characteristics should
include at least the arrival time of the messages, but could also be
conditioned on the message size, message periodicity, among other parameters.
\- When exposing the capabilities to the CNC, report worst-case performance
(e.g. maximum possible window for packet transmission).
When deterministic services such as TSN is supported, Centralized Network
Configuration (CNC), expects detailed information on the capabilities of the
underlying network including bridge latencies as defined in IEEE P802.1Qcc
[12], **before** a path for a stream is set up by TSN.
\- TSN Bridge Delay managed object contains frame length-related attributes
per tuple (ingress port, egress port, traffic class):
\- independentDelay Min/Max - incurred bridge delay independent of the frame
size (typically in ns).
\- dependentDelay Min/Max - incurred bridge delay per base volume (typically
in ps per byte).
Thus, the 3GPP network (when it acts as a bridge for the TSN system) needs to
expose the same set of parameters like regular Bridge towards CNC,
particularly, \"Bridge Delay\" managed object, independentDelay Min/Max,
dependentDelay Min/Max parameters.
Figure 6.16.2-1: Exposure of QoS capabilities towards TSN CNC
**Enhancements to 5GS QoS framework:**
**Following are the principles proposed:**
\- Introduce new QoS resource type category in order to support applications
requiring deterministic QoS. This helps differentiate the traffic and QoS
characteristics (e.g. time bound, absolute time reference, low latency) needed
for TSN type applications.
\- Introduce new 5QI for such traffic. This helps define appropriate
standardized QoS characteristics (attributes and values) for such
applications.
\- Introduce following QoS parameter as part of QoS profile in order to
support TSN traffic.
\- **Expected DelayMin** \- defines earliest possible time instant at which
the packet can arrive at the egress port relative to the arrival time of the
packet at the ingress port.
\- **_Expected DelayMax_** \-- defines latest possible time instant at which
the packet can arrive at the egress port relative to the arrival time of the
packet at the ingress port. This is similar to PDB as in 5GS QoS framework
already.Editor\'s note: additional QoS parameters needed is FFS.
**Reason for introduction of DelayMin and DelayMax parameters in to the QoS
model:**
\- The ExpectedDelayMax is needed for exposing the time duration within which
the packet is guaranteed to be available at the egress port of the 3GPP
bridge. This value can be used by the CNC to derive the maximum E2E (talker to
listener) delay that can occur during the transmission of a packet. In the
worst case, the maximum E2E delay is summation of all link delays and DelayMax
values of all bridges on the path from listener to talker. However, in some of
the bridges, that the packet pass through, the packets shall incur delay much
smaller than the DelayMax. The time windows defined at the ingress port and
egress ports offers the flexibility to transmit the packets as soon as
available. Furthermore, the time windows of different streams shall overlap,
which enables multiplexing other packets while waiting for a specific packet
to be arrived.
\- The ExpectedDelayMin defines earliest possible time instant at which the
packet can arrive at the egress port relative to the arrival time of the
packet at the ingress port. DelayMin influences the lower end of the time
window at the egress port. 5GS shall expose the DelayMin as precise as
possible so that it gives room for CNC to optimize the schedule and minimize
the E2E delay. Consider the following cases:
1) If 5GS reports Delaymin = Delaymax, then the schedule computed by CNC will
result in the worst case E2E delay.
2) If 5GS reports Delaymin \ Editor\'s note: This clause describes services and related procedures for
> the solution.
##### 6.18.1.2.1 TSN capabilities Reporting for 5GS TSN Bridge
Figure 6.18.1.2.1-1: TSN capabilities reporting for 5GS TSN Bridge
1\. Identities of 5GS virtual bridge and UPF ports could be pre-configured on
UPF based on deployment and registered to SMF. Then SMF reports those
information to AF (directly or via NEF).
2\. UPF allocates identity for UE virtual port and sends the virtual port
identity with corresponding 5GS virtual bridge identity (e.g. When UE
establishes a PDU session) to SMF. The virtual port identity is unique in the
5G virtual bridge. And SMF will register the virtual port to 5GS virtual
bridge with their identities to AF.
3\. SMF collects topology and delay time information of the 5GS virtual
bridge.
4\. SMF reports topology and delay time information to AF.
Editor\'s note: How to obtain 5GS virtual bridge related information and
report to AF is FFS.
5\. AF registers or updates the 5GS virtual bridge information to CNC.
##### 6.18.1.2.2 TSN-aware QoS profile generation
Figure 6.18.1.2.2-1: TSN-aware QoS profile generation
1\. TSN AF is responsible for the conversion between TSN traffic
characteristics/TSN QoS requirements and TSN QoS Profile.
2\. TSN AF provides TSN QoS Profile to the PCF (directly or via NEF).
3\. PCF performs feasibility check with SMF, SMF may checks further with RAN
and UPF.
Editor\'s note: Details of feasibility check of TSN QoS requirements in PCF
are FFS.
4\. If 5GS is able to fulfil the requested QoS profile from the TSN AF, PCF
indicate to TSN AF on the acceptance of the requested TSN QoS requirements. If
the 5GS is unable to fulfil the QoS profile requirements, it sends a reject
message to the TSN AF that may be relayed to the CNC.
Based on the agreed QoS profile between TSN and 5G network, PCF decides on the
related QoS policies and rules and provide that to the SMF and UE according to
the procedure specified in TS 23.502 [4] and TS 23.503 [5].
Editor\'s note: In case the requested QoS profile from TSN AF cannot be
fulfilled by the 5GS, whether the 5GS needs to propose a modified QoS profile
to TSN is FFS.
### 6.18.2 UP based QoS negotiation
#### 6.18.2.1 Description
In case Distributed model is used in TSN network, UP based QoS negotiation is
used in this solution. As as depicted in Figure 6.18.2.1-1, the network
between the AS and UPF over N6 is TSN based. The UE acts as a Listener and
receives a stream from a TSN Talker in downlink. The UPF acts as a Nearest
Bridge (network) to UE (user), which can understand the signalling protocol
used for the exchange of configuration information over the TSN user/network
interface (UNI).
Figure 6.18.2.1-1: User Plane based solution
As described in IEEE 802.1 Qcc [12], Stream Reservation Protocol (SRP) is used
to propagate configuration information throughout the network of Bridges in
the full distributed model.
When receiving an SRP message (i.e. Talker Advertise Declaration) initiated by
the Talker of a Stream, the 5GS acts as a TSN Bridge needs to update the
parameters included in the SRP message (e.g. the AccumulatedLatency value) and
triggers the resource reservation in the 3GPP network. For the update of the
AccumulatedLatency value, the PDB between the UE and the UPF which terminates
the N6 interface for the 5QI related to the Stream can be used as the worst
internal processing time of the \"5GS TSN Bridge\" between the UE and UPF for
the frame in the Stream.
To trigger the resource reservation, the UPF forwards the SRP message to the
SMF. The SMF extracts the information of the Stream from the SRP message and
provides it to the PCF as a requirements of a QoS Flow. The PCF generates PCC
rules for the QoS Flow which authorizes the PDB and MBR/GBR for the QoS Flow.
The SMF then updates the SRP message with a new AccumulatedLatency by adding
the PDB value authorized by the PCF. After successful QoS authorization, the
SMF indicates the UPF to transmit the SRP message to the UE/Listener.
After the successful configuration for the Stream, the Talker can start to
transmit the Stream to the Listener.
Editor\'s note: Whether time bound based packet delivery (e.g. 802.1Qbv) can
be supported by this user plane solution is FFS.
#### 6.18.2.2 Procedures
Based on the scenario discussed above, the TSN user/network configuration can
be supported in 3GPP network as following.
##### 6.18.2.2.1 TSN user/network configuration supported by 3GPP network
Figure 6.18.2.2.1-1 depicts the TSN user/network configuration for a DL Stream
when UPF acts as an ingress port of the \"5GS TSN Bridge\" to receive a SRP
message from the network.
Figure 6.18.2.2.1-1: TSN user/network configuration supported by 3GPP network
in DL
0\. A PDU session is established for the UE.
1\. The UPF receives a SRP message from the Talker AS. The SRP message is a
Talker Advertise Declaration defined in IEEE 802.1 Qcc [12]. The main
information carried in the message is:
\- Stream ID: a unique ID to identify the Stream.
\- DataFrameParameters: comprises the source and destination MAC addresses of
the Stream data packets and the VLAN ID.
\- UserToNetworkRequirements: specifies user requirements for the Stream, such
as latency and redundancy.
\- AccumulatedLatency: is used to determine the worst-case latency that a
Stream can encounter in its path from the Talker to a given Listener.
\- TrafficSpecification: consists of the parameters which represent the
maximum frame size and the maximum number of frames that the Talker may
transmit in one \"class measurement interval\". It is used to allocate
resources and adjust queue selection parameters in order to supply the QoS
requested by the Talker Declaration.
2\. The UPF forwards the SRP message to the SMF as indicated by the SMF.
3\. The SMF extracts the information of the Stream from the SRP message and
provides it as a QoS Flow request to the PCF.
4\. The PCF generates PCC rules for the QoS Flow/TSN Steam based on the
parameters include in the stream information described in step 1.
5\. Based on the PCC rule, the SMF will trigger PDU session modification
procedure to setup a QoS Flow for the Stream and resources between the UE and
UPF as defined in current QoS framework.
6\. The SMF sends the updated SRP message to the UPF. Before that, the SMF
updates the SRP message accordingly based on the PCC rule, by adding the PDB
as the worst internal processing time of the \"5GS TSN Bridge\" to the
AccumulatedLatency value.
NOTE: The AccumulatedLatency is related to the Stream requirements for bounded
latency. If the AccumulatedLatency for the Stream exceeds the maximum latency
from Talker to Listener(s) for a single frame of the Stream, the Stream will
be rejected by the SMF/UPF.
7\. The UPF sends the SRP message received from the SMF to the UE.
8\. The UE updates the SRP message by adding the propagation time between the
UE and the connected TSN host and sends the updated SRP message to the TSN
hose.
9\. The TSN End Station connected to the UE or co-located with the UE sends
response of the SRP message to the UE. The response of the SRP message is a
Listener Ready message defined in IEEE 802.1 Qcc [12] if the Stream
requirement can be fulfilled.
10\. The UPF forwards the response of SRP message to the next Bridge in the
TSN.
For a UL Stream, the UE acts as an ingress port of the \"5GS TSN Bridge\" to
receive a SRP message from the TSN End Station connected to the UE or co-
located with the UE. Similar TSN user/network configuration procedure will be
implemented by the 5GS.
\- The UE will forward the SRP message to the UPF and the UPF then forwards it
to the SMF as indicated by the SMF.
\- The SMF triggers the establishing a QoS Flow for the Stream and updates the
SRP message by the PDB related to the QoS Flow and sends the updated SRP
message to the UPF.
\- The UPF updates the SRP message received from the SMF by adding the
propagation time between the UPF and the next TSN Bridge, and sends the
updated SRP message to the next Bridge in the TSN.
### 6.18.3 Impacts on Existing Nodes and Functionality
> Editor\'s note: This clause captures impacts on existing 3GPP nodes and
> functional elements.
### 6.18.4 Solution Evaluation
> Editor\'s note: This clause provides an evaluation of this solution.
## 6.19 Solution #19: Time synchronization between UE and TSN
### 6.19.1 Functional Description
The architecture of time synchronization is shown as below:
{width="5.7in" height="2.5083333333333333in"}
Figure 6.19.1-1: Architecture of time synchronization
This solution is designed based on that 5GS acts as a TSN bridge.
Two pre-conditions are as follows:
1\. It is assumed UPF is synchronized with TSN GM T1, using mechanism defined
by IEEE 802.1AS.
2\. It is also assumed UE, NG-RAN, UPF are synchronized with 3GPP GM T2.
In order that UE can be synchronized with TSN GM, when the UPF receives the
gPTP message from TSN GM, it forwards the gPTP message to the UE using the PDU
session user plane.
When UPF sends gPTP packet to the downlink direction, it marks time stamps at
both PDU layer (T) and transport layer (t).
For the UL transmission, UE sends the gPTP packet to the UPF, using the
similar approach as DL packet handling.
NOTE: The transport layer can be GTP layer between UPF and RAN, and PDCP layer
between RAN and UE, which requires RAN mark the time stamp on PDCP layer using
the same value of GTP layer time stamp received from UPF.
Following figure illustrates how the interaction between UPF and UE is
achieved.
Figure 6.19-2: Solution for UE and TSN time synchronization
In order to synchronize the time between UPF and UE, they mark time stamp at
PDU layer and transport layer e.g. GTP/PDCP layer when exchanging gPTP packet
before TSN service starts.
T1, T2, T3, T4: PDU layer time stamp;
t1, t2, t3, t4: transport layer time stamp;
General IEEE 1588 mechanism applies to both GTP/PDCP and PDU layer:
\- t2-t1=offset+ms_delay
\- t4-t3=-offset+sm_delay
It is highlighted that ms_dalay cannot be assumed equal to sm_delay due to
asymmetric UL and DL transmission time within 3GPP system, e.g. caused by
packet scheduling, queuing, radio channel condition, etc.
**For** GTP/**PDCP layer:**
t2-t1=offset + ms_delay (1)
t4-t3=-offset + sm_delay (2)
(1) - (2): ms_delay - sm_delay = t2-t1-t4+t3-2*offset, (3)
Herein, offset = 0 because UE, RAN and UPF are time synchronization, based on
grandmaster T2, then:
ms_delay - sm_delay = t2-t1-t4+t3 (4);
**For PDU layer:**
T2-T1=OFFSET+ms_delay (5)
T4-T3=-OFFSET+sm_delay (6)
(5) - (6): 2*OFFSET=T2-T1-T4+T3-(ms_delay-sm_delay) (7)
**In the end, OFFSET = (T2-T1-T4+T3-(t2-t1-t4+t3))/2.**
As a summary, UE time = UE current time + OFFSET.
### 6.19.2 Impacts on existing entities and interfaces
Impacts on UPF:
\- UPF needs to mark two time stamps at two layers, one is PDU layer and the
other is GTP layer.
Impacts on NG-RAN:
\- NG-RAN moves the time stamp marked at GTP layer to the PDCP layer for the
downlink direction and vice versa for the uplink packet.
Impacts on UE:
\- UE needs to mark two time stamps at two layers, one is PDU layer and the
other is PDU layer.
\- UE needs to calculate the OFFSET of the TSN time based on the IEEE 802.1AS
approach.
## 6.20 Solution #20: Supporting service continuity between Public PLMN and
non-public network via an N3IWF-like gateway
### 6.20.1 Description
The solution addresses Key Issue #6.
Assumptions:
\- The UE is configured with non-public network credentials by the non-public
network with mechanisms outside the scope of this solution.
\- The UE is configured with PLMN credentials for access to PLMN services by
the PLMN
\- UE is authorized to use both Public PLMN and non-public network
The solution is based on the following concepts:
\- The NPN is assumed to be based on the 5GS architecture
\- The PLMN and the non-public network deploy N3IWF functionality and
configure the UE to discover the respective N3IWFs:
\- The UE discovers the PLMN or non-public network N3IWF based on the
configured information.
\- The non-public network may configure the UE with an IP address or FQDN of
the Non-public network N3IWF, and the N3IWF selection configuration defined
for the 5GS is not required.
\- The PLMN configures the UE to discover the PLMN N3IWF based on 5GS
mechanisms. e.g., for an N3IWF to be used for access from non-public networks,
the configuration may be simply an IP address or FQDN.
NOTE: Whether a PLMN deploys separate N3IWF for access via non-public networks
and non-3GPP access is a deployment decision.
\- For access to PLMN services via a non-public network, the UE obtains IP
connectivity via the non-public network, discovers an N3IWF provided by the
PLMN, and establishes connectivity to the PLMN via the N3IWF.
\- In this way, the UE is registered at the same time with both the non-public
network and the PLMN, including the scenario when NR is deployed in both the
PLMN and the non-public network.
Figure 6.20.1-1: Access to PLMN services via non-public network
\- Similarly, for access to non-public network services via a PLMN, the UE
obtains IP connectivity via the PLMN, discovers an N3IWF provided by the non-
public network, and establishes connectivity to the non-public network via the
N3IWF
\- In this way, the UE is registered at the same time with both the PLMN and
the non-public network, including the scenario when NR is deployed in both the
PLMN and the non-public network
\- The interface between the Data network and the NPN N3IWF is IP connectivity
Figure 6.20.1-2: Access to non-public network services via a PLMN
### 6.20.2 Procedures
#### 6.20.2.1 Access to PLMN Services via non-public networks
It is proposed to enable a UE to obtain 5GC services offered by an PLMN via
Non-Public Network. The UE can first obtain IP connectivity by registering
with the non-public network. Then it obtains connectivity to the 5GC in the
PLMN via an N3IWF. The Non-public network deploys a 3GPP RAT, though it is not
considered a public PLMN. The UE performs PLMN selection as part of the N3IWF
discovery as defined for untrusted non-3GPP access.
Figure 6.20.2.1-1: Registration to 5GC for MNO PLMN services over non-public
network via N3IWF
In order to register to public PLMN services via the non-public network:
1\. The UE discovers, selects and connects to a non-public network using non-
public network credentials. The UE obtains IP connectivity.
2\. The UE is provisioned with public PLMN policies for N3IWF selection and
discovers an N3IWF using the mechanisms defined for untrusted non-3GPP access.
3\. The UE registers with the 5G core network via N3IWF using the public PLMN
credentials and using the registration procedure for untrusted non-3GPP
access.
4\. The UE establishes PDU session(s) with the public PLMN\'s 5GC (or triggers
the handover to the N3IWF as described in cluse 6.20.2.3).
#### 6.20.2.2 Access to non-public network services via PLMN
It is proposed to enable a UE to obtain 5GC services offered by a Non-Public
Network via a PLMN. The UE can first obtain IP connectivity by registering
with the PLMN. Then it obtains connectivity to the 5GC in the Non-Public
Network via an N3IWF. The UE is configured by the non-public network to
discover an N3IWF (e.g. configured IP address(es), configured FQDN, etc.),
without requiring an N3IWF selection mechanism similar to the one defined for
5GS.
Figure 6.20.2.2-1: Establishing connectivity to non-public network via 5GC
Public PLMN services
In order to register to non-public network services via the public PLMN:
1\. The UE discovers, selects and connects to a PLMN using the public
credentials. The UE obtains IP connectivity.
2\. The UE is configured by the non-public network for N3IWF selection and
discovers an N3IWF using the configured information.
3\. The UE registers with the non-public network via the non-public network
N3IWF using the non-public credentials and using the registration procedure
for untrusted non-3GPP access.
4\. The UE establishes PDU session(s) with the non-public network (or triggers
the handover to the N3IWF as described in clause 6.20.2.3).
#### 6.20.2.3 Service continuity between non-public networks and PLMN
Service continuity is achieved by having a UE perform a PDU Session(s)
handover from one network to another. Note that in both cases described above,
the UE is registered in both the PLMN and the non-public network (via the PLMN
N3IWF when the UE is connected to the non-public network, and via the non-
public network N3IWF when the UE is connected via the PLMN 3GPP RAN), and both
networks have a context for the UE even though a single radio is used. This
allows the UE to remain registered in both networks even if the UE is
accessing the services of a single network and using the other one to provide
IP connectivity.
In particular:
\- for services provided by the non-public network when the UE is connected to
the PLMN via the 3GPP RAN, the PDU sessions of the non-public network are
handed over from the non-public network N3IWF to the non-public network access
as described in figure 6.20.2.3-1.
\- for services provided by the PLMN when the UE is connected to the Non-
Public Network via the 3GPP RAN (e.g. IMS voice), PDU sessions established in
the PLMN are handed over from the PLMN N3IWF to the PLMN 3GPP RAN as described
in figure 6.20.2.3-2.
\- both may happen in parallel. When moving from PLMN 3GPP RAN to non-public
network 3GPP RAN, non-public PDU sessions are handed over from non-public
network N3IWF to the non-public network 3GPP RAN, and PLMN PDU sessions are
handed over from the PLMN 3GPP RAN to a PLMN N3IWF connected via the non-
public network 3GPP RAN. When moving from Non-Public Network 3GPP RAN to PLMN
3GPP RAN, PLMN PDU sessions are handed over from PLMN N3IWF to the PLMN 3GPP
RAN, and Non-Public Network PDU sessions are handed over from the Non-Public
Network 3GPP RAN to a NPN N3IWF connected over a PLMN 3GPP RAN.
NOTE 1: The following assumes a single radio UE. Potential optimizations for
UEs that can operate on two radios are not considered in the description.
Figure 6.20.2.3-1: PDU session mobility from PLMN 3GPP access to Non-public
network 3GPP access for access to non-public network services
PDU session mobility from PLMN 3GPP access to Non-public network 3GPP access
for access to non-public network services takes place as follows:
0\. The UE has a PLMN PDU Session in use to support the Nwu towards the NPN
N3IWF and to support NPN PDU Session(s). The UE may also have other PLMN PDU
Sessions. The UE is registered both with the PLMN via the PLMN 3GPP access and
the NPN via the NPN N3IWF.
1\. The UE detects the need to move to the NPN 3GPP access.
2\. The UE performs a mobility registration to the NPN over the NPN 3GPP
access with the 5G GUTI the UE was given when registering with the NPN N3IWF
and triggers mobility of NPN PDU sessions to NPN 3GPP access (from NPN N3IWF).
NOTE 2: The Nwu between the UE and the NPN N3IWF may be maintained until
expiration and not explicitely turned down.
3\. If the UE has PLMN PDU sessions that require continuity, the UE performs
block A of Figure 6.20.2.1-1 (i.e. discovers a PLMN N3IWF, triggers
registration with the PLMN N3IWF using the PLMN 5G GUTI provided when it
registered with the PLMN, and triggers mobility of the PLMN PDU sessions from
the PLMN 3GPP access to the PLMN N3IWF.
NOTE 3: The UE may need to establish a dedicated NPN PDU session for the Nwu
to the PLMN N3IWF.
Editor\'s note: It is FFS whether optimizations to establish an Nwu between
the UE and a PLMN N3IWF while the UE is connected to the PLMN 3GPP access, or
to maintain it while the UE is connected to the NPN 3GPP access, are needed in
order to speed up the PLMN PDU sessions mobility when the UE moves between the
PLMN 3GPP access and the NPN 3GPP access.
Figure 6.20.2.3-2: PDU session mobility from non-public network 3GPP access to
PLMN 3GPP access for access to PLMN network services
PDU session mobility from non-public network 3GPP access to PLMN 3GPP access
for access to PLMN network services takes place as follows:
0\. The UE has an NPN PDU Session over the NPN 3GPP access in use to support
the Nwu towards the PLMN N3IWF and to support PLMN PDU Session(s). The UE may
also have other NPN PDU Sessions. The UE is registered both with the NPN via
the NPN 3GPP access and the PLMN via the PLMN N3IWF.
1\. The UE detects the need to move to the PLMN 3GPP access.
2\. The UE performs a mobility registration to the PLMN over the PLMN 3GPP
access with the 5G GUTI the UE was given when registering with the PLMN N3IWF
over the NPN 3GPP access, and triggers mobility of PLMN PDU sessions to PLMN
3GPP access (from PLMN N3IWF).
NOTE 4: The Nwu between the UE and the PLMN N3IWF may be maintained until
expiration and not explicitely turned down.
3\. If the UE has NPN PDU sessions that require continuity, the UE performs
block B of Figure 6.20.2.2-1 (i.e. discovers an NPN N3IWF, triggers
registration with the NPN N3IWF using the 5G GUTI provided when it registered
with the NPN, and triggers mobility of the NPN PDU sessions from the NPN 3GPP
access to the NPN N3IWF.
NOTE 5: The UE may need to establish a dedicated PLMN PDU session for the Nwu
to the NPN N3IWF.
Editor\'s note: It is FFS whether optimizations to establish an Nwu between
the UE and a NPN N3IWF while the UE is connected to the NPN 3GPP access, or to
maintain it while the UE is connected to the PLMN 3GPP access, are needed in
order to speed up the NPN PDU sessions mobility when the UE moves between the
PLMN 3GPP access and the NPN 3GPP access.
### 6.20.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.20.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.21 Solution #21 -- Using Dual Radio to access Public and non-public
networks
6.21.1 Description
This solution is for key issue #6 \"Accessing PLMN services via type-a
networks and vice versa\".
The solution is based on the following concepts:
\- UE has dual radio capabilities, dual credentials and can simultaneously be
registered and in connected state in public and non-public network.
\- A dual-radio UE that is within coverage of both public and non-public
network can simultaneously use NG-RAN to access both public and non-public
services.
\- Whether the UE is able to concurrently use both Control Plane and User
Plane with both radio connections is dependent on the UE capabilities.
\- N3IWF solution is used when UE lose coverage of either the public or the
non-public network (e.g. see solution#20: \"Supporting service continuity
between Public PLMN and non-public network via an N3IWF-like gateway\" in
clause 6.20.
\- There are no dependencies between the two radio interfaces of the UE. The
PLMN/network priority list can be provisioned separately for the public and
the non-public subscriptions of the UE.
\- The solution assumes that there is no need for any coordination of radio
resources between the public and non-public networks.
6.21.2 Procedures
#### 6.21.2.1 Access to PLMN and non-public services when dual coverage
A dual-radio capable UE can when there is coverage of both PLMN and non-public
NG-RAN, register and create PDU sessions via respective networks as shown in
figure 6.21.2.1-1. Optionally the UE can register to each network using N3IWF
access. This can be done to minimize interruption time when NG-RAN access is
lost for one of the networks.
Figure 6.21.2.1-1: Access to PLMN and non-public services when dual coverage
1\. The UE registers to PLMN 5GC via PLMN NG-RAN access.
2\. The UE establish PDU session(s) via PLMN NG-RAN access for PLMN services.
3\. The UE registers to non-public 5GC via non-public NG-RAN access.
4\. The UE establish PDU session(s) via non-public NG-RAN access for non-
public services.
5\. Optionally (before or after the UE moves out of the PLMN service area) the
UE registers to non-public 5GC via N3IWF access.
6\. Optionally (before or after the UE moves out of the NPN service area) the
UE registers to PLMN 5GC via N3IWF access.
#### 6.21.2.2 Service continuity when PLMN coverage is lost
When PLMN NG-RAN coverage is lost, or signal becomes weak, a dual-radio
capable UE can initiate PDU session mobility for PLMN PDU session from NG-RAN
to N3IWF access.
Figure 6.21.2.2-1: Service continuity when PLMN coverage is lost
1\. The UE lose PLMN NG-RAN access.
2\. The UE registers to PLMN 5GC via N3IWF access (of PLMN) if not already
done.
3\. The UE performs UE-initiated PDU session mobility for PLMN PDU session(s)
to N3IWF access in PLMN 5GC.
#### 6.21.2.3 Service continuity when non-public coverage is lost
Figure 6.21.2.3-1: Service continuity when non-public coverage is lost
1\. The UE loses non-public NG-RAN access.
2\. The UE registers to non-public 5GC via N3IWF access (of non-public
network) if not already done.
3\. The UE performs UE-initiated PDU session mobility for non-public PDU
session(s) to N3IWF access in non-public 5GC.
6.21.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
6.21.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.22 Solution #22: Using PLMN connection for NPN services
### 6.22.1 Overview
Figure 1 illustrated a network model for hosting a Non-Public Network with a
PLMN infrastructure. In this model, a Non-Public Network is deployed using the
infrastructure resources of a PLMN which may be called the Host PLMN in this
document. Some RAN nodes are shared by both the NPN and the PLMN so the UEs
that are capable of both NPN and PLMN services can access both networks
through these shared RAN nodes. Besides the shared RAN nodes, the NPN may have
its dedicated network functions/resources such as dedicated AMFs, dedicated
Network Slices, etc.
Figure 6.22.1-1: Network Model of Non-Standalone Non-Public Network
The following principles are proposed for a UE capable of simultaneously
receiving both the NPN service and the PLMN service:
\- The UE has separate subscriptions for NPN and PLMN respectively. It is
possible that the NPN may trust the Host PLMN for authenticating the UE and
doesn\'t perform 3GPP-based authentication itself, so the UE may not need SUPI
and authentication data for the NPN.
\- The UE needs to be registered with the Host PLMN first before it can
register with the NPN. And the UE maintains separate Mobility Management
context for the NPN and PLMN respectively.
\- After the UE registered with the PLMN and established the NAS connection
with the PLMN AMF, it will use the same NAS connection for control plane
communications with the NPN which is served by another NPN-dedicated AMF.
Similarly, the NPN AMF doesn\'t have direct N2 connection with the serving RAN
and the NPN-related N2 procedures also need to be delegated to PLMN AMF. The
PLMN AMF will hence serve as a NAS/N2 proxy to forward NAS/N2 messages between
the NPN-dedicated AMF and the UE/RAN.
\- UE has one single RRC connection. And the serving RAN has two N2
connections with PLMN serving AMF, one for PLMN and the other for NPN.
\- When the UE in IDLE state needs to enter CONNECTED state for NPN service,
it activates the NAS connection with the PLMN AMF even it does not need PLMN
service.
\- UE uses PLMN DRX parameters for monitoring paging for both PLMN and NPN.
Paging (either for PLMN or NPN) may be differentiated by the UE identifiers or
special indications.
### 6.22.2 Procedures
Editor\'s note: This clause describes services and related procedures for the
solution.
#### 6.22.2.1 NPN Registration
Before the initial registration with NPN, the UE determines the host PLMN and
performs registration with the Host PLMN if not already registered with the
Host PLMN, upon successful initial registration with the host PLMN, the NPN
registration procedure follows as described in in Figure 6.22.2.1-1.
Figure 6.22.2.1-1: NPN Registration procedure
1\. The UE registers with the Host PLMN network and is authenticated by the
Host PLMN network;
2\. The NPN Registration is triggered by the UE. For example, the UE enters a
NPN coverage.
3\. The UE establishes RRC Connection with the RAN
4\. The UE sends a PLMN NAS message (e.g. UL NAS Transfer), which contains a
NPN NAS Registration Request, over the PLMN NAS connection to the PLMN serving
AMF. In the PLMN NAS message, the following NPN-related parameters may be
included for the PLMN serving AMF to select the NPN serving AMF: an indication
that the contained NAS message is for Non-Public Network, the identifier of
the target Non-Public Network, the UE identifier or temporary UE identifier
for the target NPN, the NPN-specific area identifier (the NPN and the PLMN may
have separate area identifier for the same shared RAN coverage), the requested
NPN-NSSAI etc.
5\. The PLMN serving AMF selects the NPN serving AMF according to the
parameters described in Step 4.
6\. The PLMN serving AMF forwards the NPN Registration Request to the
dedicated NPN AMF. It may also send some additional information that it from
the PLMN UE Context e.g. UE\'s PLMN temporary identifiers, UE\'s security
credentials/keys derived from the PLMN authentication, UE-specific DRX
parameters.
7\. Based on local policy and configuration, the NPN serving AMF may choose to
perform additional Non-3GPP-based authentication using the UE\'s NPN
identifier and credentials, or skip the 3GPP authentication but may perform
another non-3GPP based enterprise-level authentication (e.g. EAP-based
procedures)
8\. The NPN serving AMF set up a second UE context in the serving RAN. Since
the NPN serving AMF does not have the direct N2 connection with the serving
RAN, this context setup message is relayed by the PLMN serving AMF.
9\. The NPN serving AMF sends the NPN Registration result (e.g. Registration
Accept or Registration Reject) to the PLMN serving AMF. It may also indicate
whether the connection should be maintained after Registration, depending on
Follow-on flag or pending data indication in NPN Registration request.
10\. The PLMN serving PLMN forwards the NPN Registration result message in a
PLMN container NAS message (e.g. DL NAS Transfer) to the UE.
11\. The PLMN serving PLMN may release or maintain the connection according to
the indication received from the NPN serving AMF.
Editor\'s note: It is FFS how NPN PDU Sessions and user plane are established.
Editor\'s note: It is FFS how network slicing related aspects are handled.
Editor\'s note: Security aspects for NPN NAS messages and NPN user plane are
FFS.
## 6.23 Solution #23: Path-based UE to UE packet forwarding for 5GLAN Group
Communication
### 6.23.1 Overview
This solution further addresses Key Issue #5. In particular, the solution
proposes to introduce path-based UE to UE packet forwarding for 5GLAN group
communication.
A UE within a 5GLAN group can communicate over a suitable L2 or L3 network,
without the need to forward packets through an external Data Network. When a
UEs that has been configured for 5GLAN-type services registers to the network
it provides its member Id, e.g., in the form of a hash of an FQDN or a hash of
an IP address. The member ID is stored in the subscriber record within the UDM
and it can be further provided to other members of 5GLAN group during the
Registration procedure.
When a UE wants to access 5GLAN-type services, the UE requests a PDU Session
establishment providing its member ID and possibly the member ID(s) of other
5GLAN group members, e.g., in the form of a hash of an FQDN. The PMF within
the SMF registers PDU Session IDs and the member id and it allocates a L2
address associated to the member ID. In addition, if the UE has provided
member IDs for other members, the PMF (within the SMF) provides the pathID and
MAC address of the requested 5GLAN type members, if available.
Editor\'s note: It is FFS how the pathID is defined and how it is carried in
the Ethernet frame.
Fig 6.23.1-1 is an Ethernet packet format illustrating the use of the path
information to forward packets from one UE to one or more UEs.
Figure 6.23.1-1: Proposed Packet Frame Format
In this proposal, UE to UE packet forwarding is made possible through a
routing mechanism also proposed as an extension to existing solution within TR
23.734 [X] that assumes a Path Management Function, possibly part of the SMF,
capable of computing a path toward one or multiple UEs even when these UEs are
moving.
Note that the pathID and destination UE MAC address is provided to the UE upon
successful PDU Session Establishment. Therefore, the specific topology and
configuration of the Network entity is not compromised as this field is only
interpreted by the UPF which is assumed to use a bitfield forwarding
mechanism, as described in clause 6.23.2.3.
### 6.23.2 Procedures
6.23.2.1 Registration procedure
Figure 6.23.2-1: Registration Procedure
1\. During the Registration Request procedure, the UE provides 5GLAN-Type
member IDs relative to the 5GLAN the UE intends to access or its 5GLAN type
service capability. Multiple 5GLAN Groups can be managed with one or multiple
5GLAN GMFs.
2\. Existing Authentication/Security procedures are executed.
3\. AMF retrieves subscription data and verifies whether the UE is allowed to
access 5GLAN type services of the provided member IDs or if the UE provided a
5GLAN type service capability, the 5GLAN member IDs for 5GLAN network the UE
is allowed to access. The 5GLAN member ID could be used by the AMF to resolve
the relevant 5GLAN GMF.
4\. The AMF updates the 5GLAN GMF, with 5GLAN member IDs relative to 5GLANs
the UE is allowed to access.
5\. Optionally, based on operator configuration a secondary Authentication and
Authorization procedures can be executed.
6\. Upon successful 5GLAN member Registration, the 5GLAN GMF provides relevant
configuration information including Default DNN (used to established 5GLAN
type communications) and associated S-NSSAIS.
7\. The UDM is updated with the 5GLAN UE context.
8\. The AMF provides the UE with the 5GLAN member IDs that the UE allowed to
register.
#### 6.23.2.2 PDU Session Establishment procedure
##### 6.23.2.2.1 5GLAN Service-triggered PDU Session Establishment
Figure 6.23.2.2-2: 5GLAN Service-triggered PDU Session Establishment Procedure
0\. The Application that requires 5GLAN type services triggers the
establishment of a PDU Session to. The application is configured to know the
FQDN of 5GLAN group members that want to connect to (e.g., foo1.com, foo2.com
and so on). It is assume the FQDN of members the UE contacts are configured in
the UE.
1\. The UE requests the establishment of a PDU Session and it provides the
Private DNN (e.g., the one provided during the Registration Procedure and the
member IDs it wishes to connect to.
1a. The AMF passes the SM Container and it provides the 5GLAN GMF address(s).
2\. The SMF registers in the relevant 5GLAN GMF, the PDU Session to be
established and it relays the 5GLAN member IDs the UE wants to connect to.
3\. The 5GLAN GMF provides the MAC address of 5GLAN member IDs the UE is
allowed to connect to.
4\. The SMF request from the PMF relevant paths between the 5GLAN members IDs
selected in step 3 and the requesting UE.
5\. The PMF provides the pathID to each member ID in the form of a bitfield.
The UPF will use this bitfield later to route packets towards the 5GLAN
members associated to the member IDs selected in step 3. The pathID
information provided by the PMF enables the support of multicast between two
or more UEs, distributed across one or more UPFs, AS described in clause
6.23.2.3.
6\. The SMF provides, in the PDU Session Establishment accept message the MAC
addresses of the group members selected in step 3 and pathIDs from the UE to
each selected member ID.
Editor\'s note: It is FFS how the PDU procedure depicted in clause 6.23.2.2.1
is executed when PSA are controlled by more than one SMF.
Editor\'s note: It is FFS how pathID are updated when the PSA changes, e.g.,
due to mobility procedures.
Editor\'s note: The details of such how the pathID is used to provide
multicast capabilities if For Further Study.
#### 6.23.2.3 Packet Forwarding
Figure 6.23.3-1: 5GLAN Packet Forwarding
0\. UE1 has established connectivity toward another member of the 5GLAN, using
procedures described in clause 6.23.2.2.1.
1\. An application requiring 5GLAN type services wants to send data towards a
member the 5GLAN which UE has established connectivity to. e.g., foo.com.
2\. The application forwards the packet to the UE PDU layer. E.g. HTTP: GET
foo.com.
3\. UE receives the HTTP packet from the application and it constructs an
Ethernet frame to deliver this packet using the destination MAC address of UE2
and pathID, obtained during the 5GLAN PDU Session Establishment procedure as
described in clause 6.23.2.2.1.
Editor\'s note: It is FFS how the pathID is defined and how it is carried in
the Ethernet frame.
4\. The UE forwards the Ethernet frame over the PDU Session associated to the
relevant 5GLAN.
5\. The UPF1 receives the packet and uses the pathID to route the packet to
UPF2, e.g., executing a binary operation over the bitfield provided in the
pathID.
6\. UPF1 forwards the Ethernet packet over the L2 5GLAN backbone UP.
7\. Upon receipt of the Ethernet packet, UPF2 constructs the Ethernet frame
that will deliver to UE2. UPF2 uses UE2 MAC address to derive the PDU Session
where the Ethernet frame is delivered.
8\. UPF forwards the Ethernet frame over the PDU Session associated to UE2 MAC
address.
9\. UE PDU layer forwards packet to relevant application.
### 6.23.3 Impacts on Existing Nodes and Functionality
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.23.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.24 Solution #24: 5G LAN Group Management using the existing network
architecture
### 6.24.1 Description
The solution addresses key issue #4 and #5.
A proposed architecture for 5G LAN Group Communications described in the
figure 6.24.1-1.
Fig 6.24.1-1: Re-using the existing 5GS architecture with addition of
functionalities
The proposed architecture re-uses the existing Relâ€‘15 architecture with
required functional additions to support 5G LAN Communications. In this
architecture, we propose to re-use the existing functionalities of UDM, UDR,
PCF, SMF, AMF and UE.
A 5GLAN Group Communication Session is identified by a tuple of S-NSSAI and
DNN. In case of supporting VLAN tags for 5G LAN communications, it is
identified by a tuple of S-NSSAI, DNN and VLAN Tag.
The granularity of the 5G LAN service restriction is achieved by restricting
the PDU Session establishment for the tuple of S-NSSAI, DNN. In addition, the
area restriction of the 5G LAN service is done by configuring the DNN as the
LADN DNN with LADN service area (i.e. list of Tracking Areas).
The UE connects to a virtual network that connects the number of UEs within
the group as described in the Figure 6.24.1-2. In addition, it is possible to
connect a Data Network as well. Whether it can be connected to the physical DN
or not is a configuration option of the 5G LAN Group Communication Session.
{width="3.529166666666667in" height="2.786111111111111in"}
Fig 6.24.1-2: User Plane Architecture for 5G LAN Group Communication
The proposed architecture re-uses the existing Rel-15 user plane architecture
with required functional additions to support 5G LAN Communications. In this
architecture, we propose to re-use the existing functionalities of SMF, UPF
(i.e. PSA-UPF and I-UPF). This solution assumes there is one SMF for a 5G LAN
Communication Session.
Editor\'s note: It is FFS how to support the case PDU sessions targeting the
same 5GLAN group communication are not handled by the same SMF.
PSA-UPF is traversing every 5G LAN communication packets. PSA-UPF is
responsible for enforcement of group AMBR, Group Quota as well as individual
UE\'s AMBR or QoS enforcement. PSA-UPF can be functionally collocated with
I-UPF. The SMF checks the total number of established and activated PDU
Sessions.
For the subscriber group management, it re-uses the UE group as defined as a
list of the subscription list in Table 5.2.3.3.1-2: Group Subscription data
types of TS 23.502 [4] with additional fields i.e. \"Group Type\" and \"Domain
Identifier\".
Table 6.24.1-1: Group Subscription Data
+----------------+----------------+----------------+----------------+ | Subscription | Field | Description | Comment | | data type | | | | +----------------+----------------+----------------+----------------+ | Group | External Group | Identifies | Existing | | Subscription | Identifier | external group | attributed in | | Data | | of UEs that | Table | | | | the UE belongs | 5.2.3.3.1-2 of | | | | to as defined | TS | | | | in | 23.502 [4]. | | | | TS | | | | | 23.682 [17]. | | +----------------+----------------+----------------+----------------+ | | (Optional) | Identifies | | | | Internal Group | internal group | | | | Identifier | of UEs that | | | | | the UE belongs | | | | | to as defined | | | | | in | | | | | TS | | | | | 23.501 [3]. | | +----------------+----------------+----------------+----------------+ | | SUPI list | Corresponding | | | | | SUPI list for | | | | | input External | | | | | Group | | | | | Identifier. | | +----------------+----------------+----------------+----------------+ | | Group Type | Indicates the | Proposed in | | | | usage of the | this solution | | | | Group. For | | | | | example, a | | | | | value of this | | | | | field can be | | | | | \"5GLAN User | | | | | Group\" or | | | | | \"5GLAN Admin | | | | | Group\". | | +----------------+----------------+----------------+----------------+ | | Domain | Identifies a | Proposed in | | | Identifier | logical | this solution | | | | administrative | | | | | area. | | | | | | | | | | A member of | | | | | the admin | | | | | group can | | | | | manage the | | | | | user groups | | | | | and their | | | | | membership | | | | | within the | | | | | domain. | | +----------------+----------------+----------------+----------------+
Editor\'s note: It is FFS whether the details of group management (e.g. group
type and domain identifier) are beyond the scope of this study.
An admin user (i.e. a UE which belongs to the 5GLAN Admin Group) is able to
request the addition/deletion of the 5GLAN User Group and add (or delete) a
member to the 5GLAN User Group.
An UE can belong to a limited number of groups and the subscription data for
the UE in UDR associates the subscriber with groups. An Internal-Group
Identifier in UDR identifies a group.
A group management can be defined as a management functionality on
manipulating the UDR records. For example, creating a group with list of group
members can be implemented as creating a record of Group Subscription data
(defined in Table 5.2.3.3.1-2 of TS 23.502 [4]). In addition, adding or
deleting a member in the group also can be defined as adding or deleting the
SUPI in the Group Subscription data.
A domain is a logical administrative area within which a member of the admin
group can manage the user groups and their membership. A domain is can be used
to refer a tenant (e.g. a customer of 5G LAN service provided by the
operator). A domain is composed of a domain identifier, an admin group
identifier and multiple group identifiers where each group identifier can
identify a group as defined in Table 6.24.1-1. An example of the Domain
Subscription Data is illustrated as in the Table 6.24.1-2.
Table 6.24.1-2. Domain Subscription Data
* * *
Subscription data type Field Description Comment Domain Subscription Data
Domain Identifier Identifies a domain that consists of a admin group and one
or multiple user groups. Proposed in this solution Admin Group Identifier An
external or internal group identifier of the admin group which belongs to the
domain. A member of the group can manage (i.e. create/delete the user group or
add/delete a member of the admin/user group. Proposed in this solution List of
User Group Identifier A list of external or internal group identifiers of the
user groups that belong to the domain. Proposed in this solution
* * *
Editor\'s note: It is FFS whether the details of group management (e.g. domain
subscription data) are beyond the scope of this study.
Fig 6.24.1-3 illustrates the relationship of domain, admin group and user
group for 5G LAN group. A domain can include an admin group and multiple user
groups. A user in the admin group can manage the user group and membership of
the admin/user group in the domain and manage (i.e. provision, activate or
deactivate) the 5GLAN Communication Session. A user can belong to multiple
groups (e.g. a user 2 is a member of admin group, a member of user group A.1
and a member of user group A.2 as shown in the Figure 6.24.1-3). An admin user
in one domain is not able to manage groups in another domain.
Editor\'s note: It is FFS whether there is a need for a cross domain group
communication.
Figure 6.24.1-3: 5G LAN Domain and Group Structure
NOTE: The purpose of Figure 6.24.1-3 is to illustrate the relationship among
the 5G LAN domain, admin group and user group. In the normative phase, this
figure may not be needed in normative phase.
### 6.24.2 Procedures
In the proposed architecture, the NEF provides the set of service operations
for supporting Group Management and Group Communication Management to the AF
(i.e. admin user).
Editor\'s note: It is FFS whether provisioning aspects of 5G LAN group
membership management are beyond the scope of SA WG2.
#### 6.24.2.1 Group Communication Session Management
For the Group Communication, the NEF provides the following service operations
to the AF (i.e. admin user) for activation of the Group Communication Session
##### 6.24.2.1.1 Activation of a Group Communication Session
##### 6.24.2.1.1.1 Activation of Group Communication Session by establishing a
PDU Session {#activation-of-group-communication-session-by-establishing-a-pdu-
session .H6}
Figure 6.24.2.1.1.1-1: Activation of Group Communication Session (PDU Session
Establishment)
Editor\'s note: It is FFS whether step 1 to 3 are beyond the scope of this
study.
1\. The AF (i.e. admin subscriber) requests the NEF to activate the Group
Communication Session that is provisioned as described in the procedure in
clause 6.24.2.2. The request includes the UE identifier of the requestor with
the authorization information.
Editor\'s note: How the AF is provided with the authorization information is
defined by SA WG3.
2\. The NEF checks if the requestor is authorized to activate the Group
Communication Session.
3\. The NEF retrieves the list of the UE identifiers of the Group and updates
the UE policy for each UE in the group.
4\. The UDR notifies the PCF for updating the policy data since the PCF
subscribed the UDR on the change of the policy data.
5\. The PCF initiates the UE Policy delivery procedure. In order for the UE to
establish the PDU Session immediately after the UE policy is delivered, the
URSP may include a policy enforcement parameter that indicates the immediate
establishment of the PDU Session.
6\. After the UE receives the UE policy and if it includes the immediate
establishment of the PDU Session, the UE performs the PDU Session
Establishment procedure with the configured parameters as encoded as Route
Selection Components in the URSP rules.
##### 6.24.2.1.1.2 Activation of Group Communication Session using PDU Session
Modification {#activation-of-group-communication-session-using-pdu-session-
modification .H6}
Figure 6.24.2.1.1.2-1: Activation of Group Communication Session (using PDU
Session Modification)
Editor\'s note: It is FFS whether step 1 to 3 are beyond the scope of this
study.
1\. The AF (i.e. admin user) request the NEF to activate a Group Communication
that is provisioned as described in the procedure in clause 6.24.2.2. The
request includes the UE identifier of the requestor with the authorization
information.
Editor\'s Note: How the AF is provided with the authorization information is
defined by SA WG3.
2\. The NEF checks if the requestor is authorized to activate the Group
Communication Session.
3\. The NEF retrieves the list of the UE identifiers of the Group and updates
the UE policy for each UE in the group.
4\. The UDR notifies the PCF for updating the policy data since the PCF
subscribed the UDR on the change of the policy data.
5\. The PCF performs the SM policy control update notification procedure to
deliver the update policy information for the established session for example,
the addition of VLAG TAG.
6\. The SMF initiates the PDU Session Modification procedure to send the VLAN
TAG to the UE.
##### 6.4.2.1.1.3 PDU Session Establishment (Join procedure to the activated
Group Communication Session) {#pdu-session-establishment-join-procedure-to-
the-activated-group-communication-session .H6}
This procedure describes the joining procedure to the activated group
communication session by using the PDU Session Establishment procedure.
Figure 6.4.2.1.1.3-1: PDU Session Establishment (Join procedure to the
activated Group Communication Session)
1\. The UE initiates the PDU Session Establishment procedure to join the group
communication session with the group session identification information (e.g.
the tuple of S-NSSAI, and DNN).
2\. The AM selects the approaate the SMF using the group communication
identification information (in this example, it is a combination of S-NSSAI
and DNN)
7\. The SMF retrieves the policy information of the group communication
session that includes the Group AMBR and Group Quota information.
10a/b. The SMF selects the Group PSA-UPF and provides the group policy data to
the UPF.
10c/d. The SMF may add an I-UPF to connect the (R)AN and the Group PSA-UPF if
the (R)AN is not able to connect the N3 tunnel directly to the PSA-UPF based
on the topology.
11\. If necessary, the SMF may send the VLAN-TAG to the UE.
## 6.25 Solution #25: Support of communication between Ethernet type 5GLAN and
Ethernet network in data network
### 6.25.1 Description
The solution addresses how to support 5GLAN Group in sub key issue #4.1
(\"5GLAN Group Management\") and support communication between Ethernet type
5GLAN and Ethernet network in data network described in key issue #5
(\"Support of 5GLAN communication\"). The solution is based on the following
principles:
NOTE The UPF supports S-tag (IEEE 802.1ad) and C-tag (IEEE 802.1q).
\- One PDU Session provides access to multi 5GLAN group. S-tag and/or C-tag
for the 5GLAN group are not pre-configured on the UE and they are not
dynamically provided to the UE.
\- 5GLAN group identifier is used to identify the 5GLAN group.
\- The operator assigns the list of 5GLAN group identifiers for those UEs.
5GLAN group identifier is configured in the UDR
\- The SMF is configured by the operator to have the mapping tables for 5GLAN
group identifiers, C-tag, S-tag.
> Editor\'s note How the customer (5GLAN administrator) negotiates the
> allocation of the C-tag with the (h-SMF\'s) operator is FFS.
\- The SMF maps the list of the 5GLAN group identifiers of the UE, which is
notified through the procedures of PDU Session establishment, into the S-tag
and C-tag, and packet filter for the uplink traffic to identify each 5GLAN
group.
\- The UPF inserts S-tag and C-tag onto the traffic which is sent to N6 based
on the packet filter for the uplink traffic.
### 6.25.2 Procedures
Once the UE and the network are configured, the Ethernet type 5GLAN
communication is provided largely by using the procedures for access to
external networks as specified in TS 29.561 [10]:
\- UE wishing to connect to the 5G LAN sends a PDU Session Establishment
request to the configured DNN. This DNN is used to identify whether this PDU
session is to access to the Ethernet type 5GLAN communication.
\- During PDU Session establishment the network selects the PSA that is the
ingress point to the preconfigured Ethernet type 5GLAN communication.
\- The following steps are updated regarding PDU Session establishment as
described in Figure 4.3.2.2.1-1 TS 23.502 [4].
\- In Step 4, the UDM notifies the list of 5GLAN group identifiers for the UE
to the SMF.
\- In Step 10a, the SMF maps the list of the 5GLAN group identifiers into the
value of S-tag, C-tag and the packet filter, used by the UPF to handle the
uplink traffic. After the UPF detects the packets based on the packet filter,
the UPF inserts S-tag and C-tag onto the traffic to N6. Only when the customer
requires the C-tag, to be inserted.
### 6.25.3 Impacts on Existing Nodes and Functionality
\- UDR:
Support of list of 5GLAN group identifiers as the subscription information per
UE requesting the Ethernet type 5GLAN communication.
\- UDM:
Support of list of 5GLAN group identifiers as the subscription information per
UE requesting the Ethernet type 5GLAN communication.
\- SMF:
Support of retrieving list of 5GLAN group identifiers from UDM for the
particular UE;
Support the configuration to map the list of 5GLAN Group identifiers to S-tag,
C-tag and the packet filter and transfer them to UPF.
### 6.25.4 Solution Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.26 Solution 26: One to many communication for 5GLAN service within 5GLAN
group
### 6.26.1 Functional Description
This solution is for Key Issue 5 to address one to many data communication.
_\- How to support the one to one or one to many data communication for 5GLAN
communication service within a single 5GLAN group, the procedure to establish,
modify, and release the one to one and one to many 5GLAN communication._
In this solution, in order to support one to many communication in one group,
group specific PDU session and CN internal tunnel are established. 5GS will
support the group specific PDU Session establishment, release, modify along
with the group/group member addition or removal. SMF is responsible for group
specific PDU Session management and tunnel management. The different member in
the group can be served by the same UPF or different UPF.
NOTE: In this solution, it assumed that all the group members are managed by
the same SMF.
Editor\'s note: It is FFS how to ensure same SMF is used for all group
members.
The scenario can be illustrated in the following figure. UE-T is the
transmitter while UE-R1 and UE-R2 are the receivers, in which UE-T and UE-R1
are served by the same UPF1, UE-R are served by UPF2. The data from UE-T is
transmitted within 5GS and routed by UPFs via the group specific CN tunnel.
Figure 6.26.1: One to many communication user plane topology
The group specific PDU Session is terminated at the group member and the
serving UPF. When a group is established by one AF or one UE, a group specific
PDU Session is established for each group member who are added into the group
with the group creation. After the group creation, when a group member is
added into the group, the group specific PDU Session is established for the
new joined member. The SMF is responsible for establishing the forwarding
tunnel between the UPF serving the new joined member and the UPFs serving the
authorised transmitting members. The PDU Session for UE-T, PDU Session for
UE-R1, forwarding tunnel on N9 interface for this group, PDU Session for UE-R2
compose the group data forwarding path. UPF1 forwards the data received from
UE-T to UE-R1 and UPF2 according to group data forwarding path. If there are
multiple UPFs (i.e. more than two UPFs) on the group data forwarding path,
group forwarding tunnel will be established on each N9 interface on the group
data forwarding path. UPF(s) detects one to many communication based on the
destination address in the received data, e.g. if the destination address in
the received data is broadcast/multicast address, then UPF(s) forward the data
to the related group members.
Editor\'s note: It is FFS how to handle the case that UPF changes.
Figure 6.26.2: One to many communication group PDU Session
### 6.26.2 Procedures
#### 6.26.2.1 One to many communication PDU Session establishment procedure
This procedure describes the one to many communication PDU Session
establishment procedure. It is assumed that one group is managed by the same
SMF. The group creation and group member joining procedure is based on other
solution and not mentioned in this solution.
Figure 6.26.3: One to many communication PDU Session establishment procedure
1\. When the group is created, and group member UE-T and UE-R1 are added into
the group, and UE-T is authorised to send one to many data to the member in
the group. UE-T initiates group specific PDU Session establishment request,
including the request S-NSSAI, group information, etc.
NOTE: The group information could be e.g. group index, or group specific DNN
information or group specific application server information.
2\. After receiving the request from UE-T, SMF selects the UPF1 as the serving
UPF for the specific group and assigns addresses (e.g. multicast address) for
one to many data communication based on the S-NSSAI information and group
information.
3\. SMF sends session establishment request to UPF1, including the allocated
CN tunnel information on N3 interface. UPF1 acknowledges by sending Session
establishment response message.
4\. SMF sends PDU Session Accept to the UE-T with the addresses for one to
many data communication. In case of PDU Session Type IPv4 or IPv6 or IPv4v6,
the SMF may allocate an IP address/prefix for the PDU Session.
5\. When UE-R2 is added into the group, UE-R2 initiates PDU Session
establishment request to the SMF, incl. S-NSSAI information and group
information.
6\. SMF selects UPF2 as the serving UPF for UE-R2 and assigns same addresses
for one to many data communication based on the S-NSSAI information and group
information, and determines to establish the forwarding tunnel between UPF1
serving UE-T and the UPF2.
7\. SMF sends session establishment request to UPF2, including the allocated
CN tunnel information and the allocated addresses for one to many data
communication, the CN tunnel information includes the UPF2 address of the
tunnel between UPF1 and UPF2 and the UPF2 address of N3 tunnel. UPF2
acknowledges by sending Session establishment response message.
8\. SMF establishes group forwarding tunnel between UPF1 and UPF2, and
provides the UPF2 address of the tunnel between UPF1 and UPF2, as well as
addresses for one to many data communication to UPF1. Also, SMF associates
this forwarding tunnel, addresses for one to many data communication and PDU
Session for UE-T to group path and provides the group forwarding path to UPF1.
9\. SMF sends PDU Session Accept to UE-R2 with the addresses for one to many
data communication. In case of PDU Session Type IPv4 or IPv6 or IPv4v6, the
SMF may allocate an IP address/prefix for the PDU Session, and the
address/prefix is the group specific for UE-R2. If there is existing PDU
Session for another group for UE-R2, the existing PDU Session can be re-used
for the newly joined group, i.e. multiple groups can share one PDU Session for
the receiving member in the group.
10\. UE-T sends the group data to the UPF1, UPF 1 determines the receiving
UE-R1, UE-R2 according to the destination addresses, group paths received in
step 8 and routes the data to the tunnel corresponding to UE-R1 and UE-R2
respectively.
### 6.26.3 Impacts on existing entities and interfaces
### 6.26.4 Evaluation
## 6.27 Solution 27: Source Mobility restrictions-based solution for access
control during HO
### 6.27.1 Functional Description
This solution is for Key Issue 5 to address the following issue:
_\- How to prevent NG-RAN from handing over a UE to a non-public network if
the UE is not permitted to access non-public network?_
In this solution, NG-RAN obtains mobility restrictions information (e.g. UE
authorised network information) from core network when N2 connection is
established for the UE. The authorised network information can be non-public
network ID(s) UE is authorised to access or not authorised to access. NG-RAN
is expected to know which non-public network(s) the neighbouring NG-RAN or
neighbouring cells support based on e.g. local configuration and determines
the target network (e.g. frequencies, cells) to UE according to the received
UE mobility restrictions and the local configuration. The possible NG-RAN
behaviour can be as following.
1) NG-RAN determines the frequencies to be measured by the UE. If the non-
public network is deployed in a frequency and the UE is not authorised to
access the Type a network, then NG-RAN does not configure the frequency as the
measurement objective to the UE, and vice versa.
2) NG-RAN provides the UE a black-cell list or white-cell list, in which the
cells belong to the Type a network UE is not authorised or authorised to
access. 3) NG-RAN determines the candidate target cells from the measurement
report according to UE authorization network information and local
configuration. If the cells in the measurement report belong to non-public
network that UE is not authorised to access, NG-RAN does not treat the cells
as the candidate target cell.
NOTE: This solution applies to a non-standalone non-public network.
### 6.27.2 Procedures
Figure 6.27.2
1\. UE initiates RRC connection setup procedure.
2/2-bis. AMF provides mobility restrictions for the UE to NG-RAN. If AMF has
no UE mobility restrictions, AMF retrieves from the UDM.
4\. AMF provides UE mobility restrictions to NG-RAN, optionally, AMF can only
provide the information of the registration area.
5\. NG-RAN determines the measurement configuration, e.g. the to be measured
frequencies, the black-cell list/white-cell list, according to UE mobility
restrictions.
6\. NG-RAN provides the measurement configuration to the UE.
Editor\'s note: The assumed architecture with distribution of NPN and PLMN
entities is FFS. HO procedure(s) between NPN and PLMN is FFS.
### 6.27.3 Impacts on existing entities and interfaces
Editor\'s note: This clause captures impacts on existing 3GPP nodes and
functional elements.
### 6.27.4 Evaluation
Editor\'s note: This clause provides an evaluation of this solution.
## 6.28 Solution #28: TSN Time Synchronization Considering Multiple Clock
Domains
## 6.28.1 Introduction
This solution has been further merged with solution # 11 Option 3 to provide
one single solution in clause 6.28A.
This solution addresses key issue #3.1 System Enhancements to support Time
Sensitive Networking (TSN) and #3.2 Time synchronization with particular
consideration in supporting multiple TSN clock domain. The proposal is based
on the following observations:
\- The feature of multiple clock domains is natively supported by IEEE 1588
PTP v2 protocol with the 1-octet identifier \"domainNumber\" in PTP header. It
can be expected that certain vertical applications demands this feature. In
this sense, 3GPP should consider to develop the solution of supporting
multiple external TSN clock domains.
\- For supporting TSN synchronization, 5GS should act as a TSN-compliant
entity which could be either a transparent clock node or a boundary clock node
\- Such an entity (typically as a TSN bridge) is driven by its own internal
clock/oscillator which provides common concept of time among its different
ports. In this way, the relaying of synchronization with proper ingress/egress
timestamping as well as residence time calculation / correction are made
possible. Analogously, the 5GS as TSN-compliant logic entity should continue
to developing its internal synchronization mechanism to achieve the common
concept of time among different port at N6 and N60, which involves RAN
synchronization between UE and gNB as well as the synchronization between gNB
and UPF.
\- The requirements on the synchronization between the 5GS internal clock and
external TSN clocks in multiple domains depend on whether 5GS behave as
transparent clock node or as boundary clock node in the TSN. There are
significant differences in the complexities for supporting single clock domain
or multiple clock domains with transparent clock or boundary clock.
\- In a boundary clock node, the PTP message doesn\'t go through the node from
one port to another. Instead the TSN node need to synchronize its internal
clock to external upstream master\'s clock from a slave port and act as a
master clock to downstream slave clock. For supporting multiple clock domain,
the boundary clock node needs to maintain the mapping of its internal clock to
multiple external clocks, which needs continuous tracking and signalling of
time and frequency offsets leading to complex solution.
\- As a transparent clock, the TSN node need to measure the port-to-port delay
during which a PTP message stays in the node, which is called residence time.
It is added into the \"correctionField\" within the header of the PTP message
which travel through the node. Since only residence time is treated, there is
no extra complexity for supporting multiple clock domains
\- A transparent clock doesn\'t need to be synchronized with any external
clock and can transparently and straightforwardly support multiple external
clock domain without special design. Besides, the clock mismatch between
internal clock and external clock may no need to be treated since it only
gives negligible impact to the measurement of residence time.
Based on the above observations, we propose to focus on the transparent clock
approach for 5GS to support synchronization in multiple clock domains. The key
ideas are:
\- 5GS acts as transparent clock with independent internal clock achieving
common concept of time between UEs and UPF as well as among different UEs. In
this way, the one-way measurement and control of the E2E delay are made
possible.
\- Based on the internal synchronization, the 5GS transparently pass the
external PTP message through and makes proper correction of the PTP header\'s
\"correctionField\" with the known residence time.
## 6.28.2 Detailed Method
{width="5.731944444444444in" height="2.620138888888889in"}
Figure 6.28.2-1: 5GS as Transparent Clock
The transparent clock is a multi-port device which behaves neither as a Master
nor a Slave clock but a time-aware relay between any pair of two ports,
forwarding and correcting all PTP Messages. The correction achieved by
addition of the residence time within the relay into the \"correctionField\"
within the header of the PTP message. For the peer-to-peer transparent clock,
the relay also add the measured peer-to-peer link delay to the
\"correctionField\", which is however out of the scope of 3GPP. When 5GS
behaves as the transparent clock, there is no need to couple the 5GS internal
clock to external TSN clock. The internal clock is only needed for achieving
port-to-port determination of the residence time within the 5G logic TSN
entity while the absolute value of the internal time is generally meaning
less.
There are two possible ways of determining the residence time within a logic
transparent clock node implemented with 5GS:
\- Solution #28.1: relying on extending the 5G QoS classes to achieve a fixed
residence time between a pair of ports, which is illustrated in Figure
6.28.2-2.
This option is basically similar to Solution #17, which demands newly defined
deterministic delay QoS class including parameters of target delay, loss
tolerance and priority as well as the new setting-up procedures illustrated in
Figure 6.17.2-1.
\- Solution #28.2: Explicit signalling of ingress or egress timestamps for
measuring the residence time of each PTP message.
In this option, the complexity of defining new QoS class and its procedures
are avoided. Instead, simple signalling of a timestamp can achieve the same
goal of acquiring the residence time.
For achieving the measurement of the residence time, two basic condition needs
to be satisfied:
1\. 5GS should be internally synchronization with common concept of time,
between different UEs and/or between UE and UPF.
2\. Certain mechanism of signalling a PTP message\'s ingress or egress
timestamps within 5GS to a common place where both ingress and egress
timestamp of the PTP message are available for calculating the residence time:
{width="1.6875in" height="0.17708333333333334in"}
There are two options:
**Solution #28.2A:** Explicit signalling of the ingress time t0, which is
illustrated in Figure 6.28.2-3.
**Solution #28.2B:** Explicit signalling of a targeted egress time t1, which
is illustrated in Figure 6.28.2-4.
In this option, the maximum E2E transport delay between ingress and egress
entities should be known by the ingress entity beforehand from the PDB. The
egress time t1 should be determined on condition t1 - t0 > TT in order to
accommodate the processing delay within ingress node and egress node:
\- **Solution #28.2A:** Explicit signalling of the ingress time t~0~ , which
is illustrated in Figure 6.28.2-3.
\- **Solution #28.2B:** Explicit signalling of a targeted egress time t~1~ ,
which is illustrated in Figure 6.28.2-4.
In this option, the maximum E2E transport delay between ingress and egress
entities should be known by the ingress entity beforehand from the PDB. The
egress time t~1~ should be determined on condition t~1~ -- t~0~ > T~T~ in
order to accommodate the processing delay within ingress node and egress node.
There could be multiple methods for signalling the ingress or egress timestamp
in Solution #28.2:
\- Signalling Method 1: Directly concatenating the ingress/egress timestamp
with the original PTP message to form a PDU packet which can be delivered
between UE and UPF within a PDU session.
\- Signalling Method 2: Generating an extra PDU following the PDU carrying PTP
message.
\- Signalling Method 3: Considering to utilize the optional field of GTP
header and dedicated PDCP SDU.
\- Signalling Method 4: Utilize the reserved fields of the PTP message header
to carry the ingress/egress timestamp.
The optimal signalling method is FFS.
{width="4.220138888888889in" height="3.4069444444444446in"}
Figure 6.28.2-2: Solution #28.1: Delay correction based on the fixed residence
time within 5GS transparent clock
{width="4.220138888888889in" height="3.4402777777777778in"}
Figure 6.28.2-3: Solution #28.2A Delay correction based on the measurement of
variable residence time within 5GS transparent clock with the signalling of
ingress time t~0~
{width="4.340277777777778in" height="3.8666666666666667in"}
Figure 6.28.2-4: Solution #28.2B Delay correction based on the measurement of
variable residence time within 5GS transparent clock with the signalling of
targeted egress time t~1~
## 6.28A Solution #28A: TSN Time Synchronization Considering Multiple Clock
Domains
### 6.28A.1 Introduction
This solution is the merged solution of solution # 11 Option 3 and Solution
#28.
This solution addresses key issue #3.1 System Enhancements to support Time
Sensitive Networking (TSN) and #3.2 Time synchronization with particular
consideration in supporting multiple TSN clock domain.
According to this TR, the 5G System is integrated with the external network as
a TSN bridge. For supporting TSN time synchronization, this \"logical\" TSN
bridge shall be modelled as an IEEE 802.1AS compliant entity according to TS
22.104 [13].
The entire 5G system can be considered as an 802.1AS \"time-aware system\".
Only the network elements at the edges of the 5G system (i.e.
translator/adaptor) need to support the IEEE 802.1AS operations.
UE, gNB, UPF, translators at UE and UPF side are synchronized with 5G GM, the
5G internal system clock will keep these network elements synchronized so that
the timestamping of the gPTP event messages is done correctly. The 5G system
has to properly handle the Best Master Clock Algorithm, BMCA (in particular
handling the gPTP Announce messages) in order to set up the state of the PTP
ports and select the GM. Given the specific operation described by the
IEEE802.1AS, the actual timing operation consist in the processing of the
correction field in the sync message (as well as of the proper handling of the
peer-to-peer delay operations).
In such a model, the entire 5G system can be kept untouched, therefore there
will be minimal impact on the 5G system nodes. The translator/adaptor function
located at the edge of 5G system, can take care all 802.1AS related functions.
For example, the (g)PTP support, time stamping, BMCA can be all implemented in
the translator. The translator function can be implemented either as part of
UPF/UE, or as a stand-alone entity.
Figure 6.28A.1-1: 5G system is modelled as IEEE 802.1AS compliant time aware
system for supporting TSN time synchronization
Editor\'s note: TSC assistance information as defined in LS from RAN WG2 in
S2-1902953 and interpretation of it in TS 23.501 [3] describes TSC traffic
characteristics for use in the 5G System. It is FFS how to support and handle
TSCAI.
### 6.28A.2 Distribution of timing information
**Distribution of 5G internal clock:**
The 5G internal system clock (black clock) is made available to all nodes in
the 5G system. The UPF / UPF side translator can get 5G internal clock from
gNB via the underlying PTP compatible transport network. The 5G internal
system clock can be made available to UE / UE side translator with signalling
of time information related to absolute timing of radio frames (i.e. similar
concept for NR as using SIB broadcast or RRC unicast based methods, which is
under RAN responsibility).
**Distribution of TSN clock and time-stamping:**
For the downlink, gPTP frames from TSN working domain(s) arrive at the
UPF/translator, the UPF / translator makes an ingress timestamping (TSi) for
each gPTP message. The TSi can be carried either in the suffix or
\"correctionField\" of the gPTP message together with the original TSN timing
information.
UPF then forwards the modified gPTP message to the UE via user plane (i.e.
using the PDU session applicable for sending gPTP messages). Only one PDU
session per UE per UPF is used for sending gPTP messages regardless of how
many external TSN working domains have their clock information delivered
through a given UPF serving that UE.
A UE receives the original TSN clock timing information and the TSi and
forwards them to the UE side translator. The UE translator then makes egress
timestamping (TSe) for the gPTP messages for external TSN working domains. The
difference between TSi and TSe is considered as the residence time spent
within the 5G system for this gPTP message. The UE/translator modifies the
gPTP messages towards an end station with the original TSN timing information
and calculated residence time in the \"correctionField\" at gPTP header.
NOTE: The Link Delay from the previous TSN system (bridge or node) may be
reflected in the TSi.
For the UL transmission, UE sends the gPTP packet to the UPF, using the
similar approach as DL packet handling. This provides support for use cases
when the Time Grand Master (GM) is located at the End Station at the UE side,
e.g. a PLC controller with a GM, which is common in industrial automation
applications, an example illustration is in figure 6.28.2-1.
Figure 6.28A.2-1 Uplink Transmission example illustration
Figure 6.28A.2-2: Distribution of TSN clock and time-stamping within 5G system
Time stamping at ingress and egress point: A 5G timestamp is added when PTP
message arrives at the ingress point. The timestamp is carried either in the
suffix or \"correctionField\" of the original gPTP message. When the PTP
message is to exit the 5GS (point of egress), the UE/Translator checks
difference between the current time and the time stamp corresponding to the
point of PTP message ingress (at the UPF/Translator) and calculates the
residence time of the message in 5G.
**Signalling Method:**
The 5GS signalling method used to carry the timing information (TSN clock
information and ingress timestamping) is directly concatenating the ingress
timestamp with the original PTP message to form a PDU packet which can be
delivered between UE and UPF within a PDU session.
\- Method 1.1: Concatenation applies to each gPTP SYNC message. UE/TT filters
the message based on EtherType=gPTP and messageType=SYNC.
\- Method 1.2: Concatenation applies to each gPTP SYNC message, and Network
places these messages in a new 5G QoS flow. UE does not have to filter the
message. This 5G QoS flow does not carry any other packets.
Editor\'s note: Selection of method 1.1. and 1.2 is FFS.
### 6.28A.3 Support for multiple TSN working domains
Figure 6.28A.3-1
IEEE 802.1 AS gPTP frames from two (or more) different TSN working domains
arrive at the TSN translator/adaptor at UPF side. Each TSN working domain has
its own gPTP messages. These frames carry the gPTP multicast Ethernet
destination MAC address and a specific PTP \"domainNumber\" that indicate the
time domain they are referring to. The UPF / translator makes ingress
timestamping (TSi) for the gPTP messages of all domains. The TSi can be
carried in the suffix or correctionField of gPTP that was belonging to its own
domain.
A UE receives the original TSN clock timing information and the TSi (via gPTP
messages for both working domains) and forwards them to the UE side TSN
translator which can be implemented either as a part of UE or as a separate
entity. The UE translator then makes egress timestamping (TSe) for the gPTP
messages for every external TSN working domains. The difference between TSi
and TSe is considered as the residence time spent within the 5G system. The
UE/translator modifies the gPTP messages towards an end station with the
original TSN timing information and calculated residence time in the
\"correctionField\". An end-station can select the proper TSN timing
information based on the \"domainNumber\" in the gPTP message. Ingress and
egress time stamping of the 5G system is based on a 5G time domain provided to
gNBs from a 5G grand master (GM) clock.
The process described in \"Distribution of TSN clock and time-stamping\" is
thus repeated for each TSN working domain between a UE and the UPF it is
connected to. When a UE is connected to multiple TSN working domains via
single UPF via single PDU session, then all gPTP messages from these domains
(as described in \"Signalling Method\" for this solution) are forwarded to the
UE via the single PDU session.
The 5G RAN remains independent from the one or more TSN working time domains.
The solution is independent from the number of working time domains that are
supported. This solution is compliant with IEEE 802.1AS, according to which it
appears as a \"time-aware system\".
The solution can support both TS 22.104 [13] required cases through
application layer (\"application merge\" and \"application separate\"). The
end station receives gPTP messages for both working domains, then it can
select \"domainNumber\" based on application decision.
## 6.29 Solution #29: Unified architecture for 5G LAN-type service
### 6.29.1 Functional Description
#### 6.29.1.1 General description
5G LAN-type service is provided by the 5G system based on the architecture
defined in rel-15, with the additional enhancement:
For the centralized user plane architecture:
\- A single SMF and a single PSA UPF is responsible for all the PDU Sessions
for 5GLAN group communication.
\- The SMF is responsible for managing the PDU sessions belonging to the 5GLAN
group, it includes the management for example the total number of established
and activated PDU Sessions.
\- All the traffic of participating 5GLAN group member (i.e. UE) traverses the
PSA UPF. PSA-UPF should support the enforcement of QoS per R15 QoS
architecture.
For the distributed user plane architecture, i.e. PDU sessions for 5GLAN group
communication are controlled by a single SMF, and these PDU sessions may
terminate in one or multiple UPFs:
**\- SMF enhancements: determine the traffic routing approach (e.g. local
switch, between two UPFs via Nx interface, via N6 interface); configure packet
handling rules (e.g. packet forwarding rules, packet marking rules) in the UPF
to support 5GLAN communication.**
**\- Nx interface is introduced to connect two UPF for routing traffic of
5GLAN-type service. The difference from N9 interface is, Nx interface is of a
5GLAN group granularity, which means an Nx tunnel carries the traffic
belonging to a 5GLAN group communication.**
#### 6.29.1.2 5GLAN group management
Void.
#### 6.29.1.3 PDU session management 5G LAN-type service
UE can access the 5G LAN-type service by establishing a PDU Session targeting
the DNN associated with the 5GLAN group. The PDU session establishment request
message (5G LAN-VN DNN, etc.) is sent from UE to the SMF, as defined in
release 15. During establishment of the PDU Session, the SMF may contact the
DN AAA in order to authenticate and authorize the UE for accessing 5G LAN-type
service to the intended 5GLAN group.
During PDU session establishment, the SMF determines the traffic routing
approach by correlating all the PDU session contexts targeting the same DNN
associated with the 5GLAN group, (**e.g. local switch, between two UPFs via Nx
interface, via N6 interface)**.
#### 6.29.1.4 Path management of 5GLAN communication
SMF stores all the PDU session contexts targeting the same DNN associated with
the 5GLAN group. SMF stores the traffic routing policy for a 5GLAN group which
is retrieved from the PCF or locally configured.
There are types of traffic routing policies of 5GLAN communication.
\- N6-based, it means all the UL/DL traffic for the 5GLAN communication is
routed to/from the DN;
\- Nx based , it means all the UL/DL traffic for the 5GLAN communication is
routed between PSA UPFs of different PDU sessions
\- Local switch: traffic routed locally by a single UPF if it is the common
PSA UPF of different sessions;
SMF generates PDU forwarding rules and provides them to the UPF.
UPF enforces local traffic switching based on extension of the Release 15
mechanisms as described in TS 23.501 [3], clause 5.6.10.2 and clause 5.8.2.5.
Alternatively, PDR and FAR provide information that may explicitly indicate
whether an uplink traffic flow is routed to the DN or to another PDU session
anchor UPF (via Nx interface) or locally routed.
The packets for different 5GLAN group may be marked with respective VLAN
tagging by UPF.
### 6.29.3 Impacts on existing entities and interfaces
SMF is enhanced to determine the traffic routing approach for 5GLAN type-
service.
Nx interfaces optionally is supported between two UPFs, in order to achieve
optimized routing for 5G LAN-type service.
Local switch is supported by UPF;
N4 interface is enhanced that SMF instructs UPF how to route the traffic for
5GLAN type-service;
### 6.29.4 Evaluation
This solution supports N6-based, Nx-based and local switch type traffic
routing of 5G LAN-type service. It provides sufficient support to address key
issue 4 and 5.
## 6.30 Solution #30
### 6.30.1 Description
The solution addresses key issue #3.1 System Enhancements to support Time
Sensitive Networking (TSN) regarding the open issues of:
1\. The mapping between QoS requirements of the TSN communication and QoS
models in the serving 5G system.
2\. The QoS framework enhancement to support deterministic QoS and fulfil the
requirements for time sensitive communication.
**Categorization of TSN related QoS information**
In this proposal, the related QoS information supporting TSN communication was
categorized into two parts:
1\. TSN QoS characteristics, which includes QoS parameters for TSN traffic
transmission, such as latency of TSN bridge, bandwidth information, and
priority level of TSN streams etc. This part of information can be mapped into
QoS parameters in 5G QoS flows.
Editor\'s note: Mapping to 3GPP 5G QoS is FFS and will be performed once which
parameters will be included agreed.
2\. TSN traffic Pattern, which includes information for TSN supporting, such
as gate control mechanism scheduling TSN traffic etc. This part of information
is identified as additional parameters for 5GS to fulfil the QoS requirement
of TSN communications, which is not included in the 5G QoS model.
**5GS support for TSN traffic scheduling**
Periodic deterministic communication is often used in factory automation
processes. Such communication has stringent requirements on timeliness and
availability of the communication service TS 22.104 [13]. Many critical
industrial applications have a need for frame delivery that is highly
predictable in terms of the time at which frame transmission will occur. Time-
aware scheduled traffic at the output the TSN bridge is an approach as defined
in IEEE 802.1 Qbv. Such traffic has certain traffic pattern, e.g. periodicity
due to the time-aware traffic scheduling. When a 5G System (5GS) is integrated
with a TSN network as a vertical bridge, if there is no proper scheduling
mechanism applied at the output of the 5GS to fulfil the TSN scheduling
requirement, the traffic coming out of the 5GS may overflow the next TSN
nodes, and hence leads to congestion losses.
Some solutions have been proposed on how to achieve deterministic
communication in 5GS. TR 23.724 [19] Solution #16 described an example of
deterministic data flow defined by a window at both ingress and egress side of
5GS. A de-jittering function deployed at the edges of the 5GS (e.g. UPF in UL,
and UE in DL) can be used to achieve deterministic communications on an end-
to-end basis as described in R2-1814992.
## 6.31 Solution #31
### 6.31.1 Description
RAN group has an ongoing email discussion on making use of the knowledge of
the traffic pattern for radio optimization, e.g. to provide the UE with proper
SPS or Configured Grants configurations. Therefore, information of the traffic
pattern such as at least periodicity and message size would be required. Also,
information on when the periodic data arrives i.e. a time reference or offset
would be helpful. If such information is not available at RAN, over-scheduling
would need to be done in order to meet the TSN traffic requirements (e.g.
latency). During such over-scheduling, the RAN could learn the traffic pattern
and reduce its over-scheduling, however, radio resources i.e. capacity would
be wasted during such a learning phase. Also, admission control for further
users would need to be done more conservatively, if the actual resource need
for current traffic is unclear. For those reasons, it would be beneficial for
RAN, if knowledge of the TSN traffic pattern, which is available at the 5G
core interacting with TSN CNC, could be provided to the RAN beforehand.
Editor\'s note: What is the periodicity in reference to, e.g. absolute time,
is FFS. How does Message size relate to MDBV defined for 5GS QoS is FFS.
It is particularly important for uplink traffic, where frequent pre-scheduling
e.g. configured grants would need to be proactively provided to the UE, in
order to meet UL latency requirements, i.e. in particular for UL scheduling,
the RAN would benefit from the traffic knowledge.
Figure 6.31.1-1: Delivery of additional TSN traffic pattern to RAN for radio
optimization (downlink)
The CNC has pre-scheduled the traffic pattern for every TSN bridge egress.
Every TSN bridge should receive the traffic pattern from the CNC and send out
the traffic according to the pre-scheduled pattern. Figure 6.31.1-1 illustrate
5GS downlink output scheduling. There are three TSN nodes. The 5GS is modelled
as TSN bridge (B), it receives \"TSN traffic pattern B\" for doing output
scheduling at UE for downlink traffic towards TSN node (c). The TSN node (A)
is the preceding node of the 5GS. The output traffic from node (A) follows
\"traffic pattern A\". CNC has both \"traffic pattern A and B\" information.
Normally, CNC only sends the relevant traffic pattern information to the
bridge who needs to use it for output scheduling, e.g. \"traffic pattern A\"
is only sent to TSN node (A). Therefore, for the output scheduling purpose,
the 5GS only needs to distribute the \"TSN traffic pattern B\" from the AF to
UE translator in downlink direction. However, in order to optimize radio
resource for TSN traffic, the gNB needs to aware the incoming TSN traffic
pattern, therefore 5GS has to request \"TSN traffic pattern A\" from the CNC,
and then forward it to gNB.
Editor\'s note: Role of UPF for TSN traffic pattern, if any, is FFS.
Figure 6.31.1-2: Delivery of additional TSN traffic pattern to RAN for radio
optimization (uplink)
Figure 6.31.1-2 shows an uplink case, where the TSN node (C) is the preceding
node to 5GS, therefore, besides the \"TSN traffic pattern B\" that is required
for 5GS output scheduling, additional \"traffic pattern C\" needs to be
delivered to gNB for radio optimization purpose.
### 6.31.2 procedure
Figure 6.31.2-1: 5GS distributes additional TSN traffic pattern to gNB for
radio optimization purpose
The delivery of TSN traffic pattern used by current node for 5GS output
scheduling has been described in Solution #30 the following procedure
describes the difference that related to deliver additional TSN traffic
pattern used by preceding node.
1\. CNC distributes the TSN QoS requirements and traffic pattern (specific for
current node) to 5G virtual bridge via TSN AF. For radio optimization purpose,
the AF can request the additional traffic pattern for the preceding node from
the CNC (e.g. triggered by CNC configuration event), i.e. when CNC sends TSN
QoS requirements and \"traffic pattern B\" to AF as part of bridge
configuration request, AF then asks CNC for additional TSN traffic pattern
information of the preceding node.
NOTE: During the 5G virtual bridge registration stage, the 5GS may indicate
the needs of traffic pattern for both current bridge and preceding node. Then
CNC may be configured to send both traffic patterns (e.g. both \"TSN traffic
pattern B\" and \"traffic pattern A\" in figure 1) to 5G bridge. However the
CNC behaviour is out of scope of 3GPP.
2\. The additional TSN traffic pattern used by preceding node are forwarded to
PCF (directly or via NEF).
3\. PCF finds suitable 5G QoS policies and rules that can fulfil the TSN QoS
characteristics (i.e. mapping TSN QoS characteristics to 5G QoS profiles).
4\. PCF triggers the PDU session modification procedure to establish a new 5G
QoS flow according to the selected QoS policies and rules. SMF configures UE,
gNB and UPF for QoS enforcement according to existing 3GPP procedure (see TS
23.501 [3], clause 5.7). Every QoS flow has a QoS flow Identifier (QFI),
therefore for every mapped TSN flows, the QFI can be used to identify the link
between TSN traffic profile and QoS flow. An example mapping can be: QFI \
5G QoS profile \ TSN QoS characteristics \ TSN traffic pattern used by
current node \ TSN traffic pattern used by preceding node.
In both uplink and downlink direction, PCF distributes the additional TSN
traffic pattern used by preceding node to RAN via SMF and AMF. The additional
TSN traffic pattern used by preceding node and associated QFI reference are
sent from SMF to RAN via N2 information using existing PDU session
establishment/modification procedure. New information element may need to be
introduced in N2 information to carry the additional TSN traffic pattern and
QFI reference. PDU session resources setup/modification procedure can be used
to carry the additional TSN information from AMF to gNB, e.g. NGAP over N2 (TS
38.413 [18]. The QFI reference is used by gNB to link the additional TSN
traffic pattern to a specific TSN flow.
5\. PCF response to TSN AF (directly or via NEF).
6\. TSN AF response to CNC.
# 7 Overall Evaluation
## 7.1 Evaluation for key issue 1 and 2
Solutions 2 address key issues 1 and 2 for non-stand-alone non-public networks
(i.e. non-public networks deployed as part of a PLMN) and specifically
satisfies the SA WG1 requirement to \"prevent a UE with a subscription to a
PLMN from automatically selecting and attaching to a non-public network it is
not authorised to select\" by enabling operators to limit cell access to a
group of UEs, e.g. the machines in a factory. As such solution 2 is an
essential system enhancement for non-public networks that are deployed as part
of a PLMN.
In addition, the deployment option when the NPN is \"offered as a slice by a
PLMN\" does not require any standardization changes i.e. existing support for
network slicing can be re-used as is with the NPN identified in the public
PLMN by one or more S-NSSAI(s) and with the following limitation: there is no
mechanism to prevent unauthorized UEs from trying to access cells that only
provides access to a non-public network that is part of a PLMN. As a result of
this, the SA WG1 expectation that \"_unauthorised UEs [...] that are not
associated with the enterprise, will not attempt to access the non-public
network, which could result in resources being used to reject that UE and
thereby not be available for the UEs of the enterprise._ \" cannot be
fulfilled if a deployment uses network slicing functionality only.
# 8 Conclusions
## 8.1 Conclusion for key issue 1 and 2
To enable stand-alone non-public networks, it is recommended to select
solution 1 as the basis for normative work.
To enable non-public networks deployed as part of a PLMN, it is recommended to
select solution 2 as the basis for normative work.
In addition, existing network slicing mechanisms already support the
deployment option when the NPN is \"offered as a slice by a PLMN\" i.e. it
does not require any standardization changes (but it could be described e.g.
in an informative annex). The NPN is identified in the public PLMN by one or
more S-NSSAI(s). In such case, the network discovery, selection and access
control applied for the public PLMN applies, and in addition the public PLMN
controls the access to the NPN S-NSSAI.
NOTE: There is no mechanism in network slicing to prevent unauthorized UEs
from trying to access or to be handed over to cells that only provides access
to a non-public network that is part of a PLMN. As a result of this, the SA
WG1 expectation that \"_unauthorised UEs [...] that are not associated with
the enterprise, will not attempt to access the non-public network, which could
result in resources being used to reject that UE and thereby not be available
for the UEs of the enterprise._ \" cannot be fulfilled if a deployment uses
network slicing functionality only.
## 8.2 Conclusion for key issue 3.1
To enable support for Time Sensitive Communication, it is recommended to
select solution 8 as the basis for normative work. It is recommended to add a
description regarding mapping of QoS flows from multiple UE(s) to backhaul
streams (e.g. TSN) in an informative Annex during the normative
phase.Enhancements to 5GS QoS framework should be considered in order to
support deterministic QoS and fulfil the requirements for time sensitive
communication. Following are some principles to be considered:
1) 5GS QoS framework is reused with enhancements, if needed, in order to
support time sensitive communication.
2) Evaluate the need for new QoS parameter(s) to support time sensitive
communication scheduled transmission in 5GS.
3) QoS requirements coming via CP/UP from TSN System should be considered.
## 8.3 Conclusion for 5G-LAN
### 8.3.1 Conclusion for Key Issue #4, #5
Solution #29 is concluded as the conclusion for key issue 4 and 5.
### 8.3.2 Conclusions for Key Issue #4.1 on 5GLAN Group Management
a) In this release it is assumed that the 5GLAN Group Management can be
configured by a network administrator (a.1) or can be managed dynamically by
AF (a.2).
For both a.1) and a.2): GPSI is used to uniquely identify the 5GLAN group
member.
For a.1) only: The Group as described in clause 5.2.3.3.1 of TS 23.502 [4] is
used to identify the 5GLAN group.
For a.2) only: For dynamic 5GLAN Group Management, the NEF shall expose a new
set of service API to manage (e.g. add/delete) 5GLAN group and 5GLAN member.
b) The 5GLAN configuration is provided by the AF to the NEF and is stored in
the UDR, by using the NEF service operations information flow procedure
described in TS 23.502 [4] clause 4.15.6.2.
c) The list of parameters in the 5GLAN configuration includes at least the PDU
session type (i.e. IP or Ethernet), DNN, S-NSSAI and GPSI of 5GLAN group
member UE (only for the case of a.2). Any additional parameters in the 5GLAN
configuration shall be determined as part of normative work.
d) Some of the 5GLAN configuration stored in the UDR, i.e. PDU session type
(i.e. IP or Ethernet), DNN and S-NSSAI is delivered to UE from the PCF using
the UE Configuration Update procedure for transparent UE Policy delivery
described in TS 23.502 [4] clause 4.2.4.3.
## 8.4 Conclusion for key issue 6 \"Accessing PLMN services via non-public
networks and vice versa\"
It is recommended to progress solution #20 for normative specifications (only
a clarification needs to be added that access to 5GC via an untrusted access
now also applies to accessing 5GC using NG-RAN).
As illustrated in solution #21, seamless service continuity between NPN and
PLMN can be achieved by dual radio support. Support for seamless service
continuity with UE supporting dual radio is assumed to not require any
specific protocol changes.
It is agreed to allow discussions for following aspects during the normative
phase:
1\. the ability to avoid dropped packets; and
2\. QoS (for the NPN signalling/data carried in PLMN PDU Session or vice
versa).
NOTE: For each of the above possible enhancements, input is required on
justification for the enhancement and the impacts to enable decisions on a way
forward.
## 8.5 Conclusion for key issue 3.2
To enable support for TSN time synchronization, the following solution and
principles are agreed for normative work:
\- Solution# 28A is adopted for time synchronization of external TSN time
domains via (g)PTP protocols between TSN translator functions at the side of
UPF and UE.
\- Whether the reference time of the TSC AI parameters, is based on the 5G GM
clock or the external TSN GM clock will be resolved in normative phase.
###### ### Annex A: TSN standard/project for consideration in TSN integration
in 5GS approach
Following listed the TSN standard/project may need to be considered, for Key
issue #3: Enablers to support Time Sensitive Networking (TSN) if the TSN
integration in 5G System approach is pursued:
\- 802.1Qbu - Frame Pre-emption;
\- 802.1Qbv - Enhancements for Scheduled Traffic;
\- 802.1Qca - IS-IS Path Control and Reservation (PCR);
\- 802.1Qch - Cyclic Queuing and Forwarding;
\- 802.1Qci - Per-Stream Filtering and Policing;
\- P802.1Qcc - Stream Reservation Protocol (SRP) Enhancements & Performance
Improvements and TSN configuration;
\- P802.1Qcr - Asynchronous Traffic Shaping (ATS);
\- P802.1AS-Rev - Timing and Synchronization - Revision.
###### ### Annex B: UE Group Management and Provisioning with Solution 24
Along with the solution 6.24, the informative procedures for group subscriber
management and provisioning procedure are describe in this Annex to help
readers understand the whole network architecture.
# B.1 Group Subscriber Management Procedures
Editor\'s note: It is FFS whether the procedure described in this clause is in
scope of SA WG2.
For the Group Management, the NEF provides the following service operations to
the AMF (i.e. admin user):
1\. Creation (or deletion) of a group.
2\. Addition (or deletion) of a member (i.e. subscriber) to (or from) the
group.
## B.1.1 Creation (or deletion) of a group by an admin subscriber
Figure B.1.1-1: Creation (or deletion) of a group by an admin subscriber
1\. The AF (i.e. the admin subscriber) requests the NEF to add (or delete) a
group. It includes the Group External Identity, list of the GPSI(s), Requestor
Identity, and Authorization Information.
2\. The NEF may record its request so that the operator allow or authorize the
request.
3\. When the operator authorize the request, the NEF proceeds to use the
UDM\'s service operations to request the UDM to create (or delete) a group
with list of UE identities.
4\. UDM uses the UDR service operations to create (or delete) a group from the
Group Records.
5\. For each UEs in the group, UDM uses the UDR service operations to add (or
delete) a Group identified by Internal/External Identifier.
## B.1.2 Addition/deletion of a member by an admin subscriber
Figure B.1.2-1: Addition (or deletion) of a member to (or from) the group by
an admin subscriber
1\. The AF (i.e. the admin subscriber) requests the NEF to add (or delete) a
member to (or from) the group. The message includes the Group External
Identity, UE identity (GPSI or SUPI), Requestor Identity, and Authorization
Information.
2\. The NEF may record its request so that the operator allow or authorize the
request.
3\. When the operator authorizes the request, the NEF proceeds to use the
UDM\'s service operations to request the UDM to add (or delete) the member to
(or from) the group.
4\. UDM uses the UDR service operations to add (or delete) a member identified
by the GPSI or SUPI from the group.
5\. For the UE, UDM uses the UDR service operations to add (or delete) the
Group identified by the Internal/External Identifier.
# B.2 Provisioning of a Group Communication Session
Editor\'s note: It is FFS whether provisioning of Group Communication Session
is scope of SA WG5.
Figure B.2-1: Provisioning of a Group Communication Session by an admin
subscriber
1\. The AF (i.e. Admin subscriber) requests the NEF to provision a Group
Communication Session with provisioning parameters. The provisioning
parameters are used by the NEF or OSS/BSS system to provision the NFs for the
Group Communication Session. For example, it may include the following
provisioning parameters for the SMF to establish the PDU Session for the Group
Communication:
\- Group Communication Identification Tuple: S-NSSAI, DNN, VLAN TAG.
\- PDU Session Type: IPv4, IPv6, IPv4v6, Ethernet or Unstructured data.
\- IP address allocation method: For IPv4, using DHCP or static IP address
allocation for group member (i.e. per UE). For IPv6, using DHCPv6 or stateless
address auto-configuration.
\- DN authorization method: No DN authorization, per UE authentication, per
group authorization (i.e. group code shared with the group).
\- PDU Session capability: Maximum number of the established PDU Session.
\- LADN indicator: Indicates whether the DNN is LADN DNN or not.
\- Geographical restriction area.
\- Service Area Restriction enforcement option: Indicates whether the PDU
Session is deactivated or released when the SMF detects that the UE is out of
the service area.
\- Group AMBR: The aggregated maximum bit rate for the Group Communication.
\- DNAI: An identifier of the UPF supporting the 5G LAN Group Communications.
2\. The NEF may record its request so that the operator allow or authorize the
request.
3a. The NEF may request the OSS/BSS to provision the appropriate NF resources
(e.g. dedicated SMF and/or UPF) with the required configuration parameters.
3b. The NEF may update the configuration parameters of the existing NF (e.g.
LADN DNN and/or LADN Service Area).
3c. The NEF may add or update the UE policy or SM/QoS policy.
4a/b. The instantiated NFs (e.g. SMF and/or UPF) may register itself to the
NRF so that other NF (e.g. AMF) may discover and select the SMF based on the
registered information (e.g. DNN, S-NSSAI, etc.).
5\. After completion of provisioning NFs, updating the NF configuration and
policy data, the NEF response the AF with the Group Communication Session
Reference Identifier (GCS Reference Id).
#