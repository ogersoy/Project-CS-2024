# Foreword
This Technical Report has been produced by the 3rd Generation Partnership
Project (3GPP).
The contents of the present document are subject to continuing work within the
TSG and may change following formal TSG approval. Should the TSG modify the
contents of the present document, it will be re-released by the TSG with an
identifying change of release date and an increase in version number as
follows:
Version x.y.z
where:
x the first digit:
1 presented to TSG for information;
2 presented to TSG for approval;
3 or greater indicates TSG approved document under change control.
y the second digit is incremented for all changes of substance, i.e. technical
enhancements, corrections, updates, etc.
z the third digit is incremented when editorial only changes have been
incorporated in the document.
# 1 Scope
The objectives of this Technical Report are to enhance the service-based
architecture used for location services in the 5G system, and corresponding
Network Functions (NFs) and procedures, to meet the service requirements
defined in, SA WG1 (e.g. TS 22.261 [2] and TS 22.071 [3]), including the
consideration of roaming and non-roaming scenarios, and access via 3GPP as
well as non-3GPP access technologies (un-trusted, and trusted in TR 23.716
[9]). Of particular consideration is how to support location services in 5GS
and EPS interworking scenarios, and in non-3GPP access and 3GPP access
interworking scenarios.
This Technical Report will need to consider related architectures and
functions developed in RAN, and implications if any.
# 2 References
The following documents contain provisions which, through reference in this
text, constitute provisions of the present document.
\- References are either specific (identified by date of publication, edition
number, version number, etc.) or non‑specific.
\- For a specific reference, subsequent revisions do not apply.
\- For a non-specific reference, the latest version applies. In the case of a
reference to a 3GPP document (including a GSM document), a non-specific
reference implicitly refers to the latest version of that document _in the
same Release as the present document_.
[1] 3GPP TR 21.905: \"Vocabulary for 3GPP Specifications\".
[2] 3GPP TS 22.261: \"Service requirements for next generation new services
and markets; Stage 1\".
[3] 3GPP TS 22.071: \"Technical Specification Group Systems Aspects; Location
Services (LCS)\".
[4] 3GPP TS 23.501: \"System Architecture for the 5G System; Stage 2\".
[5] 3GPP TS 23.502: \"Procedures for the 5G System; Stage 2\".
[6] 3GPP TS 23.271: \"Functional stage 2 description of Location Services
(LCS)\".
[7] 3GPP TS 38.305: \"NG Radio Access Network (NG-RAN); Stage 2 functional
specification of User Equipment (UE) positioning in NG-RAN\".
[8] 3GPP TR 38.913: \"Study on scenarios and requirements for next generation
access technologies\".
[9] 3GPP TR 23.716: \"Study on the Wireless and Wireline Convergence for the
5G system architecture\".
[10] 3GPP TR 22.872: \"Study on positioning use cases\".
[11] 3GPP TS 38.455: \"NR Positioning Protocol A (NRPPa)\".
[12] 3GPP TS 36.305: \"Evolved Universal Terrestrial Radio Access Network
(E-UTRAN); Stage 2 functional specification of User Equipment (UE) positioning
in E-UTRAN\".
[13] Open Mobile Alliance, OMA AD SUPL: \"Secure User Plane Location
Architecture\", (http://www.openmobilealliance.org).
[14] Open Mobile Alliance, OMA TS ULP: \"User Plane Location Protocol\",
(http://www.openmobilealliance.org).
[15] 3GPP TS 36.355: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Stage 2 LTE Positioning Protocol (LPP)\".
[16] 3GPP TR 38.801: \"Study on new radio access technology: Radio access
architecture and interfaces\".
[17] 3GPP TS 23.167: \"IP Multimedia Subsystem (IMS) emergency sessions\".
[18] 3GPP TS 29.172: \"Location Services (LCS); Evolved Packet Core (EPC) LCS
Protocol (ELP) between the Gateway Mobile Location Centre (GMLC) and the
Mobile Management Entity (MME); SLg interface\".
[19] 3GPP TS 29.518: \"5G System; Access and Mobility Management Services;
Stage 3\".
[20] 3GPP TR 23.724: \"Study on Cellular IoT support and evolution for the 5G
System\".
[21] 3GPP TS 24.501: \"Non-Access-Stratum (NAS) protocol for 5G System (5GS);
Stage 3\".
[22] 3GPP TS 36.300: \"(E-UTRAN); Overall description; Stage 2\".
[23] 3GPP TS 23.401: \"General Packet Radio Service (GPRS) enhancements for
Evolved Universal Terrestrial Radio Access Network (E-UTRAN) access\".
[24] 3GPP TR 22.804: \"Study on Communication for Automation in Vertical
Domains\".
[25] 3GPP TR 36.880: \"Evolved Universal Terrestrial Radio Access (E-UTRA);
Study on further enhancements of Minimization of Drive Tests (MDT) for
E-UTRAN\".
[26] 3GPP TS 38.413: \"NG-RAN; NG Application Protocol (NGAP)\".
[27] ETSI ES 282 004: \"Telecommunications and Internet converged Services and
Protocols for Advanced Networking (TISPAN); NGN Functional Architecture;
Network Attachment Sub-System (NASS)\".
# 3 Definitions and abbreviations
## 3.1 Definitions
For the purposes of the present document, the terms and definitions given in
TR 21.905 [1] apply.
## 3.3 Abbreviations
For the purposes of the present document, the abbreviations given in TR 21.905
[1] and the following apply.\ An abbreviation defined in the present document
takes precedence over the definition of the same abbreviation, if any, in TR
21.905 [1].
EDT Early Data Transmission
LDR Location Deferred Request
RAI Release Assistance Indication
TTFF Time to First Fix
# 4 Architectural Requirements and Assumptions
## 4.1 Architectural Requirements
The following requirements should be applicable to 5GC LCS feature:
\- The 5GC LCS architecture should incorporate flexible modular components
with open interfaces that facilitate equipment interoperability and the
architectural requirements based on evolution of service providing
capabilities.
\- The 5GC LCS architecture should be future proof e.g. should be able to
support high accuracy positioning method and low latency positioning method.
\- Support of single or hybrid positioning methods in order to determine the
normative stage-1 requirements location of user equipment (UE). Such
positioning method includes methods in NG RAN (To be specified in TS 38.305
[7]).
\- It should be possible to provide position information to location services
consumer existing within the PLMN, external to the PLMN, or in Mobile
Equipment.
\- Support for location services as per the related service requirements
defined in TS 22.261 [2] and TS 22.071 [3]).
\- 5GC should support the same location services as defined in TS 23.271 [6]
for both roaming and non-roaming UEs in a manner compatible with support for
EPS. These services comprise the following:
\- Immediate current location of a target UE using an MT-LR,
\- Deferred location of a target UE for the UE available event,
\- Periodic location of a target UE,
\- Triggered location of a target UE for the area event,
\- Triggered location of a target UE for the motion event,
\- Mobile Originated Location Request (MO-LR) for immediate current location
of a UE,
\- MO-LR for transfer of assistance data to a UE,
\- MO-LR for Transfer To Third Party (TTTP).
\- 5GC LCS architecture should be able to determine the appropriate
positioning method based on the Access Network(s) of the UE.
\- 5GC LCS architecture should be able to support location service in 5GS and
EPS interwork scenarios; and in non-3GPP access and 3GPP access interworking
scenarios while both accesses connected to 5GC.
## 4.2 Architectural Assumptions
As a basis for the underlying architectural further development work on
commercial LCS in 5GC the following assumptions for enhancements to the 5GC to
support commercial apply:
\- Positioning methods may be Access Network specific, although commonalties
should be encouraged between Access Networks;
\- The location services in the Access Network is optional through support of
the specified method(s);
\- The service based architecture defined in TS 23.501 [4] clause 4.4.4 shall
be used as a starting point for this study.
\- The POI requirements and procedures of TS 23.271 [6] pertaining to
emergency services and lawful interception shall be followed.
\- Compatibility with the location solution for regulatory services defined in
TS 23.501 [4] shall be supported with the following aspects:
\- Ability to coexist in the same PLMN with location solution for regulatory
services defined in TS 23.501 [4].
\- Ability to reuse existing positioning procedures and signalling for the N1
interface defined in TS 23.502 [5];
\- Minimize new impacts to the N2 interface and existing 5GC NFs.
# 5 Key Issues
## 5.1 Key Issue 1: Enhancement to LCS Architecture
### 5.1.1 Description
Editor\'s note: This clause provides a short description of the key issue.
The Rel‑15 LCS architecture is SBI based and should be used as base for Rel-16
study.
For 5G, new requirements have been defined for LCSs. More stringent parameter
e.g. High Accuracy Positioning services, has already been captured in TS
22.261 [2]. Hence, how to do architecture enhancement should be considered.
For this key issue the following aspects need to be studied at least:
\- whether there is new functional entities needed for (new) LCS requirements,
\- whether all existing functional entities in TS 23.271 [6] is needed,
\- How to do functionality distribution among NFs e.g. AMF, LMF, GMLC, etc.
\- How to do functionality distribution among 5GC, NG-RAN and UE.
Editor\'s note: For the eMBB, Massive IoT and URLLC scenario, related special
requirement on LCS, e.g. scalability, reliability and etc, should also be
considered when define solutions for this key issues.
Editor\'s note: Solutions to this key issue may have dependency on other key
issues.
## 5.2 Key Issue 2: Positioning via user plane transmission
### 5.2.1 Description
Positioning via user plane transmission is to transfer position signalling
between UE and network over the UE\'s established UP connection, in order to
relieve the massive load of control plane signalling. It is expected that
positioning via user plane transmission is supported by 5G system.
For this study it is assumed SUPL as user plane positioning protocol.
NOTE: This key issue will not cover the study on SUPL enhancement or
alternatives.
This key issue will study:
\- The 5GS architecture enhancement to support LCS via user plane
transmission, including the required NFs, the corresponding function
assignment;
\- The configuration and selection of PDU session used for LCS via user plane
transmission;
\- The system procedures to support LCS via user plane, including: MT-LR, MO-
LR, the assistance data transfer.
## 5.3 Key Issue 3: Support of low latency and high performance LCS
### 5.3.1 Description
Latency concerns the delay in obtaining location information for a target UE
(e.g. a location estimate). From a LCS client perspective and for on demand
location, the positioning (or location) latency would comprise the time
between sending a request for location to the 5GC and receiving a location
response from the 5GC. For periodic or triggered location, the latency would
be the time interval following a location related event (e.g. a trigger event
or periodic event) until the event and associated location information was
notified to a LCS client.
For some services and some clients, latency requirements may be quite loose.
Examples of these may include applications where a LCS client is a computer
system or other automated device and the location is not associated with an
emergency related event or an event where the safety or a person, animal or
asset is at stake. Other examples may include low priority on demand service
where a LCS client is prepared to receive a response at a later time (e.g.
such as when requesting the locations of a group of UEs).
For many other services, however, there may be strict latency requirements
ranging from perhaps a minute to millisecond level for interactive on demand
service or for triggered services. For some services, where the client is a
machine or computer system, latency requirements may be less than one second
when some critical action needs to be taken that is dependent on a high-
accuracy location result (e.g. such as in a factory or in association with
vehicles, drones and other moving objects).
SA WG1 has performed studies documented in TR 22.872 [10], TR 22.804 [24] and
TS 22.261 [2] of many user cases reliant on positioning support that
demonstrate the need for high location accuracy, high availability and low
latency. For example, in clause 7.3 of TS 22.261 [2] for user cases related to
vehicular positioning and positioning of objects in a factory, the performance
requirement is 0.5 meters error or less with an acquisition time of 500 ms and
an availability of 99.99%. In the clause 7.3, it is stated that: the 5G system
shall be able to provide the 5G positioning services with a TTFF less than 30
s and, for some 5G positioning services, shall support mechanisms to provide a
TTFF less than 10s.For all normative requirements on positioning performance,
e.g. Positioning service availability, Positioning service latency, Time to
First Fix (TTFF), please refer to TS 22.261 [2], clause 7.3.
Support of these performance requirements will depend mostly on the
positioning methods defined by RAN and on UE and network resources (e.g.
available RF bandwidth for signaling and location measurements, location
server availability and capacity and UE positioning capability, processing and
bandwidth) which will not generally be dependent on the location solution(s)
used by the 5GCN. However, the location solution(s) supported by the 5GCN
should not impede the attainment of high location performance requirements by
adding additional latency, unreliability and inaccuracy that is not strictly
necessary for an end-to-end solution. To enable this, the following objectives
should be supported.
Criteria to study solutions for low latency and high performance LCS support
include the following:
\- Ability to reduce latency to all UEs.
\- Ability to reduce latency for selected UEs (e.g. based on external client
QoS).
\- Ability to support different levels of latency (e.g. sub 1 second, 1
second-1 minute, over 1 minute).
\- Ability to support low latency LCS mechanisms defined for the NG-RAN and
UE.
\- Ability to reduce network resource usage in support of low latency.
\- Ability to support the use of all high accuracy position methods defined by
RAN which can be accessible to the 5GCN.
\- Ability to support high reliability of positioning comparable to
reliability in accessing a target UE.
\- Enable sufficiently low latency comprising signaling delay, measurement
delay.
\- Ability to support the combination of 3GPP and non-3GPP positioning
technologies to achieve performances of the 5G positioning services better
than those achieved using only 3GPP positioning technologies. Such 3GPP and
non-3GPP positioning method could be found in TS 22.261 [2].
## 5.4 Key Issue 4: Reduce overhead for repetitive non-successful privacy
verification
### 5.4.1 Description
For a UE subscribing to LCS for value added service, the user may change the
setting of the location privacy at any time.
When the UE user has temporarily disallowed location exposure in the UE, LCS
privacy verification request towards the UE will always be rejected. But the
network still need to trigger signalling to the UE for privacy verification
for subsequent LCS request. That will result in the overhead especially when
the UE in idle mode. How to reduce the overhead for repetitive non-successful
privacy verification procedure needs to be studied.
## 5.5 Key Issue 5: Slicing dependent location service
### 5.5.1 Description
5G system supports network slicing. Network slices may differ for supported
features and network functions optimizations, in which case such Network
Slices may have e.g. different S-NSSAIs with different Slice/Service Types. It
is possible location service has varied requirement according to different
slice types.
This key issue will study:
\- The architecture enhancement to support location service in different
certain slice types.
\- The system procedures for location service in different certain slice
types.
## 5.6 Key Issue 6: Scalability
### 5.6.1 Description
Scalability of location support in the 5GC concerns the ability of 5GC
location services to support all of the following:
\- Providing support for location requests for large numbers of UEs (e.g. tens
of millions).
\- Location for a high density of UEs at particular locations (e.g. tens of
thousands per square km).
\- Requests for repeated (e.g. periodic or triggered) location for some subset
of UEs.
Simplistically, the location service capacity of 5GC in any PLMN would need to
be responsive to the number of UEs being located, the average rate of
locations over all UEs and, for support dedicated to a specific area, the
density of UEs requiring location support in the area. The overall number of
UEs requiring location support may affect resources used to maintain state
information and setup and tear down location sessions; the rate of locations
may affect resources for requesting and obtaining location information and
computing or verifying locations in the network; and the density of UEs
requiring location in a particular area may affect the amount of resources
allocated to or available to the area.
Examples where large numbers of UEs could require location support would
include support for IoT UEs (e.g. tracking of packages, vehicles, pets,
children, assets, drones, etc.) and networks with a high level of location
subscription. Examples where a high density of UEs could require location
support could include factories, shopping malls, airports, sports stadiums,
convention centres, parades, theme parks, etc. Examples where repeated
locations for certain UEs could be needed could include applications for
navigation, tracking, geofencing, tourism, schools, etc.
As part of supporting scalability, 5GC location services need to avoid
bottlenecks and allow capacity to be increased by adding extra network
elements and/or expanding the capacity (resources) for existing network
elements. Criteria for evaluating support of scalability include the
following:
\- Ability to increase location capacity (number of UEs located and rate of UE
locations) in direct proportion to assigned network resources (software and
hardware).
\- Avoidance of network bottlenecks that limit how much system capacity can be
increased.
\- Ability to flexibly change resource allocation or availability to different
areas depending on demand.
\- Ability to reduce resource usage, e.g. signalling, information storage,
etc., per UE location determination.
## 5.7 Key Issue 7: Location service exposure
### 5.7.1 Description
Location service exposure is to allow the authorized external party or the
internal client (e.g. NG-RAN node) to obtain the UE location to enable their
application and services, and location service exposure needs to comply with
privacy and security regulation. It is expected that location service exposure
is supported by 5G system.
Editor\'s note: It needs to be confirmed with RAN that location reporting to
NG-RAN node is required
This key issue will study:
\- The LCS services that can be exposed by 5G system and the corresponding
service requirements, including the service type of Location Immediate Request
and Location Deferred Request;
\- The architecture enhancement for LCS service exposure, the required NF and
NF services;
\- The privacy authorization and protection;
\- The system procedures to enable each exposed location service.
\- Scenarios where UE is roaming, covering location service exposure by Home
PLMN and by Visited PLMN.
## 5.8 Key Issue 8: Support of IoT UEs
### 5.8.1 Description
Support of IoT UEs already has some requirements from SA WG1 as documented in
TS 22.261 [2] clauses 6.4.2.2 and 6.4.2.3, specifically on support of
efficient bulk operations and efficient management for IoT.
From a UE perspective, minimizing resource usage in an IoT UE for each
location determination for the UE is an obvious objective. Resource usage can
include power consumption, use of signalling and available bandwidth, use of
processing and use of memory. The lower these are, the more location service
can be provided for a UE for any given level of resource availability.
Reducing network resources to support very large numbers of IoT UEs would also
be an objective but is considered separately as part of the scalability key
issue.
A 5GC location solution that did not support these IoT objectives could make
massive IoT deployment less feasible or less attractive to subscribers.
Criteria to study support of IoT UEs include the following:
\- Ability to save UE processing, UE memory, UE signalling and UE battery
consumption for LCS.
\- Ability to allow a UE to remain idle for long periods without impacting
latency of LCS.
\- Ability to locate a massive number of UEs or grouped UEs without increasing
latency of LCS or UE resources.
\- Ability to maintain location accuracy requirements.
## 5.9 Key Issue 9: Support EUTRAN positioning methods
### 5.9.1 Description
This key issue will study:
\- For the positioning methods defined in TS 36.305 [12]), the interaction
between 5GC and EUTRA Rel‑15 and Rel‑16 connected to 5GC, for the
architectural options proposed in this study.
## 5.10 Key Issue 10: Support NR positioning methods
### 5.10.1 Description
This key issue will study:
\- For the NR positioning methods studied in RAN, the interaction between 5GC
and NR Rel‑16 connected to 5GC, for the architectural options proposed in this
study.
## 5.11 Key Issue 11: Coordination of Positioning Signalling Transmitted via
Control Plane Path and User Plane Path
### 5.11.1 Description
It is expected positioning signalling can be transmitted via CP signalling
message and UP path (i.e. OMA SUPL mechanism). In some cases, it may require
to switch the signalling transmission path from one to the other, e.g. due to
the control plane NF overload.
This key issue will study:
\- How to determine the signalling transmission path needs to be switched?
\- Impact on architecture enhancement and procedures.
## 5.12 Key Issue 12: LCS support for Non-3GPP access
### 5.12.1 Description
This key issue will study:
\- Architecture enhancement to support location services when the UE uses
non-3GPP access;
\- How the LCS system determines that the UE is accessing via the non-3GPP
access;
\- The solutions to support LCS when the UE is accessing 5GC via non-3GPP
access, including what information can be considered as the UE location, and
how the UE location can be reported;
NOTE: This use case considers un-trusted non-3GPP access first. Supporting
location services for trusted non-3GPP access and wireline access will be
further considered after the architecture for connecting trusted non-3GPP
access and wireline access to 5GC has been specified.
## 5.13 Key Issue 13: Support of Flexible and Efficient Periodic and Triggered
Location
### 5.13.1 Description
The control plane location solution in TS 23.271 [6] supports periodic and
triggered location for a target UE in the case of GERAN, UTRAN and E-UTRAN
access. However, the supported types of periodic and triggered location
correspond to only certain types of reporting events (e.g. periodic event,
area event, UE availability event, and UE motion event). While these reporting
events can support many user cases of importance to an external client (e.g.
geofencing), they do not support every user case that may of interest. For
example, some user cases could include location events based on one more of:
\- Time of day or Day of week (e.g. to periodically report a UE location only
during working hours Monday-Friday).
\- Current or previous location of a UE (e.g. to periodically report location
while a UE is in an area of interest).
\- Movement of a UE (e.g. to report location when a UE velocity or
acceleration exceeds a threshold or after the UE becomes stationary for some
period).
\- Activity of a UE (e.g. report location when a UE originates or receives a
call).
\- User triggered location (e.g. report location when a user identifies a
location of interest).
However, defining and standardizing these different events could have
significant network impact. This key issue will study:
\- Support of more flexible periodic and triggered location events.
\- Reduction of network impacts to support periodic and triggered location.
## 5.14 Key Issue 14: Positioning Access selection for LCS service
### 5.14.1 Description
The 5G Access Network comprising a NG-RAN and/or non-3GPP AN connecting to a
5GC core network. Within the NG RAN, one or more following options are
supported, e.g. standalone NR, NR is the anchor with E-UTRA extensions,
standalone E-UTRA, E-UTRA is the anchor with NR extensions. For Non-3GPP AN,
5GC supports untrusted non-3GPP access, trusted non-3GPP access and fixed
access.
When UE accesses 5GC via 3GPP access and non-3GPP access simultaneously, or
more options were deployed in NG-RAN, which radio access is used for LCS and
performing positioning should also be considered.
This key issue will study:
\- which network function selects the radio access network and/or radio access
technology for LCS and performing positioning, especially in 5GC-MT-LR
scenario;
\- how does the network function perform such selection? And based on what
kind of criteria and information, e.g. current registered access, to do the
selection?
\- Whether PCF is involved or not, if yes, how?
## 5.15 Key Issue 15: Location continuity support
### 5.15.1 Description
In LTE, clause 9.4.5 of TS 23.271 [6] defines the support for location
continuity for several mobility cases, this key issue target to study how to
support location continuity in 5GS.
This key issue will study:
\- Architecture enhancement to support the LCS continuity in 5GS.
\- Functionalities, system procedures needed to support Location Service
Continuity in following mobility cases, but not limited to, e.g.:
\- Mobility within 5GC (e.g. for change of serving AMF);
\- Mobility between EPS and 5GC, when UE uses 3GPP access and/or non-3GPP
access;
\- Mobility between 3GPP access and non-3GPP access, both access connected to
5GC.
\- Both single registration and dual registration mode should be considered.
## 5.16 Key Issue 16: Distribution Positioning Assistance Data
### 5.16.1 Description
Within the 5GS LCS system, the Positioning Calculation Function may be
provided by network with assistance data for positioning calculation purpose.
This key issue will study:
\- Architecture enhancement to support the distributing positioning assistance
data to Positioning Calculation Function, e.g. UE, LMF.
\- Supporting distribution of positioning assistance data for the 5G Rel-15
architecture option 2, 4, 5, and 7 in TR 38.801 [16] involving the 5GC.
\- Detailed procedures used to fulfil the distribution; E.g. How to distribute
the assistance data from the 5GS Positioning Assistance Data Source Function
to Positioning Calculation Functions; or How to retrieve the assistance data
from the Positioning Assistance Data Source Function.
NOTE: How 5GS Positioning Assistance Data Source Function is provided with
positioning assistance data is out of this key issue.
\- The nature of the positioning assistance data, e.g. dynamic or static,
should be considered when performing the distribution.
\- Within the 5GC LCS architecture, defining the functions of the 5GS
Positioning Assistance Data Source Function used for supporting the storing,
retrieving and distributing the assistance data.
\- Whether those assistance data should be distributed in a secured manner,
e.g. been broadcast to UE as encrypted data, and if yes, how? E.g. how to
delivery encrypting keys to receiving entity?
# 6 Solutions
Editor\'s note: This clause is intended to document the agreed architecture
solutions. Each solution should clearly describe which of the key issues it
covers and how.
## 6.1 Solution 1: 5GS LCS Functionality and Allocation to 5GS elements -
Option 1 and Option 2
### 6.1.1 Introduction
This solution addresses following key issues:
\- Key issue 1: Enhancement to LCS Architecture;
\- Key Issue 3: Support of low latency LCS;
\- Key Issue 6: Scalability;
\- Key Issue 16: Distribution Positioning Assistance Data.
Base on analysis of LCS function in clause 6.2 of TS 23.271 [6] for EPS, this
solution introduce those existing LCS functions, i.e. the same functional
groups and functional blocks into 5G.
Since elements of 5GC are different from that of EPS, this solution proposes a
kind of allocation of LCS functional entities to 5GC elements, by following:
\- In 5GC, the AMF, LMF, UDM/UDR replaces the MME, E-SMLC, HSS in EPC.
\- The PPR may be standalone entities, or the PPR functionality may be
integrated in H-GMLC.
\- The PMD may be standalone entities, or the PMD functionality may be
integrated in PPR.
\- Standalone PPR and PMD entities will provide Service Interface, e.g. Nppr
and Npmd.
\- The Le reference point remains unchanged.
This solution uses the functionality of PPR, PMD, GLMC and LRF specified in TS
23.271 [6] as base. Further enhancement will be developed and added during the
study. If solutions to other key issues identified some new functionality or
enhancements, then this solution will be updated accordingly. E.g. introduce
NEF for exposures purpose.
By leveraging network function virtualization techniques, the positioning data
could be decoupled from the control function, i.e. the location related state
data and/or positioning assistance data could be located in different data
storage functions (e.g. into UDSF and/or UDR in core network), and flexibly
link to the associated control plane functions (e.g. the AMF, LMF, and LSBcF)
with the possibility of dynamic scaling in and out of positioning component.
The functional virtualization provides the flexibility of location calculation
functions in supporting the UE positioning calculation of massive IoT devices
with low latency. The network function virtualization would support one DSF
storing UE location related states, and the other DSF storing position
assistance data. In order to reduce latency, the PCF function is included in
RAN.
This solution need further study following issues:
\- Selection of an LMF, for MO-LR and MT-LR request;
\- Determination of an AMF, for MT-LR request;
\- Location Service continuity in UE mobility case: e.g. inter-AMF handover;
\- Services that each network elements provide.
### 6.1.2 Functional Description
#### 6.1.2.1 Common Functionality
This clause documents common functionality of the 5GS to support the
commercial LCS.
Table 6.1.2.1-1 shows a summary of the Functional Groups and Functional Blocks
for Location services.
Table 6.1.2.1-1: Summary of Functional Groups and Functional Blocks for
Location services
+-------------+------------------+------------------+--------------+ | Functional\ | Functional | Full name of | Abbreviation | | Group | component | Functional Block | | +-------------+------------------+------------------+--------------+ | Loc. | Location Client | (External) | LCF | | | | Location Client | | | | | Function | | +-------------+------------------+------------------+--------------+ | Client | Component | Internal | LCF | | | | Location Client | | | | | Function | -internal | +-------------+------------------+------------------+--------------+ | LCS | Client handling | Location Client | LCCF | | | | Control Function | | +-------------+------------------+------------------+--------------+ | Server | component | Location Client | LCAF | | | | Authorization | | | | | Function | | +-------------+------------------+------------------+--------------+ | in PLMN | | Location Client | LCCTF | | | | Co-ordinate | | | | | Transformation | | | | | Function | | +-------------+------------------+------------------+--------------+ | | | Location Client | LCZTF | | | | Zone | | | | | Transformation | | | | | Function | | +-------------+------------------+------------------+--------------+ | | System handling | Location System | LSCF | | | | Control Function | | +-------------+------------------+------------------+--------------+ | | component | Location System | LSBF | | | | Billing Function | | +-------------+------------------+------------------+--------------+ | | | Location System | LSOF | | | | Operations | | | | | Function | | +-------------+------------------+------------------+--------------+ | | | Location System | LSBcF | | | | Broadcast | | | | | Function | | +-------------+------------------+------------------+--------------+ | | | Location System | LSCTF | | | | Co-ordinate | | | | | Transformation | | | | | Function | | +-------------+------------------+------------------+--------------+ | | Subscriber | Location | LSAF | | | | Subscriber | | | | | Authorization | | | | | Function | | +-------------+------------------+------------------+--------------+ | | Handling | Location | LSTF | | | | Subscriber | | | | | Translation | | | | | Function | | +-------------+------------------+------------------+--------------+ | | component | Location | LSPF | | | | Subscriber | | | | | Privacy function | | +-------------+------------------+------------------+--------------+ | | Positioning | Positioning | PRCF | | | | Radio Control | | | | | Function | | +-------------+------------------+------------------+--------------+ | | component | Positioning | PCF | | | | Calculation | | | | | Function | | +-------------+------------------+------------------+--------------+ | | | Positioning | PSMF | | | | Signal | | | | | Measurement | | | | | Function | | +-------------+------------------+------------------+--------------+ | | | Positioning | PRRM | | | | Radio Resource | | | | | Management | | +-------------+------------------+------------------+--------------+ | | Context & Data | Positioning | PADSF | | | | Assistance Data | | | | | Storage Function | | +-------------+------------------+------------------+--------------+ | | component | Positioning | PCUSF | | | | Context of UE | | | | | Storage Function | | +-------------+------------------+------------------+--------------+
In addition to those functionalities in above table, the AMF should support
transport NRPPa messages defined in TS 38.455 [11] between UE and the LMF.
NOTE 1: The RAN WG may develop new positioning component for NG-RAN. Thus,
above table will be updated accordingly.
In following two clauses, two options for function allocations are described,
respectively.
NOTE 2: Some function block in above table may be associated with each entity,
e.g. LSOF. That does not mean each entity will provide the same service.
NOTE 3: In both options, PCF and PADSF are introduced in NG-RAN at concept
level. However, detailed architecture, functionalities, and procedures are
under RAN WG remit, and will be updated accordingly.
#### 6.1.2.2 Option A: EPS like allocation
In this option,
\- The AMF implement all LCS related functionalities in MME (see clause 6.3.13
of TS 23.271 [6]).
\- The LMF implement all LCS related functionalities in E-SMLC (see clause
6.3.14 of TS 23.271 [6]).
\- The AMF uses UDSF to store UE related positioning context (for how to
manage AMF with UDSF, see clause 5.21.2 of TS 23.501 [4]).
\- The UDM is enhanced to support Positioning Assistance Data storage, and
support assistance data retrieval from other CP NFs.
Table 6.1.2.2-1 and figure 6.1.2.2-1 show the distribution of LCS functional
blocks to 5G network elements and general LCS Logical Architecture for 5G.
In this option, mapping LCS related procedure defined in TS 23.271 [6] to
Service base procedure is needed.
Table 6.1.2.2-1: Allocation of LCS functional entities to 5G elements
| UE | RAN | GMLC | AMF | LMF | UDSF | UDM/UDR | PPR | PMD | Client  
---|---|---|---|---|---|---|---|---|---|---  
| Location client functions |  |  |  |  |  |  |  |  |   
LCF | X |  |  | X |  |  |  |  |  | X  
LCF Internal |  |  |  |  |  |  |  |  |  |   
| Client handling functions |  |  |  |  |  |  |  |  |   
LCCTF |  |  | X |  |  |  |  |  |  |   
LCCF |  |  | X |  |  |  |  |  |  |   
LCAF |  |  | X |  |  |  |  |  |  |   
LCZTF |  |  | X |  |  |  |  |  |  |   
| System handling functions |  |  |  |  |  |  |  |  |   
LSCF |  |  |  | X |  |  |  |  |  |   
LSBF |  |  | X | X |  |  |  |  |  |   
LSOF | X | X | X | X | X |  |  |  |  |   
LSBcF |  | X |  |  | X |  |  |  |  |   
LSCTF |  |  | X |  |  |  |  |  |  |   
LIMS-IWF |  |  | X  
(Note 1) |  |  |  |  |  |  |   
| Subscriber handling functions |  |  |  |  |  |  |  |  |   
LSAF |  |  | X | X |  |  |  | X |  |   
LSPF |  |  | X | X |  |  | X | X |  |   
LSTF |  |  |  |  |  |  |  |  | X |   
| Positioning functions |  |  |  |  |  |  |  |  |   
PRCF |  |  |  |  | X |  |  |  |  |   
PCF | X | X |  |  | X |  |  |  |  |   
PSMF | X | X |  |  |  |  |  |  |  |   
PRRM |  | X |  |  |  |  |  |  |  |   
| Context & Data component |  |  |  |  |  |  |  |  |   
PADSF |  | X |  |  |  |  | X |  |  |   
PCUSF |  |  |  |  |  | X |  |  |  |   
| UE | RAN | GMLC | AMF | LMF | UDSF | UDM/UDR | PPR | PMD | Client  
Figure 6.1.2.2-1: Generic LCS Logical Architecture for 5GC
Editors\' note: The detail of services provided by NFs in this option is FFS.
#### 6.1.2.3 Option B: LMF centric allocation
In this option:
\- The AMF partially implement one LCS related functionalities i.e. LSOF (see
clause 5.4.2.3 of TS 23.271 [6]).
\- The LMF implement all LCS related functionalities in E-SMLC (see clause
6.3.14 of TS 23.271 [6]) and most of LCS related functionalities in MME.
\- The LMF uses UDSF to store UE related positioning context.
Editors\' note: The details of how LMF and UDSF interact in scale in and out
scenario are FFS.
\- The UDM is enhanced to support Positioning Assistance Data storage, and
support assistance data retrieval from other CP NFs.
Table 6.1.2.3-1 and figure 6.1.2.3-1 show the distribution of LCS functional
blocks to 5G network elements and general LCS Logical Architecture for 5G.
Compared to that of Option A, this option require LMF implement following
functionality: LCF, LSCF, LSBF, LSAF and LSPF (those are originally
implemented by MME), in addition to all LCS related functionalities in E-SMLC
(see clause 6.3.14 of TS 23.271 [6]).
Table 6.1.2.3-1: Allocation of LCS functional entities to 5G elements
| UE | RAN | GMLC | AMF | LMF | UDSF | UDM/UDR | PPR | PMD | Client  
---|---|---|---|---|---|---|---|---|---|---  
| Location client functions |  |  |  |  |  |  |  |  |   
LCF | X |  |  |  | X |  |  |  |  | X  
LCF Internal |  |  |  |  |  |  |  |  |  |   
| Client handling functions |  |  |  |  |  |  |  |  |   
LCCTF |  |  | X |  |  |  |  |  |  |   
LCCF |  |  | X |  |  |  |  |  |  |   
LCAF |  |  | X |  |  |  |  |  |  |   
LCZTF |  |  | X |  |  |  |  |  |  |   
| System handling functions |  |  |  |  |  |  |  |  |   
LSCF |  |  |  |  | X |  |  |  |  |   
LSBF |  |  | X |  | X |  |  |  |  |   
LSOF | X | X | X | X | X |  |  |  |  |   
LSBcF |  | X |  |  | X |  |  |  |  |   
LSCTF |  |  | X |  |  |  |  |  |  |   
LIMS-IWF |  |  | X (Note 1) |  |  |  |  |  |  |   
| Subscriber handling functions |  |  |  |  |  |  |  |  |   
LSAF |  |  | X |  | X |  |  | X |  |   
LSPF |  |  | X |  | X |  | X | X |  |   
LSTF |  |  |  |  |  |  |  |  | X |   
| Positioning functions |  |  |  |  |  |  |  |  |   
PRCF |  |  |  |  | X |  |  |  |  |   
PCF | X | X |  |  | X |  |  |  |  |   
PSMF | X | X |  |  |  |  |  |  |  |   
PRRM |  | X |  |  |  |  |  |  |  |   
| Context & Data component |  |  |  |  |  |  |  |  |   
PADSF |  | X |  |  |  |  | X |  |  |   
PCUSF |  |  |  |  |  | X |  |  |  |   
| UE | RAN | GMLC | AMF | LMF | UDSF | UDM/UDR | PPR | PMD | Client  
Figure 6.1.2.3-1: Generic LCS Logical Architecture for 5GC
Editors\' note: The detail of services provided by NFs in this option is FFS.
### 6.1.3 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
### 6.1.4 Impacts on existing entities and interfaces
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.1.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.2 Solution 2: LMF Based Location Solution
### 6.2.1 Introduction
The LMF based solution is intended to address or resolve, partly or
completely, the following key issues:
\- Key Issue 1: Enhancement to LCS Architecture.
\- Key Issue 3: Support of low latency LCS.
\- Key Issue 5: Slicing dependent location service.
\- Key Issue 6: Scalability.
\- Key Issue 8: Support of IoT UEs.
\- Key Issue 12: LCS support for Non-3GPP access.
\- Key Issue 15: Location continuity support.
The LMF based solution may also enable, or be compatible with, other solutions
to address or resolve some of the other key issues.
### 6.2.2 Functional Description
#### 6.2.2.1 Architecture
The LMF based location solution focuses location support on the LMF and
bypasses the AMF except for obtaining UE reachability, status and subscription
information and exchanging location related messages with a target UE or NG-
RAN. The service based architecture and corresponding reference point
architecture for roaming and non-roaming UEs are shown below.
Figure 6.2.2-1: Non-roaming reference architecture for LMF Based Solution
Figure 6.2.2-2: Roaming reference architecture for LMF Based Solution
Figure 6.2.2-3: Non-roaming reference architecture for LMF Based Solution in
reference point representation
Figure 6.2.2-4: Roaming reference architecture for LMF Based Solution in
reference point representation
Figure 6.2.2-1 is identical to Figure 4.4.4.1-1 in TS 23.501 [4] except for
the removal of the LRF in Figure 6.2.2-1 which is not relevant to commercial
location services. Figure 6.2.2-3 is similar to Figure 4.4.4.1-2 in TS 23.501
[4] with the following differences:
\- LRF is removed.
\- The NLs interface between the AMF and LMF is replaced by an NLs* interface
which is similar in some respects.
\- The NLg interface between an AMF and GMLC is replaced by an NLg* interface
between an LMF and GMLC which can be based on the same protocol.
#### 6.2.2.2 Reference points and Service based interfaces
For the LMF based solution, reference points not realized by service based
interfaces comprise:
**N1:** Reference point between UE and AMF via NAS.
**N2:** Reference point between NG-RAN and AMF.
**Le:** Reference point between a GMLC and a LCS Client.
**Lr:** Reference point between a VGMLC and HGMLC.
Reference points realized by service based interfaces comprise:
**NLg*:** Reference point between a GMLC and an LMF.
**NLs*:** Reference point between an AMF and LMF.
**NLh:** Reference point between a GMLC and UDM.
Service Based Interfaces used by the LMF based solution comprise:
**Ngmlc:** Service-based interface exhibited by GMLC (not used).
**Nlmf:** Service-based interface exhibited by LMF.
**Namf:** Service-based interface exhibited by AMF.
**Nudm:** Service-based interface exhibited by UDM.
The LMF based solution uses existing service operations defined in TS 23.502
[5] for the Namf and Nudm service based interfaces. For the Nlmf service based
interface, two new service operations are added as shown below.
Table 6.2.2.2-1: Nlmf Service Operations
+-------------+-------------+-------------+-------------+-------------+ | Service | Service | Operation | Example | Co | | Name | Operations | | Consumer | rresponding | | | | Semantics | | Service | | | | | | Operations | | | | | | in | | | | | | TS 2 | | | | | | 3.502 [5] | +-------------+-------------+-------------+-------------+-------------+ | Nlmf_Prov | Obtain UE | Reque | GMLC | Namf_Loc | | ideLocation | Location | st/Response | | ation_Prov | | | | | | ideLocation | +-------------+-------------+-------------+-------------+-------------+ | Nlmf_ | Report a UE | Notify | GMLC | Namf\ | | EventNotify | location | | | _Location_ | | | related | | | EventNotify | | | event | | | | +-------------+-------------+-------------+-------------+-------------+
The corresponding service operations in TS 23.502 [5] provide a very similar
service except that they are provided by an AMF instead of an LMF and are
restricted to regulatory rather than commercial location. This would allow the
protocol(s) developed at a stage 3 level for the Namf service operations in TS
23.502 [5] to be extended for use with the new LMF service operations.
The Nlmf_Location_DetermineLocation service operation defined in TS 23.502 [5]
is not needed for the LMF based solution.
### 6.2.3 Procedures
#### 6.2.3.1 5GC-MT-LR Procedure
Figure 6.2.3.1-1 shows a 5GC Mobile Terminated Location Request (5GC-MT-LR)
procedure for a roaming UE. A 5GC-MT-LR procedure for a non-roaming UE would
comprise a subset of the procedure shown in Figure 6.2.3.1-1. With this
procedure:
\- Privacy requirements can be configured in the HGMLC or transferred from the
UDM to the HGMLC and are not needed in the AMF.
\- AMF support is limited to functions already defined for other NFs, e.g.
providing the LMF with UE reachability, status and location information, and
providing connectivity access to the UE and NG-RAN.
Figure 6.2.3.1-1: 5GC Mobile Terminated Location Request (5GC-MT-LR) for a
roaming UE
1\. An external LCS client sends a location request to an HGMLC in the HPLMN
for the target UE. The HGMLC verifies the authorization of the LCS Client to
locate the target UE and UE privacy requirements.
NOTE 1: The external LCS client may instead be an NF or an AF which accesses
the HGMLC via an NEF as described in clause 6.9 for Solution 9.
2\. The HGMLC invokes the Nudm_UE ContextManagement_Get service operation
towards the home UDM of the target UE with the GPSI or SUPI of the UE.
3\. The UDM returns the serving AMF address and possibly a VGMLC address, a
current access type, and/or an LMF address in the VPLMN. The UDM may also
return subscribed privacy requirements for the target UE - e.g. if not stored
in the HGMLC.
NOTE 2: If the UDM does not return an AMF address, the HGMLC may also query
the home HSS of the target UE for a serving MME address as described in clause
9.1.1 of TS 23.271 [6]. The EPC-MT-LR procedure described in clause 9.1.15 of
TS 23.271 [6] may then be performed instead of steps 4-18.
4\. If a VGMLC address was not returned in step 3, the HGMLC may use the NRF
service in the HPLMN to select an available VGMLC in the VPLMN, based on the
VPLMN address contained in the AMF address received in step 3\. The HGMLC
forwards the location request to the VGMLC and includes the AMF address, the
target UE identity (e.g. SUPI), any LMF address received in step 3, any access
type received at step 3 and any privacy requirements for the UE.
5\. The VGMLC determines an LMF in the VPLMN and invokes the
Nlmf_ProvideLocation Request service operation to forward the location request
to the LMF. If the VGMLC and LMF functions are combined, this step may be
omitted.
NOTE 3: The VGMLC may determine an LMF in the following alternative ways:
1) If VGMLCs, LMFs and AMFs are fully interconnected (e.g. via an operator IP
intranet), a VGMLC may determine an LMF based on any suitable criteria (e.g.
location QoS, type of LCS client, VGMLC ID, access type) and independently of
the AMF. As one example, a VGMLC could be configured with all LMFs in the
VPLMN and could select LMFs on a round robin basis.
2) If an AMF is allowed to use some but not all LMFs in the VPLMN, a VGMLC
could be configured with the allowed LMFs for each AMF - and could then select
an LMF based on specific criteria (e.g. QoS) or randomly.
3) A VGMLC may use the NRF service in the VPLMN to request a set of available
LMFs in the VPLMN and may then select one LMF as in (1). Use of the NRF
service can support network slicing (e.g. similar to SMF selection in clause
4.3.2.2.3 of TS 23.502 [5]) if the HGMLC is configured with an S-NSSAI or
obtains an S-NSSAI from the UDM for the target UE in step 3.
4) When a UE registers with the 5GC, the serving AMF could select an LMF (e.g.
using the NRF service and an S-NSSAI). The AMF or the LMF (e.g. as described
in clause 6.8.3 for Solution 8) can then provide the LMF address to the UDM
along with the AMF address. If at a later time the selected LMF is changed,
e.g. due to change of UE\'s AN, the AMF or the LMF updates the UDM
accordingly. The UDM can then provide the LMF address in step 3 to the HGMLC
which would provide the address to the VGMLC in step 4. This alternative might
be supported only for UEs from certain HPLMNs and/or UEs with a subscription
to 5GC-MT-LR usage.
6\. As an optional optimization, instead of performing steps 4 and 5, if the
HGMLC can determine or select the LMF (e.g. based on the VPLMN identity, AMF
address, using the NRF service or by receiving an LMF address from the UDM in
step 3), the HGMLC may invoke the Nlmf_ProvideLocation Request service
operation to forward the location request directly to the LMF.
NOTE 2: When this optimization is used, the HGMLC needs to support the Nlmf
SBI. Therefore, if the HPLMN operator wishes to avoid support of the Nlmf SBI
by combining GMLCs with LMFs, steps 4 and 5 should be used rather than step 6.
7\. The LMF invokes the Namf_MT_EnableUEReachability Request service operation
towards the serving AMF to verify UE reachability.
NOTE 3: If the serving AMF is no longer available, the LMF uses the NRF
service in the VPLMN to select another AMF from the same AMF set as the
previous serving AMF.
8\. If the UE is currently in CM Connected state for 3GPP or non-3GPP access,
this step is skipped. Otherwise, if the UE is currently in CM Idle state for
3GPP access but is reachable, the AMF performs a 3GPP network triggered
service request in order to place the UE in connected state.
9\. The AMF invokes the Namf_MT_EnableUEReachability Response service
operation towards the LMF to confirm UE reachability.
10\. The LMF may notify the UE and verify UE privacy requirements based on any
privacy requirements received from the HGMLC in steps 4-6. If this occurs, the
LMF sends a supplementary services Location Notification invoke to the UE via
the serving AMF using the Namf_Communication _N1N2MessageTransfer service
operation.
NOTE 5: Transfer of supplementary services messages and positioning messages
between the LMF and UE for steps 10, 11 and 14 may be based on the procedure
in clause 4.13.5.4 in TS 23.502 [5] in the case of 3GPP access or may use the
procedure summarized in clause 6.13.3 for Solution 13 in the case of non-3GPP
access.
11\. The UE notifies the user of the location request and verifies user
permission if UE privacy is to be verified. The UE then returns a
supplementary services Location Notification response to the LMF indicating
whether the user grants or withholds permission for the location request when
UE privacy is verified. The supplementary services response is transferred via
the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation.
12\. If the LMF needs to know the current access type(s) (i.e. 3GPP and/or
non-3GPP) and any serving cell for the UE prior to performing positioning in
step 14 and prefers to obtain this from the serving AMF rather than the UE,
NG-RAN or N3IWF (e.g. to reduce latency), the LMF invokes the
Namf_EventExposure_Subscribe service operation towards the AMF to obtain UE
location information and includes the immediate one time notification flag.
13\. The serving AMF returns the UE access type(s) and location information to
the LMF (e.g. 3GPP access type and serving cell ID).
14\. The LMF may perform one or more of the positioning procedures described
in clauses 4.13.5.4, 4.13.5.5 and 4.13.5.6 of TS 23.502 [5] for 3GPP access or
the positioning procedures summarized in clause 6.13.3 for Solution 13 for
non-3GPP access. In the case of the procedure in clause 4.13.5.4 of TS 23.502
[5] for 3GPP access or step 4d in clause 6.13.3 for Solution 13 for non-3GPP
access, the LMF may include a routing identifier identifying the LMF in any
positioning message intended for the UE which is sent to the serving AMF (e.g.
at step 1 in Figure 4.13.5.4-1 in TS 23.502 [5]), which the AMF can then
forward to the UE in the NAS transport message (e.g. at step 3 in Figure
4.13.5.4-1 in TS 23.502 [5]). The LMF determines the UE location using
information obtained in this step and/or in step 13.
NOTE 6: In the event of a change of serving AMF for the UE within the same
PLMN and while positioning is in progress, the old AMF can return an error
indication to the LMF when the LMF attempts to send a positioning protocol
message to the UE, the NG-RAN or the N3IWF. In addition, if the LMF subscribes
to event notification from the old AMF for a change of AMF using the AMF event
exposure service operation, the old AMF can notify the LMF when a change of
AMF occurs. Provided the LMF is able to access the new AMF, the LMF can resume
any of steps 10-14 with the new AMF. For positioning in the UE or NG-RAN that
is already in progress when a change of AMF occurs, positioning protocol
messages can be returned by the UE or NG-RAN to the LMF via the new AMF, since
the messages would include a routing identifier indicating the LMF. This will
enable a positioning session between the UE and LMF to continue following a
change of AMF.
NOTE 7: In the event of mobility of a target UE from 5GC to EPC, the LMF can
subscribe to notification by the old AMF. The LMF can then return any UE
location so far obtained or an error indication to the HGLMC at steps 15-17.
In the case of an error indication, the HGMLC can repeat steps 2 and 3 to
query the UDM and HSS for a new AMF and new MME address. When an MME address
is returned by the HSS, the HGMLC can perform an EPC-MT-LR as described in
clause 9.1.15 of TS 23.271 [6] to obtain the UE location.
15-18. The LMF returns the location estimate to the LCS client via the VGMLC
and/or HGMLC.
#### 6.2.3.2 5GC-MO-LR Procedure
Figure 6.2.3.2-1 summarizes a 5GC Mobile Originated Location Request (5GC-MO-
LR) procedure for a roaming UE. A 5GC-MO-LR procedure for a non-roaming UE
would comprise a subset of the procedure shown in Figure 6.2.3.2-1. With this
procedure:
\- The LMF and VGMLC can be combined to avoid support of the Nlmf SBI in the
VPLMN.
\- Subscription to MO-LR support is assumed to be provided to the AMF by the
UDM and could be provided to the LMF when the LMF requests UE status
information from the AMF. As an alternative, the LMF could query the UDM.
\- The LMF is selected by the AMF.
Figure 6.2.3.2-1: 5GC Mobile Originated Location Request (5GC-MO-LR) for a
roaming UE
1\. The UE performs a service request if in idle state.
2\. The UE sends a supplementary services MO-LR request to the serving AMF
indicating a request for a location estimate, location assistance data or
sending of a location estimate to an LCS client via transfer to third party
(TTTP). For TTTP, the UE identifies the external LCS client and possibly the
HGMLC. The MO-LR is sent inside a NAS transport message. The UE may include a
default routing identifier in the NAS transport message indicating that the
AMF may select any LMF in the VPLMN.
3\. The AMF selects an LMF in the VPLMN based on receiving a default routing
identifier in step 2 and invokes the Namf_Communication_N1MessageNotify
service operation towards this LMF to transfer the MO-LR request. The AMF
includes a SUPI for the UE.
NOTE 1: The AMF may select the LMF using the NRF service and may make use of
an S-NSSAI to support network slicing. Alternatively, LMF selection may occur
when a UE first registers as described for Solution 8 in clause 6.8, in which
case the LMF address may be part of the UE context in the AMF.
4\. The LMF invokes the Namf_EventExposure_Subscribe service operation towards
the AMF to obtain UE location information and the UE subscription to MO-LR and
includes the immediate one time notification flag.
5\. The serving AMF returns UE location information to the LMF (e.g. current
access types and any serving cell ID) and UE subscription to MO-LR. The LMF
verifies that the UE is subscribed to the MO-LR request received in step 3.
Editor\'s note: It is assumed that the Namf EventExposure service operation is
extended to allow provision of UE subscription information for an MO-LR. An
alternative could be a new service operation. A decision on preferred support
is FFS.
6\. If the MO-LR request indicates a request for a location estimate or
sending of a location estimate to an LCS client via TTTP, the LMF may perform
one or more of the positioning procedures described in clauses 4.13.5.4,
4.13.5.5 and 4.13.5.6 of TS 23.502 [5] in the case of 3GPP access, or the
positioning procedures for Solution 13 summarized in clause 6.13.3 in the case
of non-3GPP access. The LMF then determines the UE location using information
obtained in this step and/or in step 5. If the MO-LR request indicates a
request for location assistance data, the LMF performs the positioning
procedure described in clause 4.13.5.4 of TS 23.502 [5] in the case of 3GPP
access, or the positioning procedure for Solution 13 summarized in clause
6.13.3 in the case of non-3GPP access, to transfer the assistance data to the
UE. For procedures involving the UE, the LMF may include a routing identifier
identifying the LMF in any positioning message intended for the UE which is
sent to the serving AMF (e.g. as at step 1 in Figure 4.13.5.4-1 in TS 23.502
[5]), which the AMF can then forward to the UE in the NAS transport message
(e.g. as at step 3 in Figure 4.13.5.4-1 in TS 23.502 [5]). If TTTP was not
requested in step 2, steps 7-10 are skipped.
7\. The LMF selects a VGMLC in the VPLMN and invokes the Nlmf_EventNotify
service operation towards the VGMLC. The service operation includes the
location obtained in step 6, the SUPI for the UE, the LCS client ID and any
HGMLC address provided in step 2. This step can be omitted if the LMF and
VGMLC functions are combined in the same entity.
8\. The VGMLC forwards the location, the UE identity and LCS client identity
to the HGMLC. The VGMLC may determine the HGMLC address if not provided in
step 7 from the HPLMN identity inferred from the SUPI.
9\. As an optional optimization, if the HGMLC address is provided by the UE in
step 2 or can be determined by the LMF (e.g. based on the HPLMN identity as
inferred from the UE identity), the LMF may invoke the Nlmf_EventNotify
service operation towards the HGMLC. The service operation includes the
location obtained in step 6, the SUPI for the UE and the LCS client ID
provided in step 2. When step 9 occurs, steps 7 and 8 are omitted.
10\. The HGMLC provides the UE location and a UE identity to the external LCS
client.
11\. The LMF invokes the Namf_Communication _N1N2MessageTransfer service
operation towards the AMF to send a supplementary services MO-LR response to
the AMF confirming completion of the MO-LR request in step 2 and including any
location determined in step 6
12\. The AMF forwards the MO-LR response to the UE in a NAS transport message.
#### 6.2.3.3 Periodic and Triggered 5GC-MT-LR Procedure
Figure 6.2.3.3-1 summarizes a periodic and triggered 5GC-MT-LR procedure for a
roaming UE. A periodic and triggered 5GC-MT-LR procedure for a non-roaming UE
would comprise a subset of the procedure shown in Figure 6.2.3.3-1. The
trigger events may comprise any of:
\- UE available event.
\- Area event (UE entering, leaving or remaining with the area).
\- Motion event (UE moving by more than a threshold straight line distance
from a previous location).
Only one of these events may be requested by an LCS Client or the UE available
event may be combined with either a periodic event or another triggered event.
When a UE is already available, a request for the UE available event is
equivalent to requesting a current location for the target UE. With this
procedure:
\- The LMF and VGMLC can be combined to avoid support of the Nlmf SBI in the
VPLMN.
\- Privacy requirements can be configured in the HGMLC or transferred from the
UDM to the HGMLC and are not needed in the AMF.
\- The same LMF may be used for each successive periodic or triggered location
fix thereby avoiding overhead to assign and release the LMF for each location
and enabling use of information obtained by the LMF for previous location
fixes.
\- Trigger detection occurs in the UE.
Figure 6.2.3.3-1: Deferred 5GC-MT-LR for periodic, triggered and UE available
event for a roaming UE
1\. An external LCS client sends a location request for a periodic and
triggered location for a target UE to an HGMLC in the HPLMN for the UE. The
location request provides the type of location reporting being requested and
associated parameters. For periodic location, the request includes the time
interval between successive location reports and the total number of reports.
For triggered reporting for an area event, the request includes details of the
target area, whether the trigger event to be reported is the UE being inside,
entering into or leaving the target area, and whether event reporting shall
include UE location estimates. For triggered reporting for the motion event,
the request includes a threshold linear distance for triggering a location
report and whether event reporting shall include UE location estimates. For
the UE available trigger event, no additional parameters are needed. The HGMLC
may verify UE privacy requirements.
NOTE 1: The external LCS client may instead be an NF or an AF which accesses
the HGMLC via an NEF as described in clause 6.9 for Solution 9.
2-3. The HGMLC queries the UDM for the serving AMF address, UE privacy
requirements and possibly a VGMLC address, current access type and/or an LMF
address in the VPLMN as described for steps 2-3 in Figure 6.2.3.3-1.
NOTE 2: The HGMLC may also query the home HSS of the target UE for a serving
MME address as described in clause 9.1.1 of TS 23.271 [6]. The deferred EPC-
MT-LR procedure for Periodic and Triggered Location described in clause 9.1.19
of TS 23.271 [6] may then be performed instead of steps 4-34 - e.g. if the HSS
returns an MME address but the UDM does not return an AMF address.
4-6. The HGMLC forwards the location request to the LMF via a VGMLC or
directly as described for steps 4-6 of Figure 6.2.3.3-1. The HGMLC includes in
the location request the AMF address, the UE identity (e.g. SUPI), the type of
location reporting being requested and associated parameters, a reference
number to be used to identify later responses, and any privacy requirements
for the UE. For area event reporting, the HGMLC, VGMLC or LMF may convert the
target area into an equivalent set of cells or TAs in the VPLMN. LMF selection
(if needed) by the VGMLC may be supported as described for step 5 of Figure
6.2.3.1-1.
7-10. If the LMF supports the type of periodic and triggered location
requested, the LMF returns an acknowledgment to the LCS client, via the VGMLC
and/or HGMLC, indicating that the request for periodic or triggered location
was accepted.
11-13. The LMF verifies UE reachability and that the UE is in a connected
state as described for steps 7-9 of Figure 6.2.3.1-1.
14-15. If the UE is not reachable (e.g. is in eDRX or PSM), the LMF invokes
the Namf_EventExposure_Subscribe service operation towards the AMF in order to
be informed by the AMF when the UE again becomes reachable. At that point and
if the UE may not yet be in connected state, the LMF may again perform steps
11-13. The LMF may also perform steps 14-15 to obtain the current access
type(s) (i.e. 3GPP and/or non-3GPP) and any serving cell ID for the UE from
the AMF after the UE becomes reachable as in steps 12-13 of Figure 6.2.3.1-1.
NOTE 3: In the event of a change of serving AMF for the UE within the same
PLMN when the UE becomes reachable, the old AMF can notify the LMF and the LMF
can perform steps 14-15 to obtain the current access type(s) (i.e. 3GPP and/or
non-3GPP) and any serving cell ID for the UE from the new AMF.
NOTE 4: In the event of mobility of a target UE from 5GC to EPC when the UE
becomes reachable, the old AMF can notify the LMF. The LMF can then return an
error indication to the HGLMC using steps 21-23. The HGMLC can then repeat
steps 2 and 3 to query the UDM and HSS for a new AMF and new MME address. When
an MME address is returned by the HSS, the HGMLC can perform a deferred EPC-
MT-LR for Periodic and Triggered Location as described in clause 9.1.19 of TS
23.271 [6].
16-17. Once the UE is reachable, the LMF may verify UE privacy requirements,
based on UE privacy requirements received from the HGMLC in steps 3-5, via a
supplementary services interaction as in steps 10-11 for Figure 6.2.3.3-1.
18\. If triggered location for the UE available event was requested, the LMF
performs UE positioning as for step 14 of Figure 6.2.3.1-1. If no other
triggered or periodic location reporting was requested, the LMF skips steps
19-20 and 25-34 and performs steps 21-24 to return the UE location to the LCS
Client after which the procedure terminates.
19\. If periodic location or triggered location for the area event or motion
event was requested, the LMF sends a supplementary services LCS Periodic-
Triggered Event Invoke message to the UE via the serving AMF by invoking the
Namf_Communication _N1N2MessageTransfer service operation. The message carries
the location request information received from the VGMLC or HGMLC, the
reference number assigned by the HGMLC and the HGMLC address if the same LMF
will not be used in step 27. The LMF includes a routing identifier in the
Namf_Communication _N1N2MessageTransfer service operation indicating whether
later trigger event reports (in step 27) are to be sent by the UE to the same
LMF. The routing identifier would be transferred to the UE by the serving AMF
in a NAS transport message used to convey the LCS Periodic-Triggered Event
Invoke to the UE and would identify the LMF when use of the same LMF is
required. The routing identifier may otherwise be omitted or set to a default
value that indicates any LMF.
20\. If the request in step 19 can be supported, the UE returns an
acknowledgment to the LMF. which is transferred via the serving AMF and
delivered to the LMF using an Namf_Communication_N1MessageNotify service
operation.
21-24. The LMF sends a response to the LCS client via the VGMLC and/or HGMLC
carrying any location estimate obtained at step 18 for the UE available event.
When steps 19-20 were performed, the response also confirms that event
reporting for periodic or triggered location was activated in the UE. The
VGMLC (if used) and optionally the LMF can then release state information for
the periodic and triggered 5GC-MT-LR request. If the LMF indicates in step 19
that the same LMF must be used for later trigger event reports (in step 27),
the LMF retains state information for the UE.
25\. If steps 19 and 20 are performed, the UE monitors for occurrence of the
trigger event requested in step 19 (e.g. a periodic trigger event, an area
trigger event or a motion trigger event). When a trigger event is detected,
the UE proceeds to step 26.
26\. The UE performs a service request if in idle state.
27\. The UE sends a supplementary services 5GC-MO-LR request to an LMF which
is transferred via the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation. The request indicates an
event report for a periodic and triggered location request and includes the
type of trigger event being reported, the HGMLC address if received at step
19, and the reference number. The request may also include a location estimate
if reporting of a location estimate is required. If requested in step 19, the
UE may ensure the MO-LR request is routed by the serving AMF to the same LMF
that initiated the periodic and triggered location request by including any
routing identifier received at step 19. Otherwise, the UE can include a
default routing identifier to indicate that the AMF may select any LMF in the
VPLMN.
NOTE 5: Step 27 does not require the same serving AMF as in steps 16-20 so
mobility between AMFs is supported. In the event of mobility of a target UE
from 5GC to EPC prior to step 26, the UE may report a trigger event detected
at step 25 according to steps 13-24 of Figure 9.1.19.1-1 of TS 23.271 [6] if
the deferred EPC-MT-LR procedure for Periodic and Triggered Location is
supported by both the UE and EPC.
28\. If a location estimate was not included in step 27 and if reporting of
location estimates was requested at step 5 or step 6, the LMF performs steps
12-14 of Figure 6.2.3.1-1 to obtain a location estimate for the UE.
29\. The LMF returns an MO-LR return result to the UE via the serving AMF
using the Namf_Communication _N1N2MessageTransfer service operation to confirm
that an event report will be sent to the LCS client.
30\. The LMF selects a VGMLC (which may be different to the VGMLC for steps
3-7) and invokes an Nlmf_EventNotify service operation towards the VGMLC with
an indication of the type of event being reported, the reference number, the
H-GMLC address and a location estimate if this was requested and obtained at
step 27 or step 28. This step may be omitted if the LMF and VGMLC are
combined.
31\. The VGMLC forwards the information received in step 30 to the HGMLC.
32\. As an optional optimization, steps 30 and 31 are omitted and the LMF
instead sends the information in step 30 directly to the HGLMC.
33\. The HGMLC uses the reference number received in step 31 or step 32 to
identify the periodic and triggered location request received in step 1 and
then sends the location estimate and type of trigger event being reported to
the external LCS client.
34\. The UE continues to monitor for further trigger events and instigates
steps 26-33 each time a trigger event is detected.
#### 6.2.3.4 Optimized Periodic and Triggered 5GC-MT-LR Procedure
Figure 6.2.3.4-1 summarizes an optimized 5GC-MT-LR procedure for a roaming UE
to support periodic and triggered location in the same manner as in Figure
6.2.3.3-1 but with less resource usage and less impact to the UE and LMF. A
corresponding optimized procedure for a non-roaming UE would comprise a subset
of the procedure shown in Figure 6.2.3.4-1. This procedure has the same
characteristics as the procedure in Figure 6.2.3.3-1, but in addition:
\- The same LMF is always used for each successive periodic or triggered
location fix thereby avoiding overhead to assign and release the LMF for each
location and enabling use of information obtained by the LMF for previous
location fixes.
\- Support of the supplementary services MO-LR request and response is not
needed by the UE or LMF.
\- Trigger detection occurs in the UE, in the LMF or in both the UE and LMF.
Figure 6.2.3.4-1: Optimized Periodic and Triggered 5GC-MT-LR for a roaming UE
1-18. Steps 1 to 18 of Figure 6.2.3.3-1 are performed.
19\. The LMF determines whether to use trigger event detection by the LMF or
by the UE - e.g. based on the type of periodic or triggered location being
requested, the LMF capabilities, the UE capabilities (if known) and whether
the UE employs power saving mode and is currently reachable. For trigger event
detection by the LMF, steps 26-27 are performed and steps 20-21 and 28-30 are
omitted. For trigger event detection by the UE, steps 20-21 and 28-30 are
performed and steps 26-27 are omitted. In some implementations, an LMF may use
both types of trigger detection in order to improve trigger detection
reliability or if the UE and LMF detect different types of triggers.
20\. For trigger detection by the UE, the LMF sends a positioning protocol
(e.g. LPP) message to the UE via the serving AMF using the Namf_Communication
_N1N2MessageTransfer service operation. The LMF includes in the message a
request for periodic or triggered location reporting by the UE as determined
by the LMF in step 19 and the type of location measurements or location
estimate to be provided by the UE for location reporting in step 30. The LMF
also includes a routing identifier identifying the LMF in the
Namf_Communication _N1N2MessageTransfer service operation which is transferred
to the UE by the AMF.
21\. If the request in step 20 can be supported, the UE returns an
acknowledgment to the LMF in a positioning protocol (e.g. LPP) message. which
is transferred via the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation.
22-25. Steps 21-24 of Figure 6.2.3.3-1 are performed to confirm that event
reporting for periodic or triggered location was activated in the LMF and/or
UE and to return any location estimate for the UE available event obtained at
step 18 if the UE available event was requested at step 5 or step 6.
26\. For trigger detection by the LMF, the LMF may monitor the status and/or
location of the UE by periodically querying the AMF for new UE status and
location information and/or subscribing to location event reporting from the
AMF such as for a change of access type, cell ID or TA. When periodic location
of the UE was requested in step 5 or step 6, step 26 may not be needed.
27\. The LMF uses the information in step 26 or other information (e.g. the
current time) to detect when a trigger event has occurred. When a trigger
event is detected the LMF proceeds to step 31.
28\. For trigger event detection by the UE, the UE monitors for occurrence of
the trigger event requested in step 20. The monitoring may occur while the UE
is in idle state and/or while the UE is unreachable from the network (e.g.
with eDRX or PSM). The UE may also (e.g. periodically) request assistance data
from the LMF to help determine a location, if needed to detect a trigger
event. When a trigger event is detected, the UE proceeds to step 29.
29\. The UE performs a service request if in idle state.
30\. The UE sends a positioning protocol (e.g. LPP) message to the LMF which
is transferred via the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation. The request may indicate
the type of event being reported and includes any location information (e.g.
location measurements or a location estimate) that were requested in step 20.
The UE includes the routing identifier received in step 20 to ensure the
positioning protocol message is sent to the same LMF which instigated the
periodic and triggered location request in step 20.
31\. If inclusion of a location estimate in event reports was requested in
step 5 or step 6, the LMF determines a location estimate for the UE based on
any location measurements or location estimate received in step 30 in the case
of UE trigger event detection or based on UE status or location information
obtained in step 26 in the case of LMF trigger event detection. If necessary
(e.g. to obtain a more accurate location estimate), the LMF may perform UE
positioning as for step 14 of Figure 6.2.3.1-1.
32-35. Steps 30-33 of Figure 6.2.3.3-1 are performed to return an indication
of the trigger event to the external client and a location estimate if this
was requested.
36\. For trigger event detection by the LMF, the LMF continues to monitor for
and detect further trigger events as in steps 26-27 and instigates steps 31-35
each time a trigger event is detected.
37\. For trigger event detection by the UE, the UE continues to monitor for
and detect further trigger events as in step 28 and instigates steps 29-35
each time a trigger event is detected.
#### 6.2.3.5 Low Power Periodic and Triggered 5GC-MT-LR Procedure
Figure 6.2.3.5-1 summarizes a low power variant of the optimized 5GC-MT-LR
procedure in clause 6.2.3.4 for a roaming UE to support periodic and triggered
location. A corresponding procedure for a non-roaming UE would comprise a
subset of the procedure shown in Figure 6.2.3.5-1. This procedure has the same
characteristics as the procedure in Figure 6.2.3.4-1, but in addition:
\- The UE is enabled to report the occurrence of trigger events and provide
associated location information using connectionless transfer.
\- Location determination and UE authentication can occur in non-real time in
the LMF.
\- Location reports from multiple UEs can be batched by the NG-RAN or N3IWF to
the LMF to reduce signalling overhead.
\- Transfer of location reports can be prioritized according to QoS
requirements.
\- The option of employing trigger detection in the LMF is not used.
Figure 6.2.3.5-1: Low Power Periodic and Triggered 5GC-MT-LR for a roaming UE
1-18. Steps 1 to 18 of Figure 6.2.3.3-1 are performed.
19\. Step 20 of Figure 6.2.3.4-1 is performed. In addition, the LMF includes
in the request for periodic or triggered location reporting a request for the
UE to send event reports using connectionless transfer via NG-RAN and includes
one or more UE IDs for connectionless reporting, ciphering information, a
priority indication and criteria for reporting using connectionless transfer
versus a NAS signalling connection.
20\. If the request in step 19 can be supported, the UE returns an
acknowledgment to the LMF in a positioning protocol (e.g. LPP) message. which
is transferred via the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation. The UE indicates in the
acknowledgment whether sending event reports using connectionless transfer is
supported in addition to sending using a NAS signalling connection.
21-24. Steps 21-24 of Figure 6.2.3.3-1 are performed to confirm that event
reporting for periodic or triggered location was activated in the UE and to
return any location estimate for the UE available event obtained at step 18 if
the UE available event was requested at step 5 or step 6.
25\. The UE monitors for occurrence of the trigger event requested in step 19.
The monitoring may occur while the UE is in idle state and/or while the UE is
unreachable from the network (e.g. with eDRX or PSM). The UE may also (e.g.
periodically) request assistance data from the LMF to help determine a
location, if needed to detect a trigger event. When a trigger event is
detected, the UE proceeds to step 26.
26\. The UE determines based on the criteria received in step 19 whether to
report the trigger event using connectionless transfer or a NAS signalling
connection. If the UE is already in connected state or can only access the 5GC
via a type of RAN node which does not support connectionless transfer, the UE
determines to use a NAS signalling connection.
27\. If the UE determines to use a NAS signalling connection at step 26, the
UE performs steps 29-31 of Figure 6.2.3.4-1. The UE then skips steps 28-33.
28\. If the UE determines to use connectionless transfer at step 26, the UE
obtains any location measurements or location estimate requested in step 19.
If the UE is using 3GPP access, the UE determines a suitable temporary serving
cell and requests and obtains a signalling channel with an associated RAN node
in NG-RAN.
29\. The UE sends a positioning message to a RAN node for 3GPP access or an
N3IWF for non-3GPP access. The positioning message includes the routing
identifier for the LMF received in step 19, the UE ID or one of the UE IDs
received in step 19, an authentication code to authenticate the UE ID and the
priority indication received at step 19. The positioning message also includes
a positioning protocol (e.g. LPP) message which includes any location
measurements or location estimate obtained in step 28 and may identify the
type of event being reported. The positioning protocol message may be ciphered
using the ciphering information received at step 19. Other content of the
positioning message is not ciphered.
30\. The UE and the RAN node release the signalling channel in the case of
3GPP access.
Editor\'s note: Details of how a signalling channel would be setup in step 28,
used to transfer a positioning message in step 29 and released in step 30
would be for RAN to determine and are outside the scope of the study in this
TR. Details on authentication of the UE ID would be for SA WG3 to approve or
determine.
31\. For 3GPP access, the RAN node may obtain uplink location measurements of
UE signalling received at step 28 and/or step 29. The RAN node sends a network
positioning message included in an N2 Transport message to an AMF. The network
positioning message includes any uplink location measurements obtained by the
RAN node and the positioning protocol message, the UE ID, the authentication
code and the priority indication received at step 29. The RAN node shall also
include the routing identifier for the LMF received at step 29 in the N2
Transport message. The RAN node may use the priority indication to expedite
sending of the network positioning message and/or to include information for
additional UEs related to the same LMF in the same network positioning
message. Any information for additional UEs would be treated and processed
separately by the LMF.
Editor\'s note: The RAN node may use security mechanism defined by SA WG3 for
the connectionless transfer to protect the system.
32\. The AMF invokes the Namf_Communication_N2InfoNotify service operation
towards the LMF indicated by the routing identifier received in step 31. The
service operation includes the network positioning message received in step
31.
33\. The LMF identifies the UE using the UE ID in the network positioning
message and authenticates the UE ID using the authentication code in the
network positioning message. The LMF then deciphers the positioning protocol
message in the network positioning message if this was ciphered. If inclusion
of a location estimate in event reports was requested in step 5 or step 6, the
LMF uses any uplink location measurements included in the network positioning
messages and any location measurements or location estimate included in the
positioning protocol message to determine or verify a location estimate for
the UE. The LMF may use the priority indication in the network positioning
message to expedite or retard processing of the network positioning message at
step 33.
34-37. Steps 30-33 of Figure 6.2.3.3-1 are performed to return an indication
of the trigger event to the external client and a location estimate if this
was requested.
38\. The UE continues to monitor for and detect further trigger events as in
step 25 and instigates steps 26-37 each time a trigger event is detected.
### 6.2.4 Compatibility with the Location Solution for regulatory services in
Release 15
#### 6.2.4.1 Architectural Compatibility
Figures 6.2.4.1-1 and 6.2.4.1-2 show service based and reference point
representations, respectively, for the non-roaming architecture for the LMF
based solution from Figures 6.2.2-1 and 6.2.2-2, respectively. The figures
also show the differences to the non-roaming architecture for the location
solution for Release 15 in Figures 4.4.4.1-1 and 4.4.4.1-2 in TS 23.501 [4].
The differences are highlighted by showing NFs and reference points which are
present in the Release 15 solution but not in the LMF based solution using
dashed lines and by showing NFs and reference points present for the LMF based
solution but not Release 15 solution using dotted lines.
Figure 6.2.4.1-1: Non-roaming reference architecture for LMF Based Solution
versus Rel-15 Location Solution
Figure 6.2.4.1-2: Non-roaming reference architecture for LMF Based Solution
versus Rel-15 Location Solution in reference point representation
Figures 6.2.4.1-1 and 6.2.4.1-2 show that there are only two major
differences. First, an LRF is present for the Rel‑15 solution but absent for
the LMF based solution. As the LRF provides support for regulatory location
services but not commercial location services (e.g. as described in TS 23.167
[17]), it is not needed for commercial location support by the LMF based
solution. The second difference concerns the replacement of the NLg reference
point between the GMLC and AMF in the location solution in Rel‑15 by an NLg*
reference point between the GMLC and LMF in the LMF based location solution.
The consequences of this are described further down.
Apart from these differences, the Rel‑15 location solution and the LMF based
location solution use the same set of NFs and the same set of reference
points. In a PLMN, in which both solutions were present, the non-roaming
architecture would be as shown in Figures 6.2.4.1-1 and 6.2.4.1-2 with all NFs
and all reference points in each figure being present. This illustrates how
both solutions may coexist in the same PLMN. The coexistence can be associated
with a set of procedures and signalling supported by the common NFs (GMLC,
AMF, LMF, NG-RAN and UE) for regulatory location as defined in Rel‑15 and
another set of procedures and signalling for commercial location as supported
by these common NFs for the LMF based solution.
#### 6.2.4.2 Compatibility on the N1 Reference Point
The description of the procedures for the LMF based solution in clause 6.2.3
shows that AMF service operations defined for Rel‑15 can be used to support
all communication between an LMF and UE for both supplementary services and
positioning for the LMF based location solution. Usage of AMF service
operations in Rel‑15 to support supplementary services occurs in steps 10 and
11 of Figure 6.2.3.1-1, steps 2, 3, 11 and 12 of Figure 6.2.3.2-1, steps 16,
17, 19, 20, 27 and 29 of Figure 6.2.3.3-1, steps 16 and 17 of Figure 6.2.3.4-1
and steps 16, 17, 19 and 20 of Figure 6.2.3.5-1. Transfer of a supplementary
services message from an LMF to a UE in these steps is based on Rel‑15 support
for NAS transport message transfer from an AMF to the UE. Transfer of a
supplementary services message from a UE to an LMF is also based on NAS
transport message transfer to an AMF and makes use of the routing identifier
added for positioning message transfer in clause 4.13.5.4 of TS 23.502 [5] to
identify a destination LMF. The only departure from Rel‑15 is to introduce a
\"default routing identifier\" which is used to route to any LMF, as selected
by an AMF, when transferring an MO-LR request from a UE where there is no
preassigned LMF (e.g. as for steps 2 and 3 of Figure 6.2.3.2-1 and step 27 of
Figure 6.2.3.3-1). This would be a new enhancement but can be backward
compatible with a Release 15 UE by defining a default routing identifier which
can be configured in later UEs and ensuring that the default routing
identifier is never assigned to a particular LMF in any PLMN.
Transfer of positioning messages between an LMF and UE (e.g. as at step 14 of
Figure 6.2.3.1-1, step 6 of Figure 6.2.3.2-1, step 18 of Figure 6.2.3.3-1,
steps 20, 21, 30 and 31 of Figure 6.2.3.4-1) uses the same transfer procedures
as in Rel‑15 as described in clause 4.13.5.4 of TS 23.502 [5], which are based
on Namf communication service operations using NAS transport messages.
With the exception of the default routing identifier, the LMF based solution
introduces no new changes to the N1 reference point and thus could be used
with a legacy UE from Rel‑15 for location procedures (e.g. 5GC-MT-LR without
UE privacy notification) which do not demand new UE functions.
#### 6.2.4.3 Compatibility on the N2 Reference Point
Use of the N2 interface to support message transfer between a UE and LMF for
the LMF based location solution was described on clause 6.2.4.2 and did not
result in any new impacts to the N2 reference point.
The N2 reference point is also used by both the location solution in Release
15 and the LMF based location solution to transfer positioning messages
between an LMF and NG-RAN node to support network assisted positioning and
non-UE associated network assistance data. This occurs for the LMF based
solution in step 14 of Figure 6.2.3.1-1, step 6 of Figure 6.2.3.2-1, steps 18
and 28 of Figure 6.2.3.3-1, steps 18 and 31 of Figure 6.2.3.4-1 and steps 18,
31 and 32 of Figure 6.2.3.5-1. Message transfer for each of these steps uses
AMF service operations and N2 transport operations from Rel‑15, the same as
the location solution in Rel‑15 as described in clauses 4.13.5.5 and 4.13.5.6
in TS 23.502 [5]. There is thus no new impact to the N2 reference point.
#### 6.2.4.4 Compatibility on the NLs Reference Point
For the location solution in Release 15, the NLs reference point supports the
following LMF services and service operations as defined in clause 5.2.15 of
TS 23.502 [5] which are used by a consumer AMF for the Release 15 location
solution.
Table 6.2.4.4-1: LMF Services consumed by an AMF
+-------------+-------------+-------------+-------------+-------------+ | Service | Service | Operation | Release 15 | LMF Based | | Name | Operations | | Location | Solution | | | | Semantics | Consumer | Consumer | +-------------+-------------+-------------+-------------+-------------+ | Nlmf_ | Determ | Reque | AMF | None | | Location | ineLocation | st/Response | | | +-------------+-------------+-------------+-------------+-------------+
The services and service operations in Table 6.2.4.4-1 are not used by the LMF
based solution nor is any other equivalent service needed on any other
reference point. Thus, this portion of the location solution in Rel‑15 does
not need to be replicated in any way for the LMF based solution and can be
used by a PLMN that supports both solutions for regulatory location but not
commercial location.
The NLs reference point also supports the following AMF services and service
operations as defined in clause 5.2.2 of 23.502 [5] which are used by a
consumer LMF for both the Release 15 location solution and the LMF based
location solution.
Table 6.2.4.4-2: AMF Services Consumed by an LMF
+-------------+-------------+-------------+-------------+-------------+ | Service | Service | Operation | Rel-15 | LMF based | | Name | Operations | | Location | solution | | | | Semantic | Consumer | consumer | +-------------+-------------+-------------+-------------+-------------+ | Namf_Co | N1Me | Subscribe / | LMF | LMF | | mmunication | ssageNotify | Notify | | | +-------------+-------------+-------------+-------------+-------------+ | | N1Messa | | note 1 | note 1 | | | geSubscribe | | | | +-------------+-------------+-------------+-------------+-------------+ | | N1Message | | note 1 | note 1 | | | UnSubscribe | | | | +-------------+-------------+-------------+-------------+-------------+ | | N1N2Mess | Request/ | LMF | LMF | | | ageTransfer | Response | | | +-------------+-------------+-------------+-------------+-------------+ | | N2In | Subscribe / | note 1 | note 1 | | | foSubscribe | Notify | | | +-------------+-------------+-------------+-------------+-------------+ | | N2Info | | note 1 | note 1 | | | UnSubscribe | | | | +-------------+-------------+-------------+-------------+-------------+ | | N | | LMF | LMF | | | 2InfoNotify | | | | +-------------+-------------+-------------+-------------+-------------+ | Namf_Ev | Subscribe | Subscribe / | None | LMF | | entExposure | | Notify | | | +-------------+-------------+-------------+-------------+-------------+ | | Unsubscribe | Subscribe / | None | note 1 | | | | Notify | | | +-------------+-------------+-------------+-------------+-------------+ | | Notify | Subscribe / | None | LMF | | | | Notify | | | +-------------+-------------+-------------+-------------+-------------+ | Namf_MT | EnableUER | Reque | None | LMF | | | eachability | st/Response | | | +-------------+-------------+-------------+-------------+-------------+ | NOTE 1: | | | | | | Usage of | | | | | | these | | | | | | service | | | | | | operations | | | | | | by a | | | | | | consumer | | | | | | LMF is not | | | | | | defined but | | | | | | could | | | | | | possibly | | | | | | occur as | | | | | | part of | | | | | | impl | | | | | | ementation. | | | | | +-------------+-------------+-------------+-------------+-------------+
The AMF service operations used for both Release 15 location and the LMF based
location solution provide transfer of positioning messages and, for the LMF
based solution, supplementary services messages, between an LMF and a UE or
NG-RAN node. Except for use of a default routing identifier as discussed in
clause 6.2.4.2, the usage of these service operations is the same for both
solutions.
The additional AMF based service operations used by the LMF based solution but
not the location solution in Release 15 that are shown in Table 6.2.4.4-2
enable an LMF to request an AMF to enable UE reachability and to subscribe to
immediate or later notification of UE reachability and current serving cell
ID. The Namf_EventExposure service operation also enables provision of
information regarding UE subscription to MO-LR service as described for steps
4 and 5 of Figure 6.2.3.2-1. Alternatively, a new AMF (or possibly UDM)
service operation might be defined to enable an LMF to request and obtain this
information. This would be a new impact to an AMF (or UDM) and LMF.
#### 6.2.4.5 Compatibility on the NLg and NLg* Reference Points
For the location solution in Release 15, the NLg reference point supports the
following AMF services and service operations as defined in clause 5.2.15 of
TS 23.502 [5] which are used by a consumer GMLC.
Table 6.2.4.5-1: AMF Services consumed by a GMLC in Release 15
+----------------+--------------------+------------------+--------------------------+ | Service Name | Service Operations | Operation | Rel-15 Location Consumer | | | | | | | | | Semantic | | +----------------+--------------------+------------------+--------------------------+ | Namf_Location | ProvideLocation | Request/Response | GMLC | +----------------+--------------------+------------------+--------------------------+ | | EventNotify | Notify | GMLC | +----------------+--------------------+------------------+--------------------------+
For the LMF based location solution, the NLg* reference point supports the
following LMF services and service operations as defined in clause 6.2.2.2
which are used by a consumer GMLC.
Table 6.2.4.5-2: LMF Services consumed by a GMLC for the LMF based solution
+----------------+----------------+----------------+----------------+ | Service Name | Service | Operation | LMF based | | | Operations | | solution | | | | Semantics | consumer | +----------------+----------------+----------------+----------------+ | Nlmf_P | Obtain UE | Re | GMLC | | rovideLocation | Location | quest/Response | | +----------------+----------------+----------------+----------------+ | Nlm | Report a UE | Notify | GMLC | | f_EventNotify | location | | | | | related event | | | +----------------+----------------+----------------+----------------+
The Namf_Location_ProvideLocation service operation in Release 15 corresponds
to the Nlmf_ProvideLocation service operation for the LMF based solution.
Similarly, the Namf_Location_EventNotify service operation in Release 15
corresponds to the Nlmf_EventNotify service operation for the LMF based
solution. The main differences between these corresponding service operations
are as follows:
\- The service operations are provided by an AMF in Release 15 and by an LMF
for the LMF based solution.
\- The service operations support access to regulatory location services in
Release 15 and to commercial location services for the LMF based solution.
The first difference transfers functional support from an AMF in Release 15 to
an LMF for the LMF based solution. For a PLMN already supporting regulatory
location services, this would increase LMF impacts but not AMF impacts. For a
PLMN supporting commercial location services only, this would avoid new AMF
impact at the expense of location impact to an LMF.
The second difference would be associated with different message content at
stage 3 and different procedures for supporting the service operations at a
GMLC. The same type of difference occurs for support of location for
regulatory services and commercial based services for EPS with regard to the
Provide-Location-Request/Answer and Location-Report-Request/Answer Diameter
commands for the MME-GMLC SLg interface defined in TS 29.172 [18]. In the case
of EPS, a common protocol is used for both types of location although the
message content and procedures are partly different. This suggests that the
protocols defined to support the service operations in Table 6.2.4.5-1 for
Release 15 in TS 29.518 [19] might be enhanced to support the service
operations in Table 6.2.4.5-2 for the LMF based solution which would reduce
stage 3 standardization. As an alternative, a new protocol might be defined
for the NLg* reference point for the LMF based solution which reuses
parameters defined in TS 29.518 [19] for the NLg reference point. The
extension of the protocol in TS 29.518 [19] for the NLg reference point or, at
least, the reuse of existing parameters for this protocol would reduce
standardization impacts for the NLg* interface (compared to defining a new
protocol from scratch) and would reduce impacts to support this protocol in
any GMLC that already supports the location solution in Release 15.
#### 6.2.4.6 Compatibility on the NLh Reference Point
For the location solution in Release 15, the NLh reference point supports the
following UDM services and service operations as defined in clause 5.2.3 of TS
23.502 [5] which are used by a consumer GMLC for the Release 15 location
solution and for the LMF based location solution:
Table 6.2.4.6-1: NF services provided by UDM
+-------------+-------------+-------------+-------------+-------------+ | NF service | Service | Operation | Rel-15 | LMF based | | | Operations | Semantics | Location | solution | | | | | Consumer | consumer | +-------------+-------------+-------------+-------------+-------------+ | UE Context | **Get** | Reque | GMLC | GMLC | | | | st/Response | | | | Management | | | | | | (UECM) | | | | | +-------------+-------------+-------------+-------------+-------------+
For the location solution in Release 15, this service operation is invoked by
a GMLC using the GPSI or SUPI of the target UE and returns the serving AMF
address. For the LMF based solution, the service operation is invoked by a
GMLC using the GPSI or SUPI of the target UE and returns the serving AMF
address and optionally a VGMLC address, an LMF address and/or subscribed
privacy requirements. The service operation in Release 15 would thus be
extended to support the LMF based solution.
### 6.2.5 Impacts on existing entities and interfaces
Impacts to existing entities and interfaces are described here in terms of the
additional impacts or reduced impacts compared to the 5GC location solution
for regulatory services defined in Release 15. Impacts are categorized as
follows:
New An all new impact with no counterpart in Release 15 and no other existing
impact.
Same The same impact as in Release 15.
Same +/- X The same impact as in Release 15 plus or minus X.
Commercial Impact solely due to commercial location (e.g. privacy, LCS Client
identification.
Existing An impact that already exists in Rel-15 for EPS and is the same
impact for 5GS.
#### 6.2.5.1 Impacts to UDM and Nudm SBI
The Nudm_UE ContextManagement service operation defined in TS 23.502 [5] in
Release 15 for use by as GMLC in obtaining the serving AMF address for a 5GC-
MT-LR can be reused by the LMF Based solution without significant change. The
only difference to Release 15 would be to enable the service operation to be
used by an GMLC in a different PLMN than the HPLMN to support roaming
scenarios.
UDM impact: same.
Nudm SBI impact: same + inter-PLMN support.
When slicing dependent location service is supported, the Nudm SBI needs to
support the providing of S-NSSAI in the Nudm_CM_Get response.
#### 6.2.5.2 Impacts to GMLC and Ngmlc SBI
No Ngmlc SBI is defined in Release 15 and none is needed for the LMF Based
solution.
However, the GMLC is a consumer of several SBIs and performs certain other
actions associated with receiving a location request from another GMLC or LCS
Client, sending a location request to another GMLC or LMF and selecting an
LMF. The impacts are summarized in Tables 6.2.5.2-1 and 6.2.5.2.-2 for a VGMLC
and HGMLC, respectively, for the different location procedures described in
clause 6.2.3 and are compared with corresponding GMLC impacts defined in
Release 15. In a non-roaming scenario, a GMLC would have both the VGMLC and
HGMLC impacts except for the GMLC-GMLC interaction which would not be an
impact.
Table 6.2.5.2-1: VGMLC Impacts for the LMF Based Solution
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Receive a location | None | | | request for a target | | | Periodic Triggered | UE from an HGMLC and | | | 5GC-MT-LR | return a location | | | | response | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Select an LMF in the | None | | | VPLMN | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Obtain a location | Obtain a location | | | estimate for a | estimate for a | | | target UE from an | target UE from an | | | LMF using the Nlmf | AMF using the Namf | | | ProvideLocation | Location | | | service operation. | ProvideLocation | | | | service operation. | | | The Nlmf | | | | ProvideLocation | | | | service operation | | | | can be an extension | | | | of the Namf Location | | | | ProvideLocation | | | | service operation at | | | | a stage 3 level with | | | | additional support | | | | for commercial | | | | location. | | | | | | | | Impact: Same + | | | | commercial | | +----------------------+----------------------+----------------------+ | 5GC-MO-LR TTTP | Receive a location | Receive a location | | | estimate for a UE | estimate for a UE | | | from an LMF using | for an emergency | | | the Nlmf EventNotify | services call from | | | service operation | an AMF using the | | | and transfer to an | Namf Location | | | HGMLC. | EventNotify service | | | | operation and | | | The Nlmf EventNotify | provide to a PSAP. | | | service operation | | | | can be an extension | | | | of the Namf | | | | ProvideLocation | | | | service operation at | | | | a stage 3 level. | | | | | | | | Impact: same + | | | | commercial | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Receive periodic (or | Receive a location | | | triggered) location | estimate for a UE | | 5GC-MT-LR | responses from an | for an emergency | | | LMF using the LMF | services call from | | | EventNotify service | an AMF using the | | | operation and | Namf Location | | | transfer to an HGMLC | EventNotify service | | | | operation and | | | The Nlmf | provide to a PSAP. | | | ProvideLocation | | | | service operation | | | | can be an extension | | | | of the Namf Location | | | | ProvideLocation | | | | service operation at | | | | a stage 3 level with | | | | additional support | | | | for commercial | | | | location and event | | | | triggers. | | | | | | | | Impact: Same + | | | | commercial + event | | | | triggers | | +----------------------+----------------------+----------------------+
Table 6.2.5.2-3: HGMLC Impacts for the LMF Based Solution
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Receive a location | Receive a location | | | request for a target | request for a target | | Periodic / Triggered | UE from an LCS | UE from an LCS | | 5GC-MT-LR | Client and return a | Client for | | | location response | regulatory services | | | | and return a | | | Impact: same + | location response. | | | commercial | | +----------------------+----------------------+----------------------+ | | Verify LCS Client | None | | | authorization and | | | | target UE privacy | | | | requirements. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Query UDM for | Query UDM for | | | serving AMF address | serving AMF address | | | and optionally LMF | | | | address and VGMLC | | | | address | | | | | | | | Impact: same + | | | | LMF/VGLMC address | | | | query option | | +----------------------+----------------------+----------------------+ | | Select a VGMLC in a | None | | | VPLMN | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Obtain a location | None | | | estimate for a | | | | target UE from a | | | | VGMLC | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | 5GC-MO-LR | Receive a location | None | | | estimate for a UE | | | | from a VGMLC and | | | | transfer to an LCS | | | | Client. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Assign a reference | None | | | number to a periodic | | | 5GC-MT-LR | or triggered | | | | 5GC-MT-LR. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Receive periodic (or | None | | | triggered) location | | | | responses from a | | | | VGMLC and transfer | | | | to an LCS Client. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+
#### 6.2.5.3 Impacts to LMF and Nlmf SBI
For the LMF based solution, the LMF needs to support the Nlmf_ProvideLocation
and Nlmf_EventNotify service operations shown in Table 6.2.2.2-1. The
Nlmf_Location_DetermineLocation service operation defined in Rel-15 is not
needed for the LMF Based solution.
Other impacts for the LMF are summarized below and are compared with LMF
impacts already defined in Release 15.
Table 6.2.5.3-1: LMF Impacts for the LMF Based Solution
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Receive a location | None | | | request for a target | | | Periodic / triggered | UE from a VGMLC | | | 5GC-MT-LR | using the Nlmf | | | | ProvideLocation | | | | service operation | | | | and return a | | | | location response. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Use the NRF service | The same impact | | | to select another | seems needed for a | | | AMF when a previous | 5GC-MT-LR or | | | serving AMF is not | 5GC-MT-LR without | | | available. | UDM Query at a GMLC | | | | though it is not yet | | | Impact: appears the | defined. | | | same as needed for a | | | | GMLC in Rel-15 | | +----------------------+----------------------+----------------------+ | | Verify reachability | None | | | of a target UE using | | | | the Namf | | | | MT_ | | | | EnableUEReachability | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Verify UE privacy | None | | | requirements based | | | | on privacy | | | | requirements | | | | received from an | | | | HGMLC. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Obtain UE status | None | | | information (and | | | Periodic / Triggered | subscription | | | 5GC-MT-LR | information for a | | | | 5GC-MO-LR) using the | | | 5GC-MO-LR | Namf UEStatus | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Obtain downlink | Obtain downlink | | | location | location | | | measurements or a | measurements or a | | | location estimate | location estimate | | | from a target UE | from a target UE | | | using the Namf | using the Namf | | | Communication | Communication | | | N1N2MessageTransfer | N1N2MessageTransfer | | | and | and | | | Namf_Communicat | Namf_Communicat | | | ion_N1MessageNotify | ion_N1MessageNotify | | | service operations. | service operations. | | | | | | | Impact: same | | +----------------------+----------------------+----------------------+ | | Obtain uplink | Obtain uplink | | | location | location | | | measurements for a | measurements for a | | | target UE from the | target UE from the | | | NG-RAN using the | NG RAN using the | | | Namf Communication | Namf Communication | | | N1N2MessageTransfer | N1N2MessageTransfer | | | and | and | | | Namf_Communi | Namf_Communi | | | cation_N2InfoNotify | cation_N2InfoNotify | | | service operations. | service operations. | | | | | | | Impact: same | | +----------------------+----------------------+----------------------+ | | Obtain non-UE | Obtain non-UE | | | associated network | associated network | | | assistance data from | assistance data from | | | the NG-RAN using the | the NG-RAN using the | | | Namf Communication | Namf Communication | | | N1N2MessageTransfer | N1N2MessageTransfer | | | and | and | | | Namf_Communi | Namf_Communi | | | cation_N2InfoNotify | cation_N2InfoNotify | | | service operations. | service operation. | | | | | | | Impact: same | | +----------------------+----------------------+----------------------+ | | Compute a location | Compute a location | | | estimate for a | estimate for a | | | target UE based on | target UE based on | | | information obtained | information obtained | | | from the UE and/or | from the UE and/or | | | NG-RAN. | NG-RAN. | | | | | | | Impact: same | | +----------------------+----------------------+----------------------+ | | Continue location | None | | | for a target UE | | | | after inter-AMF | | | | handover. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | 5GC-MO-LR | Receive a | None | | | supplementary | | | | services MO-LR | | | | request from a UE | | | | using the Namf | | | | Communication | | | | N1MessageNotify | | | | service operation | | | | and return a | | | | response to the UE | | | | containing any | | | | location estimate | | | | obtained using the | | | | Namf Communication | | | | N1N2MessageTransfer | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | For TTTP, select a | None | | | VGMLC and send a | | | | location for the UE | | | | to the VGMLC using | | | | the Nlmf EventNotify | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Verify UE | None | | | subscription to an | | | | MO-LR using UE | | | | subscription | | | | information obtained | | | | from the serving | | | | AMF. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | For an MO-LR for | None | | | transfer of | | | | assistance data, | | | | transfer requested | | | | assistance data to | | | | the UE using the | | | | Namf Communication | | | | N1N2MessageTransfer | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Send a location | None | | | event report to the | | | 5GC-MT-LR | VGMLC using the Nlmf | | | | EventNotify service | | | | operation to confirm | | | | activation in the UE | | | | of triggered or | | | | periodic location. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Select a VGMLC and | None | | | send a location | | | | event report to the | | | | VGMLC using the Nlmf | | | | EventNotify service | | | | operation for each | | | | periodic or | | | | triggered location | | | | event detected by | | | | the UE (or LMF). | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Send a supplementary | None | | | services LCS | | | 5GC-MT-LR | Periodic-Triggered | | | | Event Invoke to a | | | (not optimized) | target UE to | | | | activate periodic or | | | | triggered location | | | | in the UE using the | | | | Namf Communication | | | | N1N2MessageTransfer | | | | service operation. | | | | Receive a | | | | confirmation from | | | | the UE using the | | | | Namf Communication | | | | N1MessageNotify | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Receive a | None | | | supplementary | | | | services MO-LR | | | | request from a UE | | | | using the Namf | | | | Communication | | | | N1MessageNotify | | | | service operation | | | | for each periodic or | | | | triggered location | | | | event detected by | | | | the UE. | | | | | | | | Return a response to | | | | the UE confirming | | | | receipt using the | | | | Namf Communication | | | | N1N2MessageTransfer | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Optionally monitor | None | | | and detect periodic | | | 5GC-MT-LR | or triggered | | | | location events. | | | (optimized) | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Send a positioning | None | | | protocol (e.g. LPP) | | | | message to a target | | | | UE to activate | | | | periodic or | | | | triggered location | | | | in the UE using the | | | | Namf Communication | | | | N1N2MessageTransfer | | | | service operation. | | | | Receive a | | | | confirmation from | | | | the UE using the | | | | Namf Communication | | | | N1MessageNotify | | | | service operation. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Receive a | None | | | positioning protocol | | | | (e.g. LPP) message | | | | from a UE using the | | | | Namf Communication | | | | N1MessageNotify | | | | service operation | | | | for each periodic or | | | | triggered location | | | | event detected by | | | | the UE. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Assign and include | None | | | UE IDs, ciphering | | | 5GC-MT-LR | information, a | | | | priority indication | | | (low power) | and criteria for use | | | | of NG-RAN | | | | connectionless | | | | transfer in the | | | | positioning protocol | | | | message sent to a | | | | target UE to | | | | activate periodic or | | | | triggered location | | | | in the UE. | | +----------------------+----------------------+----------------------+ | | Receive a network | None | | | positioning message | | | | for an event report | | | | from a UE sent using | | | | connectionless | | | | NG-RAN transfer, and | | | | authenticate a UE ID | | | | and decipher an | | | | included positioning | | | | protocol message. | | +----------------------+----------------------+----------------------+
#### 6.2.5.4 Impacts to UE
For the LMF based solution, impacts for the UE are summarized below and are
compared with LMF impacts already defined in Release 15.
Table 6.2.5.4-1: UE Impacts for the LMF Based Solution
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Receive a | None | | | supplementary | | | Periodic / triggered | services request | | | 5GC-MT-LR | from an LMF for | | | | privacy notification | | | | and/or verification. | | | | Verify user privacy | | | | requirements if | | | | requested and return | | | | a supplementary | | | | services response to | | | | the LMF. | | | | | | | | The supplementary | | | | services request is | | | | already defined for | | | | EPS. | | | | | | | | Impact: existing | | +----------------------+----------------------+----------------------+ | 5GC-MT-LR | Receive a DL | Supports a UE | | | positioning message | Assisted and UE | | Periodic / Triggered | from an LMF to | Based Positioning | | 5GC-MT-LR | request UE | Procedure. | | | positioning | | | 5GC-MO-LR | capabilities, | | | | provide assistance | | | | data or request | | | | location | | | | information. Obtain | | | | any requested | | | | location | | | | information. Return | | | | any requested | | | | capabilities or | | | | location information | | | | to the LMF. | | | | | | | | From a UE | | | | perspective, the | | | | positioning | | | | interaction can be | | | | the same as in | | | | Rel-15. | | | | | | | | Impact: same | | +----------------------+----------------------+----------------------+ | 5GC-MO-LR | Send a supplementary | None | | | services MO-LR | | | | request to an LMF | | | | via the serving AMF | | | | to request a | | | | location estimate, | | | | assistance data or | | | | TTTP. Receive a | | | | response from the | | | | LMF via the AMF. | | | | | | | | The supplementary | | | | services request is | | | | already defined for | | | | EPS and transfer of | | | | the MO-LR van use | | | | the same NAS | | | | transport message as | | | | used to send | | | | positioning | | | | messages. Thus, the | | | | new impact is small | | | | | | | | Impact: existing | | | | plus small addition | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Monitor for and | None | | | detect periodic or | | | 5GC-MT-LR | triggered location | | | | events. Optionally | | | | obtain a location | | | | estimate when a | | | | location event is | | | | detected. | | | | | | | | This impact is | | | | already defined for | | | | EPS. | | | | | | | | Impact: existing | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Receive a | None | | | supplementary | | | 5GC-MT-LR | services LCS | | | | Periodic-Triggered | | | (not optimized) | Event Invoke from an | | | | LMF via the serving | | | | AMF to activate | | | | periodic or | | | | triggered location | | | | in the UE. Return a | | | | confirmation to the | | | | LMF. | | | | | | | | The supplementary | | | | services messages | | | | are already defined | | | | for EPS and transfer | | | | can use the same NAS | | | | transport message as | | | | used to send | | | | positioning | | | | messages. Thus, the | | | | new impact is small | | | | | | | | Impact: existing | | | | plus small addition | | +----------------------+----------------------+----------------------+ | | Send a supplementary | None | | | services MO-LR | | | | request to an LMF | | | | for each periodic or | | | | triggered location | | | | event detected by | | | | the UE and receive a | | | | confirmation | | | | response from the | | | | LMF. | | | | | | | | This impact is | | | | already defined for | | | | EPS. | | | | | | | | Impact: existing | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Receive a | None | | | positioning protocol | | | 5GC-MT-LR | (e.g. LPP) message | | | | from an LMF via the | | | (optimized) | serving AMF to | | | | activate periodic or | | | | triggered location | | | | in the UE. Return a | | | | confirmation to the | | | | LMF. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | | Send a positioning | None | | | protocol (e.g. LPP) | | | | message to the LMF | | | | for each periodic or | | | | triggered location | | | | event detected by | | | | the UE. | | | | | | | | Impact: new | | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Receive UE IDs, | None | | | ciphering | | | 5GC-MT-LR | information, a | | | | priority indication | | | (low power) | and criteria for use | | | | of NG-RAN | | | | connectionless | | | | transfer in the | | | | positioning protocol | | | | message which | | | | activates periodic | | | | or triggered | | | | location in the UE. | | +----------------------+----------------------+----------------------+ | | Depending on the | None | | | received criteria, | | | | send event reports | | | | using NG-RAN | | | | connectionless | | | | transfer, including | | | | obtaining a | | | | signalling channel | | | | to a nearby RAN node | | | | and sending a | | | | positioning message | | | | containing a UE ID, | | | | an authentication | | | | code and a | | | | positioning protocol | | | | message containing | | | | event and location | | | | information. | | +----------------------+----------------------+----------------------+
#### 6.2.5.5 Impacts to AMF and Namf SBI
The LMF based solution uses service based operations already defined for the
AMF in TS 23.502 [5] except for the Namf_Location service operations which are
not needed. However, to support a 5GC-MO-LR, it is assumed that the Namf
EventExposure service operation is extended to allow provision of UE
subscription information for an MO-LR. An alternative could be a new Namf
service operation. A decision on preferred support is FFS.
#### 6.2.5.6 Impacts to the NG-RAN
Except for support of a Periodic / Triggered 5GC-MT-LR using the low power
procedure in clause 6.2.3.5, there are no new impacts to the NG-RAN beyond
what is already defined in Rel‑15. However, in order to support new
positioning methods (e.g. for NR), there may be new impacts, although these
would not be specific to the LMF based solution.
For a Periodic / Triggered 5GC-MT-LR using the low power procedure in clause
6.2.3.5, an NG-RAN node needs to support the following:
\- setup and release of a temporary signalling channel to a UE.
\- receive a positioning message from a UE containing a positioning protocol
message, a routing ID and other parameters.
\- optionally obtain UL location measurements for the UE.
\- send a network positioning message, containing the information from the UE
and any UL location measurements, to an LMF identified by the routing ID via
an AMF.
More details of these impacts would need to be determined by RAN.
### 6.2.6 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.3 Solution 3: Enhancement to LCS architecture
### 6.3.1 Description
This solution addresses the Key Issue 1 \"Enhancement to LCS architecture\".
Key architecture principles:
\- Support of function flexibility and scalability: location management
function can be flexibly deployed, e.g. near UEs, the position signalling can
be efficiently transferred to reduce latency and avoid overload on UE and
network.
\- SBA support: the NFs related to LCS supports SBI and the NF services, the
clearer function decoupling among NFs to avoid the function duplication
between NFs.
\- Support service exposure: support the service exposure framework specified
in R-15, and NEF provides location service exposure to external applications.
\- Enable network slice: one network slice may have its separate location
management function, and it can also support its specific positioning
technologies.
### 6.3.2 Reference LCS architecture
The reference LCS architecture consist of the following network functions and
entities:
\- Location Management Function (LMF).
\- Access and Mobility Management Function (AMF).
\- User plane Connection Function (UCF).
\- Unified Data Management Function (UDM).
\- Network Exposure Function (NEF).
\- GMLC.
The non-roaming LCS architecture is indicated in the figure below:
Figure 6.3.2-1: non-roaming LCS reference architecture
The roaming LCS architecture is indicated in the figure below:
Figure 6.3.2-2: roaming LCS reference architecture
In roaming scenario, H-LMF in HPLMN performs privacy check for location
service request from applications and then request V-LMF to obtain UE location
if the location service request is allowed. In case that the position
signalling between UE and V-LMF is transferred via user plane, the local-
breakout PDU session is used to establish the connection between UE and UCF.
The application functions in VPLMN may be allowed to obtain location service
via NEF in VPLMN.
### 6.3.2 Functional Description
The LMF includes the following functionality:
\- Handle the location service request from UE, NEF and GMLC.
\- Support privacy check on location service request according to privacy
profile.
\- Supports location determination for a UE.
\- Obtains downlink location measurements or a location estimate from the UE
via control plane routing and/or user plane routing.
\- Obtains uplink location measurements from the NG RAN.
\- Obtains non-UE associated assistance data from the NG RAN.
\- Generates charging records for location service.
The AMF includes the following functionality:
\- Transfer the position signalling between LMF and RAN, between UE and LMF
via control plane routing.
\- Select LMF for the UE when UE registers the network.
The NEF includes the following functionality:
\- Exposure of location service to application functions.
\- Interact with LMF to address Location service request.
The UCF includes the following functionality:
\- Support the signalling transfer between UE and LMF via user plane.
Editor\'s note: Functionalities and procedures related to UCF are to be
defined.
The UDM includes the following functionality:
\- Maintain LCS subscription data and privacy profile.
\- Maintain the position context: the serving NFs for positioning, the
requested positioning service, e.g. LDR information for one UE.
The GMLC includes the following functionality:
\- Interaction with the legacy LRF and LCS client to support the interworking.
\- Request positioning service from LMF.
### 6.3.4 Impacts on existing entities and interfaces
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.3.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.4 Solution 4: Positioning operations considering different LMF deployment
scenarios
### 6.4.1 Introduction
This solution applies to Key Issue#3 \"Support of low latency LCS\" and has
objectives to cover the following aspects from the KI#3 study: support of
different latency levels and reduce network resource usage related to
positioning operations by considering different LMF deployment scenarios.
### 6.4.2 Functional Description
#### 6.4.2.1 Common Functionality
Solution principles include the possibility for the LMF selection by
considering LMF deployment scenarios such as centrally located LMF (LMFc) and
distributed LMF (LMFd) located close to or at the access network site. The
selection of the LMF shall also enable deployment of LMF with different
capabilities, e.g. LMFs supporting no or a subset of optional functionalities.
The following factors may be considered during the LMF selection:
\- Requested Quality of Service information, e.g.
\- LCS accuracy,
\- Response time (latency),
\- LCS QoS Class.
\- Proximity of the requestor and target UE,
\- Access Type (3GPP / N3GPP),
\- 5G AN type (i.e. 5G NR or eLTE) and the serving AN node (i.e. gNB or NG-
eNB) of the target UE,
\- RAN configuration information,
\- LMF capabilities,
\- LMF load,
\- Indication of either a single event report or multiple event reports,
\- Duration of event reporting,
\- Network slicing information, e.g. S-NSSAI and NSI ID.
Editor\'s note: It is FFS what other information may be considered for LMF
selection.
#### 6.4.2.2 Solution 4A: AMF based selection solution with positioning
signalling via AMF
In the Solution 4A, the flows after the LCS request is received by the AMF
are:
1\. The AMF selects an LMF (LMFc or LMFd) and communicates the request to it
over NLs.
2\. The LMF instigates location operations with the gNB/UE to obtain
positioning measurements, a location estimate or to transfer location
assistance data, e.g. interacts with a gNB to arrange and get measurements, or
with the UE for downlink positioning operation involving OTDOA.
3\. The LMF computes the position estimate and returns it to the AMF over NLs.
4\. The AMF forwards it to the requesting entity (e.g. UE or GMLC).
It is assumed that the AMF has the NLs interface with the LMFd (i.e. as it is
now for the AMF and LMFc). The positioning signalling between the LMFd and the
gNB/UE at the steps 3 and 4 in this solution is based on routing of the
NRPP/NRPPa messages that goes over NLs, N2, Uu (via NLs-AP and NAS). It is
transparent to the AMF, but always go through the AMF acting as a router of
the messages.
#### 6.4.2.3 Solution 4B: LMF centric based selection solution
In the solution 4B the concept of centrally located LMF and distributed
located LMFs is adapted for the LMF centric architecture that presented in
this TR as Solution 2 \"LMF Based Location Solution\" in clause 6.2. The
specific of the LMF centric solution is that a MT-LR comes from the GMLC to
the LMF instead of the AMF as in case of the traditional LCS architecture.
NOTE: In Solution 2 (clause 6.2.3.1) the UE location is not known at cell
level until the AMF has returned reachability information to the LMF (i.e.
LMFc). The LMFc can use the NRF service to request a set of the available
LMFds or be interconnected and configured with the available LMFds (e.g. via
an operator IP intranet).
When a positioning request comes to the LMF (i.e. LMFc), the LMFc may
determine either to instigate location procedures with the UE/gNB by itself or
to trigger the location procedures at an LMFd (e.g. based on the requested
positioning QoS information). To support selection of an appropriate LMFd, the
LMF obtains reachability information (e.g. serving cell identity) from the
AMF. The LMF may then select an LMFd and to proxy for an LMFd forwarding to it
the positioning request and the reachability information. Subsequent
positioning operations depending on the used positioning methods take place
between the LMFd and the UE, and/or between the LMFd and the gNB. When a
location result is obtained, the LMFd returns it to the LMF, which passes it
towards a LCS client via GMLC. For the requesting entity, it looks as if the
LMF computed the position itself.
### 6.4.3 Procedures
#### 6.4.3.1 Procedures for the Solution 4A
##### 6.4.3.1.1 5GC-MO-LR Procedure for the Solution 4A
Figure 6.4.3.1-1 shows a 5GC Mobile Originated Location Request (5GC-MO-LR)
procedure for AMF based selection solution where the positioning signalling
between the LMF and the gNB/UE goes always via the AMF to route the NRPP/NRPPa
messages.
Figure 6.4.3.1-1: 5GC Mobile Originated Location Request (5GC-MO-LR) for
positioning signalling going through AMF
1\. The UE with a LCS client requests some location service (e.g. positioning
or delivery of assistance data) to the serving AMF at the NAS level. The LCS
client may also request a specific LCS QoS.
2\. Depending on the requested LCS QoS (e.g. assured or best effort
positioning QoS class as defined in TS 22.071 [3]) AMF makes LMF selection.
3\. Either: the AMF invokes the Namf_Communication_N1MessageNotify service
operation to forward the location service request to a LMFd.
4\. or the AMF invokes the Namf_Communication_N1MessageNotify service
operation to transfer the location service request to a LMFc.
5a. The selected LMF instigates location procedures with the serving gNB for
the UE - e.g. to obtain positioning measurements or assistance data.
5b. In addition to step 5a or instead of step 5a, for downlink positioning the
selected LMF instigates location procedures with the UE \- e.g. to obtain a
location estimate or positioning measurements or to transfer location
assistance data to the UE.
5c. For uplink positioning in addition to performing step 5a, the selected LMF
instigates location procedures with gNB for the target UE - e.g. to obtain
positioning measurements.
6\. If step 3 was performed, the LMFd invokes the Namf_Communication
_N1N2MessageTransfer service operation to provide a location service response
to the AMF and includes any needed results - e.g. success or failure
indication and, if requested and obtained, a location estimate for the UE.
7\. If step 4 was performed, the LMFc invokes the Namf_Communication
_N1N2MessageTransfer service operation to provide a location service response
to the AMF and includes any needed results - e.g. success or failure
indication and, if requested and obtained, a location estimate for the UE.
8\. The AMF returns a location service response to the UE and includes any
needed results - e.g. a location estimate for the UE.
##### 6.4.3.1.2 5GC-MT-LR Procedure for the Solution 4A
Figure 6.4.3.1-2 shows a 5GC Mobile Terminated Location Request (5GC-MT-LR)
procedure for AMF based selection solution where the positioning signalling
between the LMF and the gNB/UE goes always via the AMF to route the NRPP/NRPPa
messages.
Figure 6.4.3.1-2: 5GC Mobile Terminated Location Request (5GC-MT-LR) for
positioning signalling going through AMF
1\. The external LCS client sends a location service request to the GMLC for a
location the target UE. The LCS client may also request a specific LCS QoS.
2\. The GMLC invokes the Namf_Location_ProvideLocation service operation
towards the AMF to request the current location of the UE.
3\. Depending on the requested LCS QoS (e.g. assured or best effort
positioning QoS class as defined in TS 22.071 [3]) AMF makes LMF selection.
4\. Either: the AMF invokes the Nlmf_Location_ProvideLocation Request service
operation to forward the location service request to a LMFd.
5\. or the AMF invokes the Nlmf_Location_ProvideLocation Request service
operation to transfer the location service request to a LMFc.
6a. The selected LMF instigates location procedures with the serving gNB for
the UE - e.g. to obtain positioning measurements or assistance data.
6b. In addition to step 6a or instead of step 6a, for downlink positioning the
selected LMF instigates location procedures with the UE \- e.g. to obtain a
location estimate or positioning measurements or to transfer location
assistance data to the UE.
6c. For uplink positioning in addition to performing step 6a, the selected LMF
instigates location procedures with gNB for the target UE - e.g. to obtain
positioning measurements.
7\. If step 4 was performed, the LMFd invokes the
Nlmf_Location_DetermineLocation service operation to provide a location
service response to the AMF and includes any needed results - e.g. success or
failure indication and, if requested and obtained, a location estimate for the
UE.
8\. If step 5 was performed, the LMFc invokes the
Nlmf_Location_DetermineLocation service operation to provide a location
service response to the AMF and includes any needed results - e.g. success or
failure indication and, if requested and obtained, a location estimate for the
UE.
9\. The AMF invokes the Namf_Location_ProvideLocation service operation
towards the GMLC to response the current location of the UE.
10\. The GMLC forwards the location service response to the LCS client.
#### 6.4.3.2 Procedures for the Solution 4B
#### 6.4.3.2.1 5GC-MT-LR Procedure for the Solution 4B
The 5G MT-LR procedure for the LMF centric solution (Solution 2) from clause
6.2.3.1 (Figure 6.2.3.1-1) is considered as a reference baseline.
A high level flow diagram (MT-LR) to support the concept of centrally located
LMF and distributed located LMFs for the LMF centric architecture is shown in
Figure 6.4.3.2-1.
Figure 6.4.3.2-1: 5GC Mobile Terminated Location Request (5GC-MT-LR) for a
roaming UE in the LMF centric architecture with different LMF deployment
scenarios
Prior to step 5, the MT-LR performs steps similar to the steps 1-4 of Figure
6.2.3.1-1 (see clause 6.2.3.1 for the step description).
At the step 5 the VGMLC invokes the Nlmf_ProvideLocation Request service
operation to forward the location request to the LMF (i.e. LMFc). The step 5
and the steps 7-15 are performed in a manner similar to the corresponding
steps of Figure 6.2.3.1-1 (see clause 6.2.3.1). Note that as a result of the
steps 9, 12, 13 the LMF gets the UE reachability information (e.g. the UE
serving cell identity) from the AMF.
Some more steps, namely, 13a, 13b, and 14a are introduced additionally to
support the different LMF deployment scenarios (see Figure 6.4.3.2-1) for the
LMF centric architecture:
13a. Based on the UE reachability information and depending on the requested
LCS QoS (or/and other factors mentioned in 6.4.2.1) the LMFc determines either
to instigate location procedures by itself or delegate the location procedures
to an LMFd. In the former case, the flows are the same as in Solution 2
(clause 6.2.3.1, the steps 7-18). In the latter case, the LMFc determines an
appropriate LMFd where the request is preferable to be served and the steps
13b and 14a are involved.
13b. The LMFc invokes the Nlmf_Location_DetermineLocation service operation to
request the LMFd to get the UE location result by triggering the positioning
operation of step 14. The service operation includes the serving cell
identity, the client type and may include the required QoS. The positioning
operation of step 14 encompasses various interactions between the LMFd and the
NG-RAN node (e.g. gNB) or the UE. The LMFd has the protocol termination
functions of an LMF, e.g. it can terminate an NRPPa protocol with the NG-RAN
node and an NRPP protocol with the UE.
14a. After the UE positioning operation of step 14, the LMFd invokes the
Nlmf_Location_DetermineLocation Response service operation to return any
needed results to the LMFc (e.g. a location estimate for the UE or obtained
measurements for a final computation of the position).
At the step 15 the LMFc returns the location result to the VGMLC in the
Nlmf_ProvideLocation_Response message and LCS service response is forwarded to
the LCS client (steps 16 and 18 in Figure 6.2.3.1-1).
#### 6.4.3.2.2 5GC-MO-LR Procedure for the Solution 4B
The 5G MO-LR procedure for the LMF centric solution (Solution 2) from clause
6.2.3.2 (Figure 6.2.3.2-1) is considered as a reference baseline.
A high level flow diagram (MO-LR) to support the concept of centrally located
LMF and distributed located LMFs for the LMF centric architecture is shown in
Figure 6.4.3.2-2.
Figure 6.4.3.2-2: 5GC Mobile Originated Location Request (5GC-MO-LR) for a
roaming UE in the LMF centric architecture with different LMF deployment
scenarios
The MO-LR performs steps similar to the steps 1-5 of Figure 6.2.3.2-1 (see
clause 6.2.3.2 for the step description).
NOTE: As a result of the steps 3-5 the LMF gets the UE reachability
information (e.g. the UE serving cell identity) from the AMF.
Some more steps, namely, 5a, 5b, and 6a are introduced additionally to support
the different LMF deployment scenarios (see Figure 6.4.3.2-2) for the LMF
centric architecture:
5a. Based on the UE reachability information and depending on the requested
LCS QoS (or/and other factors mentioned in 6.4.2.1) the LMFc determines either
to instigate location procedures by itself or delegate the location procedures
to an LMFd. In the former case, the flows are the same as in Solution 2
(clause 6.2.3.2, the steps 7-12). In the latter case, the LMFc determines an
appropriate LMFd where the request is preferable to be served and the steps 5b
and 6a are involved.
5b. The LMFc invokes the Nlmf_Location_DetermineLocation service operation to
request the LMFd to get the UE location result by triggering the positioning
operation of step 6. The service operation includes the serving cell identity,
the client type and may include the required QoS. The positioning operation of
step 6 encompasses various interactions between the LMFd and the NG-RAN node
(e.g. gNB) or the UE. The LMFd has the protocol termination functions of an
LMF, e.g. it can terminate an NRPPa protocol with the NG-RAN node and an NRPP
protocol with the UE.
6a. After the UE positioning operation of step 6, the LMFd invokes the
Nlmf_Location_DetermineLocation Response service operation to return any
needed results to the LMFc (e.g. a location estimate for the UE or obtained
measurements for a final computation of the position).
At the step 7 the LMFc notifies the location result to the VGMLC in the
Nlmf_EventNotify service operation and the MO-LR location information is
forwarded to the LCS client (steps 8 and 10 in Figure 6.2.3.2-1). The steps 8
and 9 provides MO-LR response to the AMF and further to the UE (similar to the
steps 11 and 12 in Figure 6.2.3.2-1).
### 6.4.4 Impacts on existing entities and interfaces
#### 6.4.4.1 Impacts of Solution 4A
Impacted entities:
\- AMF: Capability for LMF selection to serve the location service request
(e.g. based on the requested positioning QoS information).
#### 6.4.4.2 Impacts of Solution 4B
Impacted entities:
\- LMF (i.e. LMFc): Capability for LMF selection to serve the location service
request (e.g. based on the requested positioning QoS information).
### 6.4.5 Evaluation
#### 6.4.5.1 Evaluation of Solution 4A
The advantage of the selection of a LMFd located at the edge (close to or at
the access network site) is to make interface for location operations between
LMFd and gNB/UE as short/fast as possible, especially for the case that all
the measurement operations take place under the same gNB (e.g. operations for
downlink or uplink positioning). For instance, it accelerates the process when
the LMFd instigates location operations with the gNB/UE to obtain positioning
measurements, assistance data, or a location estimate. It brings gains both in
terms of latency at the interface and \"localized\" signalling related to the
instigation of positioning operation up to the edge in comparison with a lot
of the latency and the signalling over the network in case of a centralized
LMF located deep in the core, e.g. combined with the GMLC.
The lack of the solution is not optimal path to deliver the positioning
signalling between the LMFd and the gNB/UE since the routing of the NRPP/NRPPa
messages goes through the AMF (via NLs-AP and NAS) located in core that
impacts on the latency. A latency improvement can be obtained by deploying
many AMFs close to the edge of the network, and correspondingly many LMFs also
close to the edge of the network. This is an implementation issue and does not
have a standard impact, but this has disadvantages in deployment cost and
results in more overhead in the network due to frequent inter-AMF mobility.
This approach is applicable for a deployment with a relatively small number of
gNBs, each of which covers a large area with a lot of DUs/TRPs since there is
a tradeoff between low positioning latency and frequent inter-AMF mobility.
## 6.5 Solution 5: Privacy Check with UE privacy setting
### 6.5.1 Introduction
This solution addresses the Key Issue 4: Reduce overhead for repetitive non-
successful privacy verification.
### 6.5.2 Functional Description
In order to reduce overhead for repetitive non-successful privacy
verification, it is proposed that the UE indicates to the network the privacy
setting according to the user\'s location privacy preference. The privacy
setting specifies whether the LCS request from the external LCS client is
disallowed. Emergency Services LCS Clients and Lawful Intercept LCS Clients
are exempt from this procedure.
With respect to the privacy handling requirement of commercial LCS request as
defined in TS 22.071 [3] and the need to reduce the overhead caused by
repetitive non-successful privacy verification:
\- it is proposed to introduce a kind of 5GC-MT-LR procedure with privacy
check (See clause 6.5.3.1) based on the 5GC-MT-LR Procedure defined in clause
4.13.5.3 of TS 23.502 [5]:
\- it is also proposed another kind of 5GC-MT-LR procedure with privacy check
(See clause 6.5.3.X) based on the LMF based architecture as specified in
clause 6.2.
\- During the privacy verification with the UE about the current LCS request,
the UE can indicate the privacy setting for the subsequent LCS request from
the external LCS client, e.g. disallow the subsequent LCS requests for a time
period.
The procedure for privacy setting update (See clause 6.5.3.2) is also
proposed:
\- It can be used along to indicate and update the privacy setting of the UE;
\- Or it can be used along with 5GC-MT-LR with privacy check procedure, i.e.,
update the privacy setting which has been provided within 5GC-MT-LR with
privacy check procedure.
The GMLC, via privacy check W.R.T. the privacy setting and the subscription,
can decide whether to reject the receiving LCS request immediately. When
privacy setting disallows the LCS request, the GMLC rejects the LCS request
immediately.
### 6.5.3 Procedures
#### 6.5.3.1 5GC-MT-LR with privacy check
Figure 6.5.3.1-1: 5GC-MT-LR with privacy check
1\. See as step1 in clause 4.13.5.3 of TS 23.502 [5].
2\. The GMLC invokes a Nudm_UE ContextManagement_Get service operation towards
the home UDM of the target UE to be located with the GPSI or SUPI of this UE.
3\. The UDM returns the network addresses of the current serving AMF, UE
subscription profile for LCS and may return the privacy setting for the
subsequent LCS requests of the UE.
The GMLC performs the privacy check according to UE subscription profile and
the privacy setting, if existed. If either privacy setting or UE subscription
profile indicates barring of LCS request, the GMLC immediately returns the
rejection response back to the external LCS client. Otherwise, the GMLC
requests AMF to provide the UE location.
4\. The GMLC invokes the Namf_Location_ProvideLocation service operation
towards the AMF to request the current location of the UE. The service
operation includes the SUPI, and client type and may include the required QoS
and Supported GAD shapes.
The service operation may also carry the indicator of privacy check related
action.
5\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.4 in TS 23.502 [5] to
establish a signalling connection with the UE.
6\. If the indicator of privacy check related action indicates that the UE
must either be notified or notified with privacy verification, a notification
invoke message is sent to the target UE indicating, the identity of the LCS
client the Requestor Identity (if that is both supported and available) and
whether privacy verification is required.
7\. The target UE notifies the UE user of the location request and, if privacy
verification was requested, waits for the user to grant or withhold
permission. The UE then returns a notification result to the AMF indicating,
if privacy verification was requested, whether permission is granted or denied
for the current LCS request.
The notification result may also indicate the privacy setting for the
subsequent LCS requests. The privacy setting for the subsequent LCS requests
indicates whether the subsequent LCS requests is disallowed by the UE. The
privacy setting for the subsequent LCS requests may also indicate a time for
privacy setting for disallowing the subsequent LCS requests.
8\. If receiving the privacy setting for the subsequent LCS requests from the
UE, the AMF stores the privacy setting for the subsequent LCS requests. The
AMF also invokes a Nudm_UECM_Update service operation towards the UDM of the
target UE to request the store the privacy setting of the UE for the
subsequent LCS requests.
9-11. See as step 6-8 in clause 4.13.5.3 of TS 23.502 [5].
12\. The AMF returns the Namf_Location_ProvideLocation Response towards the
GMLC to return the location of the UE, if the AMF has not initiated the
Privacy Verification process in step 6. The service operation includes the
location estimate, its age and accuracy and may include information about the
positioning method.
If step 6 has been performed for privacy verification, the AMF returns the
location information only, if it has received a NAS Location Notification
Return Result indicating that permission is granted.
If a NAS Location Notification Return Result message indicating that
permission is not granted is received, or there is no response, with the
requested privacy check action or the UE subscription profile indicating
barring of LCS request, the AMF shall return an error response to the GMLC.
The service operation shall also include the privacy setting for the
subsequent LCS requests, if the privacy setting for the subsequent LCS
requests is indicated by the UE.
13\. The GMLC sends the location service response to the external location
services client.
#### 6.5.3.2 Privacy Setting Update
Figure 6.5.3.2-1: Privacy Setting Update
1\. If the UE user has changed the privacy setting for the subsequent LCS
requests, the UE sends the updated privacy setting for the subsequent LCS
requests to the AMF or LMF.
For the case that Privacy Setting Update procedure between UE and LMF, it
means the Privacy Setting Update procedure is transparent to the AMF and the
AMF just transfer it as container between UE and LMF.
If the UE in idle, the UE signalling connection is setup in prior to step1.
2\. The AMF or LMF stores updated privacy setting for the subsequent LCS
requests. The AMF or LMF also invokes a Nudm_UECM_Update service operation
towards the home UDM of the target UE to request the update the privacy
setting of the UE for the subsequent LCS requests.
3\. The AMF or LMF responses the privacy setting update response to the UE.
5\. If a new LCS request from the external LCS client arrives, the 5GC-MT-LR
procedure with privacy check is executed based on the updated privacy setting
for the subsequent LCS requests.
#### 6.5.3.3 5GC-MT-LR with privacy check based on LMF based architecture
Figure 6.5.3.X-1 - 5GC Mobile Terminated Location Request (5GC-MT-LR) for a UE
Step1 to step 2 are as the same as step1 to 2 in chapter 6.2.3.1.
3\. The UDM returns the serving AMF address and possibly a VGMLC address
and/or an LMF address in the VPLMN. The UDM may also return subscribed privacy
requirements for the target UE - e.g. if not stored in the HGMLC.
If the privacy setting of the target UE is included in the privacy requirement
and indicates that the LCS requests is disallowed, the HGMLC immediately
returns the rejection response back to the LCS client.
Step4 to step 10 are as the same as step4 to 10 in chapter 6.2.3.1.
11\. The UE notifies the user of the location request and verifies user
permission if UE privacy is to be verified. The UE then returns a
supplementary services Location Notification response to the LMF indicating
whether the user grants or withholds permission for the location request when
UE privacy is verified. The supplementary services response is transferred via
the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation.
The notification result may also indicate the privacy setting for the
subsequent LCS requests. The privacy setting for the subsequent LCS requests
indicates whether the subsequent LCS requests is disallowed by the UE. The
privacy setting for the subsequent LCS requests may also indicate a time for
privacy setting for disallowing the subsequent LCS requests.
12\. If receiving the privacy setting for the subsequent LCS requests from the
UE, the LMF invokes a Nudm_UECM_Update service operation towards the UDM of
the target UE to request the store the privacy setting of the UE for the
subsequent LCS requests.
Step 13 to step 18 is same as step 12 to step18 in 6.2.3.1.
### 6.5.4 Impacts on existing entities and interfaces
UE:
\- Provides the privacy permission for the current LCS request: granted or
denied.
\- Provides the privacy setting for the subsequent LCS requests: allowed or
disallowed, time for privacy setting for disallowing the subsequent LCS
requests.
AMF or LMF:
\- Store the privacy setting for the subsequent LCS requests into the UE
context if receives the privacy setting for the subsequent LCS requests from
the UE.
\- Interface with UDM to provide the privacy setting for the subsequent LCS
requests if receives the privacy setting for the subsequent LCS requests from
the UE.
GMLC:
\- Interface with UDM to enforce the privacy check according to the UE
subscription profile for LCS and privacy setting for the subsequent LCS
requests.
UDM:
\- Store privacy setting for the subsequent LCS requests, UE subscription
profile for LCS (including the requested privacy check related action).
### 6.5.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
Solution5 is that the GMLC takes the privacy setting from the UE to decide
whether immediately disallows the LCS request from external LCS client.
Solution5 can adapt to both the LMF based architecture and the AMF based
architecture. It reuses the existing privacy verification procedure as much as
possible without brings in extra NAS signalling overhead.
## 6.6 Solution 6: User Privacy Setting send via AMF
### 6.6.1 Introduction
This solution addresses Key Issue 4: Reduce overhead for repetitive non-
successful privacy verification.
### 6.6.2 Functional Description
GMLC is responsible for privacy verification based on information from PPR and
UE. The function of PPR and procedure between GMLC and PPR could be found in
TS 23.271 [6].
This solution mainly focuses on how UE provides privacy setting to GMLC. That
is, once user has changed the Privacy Setting on UE, the UE updates the
network with such changes during Registration procedure. Such update procedure
involves AMF, PPR and GMLC. The PPR decides the UE privacy profile based on
operator policy and UE provided Privacy Setting preference. The PPR sends the
changed UE privacy profile to GMLC. When LCS request arrives, the GMLC
performs the privacy verification. PPR may be a standalone network entity or
it may be integrated in H-GMLC.
### 6.6.3 Procedures
#### 6.6.3.1 Privacy Setting Update
The UE may provide Privacy Setting to GMLC during Registration procedure, once
the Privacy Setting has changed by user. For this procedure, the V-GMLC is
involved in roaming case.
Figure 6.6.3-1: Privacy Setting Update procedure
1\. UE sends Registration Request to AMF. The message includes the UE privacy
setting preference, e.g. allowed service type.
2\. AMF sends Ngmlc_UserPrivacy_Set Request to V-GMLC including the UE privacy
setting preference and UE ID.
3\. V-GMLC sends Ngmlc_UserPrivacy_Set Request to H-GMLC.
4\. H-GMLC sends Nppr_PVPreference_Set Request to PPR. The message includes
the UE ID and UE privacy setting preference.
5\. PPR sends Nppr_PVPreference_Set Response to H-GMLC, which includes the PPR
decided UE Privacy Setting. PPR may change the privacy setting preference
based on operator policy.
NOTE: If the PPR changes the UE Privacy Setting preference, the privacy
verification procedure to the UE may still happen. This may lead to repetitive
unsuccessful privacy verification procedure.
6\. H-GMLC stores the UE Privacy Setting, and sends Ngmlc_UserPrivacy_Set
Response to V-GMLC. The message includes the UE Privacy Setting received from
PPR.
7\. V-GMLC stores the UE privacy setting, and sends Ngmlc_UserPrivacy_Set
Response to AMF. The message includes the UE Privacy Setting.
8\. AMF sends Registration Accept to UE. The message includes the UE Privacy
Setting accepted by network.
#### 6.6.3.2 Privacy Verification
When GMLC receives LCS Service Request from External Client, it performs
privacy verification based on the subscriber LCS Privacy Profile (SLPP)
information from PPR first and then the User privacy setting profile received
from the PPR. If any one of the privacy verification fails, GMLC shall
terminate the request, and response to the External client with appropriate
error code. Otherwise, the GMLC continue the location procedure.
#### 6.6.3.3 GMLC service
##### 6.6.3.3.1 General
The following table shows the GMLC service and GMLC Service Operation.
Table 6.6.3.x.1-1: GMLC Services
+--------------------+--------------------+-------------------+-------------------+ | Service Name | Service Operations | Operation | Known Consumer(s) | | | | | | | | | Semantic | | +--------------------+--------------------+-------------------+-------------------+ | Ngmlc_UserPrivacy | Set | Request/ Response | Peer GMLC, AMF | +--------------------+--------------------+-------------------+-------------------+
##### 6.6.3.3.2 Ngmlc_UserPrivacy_Set service operation
Service operation name: Ngmlc_UserPrivacy_Set.
**Description:** Receives the UE Privacy Setting preference from the consumer
NF and provides the Privacy Setting accepted by network to the consumer NF.
**Input, Required:** UE Privacy Setting preference, UE ID.
Input, Optional: None.
**Output, Required:** Privacy Setting accepted by network.
Output, Optional: None.
#### 6.6.3.4 PPR service
##### 6.6.3.4.1 General
The following table shows the PPR service and PPR Service Operation.
Table 6.6.3.4.1-1: PPR Services
+--------------------+--------------------+-------------------+-------------------+ | Service Name | Service Operations | Operation | Known Consumer(s) | | | | | | | | | Semantic | | +--------------------+--------------------+-------------------+-------------------+ | Nppr_PVPreference | Set | Request/ Response | GMLC | +--------------------+--------------------+-------------------+-------------------+
##### 6.6.3.4.2 Nppr_PVPreference_Set service operation
Service operation name: Nppr_PVPreference_Set.
**Description:** Receives the UE Privacy Setting preference from the consumer
NF and provides the Privacy Setting accepted by network to the consumer NF.
**Input, Required:** UE privacy setting preference, UE ID.
Input, Optional: None.
**Output, Required:** Privacy Setting accepted by network.
Output, Optional: None.
### 6.6.4 Impacts on existing entities and interfaces
Impacted entities:
\- UE provides privacy setting preference to AMF.
\- AMF:
\- Receive privacy setting preference from UE.
\- Send the UE provided privacy setting preference to GMLC and receive updated
setting from GMLC and provide it to UE.
\- PPR decides the privacy setting based on UE provided setting preference
operator policy, and provides it to GMLC.
\- GMLC receives UE privacy setting profile from PPR and performs privacy
check based on the setting.
Impacted interfaces:
\- N1, and interface between AMF and PPR, interface between PPR and GMLC are
impacted.
### 6.6.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.7 Solution 7: User Privacy Setting send via LMF
### 6.7.1 Introduction
This solution addresses Key Issue 4: Reduce overhead for repetitive non-
successful privacy verification.
### 6.7.2 Functional Description
In this solution, we use \"UE-LMF\" to denote the protocol that used to
transfer messages between UE and LMF. The details of this protocol are left to
stage 3.
When user has changed the Privacy Setting on UE, the UE updates the network
with such changes by using \"UE-LMF\" protocol. This \"UE-LMF\" protocol
message is transferred via NAS message between UE and AMF, and the AMF and LMF
use service interface operation to transfer those messages. The LMF in the
VPLMN select VGMLC, and notify the changed privacy settings, the VGML will
contact user\'s home network (i.e. HGMLC and PPR are involved in following
steps) to confirm such change is allowed, and return received result to LMF.
The PPR decides the UE privacy profile based on operator policy and UE
provided Privacy Setting preference. The PPR sends the changed UE privacy
profile to GMLC. GMLC is responsible for privacy verification based on
information received from PPR and UE. The function of PPR and procedure
between GMLC and PPR could be found in TS 23.271 [6].
When LCS request arrives, the GMLC performs the privacy verification. PPR may
be a standalone network entity or it may be integrated in H-GMLC.
### 6.7.3 Procedures
#### 6.7.3.1 Privacy Setting Update
The UE may provide Privacy Setting to GMLC by using \"UE-LMF\" protocol
message, once the Privacy Setting has changed by user. If such change is made
by user when UE is in IDLE mode, the UE initiates service request procedure to
get NAS signalling established firstly. For this procedure, the V-GMLC is
involved in roaming case.
Figure 6.7.3-1: Privacy Setting Update procedure
1\. User changed the UE privacy setting preference. If UE is in IDLE mode, the
UE imitates service procedure to establish the NAS signalling. If UE is in
CONNECTED mode, this step is skipped.
2\. UE sends NAS Transport message to the AMF. This NAS message includes \"UE-
LMF\" message Request Setting Change (UE privacy setting preference, e.g.
allowed service type).
3 The AMF selects an LMF in the VPLMN and invokes the
Namf_Communication_N1MessageNotify service operation towards this LMF to
transfer the Request Setting Change.
4\. LMF sends Ngmlc_UserPrivacy_Set Request to V-GMLC including the UE privacy
setting preference.
5\. V-GMLC sends Ngmlc_UserPrivacy_Set Request to H-GMLC.
6\. H-GMLC sends Nppr_PVPreference_Set Request to PPR. The message includes
the UE ID and UE privacy setting preference.
7\. PPR sends Nppr_PVPreference_Set Response to H-GMLC, which includes the PPR
decided UE Privacy Setting. PPR may change the privacy setting preference
based on operator policy..
NOTE: If the PPR changes the UE Privacy Setting preference, the privacy
verification procedure to the UE may still happen. This may lead to repetitive
unsuccessful privacy verification procedure.
8\. H-GMLC stores the UE Privacy Setting, and sends Ngmlc_UserPrivacy_Set
Response to V-GMLC. The message includes the UE Privacy Setting received from
PPR.
9\. V-GMLC stores the UE privacy setting, and sends Ngmlc_UserPrivacy_Set
Response to LMF. The message includes the UE Privacy Setting.
10\. The LMF invokes the Namf_Communication _N1N2MessageTransfer service
operation towards the AMF to send Accepted Privacy Setting to the AMF. The
Accepted Privacy Setting is a \"UE-LMF\" protocol message, and includes the UE
Privacy Setting accepted by network.
11\. The AMF forwards the Accepted Privacy Setting to the UE in a NAS
transport message.
#### 6.7.3.2 Privacy Verification
Same as that of solution 6, please see clause 6.6.3.
#### 6.7.3.3 Service of GMLC and PPR
Same as that of solution 6, please see clause 6.6.3.
### 6.7.4 Impacts on existing entities and interfaces
Impacted entities:
\- UE provides privacy setting to LMF, by using \"UE-LMF\" protocol.
\- AMF provides \"UE-LMF\" protocol message transfer between UE and LMF.
\- LMF: support \"UE-LMF\" protocol:
\- Receive privacy setting from UE.
\- Send the UE provided privacy setting to GLMC, receive updated setting from
GMLC, and provide it to UE.
\- PPR decides the privacy setting based on UE provided setting and operator
policy, and provides it to LMF.
\- GMLC receives UE privacy setting profile from PPR and performs privacy
check based on the setting.
Impacted interfaces:
\- N1, interface between LMF and GMLC, interface between PPR and GMLC are
impacted.
### 6.7.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.8 Solution 8: slice dependent LMF selection
### 6.8.1 Introduction
This solution is to address Key issue 5 \"slice dependent location service\".
### 6.8.2 Functional Description
To address the specific position service requirements, one separate LMF serves
the position service for this network slice. When UEs which are allowed to
this network slice access the network, the correct LMF is selected by AMF to
serve these UEs when UEs register network. Normally one UE is only served by
one LMF.
### 6.8.3 Procedures
The LMF selection procedure is indicated in the figure below:
Figure 6.3.8-1: LMF selection during UE registration
1\. UE sends Registration Request including LCS enabled indication.
2\. AMF performs the related UE Registration procedure as specified in TS
23.502 [5].
3\. AMF discovers the LMF serving this UE via NRF. In order to discover the
correct LMF serving that UE is allowed to access, AMF provides the
corresponding S-NSSAI to NRF when discovering LMF. The position related
subscription data may include the S-NSSAI for position service.
4\. AMF request the selected LMF to activate location service for the UE.
5\. LMF discovers and selects the UDM.
6\. LMF request location related subscription data and context data from UDM,
including privacy profile, the provisioning information of valid LDR service
request that application functions ever requested.
7\. LMF responds to AMF whether the location service for the UE is activated.
8\. LMF performs NF registration towards UDM.
9-10. AMF performs the related UE Registration procedure as specified in TS
23.502 [5].
### 6.8.4 Impacts on existing entities and interfaces
The solution impact the following network functions:
\- AMF needs to discover and select the correct LMF serving the network slice.
### 6.8.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.9 Solution 9: Solution for position service exposure
### 6.9.1 Introduction
This solution address Key Issue 7 \"Position service exposure\" and Key Issue
3: \"Support of low latency LCS\" as well as at it secures roaming with EPS.
### 6.9.2 Functional Description
For external exposure the NEF receives location service request from an AF and
sends the corresponding request to GMLC or LCS client sends a location request
to GMLC.
For internal exposure the requesting NF send a request to GMLC. To enable
location privacy GMLC performs privacy check according to a privacy profile.
The privacy profile is, depending on chosen solution, provisioned in GMLC, or
downloaded from UDM. If the requested location service is allowed GMLC
performs an 5GC MT-LR procedure.
For roaming there will be an instance of GMLC in Home PLMN acting as H-GMLC
and one instance in Visited PLMN acting as V-GMLC. The H-GMLC will retrieve
the address of the V-GMLC from the UDM or HSS.
#### 6.9.2.1 Architecture
The non-roaming LCS architecture is indicated in the figure below:
Figure 6.9.2.1-1: non-roaming LCS reference architecture
The roaming LCS architecture is indicated in the figures below:
Figure 6.9.2.1-2: Roaming LCS reference architecture with 5GC VPLMN
Figure 6.9.2.1-3: Roaming LCS reference architecture with EPC VPLMN
### 6.9.3 Procedures
#### 6.9.3.1 Location Service exposure procedure, non-roaming
The flow below indicates the procedure where an external AF, internal NF or
LCS Client requests Location Service:
Figure 6.9.3.1-1: Location Service exposure, non-roaming
1a. For external exposure via NEF, the AF will request location event exposure
from the NEF by sending a Location Service Request message to the NEF
including UE identity and the Location service type.
1b. For external exposure via GMLC, the LCS Client sends a LCS Service Request
message to the GMLC including UE identity and the Location service type.
1c. For internal exposure, the NF selects an GMLC e.g. by using the NRF
service. The NF sends an Ngmlc_ProvideLocation Request message to the GMLC.
2\. If step 1a has occurred, the NEF selects an GMLC e.g. by using the NRF
service. The NEF sends an Ngmlc_ProvideLocation Request message to the GMLC.
3\. The GMLC performs privacy check based on privacy profile related to the
target UE.
4\. The GMLC performs a 5GC MT-LR procedure.
5a. If step 1a has occurred, the GMLC sends an Ngmlc_ProvideLocation Response
message to the NEF. The response includes location estimate or else an error
indication.
5b. If step 1b has occurred, the GMLC sends an LCS Service Response to the LCS
Client. The response includes location estimate or else an error indication.
5c. If step 1c has occurred, the GMLC sends an Ngmlc_ProvideLocation Response
message to the NF. The response includes location estimate or else an error
indication.
6\. If step 5c has occurred, the NEF sends Location Service Response to the
AF.
#### 6.9.3.2 Location Service exposure procedure, roaming
The flow below indicates the procedure where an external AF, internal NF or
LCS Client requests Location Service:
Figure 6.9.3.2-1: Location Service exposure, roaming
1a. If the Home PLMN is an 5GC step 1a and 2 or step 1b or step 1c of Figure
6.9.3.1-1 are performed.
1b. If the Home PLMN is an EPC the procedures corresponding to step 1a, 2, 3
and 4 are performed.2. If step 1a has occurred, The H-GMLC performs privacy
check based on privacy profile related to the target UE.
3\. If step 1a has occurred, the H-GMLC invokes the Nudm_UECM_Get service
operation towards the home UDM of the target UE with the GPSI or SUPI of the
UE.
4\. The UDM returns the V-GMLC address of the VPLMN.
5a. If both Home PLMN and Visited PLMN are 5GC, the H-GMLC sends an
Ngmlc_ProvideLocation Request message to the V-GMLC.
5b. If one of Home PLMN and Visited PLMN are EPC, the H-GMLC sends an LCS
Service Request message to the V-GMLC.
6a. If the Visited PLMN is an 5GC the V-GMLC performs e 5GC MT-LR procedure.
6b. If the Visited PLMN is an EPC the V-GMLC performs e EPC MT-LR procedure.
7a. If step 5a was performed the V-GMLC sends an Ngmlc_ProvideLocation
Response message to the H-GMLC. The response includes location estimate or
else an error indication.
7b. If step 5b was performed the V-GMLC sends an LCS Service Response message
to the H-GMLC. The response includes location estimate or else an error
indication.
8a. If the Home PLMN is an 5GC steps 5a and 6 or step 5b or step 5c of Figure
6.9.3.1-1 are performed.
8b. If the Home PLMN is an EPC the procedure corresponding to step 8a are
performed.
#### 6.9.3.3 Optimized Deferred Location Service exposure procedure
The flow below indicates the procedure when an NF requests Location Deferred
Service:
Figure 6.9.3.3-1: Optimized Deferred Location Service exposure
1\. The requesting NF (e.g. an internal AF or NEF in case of an external AF)
selects an GMLC e.g. by using the NRF service. The NF invokes an
Ngmlc_ProvideLocation operation towards the GMLC indicating request for
deferred location.
2\. The H-GMLC invokes the Nudm_UECM_Get service operation towards the home
UDM of the target UE with the GPSI or SUPI of the UE.
3\. The UDM returns the address serving location NF.
4\. The GMLC performs privacy check based on privacy profile related to the
target UE.
5\. The GMLC invokes an Nxxx_Location_ProvideLocation service operation
towards serving NF indicating Deferred service and the NF that is to receive
the location information.
6\. The location trigger is activated. This may include communication with the
UE for the case the trigger resides in the UE.7. The serving NF returns
acknowledge of the operation to the GMLC.
8\. The GMLC acknowledge the operation to the requesting NF.
9\. The trigger event is detected. This may occur in the UE and will in such
case include communication with the UE.
10\. The serving NF invokes the Nxxx_Location_EventNotify operation towards
the recipient NF including any requested location information.
11\. The initiating NF may optionally explicitly terminate the Deferred
request. The NF then invokes an Ngmlc_ProvideLocation operation the GMLC
indicating termination of a deferred location service.
12\. The GMLC may at any time determine that the privacy conditions for
allowing delivery of location are no longer valid and decides to terminate the
Deferred service.
13\. If step 11 or 12 has occurred, the GMLC invokes an
Nxxx_Location_ProvideLocation service operation towards serving NF indicating
termination of a Deferred service.
14\. The serving NF acknowledge termination of the operation to the GMLC.
15\. If step 11 has occurred, the GMLC acknowledge termination of the
operation to the requesting NF.
Editor\'s note: The NF designator \"Nxxx\" will be replaced by \"Namf\" or
\"Nlmf\" once architecture option has been selected.
### 6.9.4 Impacts on existing entities and interfaces
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
NEF:
\- Expose Location Reporting\" event to AF including authorization by the
network of the AF to receive the requested information.
\- Selection of source of location information.
\- Interface with GMLC to retrieve location information.
GMLC:
\- Expose a service-based interface on which other NF can request location
information.
\- If acting as H-GMLC, authorize exposure of location information based on
the subscriber privacy profile.
\- If acting as V-GMLC, authorize exposure of location information based on
operator policy.
\- If acting as H-GMLC, request location information from V-GMLC.
UDM:
\- Retrieve address of V-GMLC from Visited PLMN during registration procedure
and expose this information to GMLC.
Editor\'s note: Impacts on AMF and LMF is FFS.
### 6.9.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.10 Solution 10: Solution for LDR type service exposure via NEF
### 6.10.1 Introduction
This solution is to address Key Issue 7 \"Position service exposure\" and Key
issue 4 \"Reduce overhead for repetitive non-successful privacy
verification\".
### 6.10.2 Functional Description
The supported location service exposure includes LIR and LDR type service.
NEF receive location service request from applications and send the
corresponding request to LMF. To support interworking scenario that 5G UE
resides in 4G, NEF sends location request to the 4G GMLC to get UE location
via the position mechanism specified for EPC when NEF inquiries UDM/HSS and
knows the UE resides on 4G. To enable location privacy, UDM maintains privacy
profile, and LMF performs privacy check according to privacy profile. If the
requested LDR service is allowed, LMF stores the allowed location service
information to UDM.
To allow the users to provide the expected privacy provisioning information,
the UE may send the expected privacy provisioning information to LMF via N1
message. LMF stores the privacy provisioning information from the UE, and
further it determine whether the location service request from applications is
allowed based on the maintained privacy provisioning information.
### 6.10.2.1 Architecture
The non-roaming LCS architecture is indicated in the figure below:
Figure 6.10.2-1 non-roaming LCS reference architecture
The roaming LCS architecture is indicated in the figure below:
Figure 6.10.2-2 roaming LCS reference architecture
### 6.10.3 Procedures
#### 6.10.3.1 LDR type service exposure procedure
The flow below indicates the procedure that application requests LDR type
service:
Figure 6.10.3.1-1: LDR type service exposure
1\. In case that e.g. one application needs new location service, the
application sends Location Service Request message to the NEF including GPSI,
the LCS type, and the LCS service information which includes the related
parameters. One example is the application requests the periodic location
reporting for one UE, i.e. the location reporting is 5 minutes. LCS Type
indicates this is a Location Deferred Request.
2\. NEF determines the serving LMF via Nudm_UE CM_Get service operation. If
the target UE does not register network and there is no serving LMF, NEF may
discover and select one LMF via NF discovery to handle the location service
request. To support interworking between 5GC and EPC, NEF as LCS client sends
location service request to the 4G GMLC to get UE location via the position
mechanism specified for EPC when NEF inquiries UDM/HSS and knows the UE is
residing in 4G.
3\. NEF requests Nlmf_LCS_Create service operation from the serving LMF, and
SUPI of the target UE, Application ID, LCS Type and related location service
information are included in request message.
4\. The serving LMF performs privacy check based on privacy profile related to
the target UE.
5\. The serving LMF respond to NEF whether the request is allowed.
6\. NEF notice the result to the application via Location Service Response.
7\. To store the corresponding location service information stored in UDM, the
LMF requests Nudm_UDM_Create service operation from UDM including SUPI,
Application ID, LCS type, the location service information.
8\. UDM stores the corresponding location service information including SUPI,
Application ID, LCS type, and then it responds to LMF via Nudm_UDM_Create
response message.
9\. LMF activate the requested location service. For UE roaming in 5GC, H-LMF
in HPLMN sends the authorized location service request to V-LMF in VPLMN, and
V-LMF activates the location service request for this UE. When reporting UE
location related to location service request, V-LMF sends UE location
information to H-LMF, and H-LMF further sends UE location report to NEF.
#### 6.10.3.2 Application request to update LDR type service
The flow below indicates the procedure that application requests to update the
location service:
Figure 6.10.3.2-1: Update LDR type service
1\. In case that e.g. one application needs to update the location service
which was requested, the application sends Location Service Request message to
the NEF including GPSI, the LCS type, and the updated LCS service information.
One example is the application expects to update the periodic location
reporting time for one UE. LCS Type indicates this is a Location Deferred
Request.
2\. NEF determines the serving LMF via Nudm_UE CM_Get service operation.
3\. NEF requests Nlmf_LCS_Update service operation from the serving LMF, and
SUPI of the target UE, Application ID, LCS Type and updated location service
information are included in request message. LCS Type indicates this is a
Location Deferred Request.
4\. The serving LMF performs privacy check based on privacy profile related to
the target UE.
5\. The serving LMF responds to NEF whether the request is allowed.
6\. NEF notices the result to the application via Location Service Response.
7\. To update the corresponding location service information stored in UDM,
the LMF requests Nudm_UDM_Update service operation from UDM including SUPI,
Application ID, LCS type, the location service information.
8\. UDM determines and update the corresponding location service information
according to SUPI, Application ID, LCS type, and then it responds to LMF via
Nudm_UDM_Update response message.
9\. LMF activates the updated location service.
#### 6.10.3.3 Application request to cancel LDR type service
The flow below indicates the procedure that application requests to cancel the
location service:
Figure 6.10.3.3-1: Cancel LDR type service exposure
1\. In case that e.g. one application needs to cancel the location service
which was requested, the application sends Location Service Request message to
the NEF including GPSI, the LCS type that request to cancel, and the
indication on cancel service.
2\. NEF determines the serving LMF via Nudm_UE CM_Get service operation.
3\. NEF requests Nlmf_LCS_Delete service operation from the serving LMF, and
SUPI of the target UE, Application ID and LCS Type are included in request
message.
4\. The serving LMF authorizes the service request.
5\. The serving LMF responds to NEF whether the request is allowed.
6\. NEF notices the result to the application via Location Service Response.
7\. To delete the corresponding location service information stored in UDM,
the LMF requests Nudm_UDM_Delete service operation from UDM including SUPI,
Application ID, LCS type.
8\. UDM determines and delete the corresponding location service information
according to SUPI, Application ID, LCS type, and then it responds to LMF via
Nudm_UDM_Delete response message.
9\. LMF disable the location service that was cancelled.
#### 6.10.3.4 UE provides the expected location privacy provisioning to the
network
The flow below indicates the procedure that UE provides the expected location
privacy provisioning to the network:
Figure 6.10.3.4-1: UE provides Location privacy information to LMF
1\. In case that e.g. the LCS privacy configuration information of the UE is
changed by the UE user, UE sends N1 LCS request message including the updated
LCS privacy information to AMF. LCS privacy information may indicate whether
the exposure of UE location to applications is allowed.
2\. AMF determine the serving LMF for the UE, and sends the N1 LCS request
message to the serving LMF via Namf_Communicaiton_N1MessageNotify service
operation.
3\. The serving LMF authorizes whether the LCS request from the UE is allowed
according to UE LCS related subscription data and operator policy.
4\. The serving LMF send Namf_Communication_N1N2MessageTransfer request
message including N1 LCS Response message to AMF to request AMF send N1 LCS
Response to the UE, and LMF also store the LCS privacy information from the UE
if the request is allowed.
5\. The AMF sends N1 LCS Response to UE.
### 6.10.4 Impacts on existing entities and interfaces
The solution impact the following network functions:
\- To enable location service exposure including LIR and LDR type towards
applications, NEF needs to support the related location exposure service and
the corresponding service interface, and NEF also needs to interact with LMF
to realize the location service required by the authorized applications. NEF
sends location request to the 4G GMLC to get UE location via the position
mechanism specified for EPC when NEF inquiries UDM/HSS and knows the UE
resides on 4G.
\- UDM integrates the functionality for subscriber privacy profile, including:
maintain subscriber privacy profile and provides the subscriber privacy
profile to the allowed service consumer i.e. LMF. UDM also needs to store the
context for the allowed LDR type service request.
\- LMF performs privacy check according to privacy profile.
### 6.10.5 Evaluation
The solution addresses Key Issue 7 \"Position service exposure\" and Key issue
4 \"Reduce overhead for repetitive non-successful privacy verification\". The
benefits include:
\- The 5G system exposes location service to applications via general network
service exposure framework, and the supported location service can include LDR
and LIR type service. It avoids that applications need to support the legacy
reference point with GMLC to obtain location service, and thus it provides the
simple and efficient approach for location service exposure;
\- Support the unified data management via UDM, including: subscriber privacy
profile and avoid introducing one separate network function such as R-15 to
handle subscriber privacy profile, and the authorized information of LDR type
service request.
## 6.11 Solution 11: Solution for Location Service exposure to NG-RAN
### 6.11.1 Introduction
This solution is to address Key Issue 1 \"Enhancements to LCS architecture\"
and Key Issue 7 \"Position service exposure\" by adding NG-RAN as a potential
internal LCS Client (i.e. internal consumer of Location Service). Providing
LCS Service to RAN benefits use cases such as \"QoS verification\" and
\"Coverage optimization\" as described in TR 36.880 [25] and in addition may
be used by RRM procedures.
It is assumed that the NG-RAN, as an internal LCS client, is always authorized
to use the LCS service to obtain the target UE location estimation, thus no
privacy verification and LCS service authorization are required for requests
initiated by the NG-RAN.
### 6.11.2 Functional Description
This procedure is used by an NG-RAN to request the AMF to report the current
the UE location when the target UE is in CM-CONNECTED state.
### 6.11.3 Procedures
### 6.11.3.1 NG-RAN Location exposure procedure
The flow below indicates the procedure where NG-RAN requests Location service:
Figure 6.11.3.1-1: Location service exposure to NG-RAN
1\. The UE is in CM CONNECTED mode and the NG-RAN detects the need to get
(accurate) UE location.
2\. If NG-RAN doesn\'t support LM functionality, it sends a RAN Initiated
Location Request message to the AMF. The RAN Initiated Location Request
message shall, contain the requested location information. The AMF determines
the UE for which location is requested using the NGAP context associated with
the RAN request.
> Step 3-5 follows Step 6-8 of 5GC-MT-LR Procedure defined in clause 6.14.3.1.
6\. The AMF sends RAN Initiated Location Response to the NG-RAN.
### 6.11.4 Impacts on existing entities and interfaces
NG-RAN:
\- Need to handle two new messages, \"RAN Initiated Location Request\" and
\"RAN Initiated Location Response\" on N2 interface.
AMF:
\- Need to handle two new messages, \"RAN Initiated Location Request\" and
\"RAN Initiated Location Response\" on N2 interface.
N2:
\- NGAP protocol need to be extended with a new procedure consisting of two
messages with proposed naming \"RAN Initiated Location Request\" and \"RAN
Initiated Location Response\" respectively.
### 6.11.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
This solution provides an efficient support for RAN Initiated Location Request
as only the NG RAN, the AMF and the LMF are involved.
NOTE: The solution does not assume any permanent UE ID to be provided to the
RAN.
## 6.12 Solution 12: LCS support for non-3GPP access
### 6.12.1 Introduction
The solution is intended to address or resolve, partly or completely, the
following key issues:
\- Key Issue 1: Enhancement to LCS Architecture.
\- Key Issue 12: LCS support for non-3GPP access.
### 6.12.2 Functional Description
#### 6.12.2.1 Architecture
Figure 6.12.2-1: Non-roaming reference architecture
Figure 6.12.2-1 is similar to Figure 4.4.4.1-1 in TS 23.501 [4] with the
following differences:
\- LRF is removed, because it\'s not relevant to commercial location services.
\- Untrusted Non-3GPP access type is added.
\- SUPL Location Platform (SLP) is added.
\- The Nle interface between SUPL Location Platform and LMF is added.
Editor\'s note: Whether the SUPL messages can be sent between the UE and SLP
via the 3GPP control plane is FFS.
If the UE only registered to untrusted non-3GPP access, the following
information can be regarded as UE location information:
\- UE local IP address and optionally UDP or TCP source port number,
\- BSSID of the attached AP or BSSID of detected AP,
\- Civic address and/or geospatial location information. (More details can
refer to Note 1 and Note 5 in solution 13.)
#### 6.12.2.2 New Reference points and Service based interfaces
New Reference points not realized by service based interfaces comprise:
**NLe:** Reference point between a SLP and an LMF.
New Service Based Interfaces used by the solution comprise:
**Nlmf:** Service-based interface exhibited by LMF.
**Nudm:** Service-based interface exhibited by UDM.
**Namf:** Service-based interface exhibited by AMF.
This solution utilize the existing service operations defined in TS 23.502 [5]
for the Nlmf, Namf and Nudm service based interfaces.
For the Nlmf service based interface, one new service operation is added as
shown below.
Table 6.12.2.2-1: Nlmf Service Operations
+----------------+--------------------+------------------+------------------+ | Service Name | Service Operations | Operation | Example Consumer | | | | | | | | | Semantics | | +----------------+--------------------+------------------+------------------+ | Nlmf_Location | EventNotify | Subscribe/Notify | AMF | +----------------+--------------------+------------------+------------------+
### 6.12.3 Procedures
#### 6.12.3.1 5GC-MT-LR Procedure
Figure 6.12.3.1-1 illustrates the general network positioning for LCS clients
external to the PLMN. In this scenario, it is assumed that the target UE is
identified using an SUPI or GPSI. This procedure is applicable to a request
from an LCS client for a current location.
Figure 6.12.3.1-1: 5GC Mobile Terminated Location Request for Non-3GPP access
(5GC-MT-LR)
1\. The external location services client sends a request to the GMLC for a
location for the target UE identified by an GPSI or an SUPI. The request may
include the required QoS, Supported GAD shapes and client type.
2\. The GMLC invokes a Nudm_UECM_Get service operation towards the home UDM of
the target UE to be located with the GPSI or SUPI of this UE.
3\. The UDM returns thethe address of current serving AMF.
4\. The GMLC invokes the Namf_Location_ProvideLocation service operation
towards the AMF to request the current location of the UE. The service
operation includes the SUPI, and client type and may include the required QoS
and Supported GAD shapes.
5\. The AMF selects an LMF based on NRF query or configuration in AMF and
invokes the Nlmf_Location_DetermineLocation service operation towards the LMF
to request the current location of the UE. The service operation includes a
LCS Correlation identifier, the access type and the client type and may
include the required QoS and Supported GAD shapes.
6\. If the access type is Non-3GPP access, the LMF sends the Location Request
to SLP.
7\. The SLP initiates positioning procedure towards UE. This shall use SUPL
procedures based on OMA SUPL (OMA AD SUPL [13], OMA TS ULP [14]).
8\. The SLP sends the Location Response to LMF including the UE location
inforamtion.
9\. The LMF returns the Nlmf_Location_DetermineLocation Response towards the
AMF to return the current location of the UE. The service operation includes
the LCS Correlation identifier, the location estimate, its age and accuracy
and may include information about the positioning method.
10\. The AMF returns the Namf_Location_ProvideLocation Response towards the
GMLC to return the current location of the UE. The service operation includes
the location estimate, its age and accuracy and may include information about
the positioning method.
11\. The GMLC sends the location service response to the external location
services client.
#### 6.12.3.2 5GC-MO-LR Procedure
Figure 6.12.3.2-1 illustrates a 5GC Mobile Originated Location Request (5GC-
MO-LR) procedure for a UE via non-3GPP access. In this scenario, it is assumed
that the target UE is identified using a SUPI.
Figure 6.12.3.2-1: 5GC Mobile Originated Location Request for Non-3GPP access
(5GC-MO-LR)
1\. The UE has established a PDU session with one of UPFs in PLMN via non-3GPP
access.
2\. The UE initiates positioning procedure by establishing a user plane
connection with the SLP and shall use the OMA SUPL mechanism specified by OMA
(OMA AD SUPL [13], OMA TS ULP [14]) to transport location related assistance
data and location information between the UE and SLP. The UE may receive
assistance data and determine its own location and send its location
information to the SLP or the UE sends measurement results to the SLP. In case
SLP determines the location of the UE, the SLP shall send the location
information to the UE. If the UE requests to transfer the location information
obtained to external LCS client, the LCS client ID is also included.
3\. The SLP sends the Location information to LMF including the UE location
inforamtion, and the UE identity.
4\. If the location information obtained is requested to be transferred to
external LCS client by the UE in step 2, the LMF invokes Nlmf_EventNotify
towards AMF. The service operation includes the UE identity, the LCS client
ID, the location estimate, and accuracy and may include information about the
positioning method.
5\. The AMF invokes the Namf_Location_EventNotify towards the GMLC to return
the current location of the UE. The service operation includes the UE
identity, the LCS client ID, the location estimate, and accuracy and may
include information about the positioning method.
6\. The GMLC provides the UE location estimate and the UE identity to the
external location services client.
### 6.12.4 Impacts on existing entities and interfaces
#### 6.12.4.1 Impacts to UDM
\- GMLC being a new consumer of UDM service operation Nudm_UECM_Get.
\- New Subscription data type: UE LCS privacy.
#### 6.12.4.2 Impacts to GMLC
\- Capability to invoke Nudm_UECM_Get service operation.
\- Capability of LCS service request handling based on target UE privacy
setting.
#### 6.12.4.3 Impacts to LMF
\- Adding interface between LMF and SLP.
\- Capability to get access type within Nlmf_Location_DetermineLocation
service operation.
\- Adding new service operation Nlmf_Location_EventNotify.
#### 6.12.4.4 Impacts to AMF
\- Capability to send access type when invoking
Nlmf_Location_DetermineLocation service operation towards LMF.
#### 6.12.4.5 Impacts to N3IWF
\- Supporting SUPL procedures.
#### 6.12.4.6 Impacts to UE
\- Supporting SUPL procedures.
### 6.12.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.13 Solution 13: LCS support for non-3GPP access
### 6.13.1 Introduction
The solution intends to resolve the following key issues:
\- Key Issue 12: LCS support for non-3GPP access.
\- Key Issue 14: Positioning Access selection for LCS service.
### 6.13.2 Functional Description
#### 6.13.2.1 Architecture
The architectures in this solution can refer to Figure 6.3.2-1 (non-roaming
LCS reference architecture) and Figure 6.3.2-2 (roaming LCS reference
architecture) in Solution 3 with the following differences:
\- UCF is not shown since CP-based solution doesn\'t need the user plane
function.
\- NG-RAN is replaced by 5G-AN which comprises a NG-RAN and/or non-3GPP AN
(N3IWF or TNGF) connecting to a 5G core network, the TNGF is defined in TR
23.716 [9] clause 7.1.
> NOTE: For trusted non-3GPP access network, the architecture and procedures
> are based on the solution described in clause 7.1 of TR 23.716 [9].
#### 6.13.2.2 Location information for non-3GPP access
For the issue of what information can be regarded as location information for
non-3GPP access:
\- If the UE only registered to non-3GPP access, following information can be
regarded as UE location information:
Table 6.13.2-1: Supported UE location information of untrusted non-3GPP access
+----------------------+----------------------+----------------------+ | | Untrusted non-3GPP | Trusted non-3GPP | | | Access | Access | +----------------------+----------------------+----------------------+ | UE Side | UE local IP address, | Same as Untrusted | | | | non-3GPP Access | | | In case of WLAN | | | | access, BSSID of the | | | | attached AP or BSSID | | | | of detected AP, | | | | | | | | Civic address and/or | | | | geospatial location | | | | information (NOTE 1, | | | | NOTE 5, NOTE 6). | | +----------------------+----------------------+----------------------+ | N3IWF/TNGF Side | UE local IP address | UE local IP address | | | and optionally UDP | and optionally UDP | | | or TCP source port | or TCP source port | | | (NOTE 2) | (NOTE 2), | | | | | | | | Line identifier of | | | | the access point to | | | | which the UE is | | | | attached (NOTE 7) | +----------------------+----------------------+----------------------+ | AMF Side | UE local IP address | UE local IP address | | | and optionally UDP | and optionally UDP | | | source port | source port | | | (NOTE 3). | (NOTE 3). | | | | | | | Last known 3GPP | Last known 3GPP | | | access User Location | access User Location | | | Info (NOTE 4). | Info (NOTE 4). | | | | | | | | Line identifier of | | | | the access point to | | | | which the UE is | | | | attached (NOTE 7) | +----------------------+----------------------+----------------------+ | NOTE 1: In case of | | | | WLAN access, the UE | | | | may retrieve its | | | | location from a WLAN | | | | AP, prior or after | | | | association with the | | | | AP, requesting the | | | | Civic Location ANQP | | | | element, the | | | | Geospatial Location | | | | ANQP element or both | | | | as specified in IEEE | | | | Std 802.11-2012, | | | | using ANQP | | | | procedures described | | | | in HS2.0 Rel 2 | | | | specification. | | | | | | | | NOTE 2: More details | | | | can refer to | | | | TS 23.501 [4] | | | | clause 5.6.2. | | | | | | | | NOTE 3: This | | | | location information | | | | can be provided by | | | | location change | | | | event, more details | | | | can refer to | | | | TS 23.502 [5] | | | | clause 5.2.2.3.1. | | | | | | | | NOTE 4: This | | | | location information | | | | is also named as | | | | Last known Cell-Id, | | | | more details can | | | | refer to | | | | TS 23.501 [4] | | | | clause 5.6.2. | | | | | | | | NOTE 5: Geospatial | | | | location information | | | | can be obtained if | | | | UE (e.g. laptop) has | | | | installed GNSS | | | | receiver, i.e. GPS. | | | | | | | | NOTE 6: Some | | | | Applications (e.g. | | | | Google Map) may map | | | | the WiFi AP\'s BSSID | | | | with the geospatial | | | | locations obtain | | | | through GPS when the | | | | UE switch on the GPS | | | | and WiFi | | | | simultaneously. When | | | | another UE detect | | | | the same AP, the | | | | Application will | | | | send the geospatial | | | | locations to the UE. | | | | Thus the UE obtain | | | | the geospatial | | | | locations even | | | | without switch on | | | | the GPS. If the | | | | Application map the | | | | geospatial locations | | | | to civic address, | | | | the UE can also | | | | obtain the civic | | | | address. | | | | | | | | NOTE 7: Since AAA | | | | interface exists | | | | between TNAP and | | | | TNGF in trusted | | | | non-3GPP access | | | | network, TNGF or | | | | core network | | | | function (e.g. AMF) | | | | can obtain Line ID | | | | (Logical Access ID | | | | see | | | | ETSI | | | | ES 282 004 [27]). | | | | More information on | | | | trusted non-3GPP | | | | access network can | | | | refer to | | | | TR 23.716 [9]. | | | +----------------------+----------------------+----------------------+
\- If the UE registered to 3GPP access and non-3GPP access simultaneously,
following information can be regarded as UE location information:
\- All location information when the UE only registered to non-3GPP access,
\- All location information when the UE only registered to 3GPP access, more
details can refer to TS 36.305 [12].
For the issue of how to obtain the location information when the UE connects
to non-3GPP access:
In the current LCS system, LMF can obtain location measurements or location
estimate from a UE via LPP protocol specified in TS 36.355 [15], and can also
obtain location related information from NG-RAN via NRPPa protocol specified
in TS 38.455 [11].
A similar solution can be applied to non-3GPP access, in which the LMF also
obtains location measurements or location estimate from a UE via LPP protocol,
and obtain location related information from N3IWF or TNGF via NRPPa protocol.
NOTE 7: It is assumed LPP protocol and NRPPa Protocol is reused in this
solution. Both LPP protocol and NRPPa protocol should be enhanced to support
non-3GPP location signalling procedure, but it belongs to RAN WG3 work scope.
### 6.13.3 Positioning Procedures
#### 6.13.3.1 Common Positioning Procedures When UE is served by the Same PLMN
This positioning procedures shown in Figure 6.13.3.1-1, when UE is served by
the same PLMN, can be triggered by:
> MO-LR (described in TS 23.271 [6] clause 9.2.6) or 5GC-NI-LR (described in
> TS 23.502 [5] clause 4.13.5.1) or 5GC-MT-LR procedure (described in TS
> 23.502 [5] clause 4.13.5.2 and 4.13.5.3) or 5GC-MT-LR (described in clause
> 6.2.3.1 proposed by solution 2) or 5GC-MO-LR (described in clause 6.2.3.2
> proposed by solution 2), etc.
Figure 6.13.3.1-1: Common positioning procedures when UE is served by the same
PLMN
1\. LMF may subscribe to the events of location change and/or access type
change, and/or CM state change to AMF in step 1a. The AMF invoke the
Namf_EventExposure_Notify service operation to notify the events in step 1b.
2\. By considering UE/network position capacity, position QoS requirement, the
access type(s) and/or the CM state per access type, the access type if
received from HGMLC that request to perform Positioning procedure, LMF can
determine the positioning methods. Furthermore, when NRPPa protocol is used to
obtain location information from NG-RAN or N3IWF/TNGF, the LMF shall decide
which access node should be chosen to transmit the location information. Based
on other information in LMF, e.g. UE/network position capacity, the CM state
per access type, position QoS requirement, LMF may override the access type
received from HGMLC and determine the position methods corresponding to the
other access type.
When LPP protocol is used to obtain location information from UE, AMF shall
decide which access node should be chosen to transmit the location
information. For example, if CM-IDLE state in 3GPP, CM-CONNECTED state in
N3GPP, AMF prefers to choose N3IWF/TNGF to relay positioning signalling to UE,
rather than performs paging procedures via the 3GPP access.
3\. The LMF invokes the Namf_Communication_N1N2MessageTransfer service
operation towards the AMF.
When Access Type included in the Namf_Communication_N1N2MessageTransfer
message indicates 3GPP Access should be used to transmit the location
information, existing 3GPP Access Positioning Procedure specified in TS 23.502
[5] clause 4.13.5 should be performed, namely step 4b or step 4c.
When Access Type included in the Namf_Communication_N1N2MessageTransfer
message indicates non-3GPP Access should be used to transmit the location
information, the non-3GPP Access Positioning Procedure should be performed,
namely step 4e.
When AMF select NG-RAN to relay positioning signalling to UE via LPP protocol,
step 4a should be performed.
When AMF select N3IWF/TNGF to relay positioning signalling to UE via LPP
protocol, step 4d should be performed.
NOTE 1: When step 4a or 4d is performed, the Positioning Message is
corresponding to the Downlink (DL) Positioning message specified in TS 23.502
[5] clause 4.13.5.4. When step 4b or 4c or 4e is performed, the Positioning
Message is corresponding to the Network Positioning message specified in TS
23.502 [5] clauses 4.13.5.5 and 4.13.5.6.
NOTE 2: Step 4a, 4b, 4c, 4d and 4e is exclusive.
4a. This step is same as step 2 to step 6 in TS 23.502 [5] clause 4.13.5.4.
4b. This step is same as step 2 to step 6 in TS 23.502 [5] clause 4.13.5.5.
4c. This step is same as step 2 to step 4 in TS 23.502 [5] clause 4.13.5.6.
4d. This step is same as step 2 to step 6 in TS 23.502 [5] clause 4.13.5.4
with the following difference:
\- NG-RAN in TS 23.502 [5] clause 4.13.5.4 is corresponding to N3IWF/TNGF in
Figure 6.13.3-1;
\- Step 2 and 5 in TS 23.502 [5] clause 4.13.5.4 should be skipped;
\- The location information returned is specified in clause 6.13.2.
4e. This step is same as step 2 to step 4 in TS 23.502 [5] clause 4.13.5.5
with the following difference:
\- NG-RAN in TS 23.502 [5] clause 4.13.5.5 is corresponding to N3IWF/TNGF in
Figure 6.13.3-1;
\- The location information returned is specified in clause 6.13.2.
5\. The AMF invokes the Namf_Communication_N1MessageNotify service operation
towards the LMF indicated by the routing identifier received in step 4 or step
5.
NOTE 3: When step 4a or 4d is performed, the Positioning Message is
corresponding to the Uplink (UL) Positioning message specified in TS 23.502
[5] clause 4.13.5.4. When step 4b or 4c or 4e is performed, the Positioning
Message is corresponding to the Network Positioning message specified in TS
23.502 [5] clauses 4.13.5.5 and 4.13.5.6.
#### 6.13.3.2 MT-LR Procedures When UE is served by the Different PLMNs via
3GPP access and Non-3GPP access
This positioning procedures shown in Figure 6.13.3.2-1, can be triggered by
5GC-MT-LR Procedure described in TS 23.502 [5] clause 4.13.5.3 or 5GC-MT-LR
procedure described in clause 6.2.3.1 proposed by solution 2, etc, when UE is
served by the different PLMNs.
Figure 6.13.3.2-1: MT-LR positioning procedures when UE is served by the
different VPLMNs
1\. An external LCS client sends a location request to an HGMLC in the HPLMN
for the target UE. The HGMLC verifies the authorization of the LCS Client to
locate the target UE and UE privacy requirements.
2\. The HGMLC invokes the Nudm_UE ContextManagement_Get service operation
towards the home UDM of the target UE with the GPSI or SUPI of the UE.
3\. For each access type, in case the procedure is triggered by 5GC-MT-LR
Procedure described in TS 23.502 [5] clause 4.13.5.3, the UDM returns serving
AMF address, possibly a VGMLC address to HGMLC to perform routing function. In
case the procedure is triggered by 5GC-MT-LR procedure described in clause
6.2.3.1 proposed by solution 2, the LMF address should also be included which
will be provided to V-GMLC in step 5.
UDM may also returns the access type(s) and its corresponding CM state(s) to
HGMLC which will be used in step 4.
NOTE 4: UDM request the CM state(s) information from AMF by invoking
Namf_EventExposure service when UDM need the CM state(s) information.
4\. When HGMLC finds that UE is served by the different PLMNs according to the
obtained serving AMF addresses, HGMLC will determine one PLMN according to
Configuration.
NOTE 5: The Configuration which can be pre-configured in HGMLC or obtained
from LCS service requests indicates which access type and/or CM state and/or
PLMN should be the prioritized target. For example, the Configuration can be
3GPP access first and/or connected state first and/or VPLMN first.
5\. In case the procedure is triggered by 5GC-MT-LR Procedure described in TS
23.502 [5] clause 4.13.5.3, the HGMLC forwards the location request to the
VGMLC and may include the AMF address received in step 3, the target UE
identity (e.g. SUPI), access type and corresponding CM state (if needed). In
case the procedure is triggered by 5GC-MT-LR procedure described in clause
6.2.3.1 proposed by solution 2, LMF address should also be included.
6\. If the procedure is triggered by 5GC-MT-LR procedure described in clause
6.2.3.1 proposed by solution 2, the VGMLC invokes the Nlmf_ProvideLocation
Request service operation to forward the location request to the LMF directly
based on the LMF address received in step 5. LMF receives the location request
directly from VGMLC.
If the procedure is triggered by 5GC-MT-LR Procedure described in TS 23.502
[5] clause 4.13.5.3, the VGMLC invokes the
Namf_Location_ProvideLocation_Request service operation to forward the
location request to the AMF. LMF receives the location request directly from
AMF.
7\. This step can refer to step 1-5 of clause 6.13.3.1 which is performed when
UE is served by the same PLMN.
NOTE 6: If the location request received by LMF has contained access type
and/or CM state, step 1a-1b of clause 6.13.3.1 may be skipped.
8-9. VGMLC will receive the location service response from LMF and then
returns positioning result to the HGMLC. The location service response may
contain positioning information (e.g. the information shown in Table
6.13.2-1), the information about the positioning method used and the
indication whether the obtained location estimate satisfies the requested LCS
QoS (e.g. accuracy) or not (described in TS 23.271 [6] clause 9.1.1).
10\. If HGMLC finds that location service response from chosen PLMN meets
required LCS QoS, it will directly return results to LCS Client directly.
Otherwise, if needed, HGMLC will forward location request to anther PLMN so as
to obtain the positioning result which can meets required LCS QoS shown as
step 11.
11\. The step obtains the positioning information from another PLMN, the
details are same as step 5-9.
12-13. Finally, HGMLC will return final location service response to LCS
client. Location service response can contain the positioning result which
meet the required LCS QoS or both results from two different PLMNs (both
failed or succeed).
Figure 6.13.3.2-2: MT-LR positioning procedures when UE is served by HPLMN and
VPLMN
Figure 6.13.3.2-2 shows the MT-LR positioning procedures when UE is served by
HPLMN and VPLMN. The difference with procedures shown in Figure 6.13.3.2-1 is
that the H-GMLC interacts with H-LMF directly shown in step 11 of Figure
6.13.3.2-2 without involving V-GMLC shown in step 11 of Figure 6.13.3.2-1.
#### 6.13.3.3 MO-LR Procedures When UE is served by the Different PLMNs via
3GPP access and Non-3GPP access
This procedures can be triggered by MO-LR (described in TS 23.271 [6] clause
9.2.6), and which PLMN/access type shall be chosen to performing MO-LR
procedures is up to UE\'s implementation.
#### 6.13.3.4 NI-LR Procedures When UE is served by the Different PLMNs via
3GPP access and Non-3GPP access
This procedures can be triggered by 5GC-NI-LR (described in TS 23.502 [5]
clause 4.13.5.1), and refer to step 1-5 of clause 6.13.3.1 which is performed
when UE is served by the same PLMN.
### 6.13.4 Impact on existing entities and interfaces
When the UE is connecting to 3GPP and Non-3GPP simultaneously, for both
scenarios that UE is served by the same PLMN and UE is served by the different
PLMNs, common impacts on existing entities are:
LMF:
\- Need to subscribe to the events of location change and/or access type
change, and/or CM state change to AMF.
\- Need to determine the positioning methods considering the UE/network
position capacity, position QoS requirement, the access type(s) and/or the CM
state per access type.
\- Need to decide which access node should be chosen to transmit the location
information when obtaining location related info when NRPPA is used.
AMF:
\- Need to decide which access node should be chosen to transmit the location
information by considering the access type(s) and/or the CM state per access
type when LPP is used.
N3IWF/TNGF:
\- Need to support NRPPa protocol to support positioning procedures for
untrusted non-3GPP access.
UE:
\- Need to support LPP protocol to support positioning procedures for
untrusted non-3GPP access.
For the specific scenario that UE is served by the same PLMN via 3GPP access
and Non-3GPP access, impacts on existing entities are:
LMF:
\- Need to determine whether to override the received access type which is
determined by HGMLC to perform positioning procedure.
For the specific scenario that UE is served by the different PLMNs via 3GPP
access and Non-3GPP access, impacts on existing entities are:
GMLC:
\- Need to choose one PLMN according to Configuration to forward LCS
positioning requests.
\- Need to support forwarding LCS positioning requests to another PLMN, when
the positioning result from the first PLMN can\'t meet the QoS requirement,
and determining final location service response to the LCS client.
UE:
\- Need to determine which PLMN/access type shall be chosen to performing MO-
LR procedures.
### 6.13.5 Evaluation
Solution 13 is one CP-based solution designed to support non-3GPP access
positioning procedures, of which key points are that LMF can subscribe
location, access type (s), CM state change event to AMF to determine
positioning methods and/or which access node can be chosen to obtain location
information. Specially, for the scenario the UE is served by different PLMNs
for 3GPP and non-3GPP accesses, GMLC can assist to decide which PLMN/access
should be chosen to perform positioning procedures.
Solution 13 can adapt to both the LMF based architecture and the AMF based
architecture. It reuses the existing 3GPP positioning procedures as much as
possible with little impacts on existing network functions and little extra
NAS signalling overhead. In addition, this solution can be applicable to most
positioning scenarios, including MO-LR, 5GC-NI-LR, and 5GC-MT-LR procedures.
## 6.14 Solution 14: Reuse R15 existing location service architecture for
commercial use cases
### 6.14.1 Introduction
In Rel-15, Location Service feature is restricted to regulatory service,
therefore, when location service is enabled, it is assumed that the UE is
allowed to be located. However, in a commercial use case, the target UE user
shall be able to set privacy as \"not allowed to be located\".
A requester of the regulatory LCS service is assumed always authorised to use
the service. However, in a commercial use case, the requestor UE or the
requestor client may or may not be authorised to use the LCS service.
The privacy setting of the target UE and the location subscriber authorization
data of the requestor client / UE can be a Data Subset of the Subscription
Data stored in the UDR accessed by the UDM..
Additionally, for commercial services, location service architecture needs to
be extended to support roaming scenario, the location service exposure and
Mobile Originating Location Request scenario.
This solution is intended to address Key Issue 1 (Enhancement to LCS
Architecture) and Key Issue 7 (Location service exposure). The solution also
addresses the following additional key issues:
\- Key Issue 3: Support of low latency LCS.
\- Key Issue 6: Scalability.
\- Key Issue 8: Support of IoT UEs.
\- Key Issue 15: Location continuity support.
\- Key Issue 5: Slicing dependent location service.
### 6.14.2 Functional Description
#### 6.14.2.1 Architecture to support Location Services
The following proposed architectures applies to both regulatory services and
commercial services, in which only entities directly relevant to location
services are shown:
\- Figure 6.14.2.1-1 shows architectural support for location services for
non-roaming scenarios using service-based interface representation, where
applicable (same with Figure 4.4.4.1-1 of TS 23.501 [4]).
\- Figure 6.14.2.1-2 shows architectural support for location services for
roaming scenarios using service-based interface representation, where
applicable.
\- Figure 6.14.2.1-3 shows architectural support for location services for
non-roaming scenarios, using the reference point representation (same with
Figure 4.4.4.1-2 of TS 23.501 [4]).
\- Figure 6.14.2.1- 4 shows architectural support for location services for
roaming scenarios, using the reference point representation.
NOTE 1: The reference point Le is shown for completeness only.
NOTE 2: If an inter-GMLC scenario is required the reference points Lr defined
in TS 23.271 [6] can be used.
NOTE 3: R-GMLC is not shown in the figures below and is assumed to be the same
as H-GMLC or V-GMLC respectively.
Editor\'s note: Whether and how to follow the naming principle of the 5GC
architecture for the LCS related reference points is FFS.
Figure 6.14.2.1-1: Non-roaming reference architecture for Location Services in
service-based interface representation
Figure 6.14.2.1-2: Roaming reference architecture for Location Services in
service-based interface representation
NOTE 1: For the LCS service exposure, Le is used to support legacy LCS clients
and an SBI interface (to the NEF for external client or directly to a GMLC in
case of authorized clients) is used to support the 5GC LCS service
applications.
NOTE 2: New 5GS LCS features may only be supported over the SBI interface.
Figure 6.14.2.1-3: Non-roaming reference architecture for Location Services in
reference point representation
Figure 6.14.2.1-4: Roaming reference architecture for Location Services in
reference point representation
#### 6.14.2.2 Reference point to support Location Services
**N1:** Reference point between UE and AMF via NAS.
**N2:** Reference point between NG-RAN and AMF.
**Le:** Reference point between a GMLC and a LCS Client.
Following reference points are realized by service based interfaces:
**NLg:** Reference point between a GMLC and an AMF.
**NLs:** Reference point between an AMF and LMF.
**NLh:** Reference point between an GMLC and UDM.
**NLr:** Reference point between an H-GMLC and V-GMLC.
**NLc:** Reference point between GMLC and CHF.
**NLe:** Reference point between GMLC and NEF.
#### 6.14.2.3 Service Based Interfaces to support Location Services
**Ngmlc:** Service-based interface exhibited by GMLC.
**Nlmf:** Service-based interface exhibited by LMF.
**Namf:** Service-based interface exhibited by AMF.
**Nudm:** Service-based interface exhibited by UDM.
**Nchf:** Service-based interface exhibited by CHF.
**Nnef:** Service-based interface exhibited by NEF.
**Naf:** Service-based interface exhibited by AF.
#### 6.14.2.4 Network Functions to support Location Services
**AMF:**
\- Location Services management for regulatory services and commercial
services.
\- Provide transport for Location Services messages between UE and LMF as well
as between RAN and LMF.
\- LMF selection.
\- LCS service authorization to the requester UE for MO-LR scenario.
**LMF:**
\- Supports location determination for a UE.
\- Obtains downlink location measurements or a location estimate from the UE.
\- Obtains uplink location measurements from the NG RAN.
\- Obtains non-UE associated assistance data from the NG RAN.
**GMLC:**
\- Privacy checking of the target UE for MT-LR scenario.
\- LCS service authorization to the LCS Client for MT-LR scenario.
\- Provide transport for Location Services messages between LCS Client and
AMF.
\- Collect charging information of the location services and report to the
CHF.
**UDM:**
\- Store and provide privacy setting of the target UE to the GMLC.
\- Store and provide location subscriber authorization data of the requestor
UE to the AMF.
**NEF:**
\- Receive location service request from the AF.
\- Provide location result to the AF.
\- LCS service authorization of the AF.
**CHF:**
\- Charge for the usage of LCS service.
### 6.14.3 Procedures
#### 6.14.3.0 LMF selection
The selection of the LMF shall take into account that the selected LMF needs
to correspond to the Access Type of the 5G AN serving the UE.
NOTE: Location methods may differ depending on the Access Type, e.g. in case
of WLAN Access some specific corporate data base may need to be accessed; As
another example, for Wireline access, Location determination may just
correspond to retrieval of geo coordinates corresponding to a Line Id.
The selection of the LMF should also take into account the 5G AN node (e.g.
gNB) currently serving the UE as the LMF may need to be configured, e.g. with
the corresponding RAN topology information, so that it can carry out the
positioning operation.
The following factors may be considered during the LMF selection:
\- Requested Quality of Service information, e.g.:
\- LCS accuracy,
\- Response time (latency),
\- LCS QoS Class.
\- Access Type (3GPP /N3GPP).
\- 5G AN type (i.e. 5G NR or eLTE) and the serving AN node (i.e. gNB or NG-
eNB) of the target UE.
\- RAN configuration information.
\- LMF capabilities.
\- LMF load.
\- LMF location.
\- Indication of either a single event report or multiple event reports.
\- Duration of event reporting.
\- Network slicing information, e.g. S-NSSAI and NSI ID.
#### 6.14.3.1 5GC-MT-LR Procedure
Figure 6.14.3.1-1 illustrates the general network positioning for LCS clients
external to the PLMN. In this scenario, it is assumed:
\- the target UE is identified using an SUPI or GPSI;
\- the privacy setting of the UE is stored in the UDR as a Data Subset of the
Subscription Data that is accessed by the UDM.
This procedure is applicable to a request from an LCS client for a current
location.
Figure 6.14.3.1-1: 5GC-MT-LR Procedure
1\. The external location services client or the AF (via NEF) sends a request
to the (H-)GMLC for a location for the target UE identified by an GPSI or an
SUPI. The request may include the required QoS, Supported GAD shapes and
client type. NEF or (H-)GMLC authorizes the AF or the External Client for the
usage of the LCS service. If the authorization fails, step 2-9 are skipped and
NEF or (H-)GMLC responds to the external Client or the AF the failure of the
service authorization in step 10.
2\. The (H-)GMLC invokes a Nudm_SDM_Get service operation towards the UDM of
the target UE to get the privacy settings of the UE identified by its GPSI or
SUPI. The UDM returns the target UE Privacy setting and the SUPI of the UE.
The (H-)GMLC checks the privacy settings. If the target UE is not allowed to
be located, step 3-9 are skipped.
3\. The (H-)GMLC invokes a Nudm_UECM_Get service operation towards the UDM of
the target UE to be located with SUPI of this UE. The UDM returns the network
addresses of the current serving AMF and possibly the address of a V-GMLC
(roaming case).
The UDM is aware of the serving AMF address based on UE registration on an AMF
(TS 23.502 [5], clause 4.2.2.2.2). The UDM made aware of a serving GMLC
address by the AMF at UE registration on an AMF (modification to TS 23.502
[5], clause 4.2.2.2.2).
4\. The (H)GMLC invokes the Namf_Location_ProvideLocation service operation
towards the AMF to request the current location of the UE. The service
operation includes the SUPI, the client type (with potentially an override
capability) and may include the required LCS QoS and Supported GAD shapes.
Editor\'s note: The list of parameters of the Namf_Location_ProvideLocation
service operation is not meant to be exhaustive, what other parameters are to
be added is FFS.
In the roaming case, if the H-GMLC received an address of a V-GMLC (together
with the network addresses of the current serving AMF) from the UDM in step 3,
the H-GMLC may send the location request to the V-GMLC that may invoke the
Namf_Location_ProvideLocation service operation towards the AMF; otherwise,
the HGMLC may use the NRF service in the HPLMN to select an available VGMLC in
the VPLMN, based on the VPLMN identification contained in the AMF address
received in step 3.
5\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in clause 4.2.3.4 to establish a
signalling connection with the UE. If it is not possible to have the UE CM-
CONNECTED, the AMF answers to the GMLC with the last known location of the UE
(i.e. Cell ID) together with the age of this location.
If the location request comes from a value added LCS client and the indicators
of privacy related action indicates that the UE must either be notified and
the UE supports notification of LCS, a notification invoke message is sent to
the target UE indicating the type of location request from the LCS Client
(e.g. current location or \"current or last known location\") and the identity
of the LCS client and the Requestor Identity (if that is both supported and
available).
6\. The AMF selects an LMF based on the current serving AN of the UE. This
selection allows to select a LMF that depends on the access Type of the UE and
in case of 3GPP access allows to select a LMF that is configured with proper
information on the radio coverage of the UE; this selection may use a NRF
query or use local configuration in AMF. The AMF invokes the
Nlmf_Location_DetermineLocation service operation towards the LMF to request
the current location of the UE. The service operation includes a LCS
Correlation identifier, the serving cell identity and the client type and may
include the required QoS and Supported GAD shapes.
The LMF selection takes the 5G-AN currently serving the UE into account.
7\. The LMF performs one or more of the positioning procedures described in
clauses 4.13.5.4, 4.13.5.5 and 4.13.5.6 of TS 23.502 [5]. During this step the
LMF may use the Namf_Communication _N1N2MessageTransfer service operation to
request the transfer of a Positioning related N1 message to the UE or the
transfer of a Network Positioning message to the serving NG-RAN node (gNB or
NG-eNB) for the UE.
8\. The LMF returns the Nlmf_Location_DetermineLocation Response towards the
AMF to return the current location of the UE. The service operation includes
the LCS Correlation identifier, the location estimate, its age and accuracy
and may include information about the positioning method.
9\. The AMF returns the Namf_Location_ProvideLocation Response towards the
(H-)GMLC to return the current location of the UE. The service operation
includes the location estimate, its age and accuracy and may include
information about the positioning method. (H-)GMLC reports to the CHF for the
usage of the LCS service.10. The (H-)GMLC sends the location service response
to the external location services client. If in step 2 the (H-)GMLC identifies
that the target UE is not allowed to be located by the requested UE user, it
rejects the LCS service request, and optionally indicate in the response the
reason of the rejection, i.e. the target UE is not allowed to be located.
#### 6.14.3.2 5GC-MO-LR Procedure
Procedures described in Figure 6.14.3.1-2 is used for a UE to request its own
location.
Figure 6.14.3.1-2: 5GC-MO-LR Procedure
1\. If the UE is in CM IDLE state, the UE performs a UE triggered service
request as defined in TS 23.501 [4].
2\. The UE sends a NAS MO-LR Request to the AMF. The UE request may contain
LCS requested QoS information (e.g. accuracy, response time, LCS QoS Class),
the requested maximum age of location and the requested type of location (e.g.
\"current location\", \"current or last known location\"). The AMF checks the
LCS service authorization data obtained together with other UE subscription
data from the UDM during UE registration for LCS service authorization. If the
authorization fails, step 4-6 are skipped and AMF responds in Step 6 on the
failure of LCS service authorization.
Step 3-5 follows Step 6-8 of 5GC-MT-LR Procedure defined in clause 6.14.3.1.
6\. AMF responds UE of its location.
#### 6.14.3.3 Deferred 5GC-MT-LR Procedure for Periodic, Triggered and UE
Available Location Events
Figure 6.14.3.3-1 summarizes a deferred 5GC-MT-LR procedure for Periodic,
Triggered and UE Available Location Events for a roaming UE. A deferred 5GC-
MT-LR procedure for a non-roaming UE would comprise a subset of the procedure
shown in Figure 6.14.3.3-1. The procedure supports mobility of a UE within a
VPLMN 5GCN and from a 5GCN to an EPC.
Figure 6.14.3.3-1: Deferred 5GC-MT-LR for periodic, triggered and UE available
location events
1\. An external LCS client sends a deferred location request for a periodic,
triggered or UE available location event for a target UE to an HGMLC in the
HPLMN for the UE. The location request provides the type of location reporting
being requested and associated parameters. For periodic location, the request
includes the time interval between successive location reports, the total
number of reports and a location QoS. For triggered reporting for an area
event, the request includes details of the target area, whether the trigger
event to be reported is the UE being inside, entering or leaving the target
area, whether event reporting shall include UE location estimates and if so a
location QoS and the duration of reporting. For triggered reporting for the
motion event, the request includes a threshold linear distance for triggering
a location report, whether event reporting shall include UE location estimates
and if so a location QoS and the duration of reporting. For the UE available
location event, a location QoS may be included.
NOTE 1: The external LCS client may instead be an NF or an AF which accesses
the HGMLC via an NEF as described in clause 6.9 for Solution 9 and clause 6.23
for Solution 23.
2\. The HGMLC may verify UE privacy requirements by querying the UDM as
described for step 2 in Figure 6.14.3.1-1. If the target UE is not allowed to
be located, subsequent steps are skipped.
3\. The HGMLC invokes the Nudm_UECM_Get service operation towards the home UDM
of the target UE with the GPSI or SUPI of the UE to obtain the serving AMF
address and optionally a VGMLC address and current access type(s) for the
target UE as described for step 3 of Figure 6.14.3.1-1.
NOTE 2: The HGMLC may also query the HSS of the target UE for a serving MME
address as described in clause 9.1.1 of TS 23.271 [6]. The deferred EPC-MT-LR
procedure for Periodic and Triggered Location described in clause 9.1.19 of TS
23.271 [6] or the EPC-MT-LR procedure for the UE availability event described
in clause 9.1.15 of TS 23.271 [6] may then be performed instead of steps 4-40
- e.g. if the HSS returns an MME address but the UDM does not return an AMF
address.
4\. If a VGMLC address was not returned in step 3, the HGMLC may use the NRF
service in the HPLMN to select an available VGMLC in the VPLMN, based on the
VPLMN identification contained in the AMF address received in step 3. The
HGMLC forwards the location request to the VGMLC and includes the AMF address,
the target UE identity (e.g. SUPI), any access type(s) received at step 3 and
any privacy requirements for the UE. The HGMLC also includes a contact address
for the HGMLC (Notification Target Address, e.g. a URI) and an LDR reference
number (Notification correlation ID) to be used for event reporting at steps
19, 29 and 34.
5\. The VGMLC invokes the Namf_Location_ProvidePositioningInfo Request service
operation to forward the location request including all information received
at step 4 to the serving AMF. The VGMLC may optionally determine an LMF and
then includes the LMF identity in the request sent to the AMF.
6-8. If the AMF supports a deferred location request, the AMF returns an
acknowledgment to the external LCS client, via the VGMLC and HGMLC, indicating
that the request for deferred location was accepted. The VGMLC may optionally
release resources for the deferred location request at this point.
NOTE 3: As an optional optimization, a VGMLC may not be used. In this case,
instead of performing steps 4-7, the HGMLC invokes the
Namf_Location_ProvidePositioningInfo Request service operation to forward the
location request directly to the AMF. The AMF then returns an acknowledgment
directly to the HGMLC.
9\. If the UE is not currently reachable (e.g. is using eDRX or PSM), the AMF
waits for the UE to become reachable.
NOTE 4: In the event of mobility of the UE to another AMF or to EPC when the
UE becomes reachable, the old AMF can return an event indication to the HGMLC
as at steps 18 and 19 and may include the address of the new serving AMF or
MME if known. If a new serving AMF or MME is not known, the HGMLC can repeat
steps 2 and 3 to query the UDM and HSS for the new AMF or MME address. The
HGMLC can then restart the procedure from step 3.
10\. Once the UE is reachable, the AMF performs a network triggered service
request if needed to move the UE into connected state.
11\. The AMF may notify the UE and verify UE privacy requirements based on any
privacy requirements received from the HGMLC in steps 4-5. If this occurs, the
AMF sends a supplementary services Location Notification invoke to the UE.
12\. The UE notifies the user of the location request and verifies user
permission if UE privacy is to be verified. The UE then returns a
supplementary services Location Notification response to the AMF indicating
whether the user grants or withholds permission for the location request when
UE privacy is verified.
13\. The AMF determines an LMF, e.g. based on an LMF identity provided by the
VGMLC in step 5, the type of location request and current UE access type(s) or
as described for step 6 in Figure 6.14.3.1-1. The AMF then invokes the
Nlmf_Location_DetermineLocation Request service operation towards the LMF to
initiate a request for deferred UE location. For a request for periodic or
triggered location, the AMF includes all the information received in step 5
including the HGMLC contact address and LDR reference number. For a request
for the UE available location event, the HGMLC contact address and LDR
reference number are not included. In all cases, the request includes an LCS
Correlation identifier, the serving cell identity, the client type and may
include the required QoS and Supported GAD shapes.
14\. The LMF instigates a UE positioning procedure using the UE Assisted and
UE Based Positioning Procedure described in clause 4.13.5.4 of TS 23.502 [5]
and/or the Network Assisted Positioning Procedure described in clause 4.13.5.5
of TS 23.502 [5]. During this procedure, the LMF may request and obtain the UE
positioning capabilities (e.g. which may indicate the type(s) of periodic and
triggered location supported by the UE and the access types supported by the
UE for event reporting). The LMF may also obtain the UE location - e.g. for a
request for the UE available location event or when an initial location is
requested for periodic or triggered UE location. For a request for the UE
available location event, the LMF skips steps 15 and 16.
15\. As part of step 14 and if periodic or triggered location was requested,
the LMF sends a Periodic-Triggered Location Request to the UE via the serving
AMF by invoking the Namf_Communication_N1N2MessageTransfer service operation.
The Periodic-Triggered Location Request carries the location request
information received from the AMF at step 13, including the HGMLC contact
address and LDR reference number. The Periodic-Triggered Location Request also
includes a deferred rouiting identifier, which can be the identification of
the LMF when the LMF will act as a serving LMF or a default LMF identification
otherwise. The Periodic-Triggered Location Request may indicate the allowed
access types for event reporting at step 22 (e.g. one or more of NR, E-UTRA
connected to 5GC, E-UTRA connected to EPC, non-3GPP access connected to 5GC)
and may indicate certain allowed or required location measurements (or a
location estimate) at step 22 for each location event reported (e.g. based on
the positioning capabilities of the UE obtained as part of step 14 and the
allowed access types). When EDT transfer is allowed for step 24, the Periodic-
Triggered Location Request may also include information for EDT reporting as
described for Solution 21 in step 19 of Figure 6.21.3.2-1. As part of NAS
transport of the Periodic-Triggered Location Request from the serving AMF to
the UE, the serving AMF includes an immediate routing identifier in the NAS
transport message identifying the LMF - e.g. as already supported in Release
15 according to clause 4.13.5.4 of TS 23.502 [5].
NOTE 5: The deferred roiting identifier may be global (e.g. an IP address,
UUID or URI) or may be local. This The deferred routing identifier is used for
routing in step 24. However, the immediate routing identifier included by the
AMF in step 15 is used for routing in step 16. The 2 routing identifiers may
or may not be the same - e.g. may be different when the deferred routing
identifier is for a default LMF or a LMF which is different to the current
LMF.
16\. If the request in step 15 can be supported, the UE returns an
acknowledgment to the LMF as part of step 14, which is transferred via the
serving AMF using the immediate routing identifier and delivered to the LMF
using an Namf_Communication_N1MessageNotify service operation.
NOTE 6: The Periodic-Triggered Location Request sent at step 15 and its
acknowledgment at step 16 may be messages for a positioning protocol (e.g.
LPP) or may be messages for a separate protocol (e.g. a supplementary services
protocol). In the latter case, each message may carry an embedded positioning
protocol message to enable the LMF to request or allow specific location
measurements from the UE at step 24 and to set up an initial location session
for the location reporting at step 24.
17\. The LMF invokes the Nlmf_Location_DetermineLocation Response service
operation towards the AMF to respond to the request at step 13. For a request
for the UE available location event, the response includes any UE location
obtained at step 14 and the LMF then releases all resources. For a periodic or
triggered location request, the response includes any location obtained at
step 14, a confirmation of whether periodic or triggered location was
successfully activated in the UE according to steps 15 and 16 and the
identification of the LMF in the case of successful activation with a serving
LMF; the LMF also retains state information and resources for later steps if
the LMF acts a serving LMF.
18\. The AMF invokes the Namf_Location_EventNotify service operation towards
the VGMLC and includes any location received at step 17 and for periodic or
triggered location, a confirmation of whether periodic or triggered location
was successfully activated in the target UE. The VGMLC may be the same VGMLC
used in steps 5 and 6 or may be a different VGMLC. In the case of a different
VGMLC, the AMF includes the HGMLC contact address and LDR reference number.
The AMF also includes the LMF identification if received at step 17. The AMF
may then release all resources for the location request and cease support for
the procedure.
19\. The VGMLC forwards the response received at step 18 to the HGMLC using
the HGMLC contact address received at step 18 (for a different VGMLC) or
received and stored at step 4 (for the same VGMLC) and includes the LDR
reference number and any LMF identification that was received. The VGMLC may
then release all resources for the location request and cease support for the
procedure.
NOTE 7: As an optional optimization, instead of performing steps 18 and 19,
the AMF may invoke the Namf_Location_EventNotify service operation directly
towards the HGMLC (e.g. if a VGMLC is not used or if the VGMLC ceases support
after step 8).
20\. The HGMLC forwards the response to the external LCS client. If the
location request at step 1 was for the UE available location event, the
procedure terminates here and further steps 21-40 are not performed.
21\. For a periodic or triggered location request where steps 15 and 16 were
successfully performed, the UE monitors for occurrence of the trigger or
periodic event requested in step 15. When a trigger event is detected and if
the UE is camped on or connected to (or can otherwise access) an access type
allowed by the LMF at step 15, the UE proceeds to step 22. If the UE cannot
access an allowed access type, the UE may skip reporting the trigger event or
may report the trigger event at a later time when an allowed access type
becomes available, according to requirements received from the LMF at step 15.
22\. The UE obtains any location measurements or a location estimate that were
requested or allowed at step 15.
23\. The UE performs a service request if in idle state and if the UE will
report the location event using a NAS signalling connection at step 24\. The
description here assumes that 3GPP access to 5GC is used for steps 23-27,
although similar steps can apply to non-3GPP access to 5GC.
24\. The UE sends an event report message to the LMF which is transferred via
the serving AMF (which may be different to the original serving AMF for steps
14-16) and is delivered to the LMF using an Namf_Communication_N1MessageNotify
service operation. The event report may indicate the type of event being
reported and includes any location measurements or location estimate obtained
at step 22. The UE also includes the deferred routing identifier received in
step 15 in the NAS Transport message used to transfer the event report from
the UE to the AMF. The AMF then forwards the event report to either the
serving LMF or any suitable LMF based on whether the deferred routing
identifier indicates a particular LMF or any (default) LMF. The UE also
includes the HGMLC contact address, the LDR reference number, whether location
estimates are to be reported and if so the location QoS in the event report.
The event report may be transferred to the serving AMF using a NAS signalling
connection if the UE is in connected state or may be transferred using the EDT
procedure described for Solution 21 by performing steps 29-32 in Figure
6.21.3.2-1.
NOTE 8: When forwarding the event report message to the LMF in step 24 or when
forwarding an uplink positioning message to the LMF in step 26 when step 26 is
performed, the AMF does not include an LCS Correlation Identifier (because the
AMF does not have an LCS Correlation Identifier). To allow the AMF to be aware
that an LCS Correlation Identifier is not needed, the deferred routing
identifier sent by the LMF in step 15 and possibly reassigned in step 25 can
indicate that an LCS Correlation Identifier is not used. For example, a
deferred routing identifier could include a flag or could be selected from a
different range of identifiers to the immediate routing identifier sent by the
AMF at step 15.
25\. Unless the event report was sent at step 24 using EDT where a response
from the LMF is not allowed, the LMF returns an acknowledgment for the event
report to the UE. The acknowledgment may optionally include a new deferred
routing identifier indicating a new serving LMF or a default (any) LMF.
NOTE 9: The event report and acknowledgment sent at steps 24 and 25 may be
messages for a positioning protocol (e.g. LPP) or may be messages for a
separate protocol (e.g. a supplementary services protocol). In the latter
case, the event report at step 24 may carry an embedded UL positioning message
to enable the UE to include any location measurements or location estimate
obtained at step 22.
NOTE 10: Inclusion of a new deferred routing identifier in the event report
acknowledgment at step 25 may be used to change the serving LMF (e.g. if a UE
moves into an area or to an access type that is better supported by a
different LMF or if the serving LMF is overloaded) or to enable a default LMF
to become a serving LMF.
26\. If the UE sends the event report to the LMF at step 24 using a NAS
signalling connection when in connected state, the LMF may obtain location
measurements or a location estimate for the UE by performing a UE positioning
procedure using the UE Assisted and UE Based Positioning Procedure described
in clause 4.13.5.4 of TS 23.502 [5] and/or the Network Assisted Positioning
Procedure described in clause 4.13.5.5 of TS 23.502 [5].
27\. If a location estimate is needed for event reporting, the LMF determines
the UE location using the location measurements and/or location estimate(s)
obtained at step 24 and/or step 26.
28\. The LMF selects a VGMLC (which may be different to the VGMLC for steps
3-8 and steps 18-20) and invokes an Nlmf_EventNotify service operation towards
the VGMLC with an indication of the type of event being reported, the H-GMLC
contact address and LDR reference number, the identification of the LMF, and
any location estimate obtained at step 27.
NOTE 11: The LMF may select the VGMLC for step 28 using the NRF service or
using configuration information in the LMF or may use the same VGMLC as for
steps 3-8 (e.g. if the LMF acts as a serving LMF and received the VGMLC
address from the AMF as part of step 13).
29\. The VGMLC forwards the information received in step 28 (e.g. including
the type of event being reported, the LDR reference number and possibly the
LMF identification) to the HGMLC which identifies the periodic and triggered
location request from the LDR reference number.
NOTE 12: As an optional optimization, instead of performing steps 28 and 29,
the LMF may invoke the Nlmf_EventNotify service operation directly towards the
HGMLC.
30\. The HGMLC uses the LDR reference number received in step 29 to identify
the periodic and triggered location request received in step 1 and then sends
the type of event being reported and any location estimate to the external LCS
client. The HGMLC may also verify UE privacy requirements before reporting the
event and any location to the external LCS client.
31\. The UE continues to monitor for further periodic or trigger events and
instigates steps 22-30 each time a trigger event is detected.
NOTE 13: If the target UE is unable to access the 5GCN in the VPLMN for a
repetition of step 23 but is allowed to and can access E-UTRA connected to EPC
for the VPLMN, the UE may report the location event using event reporting for
the Deferred EPC-MT-LR for Periodic and Triggered Location procedure described
in clause 9.1.19 of TS 23.271 [6] by instigating steps 13-24 in Figure
9.1.19.1-1 in TS 23.271 [6]. In this case, the UE includes the HGMLC contact
address and LDR reference number when sending the MO-LR Invoke at step 14 for
Figure 9.1.19.1-1 in TS 23.271 [6] which enables the serving MME for the UE to
report the location event to the HGMLC using steps 19-21 in Figure 9.1.19.1-1
in TS 23.271 [6]. Typically, the E-SMLC used for the procedure in clause
9.1.19 of TS 23.271 [6] would be different and separate from the LMF for steps
14-16 here, although a proprietary procedure might be used by a VPLMN to
enable the E-SMLC to access (e.g. read and/or modify) state information for
the UE in the LMF (e.g. using the HGMLC contact address and LDR reference
number as a key to identify the UE state information), which might assist
location of the UE by the E-SMLC and/or by the LMF at a later time.
32\. In order to cancel the location request (e.g. if the UE is powered off or
if the user wishes to cancel the location), the UE performs step 24 and
optionally step 23 to send a Cancel Location request message to the LMF
indicating that periodic or triggered location was cancelled.
33-35. The LMF forwards the cancelation request to the HGMLC and external LCS
client.
36\. If the external LCS client wishes to cancel the periodic or triggered
location, the external LCS client sends a request to the HGMLC.
37-38. The HGMLC determines the serving AMF address as in steps 2-3 and
forwards the cancelation request to the AMF either directly or via a VGMLC.
The HGMLC includes the HGMLC contact address, the LDR reference number and the
latest LMF identification received in step 19 or step 29 if either step has
occurred and included an LMF identification.
39\. If an LMF identification was included in steps 37-38, the AMF forwards
the cancelation request to the indicated LMF by invoking an
Nlmf_CancelLocation service operation and includes the HGMLC contact address
and LDR reference number. The LMF then releases all resources for the location
request.
40\. The AMF sends the cancelation request to the target UE as soon as the
target UE becomes reachable and includes the HGMLC contact address and the LDR
reference number. The UE then releases all resources for the location request.
NOTE 14: Steps 39 and 40 are only performed if step 18 has already occurred
and periodic or triggered location was activated in the UE. In this case, the
AMF will have no knowledge of the location request (since all resources are
released after step 18) and can thereby determine that step 18 must have
occurred. If step 38 occurs before step 18, the AMF only performs steps 39 and
40 if step 13 has already occurred (and after step 17 occurs). Otherwise, if
step 13 has not yet occurred, steps 39 and 40 are omitted.
NOTE 15: The cancellation request sent to the UE at step 40 could be a message
for supplementary services or a NAS message and can be resolved later as part
of stage 3 definition.
#### 6.14.3.4 LMF change procedure via serving LMF
When a serving LMF is used for the procedure in Figure 6.14.3.3-1, mobility of
the target UE may lead to a change of serving AMF for which the original
serving LMF is not suitable. For example, the serving LMF may be very remote
from the AMF leading to higher resource utilisation for AMF to LMF signalling
or the LMF may not be configured with information (e.g. a cell database) for
the current access network for the UE to enable location. In such a case, the
serving LMF may need to change. Figure 6.14.3.4-1 shows a procedure to enable
change of the serving LMF when a UE sends an event report at step 24 in Figure
6.14.3.3-1.
Figure 6.14.3.4-1: Change of serving LMF for periodic and triggered UE
location events
Precondition: Steps 1-22 in Figure 6.14.3.3-1 have been performed including
possibly a repetition of steps 21-22 for a subsequent event report. A serving
LMF is used and the current serving LMF is LMF1.
1\. The UE performs a service request if needed as for step 23 in Figure
6.14.3.3-1.
2\. The UE sends a NAS Transport message containing an event report message to
the serving AMF. The NAS Transport message includes a deferred routing
identifier indicating LMF1. Step 2 corresponds to part of step 24 for Figure
6.14.3.3-1.
3\. Based on operator configuration and policy, the AMF may evaluate and
determine that LMF1 is unsuitable or unable to support location for the
current UE access network or serving cell and determines LMF2 as being a more
suitable LMF.
4\. The AMF invokes the Namf_Communication_N1MessageNotify service operation
towards LMF1. The service operation includes the event report received in step
2. If the AMF determined in step 3 that a new LMF2 should be used, it
indicates that to the LMF1 as well.
5\. If AMF did not indicate a new LMF in step 4, based on the operator
configuration and policy, LMF1 may evaluate and determine that it is
unsuitable or unable to support location for the current UE access network or
serving cell and determines LMF2 as being a more suitable LMF.
6a. LMF1 invokes an Nlmf_LocationContextTransfer service operation towards
LMF2 to provide the current location context of the UE and includes the event
report message received in step 3. The service operation includes the AMF
identity and all the information originally received by LMF1 for the periodic
or triggered location request either from the AMF according to the procedure
in Figure 6.14.3.3-1 or from an earlier serving LMF according to this
procedure. The service operation may also include the current status of event
reporting (e.g. the number of event reports so far received from the UE and/or
the duration of event reporting so far) and may include location related
information for the UE such a previous location estimate or location
measurements. LMF1 then releases all resources for the procedure.
6b. LMF2 informs LMF1 of the location context transfer operation results.
7\. LMF2 invokes the Namf_Communication _N1N2MessageTransfer service operation
towards the AMF to request the transfer of an Event Report Acknowledgment
message to the UE. The Event Report Acknowledgment indicates a change of LMF
and includes a deferred routing identifier indicating LMF2.
> NOTE: In a network where change of an serving LMF is possible, the original
> serving LMF shall not allow the UE to use EDT transfer at step 2 in which a
> response from the serving LMF is not possible. This will avoid not being
> able to return the deferred routing identifier indicating the new serving
> LMF2 to the UE in step 6.
8\. The AMF forwards the Event Report Acknowledgment to the UE in a NAS
Transport message.
9\. The AMF informs the LMF2 of the result of the delivery of the Event Report
Acknowledgement using the NAS Transport message.
10\. Unless EDT transfer is used at stage 2, LMF2 may obtain location
measurements or a location estimate for the UE by performing a UE positioning
procedure as at step 26 in Figure 6.14.3.3-1.
11\. If a location estimate is needed for event reporting, LMF2 determines the
UE location as at step 27 in Figure 6.14.3.3-1. The rest of the procedure in
Figure 6.14.3.3-1 then continues from step 28 with LMF2 retaining state
information to enable support of subsequent event reports from the UE.
### 6.14.4 Impacts on existing entities and interfaces
#### 6.14.4.1 Impacts to UDR and UDM
Impacts to UDR: New Data Subset of the Subscription Data Storage, i.e. the
privacy setting of the target UE and the location subscriber authorization
data of the requestor UE.
Impacts to UDM:
\- GMLC being a new consumer of UDM service operation;
\- new Subscription data types: UE LCS privacy and location subscriber
authorization data of the requestor UE.
#### 6.14.4.2 Impacts to GMLC
\- Capability to invoke Nudm_SDM_Get service operation.
\- Capability of LCS service request handling based on target UE privacy
setting.
\- GMLC to GMLC interface (and addition of the V-GMLC role).
\- Support a deferred location request from an external LCS Client (impact may
be the same as for EPS)
\- Forward a deferred location request from an HGMLC to a VGMLC (impact may be
the same as for EPS)
\- Forward a deferred MT-LR location request to an AMF and receive an
immediate confirmation of acceptance and later confirmation of activation in
the target UE and return these to an HGMLC or external LCS client.
\- Receive event reports from an LMF and forward these to an HGMLC or external
LCS client.
\- Support cancelation of a periodic or triggered location.
#### 6.14.4.3 Impacts to UE
UE impacts comprise the following:
\- Support for privacy notification and verification for a 5GC-MT-LR.
\- Support for invocation of a 5GC-MO-LR.
\- Support receipt of a Periodic-Triggered Location Request from an LMF for
periodic triggered location and an ability to confirm or reject the request.
\- Monitor for periodic or triggered location events and report the occurrence
of an event to an LMF along with any requested location measurements or
location estimate.
\- Support change of an serving LMF during location event reporting.
\- Support cancelation of periodic or triggered event reporting by the UE or
by an external LCS Client.
#### 6.14.4.4 Impacts to AMF
AMF impacts comprise the following:
Support for privacy notification and verification for a 5GC-MT-LR.
\- Support for an 5GC-MO-LR.
Support a deferred MT-LR location request from a VGMLC or HGMLC.
\- Support an immediate response to a VGMLC or GGMLC to confirm acceptance of
a periodic or triggered request and a later response to the VGMLC or HGMLC to
confirm activation of the periodic or triggered location request in the UE.
\- Support cancelation of a periodic or triggered location.
\- Optionally support change of a serving LMF by determining a new LMF.
\- Support a request for a deferred periodic or triggered location request for
a target UE.
#### 6.14.4.5 Impacts to LMF
LMF impacts comprise the following:
\- Support a request for a deferred periodic or triggered location request for
a target UE received from an AMF.
\- Send a Periodic-Triggered Location Request to the UE to activate periodic
or triggered location in the UE and receive a confirmation (or rejection) from
the UE and include this in the response to the AMF.
\- Receive triggered or periodic events reports from the UE for events
detected by the UE and obtain the UE location if this is needed and forward
the event report and any location to a VGMLC or HGMLC for return to an
external LCS Client.
\- support change of a serving LMF including determining a new LMF and sending
location context information for the UE to the new serving LMF.
\- Support cancelation of a periodic or triggered location.
### 6.14.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.15 Solution 15: Enhancement to LCS architecture
### 6.15.1 Introduction
This solution addresses the modified Key Issue 1 \"Enhancement to LCS
architecture\" and proposes LMF architecture split by including Location
Management (LM) capabilities in the NG-RAN and the UE. Further, the impact to
the 5GC, particularly LMF, are discussed. The solution also applies to Key
Issue#3 \"support of low latency LCS\" and Key Issue#8 \"Support of IoT UEs\".
### 6.15.2 Functional Description
The solution proposal includes LM capabilities assigned to the NG-RAN and UE,
referred as RAN-LMC (Location Management Component) and UE-LMC respectively,
as shown in Figure 6.15.2-1. Legacy LCS functions from TS 23.271 [6] as well
as enhanced LCS functions based on new positioning requirements and methods
may be mapped to these roles.
NOTE 1: The bullets of roles in NG-RAN and UE listed in this clause are
subject to further work from RAN WGs.
Figure 6.15.2-1: Enhanced LCS architecture with local LMF
The RAN-LMC and UE-LMC perform partial location management role in the RAN and
UE respectively and implement a subset of the functionalities of the LMF in
the 5GC, as well as new functionalities arising out of performing location
management at the RAN/UE levels.
The RAN-LMC and UE-LMC perform the following roles in the enhanced LCS
architecture:
\- Location measurement collection: collect location-related measurements for
the Uu interface.
\- Position calculation: compute absolute/relative positions based on
collected location measurements.
\- Location information report: report calculated positions to requesting
entities over the Uu interface.
\- Cooperation among peers: share location measurements, position-related
information, load balancing, etc. among peer LMCs.
\- Positioning performance monitoring: monitor and predict positioning
performance.
\- Communication to CN: Communicate with LMF, AMF and other 5GC LCS functions.
NOTE 2: Details of some LCS functionalities and new positioning methods should
be studied in RAN WGs.
The LMF in 5GC should perform additional procedures in order to enable the
RAN-LMC and UE-LMC to function in the enhanced LCS architecture:
\- Capability verification: Verify the positioning capabilities of RAN- or UE-
LMCs.
\- Authorization: authorize RAN- or UE-LMCs to operate in the network.
\- Location group management: Manage grouping of RAN- or UE-LMCs for
cooperation in order to meet positioning KPIs.
\- Privacy management: Configure privacy rules for information sharing between
and within groups of RAN- or UE LMCs.
\- Location performance control: location performance management to control
and guarantee overall positioning performance.
\- Subscriber management: Billing and charging for RAN- or UE-LMCs.
\- Location service management: allow for different and new types of location
services to be provided by the RAN- or UE LMCs.
### 6.15.3 Procedures
#### 6.15.3.1 RAN-LMC registration
Figure 6.15.3-1 shows a procedure which may be used by a RAN to register its
LMC to LMF or by the LMF to activate a RAN-LMC in order to offload LCS
traffic. This procedure is not associated with a UE location session. It is
used to grant the use of a RAN-LMC at the LMF in 5GC. The procedure may be
based on an NRPPa protocol in TS 38.455 [11] between the LMF and NG-RAN.
Figure 6.15.3-1: Procedure for RAN-LMC registration at LMF
1\. In case that the registration procedure is initiated by a RAN, the RAN
includes an LMC registration request in an N2_Transport message.
2\. The AMF selects an LMF and invokes the Namf_Communication_N2InfoNotify
service operation towards this LMF to transfer the LMC registration request.
The service operation includes the RAN node identity.
3\. The LMF determines if the registration can be granted based on the RAN\'s
capability. In case that the procedure is initiated by the LMF, step 1 and 2
are omitted. Based on certain factors such as the LCS QoS and/or LMF traffic
load, the LMF determines if an LMC in RAN should be granted.
4\. The LMF invokes the Namf_Communication_N2MessageTransfer service operation
towards the AMF to request the transfer of an LMC registration grant to a RAN
node. The service operation includes the RAN node identity.
5\. The AMF forwards the LMC registration grant to the RAN node indicated in
step 4 in an N2 Transport message. The AMF includes a Routing identifier, in
the N2 Transport message, identifying the LMF as the manager of the RAN-LMC.
NOTE: Coordination procedures between UE and RAN-LMC should be studied within
RAN scope.
Alternatively, RAN-LMC registration may be handled by AMF. The procedure is
adjusted as it is shown in Figure 6.15.3-2. This procedure may be combined
with NG setup or RAN configuration update procedure over NG-AP in TS 38.413
[26]. The AMF informs the LMF about the LMC registration using AMF service
message.
Figure 6.15.3-2: Procedure of RAN-LMC registration at AMF
#### 6.15.3.2 LMC performance control
The LMF monitors the performance of the registered RAN-LMC by receiving LMC
performance report. The LMC performance report may be provided in an on-demand
or periodic manner. Figure 6.15.3-3 shows the procedure for on-demand
performance report. The performance reports may consist LCS QoS information
and LCS load at RAN-LMC. The LMF makes further decision, such as deactivation
or activation/usage of new RAN-LMCs, based on the performance report obtained.
This procedure is not associated with a UE location session and based on an
NRPPa protocol between the LMF and NG-RAN.
Figure 6.15.3-3: Procedure for RAN-LMC performance control at LMF
1\. The LMF invokes the Namf_Communication_N2MessageTransfer service operation
towards the AMF to request the LMC performance report to a RAN node. The
service operation includes the RAN node identity.
2\. The AMF forwards the LMC performance report request to the RAN node
indicated in step 1 in an N2 Transport message.
NOTE: Step 1-2 are optional and used only in case of LMF is requesting a LMC
performance report(e.g., triggered by resource demanding/low latency location
service request).
3\. The RAN-LMC obtains the performance report requested in step 2.
4\. The RAN node returns the performance report obtained in step 3 to the AMF
in an N2 Transport message. The RAN node shall also include the Routing
identifier of the manager LMF received at registration.
5\. The AMF invokes the Namf_Communication_N2InfoNotify service operation
towards the LMF indicated by the routing identifier received in step 4. The
service operation includes the LMC performance report received in step 4.
Alternatively, RAN-LMC performance control may be handled by AMF. This
procedure may be combined with the RAN configuration update procedure over NG-
AP in TS 38.413 [26] as it is shown in Figure 6.15.3-4. AMF may request
performance report from LMC (e.g., triggered by resource demanding/low latency
location service request), and determines whether a new LMC needs to be
activated/deactivated/used, the required configuration of RAN-LMCs, based on
the performance report (e.g., LCS QoS information and LCS load) obtained. The
AMF may provide the performance report to LMF using AMF service message.
Figure 6.15.3-4: Procedure for RAN-LMC performance control at AMF
In some circumstance, LMC registration and LMC performance control procedures
can be combined. For instance, the LMC registration message may include also
the LMC performance report information. Whenever the LMC performance changes,
new LMC registration is performed. In the case of high dynamics on LCS load,
RAN-LMC needs to send more frequent performance report. It is therefore
unnecessary to verify capability of RAN-LMC upon reception of every
performance report. Meanwhile, LMF/AMF may request LMC performance report only
when needed to reduce the signalling overhead. In such cases, two independent
procedures would be necessary.
### 6.15.4 Impacts on existing entities and interfaces
The enhanced LCS architecture requires LMC management functionalities
implemented at LMF, such as LMC registration, capability verification and
performance control. For the interactions between RAN-LMC and LMF, NRPPa
protocol over N2 interface can be reused.
In case the LMC management functionalities is implemented at AMF, the
interactions between RAN-LMC and AMF may be based on new NGAP elementary
procedures supporting LMC management, or be combined with the existing NG
setup and/or RAN configuration update procedures.For both options, NG-RAN
supports the functionality of LMC.
### 6.15.5 Evaluation
This solution proposes to distribute location management capability in RAN/UE,
allowing for more flexible resource usage. When sufficient measurements and
assistance information can be obtained within RAN, position calculation may be
carried out at LMC in RAN. This avoids the signalling overhead from sending
measurements to the centralized LMF in 5GC. For use cases with stringent
latency requirements, a LMF may authorize LMC close to UE in order to reduce
the delay caused by communication to the LMF in CN.
The proposal also provides necessary procedures to include LMC management
functionalities at either LMF or AMF. The pros and cons of the two options are
summarized in Table 6.15-1.
Table 6.15-1
+----------------------+----------------------+----------------------+ | | Pros | Cons | +----------------------+----------------------+----------------------+ | LMC management at | Clean design: all | Longer communication | | LMF | LCS related | path to LMC --> | | | functionalities are | higher latency. | | | implemented at LMF. | | | | | | | | Allow for different | | | | location management | | | | architecture (e.g., | | | | hierarchical). | | +----------------------+----------------------+----------------------+ | LMC management at | Shorter | Complex | | AMF | communication path | functionality split | | | to LMC --> lower | between AMF and LMF. | | | latency. | Synchronization of | | | | LMC management | | | | needed between AMF | | | | and LMF. | | | | | | | | Increased complexity | | | | at AMF. | +----------------------+----------------------+----------------------+
## 6.16 Solution 16: Solution for position via user plane transmission
### 6.16.1 Introduction
This solution addresses Key Issue 2 on Positioning via user plane
transmission.
### 6.16.2 Functional Description
At network side, 5G LMF and UCF (User plane Connection Function) are required
to support position via user plane. UCF establishes the secure connection with
UE via user plane, and it transfers the SUPL message between UE and 5G LMF. 5G
LMF supports MO and MT positioning via user plane, and 5G LMF computes the UE
location according to the position measurement data contained in SUPL
messages.
### 6.16.3 Procedures
### 6.16.3.1 UE establishes the connection with UCF
The flow below indicates the UE establishes the security connection with UCF.
Figure 6.16.3.1-1: the connection establishment between UE and UCF
1\. URSP configured in the UE may indicate which PDU session is used to
establish the connection with UCF. UE retrieves UCF address via e.g. DNS
mechanism or local configuration. For roaming scenario, UE interacts the UCF
in VPLMN.
2\. NF requests to establish the security connection with the selected UCF via
user plane.
3\. UCF sends Nudm_UECM_Registration Request (Public UE Identity, UCF NF type,
UCF NF ID) to UDM to perform the serving NF registration.
4\. UDM stores the associated UE with the serving UCF, and it responds to UCF
via Nudm_UECM_Registration Response message.
After establishing the connection, UE and UCF maintain the connection context
for later message transfer via user plane.
### 6.16.3.2 UE initiated position via user plane
The flow below indicates the UE initiates position via user plane.
Figure 6.16.3.2-1: UE initiated position via user plane
0\. UE already established the connection with UCF.
1\. UE sends Uplink message including Public UE Identity, message type and
SUPL payload to UCF, and the uplink message is encrypted with the security
context, and message type indicates the message is for LCS service.
2\. UCF decrypts the Uplink message and determines the serving NF type
according to the associated message type with the serving NF type. UCF may
further determine the serving LMF via requesting Nudm_UECM_Get serving
operation from UDM if the UCF does not maintain the mapping between UE and the
serving LMF.
3\. UCM sends SUPL payload to the serving LMF via
Nucf_Communciation_MessageNotify including UE Identity and SUPL payload.
4\. LMF identify the SUPL message and perform the SUPL positioning procedure.
During SUPL procedure, UCF transfers the SUPL message between UE and LMF.
### 6.16.3.3 Network initiated position via user plane
The flow below indicates the network initiates position via user plane.
Figure 6.16.3.3-1: Network initiated position via user plane
> 0\. When receiving location service request for one UE, LMF determines to
> initiate MT location via user plane.
>
> 1\. If LMF does not store the UCF that serves the target UE, LMF may
> determine the serving LMF via requesting Nudm_UECM_Get serving operation
> from UDM.
>
> 2\. LMF generates an SUPL initiation message and transfers it to UCF via
> Nucf_Communication_MessageTransfer request including UE Identity and SUPL
> payload.
>
> 3\. UCF determines the target UE according to the stored context of the
> connection with UE, and it encrypts message and send the Downlink message to
> the target UE.
>
> 4\. LMF and the target UE perform the SUPL positioning procedure. During
> SUPL procedure, UCF transfers the SUPL message between UE and LMF.
### 6.16.4 Impacts on existing entities and interfaces
The solution impact the following network functions:
\- New NF called \"UCF\" is required to establish the connection with UE and
transfer the SUPL signalling between UE and LMF;
\- LMF supports SUPL positioning process;
\- To enable the interaction with 5GC NFs such as LMF via user plane
connection, UE needs to select UCF and establish the connection with the UCF
after registering the network.
Editor\'s note: It is FFS if modifications to SUPL specifications are needed.
### 6.16.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.17 Solution 17: Solution for Flexible and Efficient Periodic and
Triggered Location
### 6.17.1 Introduction
This solution is intended to address Key Issue 13 on Support of Flexible and
Efficient Periodic and Triggered Location.
### 6.17.2 Functional Description
For a 5GC location solution in which periodic and triggered location is
supported and where trigger detection and instigation of event reporting is
performed by a target UE, an LCS client provides an indication of the required
trigger events to the 5GC (e.g. to a GMLC in the 5GC) using a transparent
container along with the request for periodic and triggered location. The
transparent container is subsequently transferred without alteration or
interpretation through the 5GC to the UE according to how the particular 5GC
location solution sends a request for periodic and triggered location to a
target UE. The content of the transparent container indicates the required
triggering event(s) and may include associated parameters (e.g. such a
velocity or distance for triggers associated with UE velocity or UE location).
The content of the transparent container is only meaningful to the LCS Client
and UE and may be standardized by 3GPP, completely proprietary or partially
standardized and partially proprietary (hybrid definition). As an example of a
hybrid definition, 3GPP might define a high level structure for a transparent
container that includes an ID or Type field having one set of standardized
values and another set of proprietary values with the remainder of the
container defined by 3GPP only for the set of standardized values.
A second transparent container is used to allow a UE to report a type of
detected trigger event back to an LCS Client when more than one type of
trigger event is used. The second container could be included in a report of a
trigger event sent from a UE to the 5GC (e.g. in an MO-LR request) and would
be transferred without interpretation or alteration back to the LCS Client.
The content of the second transparent container may also be standardized by
3GPP, completely proprietary or partially standardized and partially
proprietary.
When transparent containers are used, certain common parameters may be
provided explicitly to the 5GC by an LCS Client to enable common support from
the 5GC for all types of periodic and triggered location procedures. The
common parameters may also assist the 5GC (e.g. a GMLC) to estimate resource
usage in advance for a periodic and triggered location request received from
an LCS Client and to decide whether to accept or reject the request. The
common parameters could include:
\- Conditions for terminating a periodic and triggered location session (e.g.
a maximum duration and/or a maximum number of event reports).
\- Whether a location estimate is required for each event report.
\- A maximum interval and/or a minimum interval between consecutive event
reports.
\- A maximum and/or a minimum event sampling interval for a target UE.
### 6.17.3 Procedures
#### 6.17.3.1 Generic Procedure
Figure 6.17.3.1-1 shows a common generic procedure for support of a Periodic
and Triggered 5GC-MT-LR Procedure using transparent containers. The procedure
can be applicable to any type of Periodic and Triggered 5GC-MT-LR procedure
such as the procedures described in clauses 6.2.3.3., 6.2.3.4 and 6.2.3.5 for
the LMF based location solution. The messages shown in Figure 6.17.3.1-1 will
depend on the particular type of Periodic and Triggered 5GC-MT-LR procedure
and may be different, but the usage of the transparent containers may remain
unchanged.
Figure 6.17.3.1-1: Periodic and Triggered 5GC-MT-LR Procedure using
Transparent Containers
1\. An external LCS client sends a location request for periodic and triggered
location for a target UE to a VPLMN or HPLMN for the UE (e.g. a GMLC). The
location request provides the type of location reporting being requested and
associated parameters. The location request includes a transparent container
TC1 that includes details of the trigger events to be reported. The
transparent container TC1 may be encoded according to a standard (e.g. 3GPP)
definition and/or a proprietary definition particular to the LCS Client. The
location request may also include common parameters applicable to all type of
trigger events such as a maximum duration of event reporting, a maximum number
of event reports, whether a location estimate is required for each event
report, a maximum interval and/or a minimum interval between consecutive event
reports, and a maximum and/or a minimum event sampling interval for the target
UE.
2\. The HPLMN and/or VPLMN determine whether to accept or reject the location
request - e.g. based on the common parameters and subscription information for
the LCS Client and the target UE. For a roaming UE, where the request in step
1 is sent to the HPLMN, the HPLMN transfers the request to the VPLMN. If the
request is accepted, the VPLMN or HPLMN returns a confirmation to the LCS
Client.
3\. If the UE is not currently reachable, the HPLMN/VPLMN waits for the UE to
become reachable.
4-5. Once the UE is reachable, the HPLMN/VPLMN may verify UE privacy
requirements, e.g. via a supplementary services interaction.
6\. The HPLMN/VPLMN sends a request to the UE to perform periodic and
triggered location. The request carries the location request information
provided by the LCS Client in step 1, including the transparent container TC1
and any common parameters, and may include the identity of the LCS Client.
7\. The UE interprets the transparent container TC1 using either a
standardized 3GPP definition or a proprietary definition particular to the LCS
Client. A proprietary definition may be identified from the LCS Client
identity, if received in step 6, or from some standardized ID included in the
container TC1 if the container is at least partially standardized. If the
request can be supported, the UE returns an acknowledgment to the HPLMN/VPLMN.
8\. Depending on the particular Periodic and Triggered 5GC-MT-LR procedure,
the VPLMN and/or the HPLMN may return a response to the LCS Client to confirm
that event reporting for periodic and triggered location was activated in the
UE.
9\. The UE monitors for occurrence of the trigger event(s) defined by the
transparent container TC1. When a trigger event is detected, the UE proceeds
to step 10.
10\. The UE sends a report to the HPLMN/VPLMN for the detected trigger event
and may include a location estimate if available to the UE and if requested in
step 6. The report may include a second transparent container TC2 indicating
the type of detected trigger event, e.g. when more than one type of trigger
event was requested by the LCS Client.
11\. If a location estimate was not included in step 10 and if reporting of
location estimates was requested by the LCS Client, the HPLMN/VPLMN performs
positioning of the UE and obtains a location estimate.
12\. The HPLMN/VPLMN send an acknowledgment to the UE to confirm that an event
report will be sent to the LCS client.
13\. The HPLMN/VPLMN sends an event report to the LCS Client and includes any
transparent container TC2 received at step 10 and any location estimate
received at step 10 or obtained at step 11.
14\. The UE continues to monitor for further trigger events and instigates
steps 10-13 each time a trigger event is detected.
### 6.17.4 Impacts on existing entities and interfaces
Impacts to existing entities and interfaces in the 5GS are as follows.
VPLMN / HPLMN (e.g. GMLC, LMF, AMF):
\- transfer a transparent container from an LCS Client to a target UE as part
of a periodic and triggered 5GC-MT-LR request.
\- transfer a transparent container from a target UE to an LCS Client as part
of reporting the occurrence of a trigger event.
UE:
\- Interpret a transparent container sent by an LCS Client as part of a
periodic and triggered 5GC-MT-LR request.
\- Detect and report the trigger events defined by the transparent container.
\- Include a transparent container indicating a detected trigger event in a
report of the trigger event when more than one type of trigger event was
instigated for a periodic and triggered location session.
LCS Client:
\- Support of receiving and processing a transparent container sent by an UE
as part of the LCS service response.
\- Support of generating and signal a transparent container to a target UE as
part of a LCS service request.
### 6.17.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.18 Solution #18: UDM based Positioning Access selection for LCS service
### 6.18.1 Introduction
This solution addresses the Key Issue 14: Positioning Access selection for LCS
service.
### 6.18.2 Functional Description
When UE accesses 5GC via 3GPP access and non-3GPP access simultaneously, the
UDM is responsible to manage separate/independent UE Registration procedures
for each access. For example, when UE initiates Registration procedure over
3GPP access, the AMF registers with the UDM by providing, e.g. AMF ID and
Access Type. The UDM stores the AMF ID associated to the Access Type and does
not remove the AMF ID associated to the other Access Type.
When UDM receives request from GMLC, it is proposed that UDM decides access
type to perform the positioning procedure based on, e.g. access type and
associated serving AMF which is provided by AMF during Registration procedure
and the UE state change in the access type (e.g. connectivity state changes)
which is obtained by subscribing UE access and mobility information event to
AMF. The UDM provides Access Type to the GMLC.
### 6.18.3 Procedures
Figure 6.18.3-1: Access Type selection for LCS service
1\. An external LCS client sends a location request to an HGMLC in the HPLMN
for the target UE. The HGMLC verifies the authorization of the LCS Client to
locate the target UE and UE privacy requirements.
2\. The HGMLC invokes the Nudm_UE ContextManagement_Get service operation
towards the home UDM of the target UE with the GPSI or SUPI of the UE.
3\. The UDM returns the serving AMF address and possibly a VGMLC address
and/or an LMF address in the VPLMN. The UDM also selects and returns Access
Type to transmit the location information based on, e.g. Access Type,
associated serving AMF and the UE state change (e.g. connectivity state
changes) in the access. If the serving AMF for different Access Type is
different, the UDM only returns the AMF address related to the selected Access
Type and will not return the Access Type.
4\. The HGMLC forwards the location request to the VGMLC and includes the AMF
address, the target UE identity (e.g. SUPI), any LMF address received in step
3 and Access Type.
5a. [Conditional] If solution in clause 6.2 (i.e. LMF Based Location Solution)
is performed, the VGMLC invokes the Nlmf_ProvideLocation Request service
operation to forward the location request and Access Type to the LMF.
6a. [Conditional] If step 5a is performed, the LMF invokes the
Namf_Communication_N1N2Message Transfer service operation to send the
Positioning Message and Access Type to the AMF.
5b. [Conditional] If solution in clause 6.14 (i.e. Reuse R15 existing location
service architecture for commercial use cases) is performed, the VGMLC invokes
the Namf_Location_ProvideLocation_Request service operation to forward the
Access Type to the AMF.
7\. [Conditional] If the Access Type is 3GPP access, the step is performed.
The step can be the steps 2-6 in clause 4.13.5.4 in TS 23.502 [5], steps 2-5
in clause 4.13.5.5 in TS 23.502 [5], steps 2-4 in clause 4.13.5.6 in TS 23.502
[5] or other new positioning procedures defined for 3GPP access.
8\. [Conditional] If the Access Type is N3GPP access, the step is performed.
The step can be the steps 5-9 in clause 6.12.3.1 or other new positioning
procedures defined for N3GPP access.
9a. [Conditional] If step 6a is performed, the AMF invokes the
Namf_Communication_N1N2Message Transfer service operation to forward the
Positioning Message to the LMF.
10a. [Conditional] If step 9a is performed, the LMF invokes the
Nlmf_ProvideLocation Response service operation to forward the location
information to the VGMLC.
9b. [Conditional] If step 5b is performed, the VGMLC invokes the
Namf_Location_ProvideLocation_Response service operation to forward the
location information to the VGMLC.
11-12. VGMLC returns the location estimate to the LCS client via HGMLC.
### 6.18.4 Impacts on existing entities and interfaces
Impacts are as follows:
\- UDM: decide the Access Type to transmit the location information (e.g.
positioning message) and provide the Access Type to the GMLC.
\- GMLC: send the Access Type received from UDM to AMF or LMF.
\- LMF: send the Access Type received from GMLC to the AMF.
\- AMF: triggers the procedure to obtain UE location in the specific access
based on the Access Type received from GMLC or LMF.
### 6.18.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.19 Solution #19: Distribution of Positioning Assistance Information
### 6.19.1 Introduction
This solution addresses the Key Issue 16.
### 6.19.2 Functional Description
The solution focuses on procedures for distributing positioning assistance
data in the 5GS LCS system for Rel‑15 architecture options involving the 5GC
(Options 2, 4, 5 and 7 in TR 38.801 [16]). The 5GS LCS procedures outlined in
TS 23.502 [5] are considered as the base. Furthermore, procedures for
broadcasting encrypted assistance data are detailed.
Maintenance, collection and distribution of positioning assistance data was
done by E-SMLC in EPC. For 5GS LCS, this TR proposes LMF-centric allocation of
LCS functions (Option B of Solution 1) and an LMF-based location solution
(Solution 2). Hence, following the LMF-centric solution, the storing and
updating of positioning assistance data is done by the LMF.
The generic LCS Logical Architecture in clause 6.2 describes LCS Functional
entities and their allocation to network elements. Within this framework a new
LCS Functional entity, namely Positioning Assistance Data Source Function
(PADSF) is introduced that is responsible for maintaining, updating and
distributing up-to-date positioning assistance data within the 5GS LCS system.
The PADSF is agnostic to the type of Access Network (AN) and hence may store,
update and distribute assistance data for multiple ANs. The PADSF is
implemented at the LMF and at the respective AN node NG-RAN as shown in Fig.
1. The justification for this split is as follows: Positioning assistance
data, in general, can be RAT-dependent (ex. OTDoA assistance data) or RAT-
independent (ex. GNSS assistance data). Further, it can be static or dynamic
in nature, depending on whether it changes over time, over a target area or
for specific UEs, etc. RAT-independent and RAT-dependent static assistance
data will originate at the LMF, whereas RAT-dependent dynamic assistance data
will originate in the respective RAT node. Hence the PADSF is distributed
between the 5GC and AN.
In terms of distributing the assistance data, existing LCS functions fulfil
the role of maintaining and updating the positioning assistance data and there
is no need to define a new function for this purpose:
\- Positioning Radio Control Function (PRCF).
\- Positioning Radio Resource Management (PRRM).
\- Location System Broadcast Function (LSBcF).
Figure 6.19.2-1: Generic LCS Logical Architecture for 5GC (LMF-centric
allocation)
### 6.19.3 Procedures
Editor\'s note: This clause describes high-level procedures and information
flows for the solution.
#### 6.19.3.1 UE Assisted and UE Based Positioning and Assistance Delivery
Procedure
The following procedure depicts a positioning service transaction that is used
by the LMF to support UE based positioning, UE assisted positioning and
delivery of assistance data for SA option 2. A single location request from
the AMF may invoke one or more transactions, in which each transaction may
perform a single positioning service (e.g. UE assisted positioning, UE
capability retrieval). RAN positioning procedures related to LMF and UE
communication should be specified as part of NR Positioning Protocol (NRPP).
Figure 6.19.3-1: UE Assisted and UE Based Positioning and Assistance Delivery
Procedure
1\. The LMF invokes the Namf_Communication _N1N2MessageTransfer service
operation towards the AMF to request the transfer of a Downlink (DL)
Positioning message to the UE. The service operation includes the DL
Positioning message. The Session ID parameter of the
Namf_Communication_N1N2MessageTransfer service operation is set to the LCS
Correlation identifier. The Downlink Positioning message provide assistance
data to the UE.
2\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure as defined in TS 23.502 [5] to establish a
signalling connection with the UE.
3\. The AMF forwards the Downlink Positioning message to the NG-RAN in a DL
NAS TRANSPORT message. The AMF includes a Routing identifier, in the DL NAS
TRANSPORT message, identifying the LMF.
4\. The NG-RAN forwards the downlink positioning information and Routing
identifier to the UE by DL NAS TRANSPORT message.
5\. The UE stores any assistance data provided in the Downlink Positioning
message and performs any positioning measurements and location computation
requested by the Downlink Positioning message.
6\. the UE has entered CM-IDLE state during step 4, the UE instigates the UE
triggered Service Request as defined in TS 23.502 [5] in order to establish a
signalling connection with the AMF.
7\. The UE returns any location information obtained in step 5 to the NG-RAN
in an Uplink Positioning message included in a NAS TRANSPORT message. The UE
shall also include the Routing identifier in the UL NAS TRANSPORT message
received in step 3.
8\. The NG-RAN forwards the Uplink Positioning Information and Routing
identifier to the AMF in a NAS TRANSPORT message.
9\. The AMF invokes the Namf_Communication_N1MessageNotify service operation
towards the LMF indicated by the routing identifier received in step 7. The
service operation includes the Uplink Positioning message received in step 7
and the LCS Correlation identifier. Steps 1 to 9 may be repeated to send new
assistance data.
#### 6.19.3.2 Obtaining Non-UE Associated Network Assistance Data
The following procedure is used by the LMF to support network assisted and
network based positioning. This procedure is not associated with a UE location
session. It is used to obtain network assistance data from a NG-RAN node (e.g.
NG-RAN or ng-eNB). The procedure may be based on NRPPa protocol in TS 38.455
[11] between the LMF and NG-RAN.
Figure 6.19.3-2: Obtaining Network Assisted Data
1\. The LMF invokes the Namf_Communication_N1N2MessageTransfer service
operation towards the AMF to request the transfer of a Network Positioning
message to a NG-RAN in the NG-RAN. The service operation includes the Network
Positioning message and the target NG-RAN node identity. The Network
Positioning message may request positioning assistance information from the
NG-RAN.
2\. The AMF forwards the Network Positioning message to the target NG-RAN
indicated in step 1 in an N2 Transport message. The AMF includes a Routing
identifier, in the N2 Transport message, identifying the LMF.
3\. The target NG-RAN obtains any positioning assistance information requested
in step 2.
4\. The target NG-RAN returns any positioning assistance information obtained
in step 3 to the AMF in a Network Positioning message included in an N2
Transport message. The target NG-RAN shall also include the Routing identifier
in the N2 Transport message received in step 2.
5\. The AMF invokes the Namf_Communication_N2InfoNotify service operation
towards the LMF indicated by the routing identifier received in step 4. The
service operation includes the Network Positioning message received in step 4
and the UE identifier. Steps 1 to 5 may be repeated to request further
positioning assistance information from the NG-RAN.
#### 6.19.3.3 Broadcasting assistance data for UE assisted or UE based
positioning
The following procedure (Fig. 4) allows the LMF to broadcast positioning
assistance data for UE assisted or UE based positioning. NRPPa will be used
between the LMF and NG-RAN node. The NG-RAN node then broadcasts the
positioning assistance data using a positioning SIB which needs updated RRC
definitions for NR-specific assistance data (RAN scope).
Figure 6.19.3-3: Procedure for broadcasting positioning assistance data
1\. The LMF invokes the Namf_Communication_N1N2MessageTransfer service
operation towards the AMF to request the transfer of a Network Positioning
message to a NG-RAN in the NG-RAN. The service operation includes the Network
Positioning message and the target NG-RAN node identity. The Network
Positioning message contains positioning assistance information for the UEs.
2\. The AMF forwards the Network Positioning message to the target NG-RAN
indicated in step 1 in an N2 Transport message.
3\. The target NG-RAN broadcasts the positioning assistance information
received in the Network Positioning message in step 2.
### 6.19.4 Impacts on existing entities and interfaces
Editor\'s note: This clause describes impacts to existing entities and
interfaces.
### 6.19.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.20 Solution 20: LMF selection in GMLC
### 6.20.1 Introduction
This solution applies to Key Issue 1 \"Enhancement to LCS Architecture\", Key
Issue 3 \"Support of low latency LCS\" and Key Issue 5 \"Slicing dependent
location service\".
### 6.20.2 Functional Description
Solution implies that the GMLC selects the LMF based on parameters such as
positioning QoS, Client type, Serving cell id and S-NSSAI.
### 6.20.3 Procedures
#### 6.20.3.1 Procedure for LMF selection in GMLC with MO-LR and NI-LR
Figure 6.20.3.1-1 shows a 5GC-MO-LR or 5GC-NI-LR procedure for GMLC based LMF
selection solution where AMF request LMF selection from GMLC.
Figure 6.20.3.1-1: Procedure for LMF selection in GMLC with MO-LR and NI-LR
1a. Either the UE with a LCS client requests some location service (e.g.
positioning or delivery of assistance data) to the serving AMF at the NAS
level. The LCS client may also request a specific LCS QoS;
1b. or the AMF initiate an NI-LR procedure.
2\. To select an optimal LMF the AMF may select a V-GMLC based on NRF query or
configuration in AMF and invoke the Ngmlc_LmfSelection services operation
towards the V-GMLC. The AMF includes the type of location service, QoS, UE
identity, serving cell identity and S-NSSAI if available.
3\. The V-GMLC, based on provided parameters, selects an LMF and provides LMF
address to AMF in response.
4\. The AMF continues positioning procedure using the selected LMF. If steps 2
and 3 did not occur or no LMF addresses was provided by the V-GMLC or the AMF
is unable to use provided LMF addresses, the AMF selects an LMF based on NRF
query or configuration in AMF. For a roaming scenario the procedure may
include interaction between V-GMLC and H-GMLC.
#### 6.20.3.2 Procedure for LMF selection in GMLC with 5GC-MT-LR
Figure 6.20.3.2-1 shows a 5GC-MT-LR procedure for GMLC based LMF selection
solution where GMLC selects LMF and informs AMF of selection.
Figure 6.20.3.2-1: 5GC-MT-LR with LMF selection in GMLC
1\. The external location services client sends a request to the GMLC for a
location for the target UE identified by an GPSI or an SUPI. The request may
include the required QoS, Supported GAD shapes and client type.
2\. The GMLC invokes a Nudm_UE ContextManagement_Get service operation towards
the home UDM of the target UE to be located with the GPSI or SUPI of this UE.
3\. The UDM returns the network addresses of the current serving AMF, UE
subscription profile for LCS and may return the privacy setting for the
subsequent LCS requests of the UE.
4\. The H-GMLC invokes the Ngmlc_ProvideLocation service towards the V-GMLC.
5\. This step and steps 6 to 9 are only performed if the V-GMLC needs to know
the serving cell for the UE prior to selecting LMF. The LMF invokes the
Namf_MT_EnableUEReachability Request service operation towards the serving AMF
to verify UE reachability.
6\. If the UE is currently idle but reachable, the AMF performs a network
triggered service request in order to place the UE in connected state.
7\. The AMF returns the result of the UE reachability operation.
8\. The V-GMLC invokes the Namf_EventExposure_Subscribe service operation
towards the AMF to obtain UE location information and includes the immediate
one time notification flag.
9\. The serving AMF returns UE location information to the LMF (e.g. serving
cell ID).
10\. The V-GMLC may define a list, in order of priority, of one or more
selected LMFs to be used by the AMF. The list is based on e.g. the requested
QoS, the type of External Client and information from NRF service. The list
may also for each selected LMF include a condition on a certain S-NSSAI being
used by the UE for the LMF to be applicable to be used.
11\. The V-GMLC invokes the Namf_Location_ProvideLocation service operation
towards the AMF to request the current location of the UE. The service
operation includes the SUPI, and client type and may include the required QoS
and Supported GAD shapes and the prioritized list of selected LMF addresses
each with an optional S-NSSAI condition defined in step 4.
12\. If the UE is in CM IDLE state, the AMF initiates a network triggered
Service Request procedure to establish a signalling connection with the UE.
13\. If the indicator of privacy check related action indicates that the UE
must either be notified or notified with privacy verification, a notification
procedure is performed.
14\. The AMF selects the LMF with highest priority and fulfilling S-NSSAI
criteria from the list provided in step 4. If no LMF addresses was provided by
the GMLC or the AMF is unable to use any provided LMF address, the AMF selects
an LMF based on NRF query or configuration in AMF.
15\. The AMF invokes the Nlmf_Location_DetermineLocation service operation
towards the LMF to request the current location of the UE. The service
operation includes a LCS Correlation identifier, the serving cell identity and
the client type and may include the required QoS and Supported GAD shapes.
16\. The LMF performs one or more of the positioning procedures.
17\. The LMF returns the Nlmf_Location_DetermineLocation Response towards the
AMF to return the current location of the UE. The service operation includes
the LCS Correlation identifier, the location estimate, its age and accuracy
and may include information about the positioning method.
18\. The AMF returns the Namf_Location_ProvideLocation Response towards the
V-GMLC to return the current location of the UE. The service operation
includes the location estimate, its age and accuracy and may include
information about the positioning method.
19\. The V-MLC returns location estimate or error indication to the H-GMLC.
20\. The H-GMLC sends the location service response to the external location
services client.
### 6.20.4 Impacts on existing entities and interfaces
GMLC:
\- Need to select LMF based e.g. on requested QoS, UE identity, Client type,
serving cell id and S-NSSAI.
AMF:
\- Need to request LMF selection from GMLC for MO-LR and NI-LR requests.
\- Need handle LMF selection based on S-NSSAI for MT-LR requests.
Ngmlc:
\- Need to support a new service \"Ngmlc_LmfSelection\".
### 6.20.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.21 Solution 21: Solution for Low Power Periodic and Triggered Location
### 6.21.1 Introduction
This solution is based on solution 2, and thus share the same architecture and
base procedures as documented in clause 6.2.
The only difference with solution 2 is the enhancement of Low Power Periodic
and Triggered 5GC-MT-LR Procedure by using the EDT and RAI mechanism as in
solution 1 of TR 23.724 [20]. Other procedures of solution 2 as in clause 6.2
are reused.
Editor\'s note: This solution has dependency on the conclusion of TR 23.724
[20] and RAN developments for EDT support.
### 6.21.2 Functional Description
This solution has the same architecture and reference points definition as
that of solution 2, i.e. clauses 6.2.2.1 and 6.2.2.2.
### 6.21.3 Procedures
#### 6.21.3.1 General
All the procedures in solution 2, except the Low Power Periodic and Triggered
5GC-MT-LR Procedure in clause 6.2.3.5, apply to this solution. The enhanced
Low Power Periodic and Triggered 5GC-MT-LR Procedure is described below.
#### 6.21.3.2 Low Power Periodic and Triggered 5GC-MT-LR Procedure
Figure 6.21.3.2-1 summarizes a low power variant of the optimized 5GC-MT-LR
procedure in clause 6.2.3.4 for a roaming UE to support periodic and triggered
location. A corresponding procedure for a non-roaming UE would comprise a
subset of the procedure shown in Figure 6.2.3.5-1. This procedure has the same
characteristics as the procedure in Figure 6.2.3.4-1, but in addition:
\- The UE is enabled to report the occurrence of trigger events and provide
associated location information using EDT and RAI as proposed for Solution 1
in TR 23.724 [20].
\- The UE is enabled to request immediate release of the signalling connection
by the RAN following the sending of an event report using EDT as proposed for
Solution 1 in TR 23.724 [20], which can minimize the duration of the
signalling connection.
\- The UE is enabled to indicate an expectation of receiving a single response
from the LMF after which the signalling connection is released by the AMF,
which can reduce the duration of the signalling connection.
\- The option of employing trigger detection in the LMF is not used.
Figure 6.21.3.2-1: Low Power Periodic and Triggered 5GC-MT-LR for a roaming UE
1-18. Steps 1 to 18 of Figure 6.2.3.3-1 are performed.
19\. Step 20 of Figure 6.2.3.4-1 is performed. In addition, the LMF includes
in the request for periodic or triggered location reporting an indication that
the UE is permitted to send event reports using EDT. The LMF may also include
criteria indicating when EDT may be used by the UE and which values of RAI the
UE is permitted to include for EDT (e.g. RAI for immediate release and/or RAI
for early release).
NOTE 1: The LMF may determine UE support for EDT for event reporting,
including values of RAI supported by the UE, by obtaining the positioning
(e.g. LPP) capabilities of the UE prior to step 19.
NOTE 2: Use of the permitted values of RAI may also be negotiated at the NAS
level during registration of a UE as proposed for Solution 1 in TR 23.724
[20]. A UE may then only use EDT and particular RAI values if both agreed
during registration and allowed by the LMF.
20\. If the request in step 19 can be supported, the UE returns an
acknowledgment to the LMF in a positioning protocol (e.g. LPP) message, which
is transferred via the serving AMF and delivered to the LMF using an
Namf_Communication_N1MessageNotify service operation.
21-24. Steps 21-24 of Figure 6.2.3.3-1 are performed to confirm that event
reporting for periodic or triggered location was activated in the UE and to
return any location estimate for the UE available event obtained at step 18 if
the UE available event was requested at step 5 or step 6.
25\. The UE monitors for occurrence of the trigger event requested in step 19.
The monitoring may occur while the UE is in idle state and/or while the UE is
not reachable from the network (e.g. with eDRX or PSM). The UE may also (e.g.
periodically) request assistance data from the LMF to help determine a
location, if needed to detect a trigger event. When a trigger event is
detected, the UE proceeds to step 26.
26\. The UE determines (e.g. based on any criteria received in step 19)
whether to report the trigger event using a NAS signalling connection or EDT.
If the UE is already in connected state or can only access a RAN node which
does not support EDT, the UE determines to use a NAS signalling connection.
27\. If the UE determines to use a NAS signalling connection at step 26, the
UE performs steps 29-31 of Figure 6.2.3.4-1. The UE then skips steps 28-37.
28\. If the UE determines to use EDT at step 26, the UE obtains any location
measurements or location estimate requested in step 19, determines a suitable
serving cell if accessing NG-RAN and requests and obtains an RRC signalling
connection with a RAN node.
29\. The UE sends an RRC EDT Request message to the RAN node. The RRC EDT
Request message includes the 5G-GUTI and a NAS Transport message containing an
UL positioning protocol (e.g. LPP) message which includes any location
measurements or location estimate obtained in step 28 and may identify the
type of event being reported. The NAS Transport message also includes the
routing identifier received by the UE at step 19. The NAS Transport message is
ciphered and integrity protected as defined in TS 24.501 [21]. The RRC EDT
Request further includes an RAI as proposed for Solution 1 in TR 23.724 [20].
The RAI may indicate either immediate release or early release of the RRC
signalling connection. For early release, the RAI may also indicate whether
the UE expects to receive one DL positioning protocol message from the LMF in
response.
30\. If the RAI received in step 29 indicates immediate release, the RAN node
sends an RRC EDT Complete message to the UE to immediately release the RRC
signaling connection.
Editor\'s note: Details of EDT support for NG-RAN (e.g. including new RRC
messages) are still to be decided by RAN. The description here is based on
current EDT support for Control Plane CIoT EPS optimization in TS 36.300 [22]
and TS 23.401 [23] and proposed use of EDT and RAI for small data transfer for
Solution 1 in clause 6.1 of TR 23.724 [20].
31\. The RAN node sends an N2 Initial UE message to the serving AMF for the UE
(identified by the 5G-GUTI). The Initial UE message includes the NAS Transport
message received at step 29 and the RAI.
32\. The AMF performs integrity protection verification and deciphering of the
NAS Transport message as defined in TS 24.501 [21]. The AMF invokes the
Namf_Communication_N2InfoNotify service operation towards the LMF indicated by
the routing identifier received in the NAS Transport message in step 31. The
service operation includes the UL positioning protocol message and the RAI
received at step 31. If the RAI received at step 31 indicates either immediate
release or early release where no LMF response is expected by the UE, the AMF
omits support for steps 34-35, since the AMF does not expect to receive a
response at step 34.
33\. If inclusion of a location estimate in event reports was requested at
step 5 or step 6, the LMF uses any location measurements or location estimate
included in the UL positioning protocol message received at step 32 to
determine a location estimate for the UE.
34\. If the RAI received at step 31 indicates early release where the UE
expects to receive a response from the LMF, the LMF invokes the
Namf_Communication _N1N2MessageTransfer service operation towards the AMF to
request the transfer of a DL positioning protocol message (e.g. an LPP
message) to the UE. The service operation includes the DL positioning protocol
message.
NOTE 3: The DL positioning protocol message may be an acknowledgment of the UL
positioning protocol message.
35\. If the AMF receives a DL positioning protocol message for the UE from the
LMF at step 34, the AMF forwards the DL positioning protocol message to the
RAN in a NAS Transport message.
36\. Unless the AMF receives an RAI indicating immediate release at step 31,
the AMF sends a UE Context Release Command to the RAN to release the RRC
signalling connection to the UE. Step 36 is performed after step 35 when an
RAI is received at step 31 indicating that a response is expected by the UE
from the LMF. Step 36 is instead performed either after a timeout if step 35
does not occur or after step 32 when an RAI is received by the AMF indicating
no response is expected by the UE from the LMF.
NOTE 4: The AMF may also send any pending MT small data or pending MT SMS
messages to the UE following step 31 and prior to step 36 as described for
some of the small data solutions in TR 23.724 [20].
37\. Unless the RAN previously performed step 30 for immediate release of the
UE, the RAN sends an RRC EDT Complete message to the UE to release the RRC
signalling connection to the UE and includes any NAS Transport message
received at step 35 if step 35 occurs.
38-41. Steps 30-33 of Figure 6.2.3.3-1 are performed to return an indication
of the trigger event to the external client and a location estimate if this
was requested.
42\. The UE continues to monitor for and detect further trigger events as in
step 25 and instigates steps 26-41 each time a trigger event is detected.
### 6.21.4 Impacts on existing entities and interfaces
The solution adds the following new impacts in addition to those described in
clause 6.2.4 when used to enhance Solution 2 in clause 6.2.
#### 6.21.4.1 Impacts to LMF and Nlmf SBI
Table 6.21.4.1-1: LMF Impacts
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Provide criteria to | None | | | a UE defining when | | | 5GC-MT-LR | event reporting | | | | using EDT may be | | | (low power) | used | | +----------------------+----------------------+----------------------+ | | Receive an UL | None | | | positioning message | | | | for an event report | | | | from a UE sent using | | | | EDT, and send a | | | | single response when | | | | the UE indicates a | | | | response is | | | | expected. | | +----------------------+----------------------+----------------------+
#### 6.21.4.2 Impacts to UE
Table 6.21.4.2-1: UE Impacts
+----------------------+----------------------+----------------------+ | Procedure | Description | Corresponding or | | | | Similar Rel-15 | | | | Impact (if any) | +----------------------+----------------------+----------------------+ | Periodic / Triggered | Receive criteria | None | | | from an LMF for use | | | 5GC-MT-LR | of EDT for event | | | | reporting for | | | (low power) | periodic or | | | | triggered location. | | +----------------------+----------------------+----------------------+ | | Depending on the | None | | | received criteria, | | | | send event reports | | | | using EDT and | | | | include an RAI | | | | indicating immediate | | | | release or early | | | | release. | | +----------------------+----------------------+----------------------+
#### 6.21.4.3 Impacts to AMF and Namf SBI
The solution relies on service based operations to be defined later for
support of EDT by an AMF.
#### 6.21.4.4 Impacts to the NG-RAN
An NG-RAN node needs to support EDT. The support of EDT can be common to
support of EDT for CIoT small data transfer as proposed in clause 6.1 of TR
23.724 [20] and is not specific to location services.
## 6.22 Solution 22: LCS continuity Support for N26 based Handover
### 6.22.1 Introduction
This solution addresses one scenario of Key Issue 15: Location continuity
support, that is:
\- Mobility between EPS and 5GC, when UE uses 3GPP access and/or non-3GPP
access.
This solution address for inter-system mobility cases, and it can work
together with other intra-system mobility solutions.
### 6.22.2 Functional Description
The interworking between 5GS and EPS with N26 interface is specified in clause
5.17.2.2 of TS 23.501 [4], and the handover procedure via is specified in
clause 4.11.1.2 of TS 23.502 [5]. During that handover procedure, location
request from LCS Client may arrive at 5GC or EPS core network entities, e.g.
AMF or MME. Or after core network entities received Location Request from GMLC
and before actual positioning procedure finish, the handover required message
maybe received from RAN.
Since those handover procedure is on-going, continue performing positioning
procedure within the source RAN may have problems, e.g. such positioning
procedure may not able be finished due to UE moved to target side; the
positioning result from the source side may not be accurate due to UE
mobility. In such handover and location service simultaneously on-going
scenarios, forwarding arrived location request to target side and trigger
actual positioning procedure at target side has benefits over simply reject
the location request. The benefits including that network can provide UE
location timely and accurately.
### 6.22.3 Procedures
### 6.22.3.1 LCS support during Handover from 5GS to EPS
Within below figure 6.22.3.1-1, the MT-LR location request arrives at AMF
(e.g. Step 4 of clause 4.13.5.3 of TS 23.502 [5], Namf_Location_Provide
Request from V-GMLC), and this would trigger the positioning procedure. When
such MT-LR procedure is still on-going, the NG-RAN may decides that a Handover
is required.
Figure 6.22.3.1-1: LCS support during handover from 5GS to EPS
Step A-1: During the 5GC-MT-LR procedure, e.g. in clause 4.13.5.3 of TS 23.502
[5], step 4, the AMF received Namf_Location_ProvideLocation request from
V-GMLC, which includes the SUPI, and client type and may include the required
QoS parameters. The LMF is then contacted to perform one or more of the
positioning procedures described in clause 4.13.5.4 and 4.13.5.5 of TS 23.502
[5].
Step A-2. Take the clause 4.13.5.4 of TS 23.502 [5] as an example, the step 1
of this procedure is triggered. The LMF invokes the
Namf_Communication_N1N2MessageTransfer service operation towards the AMF.
Step B: Before the complete of procedure triggered in StepA-2, or before Step
A-2 but after Step A-1, the NG-RAN may decide to initiate the Handover. The
AMF receives the Handover Required from NG-RAN as defined in clause 4.11.1.2.1
of TS 23.502 [5], step 1.
Step C-1: Replace the step 9 in 4.13.5.3 of TS 23.502 [5], the AMF returns the
Namf_Location_ProvideLocation Response towards the V-GMLC, to indicate that
there is a Handover.
Step C-2: The AMF invokes the Namf_Communication_N1MessageNotify service
operation towards the LMF, to indicate that there is a Handover, and the abort
of positioning procedure.
Step D: The AMF needs to indicate the MME to preform Location Procedure in EPS
and return the result, via N26 interface. The AMF may map the
Namf_Location_ProvideLocation request message received to the message Provide
Subscriber Location message, and send this message to MME by piggybacking in
the Relocation Required, which is step 3 of procedure in 4.11.1.2.1 of TS
23.502 [5]. The MME assumes such Provide Subscriber Location is come from a
GMLC, and triggers the Step F-1. At the same time, the handover procedure
continues, as defined in 4.11.1.2.1 of TS 23.502 [5].
Step E-1: The MME send Location request to E-SMLC, as defined in clause 9.1.15
of TS 23.271 [6].
Step F-1: The E-SMLC performs the step 7 of clause 9.1.15 of TS 23.271 [6].
Step G-1: The E-SMLC performs the step 8 of clause 9.1.15 of TS 23.271 [6]. In
this step, the MME receives the Location Response message from E-SMLC. That
means the positioning result is from the target side.
Step H: The positioning result is return to AMF via N26 interface. The context
request/response pair message could to re-use with some modification, or
defines new messages for this purpose.
Step J: Like the step 9 in 4.13.5.3 of TS 23.502 [5], the AMF returns the
Namf_Location_ProvideLocation Response towards the V-GMLC, to return the UE
location to V-GMLC.
### 6.22.3.2 LCS support during Handover from EPS to 5GS
Within below figure 6.22.3.2-1, the MT-LR location request (e.g. Provide
Subscriber Location Request sent by VGMLC in step 2 of clause 9.1.15 of TS
23.271 [6]) arrives at MME, and this would trigger the positioning procedure.
When such MT-LR procedure is still on-going, the NG-RAN decides that a
Handover is required.
Figure 6.22.3.2-1: LCS support during handover from EPS to 5GS
Step A: During the EPS-MT-LR procedure, e.g. procedure in 9.1.15 of TS 23.271
[6], step 2, GMLC sends a Provide Subscriber Location message to the MME. This
message carries the type of location information requested (e.g. current
location and optionally, velocity), the UE subscriber\'s IMSI, LCS QoS
information (e.g. accuracy, response time) and an indication of whether the
LCS client has the override capability. The procedure may continue and step 6
of 9.1.15 of TS 23.271 [6] happens.
Step B: Before the complete of procedure triggered in Step A, the E-UTRAN may
decide to initiate the Handover. The MME receives the Handover Required from
NG-RAN as defined in clause 4.11.1.2.2.2 of TS 23.502 [5], step 2.
Step C-1: In such case, since the Handover is going to happen, continuing
positioning at EPS side become useless, so the MME may send Location Abort to
E-SMLC.
Step C-2: The MME may also send Subscriber Location Report to V-GMLC, to
indicate that there is a Handover imminent.
Step D: The MME needs to indicate the AMF to preform Location Procedure in 5GS
and return the result, via N26 interface. The MME send the Provide Subscriber
Location message to AMF, by piggybacking it in the Forward Relocation Request
message, which is step 3 of procedure in 4.11.1.2.2.2 of TS 23.502 [5].
After receive this message, the AMF needs map the Provide Subscriber Location
message to Namf_Location_ProvideLocation request message, and the MME assumes
such Namf_Location_ProvideLocation is come from a V-GMLC, and triggers the
Step E. At the same time, the handover procedure continues, as defined in
4.11.1.2.2 of TS 23.502 [5].
Step E: As step 6 in clause 4.13.5.3 of TS 23.502 [5], the AMF selects an LMF
based on NRF query or configuration in AMF and invokes the
Nlmf_Location_DetermineLocation service operation towards the LMF to request
the current location of the UE.
Step F-1: As step 7 in clause 4.13.5.3 of TS 23.502 [5], the LMF performs one
or more of the positioning procedures described in clause 4.13.5.4, 4.13.5.5
of TS 23.502 [5]. This step F-1 shows that clause 4.13.5.4 as an example.
Step F-2: As step 8 in clause 4.13.5.3 of TS 23.502 [5], the LMF returns the
Nlmf_Location_DetermineLocation Response towards the AMF to return the current
location of the UE.
Step G: The positioning result is return to MME via N26 interface. The context
request/response pair message could to re-use with some modification, or
defines new messages for this purpose.
Step H: Like the step 9a in in 9.1.15 of TS 23.271 [6], the MME send a
Subscriber Location Report to the V-GMLC.
### 6.22.4 Impacts on existing entities and interfaces
Impacted entities:
\- AMF: forward LCS related message to MME, and receive such message from MME,
to trigger positioning procedure; to forward positioning result to MME;
mapping the Provide Subscriber Location message to and from the
Namf_Location_ProvideLocation request message.
\- MME: forward LCS related message to AMF, and receive such message from MME,
to trigger positioning procedure; to forward positioning result to AMF.
Impacted interfaces:
\- N26, forwarding LCS related messages between AMF and MME.
### 6.22.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.23 Solution #23: Unified NEF Location Service Exposure
### 6.23.1 Introduction
The Unified NEF Location Service Exposure solution addresses the following key
issue:
\- Key Issue 7: Location service exposure.
The solution enables the NEF to provide a unified exposure of different
location services offered by 5GS to a consumer NF or AF. These location
services include the GMLC (and LMF) based location solution and the AMF Event
Exposure service based location solution. This unified exposure will enable a
PLMN operator to offer location services to NFs and AFs using either one of
these solutions or both solutions without impacting the SBI or API used by an
NF or AF to access the NEF. In addition, by supporting a single unified SBI
and API at an NEF, an optimal choice of solutions can be supported by the NEF
(e.g. dependent on location accuracy and response time requirements) without
impacting an AF or NF.
GMLC based solution means any of the solutions described in this TR in which a
GMLC is used. The AMF based location solution is the solution that makes use
of AMF event exposure service as specified in TS 23.502 [5] and described in
clause 6.23.3.1, or the enhanced procedure described in clause 6.23.3.3.
### 6.23.2 Functional Description
The service based architectures for roaming and non-roaming UEs are shown
below.
Figure 6.23.2-1: Non-roaming reference architecture for unified NEF location
exposure
Figure 6.23.2-2: Roaming reference architecture for unified NEF location
exposure
### 6.23.3 Procedures
#### 6.23.3.1 Unified Location Service Exposure Procedure
Figure 6.23.3.1-1 shows a unified location service exposure procedure provided
by an NEF in an HPLMN for a target UE to a consumer NF in the HPLMN or to a
consumer AF outside the HPLMN. The target UE can be roaming or non-roaming.
The NEF service operations and APIs referenced in Figure 6.23.3.1-1 can be new
and could use different names to those shown below for Figure 6.23.3.1-1.
Mobility aspect is handled with existing procedures as defined in TS 23.501
[4] and TS 23.502 [5].
Figure 6.23.3.1-1: Unified Location Service Exposure Procedure for a roaming
or non-roaming UE
> 1a. An external AF sends an LCS Service Request to an NEF in the HPLMN for a
> target UE using an NEF API and includes an identification of the UE (e.g.
> SUPI or GPSI) and details of the location request such as whether a current
> or last know location is requested, the location accuracy and response time,
> and LDR request information.
>
> 1b. As an alternative to step 1a, a consumer NF in the HPLMN for a target UE
> invokes an Nnef_ProvideLocation Request service operation towards an NEF in
> the HPLMN and includes a global identification of the UE (e.g. SUPI or GPSI)
> and details of the location request as in step 1a.
>
> 2\. Based on the service requirements in step 1a or step 1b (e.g. location
> accuracy, location response time and whether triggered or periodic location
> is requested) and/or on HPLMN support for GMLC versus AMF based location
> service, the NEF determines whether to map the location request in step 1a
> or step 1b to a GMLC based location service or to an AMF based location
> service. When a GMLC based location service is determined, steps 3-6 are
> performed and steps 7-14 are omitted. When an AMF based location service is
> determined, steps 7-14 are performed and steps 3-6 are omitted. NEF takes
> the potential load to the system, e.g. AMF/UDM load, or GMLC load, into
> consideration when deciding which location service to use, or whether to
> reject the request from NF or AF.
>
> 3\. When a GMLC based location service is determined in step 2, the NEF
> invokes an Ngmlc_ProvideLocation Request service operation towards an HGMLC
> in the HPLMN. The service operation may include all of the information
> received from the AF or NF in step 1a or 1b.
>
> 4\. The HGMLC may first verify UE privacy requirements. If these are
> satisfied, the HGMLC then obtains one or more locations for the target UE as
> requested in step 3. The details of how this is done depend on the location
> solution used by the HGMLC which can employ any of the solutions described
> in this TR in which a GMLC is used.
>
> 5\. The HGMLC invokes an Ngmlc_ProvideLocation Response service operation
> towards the NEF to confirm the request in step 3 or to return the UE
> location. Which of these is used depends on the location request in step 3.
> For example, when a one-time current or last known location was requested in
> step 3, the HGMLC would return the current or last known location in step 5.
> When step 3 carries a deferred, periodic or triggered location request, step
> 5 may just return a confirmation of the request.
>
> 6\. Optionally, if a deferred, periodic or triggered location request was
> sent in step 3, the HGMLC may invoke one or more Ngmlc_LocationEvent Notify
> service operations towards the NEF, each carrying a notification of some
> event and possibly a UE location.
>
> 7\. When an AMF based location service is determined in step 2, if the NEF
> needs to verify the target UE privacy requirements (e.g. for a location
> request from a consumer AF in step 1a), the NEF invokes an
> Nudm_UEContextManagement_Get Request service operation towards the UDM for
> the target UE to request the UE privacy requirements and the serving AMF
> address. Example of the AMF based location solution is that of the AMF event
> exposure based operation as described below, or the enhanced procedure
> described in clause 6.23.3.3.
>
> 8\. When step 7 was performed, the UDM invokes the
> Nudm_UEContextManagement_Get Response service operation towards the NEF to
> return the serving AMF address and UE privacy requirements. The NEF then
> verifies UE privacy.
>
> NOTE: The AMF based location service does not support a real time query to
> the UE to verify UE privacy requirement by the user.
Editor\'s note: The assumption in the above note would need to be verified.
For example, UE privacy verification by an AMF could be added but would be an
extra impact.
> 9\. The NEF invokes an Namf_EventExposure Subscribe service operation
> towards the serving AMF for the target UE and indicates whether a one-time
> UE location is requested or multiple UE locations for some triggering event
> and includes information on location accuracy (e.g. cell ID or TA
> granularity or higher accuracy). The NEF sends the Namf_EventExposure
> Subscribe service operation directly to the serving AMF as shown in Figure
> 6.23.3.1-1 when the NEF knows the AMF address (e.g. if steps 7 and 8 are
> performed). Otherwise, the NEF sends the Namf_EventExposure Subscribe
> service operation to the serving AMF via a UDM as described below for Figure
> 6.23.3.2-1.
>
> 10\. The AMF acknowledges the request in step 9 either directly as shown in
> Figure 6.23.3.1-1 or via the UDM as shown in Figure 6.23.3.2-1.
>
> 11\. If the UE is currently reachable and in CM-IDLE state and if location
> is requested in step 9 with a cell ID accuracy or higher, the AMF perform a
> network triggered service request as described in TS 23.502 [5] to place the
> UE in CM-CONNECTED state.
>
> 12\. If the AMF already has the current UE serving cell ID (e.g. following
> step 11) and the request in step 9 is for a one-time UE location with cell
> ID (or lower) accuracy and the AMF is able to convert the current serving
> cell ID into a geodetic location estimate, the AMF obtains the location
> estimate and proceeds to step 13. Otherwise, the AMF may perform the NG-RAN
> location reporting procedure defined in clause 4.10 of TS 23.502 [5] to
> obtain the current or last known UE location from the NG-RAN with a
> granularity of a cell ID or tracking area. Alternatively (e.g. if higher
> location accuracy is requested in step 9), the AMF may perform the enhanced
> NG-RAN location reporting procedure described in Figure 6.23.3.3-1 to obtain
> a UE location with higher accuracy. For either procedure, the AMF may
> request additional location reports from the NG-RAN if requested in step 9
> for certain trigger events such as a change of cell ID or TA for a UE or
> entry into or out of an area of interest.
>
> 13\. The AMF invokes the Namf_EventExposure Notify service operation towards
> the NEF to provide the current or last known UE location as obtained at step
> 12. This service operation is valid for both direct access to the AMF by the
> NEF and indirect access via the UDM.
>
> 14\. Optionally, if additional triggered UE locations are requested in step
> 9, the AMF may invoke one or more Namf_EventExposure Notify service
> operation towards the NEF to provide additional UE locations when certain
> trigger events occur (e.g. such as a UE changing serving cell or a serving
> TA or entering or leaving an area of interest).
>
> 15a, 15b. The NEF returns the first UE location received at step 5 or step
> 13 or a confirmation of the location request received at step 5 in the case
> of a GMLC location service to the consumer AF (step 15a) or consumer NF
> (step 15b). If LCS service request is LDR type, LDR reference ID will be
> included in response message, and H(V)-LMF may store the LDR request
> information at H(V)-UDR.
>
> 16a, 16b. Optionally, if one or more additional location reports are
> received at step 6 or step 14, the NEF returns one or more additional
> locations to the consumer AF (step 16a) or consumer NF (step 16b).
#### 6.23.3.2 Alternative procedure for NEF to use AMF event exposure service
via the UDM
Figure 6.23.3.2-1 shows the procedure used by the NEF to access the serving
AMF for the UE when the NEF does not have the address of the serving AMF and
when AMF location reporting is selected by the NEF.
Figure 6.23.3.2-1: NEF Access to the Serving AMF via the UDM
> 1\. The NEF invokes an Nudm_EventExposure Subscribe service operation
> towards the UDM for the target UE for location reporting and indicates
> whether a one-time UE location is requested or multiple UE locations for
> some triggering event and includes the UE identity (SUPI or GPSI),
> information on location accuracy (e.g. cell ID or TA granularity or a higher
> accuracy). A correlation ID is also included.
>
> 2\. The UDM invokes an Namf_EventExposure Subscribe service operation
> towards the serving AMF for the target UE for location reporting and
> includes the information received in the service operation for step 1
> including the correlation ID and a URL for the NEF.
>
> 3\. The AMF acknowledges the request in step 2.
>
> 4\. The UDM acknowledges the request in step 1.
>
> 5\. The AMF performs a Network Triggered Service Request if needed to place
> the UE in CM-CONNECTED state.
>
> 6\. The AMF obtains the current or last known location of the UE as
> described for step 12 of Figure 6.23.3.1-1,
>
> 7\. The AMF invokes the Namf_EventExposure Notify service operation towards
> the NEF indicated by the URL received in step 2 and includes the current or
> last known UE location as obtained at step 6 and the correlation ID received
> at step 2.
>
> 8\. Optionally if additional triggered UE locations are requested in step 2,
> the AMF may invoke one or more Namf_EventExposure Notify service operations
> towards the NEF to provide additional UE locations as in step 14 for Figure
> 6.23.3.1-1.
#### 6.23.3.3 Enhanced NG-RAN Location Reporting Procedure
Figure 6.23.3.3-1 shows the procedure used by a serving AMF to obtain a
location estimate for the target UE from the NG-RAN with higher location
accuracy than that possible using cell ID based location. The procedure could
also be used for non-3GPP access from a UE if an N3IWF and AN replace the NG-
RAN in Figure 6.23.3.3-1. The procedure is intended to supplement the NG-RAN
Location reporting procedures defined in clause 4.10 of TS 23.502 [5] using
the same NGAP messages between the AMF and NG-RAN.
Figure 6.23.3.3-1: Enhanced NG-RAN Location Reporting Procedure
Precondition: The UE is initially in CM_CONNECTED state.
1\. The AMF sends a Location Reporting Control message to the NG-RAN
containing the information identifying the UE, a Reporting Type, an optional
Location Reporting Level (e.g. indicating an area of interest), a Location QoS
and optionally a maximum duration or maximum number of reports for triggered
location. The Reporting Type can indicate a one-time location or a series of
triggered locations based on criteria such as a change of serving cell, a
fixed periodic interval or entry into or exit from an area of interest.
Editor\'s note: The supported triggering events may align with those defined
in Release 15 or may include additional triggering events such as fixed
periodic events or movement of the UE by more than some threshold distance.
The triggering events can be defined to align with triggering events used for
GMLC based location to enable a unified location service from an NEF.
2\. Depending on the location QoS requested in step 1, the NG-RAN may send a
Location Measurement Request to the UE to request location measurements from
the UE (e.g. of signals transmitted by the NG-RAN).
3\. If step 2 occurs, the UE obtains and returns the requested location
measurements.
4\. Using any location measurements provided at step 3, any recent location
measurements previously received from the UE and/or location measurements for
the UE obtained by the NG-RAN, the NG-RAN determines the UE location.
Editor\'s note: Support of steps 2-4 depends on new procedures and possibly
new measurements to be agreed and added by RAN.
5\. The NG-RAN returns the UE location to the AMF in a Location Report
message.
6\. If triggered UE locations were requested at step 1, the NG-RAN waits until
a trigger event occurs and then proceeds to step 7.
7-10. The NG-RAN repeats steps 2-5. Steps 6-10 are then repeated until a
maximum number of reports or maximum duration is attained or until step 11
occurs.
11\. For triggered location reporting, the AMF may cancel the location
reporting in the NG-RAN - e.g. if no maximum duration or maximum number of
reports was included at step 1.
### 6.23.4 Impacts on existing entities and interfaces
**NG-RAN Impacts:**
\- Impacts to support more accurate UE location determination for the Enhanced
NG-RAN Location Reporting Procedure.
**AMF Impacts:**
\- Impacts to request more accurate UE location for the Enhanced NG-RAN
Location Reporting Procedure.
\- Impacts for any changes to the AMF Event Exposure service operation to
support additional types of triggered and periodic location reporting and more
accurate location reporting.
**UDM Impacts:**
\- Impacts to support additional types of triggered and periodic location
reporting and higher location accuracy for the AMF and UDM Event Exposure
service operations.
**NEF Impacts:**
\- Impacts to support a new SBI to NFs and new API to AFs to enable a unified
request for a UE location including a request for triggered or periodic
location.
\- Impacts to support a GMLC Provide Location SBI to request UE location from
a GMLC.
\- Impacts to support enhanced AMF and UDM Event Exposure SBIs to enable a
request for UE location reporting with higher accuracy and/or additional types
of periodic and triggered location.
\- Impacts to query a UDM for UE privacy requirements and a serving AMF
address.
\- Impacts to verify UE privacy requirements.
### 6.23.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.24 Solution #24: GMLC based Positioning Access selection for LCS service
### 6.24.1 Introduction
This solution addresses the Key Issue 14: Positioning Access selection for LCS
service.
### 6.24.2 Functional Description
When UE accesses 5GC via 3GPP access and non-3GPP access simultaneously, the
serving AMF may be same or different in the following scenarios:
\- Scenario 1: When served by the same PLMN for 3GPP and non-3GPP accesses,
the UE is served by the same AMF.
\- Scenario 2: When served by different PLMNs for 3GPP and non-3GPP accesses,
the UE is served by two AMFs belonging to two different PLMNs.
In order to support the scenarios above, when GMLC receives LCS Service
Request from LCS Client, it decides Access Type to transmit the positioning
message based on the information in Table 6.24.2-1.
Table 6.24.2-1: Information for access type selection
+---------------------------+-----------------------------------------+ | Information | Description | +---------------------------+-----------------------------------------+ | Access Type | The information is provided by UDM. UDM | | | obtains the information from AMF during | | | Registration procedure. | +---------------------------+-----------------------------------------+ | **For each Access Type:** | | +---------------------------+-----------------------------------------+ | Serving AMF address | The information is provided by UDM. UDM | | | obtains the information during the | | | Registration procedure. | +---------------------------+-----------------------------------------+ | Connectivity state | The information may be provided by UDM, | | | AMF or LMF. | | | | | | - UDM and LMF obtain the information | | | by invoking Namf_EventExposure | | | service. | | | | | | - AMF locally maintains the | | | connectivity state of the UE. | +---------------------------+-----------------------------------------+
The GMLC provides the selected Access Type to the LMF or AMF.
### 6.24.3 Procedures
Figure 6.24.3-1: Access Type selection for LCS service
1\. An external LCS client sends a location request to an HGMLC in the HPLMN
for the target UE. The HGMLC verifies the authorization of the LCS Client to
locate the target UE and UE privacy requirements.
2\. The HGMLC invokes the Nudm_UE ContextManagement_Get service operation
towards the UDM of the target UE with the GPSI or SUPI of the UE.
3\. The UDM returns the Access Type(s) currently used by UE. For each access
type, the UDM returns serving AMF address and possibly returns connectivity
state, a VGMLC address and/or an LMF address.
NOTE: The UDM retrieves the connectivity state from the AMF when the
connectivity state is requested by the GMLC.
4\. The HGMLC selects the access type to transmit the positioning message
based on the information received from UDM.
Alternatively, if the UE is served by same AMF, the LMF/AMF may perform access
type selection further.
Steps 5-13 are same as step 4-12 in section 6.18.3.
### 6.24.4 Impacts on existing entities and interfaces
Impacts are as follows:
\- GMLC: decide the Access Type to transmit the location information (e.g.
positioning message) and provide the Access Type to AMF or LMF.
\- LMF: send the Access Type received from GMLC to the AMF.
\- AMF: triggers the procedure to obtain UE location in the specific access
based on the Access Type received from GMLC or LMF.
### 6.24.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.25 Solution #25: Coordination of Positioning Signalling Transmitted via
Control Plane Path and User Plane Path
### 6.25.1 Introduction
This solution is to address Key Issue 11 \"Coordination of Positioning
Signalling Transmitted via Control Plane Path and User Plane Path\".
### 6.25.2 Functional Description
Positioning signalling between UE and AMF can be transferred via control plane
path and user plane path. LMF may determine the preferred transfer path
according to:
\- The load balance of control plane path and user plane path. When LMF knows
the serving AMF is in high load level, it may transfer the positioning
signalling via User Plane path to perform MT-LR position.
\- The latency requirement on positioning. In case that one LMF is distributed
deployed as described in Solution 4 to support low latency position, the LMF
may need to transfer the position signalling between UE and LMF via UCF
(proposed in Solution 6.16) which is also locally deployed.
### 6.25.3 Procedures
The system procedure that LMF selects the transfer path of position signalling
is depicted below:
Figure 6.25.3-1: MT-LR position procedure with transfer path coordination
0\. When one LMF is selected to serve one UE, LMF subscribes the status report
of serving AMF load level and UE\'s CP connection via
Namf_EventExposure_Subscribe service operation. When the serving AMF is high
load, it notifies the event indicating AMF\'s high load to the LMF. LMF may
also obtains UE\'s serving AMF via querying UDM.
1\. NEF sends Nlmf_Location_UELocation Request message (UE Identity, Location
request) to the LMF. The location request include the location positioning QoS
requirement, and LMF determines the location positioning transfer path for MT-
LR position according to serving AMF\'s load, the location QoS requirement,
and other aspect like latency requirement. The NEF selects the LMF as
described in step 2, clause 6.10.3.1 in the TR.
2a. The MT-LR position is performed via control plane path, and the serving
AMF transfers the positioning signalling between UE and LMF via its
\"Namf_Communication\" service.
2b. The MT-LR position is performed via user plane path. As indicated in
Solution 6.16, serving UCF transfers the positioning signalling between UE and
LMF.
3\. The LMF provides UE location to the NEF via Nlmf_Location_UELocation
Response.
### 6.25.4 Impacts on existing entities and interfaces
The solution impact the following network functions:
\- LMF needs to subscribe serving AMF\'s load information and determine the
transfer path for position signalling between control plane path and user
plane path.
\- \"AMF load status\"is exposed by AMF as a new service.
### 6.25.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.26 Solution 26: Local LCS architecture
### 6.26.1 Introduction
This solution addresses the Key Issue#1 \"Enhancement to LCS architecture\"
and Key Issue#3 \"support of low latency LCS\", and proposes local LMF
architecture in the NG-RAN, additionally, the impact to the 5GC and NG-RAN are
discussed.
### 6.26.2 Functional Description
The solution includes Local LMF capabilities in the NG-RAN, as shown in Figure
6.26.2-1.
Figure 6.26.2-1: Local LCS architecture
The NG-RAN which contained local LMF capability includes the following
functionalities:
\- Supports location determination for a UE served by the NG RAN contains
Local LMF capability.
\- Obtains downlink location measurements or a location estimate from the UE.
\- Obtains uplink location measurements.
\- Obtains non-UE associated assistance data from the neighbour NG RAN(s).
\- Dynamic coordination of positioning resources of the neighbour NG RAN(s).
\- Communication with LMF, AMF and other 5GC LCS function entities.
### 6.26.3 Procedures
#### 6.26.3.1 Local LMF registration
The purpose of the Local LMF capability registration procedure is to register
the Local LMF to the NRF , as shown in Figure 6.26.3-1.
Figure 6.26.3-1: Procedure for Local LMF registration
1\. The NG-RAN node issues a N2 transport message to the AMF, which may be a
NG setup request or RAN congifuration update message, passing the registration
related information of the Local LMF, e.g, the Local LMF support indicator or
the capability information of the Local LMF, etc.
2\. According to the received registration related information, the AMF may
generate and send the Local LMF registration request message towards the NRF,
which contains the RAN identity and the capability information of the Local
LMF, etc.
Editor\'s note: Whether AMF contacts NRF is FFS.
Editor\'s note: Whether and how NRF store the Local LMF capability of NG-RAN
is FFS.
3\. The NRF determines if the registration can be accepted based on the
operator\'s strategy and stores the above registration related information.
4\. If the registration is accepted, the NRF returns the Local LMF
registration ack message to the AMF.
5\. The AMF returns a N2 transport message to the corresponding NG-RAN node,
which may be a NG setup response or RAN congifuration update acknowledge
message.
#### 6.26.3.2 AMF based Local LMF selection
The AMF based Local LMF selection procedure is used when a location service is
requested and the serving NG-RAN has the Local LMF capability, as shown in
Figure 6.26.3-2
Figure 6.26.3-2: Procedure for AMF based Local LMF selection
1\. The AMF receives the location service request Message from the GMLC or UE.
2\. The AMF may invoke the Nnrf_NFDiscovery_Request service operation from the
NRF to find a suitable LMF to continue the location request procedure.
3\. The NRF replies with the list of potential LMF(s) and their service
capability information. The list contains LLMFs and LMFs. Based on LMF
selection factors in clause 6.14.3.0, the AMF may chose to use the LLMF within
current serving NG-RAN of the target UE to continue the location request.
4\. The AMF communicates the Location Determine Request to the Local LMF.
5\. The local LMF initiates location operations with the gNB/UE to obtain
positioning measurements, the positioning signalling between the Local LMF and
the gNB/UE in this solution is to be defined by RAN.
6\. The Local LMF computes the position estimate and returns it to the AMF,
via Location Determine Response.
7\. The AMF forwards it to the requesting entity (e.g. UE or GMLC).
If the local LMF related information is stored in the serving AMF, the above
step 2 and 3 should be omitted. The AMF can discover a suitable Local LMF
serving this UE by itself.
Editors\' note: The details of communication between AMF and Local LMF are FFS
and needs to be further studied in cooperation with RAN. E.g. in step 4 and 6,
the AMF and LLMF may exchange messages directly or via NG-RAN.
### 6.26.4 Impacts on existing entities and interfaces
The NG-RAN supports positioning capability, e.g, location measurement and
location calculation.
### 6.26.5 Evaluation
Since the LMF related capabilities are supported in NG-RAN, the signaling
transmission process via 5GC can be avoided, the solution can greatly improve
the latency performance of the location service. Especially for the location
service with stringent latency requirement, compared with the legacy LCS
architecture, this solution can obtain the maximum gain. In addition, through
the dynamic coordination of position resources, the solution can further
improve the utilization rate of radio resources.
## 6.27 Solution #27: Bulk operation of LCS service request targeting to
multiple UEs
### 6.27.1 Introduction
A service application in the AF may have the same location service
requirements for multiple (e.g. IoT) UEs, e.g. a group of UEs or any UE in a
certain area. It is not necessary to initiate multiple individual location
requests with the same requirements for each UE in a group. It should be
possible for the LCS specifications to enable the AF to send in a single
message a LCS service request with the same requirements for multiple UEs
identified by a group ID or targeting any UE. The LCS specifications shall be
able to ensure that the AF LCS service request can be successfully delivered
to the serving NFs of the UE (e.g. AMF and LMF) once privacy setting checks
have been done:
\- For the UEs who are already registered, the LCS service is initiated
immediately.
\- For the UEs who are not yet registered, the LCS service is initiated later
and the AF LCS service request is stored for future usage.
A UE group may be associated with a group privacy setting, i.e. each member of
the group shares the same privacy setting. The UE belonging to a network slice
instance may be associated with a common privacy setting.
This solution applies to Key Issue #8 Support of IoT UEs, and it can also be
applied to non-IoT UEs.
### 6.27.2 Functional Description
#### 6.27.2.1 Option 1: LCS service request stored in the UDR as the
subscription data
When GMLC or NEF receives a LCS request from the AF targeting multiple UEs
(identified by a Group ID or any UE belonging to a network slice instance), it
maps the external group ID into the internal group ID. The GMLC checks from
the UDM on the privacy setting of the target UE group in a single message, and
the UDM returns with either the LCS privacy setting for individual UE, for the
UE group or for the network slice instance. For those UEs who allows to be
located, the GMLC further checks with UDM on their serving AMFs and initiates
the 5GC_NT_LR procedure to the individual AMF serving the targeting UE.
If it is a deferred or a periodic location request, for the targeting UE who
has not been successfully registered (who has no serving AMF for the moment),
GMLC stores the AF request to the UDR as the subscription data for future
fetching by the AMF via UDM. When any UE successfully registered in the
network, based on local configuration, the serving AMF fetches from the UDR
via UDM for the AF request and the serving GMLC ID. For those UEs subject to
the AF request and AF is authorised to use the location service by the target
UE, the AMF initiates the 5GC_NI_LR procedure to trigger the positing of the
target UE and reports the location of the target UE to the GMLC.
Alternatively, the GMLC can be a functionality of NEF, i.e. a service provided
by the NEF.
#### 6.27.2.2 Option 2: LCS service request stored in the UDR as the
application data
When GMLC or NEF receives the AF location request targeting to multiple UEs (a
group of UE, any UE belonging to a network slice instance or any UE moving
into an area), it maps the external group ID into the internal group ID. The
GMLC checks from the UDM on the privacy setting of the target UE group in a
single message, and the UDM returns with either the LCS privacy setting for
individual UE, for the UE group or for the network slice instance. For those
UEs who allows to be located, the GMLC further checks with UDM on their
serving AMFs and initiates the 5GC_MT_LR procedure to the individual AMF
serving the targeting UE.
If it is a deferred or a periodic location request, for the targeting UE who
has not been successfully registered (who has no serving AMF for the moment),
GMLC stores the AF request to the UDR as the application data for future
fetching by the AMF. When any UE successfully registered in the network, based
on local configuration, the serving AMF fetches from the UDR for the AF
request and the serving GMLC ID. The AMF then performs the privacy checking to
the UDM, and if location service is allowed, the AMF initiates the 5GC_NI_LR
procedure to trigger the positing of the target UE and reports the location of
the target UE to the GMLC.
Alternatively, the GMLC can be a functionality of NEF, i.e. a service provided
by the NEF.
### 6.27.3 Procedures
> Editor\'s note: This clause describes high-level procedures and information
> flows for the solution.
#### 6.27.3.1 Option 1: LCS service request stored in the UDR as the
subscription data
Figure 6.27.3.1-1: Bulk operation of LCS service request targeting to multiple
UEs (LCS service request stored in the UDR as the subscription data)
1\. The external location services client or the AF (via NEF) sends a request
to the GMLC for a location of a group ID (may be mapped by the NEF from
external group ID to the group ID used within 3GPP network) or any UE (e.g.
belonging to a network slice). The request may include the required QoS,
Supported GAD shapes and client type. NEF or GMLC authorizes the AF or the
External Client for the usage of the LCS service.
2\. The GMLC invokes a Nudm_SDM_Get service operation towards the UDM to get
the privacy settings of the UE identified by a group ID or pertaining to an
S-NSSAI. The UDM returns either the target UE Privacy setting and the SUPI of
the UE or the target group privacy setting and the group ID/S-NSSAI. The GMLC
checks the privacy settings. If the target UE is not allowed to be located,
step 3-4 are skipped.
Further steps (except step 5) are carried once per UE.
3\. The GMLC invokes a Nudm_UECM_Get service operation towards the UDM of the
target UE to be located with SUPI of this UE. The UDM returns the network
addresses of the current serving AMF.
The UDM is aware of the serving AMF address based on UE registration on an AMF
(TS 23.502 [5], clause 4.2.2.2.2). The UDM made aware of a serving GMLC
address by the AMF at UE registration on an AMF (modification to TS 23.502
[5], clause 4.2.2.2.2).
4\. The GMLC initiates 5GC_MT_LR procedure as described in Step 4-10 of clause
6.14.3.1.
5\. If no serving AMF address is provided for a UE in step 3, the GMLC stores
the AF request and its address as the subscription data, which can be accessed
by the UDM, into the UDR.
6\. UE performs the registration to the network, and AMF is allocated to serve
the UE.
7\. AMF fetches from the UDM of the potential AF request of the target UE.
8\. UDM fetches them from the UDR.
9\. If there are any AF request applies to the UE and the privacy setting of
the target UE allows itself to be located by the AF, the UDM responds to the
AMF with the AF request and the GMLC address for reporting; otherwise it
responds with no AF request and Step 10 is skipped.
10\. The AMF initiates 5GC_NI_LR procedure for UE positioning and location
reporting.
#### 6.27.3.2 Option 2: LCS service request stored in the UDR as the
application data
Figure 6.27.3.2-1: Bulk operation of LCS service request targeting to multiple
UEs (LCS service request stored in the UDR as the application data)
1\. The external location services client or the AF (via NEF) sends a request
to the GMLC for a location of a group ID (may be mapped by the NEF from
external group ID to the group ID used within 3GPP network) or any UE (e.g.
belonging to a network slice). The request may include the required QoS,
Supported GAD shapes and client type. NEF or GMLC authorizes the AF or the
External Client for the usage of the LCS service.
2\. The GMLC invokes a Nudm_SDM_Get service operation towards the UDM to get
the privacy settings of the UE identified by a group ID or pertaining to an
S-NSSAI. The UDM returns either the target UE Privacy setting and the SUPI of
the UE or the target group privacy setting and the group ID/S-NSSAI. The GMLC
checks the privacy settings. If the target UE is not allowed to be located,
step 3-4 are skipped.
Further steps (except step 5) are carried once per UE.
3\. The GMLC invokes a Nudm_UECM_Get service operation towards the UDM of the
target UE to be located with SUPI of this UE. The UDM returns the network
addresses of the current serving AMF.
The UDM is aware of the serving AMF address based on UE registration on an AMF
(TS 23.502 [5], clause 4.2.2.2.2). The UDM made aware of a serving GMLC
address by the AMF at UE registration on an AMF (modification to TS 23.502 [5]
clause 4.2.2.2.2).
4\. The GMLC initiates 5GC_MT_LR procedure as described in Step 4-10 of clause
6.14.3.1.
5\. If no serving AMF address is provided for a UE in a group in step 3, the
GMLC stores the AF request and its address to the UDR as the application data
using Nudr_DM_Create service operation.
6\. UE performs the registration to the network, and AMF is allocated to serve
the UE.
7\. Based on local configuration, the AMF may fetch from the UDR of the
potential AF request using Nudr_DM_Query service operation.
8\. If there\'s any AF request applies to the UE, the UDR responds to the AMF
of the AF request and the GMLC address for reporting.
9\. The AMF checks privacy setting of the target UE to the UDM. If the target
UE doesn\'t allow itself to be located by the AF, step 10 is skipped.
10\. If the target UE allows itself to be located by the AF, the AMF initiates
a 5GC_NI_LR procedure to trigger the positing of the target UE and reports the
location of the target UE to the GMLC.
### 6.27.4 Impacts on existing entities and interfaces
> Editor\'s note: This clause describes impacts to existing entities and
> interfaces.
#### 6.27.4.1 Impacts to UDR and UDM
Impacts to UDR:
\- New Data Subset of the Subscription Data Storage, i.e. the privacy setting
of the target UE and the UE group;
\- AMF being a new consumer of Nudr_DM_Query; GMLC being a new consumer of
Nudr_DM_Create.
Impacts to UDM:
\- GMLC being a new consumer of UDM service operation;
\- new Subscription data types: UE LCS privacy and location subscriber
authorization data of the requestor UE.
#### 6.27.4.2 Impacts to GMLC
Capability of LCS service request handling based on target UE privacy setting.
Capability to invoke Nudr_DM_Create service operation.
#### 6.27.4.3 Impacts to NEF
If GMLC is a functionality of NEF, NEF needs to support the corresponding GMLC
services.
### 6.27.5 Evaluation
Editor\'s note: This clause provides an evaluation of the solution.
## 6.28 Solution #28: Enhanced NG-RAN to support high accuracy location
estimation
### 6.28.1 Introduction
In R15, the NG-RAN node can only provide cell-ID level UE location to the AMF.
For higher level accuracy location estimation, the AMF selects a LMF to
perform the positioning. However, even if LMF is deployed close to the NG-RAN,
the latency introduced due to the interaction with AMF for the positioning
still can\'t be avoided.
A solution needs to be developed to achieve low latency and high accuracy
location estimation.
This solution applies to:
\- Key Issue 1: Enhancement to LCS Architecture.
\- Key Issue 3: Support of low latency and high performance LCS.
\- Key Issue 7: Location service exposure.
### 6.28.2 Functional Description
This solution is dependent on the architecture defined in Solution 14 with the
addition that NG-RAN node may be enhanced to support location management
functionality to enable high accuracy location estimation, i.e., higher than
Cell Id level location accuracy.
NG-RAN node\'s capability of location management may be known to the AMF by
the following means:
\- pre-configuration;
\- N2 Configuration procedure: This may (based on RAN WG3 decision) use TS
38.413 [26] NG SETUP REQUEST or RAN CONFIGURATION UPDATE messages.
When a LCS service request is received at the NEF, the NEF determines based on
the requested accuracy on whether to invoke Nglmc_ProvideLocation service or
Namf_EventExposure service:
For a cell-ID level accuracy LCS service request, the Namf_EventExposure
service is invoked.
For a higher than cell-ID level accuracy LCS service request, the
Nglmc_ProvideLoacation service is invoked.
When AMF receives the LCS service request from the (V)GMLC, before AMF
performs LMF selection, it first determines Whether a NG-RAN node enhanced
with location management functionality can be selected or whether a LMF shall
be selected:
\- If the serving NG-RAN node does not support location management capability,
the AMF selects a LMF and instructs the LMF to perform UE positioning, and the
procedures defined in Solution 14 applies.
\- Otherwise, the AMF instructs the NG-RAN node to perform UE positioning
(using an evolved TS 38.413 [26] LOCATION REPORTING CONTROL message), and the
procedures defined in clause 6.28.3 applies.
### 6.28.3 Procedures
#### 6.28.3.1 5GC-MT-LR Procedure
The procedure defined in clause 6.14.3.1 applies with the following
differences:
\- Step 6: Before AMF performs LMF selection, it first determines based on the
capability of the serving NG-RAN node whether the NG-RAN node enhanced with
location management functionality can be selected or whether a LMF shall
selected. If the serving NG-RAN is selected, the AMF sends a N2 message (using
an evolved TS 38.413 [26] LOCATION REPORTING CONTROL message) to the serving
NG-RAN node to instruct it performing UE positioning.
\- Step 7: If AMF selects the NG-RAN node for UE positioning, the positioning
procedure is between UE and NG-RAN node.
#### 6.28.3.2 MO-LR Procedure
The procedure defined in clause 6.14.3.2 applies with the following
differences:
\- Step 3: Before AMF performs LMF selection, it first determines based on the
capability of the serving NG-RAN node whether the NG-RAN node enhanced with
location management functionality can be selected or whether a LMF shall
selected. If the serving NG-RAN is selected, the AMF sends a N2 message (using
an evolved TS 38.413 [26] LOCATION REPORTING CONTROL message) to the serving
NG-RAN node to instruct it performing UE positioning.
\- Step 4: If AMF selects the NG-RAN node for UE positioning, the positioning
procedure is between UE and NG-RAN node.
#### 6.28.3.3 5GC- Deferred 5GC-MT-LR Procedure for Periodic, Triggered and UE
Available Location Events
The procedure defined in clause 6.14.3.3 applies, i.e. no evolved TS 38.413
[26] LOCATION REPORTING CONTROL message is used by the AMF in this case.
#### 6.28.3.4 Location Service Exposure Procedure
##### 6.28.3.4.1 Location exposure to AF
The procedure defined in clause 6.23.3.1 applies with the following
differences:
\- Step 2: When a LCS service request is received at the NEF, the NEF
determines based on the requested accuracy on whether to invoke
Nglmc_ProvideLocation service or Namf_EventExposure service:
\- For a cell-ID level accuracy LCS service request, the Namf_EventExposure
service is invoked.
\- For a higher than cell-ID level accuracy LCS service request, the
Nglmc_ProvideLoacation service is invoked.
\- Step 12: UE Activity Notification procedure defined in clause 4.2.5.3 of TS
23.502 [5] applies instead of the enhanced location reporting procedure.
##### 6.28.3.4.2 NG-RAN being the LCS client
The procedure defined in clause 6.11.3.1 applies with the following
differences:
At Step 2, if the NG-RAN supports LM functionality, it performs the UE
positioning by itself and all the rest steps are skipped.
#### 6.28.4 Impacts on existing entities and interfaces
##### 6.28.4.1 Impacts to NG-RAN node
NG-RAN node needs to be enhanced to support location management functionality
to enable high accuracy location estimation, i.e., higher than Cell Id level
location accuracy.
##### 6.28.4.2 Impacts to N2
N2 interface needs to be enhanced with the support of positioning related
messages. This may (based on RAN3 decision) imply enhancements to following TS
38.413 [26] messages:
\- LOCATION REPORTING CONTROL, LOCATION REPORTING FAILURE INDICATION, LOCATION
REPORT.
\- NG SETUP REQUEST or RAN CONFIGURATION UPDATE.
##### 6.28.4.3 Impacts to AMF
Pre-configuration of the list of NG-RAN nodes for the support of LM
functionality or reusing N2 configuration procedure for the identification of
NG-RAN node high accuracy positioning capability;
Determination of whether NG-RAN node or LMF to perform UE positioning.
### 6.28.5 Evaluation
The proposed solution enables timely delivery of the high accurate UE location
estimation by reducing latency introduced at the mobile backhaul for the UE
positioning. The latency is reduced to the largest extent.
It reuses the architecture defined for Solution 14, no impact to NRF, no
impact to LMF, minor impact to AMF on the management of NG-RAN node high
accuracy positioning capability.
It has impact to the NG-RAN node and N2 interface. The details of the
positioning procedure and the required N2 messages will be heavily dependent
on solutions developed in the RAN WG(s).
# 7 Evaluation
Editor\'s note: This clause will provide a general evaluation of the
solutions.
## 7.1 Evaluation of Solutions for Key Issue #4
The summary of the solutions for Key Issue #4 (Reduce overhead for repetitive
non-successful privacy verification) is shown in table B.1-1 in Annex B.1.
As shown in the Table B.1-1 in Annex B.1, the common parts of Solution5,
Solution6,Solution7and Solution 14 are as follows:
\- The UE indicates to the network the privacy setting.
\- For 5GC_MT_LR request, the GMLC determines whether to disallow subsequent
LCS requests from external LCS clients based on UE privacy setting.
On the privacy setting storage, Solution 5 and Solution 14 propose to store
them in the UDM, and Solution 6 and Solution7 propose to store them in the
PPR. Considering that operators will benefit from a unified data storage and a
simplified network architecture, PPR can be merged into UDR, i.e. UE LCS
privacy setting is a Data Subset of the Subscription Data stored in the UDR
that is accessed by the UDM.
## 7.2 Evaluation of Complete E2E Solutions for Key Issue 1
The following solutions provide complete end-to-end (E2E) support for
commercial location services and thus address key issue 1. Pros and Cons of
each solution are included.
\- Solution 2 - LMF Based Location Solution.
\- Solution 4 - Positioning operations considering different LMF deployment
scenarios:
Solution 4A (AMF variant) - same as Solution 14 with option of choosing LMFc
or LMFd.
Solation 4B (LMF variant) - same as Solution 2 but allows an LMFc to send a
location request to an LMFd.
\- Solution 14 - Reuse R15 existing location service architecture for
commercial use cases.
\- Solution 16 - Solution for position via user plane transmission.
It is assumed that only one complete E2E solution is needed in Rel-16 (to
limit UE and network impacts and avoid industry fragmentation). Based on the
above, Solution 14 is seen to have the least disadvantage and greatest benefit
conditional on an efficient periodic and triggered location procedure being
added. Other solutions selected for Rel-16 should therefore be restricted to
solutions which are compatible with and enhance Solution 14 and should exclude
solutions which are incompatible with Solution 14.
## 7.3 Evaluation of Architectural Solutions
The following solutions provide architectural enhancements and support in the
context of key issue 1.
\- Solution 1 - 5GS LCS Functionality and Allocation to 5GS elements - Option
A and Option B. The main difference between option A and B is the placement of
the functions related to location session management and specifically, if such
functionality is allocated to AMF or LMF.
Solution 3 - Enhancement to LCS architecture.
Solution 1 (Option A) aligned with Solution 14, and is seen as worth including
for Rel-16 if any inconsistencies with other agreed solutions can be
corrected.
## 7.4 Evaluation of Solutions for Location Service Exposure
The following solutions provide support for location service exposure
according to key issue 7.
\- Solution 9 - Solution for position service exposure.
\- Solution 10 - Solution for LDR type service exposure via NEF.
\- Solution 11 - Solution for Location Service exposure to NG-RAN.
\- Solution 23 - Unified NEF Location Service Exposure.
Solution 23 is proposed for Rel-16. It is noted that Solution 23 includes
Solution 9 as a subset.
## 7.5 Evaluation of Solutions for Non-3GPP Access
The following solutions provide support for non-3GPP access according to key
issue 12:
\- Solution 12 - LCS support for non-3GPP access.
\- Solution 13 - LCS support for untrusted non-3GPP access.
Solution 13 is proposed for inclusion in Rel-16.
## 7.6 Evaluation of Solutions for Miscellaneous Functional Enhancements
The following solutions provide various miscellaneous functional enhancements
for a number of key issues.
\- Solution 8 - slice dependent LMF selection:
Key Issue 5.
\- Solution 14 - Reuse R15 existing location service architecture for
commercial use cases:
Key Issues 1, 7 and additionally Key Issues 3, 5, 6, 8, 15.
\- Solution 15: Enhancement to LCS architecture:
Key Issues 1, 3, 8.
\- Solution 17 - Solution for Flexible and Efficient Periodic and Triggered
Location:
Key Issue 13.
\- Solution 18 - UDM based Positioning Access selection for LCS service:
Key Issue 14.
\- Solution 19 - Distribution of Positioning Assistance Information:
Key Issue 16.
\- Solution 20: - LMF selection in GMLC:
Key Issues 1, 3, 5.
\- Solution 21 - Solution for Low Power Periodic and Triggered Location:
Key Issues 3, 6, 8.
\- Solution 22 - LCS continuity Support for N26 based Handover:
Key Issue 15.
\- Solution 24 - GMLC based Positioning Access selection for LCS service:
Key Issue 14.
\- Solution 25 - Coordination of Positioning Signalling Transmitted via
Control Plane Path and User Plane Path:
Key Issue 11.
Based on the above, Solution 21 is proposed for continuation in Rel-16
conditional on RAN agreement on support for EDT in Rel-16. Further Solution 14
is proposed as giving a sufficient solution for key issue 5. Other solutions
above might also be considered for Rel-16 but are deemed of lower priority.
## 7.7 Evaluation of Solutions for Key Issue #9 and #10
The analysis in Annex A shows that all solution 1 to 25 fulfils the criteria
for supporting all Rel-15 positioning methods when 3GPP EUTRAN respectively
3GPP NR radio access is used.
For Rel-16 EUTRAN and NR radio access the set of defined positioning methods
has not yet been defined by 3GPP RAN and evaluation is thus for further study.
Editor\'s note: Assessment of any positioning methods defined in Rel-16 is
FFS.
## 7.8 Evaluation of Solutions for Key Issue #3
Several solutions attempt to resolve \"Key Issue 3: Support of low latency and
high performance LCS\", which are Solution 2, 4, 14, 15, 23, 26 and Solution
28.
The low latency and high performance is achieved by:
\- allowing the deployment of distributed LMF in addition to the deployment of
the centralized LMF, as supported by Solution 2, 4, and 14.
\- allowing LMF to report UE location estimation directly to GMLC for the case
of deferred 5GC-MT-LR for periodic, triggered and UE available location
events, as supported by Solution 2 and Solution 14.
\- allowing location management functionality supported in NG-RAN, as
supported by Solution 15, 23, 26 and 28.
Solution 2 and Solution 4B are not aligned with Solution 14, thus they will
not be considered. Solution 4A is fully covered by Solution 14, thus can be
seen as a subset of Solution 14. Solution 23 includes the Enhanced NG-RAN
Location Reporting Procedure, which is a complement to Solution 28. However,
since the procedure is highly dependent on RAN, it is not within SA WG2 scope,
the details of the procedure will be determined by RAN WG(s).
On the support of location management functionality in NG-RAN, Table B.3.1
provides a comparison of Solution 15, 23, 26 and 28, which shows that:
\- All the 4 solutions require location management functionality supported in
NG-RAN, thus have dependence to RAN.
\- Solution 28 and Solution 23 has no or minor impact to LMF, AMF and NRF;
Solution 15 and Solution 26 has more impacts to LMF, AMF and NRF.
# 8 Conclusions
Editor\'s note: This clause will capture conclusions from the study.
## 8.0 General conclusions
For complete end to end support, Solution 14 is to be used as the baseline for
the development of Rel-16 normative work.
## 8.1 Conclusions of key issue 1
1\. Key issue 1 has the following interim conclusions:Rel‑16 LCS architecture
includes following NFs:
AMF, V-LMF, V-GMLC, H-GMLC, UDM, NEF and external LCS client.
2\. LRF is part of the rel-16 eLCS architecture, of which the functionality is
not enhanced from Rel-15.
Solution 1 (Option A) is seen to provide useful support in terms of functional
assignment for system handling functions and positioning functions. The
detailed functional assignments will be dependent on the specific selected
solutions for other key issues.
## 8.2 Conclusion for Key Issue #4
The following conclusion is adopted for the R16 normative work with regard to
the development for UE privacy setting update, storage and verification:
\- UE indicates to the network the privacy setting, and the privacy setting
can be stored as a Data Subset of the Subscription Data stored in the UDR that
is accessed by the UDM.
\- For 5GC_MT_LR request, the GMLC determines whether to disallow subsequent
LCS requests from external LCS clients based on the privacy setting obtained
from the UDM.
## 8.3 Conclusion for Key Issue #12
About the issue of what information should be regarded as location information
for N3GPP.
\- Agreement 1: Location information for non-3GPP access shown in column
\"Untrusted/Trusted WLAN Access\" of Table 6.13.2-1 of solution 13, should be
adopted.
> \- Agreement 2: Considering the similarity between untrusted non-3GPP and
> trusted non-3GPP solution, eLCS solution for trusted non-3GPP will be
> further specified in normative phase based on the conclusion of trusted
> non-3GPP in TR 23.716 [9].
It is concluded that Solution 13 provides acceptable support for Key Issue
#12.
## 8.4 Conclusion for Key Issues #6 and #8
On bulk operation of LCS service request targeting to multiple UEs, it is
concluded that Solution 27 Option 1 has the least impact to the 5GC
architecture, thus can be adopted as the solution for Key Issues #6 and #8.
On UE event reporting for periodic and triggered location request, it is
concluded that Solution 21 provides acceptable support for Key Issues #6 and
#8. This is conditional on RAN agreement on support for EDT in Rel-16.
## 8.5 Conclusion for Key Issue #7
For Key Issue 7: Location service exposure, following agreements are reached:
\- Agreement: For exposure location service to AF outside of HPLMN, NEF should
provide new APIs to the AF; and related services and service operation need be
provided on Nnef interface;
It is concluded that Solution 23 provides acceptable support for Key Issue #7
when exposing location service to internal NF/AF or external AF. It is noted
that Solution 23 includes Solution 9 as a subset.
It is concluded that Solution 11 provides acceptable support for Key Issue #7
when exposing location service to NG-RAN. This is conditional on RAN agreement
on support of NG-RAN as an internal LCS Client in Rel-16. The UE location
information provided to NG-RAN will be determined in the normative work.
## 8.6 Conclusion for Key Issue #9 and #10
It is concluded that the defined positioning methods defined for EUTRA Rel-15
and NR Rel-15 are supported by solutions 1 to 25 and thus no additional
solutions are necessary for the purpose of supporting these positioning
methods.
## 8.7 Agreement for Key Issue #14
For Key Issue 14: Positioning Access selection for LCS service, following
interim agreements are reached:
> \- Agreement 1: For MT-LR reached at HGMLC, the HGMLC shall query UDM for
> target UE information (e.g. serving AMF addresses). If target UE is served
> by different AMFs from different PLMN for non-3GPP access and 3GPP access
> respectively, the HGMLC shall use returned information from UDM and local
> policy to select one access type, i.e. one which AMF, to continue this
> location request. If the positioning result can meet the QoS requirement,
> the HGMLC return the positioning result to LCS client directly. Otherwise,
> HGMLC may request the other PLMN to perform positioning procedures.
\- If the positioning result from the other PLMN can meet the QoS requirement,
HGMLC return it to LCS client.
\- If the positioning result from the other PLMN can\'t meet the QoS
requirement, HGMLC return final location service response without including
any positioning result.
\- Agreement 2: For MT-LR reached at GMLC, if the GMLC find target UE is
served by only one AMF, the GMLC firstly use this AMF to continue this
location request.
## 8.8 Conclusions for Key Issue #3
The following means to achieve low latency and high-performance location
estimation can be considered in R16 normative work development:
\- The LMF deployed close to RAN is selected by the AMF to perform UE
positioning as defined in Solution 14.
\- LMF reports UE location estimation directly to GMLC when positioning
procedure is triggered by the detected LCS event for the case of deferred 5GC-
MT-LR for periodic, triggered and UE available location events, as defined in
Solution 14.
\- NG-RAN node enhanced with the support of location management functionality
may be selected to perform UE positioning locally in the RAN under the
condition that RAN WG(s) concludes that NG-RAN supports location management
functionality.
The detail N2 configuration, UE positioning procedures and the N2 extensions
will be developed in RAN WG(s), if needed.
## 8.9 Conclusion for Key Issues 5
It is concluded that Solution 14 provides acceptable support for Key Issues 5.
## 8.10 Conclusions for other Key Issues
It is concluded that no Rel-16 normative work is needed for other key issues,
i.e. Key Issue #2, Key Issue #11, Key Issue #13, Key Issue #15 and Key Issue #
16.
###### ### Annex A: Supported positioning methods
For each combination of positioning method and solution it is assessed if any
aspect of the solution may prevent specifying or implementing a certain
positioning method. If no preventing aspect is identified the solution is
deemed to support the positioning method.
Table A-1 below provides mapping between naming of methods in tables A.1-1 and
A.2-1 and the terminology used in TS 38.305 [7] and TS 23.271 [6].
Table A-1: Naming of positioning methods
+----------------------+----------------------+----------------------+ | | | | +----------------------+----------------------+----------------------+ | Name | Description in | Description in | | | 23.271 [6] Rel-15 | 38.305 [7] Rel-15 | +----------------------+----------------------+----------------------+ | CID | uplink and downlink | Note 1, Note 2 | | | cell coverage based\ | | | | positioning methods | | +----------------------+----------------------+----------------------+ | E-CID | Note 2 | enhanced cell ID | | | | method Note 3 | +----------------------+----------------------+----------------------+ | A-GNSS | A-GNSS based | network-assisted | | | positioning methods | GNSS methods | +----------------------+----------------------+----------------------+ | OTDOA | OTDOA positioning | observed time | | | method | difference of | | | | arrival (OTDOA) | | | | positioning Note 4 | +----------------------+----------------------+----------------------+ | Barometric\ | Barometric pressure | Barometric pressure | | pressure | sensor method | sensor method | +----------------------+----------------------+----------------------+ | WLAN | WLAN method | WLAN positioning | +----------------------+----------------------+----------------------+ | Bluetooth | Bluetooth method | Bluetooth | | | | positioning | +----------------------+----------------------+----------------------+ | TBS | Terrestrial Beacon | terrestrial beacon | | | System methods | system (TBS) | | | | positioning Note 5 | +----------------------+----------------------+----------------------+ | | - | | +----------------------+----------------------+----------------------+ | NOTE 1: In Rel-15 | | | | CID (Cell ID) is not | | | | described a separate | | | | positioning method | | | | but rather as subset | | | | of ECID. | | | | | | | | NOTE 2: In Rel-15 | | | | CID for NR is | | | | supported. | | | | | | | | NOTE 3: In Rel-15 | | | | only E-CID based on | | | | LTE signals is | | | | supported. | | | | | | | | NOTE 4: In Rel-15 | | | | only OTDOA based on | | | | LTE signals is | | | | supported. | | | | | | | | NOTE 5: In Rel-15 | | | | TBS is restricted to | | | | positioning based on | | | | MBS ((Metropolitan | | | | Beacon System) | | | | signals. | | | +----------------------+----------------------+----------------------+
Editor\'s note: Assessment of any positioning method defined in Rel-16 is FFS.
# A.1 Supported positioning methods in EUTRAN Rel-15
Table A.1-1 indicates if the solutions in this TR supports a specific
positioning method in EUTRAN and any identified condition of restriction. A
YES indicates that the positioning method is supported, a NO indicates that
the positioning method is not supported.
A common criterion for support of all the listed methods in a 3GPP access
network is that the solution allows the procedures defined in in clauses
4.13.5.4, 4.13.5.5 and 4.13.5.6 of TS 23.502 [5] to be used.
Table A.1-1: Supported positioning methods in EUTRAN
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Sol | CID | E-CID | A | OTDOA | Barom | WLAN | Blue | TBS | | ution | | | -GNSS | | etric | | tooth | | | | | | | | | | | | | | | | | | pre | | | | | | | | | | ssure | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 21 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 22 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 23 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 24 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | te 1) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 25 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NO | | | | | | | | | | TE 1: | | | | | | | | | | The | | | | | | | | | | asses | | | | | | | | | | sment | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | 3GPP | | | | | | | | | | E | | | | | | | | | | UTRAN | | | | | | | | | | a | | | | | | | | | | ccess | | | | | | | | | | type | | | | | | | | | | is | | | | | | | | | | used. | | | | | | | | | | | | | | | | | | | | NO | | | | | | | | | | TE 2: | | | | | | | | | | The | | | | | | | | | | asses | | | | | | | | | | sment | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | \ | | | | | | | | | | "GMLC | | | | | | | | | | Loc | | | | | | | | | | ation | | | | | | | | | | Serv | | | | | | | | | | ice\" | | | | | | | | | | used. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Editor\'s note: The assessment is preliminary and may be modified based on new
findings and modified or new solutions.
# A.2 Supported positioning methods in NR Rel-15
Table A.2-1 indicates if the solutions in this TR supports a specific
positioning method in NR and any identified condition of restriction. A YES
indicates that the positioning method is supported, a NO indicates that the
positioning method is not supported.
A common criterion for support of all the listed methods in a 3GPP access
network is that the solution allows the procedures defined in in clauses
4.13.5.4, 4.13.5.5 and 4.13.5.6 of TS 23.502 [5] to be used.
Table A.2-1: Supported positioning methods in NR
+-------+-------+-------+-------+-------+-------+-------+-------+-------+ | Sol | CID | E-CID | A | OTDOA | Barom | WLAN | Blue | TBS | | ution | | Note1 | -GNSS | Note1 | etric | | tooth | | | | | | | | | | | | | | | | | | pre | | | | | | | | | | ssure | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 1 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 2 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 3 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 4 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 5 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 6 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 7 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 8 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 9 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 10 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 11 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 12 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 13 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | (No | (No | | | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | te 2) | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 14 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 15 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 16 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 17 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 18 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 19 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 20 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 21 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 22 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 23 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | (No | (No | (No | (No | (No | (No | N | N | | | te 3) | te 3) | te 3) | te 3) | te 3) | te 3) | ote 3 | ote 3 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 24 | YES | YES | YES | YES | YES | YES | YES | YES | | | | | | | | | | | | | N | N | N | N | N | N | N | N | | | ote 2 | ote 2 | ote 2 | ote 2 | ote 2 | ote 2 | ote 2 | ote 2 | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | 25 | YES | YES | YES | YES | YES | YES | YES | YES | +-------+-------+-------+-------+-------+-------+-------+-------+-------+ | NO | | | | | | | | | | TE 1: | | | | | | | | | | In | | | | | | | | | | R | | | | | | | | | | el-15 | | | | | | | | | | only | | | | | | | | | | E-CID | | | | | | | | | | and | | | | | | | | | | OTDOA | | | | | | | | | | based | | | | | | | | | | on | | | | | | | | | | LTE | | | | | | | | | | si | | | | | | | | | | gnals | | | | | | | | | | is | | | | | | | | | | suppo | | | | | | | | | | rted. | | | | | | | | | | | | | | | | | | | | NO | | | | | | | | | | TE 2: | | | | | | | | | | The | | | | | | | | | | asses | | | | | | | | | | sment | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | 3GPP | | | | | | | | | | NR | | | | | | | | | | a | | | | | | | | | | ccess | | | | | | | | | | type | | | | | | | | | | is | | | | | | | | | | used. | | | | | | | | | | | | | | | | | | | | NO | | | | | | | | | | TE 3: | | | | | | | | | | The | | | | | | | | | | asses | | | | | | | | | | sment | | | | | | | | | | ap | | | | | | | | | | plies | | | | | | | | | | when | | | | | | | | | | \ | | | | | | | | | | "GMLC | | | | | | | | | | Loc | | | | | | | | | | ation | | | | | | | | | | Serv | | | | | | | | | | ice\" | | | | | | | | | | is | | | | | | | | | | used. | | | | | | | | | +-------+-------+-------+-------+-------+-------+-------+-------+-------+
Editor\'s note: The assessment is preliminary and may be modified based on new
findings and modified or new solutions.
###### ### Annex B: Evaluation tables for Key Issues
# B.1 Evaluation table for of Solutions for Key Issue #4
Table B.1-1 shows the analysis of solutions for key issue#4.
Table B.1.-1: Analysis of solutions for Key Issue #4
* * *
                                                                       Solution5 in clause 6.5                                          Solution6 in clause 6.6                                                                                                                                                                                                                             Solution7 in clause 6.7                                                                                                                                                                                                                             Solution 14 in clause 6.14
**Network function performs privacy verification for 5GC_MT_LR** GMLC GMLC
GMLC GMLC **How to transfer the privacy setting** N/A **Where to store the
privacy setting from the UE** UDM PPR PPR UDM **Which kind of message to carry
privacy setting from the UE** \"UE-LMF\" message and NAS Location Notification
Return Result Registration message \"UE-LMF\" message. N/A **Whether the
network changes the privacy setting from the UE** \-- The PPR may change the
privacy setting from the UE. If the PPR changes the UE Privacy Setting
preference, the privacy verification procedure to the UE may still happen.
This may lead to repetitive unsuccessful privacy verification procedure. The
PPR may change the privacy setting from the UE. If the PPR changes the UE
Privacy Setting preference, the privacy verification procedure to the UE may
still happen. This may lead to repetitive unsuccessful privacy verification
procedure. N/A
* * *
# B.2 Evaluation table for of Solutions for Key Issue #7
Table B.2-1 shows the analysis of solutions for key issue#7.
Table 7.8.-1: Analysis of solutions for Key Issue #7
+----------+----------+----------+----------+----------+----------+ | | Solution | Solution | Solution | Solution | Solution | | | 9 | 10 | 14 | 23 | 11 | +----------+----------+----------+----------+----------+----------+ | Which NF | GMLC | LMF | > GMLC | a) | Does not | | that NEF | | | | HGMLC or | apply | | forwards | | | | | | | the | | | | b) AMF | | | received | | | | | | | LCS | | | | | | | request | | | | | | | from | | | | | | | external | | | | | | +----------+----------+----------+----------+----------+----------+ | How such | using | > Query | > Not | a) Not | Does not | | NF is | the NRF | > UDM | > Known, | me | apply | | s | service | > for | > Le | ntioned? | | | elected? | to find | > | > i | | | | | first | serving | nterface | b) | | | | GMLC, | > LMF, | > is | Query | | | | and in | > if | > used | UDM to | | | | roaming | > non, | > | get | | | | case, | > use | between | serving | | | | HGMCL | > NRF | > NEF | AMF | | | | finds | > | > and | | | | | VGMLC by | service | > GMLC; | | | | | co | > to get | | | | | | ntacting | > one; | | | | | | UDM; | | | | | +----------+----------+----------+----------+----------+----------+ | Inter | North | > NEF | an SBI | > SBI | > Does | | faces | bound: | > need | to NEF | > i | > not | | aspects | Not | > | for | nterface | > apply | | of NEF | me | support | external | > to NF, | | | | ntioned; | > the | client | > and | | | | | > corre | (?) | > new | | | | | sponding | | > APIs | | | | | > | | > to AFs | | | | | service | | | | | | | > i | | | | | | | nterface | | | | +----------+----------+----------+----------+----------+----------+ | Internal | NF send | > | ? not | > via | > Does | | exposure | request | Solution | clear ? | > NEF, | > not | | to NF | to GMLC; | > itself | | > then | > apply | | within | | > does | an SBI | > NEF | | | 5G-CN | GMLC | > not | i | > | | | | provide | > diffe | nterface | forward | | | | service | rentiate | (to the | > LCS | | | | based | > | NEF for | > | | | | i | external | external | request | | | | nterface | > and | client | > to | | | | for | > | or | > GMLC; | | | | location | internal | directly | | | | | request | > | to a | | | | | | exposure | GMLC in | | | | | | | case of | | | | | | | au | | | | | | | thorized | | | | | | | c | | | | | | | lients); | | | +----------+----------+----------+----------+----------+----------+ | Internal | Not | > Not | Not | > Not | > For | | exposure | m | > m | m | > m | > target | | to | entioned | entioned | entioned | entioned | > UE in | | NG-RAN | | | | | > | | | | | | | connect | | | | | | | > mode, | | | | | | | > the | | | | | | | > NG-RAN | | | | | | | > send | | | | | | | > | | | | | | | Location | | | | | | | > | | | | | | | request | | | | | | | > to AMF | | | | | | | > via N2 | +----------+----------+----------+----------+----------+----------+ | Location | Deferred | > | Rel-15 | > I | > 5GC NI | | Request | Location | Includes | defined | ncluding | > LR | | | su | > LDR | p | > a | > used; | | type | pported, | > and | rocedure | > | | | s | related | > LIR; | su | request | | | upported | serving | > | pported. | > for | | | | NF | > | | > t | | | | activate | Request, | How to | riggered | | | | and | > | support | > or | | | | de-act | update, | \" | > | | | | the | > and | Deferred | periodic | | | | trigger, | > cancel | Location | > l | | | | detect | > LDR | r | ocation. | | | | the | > | equest\" | | | | | event of | request | not | | | | | the | > p | clearly | | | | | trigger. | rocedure | sp | | | | | | > | ecified. | | | | | Serving | defined. | | | | | | NF not | > | | | | | | s | > LMF | | | | | | pecified | > will | | | | | | in CN, | > handle | | | | | | UE could | > such | | | | | | be one. | > | | | | | | | location | | | | | | | > | | | | | | | request. | | | | +----------+----------+----------+----------+----------+----------+ | Privacy | GMLC | > | HGMLC | a) | As | | checking | perform | serving | i | HGMLC | NG-RAN | | | | > LMF | nteracts | interact | is an | | | | > | with UDM | with UDM | internal | | | | performs | to | | LCS | | | | | perform | b) NEF | client, | | | | | | interact | it is | | | | | | with UDM | deemed | | | | | | | that | | | | | | | privacy | | | | | | | veri | | | | | | | fication | | | | | | | is not | | | | | | | r | | | | | | | equired. | +----------+----------+----------+----------+----------+----------+ | Other | Target | > UE | LMF | Enhanced | Only UE | | aspects | UE | > | s | NG-RAN | in | | | located | provides | election | Location | connect | | | in EPC | > the | c | R | mode, | | | con | > | riterias | eporting | such | | | sidered. | expected | defined | P | solution | | | | > | | rocedure | works. | | | | location | | proposed | | | | | > | | | | | | | privacy | | | | | | | > prov | | | | | | | isioning | | | | | | | > to the | | | | | | | > netw | | | | | | | ork(LMF) | | | | | | | > p | | | | | | | roposed. | | | | +----------+----------+----------+----------+----------+----------+ | Other | Key | > Key | Key | | > Key | | key | Issue 3: | > issue | Issue 1 | | > Issue | | issues | \ | > 4 | (Enh | | > 1 | | a | "Support | > | ancement | | > \"Enha | | ddressed | of low | \"Reduce | to LCS | | ncements | | | latency | > | Archi | | > to LCS | | | LCS\" | overhead | tecture) | | > archit | | | | > for | | | ecture\" | | | | > re | | | | | | | petitive | | | | | | | > non-su | | | | | | | ccessful | | | | | | | > | | | | | | | privacy | | | | | | | > | | | | | | | verific | | | | | | | ation\". | | | | +----------+----------+----------+----------+----------+----------+ | Impacted | NEF, | > NEF | AMF, | > AM | > | | NFs | GMLC,UDM | ,UDM,LMF | LMF,GMLC | F,UDM,NE | NG-RAN, | | | | | ,UDM,CHF | F,NG-RAN | AMF,UDM, | +----------+----------+----------+----------+----------+----------+
# B.3 Evaluation table for Key Issue #3
Table B.3.1: Evaluation on the solution of location management functionality
support in NG-RAN
+----------+----------+----------+----------+----------+----------+ | Solution | Impact | Impact | Impact | Impact | Impact | | | to NRF | to LMF | to AMF | to | to | | | and | | | NG-RAN | in | | | service | | | node | terfaces | | | f | | | | and | | | ramework | | | | service | | | | | | | op | | | | | | | erations | +----------+----------+----------+----------+----------+----------+ | 15 | No | Yes, LMF | Yes, LMC | LMC | N2 | | | | enhanced | regi | s | | | | | for LMC | stration | upported | New | | | | per | to AMF | | N | | | | formance | and AMF | | amf_LMC | | | | ma | enhanced | | service | | | | nagement | for LMC | | | | | | | per | | | | | | | formance | | | | | | | ma | | | | | | | nagement | | | +----------+----------+----------+----------+----------+----------+ | 23 | No | No | Yes | LM | N2 | | | | | (minor). | funct | | | | | | | ionality | | | | | | | s | | | | | | | upported | | +----------+----------+----------+----------+----------+----------+ | 26 | Yes，AMF | No | Yes, AMF | LLMF as | N2 | | | on | | provides | one RAN | | | | behalf | | the LLMF | ca | | | | of LLMF, | | regi | pability | | | | provides | | stration | | | | | regi | | info to | | | | | stration | | NRF | | | | | to NRF | | using | | | | | | | NRF | | | | | | | service | | | | | | | op | | | | | | | erations | | | +----------+----------+----------+----------+----------+----------+ | 28 | No | No | Yes | LM | N2 | | | | | (minor). | funct | | | | | | NG RAN | ionality | | | | | | node LM | s | | | | | | ca | upported | | | | | | pability | | | | | | | preco | | | | | | | nfigured | | | | | | | locally | | | | | | | or | | | | | | | received | | | | | | | during | | | | | | | N2 | | | | | | | config | | | | | | | uration. | | | +----------+----------+----------+----------+----------+----------+
#